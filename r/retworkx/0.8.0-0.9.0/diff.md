# Comparing `tmp/retworkx-0.8.0.tar.gz` & `tmp/retworkx-0.9.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/retworkx-0.8.0.tar", last modified: Tue Mar  2 21:19:22 2021, max compression
+gzip compressed data, was "dist/retworkx-0.9.0.tar", last modified: Tue Jun  1 11:37:56 2021, max compression
```

## Comparing `retworkx-0.8.0.tar` & `retworkx-0.9.0.tar`

### file list

```diff
@@ -1,31 +1,36 @@
-drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-03-02 21:19:22.000000 retworkx-0.8.0/
--rw-r--r--   0 runner    (1001) docker     (121)    15009 2021-03-02 21:19:13.000000 retworkx-0.8.0/Cargo.lock
--rw-r--r--   0 runner    (1001) docker     (121)      785 2021-03-02 21:19:13.000000 retworkx-0.8.0/Cargo.toml
--rw-r--r--   0 runner    (1001) docker     (121)       80 2021-03-02 21:19:13.000000 retworkx-0.8.0/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (121)     7754 2021-03-02 21:19:22.000000 retworkx-0.8.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (121)     5595 2021-03-02 21:19:13.000000 retworkx-0.8.0/README.md
--rw-r--r--   0 runner    (1001) docker     (121)       69 2021-03-02 21:19:13.000000 retworkx-0.8.0/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx/
--rw-r--r--   0 runner    (1001) docker     (121)    18820 2021-03-02 21:19:13.000000 retworkx-0.8.0/retworkx/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/
--rw-r--r--   0 runner    (1001) docker     (121)     7754 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (121)      484 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (121)        1 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (121)        1 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (121)       14 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (121)        9 2021-03-02 21:19:22.000000 retworkx-0.8.0/retworkx.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (121)       38 2021-03-02 21:19:22.000000 retworkx-0.8.0/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (121)     1881 2021-03-02 21:19:13.000000 retworkx-0.8.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-03-02 21:19:22.000000 retworkx-0.8.0/src/
--rw-r--r--   0 runner    (1001) docker     (121)     7785 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/astar.rs
--rw-r--r--   0 runner    (1001) docker     (121)    21123 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/dag_isomorphism.rs
--rw-r--r--   0 runner    (1001) docker     (121)    79916 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/digraph.rs
--rw-r--r--   0 runner    (1001) docker     (121)     5424 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/dijkstra.rs
--rw-r--r--   0 runner    (1001) docker     (121)     2981 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/dot_utils.rs
--rw-r--r--   0 runner    (1001) docker     (121)    34011 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/generators.rs
--rw-r--r--   0 runner    (1001) docker     (121)    53311 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/graph.rs
--rw-r--r--   0 runner    (1001) docker     (121)    16573 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/iterators.rs
--rw-r--r--   0 runner    (1001) docker     (121)     3038 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/k_shortest_path.rs
--rw-r--r--   0 runner    (1001) docker     (121)   104315 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/lib.rs
--rw-r--r--   0 runner    (1001) docker     (121)    55228 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/max_weight_matching.rs
--rw-r--r--   0 runner    (1001) docker     (121)     3669 2021-03-02 21:19:13.000000 retworkx-0.8.0/src/union.rs
+drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-06-01 11:37:56.000000 retworkx-0.9.0/
+-rw-r--r--   0 runner    (1001) docker     (121)    15022 2021-06-01 11:37:43.000000 retworkx-0.9.0/Cargo.lock
+-rw-r--r--   0 runner    (1001) docker     (121)      785 2021-06-01 11:37:43.000000 retworkx-0.9.0/Cargo.toml
+-rw-r--r--   0 runner    (1001) docker     (121)       80 2021-06-01 11:37:43.000000 retworkx-0.9.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (121)     9149 2021-06-01 11:37:56.000000 retworkx-0.9.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (121)     6755 2021-06-01 11:37:43.000000 retworkx-0.9.0/README.md
+-rw-r--r--   0 runner    (1001) docker     (121)      149 2021-06-01 11:37:43.000000 retworkx-0.9.0/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx/
+-rw-r--r--   0 runner    (1001) docker     (121)    45124 2021-06-01 11:37:43.000000 retworkx-0.9.0/retworkx/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx/visualization/
+-rw-r--r--   0 runner    (1001) docker     (121)      579 2021-06-01 11:37:43.000000 retworkx-0.9.0/retworkx/visualization/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (121)     5884 2021-06-01 11:37:43.000000 retworkx-0.9.0/retworkx/visualization/graphviz.py
+-rw-r--r--   0 runner    (1001) docker     (121)    39376 2021-06-01 11:37:43.000000 retworkx-0.9.0/retworkx/visualization/matplotlib.py
+drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (121)     9149 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (121)      601 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (121)        1 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (121)        1 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (121)      118 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (121)        9 2021-06-01 11:37:56.000000 retworkx-0.9.0/retworkx.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (121)       38 2021-06-01 11:37:56.000000 retworkx-0.9.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (121)     2136 2021-06-01 11:37:43.000000 retworkx-0.9.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (121)        0 2021-06-01 11:37:56.000000 retworkx-0.9.0/src/
+-rw-r--r--   0 runner    (1001) docker     (121)     7785 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/astar.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    87646 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/digraph.rs
+-rw-r--r--   0 runner    (1001) docker     (121)     5424 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/dijkstra.rs
+-rw-r--r--   0 runner    (1001) docker     (121)     2981 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/dot_utils.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    43450 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/generators.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    57258 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/graph.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    27503 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/isomorphism.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    66406 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/iterators.rs
+-rw-r--r--   0 runner    (1001) docker     (121)     3038 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/k_shortest_path.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    12523 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/layout.rs
+-rw-r--r--   0 runner    (1001) docker     (121)   166610 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/lib.rs
+-rw-r--r--   0 runner    (1001) docker     (121)    55139 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/max_weight_matching.rs
+-rw-r--r--   0 runner    (1001) docker     (121)     3669 2021-06-01 11:37:43.000000 retworkx-0.9.0/src/union.rs
```

### Comparing `retworkx-0.8.0/Cargo.lock` & `retworkx-0.9.0/Cargo.lock`

 * *Files 3% similar despite different names*

```diff
@@ -28,17 +28,17 @@
 name = "cfg-if"
 version = "1.0.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd"
 
 [[package]]
 name = "crossbeam-channel"
-version = "0.5.0"
+version = "0.5.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "dca26ee1f8d361640700bde38b2c37d8c22b3ce2d360e1fc1c74ea4b0aa7d775"
+checksum = "06ed27e177f16d65f0f0c22a213e17c696ace5dd64b14258b52f9417ccb52db4"
 dependencies = [
  "cfg-if 1.0.0",
  "crossbeam-utils",
 ]
 
 [[package]]
 name = "crossbeam-deque"
@@ -49,41 +49,40 @@
  "cfg-if 1.0.0",
  "crossbeam-epoch",
  "crossbeam-utils",
 ]
 
 [[package]]
 name = "crossbeam-epoch"
-version = "0.9.3"
+version = "0.9.5"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "2584f639eb95fea8c798496315b297cf81b9b58b6d30ab066a75455333cf4b12"
+checksum = "4ec02e091aa634e2c3ada4a392989e7c3116673ef0ac5b72232439094d73b7fd"
 dependencies = [
  "cfg-if 1.0.0",
  "crossbeam-utils",
  "lazy_static",
  "memoffset",
  "scopeguard",
 ]
 
 [[package]]
 name = "crossbeam-utils"
-version = "0.8.3"
+version = "0.8.5"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "e7e9d99fa91428effe99c5c6d4634cdeba32b8cf784fc428a2a687f61a952c49"
+checksum = "d82cfc11ce7f2c3faef78d8a684447b40d503d9681acebed6cb728d45940c4db"
 dependencies = [
- "autocfg",
  "cfg-if 1.0.0",
  "lazy_static",
 ]
 
 [[package]]
 name = "ctor"
-version = "0.1.19"
+version = "0.1.20"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "e8f45d9ad417bcef4817d614a501ab55cdd96a6fdb24f49aab89a54acfd66b19"
+checksum = "5e98e2ad1a782e33928b96fc3948e7c355e5af34ba4de7670fe8bac2a3b2006d"
 dependencies = [
  "quote",
  "syn",
 ]
 
 [[package]]
 name = "either"
@@ -95,17 +94,17 @@
 name = "fixedbitset"
 version = "0.2.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "37ab347416e802de484e4d03c7316c48f1ecb56574dfd4a46a80f173ce1de04d"
 
 [[package]]
 name = "getrandom"
-version = "0.2.2"
+version = "0.2.3"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "c9495705279e7140bf035dde1f6e750c162df8b625267cd52cc44e0b156732c8"
+checksum = "7fcd999463524c52659517fe2cea98493cfe485d10565e7b0fb07dbba7ad2753"
 dependencies = [
  "cfg-if 1.0.0",
  "libc",
  "wasi",
 ]
 
 [[package]]
@@ -136,17 +135,17 @@
 checksum = "322f4de77956e22ed0e5032c359a0f1273f1f7f0d79bfa3b8ffbc730d7fbcc5c"
 dependencies = [
  "libc",
 ]
 
 [[package]]
 name = "indexmap"
-version = "1.6.1"
+version = "1.6.2"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "4fb1fa934250de4de8aef298d81c729a7d33d8c239daa3a7575e6b92bfc7313b"
+checksum = "824845a0bf897a9042383849b02c1bc219c2383772efcd5c6f9766fa4b81aef3"
 dependencies = [
  "autocfg",
  "hashbrown",
 ]
 
 [[package]]
 name = "indoc"
@@ -206,23 +205,23 @@
 name = "lazy_static"
 version = "1.4.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "e2abad23fbc42b3700f2f279844dc832adb2b2eb069b2df918f455c4e18cc646"
 
 [[package]]
 name = "libc"
-version = "0.2.87"
+version = "0.2.95"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "265d751d31d6780a3f956bb5b8022feba2d94eeee5a84ba64f4212eedca42213"
+checksum = "789da6d93f1b866ffe175afc5322a4d76c038605a1c3319bb57b06967ca98a36"
 
 [[package]]
 name = "lock_api"
-version = "0.4.2"
+version = "0.4.4"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "dd96ffd135b2fd7b973ac026d28085defbe8983df057ced3eb4f2130b0831312"
+checksum = "0382880606dff6d15c9476c416d18690b72742aa7b605bb6dd6ec9030fbf07eb"
 dependencies = [
  "scopeguard",
 ]
 
 [[package]]
 name = "matrixmultiply"
 version = "0.2.4"
@@ -230,17 +229,17 @@
 checksum = "916806ba0031cd542105d916a97c8572e1fa6dd79c9c51e7eb43a09ec2dd84c1"
 dependencies = [
  "rawpointer",
 ]
 
 [[package]]
 name = "memoffset"
-version = "0.6.1"
+version = "0.6.4"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "157b4208e3059a8f9e78d559edc658e13df41410cb3ae03979c83130067fdd87"
+checksum = "59accc507f1338036a0477ef61afdae33cde60840f4dfe481319ce3ad116ddf9"
 dependencies = [
  "autocfg",
 ]
 
 [[package]]
 name = "ndarray"
 version = "0.13.1"
@@ -292,17 +291,17 @@
 dependencies = [
  "hermit-abi",
  "libc",
 ]
 
 [[package]]
 name = "numpy"
-version = "0.12.2"
+version = "0.13.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "9fd9e8e652becf4ba6c11803945f8bf463c23f482f704bb33f70ae9d22482d10"
+checksum = "a7073fae1e0b82409533a29c6f804b79783d7b2d3c07728fdc4d884eda8cd4f0"
 dependencies = [
  "cfg-if 0.1.10",
  "libc",
  "ndarray",
  "num-complex",
  "num-traits",
  "pyo3",
@@ -372,56 +371,57 @@
 name = "proc-macro-hack"
 version = "0.5.19"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "dbf0c48bc1d91375ae5c3cd81e3722dff1abcf81a30960240640d223f59fe0e5"
 
 [[package]]
 name = "proc-macro2"
-version = "1.0.24"
+version = "1.0.27"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "1e0704ee1a7e00d7bb417d0770ea303c1bccbabf0ef1667dae92b5967f5f8a71"
+checksum = "f0d8caf72986c1a598726adc988bb5984792ef84f5ee5aa50209145ee8077038"
 dependencies = [
  "unicode-xid",
 ]
 
 [[package]]
 name = "pyo3"
-version = "0.12.4"
+version = "0.13.2"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "bf6bbbe8f70d179260b3728e5d04eb012f4f0c7988e58c11433dd689cecaa72e"
+checksum = "4837b8e8e18a102c23f79d1e9a110b597ea3b684c95e874eb1ad88f8683109c3"
 dependencies = [
+ "cfg-if 1.0.0",
  "ctor",
  "hashbrown",
  "indoc",
  "inventory",
  "libc",
  "parking_lot",
  "paste",
- "pyo3cls",
+ "pyo3-macros",
  "unindent",
 ]
 
 [[package]]
-name = "pyo3-derive-backend"
-version = "0.12.4"
+name = "pyo3-macros"
+version = "0.13.2"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "10ecd0eb6ed7b3d9965b4f4370b5b9e99e3e5e8742000e1c452c018f8c2a322f"
+checksum = "a47f2c300ceec3e58064fd5f8f5b61230f2ffd64bde4970c81fdd0563a2db1bb"
 dependencies = [
- "proc-macro2",
+ "pyo3-macros-backend",
  "quote",
  "syn",
 ]
 
 [[package]]
-name = "pyo3cls"
-version = "0.12.4"
+name = "pyo3-macros-backend"
+version = "0.13.2"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "d344fdaa6a834a06dd1720ff104ea12fe101dad2e8db89345af9db74c0bb11a0"
+checksum = "87b097e5d84fcbe3e167f400fbedd657820a375b034c78bd852050749a575d66"
 dependencies = [
- "pyo3-derive-backend",
+ "proc-macro2",
  "quote",
  "syn",
 ]
 
 [[package]]
 name = "quote"
 version = "1.0.9"
@@ -484,49 +484,49 @@
 name = "rawpointer"
 version = "0.2.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "60a357793950651c4ed0f3f52338f53b2f809f32d83a07f72909fa13e4c6c1e3"
 
 [[package]]
 name = "rayon"
-version = "1.5.0"
+version = "1.5.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "8b0d8e0819fadc20c74ea8373106ead0600e3a67ef1fe8da56e39b9ae7275674"
+checksum = "c06aca804d41dbc8ba42dfd964f0d01334eceb64314b9ecf7c5fad5188a06d90"
 dependencies = [
  "autocfg",
  "crossbeam-deque",
  "either",
  "rayon-core",
 ]
 
 [[package]]
 name = "rayon-core"
-version = "1.9.0"
+version = "1.9.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "9ab346ac5921dc62ffa9f89b7a773907511cdfa5490c572ae9be1be33e8afa4a"
+checksum = "d78120e2c850279833f1dd3582f730c4ab53ed95aeaaaa862a2a5c71b1656d8e"
 dependencies = [
  "crossbeam-channel",
  "crossbeam-deque",
  "crossbeam-utils",
  "lazy_static",
  "num_cpus",
 ]
 
 [[package]]
 name = "redox_syscall"
-version = "0.2.5"
+version = "0.2.8"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "94341e4e44e24f6b591b59e47a8a027df12e008d73fd5672dbea9cc22f4507d9"
+checksum = "742739e41cd49414de871ea5e549afb7e2a3ac77b589bcbebe8c82fab37147fc"
 dependencies = [
  "bitflags",
 ]
 
 [[package]]
 name = "retworkx"
-version = "0.8.0"
+version = "0.9.0"
 dependencies = [
  "fixedbitset",
  "hashbrown",
  "ndarray",
  "numpy",
  "petgraph",
  "pyo3",
@@ -545,28 +545,28 @@
 name = "smallvec"
 version = "1.6.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "fe0f37c9e8f3c5a4a66ad655a93c74daac4ad00c441533bf5c6e7990bb42604e"
 
 [[package]]
 name = "syn"
-version = "1.0.60"
+version = "1.0.72"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "c700597eca8a5a762beb35753ef6b94df201c81cca676604f547495a0d7f0081"
+checksum = "a1e8cdbefb79a9a5a65e0db8b47b723ee907b7c7f8496c76a1770b5c310bab82"
 dependencies = [
  "proc-macro2",
  "quote",
  "unicode-xid",
 ]
 
 [[package]]
 name = "unicode-xid"
-version = "0.2.1"
+version = "0.2.2"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "f7fe0bb3479651439c9112f72b6c505038574c9fbb575ed1bf3b797fa39dd564"
+checksum = "8ccb82d61f80a663efe1f787a51b16b5a51e3314d6ac365b08639f52387b33f3"
 
 [[package]]
 name = "unindent"
 version = "0.1.7"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "f14ee04d9415b52b3aeab06258a3f07093182b88ba0f9b8d203f211a7a7d41c7"
```

### Comparing `retworkx-0.8.0/Cargo.toml` & `retworkx-0.9.0/Cargo.toml`

 * *Files 15% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 [package]
 name = "retworkx"
 description = "A python graph library implemented in Rust"
-version = "0.8.0"
+version = "0.9.0"
 authors = ["Matthew Treinish <mtreinish@kortar.org>"]
 license = "Apache-2.0"
 readme = "README.md"
 repository = "https://github.com/Qiskit/retworkx"
 keywords = ["python", "graph"]
 edition = "2018"
 
@@ -15,27 +15,27 @@
 [lib]
 name = "retworkx"
 crate-type = ["cdylib"]
 
 [dependencies]
 petgraph = "0.5.1"
 fixedbitset = "0.2.0"
-numpy = "0.12.1"
+numpy = "0.13.1"
 rand = "0.8"
 rand_pcg = "0.3"
 rayon = "1.5"
 
 [dependencies.pyo3]
-version = "0.12.3"
+version = "0.13.0"
 features = ["extension-module", "hashbrown"]
 
 [dependencies.hashbrown]
 version = "0.9"
 features = ["rayon"]
 
 [dependencies.ndarray]
-version = "^0.13.0"
+version = "^0.13.1"
 features = ["rayon"]
 
 [profile.release]
 lto = 'fat'
 codegen-units = 1
```

### Comparing `retworkx-0.8.0/PKG-INFO` & `retworkx-0.9.0/PKG-INFO`

 * *Files 15% similar despite different names*

```diff
@@ -1,29 +1,30 @@
 Metadata-Version: 2.1
 Name: retworkx
-Version: 0.8.0
+Version: 0.9.0
 Summary: A python graph library implemented in Rust
 Home-page: https://github.com/Qiskit/retworkx
 Author: Matthew Treinish
 Author-email: mtreinish@kortar.org
 License: Apache 2.0
 Project-URL: Bug Tracker, https://github.com/Qiskit/retworkx/issues
 Project-URL: Source Code, https://github.com/Qiskit/retworkx
-Project-URL: Documentation, https://retworkx.readthedocs.io
+Project-URL: Documentation, https://qiskit.org/documentation/retworkx
 Description: # retworkx
         
         [![License](https://img.shields.io/github/license/Qiskit/retworkx.svg?style=popout-square)](https://opensource.org/licenses/Apache-2.0)
-        [![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/master.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
+        ![Build Status](https://github.com/Qiskit/retworkx/actions/workflows/main.yml/badge.svg?branch=main)
+        [![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/main.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
         [![](https://img.shields.io/github/release/Qiskit/retworkx.svg?style=popout-square)](https://github.com/Qiskit/retworkx/releases)
         [![](https://img.shields.io/pypi/dm/retworkx.svg?style=popout-square)](https://pypi.org/project/retworkx/)
-        [![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=master)](https://coveralls.io/github/Qiskit/retworkx?branch=master)
-        [![Minimum rustc 1.39](https://img.shields.io/badge/rustc-1.39+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
+        [![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=main)](https://coveralls.io/github/Qiskit/retworkx?branch=main)
+        [![Minimum rustc 1.41.1](https://img.shields.io/badge/rustc-1.41.1+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
         
           - You can see the full rendered docs at:
-            <https://retworkx.readthedocs.io/en/latest/index.html>
+            <https://qiskit.org/documentation/retworkx>
         
         retworkx is a general purpose graph library for python3 written in Rust to
         take advantage of the performance and safety that Rust provides. It was built
         as a replacement for [qiskit](https://qiskit.org/)'s previous (and current)
         networkx usage (hence the name) but is designed to provide a high
         performance general purpose graph library for any python application. The
         project was originally started to build a faster directed graph to use as the
@@ -44,29 +45,48 @@
         This will install a precompiled version of retworkx into your python
         environment.
         
         ### Installing on a platform without precompiled binaries
         
         If there are no precompiled binaries published for your system you'll have to
         build the package from source. However, to be able able to build the package
-        from the published source package you need to have rust >=1.39 installed (and
+        from the published source package you need to have rust >=1.41.1 installed (and
         also [cargo](https://doc.rust-lang.org/cargo/) which is normally included with
         rust) You can use [rustup](https://rustup.rs/) (a cross platform installer for
         rust) to make this simpler, or rely on
         [other installation methods](https://forge.rust-lang.org/infra/other-installation-methods.html).
         A source package is also published on pypi, so you still can also run the above
         `pip` command to install it. Once you have rust properly installed, running:
         
         ```bash
         pip install retworkx
         ```
         
         will build retworkx for your local system from the source package and install
         it just as it would if there was a prebuilt binary available.
         
+        ### Optional dependencies
+        
+        If you're planning to use the `retworkx.visualization` module you will need to
+        install optional dependencies to use the functions. The matplotlib based drawer
+        function `retworkx.visualization.mpl_draw` requires that the
+        [matplotlib](https://matplotlib.org/) library is installed. This can be
+        installed with `pip install matplotlib` or when you're installing retworkx with
+        `pip install 'retworkx[mpl]'`. If you're going to use the graphviz based drawer
+        function `retworkx.visualization.graphviz_drawer` first you will need to install
+        graphviz, instructions for this can be found here:
+        https://graphviz.org/download/#executable-packages. Then you
+        will need to install the [pydot](https://pypi.org/project/pydot/) and
+        [pillow](https://python-pillow.org/) Python libraries. This can be done either
+        with `pip install pydot pillow` or when installing retworkx with
+        `pip install 'retworkx[graphviz]'`.
+        
+        If you would like to install all the optional Python dependencies when you
+        install retworkx you can use `pip install 'retworkx[all]'` to do this.
+        
         ## Building from source
         
         The first step for building retworkx from source is to clone it locally
         with:
         
         ```bash
         git clone https://github.com/Qiskit/retworkx.git
@@ -146,7 +166,10 @@
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Operating System :: MacOS :: MacOS X
 Classifier: Operating System :: Microsoft :: Windows
 Classifier: Operating System :: POSIX :: Linux
 Requires-Python: >=3.6
 Description-Content-Type: text/markdown
+Provides-Extra: mpl
+Provides-Extra: graphviz
+Provides-Extra: all
```

### Comparing `retworkx-0.8.0/README.md` & `retworkx-0.9.0/README.md`

 * *Files 22% similar despite different names*

```diff
@@ -1,18 +1,19 @@
 # retworkx
 
 [![License](https://img.shields.io/github/license/Qiskit/retworkx.svg?style=popout-square)](https://opensource.org/licenses/Apache-2.0)
-[![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/master.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
+![Build Status](https://github.com/Qiskit/retworkx/actions/workflows/main.yml/badge.svg?branch=main)
+[![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/main.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
 [![](https://img.shields.io/github/release/Qiskit/retworkx.svg?style=popout-square)](https://github.com/Qiskit/retworkx/releases)
 [![](https://img.shields.io/pypi/dm/retworkx.svg?style=popout-square)](https://pypi.org/project/retworkx/)
-[![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=master)](https://coveralls.io/github/Qiskit/retworkx?branch=master)
-[![Minimum rustc 1.39](https://img.shields.io/badge/rustc-1.39+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
+[![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=main)](https://coveralls.io/github/Qiskit/retworkx?branch=main)
+[![Minimum rustc 1.41.1](https://img.shields.io/badge/rustc-1.41.1+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
 
   - You can see the full rendered docs at:
-    <https://retworkx.readthedocs.io/en/latest/index.html>
+    <https://qiskit.org/documentation/retworkx>
 
 retworkx is a general purpose graph library for python3 written in Rust to
 take advantage of the performance and safety that Rust provides. It was built
 as a replacement for [qiskit](https://qiskit.org/)'s previous (and current)
 networkx usage (hence the name) but is designed to provide a high
 performance general purpose graph library for any python application. The
 project was originally started to build a faster directed graph to use as the
@@ -33,29 +34,48 @@
 This will install a precompiled version of retworkx into your python
 environment.
 
 ### Installing on a platform without precompiled binaries
 
 If there are no precompiled binaries published for your system you'll have to
 build the package from source. However, to be able able to build the package
-from the published source package you need to have rust >=1.39 installed (and
+from the published source package you need to have rust >=1.41.1 installed (and
 also [cargo](https://doc.rust-lang.org/cargo/) which is normally included with
 rust) You can use [rustup](https://rustup.rs/) (a cross platform installer for
 rust) to make this simpler, or rely on
 [other installation methods](https://forge.rust-lang.org/infra/other-installation-methods.html).
 A source package is also published on pypi, so you still can also run the above
 `pip` command to install it. Once you have rust properly installed, running:
 
 ```bash
 pip install retworkx
 ```
 
 will build retworkx for your local system from the source package and install
 it just as it would if there was a prebuilt binary available.
 
+### Optional dependencies
+
+If you're planning to use the `retworkx.visualization` module you will need to
+install optional dependencies to use the functions. The matplotlib based drawer
+function `retworkx.visualization.mpl_draw` requires that the
+[matplotlib](https://matplotlib.org/) library is installed. This can be
+installed with `pip install matplotlib` or when you're installing retworkx with
+`pip install 'retworkx[mpl]'`. If you're going to use the graphviz based drawer
+function `retworkx.visualization.graphviz_drawer` first you will need to install
+graphviz, instructions for this can be found here:
+https://graphviz.org/download/#executable-packages. Then you
+will need to install the [pydot](https://pypi.org/project/pydot/) and
+[pillow](https://python-pillow.org/) Python libraries. This can be done either
+with `pip install pydot pillow` or when installing retworkx with
+`pip install 'retworkx[graphviz]'`.
+
+If you would like to install all the optional Python dependencies when you
+install retworkx you can use `pip install 'retworkx[all]'` to do this.
+
 ## Building from source
 
 The first step for building retworkx from source is to clone it locally
 with:
 
 ```bash
 git clone https://github.com/Qiskit/retworkx.git
```

### Comparing `retworkx-0.8.0/retworkx.egg-info/PKG-INFO` & `retworkx-0.9.0/retworkx.egg-info/PKG-INFO`

 * *Files 15% similar despite different names*

```diff
@@ -1,29 +1,30 @@
 Metadata-Version: 2.1
 Name: retworkx
-Version: 0.8.0
+Version: 0.9.0
 Summary: A python graph library implemented in Rust
 Home-page: https://github.com/Qiskit/retworkx
 Author: Matthew Treinish
 Author-email: mtreinish@kortar.org
 License: Apache 2.0
 Project-URL: Bug Tracker, https://github.com/Qiskit/retworkx/issues
 Project-URL: Source Code, https://github.com/Qiskit/retworkx
-Project-URL: Documentation, https://retworkx.readthedocs.io
+Project-URL: Documentation, https://qiskit.org/documentation/retworkx
 Description: # retworkx
         
         [![License](https://img.shields.io/github/license/Qiskit/retworkx.svg?style=popout-square)](https://opensource.org/licenses/Apache-2.0)
-        [![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/master.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
+        ![Build Status](https://github.com/Qiskit/retworkx/actions/workflows/main.yml/badge.svg?branch=main)
+        [![Build Status](https://img.shields.io/travis/com/Qiskit/retworkx/main.svg?style=popout-square)](https://travis-ci.com/Qiskit/retworkx)
         [![](https://img.shields.io/github/release/Qiskit/retworkx.svg?style=popout-square)](https://github.com/Qiskit/retworkx/releases)
         [![](https://img.shields.io/pypi/dm/retworkx.svg?style=popout-square)](https://pypi.org/project/retworkx/)
-        [![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=master)](https://coveralls.io/github/Qiskit/retworkx?branch=master)
-        [![Minimum rustc 1.39](https://img.shields.io/badge/rustc-1.39+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
+        [![Coverage Status](https://coveralls.io/repos/github/Qiskit/retworkx/badge.svg?branch=main)](https://coveralls.io/github/Qiskit/retworkx?branch=main)
+        [![Minimum rustc 1.41.1](https://img.shields.io/badge/rustc-1.41.1+-blue.svg)](https://rust-lang.github.io/rfcs/2495-min-rust-version.html)
         
           - You can see the full rendered docs at:
-            <https://retworkx.readthedocs.io/en/latest/index.html>
+            <https://qiskit.org/documentation/retworkx>
         
         retworkx is a general purpose graph library for python3 written in Rust to
         take advantage of the performance and safety that Rust provides. It was built
         as a replacement for [qiskit](https://qiskit.org/)'s previous (and current)
         networkx usage (hence the name) but is designed to provide a high
         performance general purpose graph library for any python application. The
         project was originally started to build a faster directed graph to use as the
@@ -44,29 +45,48 @@
         This will install a precompiled version of retworkx into your python
         environment.
         
         ### Installing on a platform without precompiled binaries
         
         If there are no precompiled binaries published for your system you'll have to
         build the package from source. However, to be able able to build the package
-        from the published source package you need to have rust >=1.39 installed (and
+        from the published source package you need to have rust >=1.41.1 installed (and
         also [cargo](https://doc.rust-lang.org/cargo/) which is normally included with
         rust) You can use [rustup](https://rustup.rs/) (a cross platform installer for
         rust) to make this simpler, or rely on
         [other installation methods](https://forge.rust-lang.org/infra/other-installation-methods.html).
         A source package is also published on pypi, so you still can also run the above
         `pip` command to install it. Once you have rust properly installed, running:
         
         ```bash
         pip install retworkx
         ```
         
         will build retworkx for your local system from the source package and install
         it just as it would if there was a prebuilt binary available.
         
+        ### Optional dependencies
+        
+        If you're planning to use the `retworkx.visualization` module you will need to
+        install optional dependencies to use the functions. The matplotlib based drawer
+        function `retworkx.visualization.mpl_draw` requires that the
+        [matplotlib](https://matplotlib.org/) library is installed. This can be
+        installed with `pip install matplotlib` or when you're installing retworkx with
+        `pip install 'retworkx[mpl]'`. If you're going to use the graphviz based drawer
+        function `retworkx.visualization.graphviz_drawer` first you will need to install
+        graphviz, instructions for this can be found here:
+        https://graphviz.org/download/#executable-packages. Then you
+        will need to install the [pydot](https://pypi.org/project/pydot/) and
+        [pillow](https://python-pillow.org/) Python libraries. This can be done either
+        with `pip install pydot pillow` or when installing retworkx with
+        `pip install 'retworkx[graphviz]'`.
+        
+        If you would like to install all the optional Python dependencies when you
+        install retworkx you can use `pip install 'retworkx[all]'` to do this.
+        
         ## Building from source
         
         The first step for building retworkx from source is to clone it locally
         with:
         
         ```bash
         git clone https://github.com/Qiskit/retworkx.git
@@ -146,7 +166,10 @@
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Operating System :: MacOS :: MacOS X
 Classifier: Operating System :: Microsoft :: Windows
 Classifier: Operating System :: POSIX :: Linux
 Requires-Python: >=3.6
 Description-Content-Type: text/markdown
+Provides-Extra: mpl
+Provides-Extra: graphviz
+Provides-Extra: all
```

### Comparing `retworkx-0.8.0/setup.py` & `retworkx-0.9.0/setup.py`

 * *Files 7% similar despite different names*

```diff
@@ -11,17 +11,21 @@
 
 
 def readme():
     with open('README.md') as f:
         return f.read()
 
 
+mpl_extras = ['matplotlib>=3.0']
+graphviz_extras = ['pydot>=1.4', 'pillow>=5.4']
+
+
 setup(
     name="retworkx",
-    version="0.8.0",
+    version="0.9.0",
     description="A python graph library implemented in Rust",
     long_description=readme(),
     long_description_content_type='text/markdown',
     author="Matthew Treinish",
     author_email="mtreinish@kortar.org",
     license="Apache 2.0",
     classifiers=[
@@ -39,17 +43,22 @@
         "Operating System :: POSIX :: Linux",
     ],
     keywords="Networks network graph Graph Theory DAG",
     url="https://github.com/Qiskit/retworkx",
     project_urls={
         "Bug Tracker": "https://github.com/Qiskit/retworkx/issues",
         "Source Code": "https://github.com/Qiskit/retworkx",
-        "Documentation": "https://retworkx.readthedocs.io",
+        "Documentation": "https://qiskit.org/documentation/retworkx",
     },
     rust_extensions=[RustExtension("retworkx.retworkx", "Cargo.toml",
                                    binding=Binding.PyO3)],
     include_package_data=True,
-    packages=["retworkx"],
+    packages=["retworkx", "retworkx.visualization"],
     zip_safe=False,
     python_requires=">=3.6",
     install_requires=['numpy>=1.16.0'],
+    extras_require={
+        'mpl': mpl_extras,
+        'graphviz': graphviz_extras,
+        'all': mpl_extras + graphviz_extras,
+    }
 )
```

### Comparing `retworkx-0.8.0/src/astar.rs` & `retworkx-0.9.0/src/astar.rs`

 * *Files identical despite different names*

### Comparing `retworkx-0.8.0/src/digraph.rs` & `retworkx-0.9.0/src/digraph.rs`

 * *Files 3% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 // under the License.
 
 use std::cmp;
 use std::cmp::Ordering;
 use std::collections::BTreeMap;
 use std::fs::File;
 use std::io::prelude::*;
-use std::io::BufReader;
+use std::io::{BufReader, BufWriter};
 use std::ops::{Index, IndexMut};
 use std::str;
 
 use hashbrown::{HashMap, HashSet};
 
 use pyo3::class::PyMappingProtocol;
 use pyo3::exceptions::PyIndexError;
@@ -42,28 +42,32 @@
     GetAdjacencyMatrix, GraphBase, GraphProp, IntoEdgeReferences, IntoEdges,
     IntoEdgesDirected, IntoNeighbors, IntoNeighborsDirected,
     IntoNodeIdentifiers, IntoNodeReferences, NodeCompactIndexable, NodeCount,
     NodeFiltered, NodeIndexable, Visitable,
 };
 
 use super::dot_utils::build_dot;
-use super::iterators::{EdgeList, NodeIndices, WeightedEdgeList};
+use super::iterators::{
+    EdgeIndexMap, EdgeIndices, EdgeList, NodeIndices, WeightedEdgeList,
+};
 use super::{
     is_directed_acyclic_graph, DAGHasCycle, DAGWouldCycle, NoEdgeBetweenNodes,
     NoSuitableNeighbors, NodesRemoved,
 };
 
 /// A class for creating directed graphs
 ///
-/// The PyDiGraph class is used to create a directed graph. It can be a
+/// The ``PyDiGraph`` class is used to create a directed graph. It can be a
 /// multigraph (have multiple edges between nodes). Each node and edge
-/// (although rarely used for edges) is indexed by an integer id. Additionally
-/// each node and edge contains an arbitrary Python object as a weight/data
-/// payload. You can use the index for access to the data payload as in the
-/// following example:
+/// (although rarely used for edges) is indexed by an integer id. These ids
+/// are stable for the lifetime of the graph object and on node or edge
+/// deletions you can have holes in the list of indices for the graph.
+/// Additionally, each node and edge contains an arbitrary Python object as a
+/// weight/data payload. You can use the index for access to the data payload
+/// as in the following example:
 ///
 /// .. jupyter-execute::
 ///
 ///     import retworkx
 ///
 ///     graph = retworkx.PyDiGraph()
 ///     data_payload = "An arbitrary Python object"
@@ -106,16 +110,37 @@
 /// :meth:`~PyDiGraph.add_edge`, :meth:`~PyDiGraph.add_edges_from`,
 /// :meth:`~PyDiGraph.add_edges_from_no_data`,
 /// :meth:`~PyDiGraph.extend_from_edge_list`,  and
 /// :meth:`~PyDiGraph.extend_from_weighted_edge_list` comes with a performance
 /// penalty that grows as the graph does. If you're adding a node and edge at
 /// the same time leveraging :meth:`PyDiGraph.add_child` or
 /// :meth:`PyDiGraph.add_parent` will avoid this overhead.
+///
+/// By default a ``PyDiGraph`` is a multigraph (meaning there can be parallel
+/// edges between nodes) however this can be disabled by setting the
+/// ``multigraph`` kwarg to ``False`` when calling the ``PyDiGraph``
+/// constructor. For example::
+///
+///     import retworkx
+///     graph = retworkx.PyDiGraph(multigraph=False)
+///
+/// This can only be set at ``PyDiGraph`` initialization and not adjusted after
+/// creation. When :attr:`~retworkx.PyDiGraph.multigraph` is set to ``False``
+/// if a method call is made that would add a parallel edge it will instead
+/// update the existing edge's weight/data payload.
+///
+/// :param bool check_cycle: When this is set to ``True`` the created
+///     ``PyDiGraph`` has runtime cycle detection enabled.
+/// :param bool multgraph: When this is set to ``False`` the created
+///     ``PyDiGraph`` object will not be a multigraph. When ``False`` if a
+///     method call is made that would add parallel edges the the weight/weight
+///     from that method call will be used to update the existing edge in place.
 #[pyclass(module = "retworkx", subclass, gc)]
 #[text_signature = "(/, check_cycle=False, multigraph=True)"]
+#[derive(Clone)]
 pub struct PyDiGraph {
     pub graph: StableDiGraph<PyObject, PyObject>,
     pub cycle_state: algo::DfsSpace<
         NodeIndex,
         <StableDiGraph<PyObject, PyObject> as Visitable>::Map,
     >,
     pub check_cycle: bool,
@@ -517,26 +542,50 @@
     /// If set to ``False`` multiple edges between nodes are not allowed and
     /// calls that would add a parallel edge will instead update the existing
     /// edge
     #[getter]
     fn multigraph(&self) -> bool {
         self.multigraph
     }
+
+    /// Return the number of nodes in the graph
+    #[text_signature = "(self)"]
+    pub fn num_nodes(&self) -> usize {
+        self.graph.node_count()
+    }
+
+    /// Return the number of edges in the graph
+    #[text_signature = "(self)"]
+    pub fn num_edges(&self) -> usize {
+        self.graph.edge_count()
+    }
+
     /// Return a list of all edge data.
     ///
     /// :returns: A list of all the edge data objects in the graph
     /// :rtype: list
     #[text_signature = "(self)"]
     pub fn edges(&self) -> Vec<&PyObject> {
         self.graph
             .edge_indices()
             .map(|edge| self.graph.edge_weight(edge).unwrap())
             .collect()
     }
 
+    /// Return a list of all edge indices.
+    ///
+    /// :returns: A list of all the edge indices in the graph
+    /// :rtype: EdgeIndices
+    #[text_signature = "(self)"]
+    pub fn edge_indices(&self) -> EdgeIndices {
+        EdgeIndices {
+            edges: self.graph.edge_indices().map(|edge| edge.index()).collect(),
+        }
+    }
+
     /// Return a list of all node data.
     ///
     /// :returns: A list of all the node data objects in the graph
     /// :rtype: list
     #[text_signature = "(self)"]
     pub fn nodes(&self) -> Vec<&PyObject> {
         self.graph
@@ -612,14 +661,106 @@
                 predec.push(self.graph.node_weight(pred).unwrap());
                 used_indexes.insert(pred);
             }
         }
         predec
     }
 
+    /// Return a filtered list of successors data such that each
+    /// node has at least one edge data which matches the filter.
+    ///
+    /// :param int node: The index for the node to get the successors for
+    ///
+    /// :param filter_fn: The filter function to use for matching nodes. It takes
+    ///     in one argument, the edge data payload/weight object, and will return a
+    ///     boolean whether the edge matches the conditions or not. If any edge returns
+    ///     ``True``, the node will be included.
+    ///
+    /// :returns: A list of the node data for all the child neighbor nodes
+    ///           whose at least one edge matches the filter
+    /// :rtype: list
+    #[text_signature = "(self, node, filter_fn/)"]
+    pub fn find_successors_by_edge(
+        &self,
+        py: Python,
+        node: usize,
+        filter_fn: PyObject,
+    ) -> PyResult<Vec<&PyObject>> {
+        let index = NodeIndex::new(node);
+        let mut succesors: Vec<&PyObject> = Vec::new();
+        let mut used_indexes: HashSet<NodeIndex> = HashSet::new();
+
+        let filter_edge = |edge: &PyObject| -> PyResult<bool> {
+            let res = filter_fn.call1(py, (edge,))?;
+            res.extract(py)
+        };
+
+        let raw_edges = self
+            .graph
+            .edges_directed(index, petgraph::Direction::Outgoing);
+
+        for edge in raw_edges {
+            let succ = edge.target();
+            if !used_indexes.contains(&succ) {
+                let edge_weight = edge.weight();
+                if filter_edge(edge_weight)? {
+                    used_indexes.insert(succ);
+                    succesors.push(self.graph.node_weight(succ).unwrap());
+                }
+            }
+        }
+        Ok(succesors)
+    }
+
+    /// Return a filtered list of predecessor data such that each
+    /// node has at least one edge data which matches the filter.
+    ///
+    /// :param int node: The index for the node to get the predecessor for
+    ///
+    /// :param filter_fn: The filter function to use for matching nodes. It takes
+    ///     in one argument, the edge data payload/weight object, and will return a
+    ///     boolean whether the edge matches the conditions or not. If any edge returns
+    ///     ``True``, the node will be included.
+    ///
+    /// :returns: A list of the node data for all the parent neighbor nodes
+    ///           whose at least one edge matches the filter
+    /// :rtype: list
+    #[text_signature = "(self, node, filter_fn/)"]
+    pub fn find_predecessors_by_edge(
+        &self,
+        py: Python,
+        node: usize,
+        filter_fn: PyObject,
+    ) -> PyResult<Vec<&PyObject>> {
+        let index = NodeIndex::new(node);
+        let mut predec: Vec<&PyObject> = Vec::new();
+        let mut used_indexes: HashSet<NodeIndex> = HashSet::new();
+
+        let filter_edge = |edge: &PyObject| -> PyResult<bool> {
+            let res = filter_fn.call1(py, (edge,))?;
+            res.extract(py)
+        };
+
+        let raw_edges = self
+            .graph
+            .edges_directed(index, petgraph::Direction::Incoming);
+
+        for edge in raw_edges {
+            let pred = edge.source();
+            if !used_indexes.contains(&pred) {
+                let edge_weight = edge.weight();
+                if filter_edge(edge_weight)? {
+                    used_indexes.insert(pred);
+                    predec.push(self.graph.node_weight(pred).unwrap());
+                }
+            }
+        }
+        Ok(predec)
+    }
+
     /// Return the edge data for an edge between 2 nodes.
     ///
     /// :param int node_a: The index for the first node
     /// :param int node_b: The index for the second node
     ///
     /// :returns: The data object set for the edge
     /// :raises NoEdgeBetweenNodes: When there is no edge between nodes
@@ -781,14 +922,41 @@
                         edge.weight().clone_ref(py),
                     )
                 })
                 .collect(),
         }
     }
 
+    /// Get an edge index map
+    ///
+    /// Returns a read only mapping from edge indices to the weighted edge
+    /// tuple. The return is a mapping of the form:
+    /// ``{0: (0, 1, "weight"), 1: (2, 3, 2.3)}``
+    ///
+    /// :returns: An edge index map
+    /// :rtype: EdgeIndexMap
+    #[text_signature = "(self)"]
+    pub fn edge_index_map(&self, py: Python) -> EdgeIndexMap {
+        EdgeIndexMap {
+            edge_map: self
+                .edge_references()
+                .map(|edge| {
+                    (
+                        edge.id().index(),
+                        (
+                            edge.source().index(),
+                            edge.target().index(),
+                            edge.weight().clone_ref(py),
+                        ),
+                    )
+                })
+                .collect(),
+        }
+    }
+
     /// Remove a node from the graph.
     ///
     /// :param int node: The index of the node to remove. If the index is not
     ///     present in the graph it will be ignored and this function will have
     ///     no effect.
     #[text_signature = "(self, node, /)"]
     pub fn remove_node(&mut self, node: usize) -> PyResult<()> {
@@ -1445,15 +1613,15 @@
     /// a node
     ///
     /// :param int node: The index of the node to get the successors of
     ///
     /// :returns: A list of the neighbor node indicies
     /// :rtype: NodeIndices
     #[text_signature = "(self, node, /)"]
-    pub fn successor_indices(&mut self, node: usize) -> NodeIndices {
+    pub fn successor_indices(&self, node: usize) -> NodeIndices {
         NodeIndices {
             nodes: self
                 .graph
                 .neighbors_directed(
                     NodeIndex::new(node),
                     petgraph::Direction::Outgoing,
                 )
@@ -1468,15 +1636,15 @@
     /// a node
     ///
     /// :param int node: The index of the node to get the predecessors of
     ///
     /// :returns: A list of the neighbor node indicies
     /// :rtype: NodeIndices
     #[text_signature = "(self, node, /)"]
-    pub fn predecessor_indices(&mut self, node: usize) -> NodeIndices {
+    pub fn predecessor_indices(&self, node: usize) -> NodeIndices {
         NodeIndices {
             nodes: self
                 .graph
                 .neighbors_directed(
                     NodeIndex::new(node),
                     petgraph::Direction::Incoming,
                 )
@@ -1681,24 +1849,31 @@
         &self,
         py: Python,
         node_attr: Option<PyObject>,
         edge_attr: Option<PyObject>,
         graph_attr: Option<BTreeMap<String, String>>,
         filename: Option<String>,
     ) -> PyResult<Option<PyObject>> {
-        if filename.is_some() {
-            let mut file = File::create(filename.unwrap())?;
-            build_dot(py, self, &mut file, graph_attr, node_attr, edge_attr)?;
-            Ok(None)
-        } else {
-            let mut file = Vec::<u8>::new();
-            build_dot(py, self, &mut file, graph_attr, node_attr, edge_attr)?;
-            Ok(Some(
-                PyString::new(py, str::from_utf8(&file)?).to_object(py),
-            ))
+        match filename {
+            Some(filename) => {
+                let mut file = File::create(filename)?;
+                build_dot(
+                    py, self, &mut file, graph_attr, node_attr, edge_attr,
+                )?;
+                Ok(None)
+            }
+            None => {
+                let mut file = Vec::<u8>::new();
+                build_dot(
+                    py, self, &mut file, graph_attr, node_attr, edge_attr,
+                )?;
+                Ok(Some(
+                    PyString::new(py, str::from_utf8(&file)?).to_object(py),
+                ))
+            }
         }
     }
 
     /// Read an edge list file and create a new PyDiGraph object from the
     /// contents
     ///
     /// The expected format for the edge list file is a line seperated list
@@ -1711,42 +1886,29 @@
     /// :param str deliminator: Optional character to use as a deliminator by
     ///     default any whitespace will be used
     ///
     /// For example:
     ///
     /// .. jupyter-execute::
     ///
-    ///   import os
     ///   import tempfile
     ///
-    ///   from PIL import Image
-    ///   import pydot
-    ///
     ///   import retworkx
-    ///
+    ///   from retworkx.visualization import mpl_draw
     ///
     ///   with tempfile.NamedTemporaryFile('wt') as fd:
     ///       path = fd.name
     ///       fd.write('0 1\n')
     ///       fd.write('0 2\n')
     ///       fd.write('0 3\n')
     ///       fd.write('1 2\n')
     ///       fd.write('2 3\n')
     ///       fd.flush()
     ///       graph = retworkx.PyDiGraph.read_edge_list(path)
-    ///
-    ///   # Draw graph
-    ///   dot = pydot.graph_from_dot_data(graph.to_dot())[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(graph)
     ///
     #[staticmethod]
     #[text_signature = "(path, /, comment=None, deliminator=None)"]
     pub fn read_edge_list(
         py: Python,
         path: &str,
         comment: Option<String>,
@@ -1805,14 +1967,87 @@
             cycle_state: algo::DfsSpace::default(),
             check_cycle: false,
             node_removed: false,
             multigraph: true,
         })
     }
 
+    /// Write an edge list file from the PyDiGraph object
+    ///
+    /// :param str path: The path to write the output file to
+    /// :param str deliminator: The optional character to use as a deliminator
+    ///     if not specified ``" "`` is used.
+    /// :param callable weight_fn: An optional callback function that will be
+    ///     passed an edge's data payload/weight object and is expected to
+    ///     return a string (a ``TypeError`` will be raised if it doesn't
+    ///     return a string). If specified the weight in the output file
+    ///     for each edge will be set to the returned string.
+    ///
+    ///  For example:
+    ///
+    ///  .. jupyter-execute::
+    ///
+    ///     import os
+    ///     import tempfile
+    ///
+    ///     import retworkx
+    ///
+    ///     graph = retworkx.generators.directed_path_graph(5)
+    ///     path = os.path.join(tempfile.gettempdir(), "edge_list")
+    ///     graph.write_edge_list(path, deliminator=',')
+    ///     # Print file contents
+    ///     with open(path, 'rt') as edge_file:
+    ///         print(edge_file.read())
+    ///
+    #[text_signature = "(self, path, /, deliminator=None, weight_fn=None)"]
+    pub fn write_edge_list(
+        &self,
+        py: Python,
+        path: &str,
+        deliminator: Option<char>,
+        weight_fn: Option<PyObject>,
+    ) -> PyResult<()> {
+        let file = File::create(path)?;
+        let mut buf_writer = BufWriter::new(file);
+        let delim = match deliminator {
+            Some(delim) => delim.to_string(),
+            None => " ".to_string(),
+        };
+
+        let weight_callable = |value: &PyObject,
+                               weight_fn: &Option<PyObject>|
+         -> PyResult<Option<String>> {
+            match weight_fn {
+                Some(weight_fn) => {
+                    let res = weight_fn.call1(py, (value,))?;
+                    Ok(Some(res.extract(py)?))
+                }
+                None => Ok(None),
+            }
+        };
+        for edge in self.graph.edge_references() {
+            buf_writer.write_all(
+                format!(
+                    "{}{}{}",
+                    edge.source().index(),
+                    delim,
+                    edge.target().index()
+                )
+                .as_bytes(),
+            )?;
+            match weight_callable(edge.weight(), &weight_fn)? {
+                Some(weight) => buf_writer
+                    .write_all(format!("{}{}\n", delim, weight).as_bytes()),
+                None => buf_writer.write_all(b"\n"),
+            }?;
+        }
+        buf_writer.flush()?;
+        Ok(())
+    }
+
     /// Create a new :class:`~retworkx.PyDiGraph` object from an adjacency matrix
     ///
     /// This method can be used to construct a new :class:`~retworkx.PyDiGraph`
     /// object from an input adjacency matrix. The node weights will be the
     /// index from the matrix. The edge weights will be a float value of the
     /// value from the matrix.
     ///
@@ -1889,76 +2124,41 @@
     ///     combined
     /// :rtype: dict
     ///
     /// For example, start by building a graph:
     ///
     /// .. jupyter-execute::
     ///
-    ///   import os
-    ///   import tempfile
-    ///
-    ///   import pydot
-    ///   from PIL import Image
-    ///
     ///   import retworkx
+    ///   from retworkx.visualization import mpl_draw
     ///
     ///   # Build first graph and visualize:
     ///   graph = retworkx.PyDiGraph()
     ///   node_a = graph.add_node('A')
     ///   node_b = graph.add_child(node_a, 'B', 'A to B')
     ///   node_c = graph.add_child(node_b, 'C', 'B to C')
-    ///   dot_str = graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(graph, with_labels=True, labels=str, edge_labels=str)
     ///
     /// Then build a second one:
     ///
     /// .. jupyter-execute::
     ///
     ///   # Build second graph and visualize:
     ///   other_graph = retworkx.PyDiGraph()
     ///   node_d = other_graph.add_node('D')
     ///   other_graph.add_child(node_d, 'E', 'D to E')
-    ///   dot_str = other_graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'other_graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(other_graph, with_labels=True, labels=str, edge_labels=str)
     ///
     /// Finally compose the ``other_graph`` onto ``graph``
     ///
     /// .. jupyter-execute::
     ///
     ///   node_map = {node_b: (node_d, 'B to D')}
     ///   graph.compose(other_graph, node_map)
-    ///   dot_str = graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'combined_graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(graph, with_labels=True, labels=str, edge_labels=str)
     ///
     #[text_signature = "(self, other, node_map, /, node_map_func=None, edge_map_func=None)"]
     pub fn compose(
         &mut self,
         py: Python,
         other: &PyDiGraph,
         node_map: HashMap<usize, (usize, PyObject)>,
@@ -2099,14 +2299,23 @@
         }
         crate::graph::PyGraph {
             graph: new_graph,
             node_removed: false,
             multigraph: true,
         }
     }
+
+    /// Return a shallow copy of the graph
+    ///
+    /// All node and edge weight/data payloads in the copy will have a
+    /// shared reference to the original graph.
+    #[text_signature = "(self)"]
+    pub fn copy(&self) -> PyDiGraph {
+        self.clone()
+    }
 }
 
 #[pyproto]
 impl PyMappingProtocol for PyDiGraph {
     /// Return the number of nodes in the graph
     fn __len__(&self) -> PyResult<usize> {
         Ok(self.graph.node_count())
```

### Comparing `retworkx-0.8.0/src/dijkstra.rs` & `retworkx-0.9.0/src/dijkstra.rs`

 * *Files identical despite different names*

### Comparing `retworkx-0.8.0/src/dot_utils.rs` & `retworkx-0.9.0/src/dot_utils.rs`

 * *Files identical despite different names*

### Comparing `retworkx-0.8.0/src/generators.rs` & `retworkx-0.9.0/src/generators.rs`

 * *Files 18% similar despite different names*

```diff
@@ -11,14 +11,15 @@
 // under the License.
 
 use std::iter;
 
 use petgraph::algo;
 use petgraph::graph::NodeIndex;
 use petgraph::stable_graph::{StableDiGraph, StableUnGraph};
+use petgraph::visit::{EdgeRef, IntoEdgeReferences};
 
 use pyo3::exceptions::PyIndexError;
 use pyo3::prelude::*;
 use pyo3::wrap_pyfunction;
 use pyo3::Python;
 
 use super::digraph;
@@ -38,49 +39,39 @@
 ///     weights will be None if this is specified. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param list weights: A list of node weights, the first element in the list
 ///     will be the center node of the cycle graph. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param bool bidirectional: Adds edges in both directions between two nodes
 ///     if set to ``True``. Default value is ``False``
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
 ///
 /// :returns: The generated cycle graph
 /// :rtype: PyDiGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_cycle_graph(5)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
-#[pyfunction(bidirectional = "false")]
-#[text_signature = "(/, num_nodes=None, weights=None, bidirectional=False)"]
+#[pyfunction(bidirectional = "false", multigraph = "true")]
+#[text_signature = "(/, num_nodes=None, weights=None, bidirectional=False, multigraph=True)"]
 pub fn directed_cycle_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
     bidirectional: bool,
+    multigraph: bool,
 ) -> PyResult<digraph::PyDiGraph> {
     let mut graph = StableDiGraph::<PyObject, PyObject>::default();
     if weights.is_none() && num_nodes.is_none() {
         return Err(PyIndexError::new_err(
             "num_nodes and weights list not specified",
         ));
     }
@@ -120,15 +111,15 @@
         graph.add_edge(first_node_index, last_node_index, py.None());
     }
     Ok(digraph::PyDiGraph {
         graph,
         node_removed: false,
         check_cycle: false,
         cycle_state: algo::DfsSpace::default(),
-        multigraph: true,
+        multigraph,
     })
 }
 
 /// Generate an undirected cycle graph
 ///
 /// :param int num_node: The number of nodes to generate the graph with. Node
 ///     weights will be None if this is specified. If both ``num_node`` and
@@ -143,34 +134,19 @@
 ///
 /// :returns: The generated cycle graph
 /// :rtype: PyGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.cycle_graph(5)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 #[pyfunction(multigraph = true)]
 #[text_signature = "(/, num_nodes=None, weights=None, multigraph=True)"]
 pub fn cycle_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
@@ -222,49 +198,39 @@
 ///     weights will be None if this is specified. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param list weights: A list of node weights, the first element in the list
 ///     will be the center node of the path graph. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param bool bidirectional: Adds edges in both directions between two nodes
 ///     if set to ``True``. Default value is ``False``
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
 ///
 /// :returns: The generated path graph
 /// :rtype: PyDiGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_path_graph(10)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
-#[pyfunction(bidirectional = "false")]
-#[text_signature = "(/, num_nodes=None, weights=None, bidirectional=False)"]
+#[pyfunction(bidirectional = "false", multigraph = "true")]
+#[text_signature = "(/, num_nodes=None, weights=None, bidirectional=False, multigraph=True)"]
 pub fn directed_path_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
     bidirectional: bool,
+    multigraph: bool,
 ) -> PyResult<digraph::PyDiGraph> {
     let mut graph = StableDiGraph::<PyObject, PyObject>::default();
     if weights.is_none() && num_nodes.is_none() {
         return Err(PyIndexError::new_err(
             "num_nodes and weights list not specified",
         ));
     }
@@ -280,30 +246,28 @@
         None => (0..num_nodes.unwrap())
             .map(|_| graph.add_node(py.None()))
             .collect(),
     };
     for (node_a, node_b) in pairwise(nodes) {
         match node_a {
             Some(node_a) => {
+                graph.add_edge(node_a, node_b, py.None());
                 if bidirectional {
-                    graph.add_edge(node_a, node_b, py.None());
                     graph.add_edge(node_b, node_a, py.None());
-                } else {
-                    graph.add_edge(node_a, node_b, py.None());
                 }
             }
             None => continue,
         };
     }
     Ok(digraph::PyDiGraph {
         graph,
         node_removed: false,
         check_cycle: false,
         cycle_state: algo::DfsSpace::default(),
-        multigraph: true,
+        multigraph,
     })
 }
 
 /// Generate an undirected path graph
 ///
 /// :param int num_node: The number of nodes to generate the graph with. Node
 ///     weights will be None if this is specified. If both ``num_node`` and
@@ -318,34 +282,19 @@
 ///
 /// :returns: The generated path graph
 /// :rtype: PyGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.path_graph(10)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 #[pyfunction(multigraph = true)]
 #[text_signature = "(/, num_nodes=None, weights=None, multigraph=True)"]
 pub fn path_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
@@ -392,73 +341,48 @@
 ///     will be the center node of the star graph. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param bool bidirectional: Adds edges in both directions between two nodes
 ///     if set to ``True``. Default value is ``False``.
 /// :param bool inward: If set ``True`` the nodes will be directed towards the
 ///     center node. This parameter is ignored if ``bidirectional`` is set to
 ///     ``True``.
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
 ///
 /// :returns: The generated star graph
 /// :rtype: PyDiGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_star_graph(10)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_star_graph(10, inward=True)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
-#[pyfunction(inward = "false", bidirectional = "false")]
-#[text_signature = "(/, num_nodes=None, weights=None, inward=False, bidirectional=False)"]
+#[pyfunction(inward = "false", bidirectional = "false", multigraph = "true")]
+#[text_signature = "(/, num_nodes=None, weights=None, inward=False, bidirectional=False, multigraph=True)"]
 pub fn directed_star_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
     inward: bool,
     bidirectional: bool,
+    multigraph: bool,
 ) -> PyResult<digraph::PyDiGraph> {
     let mut graph = StableDiGraph::<PyObject, PyObject>::default();
     if weights.is_none() && num_nodes.is_none() {
         return Err(PyIndexError::new_err(
             "num_nodes and weights list not specified",
         ));
     }
@@ -487,15 +411,15 @@
         }
     }
     Ok(digraph::PyDiGraph {
         graph,
         node_removed: false,
         check_cycle: false,
         cycle_state: algo::DfsSpace::default(),
-        multigraph: true,
+        multigraph,
     })
 }
 
 /// Generate an undirected star graph
 ///
 /// :param int num_node: The number of nodes to generate the graph with. Node
 ///     weights will be None if this is specified. If both ``num_node`` and
@@ -510,34 +434,19 @@
 ///
 /// :returns: The generated star graph
 /// :rtype: PyGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.star_graph(10)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 #[pyfunction(multigraph = true)]
 #[text_signature = "(/, num_nodes=None, weights=None, multigraph=True)"]
 pub fn star_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
@@ -586,34 +495,19 @@
 ///
 /// :returns: The generated mesh graph
 /// :rtype: PyGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.mesh_graph(4)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 #[pyfunction(multigraph = true)]
 #[text_signature = "(/, num_nodes=None, weights=None, multigraph=True)"]
 pub fn mesh_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
@@ -655,48 +549,38 @@
 /// Generate a directed mesh graph where every node is connected to every other
 ///
 /// :param int num_node: The number of nodes to generate the graph with. Node
 ///     weights will be None if this is specified. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
 /// :param list weights: A list of node weights. If both ``num_node`` and
 ///     ``weights`` are set this will be ignored and ``weights`` will be used.
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
 ///
 /// :returns: The generated mesh graph
 /// :rtype: PyDiGraph
 /// :raises IndexError: If neither ``num_nodes`` or ``weights`` are specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_mesh_graph(4)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
-#[pyfunction]
-#[text_signature = "(/, num_nodes=None, weights=None)"]
+#[pyfunction(multigraph = "true")]
+#[text_signature = "(/, num_nodes=None, weights=None, multigraph=True)"]
 pub fn directed_mesh_graph(
     py: Python,
     num_nodes: Option<usize>,
     weights: Option<Vec<PyObject>>,
+    multigraph: bool,
 ) -> PyResult<digraph::PyDiGraph> {
     let mut graph = StableDiGraph::<PyObject, PyObject>::default();
     if weights.is_none() && num_nodes.is_none() {
         return Err(PyIndexError::new_err(
             "num_nodes and weights list not specified",
         ));
     }
@@ -721,15 +605,15 @@
         }
     }
     Ok(digraph::PyDiGraph {
         graph,
         node_removed: false,
         check_cycle: false,
         cycle_state: algo::DfsSpace::default(),
-        multigraph: true,
+        multigraph,
     })
 }
 
 /// Generate an undirected grid graph.
 ///
 /// :param int rows: The number of rows to generate the graph with.
 ///     If specified, cols also need to be specified
@@ -751,34 +635,19 @@
 /// :returns: The generated grid graph
 /// :rtype: PyGraph
 /// :raises IndexError: If neither ``rows`` or ``cols`` and ``weights`` are
 ///      specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.grid_graph(2, 3)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
 #[pyfunction(multigraph = true)]
 #[text_signature = "(/, rows=None, cols=None, weights=None, multigraph=True)"]
 pub fn grid_graph(
     py: Python,
     rows: Option<usize>,
     cols: Option<usize>,
@@ -862,51 +731,41 @@
 ///     all the values in weights list is created.
 ///     If number of nodes(rows*cols) is less than length of
 ///     weights list, the trailing weights are ignored.
 ///     If number of nodes(rows*cols) is greater than length of
 ///     weights list, extra nodes with None weight are appended.
 /// :param bidirectional: A parameter to indicate if edges should exist in
 ///     both directions between nodes
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
 ///
 /// :returns: The generated grid graph
 /// :rtype: PyDiGraph
 /// :raises IndexError: If neither ``rows`` or ``cols`` and ``weights`` are
 ///      specified
 ///
 /// .. jupyter-execute::
 ///
-///   import os
-///   import tempfile
-///
-///   import pydot
-///   from PIL import Image
-///
 ///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
 ///
 ///   graph = retworkx.generators.directed_grid_graph(2, 3)
-///   dot_str = graph.to_dot(
-///       lambda node: dict(
-///           color='black', fillcolor='lightblue', style='filled'))
-///   dot = pydot.graph_from_dot_data(dot_str)[0]
-///
-///   with tempfile.TemporaryDirectory() as tmpdirname:
-///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-///       dot.write_png(tmp_path)
-///       image = Image.open(tmp_path)
-///       os.remove(tmp_path)
-///   image
+///   mpl_draw(graph)
 ///
-#[pyfunction(bidirectional = "false")]
-#[text_signature = "(/, rows=None, cols=None, weights=None, bidirectional=False)"]
+#[pyfunction(bidirectional = "false", multigraph = "true")]
+#[text_signature = "(/, rows=None, cols=None, weights=None, bidirectional=False, multigraph=True)"]
 pub fn directed_grid_graph(
     py: Python,
     rows: Option<usize>,
     cols: Option<usize>,
     weights: Option<Vec<PyObject>>,
     bidirectional: bool,
+    multigraph: bool,
 ) -> PyResult<digraph::PyDiGraph> {
     let mut graph = StableDiGraph::<PyObject, PyObject>::default();
     if weights.is_none() && (rows.is_none() || cols.is_none()) {
         return Err(PyIndexError::new_err(
             "dimensions and weights list not specified",
         ));
     }
@@ -977,15 +836,416 @@
         }
     }
     Ok(digraph::PyDiGraph {
         graph,
         node_removed: false,
         check_cycle: false,
         cycle_state: algo::DfsSpace::default(),
-        multigraph: true,
+        multigraph,
+    })
+}
+
+/// Generate an undirected binomial tree of order n recursively.
+///
+/// :param int order: Order of the binomial tree.
+/// :param list weights: A list of node weights. If the number of weights is
+///     less than 2**order extra nodes with with None will be appended.
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyGraph` object will not be not be a multigraph and
+///     won't  allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
+///
+/// :returns: A binomial tree with 2^n vertices and 2^n - 1 edges.
+/// :rtype: PyGraph
+/// :raises IndexError: If the lenght of ``weights`` is greater that 2^n
+///
+/// .. jupyter-execute::
+///
+///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
+///
+///   graph = retworkx.generators.binomial_tree_graph(4)
+///   mpl_draw(graph)
+///
+#[pyfunction(multigraph = true)]
+#[text_signature = "(order, /, weights=None, multigraph=True)"]
+pub fn binomial_tree_graph(
+    py: Python,
+    order: u32,
+    weights: Option<Vec<PyObject>>,
+    multigraph: bool,
+) -> PyResult<graph::PyGraph> {
+    let mut graph = StableUnGraph::<PyObject, PyObject>::default();
+
+    let num_nodes = usize::pow(2, order);
+
+    let nodes: Vec<NodeIndex> = match weights {
+        Some(weights) => {
+            let mut node_list: Vec<NodeIndex> = Vec::new();
+
+            let mut node_count = num_nodes;
+
+            if weights.len() > num_nodes {
+                return Err(PyIndexError::new_err(
+                    "weights should be <= 2**order",
+                ));
+            }
+
+            for weight in weights {
+                let index = graph.add_node(weight);
+                node_list.push(index);
+                node_count -= 1;
+            }
+
+            for _i in 0..node_count {
+                let index = graph.add_node(py.None());
+                node_list.push(index);
+            }
+
+            node_list
+        }
+
+        None => (0..num_nodes).map(|_| graph.add_node(py.None())).collect(),
+    };
+
+    let mut n = 1;
+
+    for _ in 0..order {
+        let edges: Vec<(NodeIndex, NodeIndex)> = graph
+            .edge_references()
+            .map(|e| (e.source(), e.target()))
+            .collect();
+
+        for (source, target) in edges {
+            let source_index = source.index();
+            let target_index = target.index();
+
+            graph.add_edge(
+                nodes[source_index + n],
+                nodes[target_index + n],
+                py.None(),
+            );
+        }
+
+        graph.add_edge(nodes[0], nodes[n], py.None());
+
+        n *= 2;
+    }
+
+    Ok(graph::PyGraph {
+        graph,
+        node_removed: false,
+        multigraph,
+    })
+}
+
+/// Generate an undirected binomial tree of order n recursively.
+/// The edges propagate towards right and bottom direction if ``bidirectional`` is ``false``
+///
+/// :param int order: Order of the binomial tree.
+/// :param list weights: A list of node weights. If the number of weights is
+///     less than 2**order extra nodes with None will be appended.
+/// :param bidirectional: A parameter to indicate if edges should exist in
+///     both directions between nodes
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
+///
+/// :returns: A directed binomial tree with 2^n vertices and 2^n - 1 edges.
+/// :rtype: PyDiGraph
+/// :raises IndexError: If the lenght of ``weights`` is greater that 2^n
+///
+/// .. jupyter-execute::
+///
+///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
+///
+///   graph = retworkx.generators.directed_binomial_tree_graph(4)
+///   mpl_draw(graph)
+///
+#[pyfunction(bidirectional = "false", multigraph = "true")]
+#[text_signature = "(order, /,  weights=None, bidirectional=False, multigraph=True)"]
+pub fn directed_binomial_tree_graph(
+    py: Python,
+    order: u32,
+    weights: Option<Vec<PyObject>>,
+    bidirectional: bool,
+    multigraph: bool,
+) -> PyResult<digraph::PyDiGraph> {
+    let mut graph = StableDiGraph::<PyObject, PyObject>::default();
+
+    let num_nodes = usize::pow(2, order);
+
+    let nodes: Vec<NodeIndex> = match weights {
+        Some(weights) => {
+            let mut node_list: Vec<NodeIndex> = Vec::new();
+            let mut node_count = num_nodes;
+
+            if weights.len() > num_nodes {
+                return Err(PyIndexError::new_err(
+                    "weights should be <= 2**order",
+                ));
+            }
+
+            for weight in weights {
+                let index = graph.add_node(weight);
+                node_list.push(index);
+                node_count -= 1;
+            }
+
+            for _i in 0..node_count {
+                let index = graph.add_node(py.None());
+                node_list.push(index);
+            }
+
+            node_list
+        }
+
+        None => (0..num_nodes).map(|_| graph.add_node(py.None())).collect(),
+    };
+
+    let mut n = 1;
+
+    for _ in 0..order {
+        let edges: Vec<(NodeIndex, NodeIndex)> = graph
+            .edge_references()
+            .map(|e| (e.source(), e.target()))
+            .collect();
+
+        for (source, target) in edges {
+            let source_index = source.index();
+            let target_index = target.index();
+
+            if graph
+                .find_edge(nodes[source_index + n], nodes[target_index + n])
+                .is_none()
+            {
+                graph.add_edge(
+                    nodes[source_index + n],
+                    nodes[target_index + n],
+                    py.None(),
+                );
+            }
+
+            if bidirectional
+                && graph
+                    .find_edge(nodes[target_index + n], nodes[source_index + n])
+                    .is_none()
+            {
+                graph.add_edge(
+                    nodes[target_index + n],
+                    nodes[source_index + n],
+                    py.None(),
+                );
+            }
+        }
+
+        if graph.find_edge(nodes[0], nodes[n]).is_none() {
+            graph.add_edge(nodes[0], nodes[n], py.None());
+        }
+
+        if bidirectional && graph.find_edge(nodes[n], nodes[0]).is_none() {
+            graph.add_edge(nodes[n], nodes[0], py.None());
+        }
+
+        n *= 2;
+    }
+
+    Ok(digraph::PyDiGraph {
+        graph,
+        node_removed: false,
+        check_cycle: false,
+        cycle_state: algo::DfsSpace::default(),
+        multigraph,
+    })
+}
+
+/// Generate an undirected hexagonal lattice graph.
+///
+/// :param int rows: The number of rows to generate the graph with.
+/// :param int cols: The number of columns to generate the graph with.
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyGraph` object will not be not be a multigraph and
+///     won't  allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
+///
+/// :returns: The generated hexagonal lattice graph with the following nodes deleted:
+///           ```2*row + 1``` and
+///           ```(col) * (2*row + 2) + (2*row + 1) * ((col) % 2)```
+///
+/// :rtype: PyGraph
+/// :raises IndexError: If neither ``rows`` or ``cols`` are
+///      specified
+///
+/// .. jupyter-execute::
+///
+///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
+///
+///   graph = retworkx.generators.hexagonal_lattice_graph(2, 2)
+///   mpl_draw(graph)
+///
+#[pyfunction(multigraph = true)]
+#[text_signature = "(/, rows=None, cols=None, multigraph=True)"]
+pub fn hexagonal_lattice_graph(
+    py: Python,
+    rows: usize,
+    cols: usize,
+    multigraph: bool,
+) -> PyResult<graph::PyGraph> {
+    let mut graph = StableUnGraph::<PyObject, PyObject>::default();
+
+    let mut rowlen = rows;
+    let mut collen = cols;
+
+    // Needs two times the number of nodes vertically
+    rowlen = 2 * rowlen + 2;
+    collen += 1;
+    let num_nodes = rowlen * collen;
+
+    let nodes: Vec<NodeIndex> =
+        (0..num_nodes).map(|_| graph.add_node(py.None())).collect();
+
+    // Add column edges
+    for i in 0..collen {
+        for j in 0..(rowlen - 1) {
+            graph.add_edge(
+                nodes[i * rowlen + j],
+                nodes[i * rowlen + (j + 1)],
+                py.None(),
+            );
+        }
+    }
+
+    // Add row edges
+    for i in 0..(collen - 1) {
+        for j in 0..rowlen {
+            if i % 2 == j % 2 {
+                graph.add_edge(
+                    nodes[i * rowlen + j],
+                    nodes[(i + 1) * rowlen + j],
+                    py.None(),
+                );
+            }
+        }
+    }
+
+    // Remove corner nodes
+    graph.remove_node(nodes[rowlen - 1]);
+    graph.remove_node(
+        nodes[(collen - 1) * rowlen + (rowlen - 1) * ((collen - 1) % 2)],
+    );
+
+    Ok(graph::PyGraph {
+        graph,
+        node_removed: true,
+        multigraph,
+    })
+}
+
+/// Generate a directed hexagonal lattice graph. The edges propagate towards  
+///     right and bottom direction if ``bidirectional`` is ``false``
+///
+/// :param int rows: The number of rows to generate the graph with.
+/// :param int cols: The number of rows to generate the graph with.
+/// :param bidirectional: A parameter to indicate if edges should exist in
+///     both directions between nodes
+/// :param bool multigraph: When set to False the output
+///     :class:`~retworkx.PyDiGraph` object will not be not be a multigraph and
+///     won't allow parallel edges to be added. Instead
+///     calls which would create a parallel edge will update the existing edge.
+///
+/// :returns: The generated directed hexagonal lattice graph with the following nodes deleted:
+///           ```2*row + 1``` and
+///           ```(col) * (2*row + 2) + (2*row + 1) * ((col) % 2)```
+///
+/// :rtype: PyDiGraph
+/// :raises IndexError: If neither ``rows`` or ``cols`` are
+///      specified
+///
+/// .. jupyter-execute::
+///
+///   import retworkx.generators
+///   from retworkx.visualization import mpl_draw
+///
+///   graph = retworkx.generators.directed_hexagonal_lattice_graph(2, 3)
+///   mpl_draw(graph)
+///
+#[pyfunction(bidirectional = "false", multigraph = "true")]
+#[text_signature = "(/, rows=None, cols=None, bidirectional=False, multigraph=True)"]
+pub fn directed_hexagonal_lattice_graph(
+    py: Python,
+    rows: usize,
+    cols: usize,
+    bidirectional: bool,
+    multigraph: bool,
+) -> PyResult<digraph::PyDiGraph> {
+    let mut graph = StableDiGraph::<PyObject, PyObject>::default();
+
+    let mut rowlen = rows;
+    let mut collen = cols;
+    // Needs two times the number of nodes vertically
+    rowlen = 2 * rowlen + 2;
+    collen += 1;
+    let num_nodes = rowlen * collen;
+
+    let nodes: Vec<NodeIndex> =
+        (0..num_nodes).map(|_| graph.add_node(py.None())).collect();
+
+    // Add column edges
+    for i in 0..collen {
+        for j in 0..(rowlen - 1) {
+            graph.add_edge(
+                nodes[i * rowlen + j],
+                nodes[i * rowlen + (j + 1)],
+                py.None(),
+            );
+            if bidirectional {
+                graph.add_edge(
+                    nodes[i * rowlen + (j + 1)],
+                    nodes[i * rowlen + j],
+                    py.None(),
+                );
+            }
+        }
+    }
+
+    // Add row edges
+    for i in 0..(collen - 1) {
+        for j in 0..rowlen {
+            if i % 2 == j % 2 {
+                graph.add_edge(
+                    nodes[i * rowlen + j],
+                    nodes[(i + 1) * rowlen + j],
+                    py.None(),
+                );
+                if bidirectional {
+                    graph.add_edge(
+                        nodes[(i + 1) * rowlen + j],
+                        nodes[i * rowlen + j],
+                        py.None(),
+                    );
+                }
+            }
+        }
+    }
+
+    // Remove corner nodes
+    graph.remove_node(nodes[rowlen - 1]);
+    graph.remove_node(
+        nodes[(collen - 1) * rowlen + (rowlen - 1) * ((collen - 1) % 2)],
+    );
+
+    Ok(digraph::PyDiGraph {
+        graph,
+        node_removed: true,
+        check_cycle: false,
+        cycle_state: algo::DfsSpace::default(),
+        multigraph,
     })
 }
 
 #[pymodule]
 pub fn generators(_py: Python, m: &PyModule) -> PyResult<()> {
     m.add_wrapped(wrap_pyfunction!(cycle_graph))?;
     m.add_wrapped(wrap_pyfunction!(directed_cycle_graph))?;
@@ -993,9 +1253,13 @@
     m.add_wrapped(wrap_pyfunction!(directed_path_graph))?;
     m.add_wrapped(wrap_pyfunction!(star_graph))?;
     m.add_wrapped(wrap_pyfunction!(directed_star_graph))?;
     m.add_wrapped(wrap_pyfunction!(mesh_graph))?;
     m.add_wrapped(wrap_pyfunction!(directed_mesh_graph))?;
     m.add_wrapped(wrap_pyfunction!(grid_graph))?;
     m.add_wrapped(wrap_pyfunction!(directed_grid_graph))?;
+    m.add_wrapped(wrap_pyfunction!(binomial_tree_graph))?;
+    m.add_wrapped(wrap_pyfunction!(directed_binomial_tree_graph))?;
+    m.add_wrapped(wrap_pyfunction!(hexagonal_lattice_graph))?;
+    m.add_wrapped(wrap_pyfunction!(directed_hexagonal_lattice_graph))?;
     Ok(())
 }
```

### Comparing `retworkx-0.8.0/src/graph.rs` & `retworkx-0.9.0/src/graph.rs`

 * *Files 8% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 // License for the specific language governing permissions and limitations
 // under the License.
 
 use std::cmp;
 use std::collections::BTreeMap;
 use std::fs::File;
 use std::io::prelude::*;
-use std::io::BufReader;
+use std::io::{BufReader, BufWriter};
 use std::ops::{Index, IndexMut};
 use std::str;
 
 use hashbrown::{HashMap, HashSet};
 
 use pyo3::class::PyMappingProtocol;
 use pyo3::exceptions::PyIndexError;
@@ -28,15 +28,17 @@
 use pyo3::PyTraverseError;
 use pyo3::Python;
 
 use ndarray::prelude::*;
 use numpy::PyReadonlyArray2;
 
 use super::dot_utils::build_dot;
-use super::iterators::{EdgeList, NodeIndices, WeightedEdgeList};
+use super::iterators::{
+    EdgeIndexMap, EdgeIndices, EdgeList, NodeIndices, WeightedEdgeList,
+};
 use super::{NoEdgeBetweenNodes, NodesRemoved};
 
 use petgraph::graph::{EdgeIndex, NodeIndex};
 use petgraph::prelude::*;
 use petgraph::stable_graph::StableUnGraph;
 use petgraph::visit::{
     GetAdjacencyMatrix, GraphBase, GraphProp, IntoEdgeReferences, IntoEdges,
@@ -45,18 +47,20 @@
     NodeIndexable, Visitable,
 };
 
 /// A class for creating undirected graphs
 ///
 /// The PyGraph class is used to create an undirected graph. It can be a
 /// multigraph (have multiple edges between nodes). Each node and edge
-/// (although rarely used for edges) is indexed by an integer id. Additionally,
-/// each node and edge contains an arbitrary Python object as a weight/data
-/// payload. You can use the index for access to the data payload as in the
-/// following example:
+/// (although rarely used for edges) is indexed by an integer id. These ids
+/// are stable for the lifetime of the graph object and on node or edge
+/// deletions you can have holes in the list of indices for the graph.
+/// Additionally, each node and edge contains an arbitrary Python object as a
+/// weight/data payload. You can use the index for access to the data payload
+/// as in the following example:
 ///
 /// .. jupyter-execute::
 ///
 ///     import retworkx
 ///
 ///     graph = retworkx.PyGraph()
 ///     data_payload = "An arbitrary Python object"
@@ -74,22 +78,34 @@
 ///     graph = retworkx.PyGraph()
 ///     data_payload = "An arbitrary Python object"
 ///     node_index = graph.add_node(data_payload)
 ///     graph[node_index] = "New Payload"
 ///     print("Node Index: %s" % node_index)
 ///     print(graph[node_index])
 ///
+/// By default a ``PyGraph`` is a multigraph (meaning there can be parallel
+/// edges between nodes) however this can be disabled by setting the
+/// ``multigraph`` kwarg to ``False`` when calling the ``PyGraph``
+/// constructor. For example::
+///
+///     import retworkx
+///     graph = retworkx.PyGraph(multigraph=False)
+///
+/// This can only be set at ``PyGraph`` initialization and not adjusted after
+/// creation. When :attr:`~retworkx.PyGraph.multigraph` is set to ``False``
+/// if a method call is made that would add a parallel edge it will instead
+/// update the existing edge's weight/data payload.
 ///
 /// :param bool multigraph: When this is set to ``False`` the created PyGraph
-///     object will not be a multigraph (which is the default behavior). When
-///     ``False`` if parallel edges are added the weight/weight from that
+///     object will not be a multigraph. When ``False`` if a method call is
+///     made that would add parallel edges the the weight/weight from that
 ///     method call will be used to update the existing edge in place.
-///
 #[pyclass(module = "retworkx", subclass, gc)]
 #[text_signature = "(/, multigraph=True)"]
+#[derive(Clone)]
 pub struct PyGraph {
     pub graph: StableUnGraph<PyObject, PyObject>,
     pub node_removed: bool,
     pub multigraph: bool,
 }
 
 pub type Edges<'a, E> =
@@ -365,26 +381,49 @@
     /// calls that would add a parallel edge will instead update the existing
     /// edge
     #[getter]
     fn multigraph(&self) -> bool {
         self.multigraph
     }
 
+    /// Return the number of nodes in the graph
+    #[text_signature = "(self)"]
+    pub fn num_nodes(&self) -> usize {
+        self.graph.node_count()
+    }
+
+    /// Return the number of edges in the graph
+    #[text_signature = "(self)"]
+    pub fn num_edges(&self) -> usize {
+        self.graph.edge_count()
+    }
+
     /// Return a list of all edge data.
     ///
     /// :returns: A list of all the edge data objects in the graph
     /// :rtype: list
     #[text_signature = "(self)"]
     pub fn edges(&self) -> Vec<&PyObject> {
         self.graph
             .edge_indices()
             .map(|edge| self.graph.edge_weight(edge).unwrap())
             .collect()
     }
 
+    /// Return a list of all edge indices.
+    ///
+    /// :returns: A list of all the edge indices in the graph
+    /// :rtype: EdgeIndices
+    #[text_signature = "(self)"]
+    pub fn edge_indices(&self) -> EdgeIndices {
+        EdgeIndices {
+            edges: self.graph.edge_indices().map(|edge| edge.index()).collect(),
+        }
+    }
+
     /// Return a list of all node data.
     ///
     /// :returns: A list of all the node data objects in the graph
     /// :rtype: list
     #[text_signature = "(self)"]
     pub fn nodes(&self) -> Vec<&PyObject> {
         self.graph
@@ -589,14 +628,41 @@
                         edge.weight().clone_ref(py),
                     )
                 })
                 .collect(),
         }
     }
 
+    /// Get an edge index map
+    ///
+    /// Returns a read only mapping from edge indices to the weighted edge
+    /// tuple. The return is a mapping of the form:
+    /// ``{0: (0, 1, "weight"), 1: (2, 3, 2.3)}``
+    ///
+    /// :returns: An edge index map
+    /// :rtype: EdgeIndexMap
+    #[text_signature = "(self)"]
+    pub fn edge_index_map(&self, py: Python) -> EdgeIndexMap {
+        EdgeIndexMap {
+            edge_map: self
+                .edge_references()
+                .map(|edge| {
+                    (
+                        edge.id().index(),
+                        (
+                            edge.source().index(),
+                            edge.target().index(),
+                            edge.weight().clone_ref(py),
+                        ),
+                    )
+                })
+                .collect(),
+        }
+    }
+
     /// Remove a node from the graph.
     ///
     /// :param int node: The index of the node to remove. If the index is not
     ///     present in the graph it will be ignored and this function will
     ///     have no effect.
     #[text_signature = "(self, node, /)"]
     pub fn remove_node(&mut self, node: usize) -> PyResult<()> {
@@ -1034,24 +1100,31 @@
         &self,
         py: Python,
         node_attr: Option<PyObject>,
         edge_attr: Option<PyObject>,
         graph_attr: Option<BTreeMap<String, String>>,
         filename: Option<String>,
     ) -> PyResult<Option<PyObject>> {
-        if filename.is_some() {
-            let mut file = File::create(filename.unwrap())?;
-            build_dot(py, self, &mut file, graph_attr, node_attr, edge_attr)?;
-            Ok(None)
-        } else {
-            let mut file = Vec::<u8>::new();
-            build_dot(py, self, &mut file, graph_attr, node_attr, edge_attr)?;
-            Ok(Some(
-                PyString::new(py, str::from_utf8(&file)?).to_object(py),
-            ))
+        match filename {
+            Some(filename) => {
+                let mut file = File::create(filename)?;
+                build_dot(
+                    py, self, &mut file, graph_attr, node_attr, edge_attr,
+                )?;
+                Ok(None)
+            }
+            None => {
+                let mut file = Vec::<u8>::new();
+                build_dot(
+                    py, self, &mut file, graph_attr, node_attr, edge_attr,
+                )?;
+                Ok(Some(
+                    PyString::new(py, str::from_utf8(&file)?).to_object(py),
+                ))
+            }
         }
     }
 
     /// Read an edge list file and create a new PyGraph object from the
     /// contents
     ///
     /// The expected format for the edge list file is a line seperated list
@@ -1064,42 +1137,29 @@
     /// :param str deliminator: Optional character to use as a deliminator by
     ///     default any whitespace will be used
     ///
     /// For example:
     ///
     /// .. jupyter-execute::
     ///
-    ///   import os
     ///   import tempfile
     ///
-    ///   from PIL import Image
-    ///   import pydot
-    ///
     ///   import retworkx
-    ///
+    ///   from retworkx.visualization import mpl_draw
     ///
     ///   with tempfile.NamedTemporaryFile('wt') as fd:
     ///       path = fd.name
     ///       fd.write('0 1\n')
     ///       fd.write('0 2\n')
     ///       fd.write('0 3\n')
     ///       fd.write('1 2\n')
     ///       fd.write('2 3\n')
     ///       fd.flush()
     ///       graph = retworkx.PyGraph.read_edge_list(path)
-    ///
-    ///   # Draw graph
-    ///   dot = pydot.graph_from_dot_data(graph.to_dot())[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'dag.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(graph)
     ///
     #[staticmethod]
     #[text_signature = "(path, /, comment=None, deliminator=None)"]
     pub fn read_edge_list(
         py: Python,
         path: &str,
         comment: Option<String>,
@@ -1156,14 +1216,87 @@
         Ok(PyGraph {
             graph: out_graph,
             node_removed: false,
             multigraph: true,
         })
     }
 
+    /// Write an edge list file from the PyGraph object
+    ///
+    /// :param str path: The path to write the output file to
+    /// :param str deliminator: The optional character to use as a deliminator
+    ///     if not specified ``" "`` is used.
+    /// :param callable weight_fn: An optional callback function that will be
+    ///     passed an edge's data payload/weight object and is expected to
+    ///     return a string (a ``TypeError`` will be raised if it doesn't
+    ///     return a string). If specified the weight in the output file
+    ///     for each edge will be set to the returned string.
+    ///
+    ///  For example:
+    ///
+    ///  .. jupyter-execute::
+    ///
+    ///     import os
+    ///     import tempfile
+    ///
+    ///     import retworkx
+    ///
+    ///     graph = retworkx.generators.path_graph(5)
+    ///     path = os.path.join(tempfile.gettempdir(), "edge_list")
+    ///     graph.write_edge_list(path, deliminator=',')
+    ///     # Print file contents
+    ///     with open(path, 'rt') as edge_file:
+    ///         print(edge_file.read())
+    ///
+    #[text_signature = "(self, path, /, deliminator=None, weight_fn=None)"]
+    pub fn write_edge_list(
+        &self,
+        py: Python,
+        path: &str,
+        deliminator: Option<char>,
+        weight_fn: Option<PyObject>,
+    ) -> PyResult<()> {
+        let file = File::create(path)?;
+        let mut buf_writer = BufWriter::new(file);
+        let delim = match deliminator {
+            Some(delim) => delim.to_string(),
+            None => " ".to_string(),
+        };
+
+        let weight_callable = |value: &PyObject,
+                               weight_fn: &Option<PyObject>|
+         -> PyResult<Option<String>> {
+            match weight_fn {
+                Some(weight_fn) => {
+                    let res = weight_fn.call1(py, (value,))?;
+                    Ok(Some(res.extract(py)?))
+                }
+                None => Ok(None),
+            }
+        };
+        for edge in self.graph.edge_references() {
+            buf_writer.write_all(
+                format!(
+                    "{}{}{}",
+                    edge.source().index(),
+                    delim,
+                    edge.target().index()
+                )
+                .as_bytes(),
+            )?;
+            match weight_callable(edge.weight(), &weight_fn)? {
+                Some(weight) => buf_writer
+                    .write_all(format!("{}{}\n", delim, weight).as_bytes()),
+                None => buf_writer.write_all(b"\n"),
+            }?;
+        }
+        buf_writer.flush()?;
+        Ok(())
+    }
+
     /// Create a new :class:`~retworkx.PyGraph` object from an adjacency matrix
     ///
     /// This method can be used to construct a new :class:`~retworkx.PyGraph`
     /// object from an input adjacency matrix. The node weights will be the
     /// index from the matrix. The edge weights will be a float value of the
     /// value from the matrix.
     ///
@@ -1246,68 +1379,40 @@
     ///   import os
     ///   import tempfile
     ///
     ///   import pydot
     ///   from PIL import Image
     ///
     ///   import retworkx
+    ///   from retworkx.visualization import mpl_draw
     ///
     ///   # Build first graph and visualize:
     ///   graph = retworkx.PyGraph()
     ///   node_a, node_b, node_c = graph.add_nodes_from(['A', 'B', 'C'])
-    ///   graph.add_edges_from_no_data([(node_a, node_b), (node_b, node_c)])
-    ///   dot_str = graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   graph.add_edges_from([(node_a, node_b, 'A to B'),
+    ///                         (node_b, node_c, 'B to C')])
+    ///   mpl_draw(graph, with_labels=True, labels=str, edge_labels=str)
     ///
     /// Then build a second one:
     ///
     /// .. jupyter-execute::
     ///
     ///   # Build second graph and visualize:
     ///   other_graph = retworkx.PyGraph()
     ///   node_d, node_e = other_graph.add_nodes_from(['D', 'E'])
-    ///   other_graph.add_edge(node_d, node_e, None)
-    ///   dot_str = other_graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'other_graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   other_graph.add_edge(node_d, node_e, 'D to E')
+    ///   mpl_draw(other_graph, with_labels=True, labels=str, edge_labels=str)
     ///
     /// Finally compose the ``other_graph`` onto ``graph``
     ///
     /// .. jupyter-execute::
     ///
     ///   node_map = {node_b: (node_d, 'B to D')}
     ///   graph.compose(other_graph, node_map)
-    ///   dot_str = graph.to_dot(
-    ///       lambda node: dict(
-    ///           color='black', fillcolor='lightblue', style='filled'))
-    ///   dot = pydot.graph_from_dot_data(dot_str)[0]
-    ///
-    ///   with tempfile.TemporaryDirectory() as tmpdirname:
-    ///       tmp_path = os.path.join(tmpdirname, 'combined_graph.png')
-    ///       dot.write_png(tmp_path)
-    ///       image = Image.open(tmp_path)
-    ///       os.remove(tmp_path)
-    ///   image
+    ///   mpl_draw(graph, with_labels=True, labels=str, edge_labels=str)
     ///
     #[text_signature = "(self, other, node_map, /, node_map_func=None, edge_map_func=None)"]
     pub fn compose(
         &mut self,
         py: Python,
         other: &PyGraph,
         node_map: HashMap<usize, (usize, PyObject)>,
@@ -1389,14 +1494,23 @@
         }
         PyGraph {
             graph: out_graph,
             node_removed: false,
             multigraph: self.multigraph,
         }
     }
+
+    /// Return a shallow copy of the graph
+    ///
+    /// All node and edge weight/data payloads in the copy will have a
+    /// shared reference to the original graph.
+    #[text_signature = "(self)"]
+    pub fn copy(&self) -> PyGraph {
+        self.clone()
+    }
 }
 
 #[pyproto]
 impl PyMappingProtocol for PyGraph {
     /// Return the nmber of nodes in the graph
     fn __len__(&self) -> PyResult<usize> {
         Ok(self.graph.node_count())
```

### Comparing `retworkx-0.8.0/src/k_shortest_path.rs` & `retworkx-0.9.0/src/k_shortest_path.rs`

 * *Files identical despite different names*

### Comparing `retworkx-0.8.0/src/lib.rs` & `retworkx-0.9.0/src/lib.rs`

 * *Files 22% similar despite different names*

```diff
@@ -28,6493 +28,10387 @@
 000001b0: 7072 6573 7320 6f72 2069 6d70 6c69 6564  press or implied
 000001c0: 2e20 5365 6520 7468 650a 2f2f 204c 6963  . See the.// Lic
 000001d0: 656e 7365 2066 6f72 2074 6865 2073 7065  ense for the spe
 000001e0: 6369 6669 6320 6c61 6e67 7561 6765 2067  cific language g
 000001f0: 6f76 6572 6e69 6e67 2070 6572 6d69 7373  overning permiss
 00000200: 696f 6e73 2061 6e64 206c 696d 6974 6174  ions and limitat
 00000210: 696f 6e73 0a2f 2f20 756e 6465 7220 7468  ions.// under th
-00000220: 6520 4c69 6365 6e73 652e 0a0a 6d6f 6420  e License...mod 
-00000230: 6173 7461 723b 0a6d 6f64 2064 6167 5f69  astar;.mod dag_i
-00000240: 736f 6d6f 7270 6869 736d 3b0a 6d6f 6420  somorphism;.mod 
-00000250: 6469 6772 6170 683b 0a6d 6f64 2064 696a  digraph;.mod dij
-00000260: 6b73 7472 613b 0a6d 6f64 2064 6f74 5f75  kstra;.mod dot_u
-00000270: 7469 6c73 3b0a 6d6f 6420 6765 6e65 7261  tils;.mod genera
-00000280: 746f 7273 3b0a 6d6f 6420 6772 6170 683b  tors;.mod graph;
-00000290: 0a6d 6f64 2069 7465 7261 746f 7273 3b0a  .mod iterators;.
-000002a0: 6d6f 6420 6b5f 7368 6f72 7465 7374 5f70  mod k_shortest_p
-000002b0: 6174 683b 0a6d 6f64 206d 6178 5f77 6569  ath;.mod max_wei
-000002c0: 6768 745f 6d61 7463 6869 6e67 3b0a 6d6f  ght_matching;.mo
-000002d0: 6420 756e 696f 6e3b 0a0a 7573 6520 7374  d union;..use st
-000002e0: 643a 3a63 6d70 3a3a 7b4f 7264 6572 696e  d::cmp::{Orderin
-000002f0: 672c 2052 6576 6572 7365 7d3b 0a75 7365  g, Reverse};.use
-00000300: 2073 7464 3a3a 636f 6c6c 6563 7469 6f6e   std::collection
-00000310: 733a 3a7b 4254 7265 6553 6574 2c20 4269  s::{BTreeSet, Bi
-00000320: 6e61 7279 4865 6170 7d3b 0a0a 7573 6520  naryHeap};..use 
-00000330: 6861 7368 6272 6f77 6e3a 3a7b 4861 7368  hashbrown::{Hash
-00000340: 4d61 702c 2048 6173 6853 6574 7d3b 0a0a  Map, HashSet};..
-00000350: 7573 6520 7079 6f33 3a3a 6372 6561 7465  use pyo3::create
-00000360: 5f65 7863 6570 7469 6f6e 3b0a 7573 6520  _exception;.use 
-00000370: 7079 6f33 3a3a 6578 6365 7074 696f 6e73  pyo3::exceptions
-00000380: 3a3a 7b50 7945 7863 6570 7469 6f6e 2c20  ::{PyException, 
-00000390: 5079 5661 6c75 6545 7272 6f72 7d3b 0a75  PyValueError};.u
-000003a0: 7365 2070 796f 333a 3a70 7265 6c75 6465  se pyo3::prelude
-000003b0: 3a3a 2a3b 0a75 7365 2070 796f 333a 3a74  ::*;.use pyo3::t
-000003c0: 7970 6573 3a3a 7b50 7944 6963 742c 2050  ypes::{PyDict, P
-000003d0: 794c 6973 747d 3b0a 7573 6520 7079 6f33  yList};.use pyo3
-000003e0: 3a3a 7772 6170 5f70 7966 756e 6374 696f  ::wrap_pyfunctio
-000003f0: 6e3b 0a75 7365 2070 796f 333a 3a77 7261  n;.use pyo3::wra
-00000400: 705f 7079 6d6f 6475 6c65 3b0a 7573 6520  p_pymodule;.use 
-00000410: 7079 6f33 3a3a 5079 7468 6f6e 3b0a 0a75  pyo3::Python;..u
-00000420: 7365 2070 6574 6772 6170 683a 3a61 6c67  se petgraph::alg
-00000430: 6f3b 0a75 7365 2070 6574 6772 6170 683a  o;.use petgraph:
-00000440: 3a67 7261 7068 3a3a 4e6f 6465 496e 6465  :graph::NodeInde
-00000450: 783b 0a75 7365 2070 6574 6772 6170 683a  x;.use petgraph:
-00000460: 3a70 7265 6c75 6465 3a3a 2a3b 0a75 7365  :prelude::*;.use
-00000470: 2070 6574 6772 6170 683a 3a76 6973 6974   petgraph::visit
-00000480: 3a3a 7b0a 2020 2020 4266 732c 2044 6174  ::{.    Bfs, Dat
-00000490: 612c 2047 7261 7068 4261 7365 2c20 4772  a, GraphBase, Gr
-000004a0: 6170 6850 726f 702c 2049 6e74 6f45 6467  aphProp, IntoEdg
-000004b0: 6552 6566 6572 656e 6365 732c 2049 6e74  eReferences, Int
-000004c0: 6f4e 6569 6768 626f 7273 2c0a 2020 2020  oNeighbors,.    
-000004d0: 496e 746f 4e6f 6465 4964 656e 7469 6669  IntoNodeIdentifi
-000004e0: 6572 732c 204e 6f64 6543 6f75 6e74 2c20  ers, NodeCount, 
-000004f0: 4e6f 6465 496e 6465 7861 626c 652c 2052  NodeIndexable, R
-00000500: 6576 6572 7365 642c 2056 6973 6974 4d61  eversed, VisitMa
-00000510: 702c 0a20 2020 2056 6973 6974 6162 6c65  p,.    Visitable
-00000520: 2c0a 7d3b 0a0a 7573 6520 6e64 6172 7261  ,.};..use ndarra
-00000530: 793a 3a70 7265 6c75 6465 3a3a 2a3b 0a75  y::prelude::*;.u
-00000540: 7365 206e 756d 7079 3a3a 496e 746f 5079  se numpy::IntoPy
-00000550: 4172 7261 793b 0a75 7365 2072 616e 643a  Array;.use rand:
-00000560: 3a64 6973 7472 6962 7574 696f 6e73 3a3a  :distributions::
-00000570: 7b44 6973 7472 6962 7574 696f 6e2c 2055  {Distribution, U
-00000580: 6e69 666f 726d 7d3b 0a75 7365 2072 616e  niform};.use ran
-00000590: 643a 3a70 7265 6c75 6465 3a3a 2a3b 0a75  d::prelude::*;.u
-000005a0: 7365 2072 616e 645f 7063 673a 3a50 6367  se rand_pcg::Pcg
-000005b0: 3634 3b0a 7573 6520 7261 796f 6e3a 3a70  64;.use rayon::p
-000005c0: 7265 6c75 6465 3a3a 2a3b 0a0a 7573 6520  relude::*;..use 
-000005d0: 6372 6174 653a 3a67 656e 6572 6174 6f72  crate::generator
-000005e0: 733a 3a50 7949 6e69 745f 6765 6e65 7261  s::PyInit_genera
-000005f0: 746f 7273 3b0a 7573 6520 6372 6174 653a  tors;.use crate:
-00000600: 3a69 7465 7261 746f 7273 3a3a 7b45 6467  :iterators::{Edg
-00000610: 654c 6973 742c 204e 6f64 6549 6e64 6963  eList, NodeIndic
-00000620: 6573 7d3b 0a0a 7472 6169 7420 4e6f 6465  es};..trait Node
-00000630: 7352 656d 6f76 6564 207b 0a20 2020 2066  sRemoved {.    f
-00000640: 6e20 6e6f 6465 735f 7265 6d6f 7665 6428  n nodes_removed(
-00000650: 2673 656c 6629 202d 3e20 626f 6f6c 3b0a  &self) -> bool;.
-00000660: 7d0a 0a66 6e20 6c6f 6e67 6573 745f 7061  }..fn longest_pa
-00000670: 7468 2867 7261 7068 3a20 2664 6967 7261  th(graph: &digra
-00000680: 7068 3a3a 5079 4469 4772 6170 6829 202d  ph::PyDiGraph) -
-00000690: 3e20 5079 5265 7375 6c74 3c56 6563 3c75  > PyResult<Vec<u
-000006a0: 7369 7a65 3e3e 207b 0a20 2020 206c 6574  size>> {.    let
-000006b0: 2064 6167 203d 2026 6772 6170 682e 6772   dag = &graph.gr
-000006c0: 6170 683b 0a20 2020 206c 6574 206d 7574  aph;.    let mut
-000006d0: 2070 6174 683a 2056 6563 3c75 7369 7a65   path: Vec<usize
-000006e0: 3e20 3d20 5665 633a 3a6e 6577 2829 3b0a  > = Vec::new();.
-000006f0: 2020 2020 6c65 7420 6e6f 6465 7320 3d20      let nodes = 
-00000700: 6d61 7463 6820 616c 676f 3a3a 746f 706f  match algo::topo
-00000710: 736f 7274 2867 7261 7068 2c20 4e6f 6e65  sort(graph, None
-00000720: 2920 7b0a 2020 2020 2020 2020 4f6b 286e  ) {.        Ok(n
-00000730: 6f64 6573 2920 3d3e 206e 6f64 6573 2c0a  odes) => nodes,.
-00000740: 2020 2020 2020 2020 4572 7228 5f65 7272          Err(_err
-00000750: 2920 3d3e 207b 0a20 2020 2020 2020 2020  ) => {.         
-00000760: 2020 2072 6574 7572 6e20 4572 7228 4441     return Err(DA
-00000770: 4748 6173 4379 636c 653a 3a6e 6577 5f65  GHasCycle::new_e
-00000780: 7272 2822 536f 7274 2065 6e63 6f75 6e74  rr("Sort encount
-00000790: 6572 6564 2061 2063 7963 6c65 2229 290a  ered a cycle")).
-000007a0: 2020 2020 2020 2020 7d0a 2020 2020 7d3b          }.    };
-000007b0: 0a20 2020 2069 6620 6e6f 6465 732e 6973  .    if nodes.is
-000007c0: 5f65 6d70 7479 2829 207b 0a20 2020 2020  _empty() {.     
-000007d0: 2020 2072 6574 7572 6e20 4f6b 2870 6174     return Ok(pat
-000007e0: 6829 3b0a 2020 2020 7d0a 2020 2020 6c65  h);.    }.    le
-000007f0: 7420 6d75 7420 6469 7374 3a20 4861 7368  t mut dist: Hash
-00000800: 4d61 703c 4e6f 6465 496e 6465 782c 2028  Map<NodeIndex, (
-00000810: 7573 697a 652c 204e 6f64 6549 6e64 6578  usize, NodeIndex
-00000820: 293e 203d 2048 6173 684d 6170 3a3a 6e65  )> = HashMap::ne
-00000830: 7728 293b 0a20 2020 2066 6f72 206e 6f64  w();.    for nod
-00000840: 6520 696e 206e 6f64 6573 207b 0a20 2020  e in nodes {.   
-00000850: 2020 2020 206c 6574 2070 6172 656e 7473       let parents
-00000860: 203d 0a20 2020 2020 2020 2020 2020 2064   =.            d
-00000870: 6167 2e6e 6569 6768 626f 7273 5f64 6972  ag.neighbors_dir
-00000880: 6563 7465 6428 6e6f 6465 2c20 7065 7467  ected(node, petg
-00000890: 7261 7068 3a3a 4469 7265 6374 696f 6e3a  raph::Direction:
-000008a0: 3a49 6e63 6f6d 696e 6729 3b0a 2020 2020  :Incoming);.    
-000008b0: 2020 2020 6c65 7420 6d75 7420 7573 3a20      let mut us: 
-000008c0: 5665 633c 2875 7369 7a65 2c20 4e6f 6465  Vec<(usize, Node
-000008d0: 496e 6465 7829 3e20 3d20 5665 633a 3a6e  Index)> = Vec::n
-000008e0: 6577 2829 3b0a 2020 2020 2020 2020 666f  ew();.        fo
-000008f0: 7220 705f 6e6f 6465 2069 6e20 7061 7265  r p_node in pare
-00000900: 6e74 7320 7b0a 2020 2020 2020 2020 2020  nts {.          
-00000910: 2020 6c65 7420 6c65 6e67 7468 203d 2064    let length = d
-00000920: 6973 745b 2670 5f6e 6f64 655d 2e30 202b  ist[&p_node].0 +
-00000930: 2031 3b0a 2020 2020 2020 2020 2020 2020   1;.            
-00000940: 7573 2e70 7573 6828 286c 656e 6774 682c  us.push((length,
-00000950: 2070 5f6e 6f64 6529 293b 0a20 2020 2020   p_node));.     
-00000960: 2020 207d 0a20 2020 2020 2020 206c 6574     }.        let
-00000970: 206d 6178 753a 2028 7573 697a 652c 204e   maxu: (usize, N
-00000980: 6f64 6549 6e64 6578 293b 0a20 2020 2020  odeIndex);.     
-00000990: 2020 2069 6620 2175 732e 6973 5f65 6d70     if !us.is_emp
-000009a0: 7479 2829 207b 0a20 2020 2020 2020 2020  ty() {.         
-000009b0: 2020 206d 6178 7520 3d20 2a75 732e 6974     maxu = *us.it
-000009c0: 6572 2829 2e6d 6178 5f62 795f 6b65 7928  er().max_by_key(
-000009d0: 7c78 7c20 782e 3029 2e75 6e77 7261 7028  |x| x.0).unwrap(
-000009e0: 293b 0a20 2020 2020 2020 207d 2065 6c73  );.        } els
-000009f0: 6520 7b0a 2020 2020 2020 2020 2020 2020  e {.            
-00000a00: 6d61 7875 203d 2028 302c 206e 6f64 6529  maxu = (0, node)
-00000a10: 3b0a 2020 2020 2020 2020 7d3b 0a20 2020  ;.        };.   
-00000a20: 2020 2020 2064 6973 742e 696e 7365 7274       dist.insert
-00000a30: 286e 6f64 652c 206d 6178 7529 3b0a 2020  (node, maxu);.  
-00000a40: 2020 7d0a 2020 2020 6c65 7420 6669 7273    }.    let firs
-00000a50: 7420 3d20 6d61 7463 6820 6469 7374 2e6b  t = match dist.k
-00000a60: 6579 7328 292e 6d61 785f 6279 5f6b 6579  eys().max_by_key
-00000a70: 287c 696e 6465 787c 2064 6973 745b 696e  (|index| dist[in
-00000a80: 6465 785d 2920 7b0a 2020 2020 2020 2020  dex]) {.        
-00000a90: 536f 6d65 2866 6972 7374 2920 3d3e 2066  Some(first) => f
-00000aa0: 6972 7374 2c0a 2020 2020 2020 2020 4e6f  irst,.        No
-00000ab0: 6e65 203d 3e20 7b0a 2020 2020 2020 2020  ne => {.        
-00000ac0: 2020 2020 7265 7475 726e 2045 7272 2850      return Err(P
-00000ad0: 7945 7863 6570 7469 6f6e 3a3a 6e65 775f  yException::new_
-00000ae0: 6572 7228 0a20 2020 2020 2020 2020 2020  err(.           
-00000af0: 2020 2020 2022 456e 636f 756e 7465 7265       "Encountere
-00000b00: 6420 736f 6d65 7468 696e 6720 756e 6578  d something unex
-00000b10: 7065 6374 6564 222c 0a20 2020 2020 2020  pected",.       
-00000b20: 2020 2020 2029 290a 2020 2020 2020 2020       )).        
-00000b30: 7d0a 2020 2020 7d3b 0a20 2020 206c 6574  }.    };.    let
-00000b40: 206d 7574 2076 203d 202a 6669 7273 743b   mut v = *first;
-00000b50: 0a20 2020 206c 6574 206d 7574 2075 3a20  .    let mut u: 
-00000b60: 4f70 7469 6f6e 3c4e 6f64 6549 6e64 6578  Option<NodeIndex
-00000b70: 3e20 3d20 4e6f 6e65 3b0a 2020 2020 7768  > = None;.    wh
-00000b80: 696c 6520 6d61 7463 6820 7520 7b0a 2020  ile match u {.  
-00000b90: 2020 2020 2020 536f 6d65 2875 2920 3d3e        Some(u) =>
-00000ba0: 2075 2021 3d20 762c 0a20 2020 2020 2020   u != v,.       
-00000bb0: 204e 6f6e 6520 3d3e 2074 7275 652c 0a20   None => true,. 
-00000bc0: 2020 207d 207b 0a20 2020 2020 2020 2070     } {.        p
-00000bd0: 6174 682e 7075 7368 2876 2e69 6e64 6578  ath.push(v.index
-00000be0: 2829 293b 0a20 2020 2020 2020 2075 203d  ());.        u =
-00000bf0: 2053 6f6d 6528 7629 3b0a 2020 2020 2020   Some(v);.      
-00000c00: 2020 7620 3d20 6469 7374 5b26 765d 2e31    v = dist[&v].1
-00000c10: 3b0a 2020 2020 7d0a 2020 2020 7061 7468  ;.    }.    path
-00000c20: 2e72 6576 6572 7365 2829 3b0a 2020 2020  .reverse();.    
-00000c30: 4f6b 2870 6174 6829 0a7d 0a0a 2f2f 2f20  Ok(path).}../// 
-00000c40: 4669 6e64 2074 6865 206c 6f6e 6765 7374  Find the longest
-00000c50: 2070 6174 6820 696e 2061 2044 4147 0a2f   path in a DAG./
-00000c60: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
-00000c70: 4469 4772 6170 6820 6772 6170 683a 2054  DiGraph graph: T
-00000c80: 6865 2067 7261 7068 2074 6f20 6669 6e64  he graph to find
-00000c90: 2074 6865 206c 6f6e 6765 7374 2070 6174   the longest pat
-00000ca0: 6820 6f6e 2e20 5468 6520 696e 7075 740a  h on. The input.
-00000cb0: 2f2f 2f20 2020 2020 6f62 6a65 6374 206d  ///     object m
-00000cc0: 7573 7420 6265 2061 2044 4147 2077 6974  ust be a DAG wit
-00000cd0: 686f 7574 2061 2063 7963 6c65 2e0a 2f2f  hout a cycle..//
-00000ce0: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
-00000cf0: 5468 6520 6e6f 6465 2069 6e64 6963 6573  The node indices
-00000d00: 206f 6620 7468 6520 6c6f 6e67 6573 7420   of the longest 
-00000d10: 7061 7468 206f 6e20 7468 6520 4441 470a  path on the DAG.
-00000d20: 2f2f 2f20 3a72 7479 7065 3a20 4e6f 6465  /// :rtype: Node
-00000d30: 496e 6469 6365 730a 2f2f 2f0a 2f2f 2f20  Indices.///./// 
-00000d40: 3a72 6169 7365 7320 4578 6365 7074 696f  :raises Exceptio
-00000d50: 6e3a 2049 6620 616e 2075 6e65 7870 6563  n: If an unexpec
-00000d60: 7465 6420 6572 726f 7220 6f63 6375 7273  ted error occurs
-00000d70: 206f 7220 6120 7061 7468 2063 616e 2774   or a path can't
-00000d80: 2062 6520 666f 756e 640a 2f2f 2f20 3a72   be found./// :r
-00000d90: 6169 7365 7320 4441 4748 6173 4379 636c  aises DAGHasCycl
-00000da0: 653a 2049 6620 7468 6520 696e 7075 7420  e: If the input 
-00000db0: 5079 4469 4772 6170 6820 6861 7320 6120  PyDiGraph has a 
-00000dc0: 6379 636c 650a 235b 7079 6675 6e63 7469  cycle.#[pyfuncti
-00000dd0: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
-00000de0: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
-00000df0: 2f29 225d 0a66 6e20 6461 675f 6c6f 6e67  /)"].fn dag_long
-00000e00: 6573 745f 7061 7468 2867 7261 7068 3a20  est_path(graph: 
-00000e10: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
-00000e20: 6170 6829 202d 3e20 5079 5265 7375 6c74  aph) -> PyResult
-00000e30: 3c4e 6f64 6549 6e64 6963 6573 3e20 7b0a  <NodeIndices> {.
-00000e40: 2020 2020 4f6b 284e 6f64 6549 6e64 6963      Ok(NodeIndic
-00000e50: 6573 207b 0a20 2020 2020 2020 206e 6f64  es {.        nod
-00000e60: 6573 3a20 6c6f 6e67 6573 745f 7061 7468  es: longest_path
-00000e70: 2867 7261 7068 293f 2c0a 2020 2020 7d29  (graph)?,.    })
-00000e80: 0a7d 0a0a 2f2f 2f20 4669 6e64 2074 6865  .}../// Find the
-00000e90: 206c 656e 6774 6820 6f66 2074 6865 206c   length of the l
-00000ea0: 6f6e 6765 7374 2070 6174 6820 696e 2061  ongest path in a
-00000eb0: 2044 4147 0a2f 2f2f 0a2f 2f2f 203a 7061   DAG.///./// :pa
-00000ec0: 7261 6d20 5079 4469 4772 6170 6820 6772  ram PyDiGraph gr
-00000ed0: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
-00000ee0: 6f20 6669 6e64 2074 6865 206c 6f6e 6765  o find the longe
-00000ef0: 7374 2070 6174 6820 6f6e 2e20 5468 6520  st path on. The 
-00000f00: 696e 7075 740a 2f2f 2f20 2020 2020 6f62  input.///     ob
-00000f10: 6a65 6374 206d 7573 7420 6265 2061 2044  ject must be a D
-00000f20: 4147 2077 6974 686f 7574 2061 2063 7963  AG without a cyc
-00000f30: 6c65 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  le..///./// :ret
-00000f40: 7572 6e73 3a20 5468 6520 6c6f 6e67 6573  urns: The longes
-00000f50: 7420 7061 7468 206c 656e 6774 6820 6f6e  t path length on
-00000f60: 2074 6865 2044 4147 0a2f 2f2f 203a 7274   the DAG./// :rt
-00000f70: 7970 653a 2069 6e74 0a2f 2f2f 0a2f 2f2f  ype: int.///.///
-00000f80: 203a 7261 6973 6573 2045 7863 6570 7469   :raises Excepti
-00000f90: 6f6e 3a20 4966 2061 6e20 756e 6578 7065  on: If an unexpe
-00000fa0: 6374 6564 2065 7272 6f72 206f 6363 7572  cted error occur
-00000fb0: 7320 6f72 2061 2070 6174 6820 6361 6e27  s or a path can'
-00000fc0: 7420 6265 2066 6f75 6e64 0a2f 2f2f 203a  t be found./// :
-00000fd0: 7261 6973 6573 2044 4147 4861 7343 7963  raises DAGHasCyc
-00000fe0: 6c65 3a20 4966 2074 6865 2069 6e70 7574  le: If the input
-00000ff0: 2050 7944 6947 7261 7068 2068 6173 2061   PyDiGraph has a
-00001000: 2063 7963 6c65 0a23 5b70 7966 756e 6374   cycle.#[pyfunct
-00001010: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
-00001020: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
-00001030: 202f 2922 5d0a 666e 2064 6167 5f6c 6f6e   /)"].fn dag_lon
-00001040: 6765 7374 5f70 6174 685f 6c65 6e67 7468  gest_path_length
-00001050: 2867 7261 7068 3a20 2664 6967 7261 7068  (graph: &digraph
-00001060: 3a3a 5079 4469 4772 6170 6829 202d 3e20  ::PyDiGraph) -> 
-00001070: 5079 5265 7375 6c74 3c75 7369 7a65 3e20  PyResult<usize> 
-00001080: 7b0a 2020 2020 6c65 7420 7061 7468 203d  {.    let path =
-00001090: 206c 6f6e 6765 7374 5f70 6174 6828 6772   longest_path(gr
-000010a0: 6170 6829 3f3b 0a20 2020 2069 6620 7061  aph)?;.    if pa
-000010b0: 7468 2e69 735f 656d 7074 7928 2920 7b0a  th.is_empty() {.
-000010c0: 2020 2020 2020 2020 7265 7475 726e 204f          return O
-000010d0: 6b28 3029 3b0a 2020 2020 7d0a 2020 2020  k(0);.    }.    
-000010e0: 6c65 7420 7061 7468 5f6c 656e 6774 683a  let path_length:
-000010f0: 2075 7369 7a65 203d 2070 6174 682e 6c65   usize = path.le
-00001100: 6e28 2920 2d20 313b 0a20 2020 204f 6b28  n() - 1;.    Ok(
-00001110: 7061 7468 5f6c 656e 6774 6829 0a7d 0a0a  path_length).}..
-00001120: 2f2f 2f20 4669 6e64 2074 6865 206e 756d  /// Find the num
-00001130: 6265 7220 6f66 2077 6561 6b6c 7920 636f  ber of weakly co
-00001140: 6e6e 6563 7465 6420 636f 6d70 6f6e 656e  nnected componen
-00001150: 7473 2069 6e20 6120 4441 472e 0a2f 2f2f  ts in a DAG..///
-00001160: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
-00001170: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-00001180: 2067 7261 7068 2074 6f20 6669 6e64 2074   graph to find t
-00001190: 6865 206e 756d 6265 7220 6f66 2077 6561  he number of wea
-000011a0: 6b6c 7920 636f 6e6e 6563 7465 640a 2f2f  kly connected.//
-000011b0: 2f20 2020 2020 636f 6d70 6f6e 656e 7473  /     components
-000011c0: 206f 6e0a 2f2f 2f0a 2f2f 2f20 3a72 6574   on.///./// :ret
-000011d0: 7572 6e73 3a20 5468 6520 6e75 6d62 6572  urns: The number
-000011e0: 206f 6620 7765 616b 6c79 2063 6f6e 6e65   of weakly conne
-000011f0: 6374 6564 2063 6f6d 706f 6e65 6e74 7320  cted components 
-00001200: 696e 2074 6865 2044 4147 0a2f 2f2f 203a  in the DAG./// :
-00001210: 7274 7970 653a 2069 6e74 0a23 5b70 7966  rtype: int.#[pyf
-00001220: 756e 6374 696f 6e5d 0a23 5b74 6578 745f  unction].#[text_
-00001230: 7369 676e 6174 7572 6520 3d20 2228 6772  signature = "(gr
-00001240: 6170 682c 202f 2922 5d0a 666e 206e 756d  aph, /)"].fn num
-00001250: 6265 725f 7765 616b 6c79 5f63 6f6e 6e65  ber_weakly_conne
-00001260: 6374 6564 5f63 6f6d 706f 6e65 6e74 7328  cted_components(
-00001270: 6772 6170 683a 2026 6469 6772 6170 683a  graph: &digraph:
-00001280: 3a50 7944 6947 7261 7068 2920 2d3e 2075  :PyDiGraph) -> u
-00001290: 7369 7a65 207b 0a20 2020 2061 6c67 6f3a  size {.    algo:
-000012a0: 3a63 6f6e 6e65 6374 6564 5f63 6f6d 706f  :connected_compo
-000012b0: 6e65 6e74 7328 6772 6170 6829 0a7d 0a0a  nents(graph).}..
-000012c0: 2f2f 2f20 4669 6e64 2074 6865 2077 6561  /// Find the wea
-000012d0: 6b6c 7920 636f 6e6e 6563 7465 6420 636f  kly connected co
-000012e0: 6d70 6f6e 656e 7473 2069 6e20 6120 6469  mponents in a di
-000012f0: 7265 6374 6564 2067 7261 7068 0a2f 2f2f  rected graph.///
-00001300: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
-00001310: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-00001320: 2067 7261 7068 2074 6f20 6669 6e64 2074   graph to find t
-00001330: 6865 2077 6561 6b6c 7920 636f 6e6e 6563  he weakly connec
-00001340: 7465 6420 636f 6d70 6f6e 656e 7473 0a2f  ted components./
-00001350: 2f2f 2020 2020 2069 6e0a 2f2f 2f0a 2f2f  //     in.///.//
-00001360: 2f20 3a72 6574 7572 6e73 3a20 4120 6c69  / :returns: A li
-00001370: 7374 206f 6620 7365 7473 2077 6865 7265  st of sets where
-00001380: 2065 6163 6820 7365 7420 6974 2061 2077   each set it a w
-00001390: 6561 6b6c 7920 636f 6e6e 6563 7465 6420  eakly connected 
-000013a0: 636f 6d70 6f6e 656e 7420 6f66 0a2f 2f2f  component of.///
-000013b0: 2020 2020 2074 6865 2067 7261 7068 0a2f       the graph./
-000013c0: 2f2f 203a 7274 7970 653a 206c 6973 740a  // :rtype: list.
-000013d0: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
-000013e0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
-000013f0: 2022 2867 7261 7068 2c20 2f29 225d 0a70   "(graph, /)"].p
-00001400: 7562 2066 6e20 7765 616b 6c79 5f63 6f6e  ub fn weakly_con
-00001410: 6e65 6374 6564 5f63 6f6d 706f 6e65 6e74  nected_component
-00001420: 7328 0a20 2020 2067 7261 7068 3a20 2664  s(.    graph: &d
-00001430: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
-00001440: 682c 0a29 202d 3e20 5665 633c 4254 7265  h,.) -> Vec<BTre
-00001450: 6553 6574 3c75 7369 7a65 3e3e 207b 0a20  eSet<usize>> {. 
-00001460: 2020 206c 6574 206d 7574 2073 6565 6e3a     let mut seen:
-00001470: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
-00001480: 6578 3e20 3d0a 2020 2020 2020 2020 4861  ex> =.        Ha
-00001490: 7368 5365 743a 3a77 6974 685f 6361 7061  shSet::with_capa
-000014a0: 6369 7479 2867 7261 7068 2e6e 6f64 655f  city(graph.node_
-000014b0: 636f 756e 7428 2929 3b0a 2020 2020 6c65  count());.    le
-000014c0: 7420 6d75 7420 6f75 745f 7665 633a 2056  t mut out_vec: V
-000014d0: 6563 3c42 5472 6565 5365 743c 7573 697a  ec<BTreeSet<usiz
-000014e0: 653e 3e20 3d20 5665 633a 3a6e 6577 2829  e>> = Vec::new()
-000014f0: 3b0a 2020 2020 666f 7220 6e6f 6465 2069  ;.    for node i
-00001500: 6e20 6772 6170 682e 6772 6170 682e 6e6f  n graph.graph.no
-00001510: 6465 5f69 6e64 6963 6573 2829 207b 0a20  de_indices() {. 
-00001520: 2020 2020 2020 2069 6620 2173 6565 6e2e         if !seen.
-00001530: 636f 6e74 6169 6e73 2826 6e6f 6465 2920  contains(&node) 
-00001540: 7b0a 2020 2020 2020 2020 2020 2020 2f2f  {.            //
-00001550: 2042 4653 206e 6f64 6520 6765 6e65 7261   BFS node genera
-00001560: 746f 720a 2020 2020 2020 2020 2020 2020  tor.            
-00001570: 6c65 7420 6d75 7420 636f 6d70 6f6e 656e  let mut componen
-00001580: 745f 7365 743a 2042 5472 6565 5365 743c  t_set: BTreeSet<
-00001590: 7573 697a 653e 203d 2042 5472 6565 5365  usize> = BTreeSe
-000015a0: 743a 3a6e 6577 2829 3b0a 2020 2020 2020  t::new();.      
-000015b0: 2020 2020 2020 6c65 7420 6d75 7420 6266        let mut bf
-000015c0: 735f 7365 656e 3a20 4861 7368 5365 743c  s_seen: HashSet<
-000015d0: 4e6f 6465 496e 6465 783e 203d 2048 6173  NodeIndex> = Has
-000015e0: 6853 6574 3a3a 6e65 7728 293b 0a20 2020  hSet::new();.   
-000015f0: 2020 2020 2020 2020 206c 6574 206d 7574           let mut
-00001600: 206e 6578 745f 6c65 7665 6c3a 2048 6173   next_level: Has
-00001610: 6853 6574 3c4e 6f64 6549 6e64 6578 3e20  hSet<NodeIndex> 
-00001620: 3d20 4861 7368 5365 743a 3a6e 6577 2829  = HashSet::new()
-00001630: 3b0a 2020 2020 2020 2020 2020 2020 6e65  ;.            ne
-00001640: 7874 5f6c 6576 656c 2e69 6e73 6572 7428  xt_level.insert(
-00001650: 6e6f 6465 293b 0a20 2020 2020 2020 2020  node);.         
-00001660: 2020 2077 6869 6c65 2021 6e65 7874 5f6c     while !next_l
-00001670: 6576 656c 2e69 735f 656d 7074 7928 2920  evel.is_empty() 
-00001680: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00001690: 2020 6c65 7420 7468 6973 5f6c 6576 656c    let this_level
-000016a0: 203d 206e 6578 745f 6c65 7665 6c3b 0a20   = next_level;. 
-000016b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000016c0: 6578 745f 6c65 7665 6c20 3d20 4861 7368  ext_level = Hash
-000016d0: 5365 743a 3a6e 6577 2829 3b0a 2020 2020  Set::new();.    
-000016e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000016f0: 6266 735f 6e6f 6465 2069 6e20 7468 6973  bfs_node in this
-00001700: 5f6c 6576 656c 207b 0a20 2020 2020 2020  _level {.       
-00001710: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00001720: 2162 6673 5f73 6565 6e2e 636f 6e74 6169  !bfs_seen.contai
-00001730: 6e73 2826 6266 735f 6e6f 6465 2920 7b0a  ns(&bfs_node) {.
-00001740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001750: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
-00001760: 745f 7365 742e 696e 7365 7274 2862 6673  t_set.insert(bfs
-00001770: 5f6e 6f64 652e 696e 6465 7828 2929 3b0a  _node.index());.
-00001780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001790: 2020 2020 2020 2020 6266 735f 7365 656e          bfs_seen
-000017a0: 2e69 6e73 6572 7428 6266 735f 6e6f 6465  .insert(bfs_node
-000017b0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-000017c0: 2020 2020 2020 2020 2020 2066 6f72 206e             for n
-000017d0: 6569 6768 626f 7220 696e 0a20 2020 2020  eighbor in.     
-000017e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000017f0: 2020 2020 2020 2067 7261 7068 2e67 7261         graph.gra
-00001800: 7068 2e6e 6569 6768 626f 7273 5f75 6e64  ph.neighbors_und
-00001810: 6972 6563 7465 6428 6266 735f 6e6f 6465  irected(bfs_node
-00001820: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00001830: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00001840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001850: 2020 2020 2020 2020 6e65 7874 5f6c 6576          next_lev
-00001860: 656c 2e69 6e73 6572 7428 6e65 6967 6862  el.insert(neighb
-00001870: 6f72 293b 0a20 2020 2020 2020 2020 2020  or);.           
-00001880: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00001890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000018a0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-000018b0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-000018c0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-000018d0: 206f 7574 5f76 6563 2e70 7573 6828 636f   out_vec.push(co
-000018e0: 6d70 6f6e 656e 745f 7365 7429 3b0a 2020  mponent_set);.  
-000018f0: 2020 2020 2020 2020 2020 7365 656e 2e65            seen.e
-00001900: 7874 656e 6428 6266 735f 7365 656e 293b  xtend(bfs_seen);
-00001910: 0a20 2020 2020 2020 207d 0a20 2020 207d  .        }.    }
-00001920: 0a20 2020 206f 7574 5f76 6563 0a7d 0a0a  .    out_vec.}..
-00001930: 2f2f 2f20 4368 6563 6b20 6966 2074 6865  /// Check if the
-00001940: 2067 7261 7068 2069 7320 7765 616b 6c79   graph is weakly
-00001950: 2063 6f6e 6e65 6374 6564 0a2f 2f2f 0a2f   connected.///./
-00001960: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
-00001970: 6170 6820 6772 6170 683a 2054 6865 2067  aph graph: The g
-00001980: 7261 7068 2074 6f20 6368 6563 6b20 6966  raph to check if
-00001990: 2069 7420 6973 2077 6561 6b6c 7920 636f   it is weakly co
-000019a0: 6e6e 6563 7465 640a 2f2f 2f0a 2f2f 2f20  nnected.///./// 
-000019b0: 3a72 6574 7572 6e73 3a20 5768 6574 6865  :returns: Whethe
-000019c0: 7220 7468 6520 6772 6170 6820 6973 2077  r the graph is w
-000019d0: 6561 6b6c 7920 636f 6e6e 6563 7465 6420  eakly connected 
-000019e0: 6f72 206e 6f74 0a2f 2f2f 203a 7274 7970  or not./// :rtyp
-000019f0: 653a 2062 6f6f 6c0a 2f2f 2f0a 2f2f 2f20  e: bool.///./// 
-00001a00: 3a72 6169 7365 7320 4e75 6c6c 4772 6170  :raises NullGrap
-00001a10: 683a 2049 6620 616e 2065 6d70 7479 2067  h: If an empty g
-00001a20: 7261 7068 2069 7320 7061 7373 6564 2069  raph is passed i
-00001a30: 6e0a 235b 7079 6675 6e63 7469 6f6e 5d0a  n.#[pyfunction].
-00001a40: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
-00001a50: 203d 2022 2867 7261 7068 2c20 2f29 225d   = "(graph, /)"]
-00001a60: 0a70 7562 2066 6e20 6973 5f77 6561 6b6c  .pub fn is_weakl
-00001a70: 795f 636f 6e6e 6563 7465 6428 6772 6170  y_connected(grap
-00001a80: 683a 2026 6469 6772 6170 683a 3a50 7944  h: &digraph::PyD
-00001a90: 6947 7261 7068 2920 2d3e 2050 7952 6573  iGraph) -> PyRes
-00001aa0: 756c 743c 626f 6f6c 3e20 7b0a 2020 2020  ult<bool> {.    
-00001ab0: 6966 2067 7261 7068 2e67 7261 7068 2e6e  if graph.graph.n
-00001ac0: 6f64 655f 636f 756e 7428 2920 3d3d 2030  ode_count() == 0
-00001ad0: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
-00001ae0: 6e20 4572 7228 4e75 6c6c 4772 6170 683a  n Err(NullGraph:
-00001af0: 3a6e 6577 5f65 7272 2822 496e 7661 6c69  :new_err("Invali
-00001b00: 6420 6f70 6572 6174 696f 6e20 6f6e 2061  d operation on a
-00001b10: 204e 756c 6c47 7261 7068 2229 293b 0a20   NullGraph"));. 
-00001b20: 2020 207d 0a20 2020 204f 6b28 7765 616b     }.    Ok(weak
-00001b30: 6c79 5f63 6f6e 6e65 6374 6564 5f63 6f6d  ly_connected_com
-00001b40: 706f 6e65 6e74 7328 6772 6170 6829 5b30  ponents(graph)[0
-00001b50: 5d2e 6c65 6e28 2920 3d3d 2067 7261 7068  ].len() == graph
-00001b60: 2e67 7261 7068 2e6e 6f64 655f 636f 756e  .graph.node_coun
-00001b70: 7428 2929 0a7d 0a0a 2f2f 2f20 4368 6563  t()).}../// Chec
-00001b80: 6b20 7468 6174 2074 6865 2050 7944 6947  k that the PyDiG
-00001b90: 7261 7068 206f 7220 5079 4441 4720 646f  raph or PyDAG do
-00001ba0: 6573 6e27 7420 6861 7665 2061 2063 7963  esn't have a cyc
-00001bb0: 6c65 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  le.///./// :para
-00001bc0: 6d20 5079 4469 4772 6170 6820 6772 6170  m PyDiGraph grap
-00001bd0: 683a 2054 6865 2067 7261 7068 2074 6f20  h: The graph to 
-00001be0: 6368 6563 6b20 666f 7220 6379 636c 6573  check for cycles
-00001bf0: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
-00001c00: 733a 2060 6054 7275 6560 6020 6966 2074  s: ``True`` if t
-00001c10: 6865 7265 2061 7265 206e 6f20 6379 636c  here are no cycl
-00001c20: 6573 2069 6e20 7468 6520 696e 7075 7420  es in the input 
-00001c30: 6772 6170 682c 2060 6046 616c 7365 6060  graph, ``False``
-00001c40: 0a2f 2f2f 2020 2020 2069 6620 7468 6572  .///     if ther
-00001c50: 6520 6172 6520 6379 636c 6573 0a2f 2f2f  e are cycles.///
-00001c60: 203a 7274 7970 653a 2062 6f6f 6c0a 235b   :rtype: bool.#[
-00001c70: 7079 6675 6e63 7469 6f6e 5d0a 235b 7465  pyfunction].#[te
-00001c80: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
-00001c90: 2867 7261 7068 2c20 2f29 225d 0a66 6e20  (graph, /)"].fn 
-00001ca0: 6973 5f64 6972 6563 7465 645f 6163 7963  is_directed_acyc
-00001cb0: 6c69 635f 6772 6170 6828 6772 6170 683a  lic_graph(graph:
-00001cc0: 2026 6469 6772 6170 683a 3a50 7944 6947   &digraph::PyDiG
-00001cd0: 7261 7068 2920 2d3e 2062 6f6f 6c20 7b0a  raph) -> bool {.
-00001ce0: 2020 2020 6d61 7463 6820 616c 676f 3a3a      match algo::
-00001cf0: 746f 706f 736f 7274 2867 7261 7068 2c20  toposort(graph, 
-00001d00: 4e6f 6e65 2920 7b0a 2020 2020 2020 2020  None) {.        
-00001d10: 4f6b 285f 6e6f 6465 7329 203d 3e20 7472  Ok(_nodes) => tr
-00001d20: 7565 2c0a 2020 2020 2020 2020 4572 7228  ue,.        Err(
-00001d30: 5f65 7272 2920 3d3e 2066 616c 7365 2c0a  _err) => false,.
-00001d40: 2020 2020 7d0a 7d0a 0a2f 2f2f 2044 6574      }.}../// Det
-00001d50: 6572 6d69 6e65 2069 6620 3220 6772 6170  ermine if 2 grap
-00001d60: 6873 2061 7265 2073 7472 7563 7475 7261  hs are structura
-00001d70: 6c6c 7920 6973 6f6d 6f72 7068 6963 0a2f  lly isomorphic./
-00001d80: 2f2f 0a2f 2f2f 2054 6869 7320 6368 6563  //./// This chec
-00001d90: 6b73 2069 6620 3220 6772 6170 6873 2061  ks if 2 graphs a
-00001da0: 7265 2073 7472 7563 7475 7261 6c6c 7920  re structurally 
-00001db0: 6973 6f6d 6f72 7068 6963 2028 6974 2064  isomorphic (it d
-00001dc0: 6f65 736e 2774 206d 6174 6368 0a2f 2f2f  oesn't match.///
-00001dd0: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
-00001de0: 2074 6865 206e 6f64 6573 206f 7220 6564   the nodes or ed
-00001df0: 6765 7320 6f6e 2074 6865 2067 7261 7068  ges on the graph
-00001e00: 7329 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  s)..///./// :par
-00001e10: 616d 2050 7944 6947 7261 7068 2066 6972  am PyDiGraph fir
-00001e20: 7374 3a20 5468 6520 6669 7273 7420 6772  st: The first gr
-00001e30: 6170 6820 746f 2063 6f6d 7061 7265 0a2f  aph to compare./
-00001e40: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
-00001e50: 6170 6820 7365 636f 6e64 3a20 5468 6520  aph second: The 
-00001e60: 7365 636f 6e64 2067 7261 7068 2074 6f20  second graph to 
-00001e70: 636f 6d70 6172 650a 2f2f 2f0a 2f2f 2f20  compare.///./// 
-00001e80: 3a72 6574 7572 6e73 3a20 6060 5472 7565  :returns: ``True
-00001e90: 6060 2069 6620 7468 6520 3220 6772 6170  `` if the 2 grap
-00001ea0: 6873 2061 7265 2073 7472 7563 7475 7261  hs are structura
-00001eb0: 6c6c 7920 6973 6f6d 6f72 7068 6963 2c20  lly isomorphic, 
-00001ec0: 6060 4661 6c73 6560 600a 2f2f 2f20 2020  ``False``.///   
-00001ed0: 2020 6966 2074 6865 7920 6172 6520 6e6f    if they are no
-00001ee0: 740a 2f2f 2f20 3a72 7479 7065 3a20 626f  t./// :rtype: bo
-00001ef0: 6f6c 0a23 5b70 7966 756e 6374 696f 6e5d  ol.#[pyfunction]
-00001f00: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
-00001f10: 6520 3d20 2228 6669 7273 742c 2073 6563  e = "(first, sec
-00001f20: 6f6e 642c 202f 2922 5d0a 666e 2069 735f  ond, /)"].fn is_
-00001f30: 6973 6f6d 6f72 7068 6963 280a 2020 2020  isomorphic(.    
-00001f40: 6669 7273 743a 2026 6469 6772 6170 683a  first: &digraph:
-00001f50: 3a50 7944 6947 7261 7068 2c0a 2020 2020  :PyDiGraph,.    
-00001f60: 7365 636f 6e64 3a20 2664 6967 7261 7068  second: &digraph
-00001f70: 3a3a 5079 4469 4772 6170 682c 0a29 202d  ::PyDiGraph,.) -
-00001f80: 3e20 5079 5265 7375 6c74 3c62 6f6f 6c3e  > PyResult<bool>
-00001f90: 207b 0a20 2020 206c 6574 2072 6573 203d   {.    let res =
-00001fa0: 2064 6167 5f69 736f 6d6f 7270 6869 736d   dag_isomorphism
-00001fb0: 3a3a 6973 5f69 736f 6d6f 7270 6869 6328  ::is_isomorphic(
-00001fc0: 6669 7273 742c 2073 6563 6f6e 6429 3f3b  first, second)?;
-00001fd0: 0a20 2020 204f 6b28 7265 7329 0a7d 0a0a  .    Ok(res).}..
-00001fe0: 2f2f 2f20 5265 7475 726e 2061 206e 6577  /// Return a new
-00001ff0: 2050 7944 6947 7261 7068 2062 7920 666f   PyDiGraph by fo
-00002000: 726d 696e 6720 6120 756e 696f 6e20 6672  rming a union fr
-00002010: 6f6d 2074 776f 2069 6e70 7574 2050 7944  om two input PyD
-00002020: 6947 7261 7068 206f 626a 6563 7473 0a2f  iGraph objects./
-00002030: 2f2f 0a2f 2f2f 2054 6865 2061 6c67 6f72  //./// The algor
-00002040: 6974 686d 2069 6e20 7468 6973 2066 756e  ithm in this fun
-00002050: 6374 696f 6e20 6f70 6572 6174 6573 2069  ction operates i
-00002060: 6e20 7468 7265 6520 7068 6173 6573 3a0a  n three phases:.
-00002070: 2f2f 2f0a 2f2f 2f20 2031 2e20 4164 6420  ///.///  1. Add 
-00002080: 616c 6c20 7468 6520 6e6f 6465 7320 6672  all the nodes fr
-00002090: 6f6d 2020 6060 7365 636f 6e64 6060 2069  om  ``second`` i
-000020a0: 6e74 6f20 6060 6669 7273 7460 602e 206f  nto ``first``. o
-000020b0: 7065 7261 7465 7320 696e 204f 286e 292c  perates in O(n),
-000020c0: 0a2f 2f2f 2020 2020 2077 6974 6820 6e20  .///     with n 
-000020d0: 6265 696e 6720 6e75 6d62 6572 206f 6620  being number of 
-000020e0: 6e6f 6465 7320 696e 2060 6260 2e0a 2f2f  nodes in `b`..//
-000020f0: 2f20 2032 2e20 4d65 7267 6520 6e6f 6465  /  2. Merge node
-00002100: 7320 6672 6f6d 2060 6073 6563 6f6e 6460  s from ``second`
-00002110: 6020 6f76 6572 2060 6066 6972 7374 6060  ` over ``first``
-00002120: 2067 6976 656e 2074 6861 743a 0a2f 2f2f   given that:.///
-00002130: 0a2f 2f2f 2020 2020 202d 2054 6865 2060  .///     - The `
-00002140: 606d 6572 6765 5f6e 6f64 6573 6060 2069  `merge_nodes`` i
-00002150: 7320 6060 5472 7565 6060 2e20 6f70 6572  s ``True``. oper
-00002160: 6174 6573 2069 6e20 4f28 6e5e 3229 2c20  ates in O(n^2), 
-00002170: 7769 7468 206e 2062 6569 6e67 2074 6865  with n being the
-00002180: 0a2f 2f2f 2020 2020 2020 206e 756d 6265  .///       numbe
-00002190: 7220 6f66 206e 6f64 6573 2069 6e20 6060  r of nodes in ``
-000021a0: 7365 636f 6e64 6060 2e0a 2f2f 2f20 2020  second``..///   
-000021b0: 2020 2d20 5468 6520 7265 7370 6563 7469    - The respecti
-000021c0: 7665 206e 6f64 6520 696e 2060 6073 6563  ve node in ``sec
-000021d0: 6f6e 6460 6020 616e 6420 6060 6669 7273  ond`` and ``firs
-000021e0: 7460 6020 7368 6172 6520 7468 6520 7361  t`` share the sa
-000021f0: 6d65 0a2f 2f2f 2020 2020 2020 2077 6569  me.///       wei
-00002200: 6768 742f 6461 7461 2070 6179 6c6f 6164  ght/data payload
-00002210: 2e0a 2f2f 2f0a 2f2f 2f20 2033 2e20 4164  ..///.///  3. Ad
-00002220: 6473 2061 6c6c 2074 6865 2065 6467 6573  ds all the edges
-00002230: 2066 726f 6d20 6060 7365 636f 6e64 6060   from ``second``
-00002240: 2074 6f20 6060 6669 7273 7460 602e 2049   to ``first``. I
-00002250: 6620 7468 6520 6060 6d65 7267 655f 6564  f the ``merge_ed
-00002260: 6765 7360 600a 2f2f 2f20 2020 2020 7061  ges``.///     pa
-00002270: 7261 6d65 7465 7220 6973 2060 6054 7275  rameter is ``Tru
-00002280: 6560 6020 616e 6420 7468 6520 7265 7370  e`` and the resp
-00002290: 6563 7469 7665 2065 6467 6520 696e 2060  ective edge in `
-000022a0: 6073 6563 6f6e 6460 6020 616e 640a 2f2f  `second`` and.//
-000022b0: 2f20 2020 2020 6669 7273 7460 6020 7368  /     first`` sh
-000022c0: 6172 6520 7468 6520 7361 6d65 2077 6569  are the same wei
-000022d0: 6768 742f 6461 7461 2070 6179 6c6f 6164  ght/data payload
-000022e0: 2074 6865 7920 7769 6c6c 2062 6520 6d65   they will be me
-000022f0: 7267 6564 0a2f 2f2f 2020 2020 2074 6f67  rged.///     tog
-00002300: 6574 6865 722e 0a2f 2f2f 0a2f 2f2f 2020  ether..///.///  
-00002310: 3a70 6172 616d 2050 7944 6947 7261 7068  :param PyDiGraph
-00002320: 2066 6972 7374 3a20 5468 6520 6669 7273   first: The firs
-00002330: 7420 6469 7265 6374 6564 2067 7261 7068  t directed graph
-00002340: 206f 626a 6563 740a 2f2f 2f20 203a 7061   object.///  :pa
-00002350: 7261 6d20 5079 4469 4772 6170 6820 7365  ram PyDiGraph se
-00002360: 636f 6e64 3a20 5468 6520 7365 636f 6e64  cond: The second
-00002370: 2064 6972 6563 7465 6420 6772 6170 6820   directed graph 
-00002380: 6f62 6a65 6374 0a2f 2f2f 2020 3a70 6172  object.///  :par
-00002390: 616d 2062 6f6f 6c20 6d65 7267 655f 6e6f  am bool merge_no
-000023a0: 6465 733a 2049 6620 7365 7420 746f 2060  des: If set to `
-000023b0: 6054 7275 6560 6020 6e6f 6465 7320 7769  `True`` nodes wi
-000023c0: 6c6c 2062 6520 6d65 7267 6564 2062 6574  ll be merged bet
-000023d0: 7765 656e 0a2f 2f2f 2020 2020 2060 6073  ween.///     ``s
-000023e0: 6563 6f6e 6460 6020 616e 6420 6060 6669  econd`` and ``fi
-000023f0: 7273 7460 6020 6966 2074 6865 2077 6569  rst`` if the wei
-00002400: 6768 7473 2061 7265 2065 7175 616c 2e0a  ghts are equal..
-00002410: 2f2f 2f20 203a 7061 7261 6d20 626f 6f6c  ///  :param bool
-00002420: 206d 6572 6765 5f65 6467 6573 3a20 4966   merge_edges: If
-00002430: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-00002440: 2065 6467 6573 2077 696c 6c20 6265 206d   edges will be m
-00002450: 6572 6765 6420 6265 7477 6565 6e0a 2f2f  erged between.//
-00002460: 2f20 2020 2020 6060 7365 636f 6e64 6060  /     ``second``
-00002470: 2061 6e64 2060 6066 6972 7374 6060 2069   and ``first`` i
-00002480: 6620 7468 6520 7765 6967 6874 7320 6172  f the weights ar
-00002490: 6520 6571 7561 6c2e 0a2f 2f2f 0a2f 2f2f  e equal..///.///
-000024a0: 2020 3a72 6574 7572 6e73 3a20 4120 6e65    :returns: A ne
-000024b0: 7720 5079 4469 4772 6170 6820 6f62 6a65  w PyDiGraph obje
-000024c0: 6374 2074 6861 7420 6973 2074 6865 2075  ct that is the u
-000024d0: 6e69 6f6e 206f 6620 6060 7365 636f 6e64  nion of ``second
-000024e0: 6060 2061 6e64 0a2f 2f2f 2020 2020 2060  `` and.///     `
-000024f0: 6066 6972 7374 6060 2e20 4974 2773 2077  `first``. It's w
-00002500: 6f72 7468 206e 6f74 696e 6720 7468 6520  orth noting the 
-00002510: 7765 6967 6874 2f64 6174 6120 7061 796c  weight/data payl
-00002520: 6f61 6420 6f62 6a65 6374 7320 6172 650a  oad objects are.
-00002530: 2f2f 2f20 2020 2020 7061 7373 6564 2062  ///     passed b
-00002540: 7920 7265 6665 7265 6e63 6520 6672 6f6d  y reference from
-00002550: 2060 6066 6972 7374 6060 2061 6e64 2060   ``first`` and `
-00002560: 6073 6563 6f6e 6460 6020 746f 2074 6869  `second`` to thi
-00002570: 7320 6e65 7720 6f62 6a65 6374 2e0a 2f2f  s new object..//
-00002580: 2f20 203a 7274 7970 653a 2050 7944 6947  /  :rtype: PyDiG
-00002590: 7261 7068 0a23 5b70 7966 756e 6374 696f  raph.#[pyfunctio
-000025a0: 6e5d 0a23 5b74 6578 745f 7369 676e 6174  n].#[text_signat
-000025b0: 7572 6520 3d20 2228 6669 7273 742c 2073  ure = "(first, s
-000025c0: 6563 6f6e 642c 206d 6572 6765 5f6e 6f64  econd, merge_nod
-000025d0: 6573 2c20 6d65 7267 655f 6564 6765 732c  es, merge_edges,
-000025e0: 202f 2922 5d0a 666e 2064 6967 7261 7068   /)"].fn digraph
-000025f0: 5f75 6e69 6f6e 280a 2020 2020 7079 3a20  _union(.    py: 
-00002600: 5079 7468 6f6e 2c0a 2020 2020 6669 7273  Python,.    firs
-00002610: 743a 2026 6469 6772 6170 683a 3a50 7944  t: &digraph::PyD
-00002620: 6947 7261 7068 2c0a 2020 2020 7365 636f  iGraph,.    seco
-00002630: 6e64 3a20 2664 6967 7261 7068 3a3a 5079  nd: &digraph::Py
-00002640: 4469 4772 6170 682c 0a20 2020 206d 6572  DiGraph,.    mer
-00002650: 6765 5f6e 6f64 6573 3a20 626f 6f6c 2c0a  ge_nodes: bool,.
-00002660: 2020 2020 6d65 7267 655f 6564 6765 733a      merge_edges:
-00002670: 2062 6f6f 6c2c 0a29 202d 3e20 5079 5265   bool,.) -> PyRe
-00002680: 7375 6c74 3c64 6967 7261 7068 3a3a 5079  sult<digraph::Py
-00002690: 4469 4772 6170 683e 207b 0a20 2020 206c  DiGraph> {.    l
-000026a0: 6574 2072 6573 203d 0a20 2020 2020 2020  et res =.       
-000026b0: 2075 6e69 6f6e 3a3a 6469 6772 6170 685f   union::digraph_
-000026c0: 756e 696f 6e28 7079 2c20 6669 7273 742c  union(py, first,
-000026d0: 2073 6563 6f6e 642c 206d 6572 6765 5f6e   second, merge_n
-000026e0: 6f64 6573 2c20 6d65 7267 655f 6564 6765  odes, merge_edge
-000026f0: 7329 3f3b 0a20 2020 204f 6b28 7265 7329  s)?;.    Ok(res)
-00002700: 0a7d 0a0a 2f2f 2f20 4465 7465 726d 696e  .}../// Determin
-00002710: 6520 6966 2032 2044 4147 7320 6172 6520  e if 2 DAGs are 
-00002720: 6973 6f6d 6f72 7068 6963 0a2f 2f2f 0a2f  isomorphic.///./
-00002730: 2f2f 2054 6869 7320 6368 6563 6b73 2069  // This checks i
-00002740: 6620 3220 6772 6170 6873 2061 7265 2069  f 2 graphs are i
-00002750: 736f 6d6f 7270 6869 6320 626f 7468 2073  somorphic both s
-00002760: 7472 7563 7475 7261 6c6c 7920 616e 6420  tructurally and 
-00002770: 616c 736f 0a2f 2f2f 2063 6f6d 7061 7269  also./// compari
-00002780: 6e67 2074 6865 206e 6f64 6520 6461 7461  ng the node data
-00002790: 2075 7369 6e67 2074 6865 2070 726f 7669   using the provi
-000027a0: 6465 6420 6d61 7463 6865 7220 6675 6e63  ded matcher func
-000027b0: 7469 6f6e 2e20 5468 6520 6d61 7463 6865  tion. The matche
-000027c0: 720a 2f2f 2f20 6675 6e63 7469 6f6e 2074  r./// function t
-000027d0: 616b 6573 2069 6e20 3220 6e6f 6465 2064  akes in 2 node d
-000027e0: 6174 6120 6f62 6a65 6374 7320 616e 6420  ata objects and 
-000027f0: 7769 6c6c 2063 6f6d 7061 7265 2074 6865  will compare the
-00002800: 6d2e 2041 2073 696d 706c 650a 2f2f 2f20  m. A simple./// 
-00002810: 6578 616d 706c 6520 7468 6174 2063 6865  example that che
-00002820: 636b 7320 6966 2074 6865 7927 7265 206a  cks if they're j
-00002830: 7573 7420 6571 7561 6c20 776f 756c 6420  ust equal would 
-00002840: 6265 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020  be::.///.///    
-00002850: 2067 7261 7068 5f61 203d 2072 6574 776f   graph_a = retwo
-00002860: 726b 782e 5079 4441 4728 290a 2f2f 2f20  rkx.PyDAG()./// 
-00002870: 2020 2020 6772 6170 685f 6220 3d20 7265      graph_b = re
-00002880: 7477 6f72 6b78 2e50 7944 4147 2829 0a2f  tworkx.PyDAG()./
-00002890: 2f2f 2020 2020 2072 6574 776f 726b 782e  //     retworkx.
-000028a0: 6973 5f69 736f 6d6f 7270 6869 635f 6e6f  is_isomorphic_no
-000028b0: 6465 5f6d 6174 6368 2867 7261 7068 5f61  de_match(graph_a
-000028c0: 2c20 6772 6170 685f 622c 0a2f 2f2f 2020  , graph_b,.///  
-000028d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028f0: 2020 2020 206c 616d 6264 6120 782c 2079       lambda x, y
-00002900: 3a20 7820 3d3d 2079 290a 2f2f 2f0a 2f2f  : x == y).///.//
-00002910: 2f20 3a70 6172 616d 2050 7944 6947 7261  / :param PyDiGra
-00002920: 7068 2066 6972 7374 3a20 5468 6520 6669  ph first: The fi
-00002930: 7273 7420 6772 6170 6820 746f 2063 6f6d  rst graph to com
-00002940: 7061 7265 0a2f 2f2f 203a 7061 7261 6d20  pare./// :param 
-00002950: 5079 4469 4772 6170 6820 7365 636f 6e64  PyDiGraph second
-00002960: 3a20 5468 6520 7365 636f 6e64 2067 7261  : The second gra
-00002970: 7068 2074 6f20 636f 6d70 6172 650a 2f2f  ph to compare.//
-00002980: 2f20 3a70 6172 616d 2063 616c 6c61 626c  / :param callabl
-00002990: 6520 6d61 7463 6865 723a 2041 2070 7974  e matcher: A pyt
-000029a0: 686f 6e20 6361 6c6c 6162 6c65 206f 626a  hon callable obj
-000029b0: 6563 7420 7468 6174 2074 616b 6573 2032  ect that takes 2
-000029c0: 2070 6f73 6974 696f 6e61 6c0a 2f2f 2f20   positional./// 
-000029d0: 2020 2020 6f6e 6520 666f 7220 6561 6368      one for each
-000029e0: 206e 6f64 6520 6461 7461 206f 626a 6563   node data objec
-000029f0: 742e 2049 6620 7468 6520 7265 7475 726e  t. If the return
-00002a00: 206f 6620 7468 6973 0a2f 2f2f 2020 2020   of this.///    
-00002a10: 2066 756e 6374 696f 6e20 6576 616c 7561   function evalua
-00002a20: 7465 7320 746f 2054 7275 6520 7468 656e  tes to True then
-00002a30: 2074 6865 206e 6f64 6573 2070 6173 7365   the nodes passe
-00002a40: 6420 746f 2069 7420 6172 6520 7669 6564  d to it are vied
-00002a50: 6564 2061 730a 2f2f 2f20 2020 2020 6d61  ed as.///     ma
-00002a60: 7463 6869 6e67 2e0a 2f2f 2f0a 2f2f 2f20  tching..///./// 
-00002a70: 3a72 6574 7572 6e73 3a20 6060 5472 7565  :returns: ``True
-00002a80: 6060 2069 6620 7468 6520 3220 6772 6170  `` if the 2 grap
-00002a90: 6873 2061 7265 2069 736f 6d6f 7270 6869  hs are isomorphi
-00002aa0: 6320 6060 4661 6c73 6560 6020 6966 2074  c ``False`` if t
-00002ab0: 6865 7920 6172 650a 2f2f 2f20 2020 2020  hey are.///     
-00002ac0: 6e6f 742e 0a2f 2f2f 203a 7274 7970 653a  not../// :rtype:
-00002ad0: 2062 6f6f 6c0a 235b 7079 6675 6e63 7469   bool.#[pyfuncti
-00002ae0: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
-00002af0: 7475 7265 203d 2022 2866 6972 7374 2c20  ture = "(first, 
-00002b00: 7365 636f 6e64 2c20 6d61 7463 6865 722c  second, matcher,
-00002b10: 202f 2922 5d0a 666e 2069 735f 6973 6f6d   /)"].fn is_isom
-00002b20: 6f72 7068 6963 5f6e 6f64 655f 6d61 7463  orphic_node_matc
-00002b30: 6828 0a20 2020 2070 793a 2050 7974 686f  h(.    py: Pytho
-00002b40: 6e2c 0a20 2020 2066 6972 7374 3a20 2664  n,.    first: &d
-00002b50: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
-00002b60: 682c 0a20 2020 2073 6563 6f6e 643a 2026  h,.    second: &
-00002b70: 6469 6772 6170 683a 3a50 7944 6947 7261  digraph::PyDiGra
-00002b80: 7068 2c0a 2020 2020 6d61 7463 6865 723a  ph,.    matcher:
-00002b90: 2050 794f 626a 6563 742c 0a29 202d 3e20   PyObject,.) -> 
-00002ba0: 5079 5265 7375 6c74 3c62 6f6f 6c3e 207b  PyResult<bool> {
-00002bb0: 0a20 2020 206c 6574 2063 6f6d 7061 7265  .    let compare
-00002bc0: 5f6e 6f64 6573 203d 207c 613a 2026 5079  _nodes = |a: &Py
-00002bd0: 4f62 6a65 6374 2c20 623a 2026 5079 4f62  Object, b: &PyOb
-00002be0: 6a65 6374 7c20 2d3e 2050 7952 6573 756c  ject| -> PyResul
-00002bf0: 743c 626f 6f6c 3e20 7b0a 2020 2020 2020  t<bool> {.      
-00002c00: 2020 6c65 7420 7265 7320 3d20 6d61 7463    let res = matc
-00002c10: 6865 722e 6361 6c6c 3128 7079 2c20 2861  her.call1(py, (a
-00002c20: 2c20 6229 293f 3b0a 2020 2020 2020 2020  , b))?;.        
-00002c30: 4f6b 2872 6573 2e69 735f 7472 7565 2870  Ok(res.is_true(p
-00002c40: 7929 2e75 6e77 7261 7028 2929 0a20 2020  y).unwrap()).   
-00002c50: 207d 3b0a 0a20 2020 2023 5b61 6c6c 6f77   };..    #[allow
-00002c60: 2863 6c69 7070 793a 3a75 6e6e 6563 6573  (clippy::unneces
-00002c70: 7361 7279 5f77 7261 7073 295d 0a20 2020  sary_wraps)].   
-00002c80: 2066 6e20 636f 6d70 6172 655f 6564 6765   fn compare_edge
-00002c90: 7328 5f61 3a20 2650 794f 626a 6563 742c  s(_a: &PyObject,
-00002ca0: 205f 623a 2026 5079 4f62 6a65 6374 2920   _b: &PyObject) 
-00002cb0: 2d3e 2050 7952 6573 756c 743c 626f 6f6c  -> PyResult<bool
-00002cc0: 3e20 7b0a 2020 2020 2020 2020 4f6b 2874  > {.        Ok(t
-00002cd0: 7275 6529 0a20 2020 207d 0a20 2020 206c  rue).    }.    l
-00002ce0: 6574 2072 6573 203d 2064 6167 5f69 736f  et res = dag_iso
-00002cf0: 6d6f 7270 6869 736d 3a3a 6973 5f69 736f  morphism::is_iso
-00002d00: 6d6f 7270 6869 635f 6d61 7463 6869 6e67  morphic_matching
-00002d10: 280a 2020 2020 2020 2020 7079 2c0a 2020  (.        py,.  
-00002d20: 2020 2020 2020 6669 7273 742c 0a20 2020        first,.   
-00002d30: 2020 2020 2073 6563 6f6e 642c 0a20 2020       second,.   
-00002d40: 2020 2020 2063 6f6d 7061 7265 5f6e 6f64       compare_nod
-00002d50: 6573 2c0a 2020 2020 2020 2020 636f 6d70  es,.        comp
-00002d60: 6172 655f 6564 6765 732c 0a20 2020 2029  are_edges,.    )
-00002d70: 3f3b 0a20 2020 204f 6b28 7265 7329 0a7d  ?;.    Ok(res).}
-00002d80: 0a0a 2f2f 2f20 5265 7475 726e 2074 6865  ../// Return the
-00002d90: 2074 6f70 6f6c 6f67 6963 616c 2073 6f72   topological sor
-00002da0: 7420 6f66 206e 6f64 6520 696e 6465 7865  t of node indexe
-00002db0: 7320 6672 6f6d 2074 6865 2070 726f 7669  s from the provi
-00002dc0: 6465 6420 6772 6170 680a 2f2f 2f0a 2f2f  ded graph.///.//
-00002dd0: 2f20 3a70 6172 616d 2050 7944 6947 7261  / :param PyDiGra
-00002de0: 7068 2067 7261 7068 3a20 5468 6520 4441  ph graph: The DA
-00002df0: 4720 746f 2067 6574 2074 6865 2074 6f70  G to get the top
-00002e00: 6f6c 6f67 6963 616c 2073 6f72 7420 6f6e  ological sort on
-00002e10: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
-00002e20: 733a 2041 206c 6973 7420 6f66 206e 6f64  s: A list of nod
-00002e30: 6520 696e 6469 6365 7320 746f 706f 6c6f  e indices topolo
-00002e40: 6769 6361 6c6c 7920 736f 7274 6564 2e0a  gically sorted..
-00002e50: 2f2f 2f20 3a72 7479 7065 3a20 4e6f 6465  /// :rtype: Node
-00002e60: 496e 6469 6365 730a 2f2f 2f0a 2f2f 2f20  Indices.///./// 
-00002e70: 3a72 6169 7365 7320 4441 4748 6173 4379  :raises DAGHasCy
-00002e80: 636c 653a 2069 6620 6120 6379 636c 6520  cle: if a cycle 
-00002e90: 6973 2065 6e63 6f75 6e74 6572 6564 2077  is encountered w
-00002ea0: 6869 6c65 2073 6f72 7469 6e67 2074 6865  hile sorting the
-00002eb0: 2067 7261 7068 0a23 5b70 7966 756e 6374   graph.#[pyfunct
-00002ec0: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
-00002ed0: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
-00002ee0: 202f 2922 5d0a 666e 2074 6f70 6f6c 6f67   /)"].fn topolog
-00002ef0: 6963 616c 5f73 6f72 7428 6772 6170 683a  ical_sort(graph:
-00002f00: 2026 6469 6772 6170 683a 3a50 7944 6947   &digraph::PyDiG
-00002f10: 7261 7068 2920 2d3e 2050 7952 6573 756c  raph) -> PyResul
-00002f20: 743c 4e6f 6465 496e 6469 6365 733e 207b  t<NodeIndices> {
-00002f30: 0a20 2020 206c 6574 206e 6f64 6573 203d  .    let nodes =
-00002f40: 206d 6174 6368 2061 6c67 6f3a 3a74 6f70   match algo::top
-00002f50: 6f73 6f72 7428 6772 6170 682c 204e 6f6e  osort(graph, Non
-00002f60: 6529 207b 0a20 2020 2020 2020 204f 6b28  e) {.        Ok(
-00002f70: 6e6f 6465 7329 203d 3e20 6e6f 6465 732c  nodes) => nodes,
-00002f80: 0a20 2020 2020 2020 2045 7272 285f 6572  .        Err(_er
-00002f90: 7229 203d 3e20 7b0a 2020 2020 2020 2020  r) => {.        
-00002fa0: 2020 2020 7265 7475 726e 2045 7272 2844      return Err(D
-00002fb0: 4147 4861 7343 7963 6c65 3a3a 6e65 775f  AGHasCycle::new_
-00002fc0: 6572 7228 2253 6f72 7420 656e 636f 756e  err("Sort encoun
-00002fd0: 7465 7265 6420 6120 6379 636c 6522 2929  tered a cycle"))
-00002fe0: 0a20 2020 2020 2020 207d 0a20 2020 207d  .        }.    }
-00002ff0: 3b0a 2020 2020 4f6b 284e 6f64 6549 6e64  ;.    Ok(NodeInd
-00003000: 6963 6573 207b 0a20 2020 2020 2020 206e  ices {.        n
-00003010: 6f64 6573 3a20 6e6f 6465 732e 6974 6572  odes: nodes.iter
-00003020: 2829 2e6d 6170 287c 6e6f 6465 7c20 6e6f  ().map(|node| no
-00003030: 6465 2e69 6e64 6578 2829 292e 636f 6c6c  de.index()).coll
-00003040: 6563 7428 292c 0a20 2020 207d 290a 7d0a  ect(),.    }).}.
-00003050: 0a66 6e20 6466 735f 6564 6765 733c 473e  .fn dfs_edges<G>
-00003060: 280a 2020 2020 6772 6170 683a 2047 2c0a  (.    graph: G,.
-00003070: 2020 2020 736f 7572 6365 3a20 4f70 7469      source: Opti
-00003080: 6f6e 3c75 7369 7a65 3e2c 0a20 2020 2065  on<usize>,.    e
-00003090: 6467 655f 636f 756e 743a 2075 7369 7a65  dge_count: usize
-000030a0: 2c0a 2920 2d3e 2056 6563 3c28 7573 697a  ,.) -> Vec<(usiz
-000030b0: 652c 2075 7369 7a65 293e 0a77 6865 7265  e, usize)>.where
-000030c0: 0a20 2020 2047 3a20 4772 6170 6842 6173  .    G: GraphBas
-000030d0: 653c 4e6f 6465 4964 203d 204e 6f64 6549  e<NodeId = NodeI
-000030e0: 6e64 6578 3e0a 2020 2020 2020 2020 2b20  ndex>.        + 
-000030f0: 496e 746f 4e6f 6465 4964 656e 7469 6669  IntoNodeIdentifi
-00003100: 6572 730a 2020 2020 2020 2020 2b20 4e6f  ers.        + No
-00003110: 6465 496e 6465 7861 626c 650a 2020 2020  deIndexable.    
-00003120: 2020 2020 2b20 496e 746f 4e65 6967 6862      + IntoNeighb
-00003130: 6f72 730a 2020 2020 2020 2020 2b20 4e6f  ors.        + No
-00003140: 6465 436f 756e 740a 2020 2020 2020 2020  deCount.        
-00003150: 2b20 5669 7369 7461 626c 652c 0a20 2020  + Visitable,.   
-00003160: 203c 4720 6173 2056 6973 6974 6162 6c65   <G as Visitable
-00003170: 3e3a 3a4d 6170 3a20 5669 7369 744d 6170  >::Map: VisitMap
-00003180: 3c4e 6f64 6549 6e64 6578 3e2c 0a7b 0a20  <NodeIndex>,.{. 
-00003190: 2020 206c 6574 206e 6f64 6573 3a20 5665     let nodes: Ve
-000031a0: 633c 4e6f 6465 496e 6465 783e 203d 206d  c<NodeIndex> = m
-000031b0: 6174 6368 2073 6f75 7263 6520 7b0a 2020  atch source {.  
-000031c0: 2020 2020 2020 536f 6d65 2873 7461 7274        Some(start
-000031d0: 2920 3d3e 2076 6563 215b 4e6f 6465 496e  ) => vec![NodeIn
-000031e0: 6465 783a 3a6e 6577 2873 7461 7274 295d  dex::new(start)]
-000031f0: 2c0a 2020 2020 2020 2020 4e6f 6e65 203d  ,.        None =
-00003200: 3e20 6772 6170 680a 2020 2020 2020 2020  > graph.        
-00003210: 2020 2020 2e6e 6f64 655f 6964 656e 7469      .node_identi
-00003220: 6669 6572 7328 290a 2020 2020 2020 2020  fiers().        
-00003230: 2020 2020 2e6d 6170 287c 696e 647c 204e      .map(|ind| N
-00003240: 6f64 6549 6e64 6578 3a3a 6e65 7728 6772  odeIndex::new(gr
-00003250: 6170 682e 746f 5f69 6e64 6578 2869 6e64  aph.to_index(ind
-00003260: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-00003270: 2e63 6f6c 6c65 6374 2829 2c0a 2020 2020  .collect(),.    
-00003280: 7d3b 0a20 2020 206c 6574 206e 6f64 655f  };.    let node_
-00003290: 636f 756e 7420 3d20 6772 6170 682e 6e6f  count = graph.no
-000032a0: 6465 5f63 6f75 6e74 2829 3b0a 2020 2020  de_count();.    
-000032b0: 6c65 7420 6d75 7420 7669 7369 7465 643a  let mut visited:
-000032c0: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
-000032d0: 6578 3e20 3d20 4861 7368 5365 743a 3a77  ex> = HashSet::w
-000032e0: 6974 685f 6361 7061 6369 7479 286e 6f64  ith_capacity(nod
-000032f0: 655f 636f 756e 7429 3b0a 2020 2020 6c65  e_count);.    le
-00003300: 7420 6d75 7420 6f75 745f 7665 633a 2056  t mut out_vec: V
-00003310: 6563 3c28 7573 697a 652c 2075 7369 7a65  ec<(usize, usize
-00003320: 293e 203d 2056 6563 3a3a 7769 7468 5f63  )> = Vec::with_c
-00003330: 6170 6163 6974 7928 6564 6765 5f63 6f75  apacity(edge_cou
-00003340: 6e74 293b 0a20 2020 2066 6f72 2073 7461  nt);.    for sta
-00003350: 7274 2069 6e20 6e6f 6465 7320 7b0a 2020  rt in nodes {.  
-00003360: 2020 2020 2020 6966 2076 6973 6974 6564        if visited
-00003370: 2e63 6f6e 7461 696e 7328 2673 7461 7274  .contains(&start
-00003380: 2920 7b0a 2020 2020 2020 2020 2020 2020  ) {.            
-00003390: 636f 6e74 696e 7565 3b0a 2020 2020 2020  continue;.      
-000033a0: 2020 7d0a 2020 2020 2020 2020 7669 7369    }.        visi
-000033b0: 7465 642e 696e 7365 7274 2873 7461 7274  ted.insert(start
-000033c0: 293b 0a20 2020 2020 2020 206c 6574 206d  );.        let m
-000033d0: 7574 2063 6869 6c64 7265 6e3a 2056 6563  ut children: Vec
-000033e0: 3c4e 6f64 6549 6e64 6578 3e20 3d20 6772  <NodeIndex> = gr
-000033f0: 6170 682e 6e65 6967 6862 6f72 7328 7374  aph.neighbors(st
-00003400: 6172 7429 2e63 6f6c 6c65 6374 2829 3b0a  art).collect();.
-00003410: 2020 2020 2020 2020 6368 696c 6472 656e          children
-00003420: 2e72 6576 6572 7365 2829 3b0a 2020 2020  .reverse();.    
-00003430: 2020 2020 6c65 7420 6d75 7420 7374 6163      let mut stac
-00003440: 6b3a 2056 6563 3c28 4e6f 6465 496e 6465  k: Vec<(NodeInde
-00003450: 782c 2056 6563 3c4e 6f64 6549 6e64 6578  x, Vec<NodeIndex
-00003460: 3e29 3e20 3d0a 2020 2020 2020 2020 2020  >)> =.          
-00003470: 2020 7665 6321 5b28 7374 6172 742c 2063    vec![(start, c
-00003480: 6869 6c64 7265 6e29 5d3b 0a20 2020 2020  hildren)];.     
-00003490: 2020 202f 2f20 5573 6564 2074 6f20 7472     // Used to tr
-000034a0: 6163 6b20 7468 6520 6c61 7374 2070 6f73  ack the last pos
-000034b0: 6974 696f 6e20 696e 2063 6869 6c64 7265  ition in childre
-000034c0: 6e20 7665 6320 6163 726f 7373 2069 7465  n vec across ite
-000034d0: 7261 7469 6f6e 730a 2020 2020 2020 2020  rations.        
-000034e0: 6c65 7420 6d75 7420 696e 6465 785f 6d61  let mut index_ma
-000034f0: 703a 2048 6173 684d 6170 3c4e 6f64 6549  p: HashMap<NodeI
-00003500: 6e64 6578 2c20 7573 697a 653e 203d 0a20  ndex, usize> =. 
-00003510: 2020 2020 2020 2020 2020 2048 6173 684d             HashM
-00003520: 6170 3a3a 7769 7468 5f63 6170 6163 6974  ap::with_capacit
-00003530: 7928 6e6f 6465 5f63 6f75 6e74 293b 0a20  y(node_count);. 
-00003540: 2020 2020 2020 2069 6e64 6578 5f6d 6170         index_map
-00003550: 2e69 6e73 6572 7428 7374 6172 742c 2030  .insert(start, 0
-00003560: 293b 0a20 2020 2020 2020 2077 6869 6c65  );.        while
-00003570: 2021 7374 6163 6b2e 6973 5f65 6d70 7479   !stack.is_empty
-00003580: 2829 207b 0a20 2020 2020 2020 2020 2020  () {.           
-00003590: 206c 6574 2074 656d 705f 7061 7265 6e74   let temp_parent
-000035a0: 203d 2073 7461 636b 2e6c 6173 7428 292e   = stack.last().
-000035b0: 756e 7772 6170 2829 3b0a 2020 2020 2020  unwrap();.      
-000035c0: 2020 2020 2020 6c65 7420 7061 7265 6e74        let parent
-000035d0: 203d 2074 656d 705f 7061 7265 6e74 2e30   = temp_parent.0
-000035e0: 3b0a 2020 2020 2020 2020 2020 2020 6c65  ;.            le
-000035f0: 7420 6368 696c 6472 656e 203d 2074 656d  t children = tem
-00003600: 705f 7061 7265 6e74 2e31 2e63 6c6f 6e65  p_parent.1.clone
-00003610: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
-00003620: 6c65 7420 636f 756e 7420 3d20 2a69 6e64  let count = *ind
-00003630: 6578 5f6d 6170 2e67 6574 2826 7061 7265  ex_map.get(&pare
-00003640: 6e74 292e 756e 7772 6170 2829 3b0a 2020  nt).unwrap();.  
-00003650: 2020 2020 2020 2020 2020 6c65 7420 6d75            let mu
-00003660: 7420 666f 756e 6420 3d20 6661 6c73 653b  t found = false;
-00003670: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
-00003680: 206d 7574 2069 6e64 6578 203d 2063 6f75   mut index = cou
-00003690: 6e74 3b0a 2020 2020 2020 2020 2020 2020  nt;.            
-000036a0: 666f 7220 6368 696c 6420 696e 2026 6368  for child in &ch
-000036b0: 696c 6472 656e 5b69 6e64 6578 2e2e 5d20  ildren[index..] 
-000036c0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-000036d0: 2020 696e 6465 7820 2b3d 2031 3b0a 2020    index += 1;.  
-000036e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000036f0: 2021 7669 7369 7465 642e 636f 6e74 6169   !visited.contai
-00003700: 6e73 2826 6368 696c 6429 207b 0a20 2020  ns(&child) {.   
-00003710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003720: 206f 7574 5f76 6563 2e70 7573 6828 2870   out_vec.push((p
-00003730: 6172 656e 742e 696e 6465 7828 292c 2063  arent.index(), c
-00003740: 6869 6c64 2e69 6e64 6578 2829 2929 3b0a  hild.index()));.
-00003750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003760: 2020 2020 7669 7369 7465 642e 696e 7365      visited.inse
-00003770: 7274 282a 6368 696c 6429 3b0a 2020 2020  rt(*child);.    
-00003780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003790: 6c65 7420 6d75 7420 6772 616e 6463 6869  let mut grandchi
-000037a0: 6c64 7265 6e3a 2056 6563 3c4e 6f64 6549  ldren: Vec<NodeI
-000037b0: 6e64 6578 3e20 3d0a 2020 2020 2020 2020  ndex> =.        
-000037c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037d0: 6772 6170 682e 6e65 6967 6862 6f72 7328  graph.neighbors(
-000037e0: 2a63 6869 6c64 292e 636f 6c6c 6563 7428  *child).collect(
-000037f0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-00003800: 2020 2020 2020 2067 7261 6e64 6368 696c         grandchil
-00003810: 6472 656e 2e72 6576 6572 7365 2829 3b0a  dren.reverse();.
-00003820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003830: 2020 2020 7374 6163 6b2e 7075 7368 2828      stack.push((
-00003840: 2a63 6869 6c64 2c20 6772 616e 6463 6869  *child, grandchi
-00003850: 6c64 7265 6e29 293b 0a20 2020 2020 2020  ldren));.       
-00003860: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00003870: 6578 5f6d 6170 2e69 6e73 6572 7428 2a63  ex_map.insert(*c
-00003880: 6869 6c64 2c20 3029 3b0a 2020 2020 2020  hild, 0);.      
-00003890: 2020 2020 2020 2020 2020 2020 2020 2a69                *i
-000038a0: 6e64 6578 5f6d 6170 2e67 6574 5f6d 7574  ndex_map.get_mut
-000038b0: 2826 7061 7265 6e74 292e 756e 7772 6170  (&parent).unwrap
-000038c0: 2829 203d 2069 6e64 6578 3b0a 2020 2020  () = index;.    
-000038d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000038e0: 666f 756e 6420 3d20 7472 7565 3b0a 2020  found = true;.  
-000038f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003900: 2020 6272 6561 6b3b 0a20 2020 2020 2020    break;.       
-00003910: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00003920: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00003930: 2020 2020 2069 6620 2166 6f75 6e64 207c       if !found |
-00003940: 7c20 6368 696c 6472 656e 2e69 735f 656d  | children.is_em
-00003950: 7074 7928 2920 7b0a 2020 2020 2020 2020  pty() {.        
-00003960: 2020 2020 2020 2020 7374 6163 6b2e 706f          stack.po
-00003970: 7028 293b 0a20 2020 2020 2020 2020 2020  p();.           
-00003980: 207d 0a20 2020 2020 2020 207d 0a20 2020   }.        }.   
-00003990: 207d 0a20 2020 206f 7574 5f76 6563 0a7d   }.    out_vec.}
-000039a0: 0a0a 2f2f 2f20 4765 7420 6564 6765 206c  ../// Get edge l
-000039b0: 6973 7420 696e 2064 6570 7468 2066 6972  ist in depth fir
-000039c0: 7374 206f 7264 6572 0a2f 2f2f 0a2f 2f2f  st order.///.///
-000039d0: 203a 7061 7261 6d20 5079 4469 4772 6170   :param PyDiGrap
-000039e0: 6820 6772 6170 683a 2054 6865 2067 7261  h graph: The gra
-000039f0: 7068 2074 6f20 6765 7420 7468 6520 4446  ph to get the DF
-00003a00: 5320 6564 6765 206c 6973 7420 6672 6f6d  S edge list from
-00003a10: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
-00003a20: 736f 7572 6365 3a20 416e 206f 7074 696f  source: An optio
-00003a30: 6e61 6c20 6e6f 6465 2069 6e64 6578 2074  nal node index t
-00003a40: 6f20 7573 6520 6173 2074 6865 2073 7461  o use as the sta
-00003a50: 7274 696e 6720 6e6f 6465 0a2f 2f2f 2020  rting node.///  
-00003a60: 2020 2066 6f72 2074 6865 2064 6570 7468     for the depth
-00003a70: 2d66 6972 7374 2073 6561 7263 682e 2054  -first search. T
-00003a80: 6865 2065 6467 6520 6c69 7374 2077 696c  he edge list wil
-00003a90: 6c20 6f6e 6c79 2072 6574 7572 6e20 6564  l only return ed
-00003aa0: 6765 7320 696e 0a2f 2f2f 2020 2020 2074  ges in.///     t
-00003ab0: 6865 2063 6f6d 706f 6e65 6e74 7320 7265  he components re
-00003ac0: 6163 6861 626c 6520 6672 6f6d 2074 6869  achable from thi
-00003ad0: 7320 696e 6465 782e 2049 6620 7468 6973  s index. If this
-00003ae0: 2069 7320 6e6f 7420 7370 6563 6966 6965   is not specifie
-00003af0: 640a 2f2f 2f20 2020 2020 7468 656e 2061  d.///     then a
-00003b00: 2073 6f75 7263 6520 7769 6c6c 2062 6520   source will be 
-00003b10: 6368 6f73 656e 2061 7262 6974 7261 726c  chosen arbitrarl
-00003b20: 7920 616e 6420 7265 7065 6174 6564 2075  y and repeated u
-00003b30: 6e74 696c 2061 6c6c 0a2f 2f2f 2020 2020  ntil all.///    
-00003b40: 2063 6f6d 706f 6e65 6e74 7320 6f66 2074   components of t
-00003b50: 6865 2067 7261 7068 2061 7265 2073 6561  he graph are sea
-00003b60: 7263 6865 642e 0a2f 2f2f 0a2f 2f2f 203a  rched..///./// :
-00003b70: 7265 7475 726e 733a 2041 206c 6973 7420  returns: A list 
-00003b80: 6f66 2065 6467 6573 2061 7320 6120 7475  of edges as a tu
-00003b90: 706c 6520 6f66 2074 6865 2066 6f72 6d20  ple of the form 
-00003ba0: 6060 2873 6f75 7263 652c 2074 6172 6765  ``(source, targe
-00003bb0: 7429 6060 2069 6e0a 2f2f 2f20 2020 2020  t)`` in.///     
-00003bc0: 6465 7074 682d 6669 7273 7420 6f72 6465  depth-first orde
-00003bd0: 720a 2f2f 2f20 3a72 7479 7065 3a20 4564  r./// :rtype: Ed
-00003be0: 6765 4c69 7374 0a23 5b70 7966 756e 6374  geList.#[pyfunct
-00003bf0: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
-00003c00: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
-00003c10: 202f 2c20 736f 7572 6365 3d4e 6f6e 6529   /, source=None)
-00003c20: 225d 0a66 6e20 6469 6772 6170 685f 6466  "].fn digraph_df
-00003c30: 735f 6564 6765 7328 0a20 2020 2067 7261  s_edges(.    gra
-00003c40: 7068 3a20 2664 6967 7261 7068 3a3a 5079  ph: &digraph::Py
-00003c50: 4469 4772 6170 682c 0a20 2020 2073 6f75  DiGraph,.    sou
-00003c60: 7263 653a 204f 7074 696f 6e3c 7573 697a  rce: Option<usiz
-00003c70: 653e 2c0a 2920 2d3e 2045 6467 654c 6973  e>,.) -> EdgeLis
-00003c80: 7420 7b0a 2020 2020 4564 6765 4c69 7374  t {.    EdgeList
-00003c90: 207b 0a20 2020 2020 2020 2065 6467 6573   {.        edges
-00003ca0: 3a20 6466 735f 6564 6765 7328 6772 6170  : dfs_edges(grap
-00003cb0: 682c 2073 6f75 7263 652c 2067 7261 7068  h, source, graph
-00003cc0: 2e67 7261 7068 2e65 6467 655f 636f 756e  .graph.edge_coun
-00003cd0: 7428 2929 2c0a 2020 2020 7d0a 7d0a 0a2f  t()),.    }.}../
-00003ce0: 2f2f 2047 6574 2065 6467 6520 6c69 7374  // Get edge list
-00003cf0: 2069 6e20 6465 7074 6820 6669 7273 7420   in depth first 
-00003d00: 6f72 6465 720a 2f2f 2f0a 2f2f 2f20 3a70  order.///./// :p
-00003d10: 6172 616d 2050 7947 7261 7068 2067 7261  aram PyGraph gra
-00003d20: 7068 3a20 5468 6520 6772 6170 6820 746f  ph: The graph to
-00003d30: 2067 6574 2074 6865 2044 4653 2065 6467   get the DFS edg
-00003d40: 6520 6c69 7374 2066 726f 6d0a 2f2f 2f20  e list from./// 
-00003d50: 3a70 6172 616d 2069 6e74 2073 6f75 7263  :param int sourc
-00003d60: 653a 2041 6e20 6f70 7469 6f6e 616c 206e  e: An optional n
-00003d70: 6f64 6520 696e 6465 7820 746f 2075 7365  ode index to use
-00003d80: 2061 7320 7468 6520 7374 6172 7469 6e67   as the starting
-00003d90: 206e 6f64 650a 2f2f 2f20 2020 2020 666f   node.///     fo
-00003da0: 7220 7468 6520 6465 7074 682d 6669 7273  r the depth-firs
-00003db0: 7420 7365 6172 6368 2e20 5468 6520 6564  t search. The ed
-00003dc0: 6765 206c 6973 7420 7769 6c6c 206f 6e6c  ge list will onl
-00003dd0: 7920 7265 7475 726e 2065 6467 6573 2069  y return edges i
-00003de0: 6e0a 2f2f 2f20 2020 2020 7468 6520 636f  n.///     the co
-00003df0: 6d70 6f6e 656e 7473 2072 6561 6368 6162  mponents reachab
-00003e00: 6c65 2066 726f 6d20 7468 6973 2069 6e64  le from this ind
-00003e10: 6578 2e20 4966 2074 6869 7320 6973 206e  ex. If this is n
-00003e20: 6f74 2073 7065 6369 6669 6564 0a2f 2f2f  ot specified.///
-00003e30: 2020 2020 2074 6865 6e20 6120 736f 7572       then a sour
-00003e40: 6365 2077 696c 6c20 6265 2063 686f 7365  ce will be chose
-00003e50: 6e20 6172 6269 7472 6172 6c79 2061 6e64  n arbitrarly and
-00003e60: 2072 6570 6561 7465 6420 756e 7469 6c20   repeated until 
-00003e70: 616c 6c0a 2f2f 2f20 2020 2020 636f 6d70  all.///     comp
-00003e80: 6f6e 656e 7473 206f 6620 7468 6520 6772  onents of the gr
-00003e90: 6170 6820 6172 6520 7365 6172 6368 6564  aph are searched
-00003ea0: 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  ..///./// :retur
-00003eb0: 6e73 3a20 4120 6c69 7374 206f 6620 6564  ns: A list of ed
-00003ec0: 6765 7320 6173 2061 2074 7570 6c65 206f  ges as a tuple o
-00003ed0: 6620 7468 6520 666f 726d 2060 6028 736f  f the form ``(so
-00003ee0: 7572 6365 2c20 7461 7267 6574 2960 6020  urce, target)`` 
-00003ef0: 696e 0a2f 2f2f 2020 2020 2064 6570 7468  in.///     depth
-00003f00: 2d66 6972 7374 206f 7264 6572 0a2f 2f2f  -first order.///
-00003f10: 203a 7274 7970 653a 2045 6467 654c 6973   :rtype: EdgeLis
-00003f20: 740a 235b 7079 6675 6e63 7469 6f6e 5d0a  t.#[pyfunction].
-00003f30: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
-00003f40: 203d 2022 2867 7261 7068 2c20 2f2c 2073   = "(graph, /, s
-00003f50: 6f75 7263 653d 4e6f 6e65 2922 5d0a 666e  ource=None)"].fn
-00003f60: 2067 7261 7068 5f64 6673 5f65 6467 6573   graph_dfs_edges
-00003f70: 2867 7261 7068 3a20 2667 7261 7068 3a3a  (graph: &graph::
-00003f80: 5079 4772 6170 682c 2073 6f75 7263 653a  PyGraph, source:
-00003f90: 204f 7074 696f 6e3c 7573 697a 653e 2920   Option<usize>) 
-00003fa0: 2d3e 2045 6467 654c 6973 7420 7b0a 2020  -> EdgeList {.  
-00003fb0: 2020 4564 6765 4c69 7374 207b 0a20 2020    EdgeList {.   
-00003fc0: 2020 2020 2065 6467 6573 3a20 6466 735f       edges: dfs_
-00003fd0: 6564 6765 7328 6772 6170 682c 2073 6f75  edges(graph, sou
-00003fe0: 7263 652c 2067 7261 7068 2e67 7261 7068  rce, graph.graph
-00003ff0: 2e65 6467 655f 636f 756e 7428 2929 2c0a  .edge_count()),.
-00004000: 2020 2020 7d0a 7d0a 0a2f 2f2f 2052 6574      }.}../// Ret
-00004010: 7572 6e20 7375 6363 6573 736f 7273 2069  urn successors i
-00004020: 6e20 6120 6272 6561 6474 682d 6669 7273  n a breadth-firs
-00004030: 742d 7365 6172 6368 2066 726f 6d20 6120  t-search from a 
-00004040: 736f 7572 6365 206e 6f64 652e 0a2f 2f2f  source node..///
-00004050: 0a2f 2f2f 2054 6865 2072 6574 7572 6e20  ./// The return 
-00004060: 666f 726d 6174 2069 7320 6060 5b28 5061  format is ``[(Pa
-00004070: 7265 6e74 204e 6f64 652c 205b 4368 696c  rent Node, [Chil
-00004080: 6472 656e 204e 6f64 6573 5d29 5d60 6020  dren Nodes])]`` 
-00004090: 696e 2061 2062 6673 206f 7264 6572 0a2f  in a bfs order./
-000040a0: 2f2f 2066 726f 6d20 7468 6520 736f 7572  // from the sour
-000040b0: 6365 206e 6f64 6520 7072 6f76 6964 6564  ce node provided
-000040c0: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
-000040d0: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
-000040e0: 3a20 5468 6520 4441 4720 746f 2067 6574  : The DAG to get
-000040f0: 2074 6865 2062 6673 5f73 7563 6365 7373   the bfs_success
-00004100: 6f72 7320 6672 6f6d 0a2f 2f2f 203a 7061  ors from./// :pa
-00004110: 7261 6d20 696e 7420 6e6f 6465 3a20 5468  ram int node: Th
-00004120: 6520 696e 6465 7820 6f66 2074 6865 2064  e index of the d
-00004130: 6167 206e 6f64 6520 746f 2067 6574 2074  ag node to get t
-00004140: 6865 2062 6673 2073 7563 6365 7373 6f72  he bfs successor
-00004150: 7320 666f 720a 2f2f 2f0a 2f2f 2f20 3a72  s for.///./// :r
-00004160: 6574 7572 6e73 3a20 4120 6c69 7374 206f  eturns: A list o
-00004170: 6620 6e6f 6465 7327 7320 6461 7461 2061  f nodes's data a
-00004180: 6e64 2074 6865 6972 2063 6869 6c64 7265  nd their childre
-00004190: 6e20 696e 2062 6673 206f 7264 6572 2e20  n in bfs order. 
-000041a0: 5468 650a 2f2f 2f20 2020 2020 4246 5353  The.///     BFSS
-000041b0: 7563 6365 7373 6f72 7320 636c 6173 7320  uccessors class 
-000041c0: 7468 6174 2069 7320 7265 7475 726e 6564  that is returned
-000041d0: 2069 7320 6120 6375 7374 6f6d 2063 6f6e   is a custom con
-000041e0: 7461 696e 6572 2063 6c61 7373 2074 6861  tainer class tha
-000041f0: 740a 2f2f 2f20 2020 2020 696d 706c 656d  t.///     implem
-00004200: 656e 7473 2074 6865 2073 6571 7565 6e63  ents the sequenc
-00004210: 6520 7072 6f74 6f63 6f6c 2e20 5468 6973  e protocol. This
-00004220: 2063 616e 2062 6520 7573 6564 2061 7320   can be used as 
-00004230: 6120 7079 7468 6f6e 206c 6973 740a 2f2f  a python list.//
-00004240: 2f20 2020 2020 7769 7468 2069 6e64 6578  /     with index
-00004250: 2062 6173 6564 2061 6363 6573 732e 0a2f   based access../
-00004260: 2f2f 203a 7274 7970 653a 2042 4653 5375  // :rtype: BFSSu
-00004270: 6363 6573 736f 7273 0a23 5b70 7966 756e  ccessors.#[pyfun
-00004280: 6374 696f 6e5d 0a23 5b74 6578 745f 7369  ction].#[text_si
-00004290: 676e 6174 7572 6520 3d20 2228 6772 6170  gnature = "(grap
-000042a0: 682c 206e 6f64 652c 202f 2922 5d0a 666e  h, node, /)"].fn
-000042b0: 2062 6673 5f73 7563 6365 7373 6f72 7328   bfs_successors(
-000042c0: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
-000042d0: 0a20 2020 2067 7261 7068 3a20 2664 6967  .    graph: &dig
-000042e0: 7261 7068 3a3a 5079 4469 4772 6170 682c  raph::PyDiGraph,
-000042f0: 0a20 2020 206e 6f64 653a 2075 7369 7a65  .    node: usize
-00004300: 2c0a 2920 2d3e 2069 7465 7261 746f 7273  ,.) -> iterators
-00004310: 3a3a 4246 5353 7563 6365 7373 6f72 7320  ::BFSSuccessors 
-00004320: 7b0a 2020 2020 6c65 7420 696e 6465 7820  {.    let index 
-00004330: 3d20 4e6f 6465 496e 6465 783a 3a6e 6577  = NodeIndex::new
-00004340: 286e 6f64 6529 3b0a 2020 2020 6c65 7420  (node);.    let 
-00004350: 6d75 7420 6266 7320 3d20 4266 733a 3a6e  mut bfs = Bfs::n
-00004360: 6577 2867 7261 7068 2c20 696e 6465 7829  ew(graph, index)
-00004370: 3b0a 2020 2020 6c65 7420 6d75 7420 6f75  ;.    let mut ou
-00004380: 745f 6c69 7374 3a20 5665 633c 2850 794f  t_list: Vec<(PyO
-00004390: 626a 6563 742c 2056 6563 3c50 794f 626a  bject, Vec<PyObj
-000043a0: 6563 743e 293e 203d 0a20 2020 2020 2020  ect>)> =.       
-000043b0: 2056 6563 3a3a 7769 7468 5f63 6170 6163   Vec::with_capac
-000043c0: 6974 7928 6772 6170 682e 6e6f 6465 5f63  ity(graph.node_c
-000043d0: 6f75 6e74 2829 293b 0a20 2020 2077 6869  ount());.    whi
-000043e0: 6c65 206c 6574 2053 6f6d 6528 6e78 2920  le let Some(nx) 
-000043f0: 3d20 6266 732e 6e65 7874 2867 7261 7068  = bfs.next(graph
-00004400: 2920 7b0a 2020 2020 2020 2020 6c65 7420  ) {.        let 
-00004410: 6368 696c 6472 656e 203d 2067 7261 7068  children = graph
-00004420: 0a20 2020 2020 2020 2020 2020 202e 6772  .            .gr
-00004430: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
-00004440: 2e6e 6569 6768 626f 7273 5f64 6972 6563  .neighbors_direc
-00004450: 7465 6428 6e78 2c20 7065 7467 7261 7068  ted(nx, petgraph
-00004460: 3a3a 4469 7265 6374 696f 6e3a 3a4f 7574  ::Direction::Out
-00004470: 676f 696e 6729 3b0a 2020 2020 2020 2020  going);.        
-00004480: 6c65 7420 6d75 7420 7375 6363 6573 6f72  let mut succesor
-00004490: 733a 2056 6563 3c50 794f 626a 6563 743e  s: Vec<PyObject>
-000044a0: 203d 2056 6563 3a3a 6e65 7728 293b 0a20   = Vec::new();. 
-000044b0: 2020 2020 2020 2066 6f72 2073 7563 6320         for succ 
-000044c0: 696e 2063 6869 6c64 7265 6e20 7b0a 2020  in children {.  
-000044d0: 2020 2020 2020 2020 2020 7375 6363 6573            succes
-000044e0: 6f72 730a 2020 2020 2020 2020 2020 2020  ors.            
-000044f0: 2020 2020 2e70 7573 6828 6772 6170 682e      .push(graph.
-00004500: 6772 6170 682e 6e6f 6465 5f77 6569 6768  graph.node_weigh
-00004510: 7428 7375 6363 292e 756e 7772 6170 2829  t(succ).unwrap()
-00004520: 2e63 6c6f 6e65 5f72 6566 2870 7929 293b  .clone_ref(py));
-00004530: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00004540: 2020 2069 6620 2173 7563 6365 736f 7273     if !succesors
-00004550: 2e69 735f 656d 7074 7928 2920 7b0a 2020  .is_empty() {.  
-00004560: 2020 2020 2020 2020 2020 6f75 745f 6c69            out_li
-00004570: 7374 2e70 7573 6828 280a 2020 2020 2020  st.push((.      
-00004580: 2020 2020 2020 2020 2020 6772 6170 682e            graph.
-00004590: 6772 6170 682e 6e6f 6465 5f77 6569 6768  graph.node_weigh
-000045a0: 7428 6e78 292e 756e 7772 6170 2829 2e63  t(nx).unwrap().c
-000045b0: 6c6f 6e65 5f72 6566 2870 7929 2c0a 2020  lone_ref(py),.  
-000045c0: 2020 2020 2020 2020 2020 2020 2020 7375                su
-000045d0: 6363 6573 6f72 732c 0a20 2020 2020 2020  ccesors,.       
-000045e0: 2020 2020 2029 293b 0a20 2020 2020 2020       ));.       
-000045f0: 207d 0a20 2020 207d 0a20 2020 2069 7465   }.    }.    ite
-00004600: 7261 746f 7273 3a3a 4246 5353 7563 6365  rators::BFSSucce
-00004610: 7373 6f72 7320 7b0a 2020 2020 2020 2020  ssors {.        
-00004620: 6266 735f 7375 6363 6573 736f 7273 3a20  bfs_successors: 
-00004630: 6f75 745f 6c69 7374 2c0a 2020 2020 7d0a  out_list,.    }.
-00004640: 7d0a 0a2f 2f2f 2052 6574 7572 6e20 7468  }../// Return th
-00004650: 6520 616e 6365 7374 6f72 7320 6f66 2061  e ancestors of a
-00004660: 206e 6f64 6520 696e 2061 2067 7261 7068   node in a graph
-00004670: 2e0a 2f2f 2f0a 2f2f 2f20 5468 6973 2064  ..///./// This d
-00004680: 6966 6665 7273 2066 726f 6d20 3a6d 6574  iffers from :met
-00004690: 683a 6050 7944 6947 7261 7068 2e70 7265  h:`PyDiGraph.pre
-000046a0: 6465 6365 7373 6f72 7360 206d 6574 686f  decessors` metho
-000046b0: 6420 2069 6e20 7468 6174 0a2f 2f2f 2060  d  in that./// `
-000046c0: 6070 7265 6465 6365 7373 6f72 7360 6020  `predecessors`` 
-000046d0: 7265 7475 726e 7320 6f6e 6c79 206e 6f64  returns only nod
-000046e0: 6573 2077 6974 6820 6120 6469 7265 6374  es with a direct
-000046f0: 2065 6467 6520 696e 746f 2074 6865 2070   edge into the p
-00004700: 726f 7669 6465 640a 2f2f 2f20 6e6f 6465  rovided./// node
-00004710: 2e20 5768 696c 6520 7468 6973 2066 756e  . While this fun
-00004720: 6374 696f 6e20 7265 7475 726e 7320 616c  ction returns al
-00004730: 6c20 6e6f 6465 7320 7468 6174 2068 6176  l nodes that hav
-00004740: 6520 6120 7061 7468 2069 6e74 6f20 7468  e a path into th
-00004750: 650a 2f2f 2f20 7072 6f76 6964 6564 206e  e./// provided n
-00004760: 6f64 652e 0a2f 2f2f 0a2f 2f2f 203a 7061  ode..///./// :pa
-00004770: 7261 6d20 5079 4469 4772 6170 6820 6772  ram PyDiGraph gr
-00004780: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
-00004790: 6f20 6765 7420 7468 6520 6465 7363 656e  o get the descen
-000047a0: 6461 6e74 7320 6672 6f6d 0a2f 2f2f 203a  dants from./// :
-000047b0: 7061 7261 6d20 696e 7420 6e6f 6465 3a20  param int node: 
-000047c0: 5468 6520 696e 6465 7820 6f66 2074 6865  The index of the
-000047d0: 2067 7261 7068 206e 6f64 6520 746f 2067   graph node to g
-000047e0: 6574 2074 6865 2061 6e63 6573 746f 7273  et the ancestors
-000047f0: 2066 6f72 0a2f 2f2f 0a2f 2f2f 203a 7265   for.///./// :re
-00004800: 7475 726e 733a 2041 206c 6973 7420 6f66  turns: A list of
-00004810: 206e 6f64 6520 696e 6465 7865 7320 6f66   node indexes of
-00004820: 2061 6e63 6573 746f 7273 206f 6620 7072   ancestors of pr
-00004830: 6f76 6964 6564 206e 6f64 652e 0a2f 2f2f  ovided node..///
-00004840: 203a 7274 7970 653a 206c 6973 740a 235b   :rtype: list.#[
-00004850: 7079 6675 6e63 7469 6f6e 5d0a 235b 7465  pyfunction].#[te
-00004860: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
-00004870: 2867 7261 7068 2c20 6e6f 6465 2c20 2f29  (graph, node, /)
-00004880: 225d 0a66 6e20 616e 6365 7374 6f72 7328  "].fn ancestors(
-00004890: 6772 6170 683a 2026 6469 6772 6170 683a  graph: &digraph:
-000048a0: 3a50 7944 6947 7261 7068 2c20 6e6f 6465  :PyDiGraph, node
-000048b0: 3a20 7573 697a 6529 202d 3e20 4861 7368  : usize) -> Hash
-000048c0: 5365 743c 7573 697a 653e 207b 0a20 2020  Set<usize> {.   
-000048d0: 206c 6574 2069 6e64 6578 203d 204e 6f64   let index = Nod
-000048e0: 6549 6e64 6578 3a3a 6e65 7728 6e6f 6465  eIndex::new(node
-000048f0: 293b 0a20 2020 206c 6574 206d 7574 206f  );.    let mut o
-00004900: 7574 5f73 6574 3a20 4861 7368 5365 743c  ut_set: HashSet<
-00004910: 7573 697a 653e 203d 2048 6173 6853 6574  usize> = HashSet
-00004920: 3a3a 6e65 7728 293b 0a20 2020 206c 6574  ::new();.    let
-00004930: 2072 6576 6572 7365 5f67 7261 7068 203d   reverse_graph =
-00004940: 2052 6576 6572 7365 6428 6772 6170 6829   Reversed(graph)
-00004950: 3b0a 2020 2020 6c65 7420 7265 7320 3d20  ;.    let res = 
-00004960: 616c 676f 3a3a 6469 6a6b 7374 7261 2872  algo::dijkstra(r
-00004970: 6576 6572 7365 5f67 7261 7068 2c20 696e  everse_graph, in
-00004980: 6465 782c 204e 6f6e 652c 207c 5f7c 2031  dex, None, |_| 1
-00004990: 293b 0a20 2020 2066 6f72 206e 2069 6e20  );.    for n in 
-000049a0: 7265 732e 6b65 7973 2829 207b 0a20 2020  res.keys() {.   
-000049b0: 2020 2020 206c 6574 206e 5f69 6e74 203d       let n_int =
-000049c0: 206e 2e69 6e64 6578 2829 3b0a 2020 2020   n.index();.    
-000049d0: 2020 2020 6f75 745f 7365 742e 696e 7365      out_set.inse
-000049e0: 7274 286e 5f69 6e74 293b 0a20 2020 207d  rt(n_int);.    }
-000049f0: 0a20 2020 206f 7574 5f73 6574 2e72 656d  .    out_set.rem
-00004a00: 6f76 6528 266e 6f64 6529 3b0a 2020 2020  ove(&node);.    
-00004a10: 6f75 745f 7365 740a 7d0a 0a2f 2f2f 2052  out_set.}../// R
-00004a20: 6574 7572 6e20 7468 6520 6465 7363 656e  eturn the descen
-00004a30: 6461 6e74 7320 6f66 2061 206e 6f64 6520  dants of a node 
-00004a40: 696e 2061 2067 7261 7068 2e0a 2f2f 2f0a  in a graph..///.
-00004a50: 2f2f 2f20 5468 6973 2064 6966 6665 7273  /// This differs
-00004a60: 2066 726f 6d20 3a6d 6574 683a 6050 7944   from :meth:`PyD
-00004a70: 6947 7261 7068 2e73 7563 6365 7373 6f72  iGraph.successor
-00004a80: 7360 206d 6574 686f 6420 696e 2074 6861  s` method in tha
-00004a90: 740a 2f2f 2f20 6060 7375 6363 6573 736f  t./// ``successo
-00004aa0: 7273 6060 6020 7265 7475 726e 7320 6f6e  rs``` returns on
-00004ab0: 6c79 206e 6f64 6573 2077 6974 6820 6120  ly nodes with a 
-00004ac0: 6469 7265 6374 2065 6467 6520 6f75 7420  direct edge out 
-00004ad0: 6f66 2074 6865 2070 726f 7669 6465 640a  of the provided.
-00004ae0: 2f2f 2f20 6e6f 6465 2e20 5768 696c 6520  /// node. While 
-00004af0: 7468 6973 2066 756e 6374 696f 6e20 7265  this function re
-00004b00: 7475 726e 7320 616c 6c20 6e6f 6465 7320  turns all nodes 
-00004b10: 7468 6174 2068 6176 6520 6120 7061 7468  that have a path
-00004b20: 2066 726f 6d20 7468 650a 2f2f 2f20 7072   from the./// pr
-00004b30: 6f76 6964 6564 206e 6f64 652e 0a2f 2f2f  ovided node..///
-00004b40: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
-00004b50: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-00004b60: 2067 7261 7068 2074 6f20 6765 7420 7468   graph to get th
-00004b70: 6520 6465 7363 656e 6461 6e74 7320 6672  e descendants fr
-00004b80: 6f6d 0a2f 2f2f 203a 7061 7261 6d20 696e  om./// :param in
-00004b90: 7420 6e6f 6465 3a20 5468 6520 696e 6465  t node: The inde
-00004ba0: 7820 6f66 2074 6865 2067 7261 7068 206e  x of the graph n
-00004bb0: 6f64 6520 746f 2067 6574 2074 6865 2064  ode to get the d
-00004bc0: 6573 6365 6e64 616e 7473 2066 6f72 0a2f  escendants for./
-00004bd0: 2f2f 0a2f 2f2f 203a 7265 7475 726e 733a  //./// :returns:
-00004be0: 2041 206c 6973 7420 6f66 206e 6f64 6520   A list of node 
-00004bf0: 696e 6465 7865 7320 6f66 2064 6573 6365  indexes of desce
-00004c00: 6e64 616e 7473 206f 6620 7072 6f76 6964  ndants of provid
-00004c10: 6564 206e 6f64 652e 0a2f 2f2f 203a 7274  ed node../// :rt
-00004c20: 7970 653a 206c 6973 740a 235b 7079 6675  ype: list.#[pyfu
-00004c30: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
-00004c40: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
-00004c50: 7068 2c20 6e6f 6465 2c20 2f29 225d 0a66  ph, node, /)"].f
-00004c60: 6e20 6465 7363 656e 6461 6e74 7328 6772  n descendants(gr
-00004c70: 6170 683a 2026 6469 6772 6170 683a 3a50  aph: &digraph::P
-00004c80: 7944 6947 7261 7068 2c20 6e6f 6465 3a20  yDiGraph, node: 
-00004c90: 7573 697a 6529 202d 3e20 4861 7368 5365  usize) -> HashSe
-00004ca0: 743c 7573 697a 653e 207b 0a20 2020 206c  t<usize> {.    l
-00004cb0: 6574 2069 6e64 6578 203d 204e 6f64 6549  et index = NodeI
-00004cc0: 6e64 6578 3a3a 6e65 7728 6e6f 6465 293b  ndex::new(node);
-00004cd0: 0a20 2020 206c 6574 206d 7574 206f 7574  .    let mut out
-00004ce0: 5f73 6574 3a20 4861 7368 5365 743c 7573  _set: HashSet<us
-00004cf0: 697a 653e 203d 2048 6173 6853 6574 3a3a  ize> = HashSet::
-00004d00: 6e65 7728 293b 0a20 2020 206c 6574 2072  new();.    let r
-00004d10: 6573 203d 2061 6c67 6f3a 3a64 696a 6b73  es = algo::dijks
-00004d20: 7472 6128 6772 6170 682c 2069 6e64 6578  tra(graph, index
-00004d30: 2c20 4e6f 6e65 2c20 7c5f 7c20 3129 3b0a  , None, |_| 1);.
-00004d40: 2020 2020 666f 7220 6e20 696e 2072 6573      for n in res
-00004d50: 2e6b 6579 7328 2920 7b0a 2020 2020 2020  .keys() {.      
-00004d60: 2020 6c65 7420 6e5f 696e 7420 3d20 6e2e    let n_int = n.
-00004d70: 696e 6465 7828 293b 0a20 2020 2020 2020  index();.       
-00004d80: 206f 7574 5f73 6574 2e69 6e73 6572 7428   out_set.insert(
-00004d90: 6e5f 696e 7429 3b0a 2020 2020 7d0a 2020  n_int);.    }.  
-00004da0: 2020 6f75 745f 7365 742e 7265 6d6f 7665    out_set.remove
-00004db0: 2826 6e6f 6465 293b 0a20 2020 206f 7574  (&node);.    out
-00004dc0: 5f73 6574 0a7d 0a0a 2f2f 2f20 4765 7420  _set.}../// Get 
-00004dd0: 7468 6520 6c65 7869 636f 6772 6170 6869  the lexicographi
-00004de0: 6361 6c20 746f 706f 6c6f 6769 6361 6c20  cal topological 
-00004df0: 736f 7274 6564 206e 6f64 6573 2066 726f  sorted nodes fro
-00004e00: 6d20 7468 6520 7072 6f76 6964 6564 2044  m the provided D
-00004e10: 4147 0a2f 2f2f 2020 0a2f 2f2f 2054 6869  AG.///  ./// Thi
-00004e20: 7320 6675 6e63 7469 6f6e 2072 6574 7572  s function retur
-00004e30: 6e73 2061 206c 6973 7420 6f66 206e 6f64  ns a list of nod
-00004e40: 6573 2064 6174 6120 696e 2061 2067 7261  es data in a gra
-00004e50: 7068 206c 6578 6963 6f67 7261 7068 6963  ph lexicographic
-00004e60: 616c 6c79 0a2f 2f2f 2074 6f70 6f6c 6f67  ally./// topolog
-00004e70: 6963 616c 6c79 2073 6f72 7465 6420 7573  ically sorted us
-00004e80: 696e 6720 7468 6520 7072 6f76 6964 6564  ing the provided
-00004e90: 206b 6579 2066 756e 6374 696f 6e2e 0a2f   key function../
-00004ea0: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
-00004eb0: 4469 4772 6170 6820 6461 673a 2054 6865  DiGraph dag: The
-00004ec0: 2044 4147 2074 6f20 6765 7420 7468 6520   DAG to get the 
-00004ed0: 746f 706f 6c6f 6769 6361 6c20 736f 7274  topological sort
-00004ee0: 6564 206e 6f64 6573 2066 726f 6d0a 2f2f  ed nodes from.//
-00004ef0: 2f20 3a70 6172 616d 2063 616c 6c61 626c  / :param callabl
-00004f00: 6520 6b65 793a 206b 6579 2069 7320 6120  e key: key is a 
-00004f10: 7079 7468 6f6e 2066 756e 6374 696f 6e20  python function 
-00004f20: 6f72 206f 7468 6572 2063 616c 6c61 626c  or other callabl
-00004f30: 6520 7468 6174 0a2f 2f2f 2020 2020 2067  e that.///     g
-00004f40: 6574 7320 7061 7373 6564 2061 2073 696e  ets passed a sin
-00004f50: 676c 6520 6172 6775 6d65 6e74 2074 6865  gle argument the
-00004f60: 206e 6f64 6520 6461 7461 2066 726f 6d20   node data from 
-00004f70: 7468 6520 6772 6170 6820 616e 6420 6973  the graph and is
-00004f80: 0a2f 2f2f 2020 2020 2065 7870 6563 7465  .///     expecte
-00004f90: 6420 746f 2072 6574 7572 6e20 6120 7374  d to return a st
-00004fa0: 7269 6e67 2077 6869 6368 2077 696c 6c20  ring which will 
-00004fb0: 6265 2075 7365 6420 666f 7220 736f 7274  be used for sort
-00004fc0: 696e 672e 0a2f 2f2f 0a2f 2f2f 203a 7265  ing..///./// :re
-00004fd0: 7475 726e 733a 2041 206c 6973 7420 6f66  turns: A list of
-00004fe0: 206e 6f64 6527 7320 6461 7461 206c 6578   node's data lex
-00004ff0: 6963 6f67 7261 7068 6963 616c 6c79 2074  icographically t
-00005000: 6f70 6f6c 6f67 6963 616c 6c79 2073 6f72  opologically sor
-00005010: 7465 642e 0a2f 2f2f 203a 7274 7970 653a  ted../// :rtype:
-00005020: 206c 6973 740a 235b 7079 6675 6e63 7469   list.#[pyfuncti
-00005030: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
-00005040: 7475 7265 203d 2022 2864 6167 2c20 6b65  ture = "(dag, ke
-00005050: 792c 202f 2922 5d0a 666e 206c 6578 6963  y, /)"].fn lexic
-00005060: 6f67 7261 7068 6963 616c 5f74 6f70 6f6c  ographical_topol
-00005070: 6f67 6963 616c 5f73 6f72 7428 0a20 2020  ogical_sort(.   
-00005080: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
-00005090: 2064 6167 3a20 2664 6967 7261 7068 3a3a   dag: &digraph::
-000050a0: 5079 4469 4772 6170 682c 0a20 2020 206b  PyDiGraph,.    k
-000050b0: 6579 3a20 5079 4f62 6a65 6374 2c0a 2920  ey: PyObject,.) 
-000050c0: 2d3e 2050 7952 6573 756c 743c 5079 4f62  -> PyResult<PyOb
-000050d0: 6a65 6374 3e20 7b0a 2020 2020 6c65 7420  ject> {.    let 
-000050e0: 6b65 795f 6361 6c6c 6162 6c65 203d 207c  key_callable = |
-000050f0: 613a 2026 5079 4f62 6a65 6374 7c20 2d3e  a: &PyObject| ->
-00005100: 2050 7952 6573 756c 743c 5079 4f62 6a65   PyResult<PyObje
-00005110: 6374 3e20 7b0a 2020 2020 2020 2020 6c65  ct> {.        le
-00005120: 7420 7265 7320 3d20 6b65 792e 6361 6c6c  t res = key.call
-00005130: 3128 7079 2c20 2861 2c29 293f 3b0a 2020  1(py, (a,))?;.  
-00005140: 2020 2020 2020 4f6b 2872 6573 2e74 6f5f        Ok(res.to_
-00005150: 6f62 6a65 6374 2870 7929 290a 2020 2020  object(py)).    
-00005160: 7d3b 0a20 2020 202f 2f20 4861 7368 4d61  };.    // HashMa
-00005170: 7020 6f66 206e 6f64 655f 696e 6465 7820  p of node_index 
-00005180: 696e 6465 6772 6565 0a20 2020 206c 6574  indegree.    let
-00005190: 206e 6f64 655f 636f 756e 7420 3d20 6461   node_count = da
-000051a0: 672e 6e6f 6465 5f63 6f75 6e74 2829 3b0a  g.node_count();.
-000051b0: 2020 2020 6c65 7420 6d75 7420 696e 5f64      let mut in_d
-000051c0: 6567 7265 655f 6d61 703a 2048 6173 684d  egree_map: HashM
-000051d0: 6170 3c4e 6f64 6549 6e64 6578 2c20 7573  ap<NodeIndex, us
-000051e0: 697a 653e 203d 0a20 2020 2020 2020 2048  ize> =.        H
-000051f0: 6173 684d 6170 3a3a 7769 7468 5f63 6170  ashMap::with_cap
-00005200: 6163 6974 7928 6e6f 6465 5f63 6f75 6e74  acity(node_count
-00005210: 293b 0a20 2020 2066 6f72 206e 6f64 6520  );.    for node 
-00005220: 696e 2064 6167 2e67 7261 7068 2e6e 6f64  in dag.graph.nod
-00005230: 655f 696e 6469 6365 7328 2920 7b0a 2020  e_indices() {.  
-00005240: 2020 2020 2020 696e 5f64 6567 7265 655f        in_degree_
-00005250: 6d61 702e 696e 7365 7274 286e 6f64 652c  map.insert(node,
-00005260: 2064 6167 2e69 6e5f 6465 6772 6565 286e   dag.in_degree(n
-00005270: 6f64 652e 696e 6465 7828 2929 293b 0a20  ode.index()));. 
-00005280: 2020 207d 0a0a 2020 2020 235b 6465 7269     }..    #[deri
-00005290: 7665 2843 6c6f 6e65 2c20 4571 2c20 5061  ve(Clone, Eq, Pa
-000052a0: 7274 6961 6c45 7129 5d0a 2020 2020 7374  rtialEq)].    st
-000052b0: 7275 6374 2053 7461 7465 207b 0a20 2020  ruct State {.   
-000052c0: 2020 2020 206b 6579 3a20 5374 7269 6e67       key: String
-000052d0: 2c0a 2020 2020 2020 2020 6e6f 6465 3a20  ,.        node: 
-000052e0: 4e6f 6465 496e 6465 782c 0a20 2020 207d  NodeIndex,.    }
-000052f0: 0a0a 2020 2020 696d 706c 204f 7264 2066  ..    impl Ord f
-00005300: 6f72 2053 7461 7465 207b 0a20 2020 2020  or State {.     
-00005310: 2020 2066 6e20 636d 7028 2673 656c 662c     fn cmp(&self,
-00005320: 206f 7468 6572 3a20 2653 7461 7465 2920   other: &State) 
-00005330: 2d3e 204f 7264 6572 696e 6720 7b0a 2020  -> Ordering {.  
-00005340: 2020 2020 2020 2020 2020 2f2f 204e 6f74            // Not
-00005350: 6963 6520 7468 6174 2074 6865 2077 6520  ice that the we 
-00005360: 666c 6970 2074 6865 206f 7264 6572 696e  flip the orderin
-00005370: 6720 6f6e 2063 6f73 7473 2e0a 2020 2020  g on costs..    
-00005380: 2020 2020 2020 2020 2f2f 2049 6e20 6361          // In ca
-00005390: 7365 206f 6620 6120 7469 6520 7765 2063  se of a tie we c
-000053a0: 6f6d 7061 7265 2070 6f73 6974 696f 6e73  ompare positions
-000053b0: 202d 2074 6869 7320 7374 6570 2069 7320   - this step is 
-000053c0: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
-000053d0: 2020 2020 2020 2f2f 2074 6f20 6d61 6b65        // to make
-000053e0: 2069 6d70 6c65 6d65 6e74 6174 696f 6e73   implementations
-000053f0: 206f 6620 6050 6172 7469 616c 4571 6020   of `PartialEq` 
-00005400: 616e 6420 604f 7264 6020 636f 6e73 6973  and `Ord` consis
-00005410: 7465 6e74 2e0a 2020 2020 2020 2020 2020  tent..          
-00005420: 2020 6f74 6865 720a 2020 2020 2020 2020    other.        
-00005430: 2020 2020 2020 2020 2e6b 6579 0a20 2020          .key.   
-00005440: 2020 2020 2020 2020 2020 2020 202e 636d               .cm
-00005450: 7028 2673 656c 662e 6b65 7929 0a20 2020  p(&self.key).   
-00005460: 2020 2020 2020 2020 2020 2020 202e 7468               .th
-00005470: 656e 5f77 6974 6828 7c7c 206f 7468 6572  en_with(|| other
-00005480: 2e6e 6f64 652e 696e 6465 7828 292e 636d  .node.index().cm
-00005490: 7028 2673 656c 662e 6e6f 6465 2e69 6e64  p(&self.node.ind
-000054a0: 6578 2829 2929 0a20 2020 2020 2020 207d  ex())).        }
-000054b0: 0a20 2020 207d 0a0a 2020 2020 2f2f 2060  .    }..    // `
-000054c0: 5061 7274 6961 6c4f 7264 6020 6e65 6564  PartialOrd` need
-000054d0: 7320 746f 2062 6520 696d 706c 656d 656e  s to be implemen
-000054e0: 7465 6420 6173 2077 656c 6c2e 0a20 2020  ted as well..   
-000054f0: 2069 6d70 6c20 5061 7274 6961 6c4f 7264   impl PartialOrd
-00005500: 2066 6f72 2053 7461 7465 207b 0a20 2020   for State {.   
-00005510: 2020 2020 2066 6e20 7061 7274 6961 6c5f       fn partial_
-00005520: 636d 7028 2673 656c 662c 206f 7468 6572  cmp(&self, other
-00005530: 3a20 2653 7461 7465 2920 2d3e 204f 7074  : &State) -> Opt
-00005540: 696f 6e3c 4f72 6465 7269 6e67 3e20 7b0a  ion<Ordering> {.
-00005550: 2020 2020 2020 2020 2020 2020 536f 6d65              Some
-00005560: 2873 656c 662e 636d 7028 6f74 6865 7229  (self.cmp(other)
-00005570: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-00005580: 7d0a 2020 2020 6c65 7420 6d75 7420 7a65  }.    let mut ze
-00005590: 726f 5f69 6e64 6567 7265 6520 3d20 4269  ro_indegree = Bi
-000055a0: 6e61 7279 4865 6170 3a3a 7769 7468 5f63  naryHeap::with_c
-000055b0: 6170 6163 6974 7928 6e6f 6465 5f63 6f75  apacity(node_cou
-000055c0: 6e74 293b 0a20 2020 2066 6f72 2028 6e6f  nt);.    for (no
-000055d0: 6465 2c20 6465 6772 6565 2920 696e 2069  de, degree) in i
-000055e0: 6e5f 6465 6772 6565 5f6d 6170 2e69 7465  n_degree_map.ite
-000055f0: 7228 2920 7b0a 2020 2020 2020 2020 6966  r() {.        if
-00005600: 202a 6465 6772 6565 203d 3d20 3020 7b0a   *degree == 0 {.
-00005610: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00005620: 6d61 705f 6b65 795f 7261 7720 3d20 6b65  map_key_raw = ke
-00005630: 795f 6361 6c6c 6162 6c65 2826 6461 672e  y_callable(&dag.
-00005640: 6772 6170 685b 2a6e 6f64 655d 293f 3b0a  graph[*node])?;.
-00005650: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00005660: 6d61 705f 6b65 793a 2053 7472 696e 6720  map_key: String 
-00005670: 3d20 6d61 705f 6b65 795f 7261 772e 6578  = map_key_raw.ex
-00005680: 7472 6163 7428 7079 293f 3b0a 2020 2020  tract(py)?;.    
-00005690: 2020 2020 2020 2020 7a65 726f 5f69 6e64          zero_ind
-000056a0: 6567 7265 652e 7075 7368 2853 7461 7465  egree.push(State
-000056b0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000056c0: 2020 206b 6579 3a20 6d61 705f 6b65 792c     key: map_key,
-000056d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000056e0: 206e 6f64 653a 202a 6e6f 6465 2c0a 2020   node: *node,.  
-000056f0: 2020 2020 2020 2020 2020 7d29 3b0a 2020            });.  
-00005700: 2020 2020 2020 7d0a 2020 2020 7d0a 2020        }.    }.  
-00005710: 2020 6c65 7420 6d75 7420 6f75 745f 6c69    let mut out_li
-00005720: 7374 3a20 5665 633c 2650 794f 626a 6563  st: Vec<&PyObjec
-00005730: 743e 203d 2056 6563 3a3a 7769 7468 5f63  t> = Vec::with_c
-00005740: 6170 6163 6974 7928 6e6f 6465 5f63 6f75  apacity(node_cou
-00005750: 6e74 293b 0a20 2020 206c 6574 2064 6972  nt);.    let dir
-00005760: 203d 2070 6574 6772 6170 683a 3a44 6972   = petgraph::Dir
-00005770: 6563 7469 6f6e 3a3a 4f75 7467 6f69 6e67  ection::Outgoing
-00005780: 3b0a 2020 2020 7768 696c 6520 6c65 7420  ;.    while let 
-00005790: 536f 6d65 2853 7461 7465 207b 206e 6f64  Some(State { nod
-000057a0: 652c 202e 2e20 7d29 203d 207a 6572 6f5f  e, .. }) = zero_
-000057b0: 696e 6465 6772 6565 2e70 6f70 2829 207b  indegree.pop() {
-000057c0: 0a20 2020 2020 2020 206c 6574 206e 6569  .        let nei
-000057d0: 6768 626f 7273 203d 2064 6167 2e67 7261  ghbors = dag.gra
-000057e0: 7068 2e6e 6569 6768 626f 7273 5f64 6972  ph.neighbors_dir
-000057f0: 6563 7465 6428 6e6f 6465 2c20 6469 7229  ected(node, dir)
-00005800: 3b0a 2020 2020 2020 2020 666f 7220 6368  ;.        for ch
-00005810: 696c 6420 696e 206e 6569 6768 626f 7273  ild in neighbors
-00005820: 207b 0a20 2020 2020 2020 2020 2020 206c   {.            l
-00005830: 6574 2063 6869 6c64 5f64 6567 7265 6520  et child_degree 
-00005840: 3d20 696e 5f64 6567 7265 655f 6d61 702e  = in_degree_map.
-00005850: 6765 745f 6d75 7428 2663 6869 6c64 292e  get_mut(&child).
-00005860: 756e 7772 6170 2829 3b0a 2020 2020 2020  unwrap();.      
-00005870: 2020 2020 2020 2a63 6869 6c64 5f64 6567        *child_deg
-00005880: 7265 6520 2d3d 2031 3b0a 2020 2020 2020  ree -= 1;.      
-00005890: 2020 2020 2020 6966 202a 6368 696c 645f        if *child_
-000058a0: 6465 6772 6565 203d 3d20 3020 7b0a 2020  degree == 0 {.  
-000058b0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-000058c0: 7420 6d61 705f 6b65 795f 7261 7720 3d20  t map_key_raw = 
-000058d0: 6b65 795f 6361 6c6c 6162 6c65 2826 6461  key_callable(&da
-000058e0: 672e 6772 6170 685b 6368 696c 645d 293f  g.graph[child])?
-000058f0: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00005900: 2020 6c65 7420 6d61 705f 6b65 793a 2053    let map_key: S
-00005910: 7472 696e 6720 3d20 6d61 705f 6b65 795f  tring = map_key_
-00005920: 7261 772e 6578 7472 6163 7428 7079 293f  raw.extract(py)?
-00005930: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00005940: 2020 7a65 726f 5f69 6e64 6567 7265 652e    zero_indegree.
-00005950: 7075 7368 2853 7461 7465 207b 0a20 2020  push(State {.   
-00005960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005970: 206b 6579 3a20 6d61 705f 6b65 792c 0a20   key: map_key,. 
-00005980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005990: 2020 206e 6f64 653a 2063 6869 6c64 2c0a     node: child,.
-000059a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000059b0: 7d29 3b0a 2020 2020 2020 2020 2020 2020  });.            
-000059c0: 2020 2020 696e 5f64 6567 7265 655f 6d61      in_degree_ma
-000059d0: 702e 7265 6d6f 7665 2826 6368 696c 6429  p.remove(&child)
-000059e0: 3b0a 2020 2020 2020 2020 2020 2020 7d0a  ;.            }.
-000059f0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00005a00: 2020 6f75 745f 6c69 7374 2e70 7573 6828    out_list.push(
-00005a10: 2664 6167 2e67 7261 7068 5b6e 6f64 655d  &dag.graph[node]
-00005a20: 290a 2020 2020 7d0a 2020 2020 4f6b 2850  ).    }.    Ok(P
-00005a30: 794c 6973 743a 3a6e 6577 2870 792c 206f  yList::new(py, o
-00005a40: 7574 5f6c 6973 7429 2e69 6e74 6f28 2929  ut_list).into())
-00005a50: 0a7d 0a0a 2f2f 2f20 436f 6c6f 7220 6120  .}../// Color a 
-00005a60: 5079 4772 6170 6820 7573 696e 6720 6120  PyGraph using a 
-00005a70: 6c61 7267 6573 745f 6669 7273 7420 7374  largest_first st
-00005a80: 7261 7465 6779 2067 7265 6564 7920 6772  rategy greedy gr
-00005a90: 6170 6820 636f 6c6f 7269 6e67 2e0a 2f2f  aph coloring..//
-00005aa0: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7947  /./// :param PyG
-00005ab0: 7261 7068 3a20 5468 6520 696e 7075 7420  raph: The input 
-00005ac0: 5079 4772 6170 6820 6f62 6a65 6374 2074  PyGraph object t
-00005ad0: 6f20 636f 6c6f 720a 2f2f 2f0a 2f2f 2f20  o color.///./// 
-00005ae0: 3a72 6574 7572 6e73 3a20 4120 6469 6374  :returns: A dict
-00005af0: 696f 6e61 7279 2077 6865 7265 206b 6579  ionary where key
-00005b00: 7320 6172 6520 6e6f 6465 2069 6e64 6963  s are node indic
-00005b10: 6573 2061 6e64 2074 6865 2076 616c 7565  es and the value
-00005b20: 2069 730a 2f2f 2f20 2020 2020 7468 6520   is.///     the 
-00005b30: 636f 6c6f 720a 2f2f 2f20 3a72 7479 7065  color./// :rtype
-00005b40: 3a20 6469 6374 0a23 5b70 7966 756e 6374  : dict.#[pyfunct
-00005b50: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
-00005b60: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
-00005b70: 202f 2922 5d0a 666e 2067 7261 7068 5f67   /)"].fn graph_g
-00005b80: 7265 6564 795f 636f 6c6f 7228 0a20 2020  reedy_color(.   
-00005b90: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
-00005ba0: 2067 7261 7068 3a20 2667 7261 7068 3a3a   graph: &graph::
-00005bb0: 5079 4772 6170 682c 0a29 202d 3e20 5079  PyGraph,.) -> Py
-00005bc0: 5265 7375 6c74 3c50 794f 626a 6563 743e  Result<PyObject>
-00005bd0: 207b 0a20 2020 206c 6574 206d 7574 2063   {.    let mut c
-00005be0: 6f6c 6f72 733a 2048 6173 684d 6170 3c75  olors: HashMap<u
-00005bf0: 7369 7a65 2c20 7573 697a 653e 203d 2048  size, usize> = H
-00005c00: 6173 684d 6170 3a3a 6e65 7728 293b 0a20  ashMap::new();. 
-00005c10: 2020 206c 6574 206d 7574 206e 6f64 655f     let mut node_
-00005c20: 7665 633a 2056 6563 3c4e 6f64 6549 6e64  vec: Vec<NodeInd
-00005c30: 6578 3e20 3d20 6772 6170 682e 6772 6170  ex> = graph.grap
-00005c40: 682e 6e6f 6465 5f69 6e64 6963 6573 2829  h.node_indices()
-00005c50: 2e63 6f6c 6c65 6374 2829 3b0a 2020 2020  .collect();.    
-00005c60: 6c65 7420 6d75 7420 736f 7274 5f6d 6170  let mut sort_map
-00005c70: 3a20 4861 7368 4d61 703c 4e6f 6465 496e  : HashMap<NodeIn
-00005c80: 6465 782c 2075 7369 7a65 3e20 3d0a 2020  dex, usize> =.  
-00005c90: 2020 2020 2020 4861 7368 4d61 703a 3a77        HashMap::w
-00005ca0: 6974 685f 6361 7061 6369 7479 2867 7261  ith_capacity(gra
-00005cb0: 7068 2e6e 6f64 655f 636f 756e 7428 2929  ph.node_count())
-00005cc0: 3b0a 2020 2020 666f 7220 6b20 696e 206e  ;.    for k in n
-00005cd0: 6f64 655f 7665 632e 6974 6572 2829 207b  ode_vec.iter() {
-00005ce0: 0a20 2020 2020 2020 2073 6f72 745f 6d61  .        sort_ma
-00005cf0: 702e 696e 7365 7274 282a 6b2c 2067 7261  p.insert(*k, gra
-00005d00: 7068 2e67 7261 7068 2e65 6467 6573 282a  ph.graph.edges(*
-00005d10: 6b29 2e63 6f75 6e74 2829 293b 0a20 2020  k).count());.   
-00005d20: 207d 0a20 2020 206e 6f64 655f 7665 632e   }.    node_vec.
-00005d30: 7061 725f 736f 7274 5f62 795f 6b65 7928  par_sort_by_key(
-00005d40: 7c6b 7c20 5265 7665 7273 6528 736f 7274  |k| Reverse(sort
-00005d50: 5f6d 6170 2e67 6574 286b 2929 293b 0a20  _map.get(k)));. 
-00005d60: 2020 2066 6f72 2075 5f69 6e64 6578 2069     for u_index i
-00005d70: 6e20 6e6f 6465 5f76 6563 207b 0a20 2020  n node_vec {.   
-00005d80: 2020 2020 206c 6574 206d 7574 206e 6569       let mut nei
-00005d90: 6768 626f 725f 636f 6c6f 7273 3a20 4861  ghbor_colors: Ha
-00005da0: 7368 5365 743c 7573 697a 653e 203d 2048  shSet<usize> = H
-00005db0: 6173 6853 6574 3a3a 6e65 7728 293b 0a20  ashSet::new();. 
-00005dc0: 2020 2020 2020 2066 6f72 2065 6467 6520         for edge 
-00005dd0: 696e 2067 7261 7068 2e67 7261 7068 2e65  in graph.graph.e
-00005de0: 6467 6573 2875 5f69 6e64 6578 2920 7b0a  dges(u_index) {.
-00005df0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00005e00: 7461 7267 6574 203d 2065 6467 652e 7461  target = edge.ta
-00005e10: 7267 6574 2829 2e69 6e64 6578 2829 3b0a  rget().index();.
-00005e20: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00005e30: 6578 6973 7469 6e67 5f63 6f6c 6f72 203d  existing_color =
-00005e40: 206d 6174 6368 2063 6f6c 6f72 732e 6765   match colors.ge
-00005e50: 7428 2674 6172 6765 7429 207b 0a20 2020  t(&target) {.   
-00005e60: 2020 2020 2020 2020 2020 2020 2053 6f6d               Som
-00005e70: 6528 6e6f 6465 2920 3d3e 206e 6f64 652c  e(node) => node,
-00005e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005e90: 204e 6f6e 6520 3d3e 2063 6f6e 7469 6e75   None => continu
-00005ea0: 652c 0a20 2020 2020 2020 2020 2020 207d  e,.            }
-00005eb0: 3b0a 2020 2020 2020 2020 2020 2020 6e65  ;.            ne
-00005ec0: 6967 6862 6f72 5f63 6f6c 6f72 732e 696e  ighbor_colors.in
-00005ed0: 7365 7274 282a 6578 6973 7469 6e67 5f63  sert(*existing_c
-00005ee0: 6f6c 6f72 293b 0a20 2020 2020 2020 207d  olor);.        }
-00005ef0: 0a20 2020 2020 2020 206c 6574 206d 7574  .        let mut
-00005f00: 2063 6f75 6e74 3a20 7573 697a 6520 3d20   count: usize = 
-00005f10: 303b 0a20 2020 2020 2020 206c 6f6f 7020  0;.        loop 
-00005f20: 7b0a 2020 2020 2020 2020 2020 2020 6966  {.            if
-00005f30: 2021 6e65 6967 6862 6f72 5f63 6f6c 6f72   !neighbor_color
-00005f40: 732e 636f 6e74 6169 6e73 2826 636f 756e  s.contains(&coun
-00005f50: 7429 207b 0a20 2020 2020 2020 2020 2020  t) {.           
-00005f60: 2020 2020 2062 7265 616b 3b0a 2020 2020       break;.    
-00005f70: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00005f80: 2020 2020 2020 636f 756e 7420 2b3d 2031        count += 1
-00005f90: 3b0a 2020 2020 2020 2020 7d0a 2020 2020  ;.        }.    
-00005fa0: 2020 2020 636f 6c6f 7273 2e69 6e73 6572      colors.inser
-00005fb0: 7428 755f 696e 6465 782e 696e 6465 7828  t(u_index.index(
-00005fc0: 292c 2063 6f75 6e74 293b 0a20 2020 207d  ), count);.    }
-00005fd0: 0a20 2020 206c 6574 206f 7574 5f64 6963  .    let out_dic
-00005fe0: 7420 3d20 5079 4469 6374 3a3a 6e65 7728  t = PyDict::new(
-00005ff0: 7079 293b 0a20 2020 2066 6f72 2028 696e  py);.    for (in
-00006000: 6465 782c 2063 6f6c 6f72 2920 696e 2063  dex, color) in c
-00006010: 6f6c 6f72 7320 7b0a 2020 2020 2020 2020  olors {.        
-00006020: 6f75 745f 6469 6374 2e73 6574 5f69 7465  out_dict.set_ite
-00006030: 6d28 696e 6465 782c 2063 6f6c 6f72 293f  m(index, color)?
-00006040: 3b0a 2020 2020 7d0a 2020 2020 4f6b 286f  ;.    }.    Ok(o
-00006050: 7574 5f64 6963 742e 696e 746f 2829 290a  ut_dict.into()).
-00006060: 7d0a 0a2f 2f2f 2043 6f6d 7075 7465 2074  }../// Compute t
-00006070: 6865 206c 656e 6774 6820 6f66 2074 6865  he length of the
-00006080: 206b 7468 2073 686f 7274 6573 7420 7061   kth shortest pa
-00006090: 7468 0a2f 2f2f 0a2f 2f2f 2043 6f6d 7075  th.///./// Compu
-000060a0: 7465 7320 7468 6520 6c65 6e67 7468 7320  tes the lengths 
-000060b0: 6f66 2074 6865 206b 7468 2073 686f 7274  of the kth short
-000060c0: 6573 7420 7061 7468 2066 726f 6d20 6060  est path from ``
-000060d0: 7374 6172 7460 6020 746f 2065 7665 7279  start`` to every
-000060e0: 0a2f 2f2f 2072 6561 6368 6162 6c65 206e  ./// reachable n
-000060f0: 6f64 652e 0a2f 2f2f 0a2f 2f2f 2043 6f6d  ode..///./// Com
-00006100: 7075 7465 7320 696e 203a 6d61 7468 3a60  putes in :math:`
-00006110: 4f28 6b20 2a20 287c 457c 202b 207c 567c  O(k * (|E| + |V|
-00006120: 2a6c 6f67 287c 567c 2929 2960 2074 696d  *log(|V|)))` tim
-00006130: 6520 2861 7665 7261 6765 292e 0a2f 2f2f  e (average)..///
-00006140: 0a2f 2f2f 203a 7061 7261 6d20 5079 4772  ./// :param PyGr
-00006150: 6170 6820 6772 6170 683a 2054 6865 2067  aph graph: The g
-00006160: 7261 7068 2074 6f20 6669 6e64 2074 6865  raph to find the
-00006170: 2073 686f 7274 6573 7420 7061 7468 7320   shortest paths 
-00006180: 696e 0a2f 2f2f 203a 7061 7261 6d20 696e  in./// :param in
-00006190: 7420 7374 6172 743a 2054 6865 206e 6f64  t start: The nod
-000061a0: 6520 696e 6465 7820 746f 2066 696e 6420  e index to find 
-000061b0: 7468 6520 7368 6f72 7465 7374 2070 6174  the shortest pat
-000061c0: 6873 2066 726f 6d0a 2f2f 2f20 3a70 6172  hs from./// :par
-000061d0: 616d 2069 6e74 206b 3a20 5468 6520 6b74  am int k: The kt
-000061e0: 6820 7368 6f72 7465 7374 2070 6174 6820  h shortest path 
-000061f0: 746f 2066 696e 6420 7468 6520 6c65 6e67  to find the leng
-00006200: 7468 7320 6f66 0a2f 2f2f 203a 7061 7261  ths of./// :para
-00006210: 6d20 6564 6765 5f63 6f73 743a 2041 2070  m edge_cost: A p
-00006220: 7974 686f 6e20 6361 6c6c 6162 6c65 2074  ython callable t
-00006230: 6861 7420 7769 6c6c 2072 6563 6569 7665  hat will receive
-00006240: 2061 6e20 6564 6765 2070 6179 6c6f 6164   an edge payload
-00006250: 2061 6e64 0a2f 2f2f 2020 2020 2072 6574   and.///     ret
-00006260: 7572 6e20 6120 666c 6f61 7420 666f 7220  urn a float for 
-00006270: 7468 6520 636f 7374 206f 6620 7468 6174  the cost of that
-00006280: 2065 6564 6765 0a2f 2f2f 203a 7061 7261   eedge./// :para
-00006290: 6d20 696e 7420 676f 616c 3a20 416e 206f  m int goal: An o
-000062a0: 7074 696f 6e61 6c20 676f 616c 206e 6f64  ptional goal nod
-000062b0: 6520 696e 6465 782c 2069 6620 7370 6563  e index, if spec
-000062c0: 6966 6965 6420 7468 6520 6f75 7470 7574  ified the output
-000062d0: 0a2f 2f2f 2020 2020 2064 6963 7469 6f6e  .///     diction
-000062e0: 6172 790a 2f2f 2f0a 2f2f 2f20 3a72 6574  ary.///./// :ret
-000062f0: 7572 6e73 3a20 4120 6469 6374 206f 6620  urns: A dict of 
-00006300: 6c65 6e67 7468 7320 7768 6572 6520 7468  lengths where th
-00006310: 6520 6b65 7920 6973 2074 6865 2064 6573  e key is the des
-00006320: 7469 6e61 7469 6f6e 206e 6f64 6520 696e  tination node in
-00006330: 6465 7820 616e 640a 2f2f 2f20 2020 2020  dex and.///     
-00006340: 7468 6520 7661 6c75 6520 6973 2074 6865  the value is the
-00006350: 206c 656e 6774 6820 6f66 2074 6865 2070   length of the p
-00006360: 6174 682e 0a2f 2f2f 203a 7274 7970 653a  ath../// :rtype:
-00006370: 2064 6963 740a 235b 7079 6675 6e63 7469   dict.#[pyfuncti
-00006380: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
-00006390: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
-000063a0: 7374 6172 742c 206b 2c20 6564 6765 5f63  start, k, edge_c
-000063b0: 6f73 742c 202f 2c20 676f 616c 3d4e 6f6e  ost, /, goal=Non
-000063c0: 6529 225d 0a66 6e20 6469 6772 6170 685f  e)"].fn digraph_
-000063d0: 6b5f 7368 6f72 7465 7374 5f70 6174 685f  k_shortest_path_
-000063e0: 6c65 6e67 7468 7328 0a20 2020 2070 793a  lengths(.    py:
-000063f0: 2050 7974 686f 6e2c 0a20 2020 2067 7261   Python,.    gra
-00006400: 7068 3a20 2664 6967 7261 7068 3a3a 5079  ph: &digraph::Py
-00006410: 4469 4772 6170 682c 0a20 2020 2073 7461  DiGraph,.    sta
-00006420: 7274 3a20 7573 697a 652c 0a20 2020 206b  rt: usize,.    k
-00006430: 3a20 7573 697a 652c 0a20 2020 2065 6467  : usize,.    edg
-00006440: 655f 636f 7374 3a20 5079 4f62 6a65 6374  e_cost: PyObject
-00006450: 2c0a 2020 2020 676f 616c 3a20 4f70 7469  ,.    goal: Opti
-00006460: 6f6e 3c75 7369 7a65 3e2c 0a29 202d 3e20  on<usize>,.) -> 
-00006470: 5079 5265 7375 6c74 3c50 794f 626a 6563  PyResult<PyObjec
-00006480: 743e 207b 0a20 2020 206c 6574 206f 7574  t> {.    let out
-00006490: 5f67 6f61 6c20 3d20 6d61 7463 6820 676f  _goal = match go
-000064a0: 616c 207b 0a20 2020 2020 2020 2053 6f6d  al {.        Som
-000064b0: 6528 6729 203d 3e20 536f 6d65 284e 6f64  e(g) => Some(Nod
-000064c0: 6549 6e64 6578 3a3a 6e65 7728 6729 292c  eIndex::new(g)),
-000064d0: 0a20 2020 2020 2020 204e 6f6e 6520 3d3e  .        None =>
-000064e0: 204e 6f6e 652c 0a20 2020 207d 3b0a 2020   None,.    };.  
-000064f0: 2020 6c65 7420 6564 6765 5f63 6f73 745f    let edge_cost_
-00006500: 6361 6c6c 6162 6c65 203d 207c 6564 6765  callable = |edge
-00006510: 3a20 2650 794f 626a 6563 747c 202d 3e20  : &PyObject| -> 
-00006520: 5079 5265 7375 6c74 3c66 3634 3e20 7b0a  PyResult<f64> {.
-00006530: 2020 2020 2020 2020 6c65 7420 7265 7320          let res 
-00006540: 3d20 6564 6765 5f63 6f73 742e 6361 6c6c  = edge_cost.call
-00006550: 3128 7079 2c20 2865 6467 652c 2929 3f3b  1(py, (edge,))?;
-00006560: 0a20 2020 2020 2020 2072 6573 2e65 7874  .        res.ext
-00006570: 7261 6374 2870 7929 0a20 2020 207d 3b0a  ract(py).    };.
-00006580: 0a20 2020 206c 6574 206f 7574 5f6d 6170  .    let out_map
-00006590: 203d 206b 5f73 686f 7274 6573 745f 7061   = k_shortest_pa
-000065a0: 7468 3a3a 6b5f 7368 6f72 7465 7374 5f70  th::k_shortest_p
-000065b0: 6174 6828 0a20 2020 2020 2020 2067 7261  ath(.        gra
-000065c0: 7068 2c0a 2020 2020 2020 2020 4e6f 6465  ph,.        Node
-000065d0: 496e 6465 783a 3a6e 6577 2873 7461 7274  Index::new(start
-000065e0: 292c 0a20 2020 2020 2020 206f 7574 5f67  ),.        out_g
-000065f0: 6f61 6c2c 0a20 2020 2020 2020 206b 2c0a  oal,.        k,.
-00006600: 2020 2020 2020 2020 6564 6765 5f63 6f73          edge_cos
-00006610: 745f 6361 6c6c 6162 6c65 2c0a 2020 2020  t_callable,.    
-00006620: 293f 3b0a 2020 2020 6c65 7420 6f75 745f  )?;.    let out_
-00006630: 6469 6374 203d 2050 7944 6963 743a 3a6e  dict = PyDict::n
-00006640: 6577 2870 7929 3b0a 2020 2020 666f 7220  ew(py);.    for 
-00006650: 2869 6e64 6578 2c20 6c65 6e67 7468 2920  (index, length) 
-00006660: 696e 206f 7574 5f6d 6170 207b 0a20 2020  in out_map {.   
-00006670: 2020 2020 2069 6620 286f 7574 5f67 6f61       if (out_goa
-00006680: 6c2e 6973 5f73 6f6d 6528 2920 2626 206f  l.is_some() && o
-00006690: 7574 5f67 6f61 6c2e 756e 7772 6170 2829  ut_goal.unwrap()
-000066a0: 203d 3d20 696e 6465 7829 0a20 2020 2020   == index).     
-000066b0: 2020 2020 2020 207c 7c20 6f75 745f 676f         || out_go
-000066c0: 616c 2e69 735f 6e6f 6e65 2829 0a20 2020  al.is_none().   
-000066d0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-000066e0: 2020 206f 7574 5f64 6963 742e 7365 745f     out_dict.set_
-000066f0: 6974 656d 2869 6e64 6578 2e69 6e64 6578  item(index.index
-00006700: 2829 2c20 6c65 6e67 7468 293f 3b0a 2020  (), length)?;.  
-00006710: 2020 2020 2020 7d0a 2020 2020 7d0a 2020        }.    }.  
-00006720: 2020 4f6b 286f 7574 5f64 6963 742e 696e    Ok(out_dict.in
-00006730: 746f 2829 290a 7d0a 0a2f 2f2f 2043 6f6d  to()).}../// Com
-00006740: 7075 7465 2074 6865 206c 656e 6774 6820  pute the length 
-00006750: 6f66 2074 6865 206b 7468 2073 686f 7274  of the kth short
-00006760: 6573 7420 7061 7468 0a2f 2f2f 0a2f 2f2f  est path.///.///
-00006770: 2043 6f6d 7075 7465 7320 7468 6520 6c65   Computes the le
-00006780: 6e67 7468 7320 6f66 2074 6865 206b 7468  ngths of the kth
-00006790: 2073 686f 7274 6573 7420 7061 7468 2066   shortest path f
-000067a0: 726f 6d20 6060 7374 6172 7460 6020 746f  rom ``start`` to
-000067b0: 2065 7665 7279 0a2f 2f2f 2072 6561 6368   every./// reach
-000067c0: 6162 6c65 206e 6f64 652e 0a2f 2f2f 0a2f  able node..///./
-000067d0: 2f2f 2043 6f6d 7075 7465 7320 696e 203a  // Computes in :
-000067e0: 6d61 7468 3a60 4f28 6b20 2a20 287c 457c  math:`O(k * (|E|
-000067f0: 202b 207c 567c 2a6c 6f67 287c 567c 2929   + |V|*log(|V|))
-00006800: 2960 2074 696d 6520 2861 7665 7261 6765  )` time (average
-00006810: 292e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  )..///./// :para
-00006820: 6d20 5079 4772 6170 6820 6772 6170 683a  m PyGraph graph:
-00006830: 2054 6865 2067 7261 7068 2074 6f20 6669   The graph to fi
-00006840: 6e64 2074 6865 2073 686f 7274 6573 7420  nd the shortest 
-00006850: 7061 7468 7320 696e 0a2f 2f2f 203a 7061  paths in./// :pa
-00006860: 7261 6d20 696e 7420 7374 6172 743a 2054  ram int start: T
-00006870: 6865 206e 6f64 6520 696e 6465 7820 746f  he node index to
-00006880: 2066 696e 6420 7468 6520 7368 6f72 7465   find the shorte
-00006890: 7374 2070 6174 6873 2066 726f 6d0a 2f2f  st paths from.//
-000068a0: 2f20 3a70 6172 616d 2069 6e74 206b 3a20  / :param int k: 
-000068b0: 5468 6520 6b74 6820 7368 6f72 7465 7374  The kth shortest
-000068c0: 2070 6174 6820 746f 2066 696e 6420 7468   path to find th
-000068d0: 6520 6c65 6e67 7468 7320 6f66 0a2f 2f2f  e lengths of.///
-000068e0: 203a 7061 7261 6d20 6564 6765 5f63 6f73   :param edge_cos
-000068f0: 743a 2041 2070 7974 686f 6e20 6361 6c6c  t: A python call
-00006900: 6162 6c65 2074 6861 7420 7769 6c6c 2072  able that will r
-00006910: 6563 6569 7665 2061 6e20 6564 6765 2070  eceive an edge p
-00006920: 6179 6c6f 6164 2061 6e64 0a2f 2f2f 2020  ayload and.///  
-00006930: 2020 2072 6574 7572 6e20 6120 666c 6f61     return a floa
-00006940: 7420 666f 7220 7468 6520 636f 7374 206f  t for the cost o
-00006950: 6620 7468 6174 2065 6564 6765 0a2f 2f2f  f that eedge.///
-00006960: 203a 7061 7261 6d20 696e 7420 676f 616c   :param int goal
-00006970: 3a20 416e 206f 7074 696f 6e61 6c20 676f  : An optional go
-00006980: 616c 206e 6f64 6520 696e 6465 782c 2069  al node index, i
-00006990: 6620 7370 6563 6966 6965 6420 7468 6520  f specified the 
-000069a0: 6f75 7470 7574 0a2f 2f2f 2020 2020 2064  output.///     d
-000069b0: 6963 7469 6f6e 6172 790a 2f2f 2f0a 2f2f  ictionary.///.//
-000069c0: 2f20 3a72 6574 7572 6e73 3a20 4120 6469  / :returns: A di
-000069d0: 6374 206f 6620 6c65 6e67 7468 7320 7768  ct of lengths wh
-000069e0: 6572 6520 7468 6520 6b65 7920 6973 2074  ere the key is t
-000069f0: 6865 2064 6573 7469 6e61 7469 6f6e 206e  he destination n
-00006a00: 6f64 6520 696e 6465 7820 616e 640a 2f2f  ode index and.//
-00006a10: 2f20 2020 2020 7468 6520 7661 6c75 6520  /     the value 
-00006a20: 6973 2074 6865 206c 656e 6774 6820 6f66  is the length of
-00006a30: 2074 6865 2070 6174 682e 0a2f 2f2f 203a   the path../// :
-00006a40: 7274 7970 653a 2064 6963 740a 235b 7079  rtype: dict.#[py
-00006a50: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
-00006a60: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
-00006a70: 7261 7068 2c20 7374 6172 742c 206b 2c20  raph, start, k, 
-00006a80: 6564 6765 5f63 6f73 742c 202f 2c20 676f  edge_cost, /, go
-00006a90: 616c 3d4e 6f6e 6529 225d 0a66 6e20 6772  al=None)"].fn gr
-00006aa0: 6170 685f 6b5f 7368 6f72 7465 7374 5f70  aph_k_shortest_p
-00006ab0: 6174 685f 6c65 6e67 7468 7328 0a20 2020  ath_lengths(.   
-00006ac0: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
-00006ad0: 2067 7261 7068 3a20 2667 7261 7068 3a3a   graph: &graph::
-00006ae0: 5079 4772 6170 682c 0a20 2020 2073 7461  PyGraph,.    sta
-00006af0: 7274 3a20 7573 697a 652c 0a20 2020 206b  rt: usize,.    k
-00006b00: 3a20 7573 697a 652c 0a20 2020 2065 6467  : usize,.    edg
-00006b10: 655f 636f 7374 3a20 5079 4f62 6a65 6374  e_cost: PyObject
-00006b20: 2c0a 2020 2020 676f 616c 3a20 4f70 7469  ,.    goal: Opti
-00006b30: 6f6e 3c75 7369 7a65 3e2c 0a29 202d 3e20  on<usize>,.) -> 
-00006b40: 5079 5265 7375 6c74 3c50 794f 626a 6563  PyResult<PyObjec
-00006b50: 743e 207b 0a20 2020 206c 6574 206f 7574  t> {.    let out
-00006b60: 5f67 6f61 6c20 3d20 6d61 7463 6820 676f  _goal = match go
-00006b70: 616c 207b 0a20 2020 2020 2020 2053 6f6d  al {.        Som
-00006b80: 6528 6729 203d 3e20 536f 6d65 284e 6f64  e(g) => Some(Nod
-00006b90: 6549 6e64 6578 3a3a 6e65 7728 6729 292c  eIndex::new(g)),
-00006ba0: 0a20 2020 2020 2020 204e 6f6e 6520 3d3e  .        None =>
-00006bb0: 204e 6f6e 652c 0a20 2020 207d 3b0a 2020   None,.    };.  
-00006bc0: 2020 6c65 7420 6564 6765 5f63 6f73 745f    let edge_cost_
-00006bd0: 6361 6c6c 6162 6c65 203d 207c 6564 6765  callable = |edge
-00006be0: 3a20 2650 794f 626a 6563 747c 202d 3e20  : &PyObject| -> 
-00006bf0: 5079 5265 7375 6c74 3c66 3634 3e20 7b0a  PyResult<f64> {.
-00006c00: 2020 2020 2020 2020 6c65 7420 7265 7320          let res 
-00006c10: 3d20 6564 6765 5f63 6f73 742e 6361 6c6c  = edge_cost.call
-00006c20: 3128 7079 2c20 2865 6467 652c 2929 3f3b  1(py, (edge,))?;
-00006c30: 0a20 2020 2020 2020 2072 6573 2e65 7874  .        res.ext
-00006c40: 7261 6374 2870 7929 0a20 2020 207d 3b0a  ract(py).    };.
-00006c50: 0a20 2020 206c 6574 206f 7574 5f6d 6170  .    let out_map
-00006c60: 203d 206b 5f73 686f 7274 6573 745f 7061   = k_shortest_pa
-00006c70: 7468 3a3a 6b5f 7368 6f72 7465 7374 5f70  th::k_shortest_p
-00006c80: 6174 6828 0a20 2020 2020 2020 2067 7261  ath(.        gra
-00006c90: 7068 2c0a 2020 2020 2020 2020 4e6f 6465  ph,.        Node
-00006ca0: 496e 6465 783a 3a6e 6577 2873 7461 7274  Index::new(start
-00006cb0: 292c 0a20 2020 2020 2020 206f 7574 5f67  ),.        out_g
-00006cc0: 6f61 6c2c 0a20 2020 2020 2020 206b 2c0a  oal,.        k,.
-00006cd0: 2020 2020 2020 2020 6564 6765 5f63 6f73          edge_cos
-00006ce0: 745f 6361 6c6c 6162 6c65 2c0a 2020 2020  t_callable,.    
-00006cf0: 293f 3b0a 2020 2020 6c65 7420 6f75 745f  )?;.    let out_
-00006d00: 6469 6374 203d 2050 7944 6963 743a 3a6e  dict = PyDict::n
-00006d10: 6577 2870 7929 3b0a 2020 2020 666f 7220  ew(py);.    for 
-00006d20: 2869 6e64 6578 2c20 6c65 6e67 7468 2920  (index, length) 
-00006d30: 696e 206f 7574 5f6d 6170 207b 0a20 2020  in out_map {.   
-00006d40: 2020 2020 2069 6620 286f 7574 5f67 6f61       if (out_goa
-00006d50: 6c2e 6973 5f73 6f6d 6528 2920 2626 206f  l.is_some() && o
-00006d60: 7574 5f67 6f61 6c2e 756e 7772 6170 2829  ut_goal.unwrap()
-00006d70: 203d 3d20 696e 6465 7829 0a20 2020 2020   == index).     
-00006d80: 2020 2020 2020 207c 7c20 6f75 745f 676f         || out_go
-00006d90: 616c 2e69 735f 6e6f 6e65 2829 0a20 2020  al.is_none().   
-00006da0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00006db0: 2020 206f 7574 5f64 6963 742e 7365 745f     out_dict.set_
-00006dc0: 6974 656d 2869 6e64 6578 2e69 6e64 6578  item(index.index
-00006dd0: 2829 2c20 6c65 6e67 7468 293f 3b0a 2020  (), length)?;.  
-00006de0: 2020 2020 2020 7d0a 2020 2020 7d0a 2020        }.    }.  
-00006df0: 2020 4f6b 286f 7574 5f64 6963 742e 696e    Ok(out_dict.in
-00006e00: 746f 2829 290a 7d0a 2f2f 2f20 5265 7475  to()).}./// Retu
-00006e10: 726e 2074 6865 2073 686f 7274 6573 7420  rn the shortest 
-00006e20: 7061 7468 206c 656e 6774 6873 2062 6574  path lengths bet
-00006e30: 7765 656e 2065 7665 7220 7061 6972 206f  ween ever pair o
-00006e40: 6620 6e6f 6465 7320 7468 6174 2068 6173  f nodes that has
-00006e50: 2061 0a2f 2f2f 2070 6174 6820 636f 6e6e   a./// path conn
-00006e60: 6563 7469 6e67 2074 6865 6d0a 2f2f 2f0a  ecting them.///.
-00006e70: 2f2f 2f20 5468 6520 7275 6e74 696d 6520  /// The runtime 
-00006e80: 6973 203a 6d61 7468 3a60 4f28 7c4e 7c5e  is :math:`O(|N|^
-00006e90: 3320 2b20 7c45 7c29 6020 7768 6572 6520  3 + |E|)` where 
-00006ea0: 3a6d 6174 683a 607c 4e7c 6020 6973 2074  :math:`|N|` is t
-00006eb0: 6865 206e 756d 6265 720a 2f2f 2f20 6f66  he number./// of
-00006ec0: 206e 6f64 6573 2061 6e64 203a 6d61 7468   nodes and :math
-00006ed0: 3a60 7c45 7c60 2069 7320 7468 6520 6e75  :`|E|` is the nu
-00006ee0: 6d62 6572 206f 6620 6564 6765 732e 0a2f  mber of edges../
-00006ef0: 2f2f 0a2f 2f2f 2054 6869 7320 6973 2064  //./// This is d
-00006f00: 6f6e 6520 7769 7468 2074 6865 2046 6c6f  one with the Flo
-00006f10: 7964 2057 6172 7368 616c 6c20 616c 676f  yd Warshall algo
-00006f20: 7269 7468 6d3a 0a2f 2f2f 2020 2020 2020  rithm:.///      
-00006f30: 0a2f 2f2f 2031 2e20 5072 6f63 6573 7320  ./// 1. Process 
-00006f40: 616c 6c20 6564 6765 7320 6279 2073 6574  all edges by set
-00006f50: 7469 6e67 2074 6865 2064 6973 7461 6e63  ting the distanc
-00006f60: 6520 6672 6f6d 2074 6865 2070 6172 656e  e from the paren
-00006f70: 7420 746f 0a2f 2f2f 2020 2020 7468 6520  t to.///    the 
-00006f80: 6368 696c 6420 6571 7561 6c20 746f 2074  child equal to t
-00006f90: 6865 2065 6467 6520 7765 6967 6874 2e0a  he edge weight..
-00006fa0: 2f2f 2f20 322e 2049 7465 7261 7465 2074  /// 2. Iterate t
-00006fb0: 6872 6f75 6768 2065 7665 7279 2070 6169  hrough every pai
-00006fc0: 7220 6f66 206e 6f64 6573 2028 736f 7572  r of nodes (sour
-00006fd0: 6365 2c20 7461 7267 6574 2920 616e 6420  ce, target) and 
-00006fe0: 616e 2061 6464 6974 696f 6e61 6c0a 2f2f  an additional.//
-00006ff0: 2f20 2020 2069 7465 726d 6564 6961 7279  /    itermediary
-00007000: 206e 6f64 6520 2877 292e 2049 6620 7468   node (w). If th
-00007010: 6520 6469 7374 616e 6365 2066 726f 6d20  e distance from 
-00007020: 736f 7572 6365 203a 6d61 7468 3a60 5c72  source :math:`\r
-00007030: 6967 6874 6172 726f 7760 2077 0a2f 2f2f  ightarrow` w.///
-00007040: 2020 2020 3a6d 6174 683a 605c 7269 6768      :math:`\righ
-00007050: 7461 7272 6f77 6020 7461 7267 6574 2069  tarrow` target i
-00007060: 7320 6c65 7373 2074 6861 6e20 7468 6520  s less than the 
-00007070: 6469 7374 616e 6365 2066 726f 6d20 736f  distance from so
-00007080: 7572 6365 0a2f 2f2f 2020 2020 3a6d 6174  urce.///    :mat
-00007090: 683a 605c 7269 6768 7461 7272 6f77 6020  h:`\rightarrow` 
-000070a0: 7461 7267 6574 2c20 7570 6461 7465 2074  target, update t
-000070b0: 6865 2073 6f75 7263 6520 3a6d 6174 683a  he source :math:
-000070c0: 605c 7269 6768 7461 7272 6f77 6020 7461  `\rightarrow` ta
-000070d0: 7267 6574 0a2f 2f2f 2020 2020 6469 7374  rget.///    dist
-000070e0: 616e 6365 2028 746f 2070 6173 7320 7468  ance (to pass th
-000070f0: 726f 7567 6820 7729 2e0a 2f2f 2f0a 2f2f  rough w)..///.//
-00007100: 2f20 5468 6520 7265 7475 726e 2066 6f72  / The return for
-00007110: 6d61 7420 6973 2060 607b 536f 7572 6365  mat is ``{Source
-00007120: 204e 6f64 653a 207b 5461 7267 6574 204e   Node: {Target N
-00007130: 6f64 653a 2044 6973 7461 6e63 657d 7d60  ode: Distance}}`
-00007140: 602e 0a2f 2f2f 0a2f 2f2f 202e 2e20 6e6f  `..///./// .. no
-00007150: 7465 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020  te::.///.///    
-00007160: 2050 6174 6873 2074 6861 7420 646f 206e   Paths that do n
-00007170: 6f74 2065 7869 7374 2061 7265 2073 696d  ot exist are sim
-00007180: 706c 7920 6e6f 7420 666f 756e 6420 696e  ply not found in
-00007190: 2074 6865 2072 6574 7572 6e20 6469 6374   the return dict
-000071a0: 696f 6e61 7279 2c0a 2f2f 2f20 2020 2020  ionary,.///     
-000071b0: 7261 7468 6572 2074 6861 6e20 7365 7474  rather than sett
-000071c0: 696e 6720 7468 6520 6469 7374 616e 6365  ing the distance
-000071d0: 2074 6f20 696e 6669 6e69 7479 2c20 6f72   to infinity, or
-000071e0: 202d 312e 0a2f 2f2f 0a2f 2f2f 202e 2e20   -1..///./// .. 
-000071f0: 6e6f 7465 3a3a 0a2f 2f2f 0a2f 2f2f 2020  note::.///.///  
-00007200: 2020 2045 6467 6520 7765 6967 6874 7320     Edge weights 
-00007210: 6172 6520 7265 7374 7269 6374 6564 2074  are restricted t
-00007220: 6f20 3120 696e 2074 6865 2063 7572 7265  o 1 in the curre
-00007230: 6e74 2069 6d70 6c65 6d65 6e74 6174 696f  nt implementatio
-00007240: 6e2e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  n..///./// :para
-00007250: 6d20 5079 4469 6772 6170 6820 6772 6170  m PyDigraph grap
-00007260: 683a 2054 6865 2044 6947 7261 7068 2074  h: The DiGraph t
-00007270: 6f20 6765 7420 616c 6c20 7368 6f72 7465  o get all shorte
-00007280: 7374 2070 6174 6873 2066 726f 6d0a 2f2f  st paths from.//
-00007290: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
-000072a0: 4120 6469 6374 696f 6e61 7279 206f 6620  A dictionary of 
-000072b0: 7368 6f72 7465 7374 2070 6174 6873 0a2f  shortest paths./
-000072c0: 2f2f 203a 7274 7970 653a 2064 6963 740a  // :rtype: dict.
-000072d0: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
-000072e0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
-000072f0: 2022 2864 6167 2c20 2f29 225d 0a66 6e20   "(dag, /)"].fn 
-00007300: 666c 6f79 645f 7761 7273 6861 6c6c 2870  floyd_warshall(p
-00007310: 793a 2050 7974 686f 6e2c 2064 6167 3a20  y: Python, dag: 
-00007320: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
-00007330: 6170 6829 202d 3e20 5079 5265 7375 6c74  aph) -> PyResult
-00007340: 3c50 794f 626a 6563 743e 207b 0a20 2020  <PyObject> {.   
-00007350: 206c 6574 206d 7574 2064 6973 743a 2048   let mut dist: H
-00007360: 6173 684d 6170 3c28 7573 697a 652c 2075  ashMap<(usize, u
-00007370: 7369 7a65 292c 2075 7369 7a65 3e20 3d0a  size), usize> =.
-00007380: 2020 2020 2020 2020 4861 7368 4d61 703a          HashMap:
-00007390: 3a77 6974 685f 6361 7061 6369 7479 2864  :with_capacity(d
-000073a0: 6167 2e6e 6f64 655f 636f 756e 7428 2929  ag.node_count())
-000073b0: 3b0a 2020 2020 666f 7220 6e6f 6465 2069  ;.    for node i
-000073c0: 6e20 6461 672e 6772 6170 682e 6e6f 6465  n dag.graph.node
-000073d0: 5f69 6e64 6963 6573 2829 207b 0a20 2020  _indices() {.   
-000073e0: 2020 2020 202f 2f20 4469 7374 616e 6365       // Distance
-000073f0: 2066 726f 6d20 6120 6e6f 6465 2074 6f20   from a node to 
-00007400: 6974 7365 6c66 2069 7320 7a65 726f 0a20  itself is zero. 
-00007410: 2020 2020 2020 2064 6973 742e 696e 7365         dist.inse
-00007420: 7274 2828 6e6f 6465 2e69 6e64 6578 2829  rt((node.index()
-00007430: 2c20 6e6f 6465 2e69 6e64 6578 2829 292c  , node.index()),
-00007440: 2030 293b 0a20 2020 207d 0a20 2020 2066   0);.    }.    f
-00007450: 6f72 2065 6467 6520 696e 2064 6167 2e67  or edge in dag.g
-00007460: 7261 7068 2e65 6467 655f 696e 6469 6365  raph.edge_indice
-00007470: 7328 2920 7b0a 2020 2020 2020 2020 2f2f  s() {.        //
-00007480: 2044 6973 7461 6e63 6520 6265 7477 6565   Distance betwee
-00007490: 6e20 6e6f 6465 7320 7468 6174 2073 6861  n nodes that sha
-000074a0: 7265 2061 6e20 6564 6765 2069 7320 310a  re an edge is 1.
-000074b0: 2020 2020 2020 2020 6c65 7420 736f 7572          let sour
-000074c0: 6365 5f74 6172 6765 7420 3d20 6461 672e  ce_target = dag.
-000074d0: 6772 6170 682e 6564 6765 5f65 6e64 706f  graph.edge_endpo
-000074e0: 696e 7473 2865 6467 6529 2e75 6e77 7261  ints(edge).unwra
-000074f0: 7028 293b 0a20 2020 2020 2020 206c 6574  p();.        let
-00007500: 2075 203d 2073 6f75 7263 655f 7461 7267   u = source_targ
-00007510: 6574 2e30 2e69 6e64 6578 2829 3b0a 2020  et.0.index();.  
-00007520: 2020 2020 2020 6c65 7420 7620 3d20 736f        let v = so
-00007530: 7572 6365 5f74 6172 6765 742e 312e 696e  urce_target.1.in
-00007540: 6465 7828 293b 0a20 2020 2020 2020 202f  dex();.        /
-00007550: 2f20 5570 6461 7465 2064 6973 7420 6f6e  / Update dist on
-00007560: 6c79 2069 6620 7468 6520 6b65 7920 6861  ly if the key ha
-00007570: 736e 2774 2062 6565 6e20 7365 7420 746f  sn't been set to
-00007580: 2030 2061 6c72 6561 6479 0a20 2020 2020   0 already.     
-00007590: 2020 202f 2f20 2869 2e65 2e20 696e 2063     // (i.e. in c
-000075a0: 6173 6520 6564 6765 2069 7320 6120 7365  ase edge is a se
-000075b0: 6c66 2065 6467 6529 2e20 4173 7375 6d65  lf edge). Assume
-000075c0: 7320 6564 6765 2077 6569 6768 7420 3d20  s edge weight = 
-000075d0: 312e 0a20 2020 2020 2020 2064 6973 742e  1..        dist.
-000075e0: 656e 7472 7928 2875 2c20 7629 292e 6f72  entry((u, v)).or
-000075f0: 5f69 6e73 6572 7428 3129 3b0a 2020 2020  _insert(1);.    
-00007600: 7d0a 2020 2020 2f2f 2054 6865 2073 686f  }.    // The sho
-00007610: 7274 6573 7420 6469 7374 616e 6365 2062  rtest distance b
-00007620: 6574 7765 656e 2061 6e79 2070 6169 7220  etween any pair 
-00007630: 6f66 206e 6f64 6573 2075 2c20 7620 6973  of nodes u, v is
-00007640: 2074 6865 206d 696e 206f 6620 7468 650a   the min of the.
-00007650: 2020 2020 2f2f 2064 6973 7461 6e63 6520      // distance 
-00007660: 7472 6163 6b65 6420 736f 2066 6172 2066  tracked so far f
-00007670: 726f 6d20 752d 3e76 2061 6e64 2074 6865  rom u->v and the
-00007680: 2064 6973 7461 6e63 6520 6672 6f6d 2075   distance from u
-00007690: 2074 6f20 7620 7468 6f72 6f75 6768 0a20   to v thorough. 
-000076a0: 2020 202f 2f20 616e 6f74 6865 7220 6e6f     // another no
-000076b0: 6465 2077 2c20 666f 7220 616e 7920 772e  de w, for any w.
-000076c0: 0a20 2020 2066 6f72 2077 2069 6e20 6461  .    for w in da
-000076d0: 672e 6772 6170 682e 6e6f 6465 5f69 6e64  g.graph.node_ind
-000076e0: 6963 6573 2829 207b 0a20 2020 2020 2020  ices() {.       
-000076f0: 2066 6f72 2075 2069 6e20 6461 672e 6772   for u in dag.gr
-00007700: 6170 682e 6e6f 6465 5f69 6e64 6963 6573  aph.node_indices
-00007710: 2829 207b 0a20 2020 2020 2020 2020 2020  () {.           
-00007720: 2066 6f72 2076 2069 6e20 6461 672e 6772   for v in dag.gr
-00007730: 6170 682e 6e6f 6465 5f69 6e64 6963 6573  aph.node_indices
-00007740: 2829 207b 0a20 2020 2020 2020 2020 2020  () {.           
-00007750: 2020 2020 206c 6574 2075 5f76 5f64 6973       let u_v_dis
-00007760: 7420 3d20 6d61 7463 6820 6469 7374 2e67  t = match dist.g
-00007770: 6574 2826 2875 2e69 6e64 6578 2829 2c20  et(&(u.index(), 
-00007780: 762e 696e 6465 7828 2929 2920 7b0a 2020  v.index())) {.  
-00007790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077a0: 2020 536f 6d65 2875 5f76 5f64 6973 7429    Some(u_v_dist)
-000077b0: 203d 3e20 2a75 5f76 5f64 6973 742c 0a20   => *u_v_dist,. 
-000077c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077d0: 2020 204e 6f6e 6520 3d3e 2073 7464 3a3a     None => std::
-000077e0: 7573 697a 653a 3a4d 4158 2c0a 2020 2020  usize::MAX,.    
-000077f0: 2020 2020 2020 2020 2020 2020 7d3b 0a20              };. 
-00007800: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00007810: 6574 2075 5f77 5f64 6973 7420 3d20 6d61  et u_w_dist = ma
-00007820: 7463 6820 6469 7374 2e67 6574 2826 2875  tch dist.get(&(u
-00007830: 2e69 6e64 6578 2829 2c20 772e 696e 6465  .index(), w.inde
-00007840: 7828 2929 2920 7b0a 2020 2020 2020 2020  x())) {.        
-00007850: 2020 2020 2020 2020 2020 2020 536f 6d65              Some
-00007860: 2875 5f77 5f64 6973 7429 203d 3e20 2a75  (u_w_dist) => *u
-00007870: 5f77 5f64 6973 742c 0a20 2020 2020 2020  _w_dist,.       
-00007880: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
-00007890: 6520 3d3e 2073 7464 3a3a 7573 697a 653a  e => std::usize:
-000078a0: 3a4d 4158 2c0a 2020 2020 2020 2020 2020  :MAX,.          
-000078b0: 2020 2020 2020 7d3b 0a20 2020 2020 2020        };.       
-000078c0: 2020 2020 2020 2020 206c 6574 2077 5f76           let w_v
-000078d0: 5f64 6973 7420 3d20 6d61 7463 6820 6469  _dist = match di
-000078e0: 7374 2e67 6574 2826 2877 2e69 6e64 6578  st.get(&(w.index
-000078f0: 2829 2c20 762e 696e 6465 7828 2929 2920  (), v.index())) 
-00007900: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00007910: 2020 2020 2020 536f 6d65 2877 5f76 5f64        Some(w_v_d
-00007920: 6973 7429 203d 3e20 2a77 5f76 5f64 6973  ist) => *w_v_dis
-00007930: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00007940: 2020 2020 2020 204e 6f6e 6520 3d3e 2073         None => s
-00007950: 7464 3a3a 7573 697a 653a 3a4d 4158 2c0a  td::usize::MAX,.
+00000220: 6520 4c69 6365 6e73 652e 0a0a 2321 5b61  e License...#![a
+00000230: 6c6c 6f77 2863 6c69 7070 793a 3a66 6c6f  llow(clippy::flo
+00000240: 6174 5f63 6d70 295d 0a0a 6d6f 6420 6173  at_cmp)]..mod as
+00000250: 7461 723b 0a6d 6f64 2064 6967 7261 7068  tar;.mod digraph
+00000260: 3b0a 6d6f 6420 6469 6a6b 7374 7261 3b0a  ;.mod dijkstra;.
+00000270: 6d6f 6420 646f 745f 7574 696c 733b 0a6d  mod dot_utils;.m
+00000280: 6f64 2067 656e 6572 6174 6f72 733b 0a6d  od generators;.m
+00000290: 6f64 2067 7261 7068 3b0a 6d6f 6420 6973  od graph;.mod is
+000002a0: 6f6d 6f72 7068 6973 6d3b 0a6d 6f64 2069  omorphism;.mod i
+000002b0: 7465 7261 746f 7273 3b0a 6d6f 6420 6b5f  terators;.mod k_
+000002c0: 7368 6f72 7465 7374 5f70 6174 683b 0a6d  shortest_path;.m
+000002d0: 6f64 206c 6179 6f75 743b 0a6d 6f64 206d  od layout;.mod m
+000002e0: 6178 5f77 6569 6768 745f 6d61 7463 6869  ax_weight_matchi
+000002f0: 6e67 3b0a 6d6f 6420 756e 696f 6e3b 0a0a  ng;.mod union;..
+00000300: 7573 6520 7374 643a 3a63 6d70 3a3a 7b4f  use std::cmp::{O
+00000310: 7264 6572 696e 672c 2052 6576 6572 7365  rdering, Reverse
+00000320: 7d3b 0a75 7365 2073 7464 3a3a 636f 6c6c  };.use std::coll
+00000330: 6563 7469 6f6e 733a 3a7b 4254 7265 6553  ections::{BTreeS
+00000340: 6574 2c20 4269 6e61 7279 4865 6170 7d3b  et, BinaryHeap};
+00000350: 0a0a 7573 6520 6861 7368 6272 6f77 6e3a  ..use hashbrown:
+00000360: 3a7b 4861 7368 4d61 702c 2048 6173 6853  :{HashMap, HashS
+00000370: 6574 7d3b 0a0a 7573 6520 7079 6f33 3a3a  et};..use pyo3::
+00000380: 6372 6561 7465 5f65 7863 6570 7469 6f6e  create_exception
+00000390: 3b0a 7573 6520 7079 6f33 3a3a 6578 6365  ;.use pyo3::exce
+000003a0: 7074 696f 6e73 3a3a 7b50 7945 7863 6570  ptions::{PyExcep
+000003b0: 7469 6f6e 2c20 5079 496e 6465 7845 7272  tion, PyIndexErr
+000003c0: 6f72 2c20 5079 5661 6c75 6545 7272 6f72  or, PyValueError
+000003d0: 7d3b 0a75 7365 2070 796f 333a 3a70 7265  };.use pyo3::pre
+000003e0: 6c75 6465 3a3a 2a3b 0a75 7365 2070 796f  lude::*;.use pyo
+000003f0: 333a 3a74 7970 6573 3a3a 7b50 7944 6963  3::types::{PyDic
+00000400: 742c 2050 794c 6973 747d 3b0a 7573 6520  t, PyList};.use 
+00000410: 7079 6f33 3a3a 7772 6170 5f70 7966 756e  pyo3::wrap_pyfun
+00000420: 6374 696f 6e3b 0a75 7365 2070 796f 333a  ction;.use pyo3:
+00000430: 3a77 7261 705f 7079 6d6f 6475 6c65 3b0a  :wrap_pymodule;.
+00000440: 7573 6520 7079 6f33 3a3a 5079 7468 6f6e  use pyo3::Python
+00000450: 3b0a 0a75 7365 2070 6574 6772 6170 683a  ;..use petgraph:
+00000460: 3a61 6c67 6f3b 0a75 7365 2070 6574 6772  :algo;.use petgr
+00000470: 6170 683a 3a67 7261 7068 3a3a 4e6f 6465  aph::graph::Node
+00000480: 496e 6465 783b 0a75 7365 2070 6574 6772  Index;.use petgr
+00000490: 6170 683a 3a70 7265 6c75 6465 3a3a 2a3b  aph::prelude::*;
+000004a0: 0a75 7365 2070 6574 6772 6170 683a 3a73  .use petgraph::s
+000004b0: 7461 626c 655f 6772 6170 683a 3a45 6467  table_graph::Edg
+000004c0: 6552 6566 6572 656e 6365 3b0a 7573 6520  eReference;.use 
+000004d0: 7065 7467 7261 7068 3a3a 756e 696f 6e66  petgraph::unionf
+000004e0: 696e 643a 3a55 6e69 6f6e 4669 6e64 3b0a  ind::UnionFind;.
+000004f0: 7573 6520 7065 7467 7261 7068 3a3a 7669  use petgraph::vi
+00000500: 7369 743a 3a7b 0a20 2020 2042 6673 2c20  sit::{.    Bfs, 
+00000510: 4461 7461 2c20 4772 6170 6842 6173 652c  Data, GraphBase,
+00000520: 2047 7261 7068 5072 6f70 2c20 496e 746f   GraphProp, Into
+00000530: 4564 6765 5265 6665 7265 6e63 6573 2c20  EdgeReferences, 
+00000540: 496e 746f 4e65 6967 6862 6f72 732c 0a20  IntoNeighbors,. 
+00000550: 2020 2049 6e74 6f4e 6f64 6549 6465 6e74     IntoNodeIdent
+00000560: 6966 6965 7273 2c20 4e6f 6465 436f 756e  ifiers, NodeCoun
+00000570: 742c 204e 6f64 6549 6e64 6578 6162 6c65  t, NodeIndexable
+00000580: 2c20 5265 7665 7273 6564 2c20 5669 7369  , Reversed, Visi
+00000590: 744d 6170 2c0a 2020 2020 5669 7369 7461  tMap,.    Visita
+000005a0: 626c 652c 0a7d 3b0a 7573 6520 7065 7467  ble,.};.use petg
+000005b0: 7261 7068 3a3a 4564 6765 5479 7065 3b0a  raph::EdgeType;.
+000005c0: 0a75 7365 206e 6461 7272 6179 3a3a 7072  .use ndarray::pr
+000005d0: 656c 7564 653a 3a2a 3b0a 7573 6520 6e75  elude::*;.use nu
+000005e0: 6d70 793a 3a49 6e74 6f50 7941 7272 6179  mpy::IntoPyArray
+000005f0: 3b0a 7573 6520 7261 6e64 3a3a 6469 7374  ;.use rand::dist
+00000600: 7269 6275 7469 6f6e 733a 3a7b 4469 7374  ributions::{Dist
+00000610: 7269 6275 7469 6f6e 2c20 556e 6966 6f72  ribution, Unifor
+00000620: 6d7d 3b0a 7573 6520 7261 6e64 3a3a 7072  m};.use rand::pr
+00000630: 656c 7564 653a 3a2a 3b0a 7573 6520 7261  elude::*;.use ra
+00000640: 6e64 5f70 6367 3a3a 5063 6736 343b 0a75  nd_pcg::Pcg64;.u
+00000650: 7365 2072 6179 6f6e 3a3a 7072 656c 7564  se rayon::prelud
+00000660: 653a 3a2a 3b0a 0a75 7365 2063 7261 7465  e::*;..use crate
+00000670: 3a3a 6765 6e65 7261 746f 7273 3a3a 5079  ::generators::Py
+00000680: 496e 6974 5f67 656e 6572 6174 6f72 733b  Init_generators;
+00000690: 0a75 7365 2063 7261 7465 3a3a 6974 6572  .use crate::iter
+000006a0: 6174 6f72 733a 3a7b 0a20 2020 2041 6c6c  ators::{.    All
+000006b0: 5061 6972 7350 6174 684c 656e 6774 684d  PairsPathLengthM
+000006c0: 6170 7069 6e67 2c20 416c 6c50 6169 7273  apping, AllPairs
+000006d0: 5061 7468 4d61 7070 696e 672c 2045 6467  PathMapping, Edg
+000006e0: 654c 6973 742c 204e 6f64 6549 6e64 6963  eList, NodeIndic
+000006f0: 6573 2c0a 2020 2020 5061 7468 4c65 6e67  es,.    PathLeng
+00000700: 7468 4d61 7070 696e 672c 2050 6174 684d  thMapping, PathM
+00000710: 6170 7069 6e67 2c20 506f 7332 444d 6170  apping, Pos2DMap
+00000720: 7069 6e67 2c20 5765 6967 6874 6564 4564  ping, WeightedEd
+00000730: 6765 4c69 7374 2c0a 7d3b 0a0a 7472 6169  geList,.};..trai
+00000740: 7420 4e6f 6465 7352 656d 6f76 6564 207b  t NodesRemoved {
+00000750: 0a20 2020 2066 6e20 6e6f 6465 735f 7265  .    fn nodes_re
+00000760: 6d6f 7665 6428 2673 656c 6629 202d 3e20  moved(&self) -> 
+00000770: 626f 6f6c 3b0a 7d0a 0a66 6e20 6c6f 6e67  bool;.}..fn long
+00000780: 6573 745f 7061 7468 2867 7261 7068 3a20  est_path(graph: 
+00000790: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
+000007a0: 6170 6829 202d 3e20 5079 5265 7375 6c74  aph) -> PyResult
+000007b0: 3c56 6563 3c75 7369 7a65 3e3e 207b 0a20  <Vec<usize>> {. 
+000007c0: 2020 206c 6574 2064 6167 203d 2026 6772     let dag = &gr
+000007d0: 6170 682e 6772 6170 683b 0a20 2020 206c  aph.graph;.    l
+000007e0: 6574 206d 7574 2070 6174 683a 2056 6563  et mut path: Vec
+000007f0: 3c75 7369 7a65 3e20 3d20 5665 633a 3a6e  <usize> = Vec::n
+00000800: 6577 2829 3b0a 2020 2020 6c65 7420 6e6f  ew();.    let no
+00000810: 6465 7320 3d20 6d61 7463 6820 616c 676f  des = match algo
+00000820: 3a3a 746f 706f 736f 7274 2867 7261 7068  ::toposort(graph
+00000830: 2c20 4e6f 6e65 2920 7b0a 2020 2020 2020  , None) {.      
+00000840: 2020 4f6b 286e 6f64 6573 2920 3d3e 206e    Ok(nodes) => n
+00000850: 6f64 6573 2c0a 2020 2020 2020 2020 4572  odes,.        Er
+00000860: 7228 5f65 7272 2920 3d3e 207b 0a20 2020  r(_err) => {.   
+00000870: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00000880: 4572 7228 4441 4748 6173 4379 636c 653a  Err(DAGHasCycle:
+00000890: 3a6e 6577 5f65 7272 2822 536f 7274 2065  :new_err("Sort e
+000008a0: 6e63 6f75 6e74 6572 6564 2061 2063 7963  ncountered a cyc
+000008b0: 6c65 2229 290a 2020 2020 2020 2020 7d0a  le")).        }.
+000008c0: 2020 2020 7d3b 0a20 2020 2069 6620 6e6f      };.    if no
+000008d0: 6465 732e 6973 5f65 6d70 7479 2829 207b  des.is_empty() {
+000008e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000008f0: 4f6b 2870 6174 6829 3b0a 2020 2020 7d0a  Ok(path);.    }.
+00000900: 2020 2020 6c65 7420 6d75 7420 6469 7374      let mut dist
+00000910: 3a20 4861 7368 4d61 703c 4e6f 6465 496e  : HashMap<NodeIn
+00000920: 6465 782c 2028 7573 697a 652c 204e 6f64  dex, (usize, Nod
+00000930: 6549 6e64 6578 293e 203d 2048 6173 684d  eIndex)> = HashM
+00000940: 6170 3a3a 6e65 7728 293b 0a20 2020 2066  ap::new();.    f
+00000950: 6f72 206e 6f64 6520 696e 206e 6f64 6573  or node in nodes
+00000960: 207b 0a20 2020 2020 2020 206c 6574 2070   {.        let p
+00000970: 6172 656e 7473 203d 0a20 2020 2020 2020  arents =.       
+00000980: 2020 2020 2064 6167 2e6e 6569 6768 626f       dag.neighbo
+00000990: 7273 5f64 6972 6563 7465 6428 6e6f 6465  rs_directed(node
+000009a0: 2c20 7065 7467 7261 7068 3a3a 4469 7265  , petgraph::Dire
+000009b0: 6374 696f 6e3a 3a49 6e63 6f6d 696e 6729  ction::Incoming)
+000009c0: 3b0a 2020 2020 2020 2020 6c65 7420 6d75  ;.        let mu
+000009d0: 7420 7573 3a20 5665 633c 2875 7369 7a65  t us: Vec<(usize
+000009e0: 2c20 4e6f 6465 496e 6465 7829 3e20 3d20  , NodeIndex)> = 
+000009f0: 5665 633a 3a6e 6577 2829 3b0a 2020 2020  Vec::new();.    
+00000a00: 2020 2020 666f 7220 705f 6e6f 6465 2069      for p_node i
+00000a10: 6e20 7061 7265 6e74 7320 7b0a 2020 2020  n parents {.    
+00000a20: 2020 2020 2020 2020 6c65 7420 6c65 6e67          let leng
+00000a30: 7468 203d 2064 6973 745b 2670 5f6e 6f64  th = dist[&p_nod
+00000a40: 655d 2e30 202b 2031 3b0a 2020 2020 2020  e].0 + 1;.      
+00000a50: 2020 2020 2020 7573 2e70 7573 6828 286c        us.push((l
+00000a60: 656e 6774 682c 2070 5f6e 6f64 6529 293b  ength, p_node));
+00000a70: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00000a80: 2020 206c 6574 206d 6178 753a 2028 7573     let maxu: (us
+00000a90: 697a 652c 204e 6f64 6549 6e64 6578 293b  ize, NodeIndex);
+00000aa0: 0a20 2020 2020 2020 2069 6620 2175 732e  .        if !us.
+00000ab0: 6973 5f65 6d70 7479 2829 207b 0a20 2020  is_empty() {.   
+00000ac0: 2020 2020 2020 2020 206d 6178 7520 3d20           maxu = 
+00000ad0: 2a75 732e 6974 6572 2829 2e6d 6178 5f62  *us.iter().max_b
+00000ae0: 795f 6b65 7928 7c78 7c20 782e 3029 2e75  y_key(|x| x.0).u
+00000af0: 6e77 7261 7028 293b 0a20 2020 2020 2020  nwrap();.       
+00000b00: 207d 2065 6c73 6520 7b0a 2020 2020 2020   } else {.      
+00000b10: 2020 2020 2020 6d61 7875 203d 2028 302c        maxu = (0,
+00000b20: 206e 6f64 6529 3b0a 2020 2020 2020 2020   node);.        
+00000b30: 7d3b 0a20 2020 2020 2020 2064 6973 742e  };.        dist.
+00000b40: 696e 7365 7274 286e 6f64 652c 206d 6178  insert(node, max
+00000b50: 7529 3b0a 2020 2020 7d0a 2020 2020 6c65  u);.    }.    le
+00000b60: 7420 6669 7273 7420 3d20 6d61 7463 6820  t first = match 
+00000b70: 6469 7374 2e6b 6579 7328 292e 6d61 785f  dist.keys().max_
+00000b80: 6279 5f6b 6579 287c 696e 6465 787c 2064  by_key(|index| d
+00000b90: 6973 745b 696e 6465 785d 2920 7b0a 2020  ist[index]) {.  
+00000ba0: 2020 2020 2020 536f 6d65 2866 6972 7374        Some(first
+00000bb0: 2920 3d3e 2066 6972 7374 2c0a 2020 2020  ) => first,.    
+00000bc0: 2020 2020 4e6f 6e65 203d 3e20 7b0a 2020      None => {.  
+00000bd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00000be0: 2045 7272 2850 7945 7863 6570 7469 6f6e   Err(PyException
+00000bf0: 3a3a 6e65 775f 6572 7228 0a20 2020 2020  ::new_err(.     
+00000c00: 2020 2020 2020 2020 2020 2022 456e 636f             "Enco
+00000c10: 756e 7465 7265 6420 736f 6d65 7468 696e  untered somethin
+00000c20: 6720 756e 6578 7065 6374 6564 222c 0a20  g unexpected",. 
+00000c30: 2020 2020 2020 2020 2020 2029 290a 2020             )).  
+00000c40: 2020 2020 2020 7d0a 2020 2020 7d3b 0a20        }.    };. 
+00000c50: 2020 206c 6574 206d 7574 2076 203d 202a     let mut v = *
+00000c60: 6669 7273 743b 0a20 2020 206c 6574 206d  first;.    let m
+00000c70: 7574 2075 3a20 4f70 7469 6f6e 3c4e 6f64  ut u: Option<Nod
+00000c80: 6549 6e64 6578 3e20 3d20 4e6f 6e65 3b0a  eIndex> = None;.
+00000c90: 2020 2020 7768 696c 6520 6d61 7463 6820      while match 
+00000ca0: 7520 7b0a 2020 2020 2020 2020 536f 6d65  u {.        Some
+00000cb0: 2875 2920 3d3e 2075 2021 3d20 762c 0a20  (u) => u != v,. 
+00000cc0: 2020 2020 2020 204e 6f6e 6520 3d3e 2074         None => t
+00000cd0: 7275 652c 0a20 2020 207d 207b 0a20 2020  rue,.    } {.   
+00000ce0: 2020 2020 2070 6174 682e 7075 7368 2876       path.push(v
+00000cf0: 2e69 6e64 6578 2829 293b 0a20 2020 2020  .index());.     
+00000d00: 2020 2075 203d 2053 6f6d 6528 7629 3b0a     u = Some(v);.
+00000d10: 2020 2020 2020 2020 7620 3d20 6469 7374          v = dist
+00000d20: 5b26 765d 2e31 3b0a 2020 2020 7d0a 2020  [&v].1;.    }.  
+00000d30: 2020 7061 7468 2e72 6576 6572 7365 2829    path.reverse()
+00000d40: 3b0a 2020 2020 4f6b 2870 6174 6829 0a7d  ;.    Ok(path).}
+00000d50: 0a0a 2f2f 2f20 4669 6e64 2074 6865 206c  ../// Find the l
+00000d60: 6f6e 6765 7374 2070 6174 6820 696e 2061  ongest path in a
+00000d70: 2044 4147 0a2f 2f2f 0a2f 2f2f 203a 7061   DAG.///./// :pa
+00000d80: 7261 6d20 5079 4469 4772 6170 6820 6772  ram PyDiGraph gr
+00000d90: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
+00000da0: 6f20 6669 6e64 2074 6865 206c 6f6e 6765  o find the longe
+00000db0: 7374 2070 6174 6820 6f6e 2e20 5468 6520  st path on. The 
+00000dc0: 696e 7075 740a 2f2f 2f20 2020 2020 6f62  input.///     ob
+00000dd0: 6a65 6374 206d 7573 7420 6265 2061 2044  ject must be a D
+00000de0: 4147 2077 6974 686f 7574 2061 2063 7963  AG without a cyc
+00000df0: 6c65 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  le..///./// :ret
+00000e00: 7572 6e73 3a20 5468 6520 6e6f 6465 2069  urns: The node i
+00000e10: 6e64 6963 6573 206f 6620 7468 6520 6c6f  ndices of the lo
+00000e20: 6e67 6573 7420 7061 7468 206f 6e20 7468  ngest path on th
+00000e30: 6520 4441 470a 2f2f 2f20 3a72 7479 7065  e DAG./// :rtype
+00000e40: 3a20 4e6f 6465 496e 6469 6365 730a 2f2f  : NodeIndices.//
+00000e50: 2f0a 2f2f 2f20 3a72 6169 7365 7320 4578  /./// :raises Ex
+00000e60: 6365 7074 696f 6e3a 2049 6620 616e 2075  ception: If an u
+00000e70: 6e65 7870 6563 7465 6420 6572 726f 7220  nexpected error 
+00000e80: 6f63 6375 7273 206f 7220 6120 7061 7468  occurs or a path
+00000e90: 2063 616e 2774 2062 6520 666f 756e 640a   can't be found.
+00000ea0: 2f2f 2f20 3a72 6169 7365 7320 4441 4748  /// :raises DAGH
+00000eb0: 6173 4379 636c 653a 2049 6620 7468 6520  asCycle: If the 
+00000ec0: 696e 7075 7420 5079 4469 4772 6170 6820  input PyDiGraph 
+00000ed0: 6861 7320 6120 6379 636c 650a 235b 7079  has a cycle.#[py
+00000ee0: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+00000ef0: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+00000f00: 7261 7068 2c20 2f29 225d 0a66 6e20 6461  raph, /)"].fn da
+00000f10: 675f 6c6f 6e67 6573 745f 7061 7468 2867  g_longest_path(g
+00000f20: 7261 7068 3a20 2664 6967 7261 7068 3a3a  raph: &digraph::
+00000f30: 5079 4469 4772 6170 6829 202d 3e20 5079  PyDiGraph) -> Py
+00000f40: 5265 7375 6c74 3c4e 6f64 6549 6e64 6963  Result<NodeIndic
+00000f50: 6573 3e20 7b0a 2020 2020 4f6b 284e 6f64  es> {.    Ok(Nod
+00000f60: 6549 6e64 6963 6573 207b 0a20 2020 2020  eIndices {.     
+00000f70: 2020 206e 6f64 6573 3a20 6c6f 6e67 6573     nodes: longes
+00000f80: 745f 7061 7468 2867 7261 7068 293f 2c0a  t_path(graph)?,.
+00000f90: 2020 2020 7d29 0a7d 0a0a 2f2f 2f20 4669      }).}../// Fi
+00000fa0: 6e64 2074 6865 206c 656e 6774 6820 6f66  nd the length of
+00000fb0: 2074 6865 206c 6f6e 6765 7374 2070 6174   the longest pat
+00000fc0: 6820 696e 2061 2044 4147 0a2f 2f2f 0a2f  h in a DAG.///./
+00000fd0: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
+00000fe0: 6170 6820 6772 6170 683a 2054 6865 2067  aph graph: The g
+00000ff0: 7261 7068 2074 6f20 6669 6e64 2074 6865  raph to find the
+00001000: 206c 6f6e 6765 7374 2070 6174 6820 6f6e   longest path on
+00001010: 2e20 5468 6520 696e 7075 740a 2f2f 2f20  . The input./// 
+00001020: 2020 2020 6f62 6a65 6374 206d 7573 7420      object must 
+00001030: 6265 2061 2044 4147 2077 6974 686f 7574  be a DAG without
+00001040: 2061 2063 7963 6c65 2e0a 2f2f 2f0a 2f2f   a cycle..///.//
+00001050: 2f20 3a72 6574 7572 6e73 3a20 5468 6520  / :returns: The 
+00001060: 6c6f 6e67 6573 7420 7061 7468 206c 656e  longest path len
+00001070: 6774 6820 6f6e 2074 6865 2044 4147 0a2f  gth on the DAG./
+00001080: 2f2f 203a 7274 7970 653a 2069 6e74 0a2f  // :rtype: int./
+00001090: 2f2f 0a2f 2f2f 203a 7261 6973 6573 2045  //./// :raises E
+000010a0: 7863 6570 7469 6f6e 3a20 4966 2061 6e20  xception: If an 
+000010b0: 756e 6578 7065 6374 6564 2065 7272 6f72  unexpected error
+000010c0: 206f 6363 7572 7320 6f72 2061 2070 6174   occurs or a pat
+000010d0: 6820 6361 6e27 7420 6265 2066 6f75 6e64  h can't be found
+000010e0: 0a2f 2f2f 203a 7261 6973 6573 2044 4147  ./// :raises DAG
+000010f0: 4861 7343 7963 6c65 3a20 4966 2074 6865  HasCycle: If the
+00001100: 2069 6e70 7574 2050 7944 6947 7261 7068   input PyDiGraph
+00001110: 2068 6173 2061 2063 7963 6c65 0a23 5b70   has a cycle.#[p
+00001120: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
+00001130: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+00001140: 6772 6170 682c 202f 2922 5d0a 666e 2064  graph, /)"].fn d
+00001150: 6167 5f6c 6f6e 6765 7374 5f70 6174 685f  ag_longest_path_
+00001160: 6c65 6e67 7468 2867 7261 7068 3a20 2664  length(graph: &d
+00001170: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
+00001180: 6829 202d 3e20 5079 5265 7375 6c74 3c75  h) -> PyResult<u
+00001190: 7369 7a65 3e20 7b0a 2020 2020 6c65 7420  size> {.    let 
+000011a0: 7061 7468 203d 206c 6f6e 6765 7374 5f70  path = longest_p
+000011b0: 6174 6828 6772 6170 6829 3f3b 0a20 2020  ath(graph)?;.   
+000011c0: 2069 6620 7061 7468 2e69 735f 656d 7074   if path.is_empt
+000011d0: 7928 2920 7b0a 2020 2020 2020 2020 7265  y() {.        re
+000011e0: 7475 726e 204f 6b28 3029 3b0a 2020 2020  turn Ok(0);.    
+000011f0: 7d0a 2020 2020 6c65 7420 7061 7468 5f6c  }.    let path_l
+00001200: 656e 6774 683a 2075 7369 7a65 203d 2070  ength: usize = p
+00001210: 6174 682e 6c65 6e28 2920 2d20 313b 0a20  ath.len() - 1;. 
+00001220: 2020 204f 6b28 7061 7468 5f6c 656e 6774     Ok(path_lengt
+00001230: 6829 0a7d 0a0a 2f2f 2f20 4669 6e64 2074  h).}../// Find t
+00001240: 6865 206e 756d 6265 7220 6f66 2077 6561  he number of wea
+00001250: 6b6c 7920 636f 6e6e 6563 7465 6420 636f  kly connected co
+00001260: 6d70 6f6e 656e 7473 2069 6e20 6120 4441  mponents in a DA
+00001270: 472e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  G..///./// :para
+00001280: 6d20 5079 4469 4772 6170 6820 6772 6170  m PyDiGraph grap
+00001290: 683a 2054 6865 2067 7261 7068 2074 6f20  h: The graph to 
+000012a0: 6669 6e64 2074 6865 206e 756d 6265 7220  find the number 
+000012b0: 6f66 2077 6561 6b6c 7920 636f 6e6e 6563  of weakly connec
+000012c0: 7465 640a 2f2f 2f20 2020 2020 636f 6d70  ted.///     comp
+000012d0: 6f6e 656e 7473 206f 6e0a 2f2f 2f0a 2f2f  onents on.///.//
+000012e0: 2f20 3a72 6574 7572 6e73 3a20 5468 6520  / :returns: The 
+000012f0: 6e75 6d62 6572 206f 6620 7765 616b 6c79  number of weakly
+00001300: 2063 6f6e 6e65 6374 6564 2063 6f6d 706f   connected compo
+00001310: 6e65 6e74 7320 696e 2074 6865 2044 4147  nents in the DAG
+00001320: 0a2f 2f2f 203a 7274 7970 653a 2069 6e74  ./// :rtype: int
+00001330: 0a23 5b70 7966 756e 6374 696f 6e5d 0a23  .#[pyfunction].#
+00001340: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
+00001350: 3d20 2228 6772 6170 682c 202f 2922 5d0a  = "(graph, /)"].
+00001360: 666e 206e 756d 6265 725f 7765 616b 6c79  fn number_weakly
+00001370: 5f63 6f6e 6e65 6374 6564 5f63 6f6d 706f  _connected_compo
+00001380: 6e65 6e74 7328 6772 6170 683a 2026 6469  nents(graph: &di
+00001390: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
+000013a0: 2920 2d3e 2075 7369 7a65 207b 0a20 2020  ) -> usize {.   
+000013b0: 2061 6c67 6f3a 3a63 6f6e 6e65 6374 6564   algo::connected
+000013c0: 5f63 6f6d 706f 6e65 6e74 7328 6772 6170  _components(grap
+000013d0: 6829 0a7d 0a0a 2f2f 2f20 4669 6e64 2074  h).}../// Find t
+000013e0: 6865 2077 6561 6b6c 7920 636f 6e6e 6563  he weakly connec
+000013f0: 7465 6420 636f 6d70 6f6e 656e 7473 2069  ted components i
+00001400: 6e20 6120 6469 7265 6374 6564 2067 7261  n a directed gra
+00001410: 7068 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  ph.///./// :para
+00001420: 6d20 5079 4469 4772 6170 6820 6772 6170  m PyDiGraph grap
+00001430: 683a 2054 6865 2067 7261 7068 2074 6f20  h: The graph to 
+00001440: 6669 6e64 2074 6865 2077 6561 6b6c 7920  find the weakly 
+00001450: 636f 6e6e 6563 7465 6420 636f 6d70 6f6e  connected compon
+00001460: 656e 7473 0a2f 2f2f 2020 2020 2069 6e0a  ents.///     in.
+00001470: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
+00001480: 3a20 4120 6c69 7374 206f 6620 7365 7473  : A list of sets
+00001490: 2077 6865 7265 2065 6163 6820 7365 7420   where each set 
+000014a0: 6974 2061 2077 6561 6b6c 7920 636f 6e6e  it a weakly conn
+000014b0: 6563 7465 6420 636f 6d70 6f6e 656e 7420  ected component 
+000014c0: 6f66 0a2f 2f2f 2020 2020 2074 6865 2067  of.///     the g
+000014d0: 7261 7068 0a2f 2f2f 203a 7274 7970 653a  raph./// :rtype:
+000014e0: 206c 6973 740a 235b 7079 6675 6e63 7469   list.#[pyfuncti
+000014f0: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
+00001500: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
+00001510: 2f29 225d 0a70 7562 2066 6e20 7765 616b  /)"].pub fn weak
+00001520: 6c79 5f63 6f6e 6e65 6374 6564 5f63 6f6d  ly_connected_com
+00001530: 706f 6e65 6e74 7328 0a20 2020 2067 7261  ponents(.    gra
+00001540: 7068 3a20 2664 6967 7261 7068 3a3a 5079  ph: &digraph::Py
+00001550: 4469 4772 6170 682c 0a29 202d 3e20 5665  DiGraph,.) -> Ve
+00001560: 633c 4254 7265 6553 6574 3c75 7369 7a65  c<BTreeSet<usize
+00001570: 3e3e 207b 0a20 2020 206c 6574 206d 7574  >> {.    let mut
+00001580: 2073 6565 6e3a 2048 6173 6853 6574 3c4e   seen: HashSet<N
+00001590: 6f64 6549 6e64 6578 3e20 3d0a 2020 2020  odeIndex> =.    
+000015a0: 2020 2020 4861 7368 5365 743a 3a77 6974      HashSet::wit
+000015b0: 685f 6361 7061 6369 7479 2867 7261 7068  h_capacity(graph
+000015c0: 2e6e 6f64 655f 636f 756e 7428 2929 3b0a  .node_count());.
+000015d0: 2020 2020 6c65 7420 6d75 7420 6f75 745f      let mut out_
+000015e0: 7665 633a 2056 6563 3c42 5472 6565 5365  vec: Vec<BTreeSe
+000015f0: 743c 7573 697a 653e 3e20 3d20 5665 633a  t<usize>> = Vec:
+00001600: 3a6e 6577 2829 3b0a 2020 2020 666f 7220  :new();.    for 
+00001610: 6e6f 6465 2069 6e20 6772 6170 682e 6772  node in graph.gr
+00001620: 6170 682e 6e6f 6465 5f69 6e64 6963 6573  aph.node_indices
+00001630: 2829 207b 0a20 2020 2020 2020 2069 6620  () {.        if 
+00001640: 2173 6565 6e2e 636f 6e74 6169 6e73 2826  !seen.contains(&
+00001650: 6e6f 6465 2920 7b0a 2020 2020 2020 2020  node) {.        
+00001660: 2020 2020 2f2f 2042 4653 206e 6f64 6520      // BFS node 
+00001670: 6765 6e65 7261 746f 720a 2020 2020 2020  generator.      
+00001680: 2020 2020 2020 6c65 7420 6d75 7420 636f        let mut co
+00001690: 6d70 6f6e 656e 745f 7365 743a 2042 5472  mponent_set: BTr
+000016a0: 6565 5365 743c 7573 697a 653e 203d 2042  eeSet<usize> = B
+000016b0: 5472 6565 5365 743a 3a6e 6577 2829 3b0a  TreeSet::new();.
+000016c0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+000016d0: 6d75 7420 6266 735f 7365 656e 3a20 4861  mut bfs_seen: Ha
+000016e0: 7368 5365 743c 4e6f 6465 496e 6465 783e  shSet<NodeIndex>
+000016f0: 203d 2048 6173 6853 6574 3a3a 6e65 7728   = HashSet::new(
+00001700: 293b 0a20 2020 2020 2020 2020 2020 206c  );.            l
+00001710: 6574 206d 7574 206e 6578 745f 6c65 7665  et mut next_leve
+00001720: 6c3a 2048 6173 6853 6574 3c4e 6f64 6549  l: HashSet<NodeI
+00001730: 6e64 6578 3e20 3d20 4861 7368 5365 743a  ndex> = HashSet:
+00001740: 3a6e 6577 2829 3b0a 2020 2020 2020 2020  :new();.        
+00001750: 2020 2020 6e65 7874 5f6c 6576 656c 2e69      next_level.i
+00001760: 6e73 6572 7428 6e6f 6465 293b 0a20 2020  nsert(node);.   
+00001770: 2020 2020 2020 2020 2077 6869 6c65 2021           while !
+00001780: 6e65 7874 5f6c 6576 656c 2e69 735f 656d  next_level.is_em
+00001790: 7074 7928 2920 7b0a 2020 2020 2020 2020  pty() {.        
+000017a0: 2020 2020 2020 2020 6c65 7420 7468 6973          let this
+000017b0: 5f6c 6576 656c 203d 206e 6578 745f 6c65  _level = next_le
+000017c0: 7665 6c3b 0a20 2020 2020 2020 2020 2020  vel;.           
+000017d0: 2020 2020 206e 6578 745f 6c65 7665 6c20       next_level 
+000017e0: 3d20 4861 7368 5365 743a 3a6e 6577 2829  = HashSet::new()
+000017f0: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00001800: 2020 666f 7220 6266 735f 6e6f 6465 2069    for bfs_node i
+00001810: 6e20 7468 6973 5f6c 6576 656c 207b 0a20  n this_level {. 
+00001820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001830: 2020 2069 6620 2162 6673 5f73 6565 6e2e     if !bfs_seen.
+00001840: 636f 6e74 6169 6e73 2826 6266 735f 6e6f  contains(&bfs_no
+00001850: 6465 2920 7b0a 2020 2020 2020 2020 2020  de) {.          
+00001860: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00001870: 6d70 6f6e 656e 745f 7365 742e 696e 7365  mponent_set.inse
+00001880: 7274 2862 6673 5f6e 6f64 652e 696e 6465  rt(bfs_node.inde
+00001890: 7828 2929 3b0a 2020 2020 2020 2020 2020  x());.          
+000018a0: 2020 2020 2020 2020 2020 2020 2020 6266                bf
+000018b0: 735f 7365 656e 2e69 6e73 6572 7428 6266  s_seen.insert(bf
+000018c0: 735f 6e6f 6465 293b 0a20 2020 2020 2020  s_node);.       
+000018d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000018e0: 2066 6f72 206e 6569 6768 626f 7220 696e   for neighbor in
+000018f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001900: 2020 2020 2020 2020 2020 2020 2067 7261               gra
+00001910: 7068 2e67 7261 7068 2e6e 6569 6768 626f  ph.graph.neighbo
+00001920: 7273 5f75 6e64 6972 6563 7465 6428 6266  rs_undirected(bf
+00001930: 735f 6e6f 6465 290a 2020 2020 2020 2020  s_node).        
+00001940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001950: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00001960: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00001970: 7874 5f6c 6576 656c 2e69 6e73 6572 7428  xt_level.insert(
+00001980: 6e65 6967 6862 6f72 293b 0a20 2020 2020  neighbor);.     
+00001990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019a0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+000019b0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+000019c0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+000019d0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+000019e0: 2020 2020 2020 206f 7574 5f76 6563 2e70         out_vec.p
+000019f0: 7573 6828 636f 6d70 6f6e 656e 745f 7365  ush(component_se
+00001a00: 7429 3b0a 2020 2020 2020 2020 2020 2020  t);.            
+00001a10: 7365 656e 2e65 7874 656e 6428 6266 735f  seen.extend(bfs_
+00001a20: 7365 656e 293b 0a20 2020 2020 2020 207d  seen);.        }
+00001a30: 0a20 2020 207d 0a20 2020 206f 7574 5f76  .    }.    out_v
+00001a40: 6563 0a7d 0a0a 2f2f 2f20 4368 6563 6b20  ec.}../// Check 
+00001a50: 6966 2074 6865 2067 7261 7068 2069 7320  if the graph is 
+00001a60: 7765 616b 6c79 2063 6f6e 6e65 6374 6564  weakly connected
+00001a70: 0a2f 2f2f 0a2f 2f2f 203a 7061 7261 6d20  .///./// :param 
+00001a80: 5079 4469 4772 6170 6820 6772 6170 683a  PyDiGraph graph:
+00001a90: 2054 6865 2067 7261 7068 2074 6f20 6368   The graph to ch
+00001aa0: 6563 6b20 6966 2069 7420 6973 2077 6561  eck if it is wea
+00001ab0: 6b6c 7920 636f 6e6e 6563 7465 640a 2f2f  kly connected.//
+00001ac0: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+00001ad0: 5768 6574 6865 7220 7468 6520 6772 6170  Whether the grap
+00001ae0: 6820 6973 2077 6561 6b6c 7920 636f 6e6e  h is weakly conn
+00001af0: 6563 7465 6420 6f72 206e 6f74 0a2f 2f2f  ected or not.///
+00001b00: 203a 7274 7970 653a 2062 6f6f 6c0a 2f2f   :rtype: bool.//
+00001b10: 2f0a 2f2f 2f20 3a72 6169 7365 7320 4e75  /./// :raises Nu
+00001b20: 6c6c 4772 6170 683a 2049 6620 616e 2065  llGraph: If an e
+00001b30: 6d70 7479 2067 7261 7068 2069 7320 7061  mpty graph is pa
+00001b40: 7373 6564 2069 6e0a 235b 7079 6675 6e63  ssed in.#[pyfunc
+00001b50: 7469 6f6e 5d0a 235b 7465 7874 5f73 6967  tion].#[text_sig
+00001b60: 6e61 7475 7265 203d 2022 2867 7261 7068  nature = "(graph
+00001b70: 2c20 2f29 225d 0a70 7562 2066 6e20 6973  , /)"].pub fn is
+00001b80: 5f77 6561 6b6c 795f 636f 6e6e 6563 7465  _weakly_connecte
+00001b90: 6428 6772 6170 683a 2026 6469 6772 6170  d(graph: &digrap
+00001ba0: 683a 3a50 7944 6947 7261 7068 2920 2d3e  h::PyDiGraph) ->
+00001bb0: 2050 7952 6573 756c 743c 626f 6f6c 3e20   PyResult<bool> 
+00001bc0: 7b0a 2020 2020 6966 2067 7261 7068 2e67  {.    if graph.g
+00001bd0: 7261 7068 2e6e 6f64 655f 636f 756e 7428  raph.node_count(
+00001be0: 2920 3d3d 2030 207b 0a20 2020 2020 2020  ) == 0 {.       
+00001bf0: 2072 6574 7572 6e20 4572 7228 4e75 6c6c   return Err(Null
+00001c00: 4772 6170 683a 3a6e 6577 5f65 7272 2822  Graph::new_err("
+00001c10: 496e 7661 6c69 6420 6f70 6572 6174 696f  Invalid operatio
+00001c20: 6e20 6f6e 2061 204e 756c 6c47 7261 7068  n on a NullGraph
+00001c30: 2229 293b 0a20 2020 207d 0a20 2020 204f  "));.    }.    O
+00001c40: 6b28 7765 616b 6c79 5f63 6f6e 6e65 6374  k(weakly_connect
+00001c50: 6564 5f63 6f6d 706f 6e65 6e74 7328 6772  ed_components(gr
+00001c60: 6170 6829 5b30 5d2e 6c65 6e28 2920 3d3d  aph)[0].len() ==
+00001c70: 2067 7261 7068 2e67 7261 7068 2e6e 6f64   graph.graph.nod
+00001c80: 655f 636f 756e 7428 2929 0a7d 0a0a 2f2f  e_count()).}..//
+00001c90: 2f20 4368 6563 6b20 7468 6174 2074 6865  / Check that the
+00001ca0: 2050 7944 6947 7261 7068 206f 7220 5079   PyDiGraph or Py
+00001cb0: 4441 4720 646f 6573 6e27 7420 6861 7665  DAG doesn't have
+00001cc0: 2061 2063 7963 6c65 0a2f 2f2f 0a2f 2f2f   a cycle.///.///
+00001cd0: 203a 7061 7261 6d20 5079 4469 4772 6170   :param PyDiGrap
+00001ce0: 6820 6772 6170 683a 2054 6865 2067 7261  h graph: The gra
+00001cf0: 7068 2074 6f20 6368 6563 6b20 666f 7220  ph to check for 
+00001d00: 6379 636c 6573 0a2f 2f2f 0a2f 2f2f 203a  cycles.///./// :
+00001d10: 7265 7475 726e 733a 2060 6054 7275 6560  returns: ``True`
+00001d20: 6020 6966 2074 6865 7265 2061 7265 206e  ` if there are n
+00001d30: 6f20 6379 636c 6573 2069 6e20 7468 6520  o cycles in the 
+00001d40: 696e 7075 7420 6772 6170 682c 2060 6046  input graph, ``F
+00001d50: 616c 7365 6060 0a2f 2f2f 2020 2020 2069  alse``.///     i
+00001d60: 6620 7468 6572 6520 6172 6520 6379 636c  f there are cycl
+00001d70: 6573 0a2f 2f2f 203a 7274 7970 653a 2062  es./// :rtype: b
+00001d80: 6f6f 6c0a 235b 7079 6675 6e63 7469 6f6e  ool.#[pyfunction
+00001d90: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+00001da0: 7265 203d 2022 2867 7261 7068 2c20 2f29  re = "(graph, /)
+00001db0: 225d 0a66 6e20 6973 5f64 6972 6563 7465  "].fn is_directe
+00001dc0: 645f 6163 7963 6c69 635f 6772 6170 6828  d_acyclic_graph(
+00001dd0: 6772 6170 683a 2026 6469 6772 6170 683a  graph: &digraph:
+00001de0: 3a50 7944 6947 7261 7068 2920 2d3e 2062  :PyDiGraph) -> b
+00001df0: 6f6f 6c20 7b0a 2020 2020 6d61 7463 6820  ool {.    match 
+00001e00: 616c 676f 3a3a 746f 706f 736f 7274 2867  algo::toposort(g
+00001e10: 7261 7068 2c20 4e6f 6e65 2920 7b0a 2020  raph, None) {.  
+00001e20: 2020 2020 2020 4f6b 285f 6e6f 6465 7329        Ok(_nodes)
+00001e30: 203d 3e20 7472 7565 2c0a 2020 2020 2020   => true,.      
+00001e40: 2020 4572 7228 5f65 7272 2920 3d3e 2066    Err(_err) => f
+00001e50: 616c 7365 2c0a 2020 2020 7d0a 7d0a 0a2f  alse,.    }.}../
+00001e60: 2f2f 2052 6574 7572 6e20 6120 6e65 7720  // Return a new 
+00001e70: 5079 4469 4772 6170 6820 6279 2066 6f72  PyDiGraph by for
+00001e80: 6d69 6e67 2061 2075 6e69 6f6e 2066 726f  ming a union fro
+00001e90: 6d20 7477 6f20 696e 7075 7420 5079 4469  m two input PyDi
+00001ea0: 4772 6170 6820 6f62 6a65 6374 730a 2f2f  Graph objects.//
+00001eb0: 2f0a 2f2f 2f20 5468 6520 616c 676f 7269  /./// The algori
+00001ec0: 7468 6d20 696e 2074 6869 7320 6675 6e63  thm in this func
+00001ed0: 7469 6f6e 206f 7065 7261 7465 7320 696e  tion operates in
+00001ee0: 2074 6872 6565 2070 6861 7365 733a 0a2f   three phases:./
+00001ef0: 2f2f 0a2f 2f2f 2020 312e 2041 6464 2061  //.///  1. Add a
+00001f00: 6c6c 2074 6865 206e 6f64 6573 2066 726f  ll the nodes fro
+00001f10: 6d20 2060 6073 6563 6f6e 6460 6020 696e  m  ``second`` in
+00001f20: 746f 2060 6066 6972 7374 6060 2e20 6f70  to ``first``. op
+00001f30: 6572 6174 6573 2069 6e20 4f28 6e29 2c0a  erates in O(n),.
+00001f40: 2f2f 2f20 2020 2020 7769 7468 206e 2062  ///     with n b
+00001f50: 6569 6e67 206e 756d 6265 7220 6f66 206e  eing number of n
+00001f60: 6f64 6573 2069 6e20 6062 602e 0a2f 2f2f  odes in `b`..///
+00001f70: 2020 322e 204d 6572 6765 206e 6f64 6573    2. Merge nodes
+00001f80: 2066 726f 6d20 6060 7365 636f 6e64 6060   from ``second``
+00001f90: 206f 7665 7220 6060 6669 7273 7460 6020   over ``first`` 
+00001fa0: 6769 7665 6e20 7468 6174 3a0a 2f2f 2f0a  given that:.///.
+00001fb0: 2f2f 2f20 2020 2020 2d20 5468 6520 6060  ///     - The ``
+00001fc0: 6d65 7267 655f 6e6f 6465 7360 6020 6973  merge_nodes`` is
+00001fd0: 2060 6054 7275 6560 602e 206f 7065 7261   ``True``. opera
+00001fe0: 7465 7320 696e 204f 286e 5e32 292c 2077  tes in O(n^2), w
+00001ff0: 6974 6820 6e20 6265 696e 6720 7468 650a  ith n being the.
+00002000: 2f2f 2f20 2020 2020 2020 6e75 6d62 6572  ///       number
+00002010: 206f 6620 6e6f 6465 7320 696e 2060 6073   of nodes in ``s
+00002020: 6563 6f6e 6460 602e 0a2f 2f2f 2020 2020  econd``..///    
+00002030: 202d 2054 6865 2072 6573 7065 6374 6976   - The respectiv
+00002040: 6520 6e6f 6465 2069 6e20 6060 7365 636f  e node in ``seco
+00002050: 6e64 6060 2061 6e64 2060 6066 6972 7374  nd`` and ``first
+00002060: 6060 2073 6861 7265 2074 6865 2073 616d  `` share the sam
+00002070: 650a 2f2f 2f20 2020 2020 2020 7765 6967  e.///       weig
+00002080: 6874 2f64 6174 6120 7061 796c 6f61 642e  ht/data payload.
+00002090: 0a2f 2f2f 0a2f 2f2f 2020 332e 2041 6464  .///.///  3. Add
+000020a0: 7320 616c 6c20 7468 6520 6564 6765 7320  s all the edges 
+000020b0: 6672 6f6d 2060 6073 6563 6f6e 6460 6020  from ``second`` 
+000020c0: 746f 2060 6066 6972 7374 6060 2e20 4966  to ``first``. If
+000020d0: 2074 6865 2060 606d 6572 6765 5f65 6467   the ``merge_edg
+000020e0: 6573 6060 0a2f 2f2f 2020 2020 2070 6172  es``.///     par
+000020f0: 616d 6574 6572 2069 7320 6060 5472 7565  ameter is ``True
+00002100: 6060 2061 6e64 2074 6865 2072 6573 7065  `` and the respe
+00002110: 6374 6976 6520 6564 6765 2069 6e20 6060  ctive edge in ``
+00002120: 7365 636f 6e64 6060 2061 6e64 0a2f 2f2f  second`` and.///
+00002130: 2020 2020 2066 6972 7374 6060 2073 6861       first`` sha
+00002140: 7265 2074 6865 2073 616d 6520 7765 6967  re the same weig
+00002150: 6874 2f64 6174 6120 7061 796c 6f61 6420  ht/data payload 
+00002160: 7468 6579 2077 696c 6c20 6265 206d 6572  they will be mer
+00002170: 6765 640a 2f2f 2f20 2020 2020 746f 6765  ged.///     toge
+00002180: 7468 6572 2e0a 2f2f 2f0a 2f2f 2f20 203a  ther..///.///  :
+00002190: 7061 7261 6d20 5079 4469 4772 6170 6820  param PyDiGraph 
+000021a0: 6669 7273 743a 2054 6865 2066 6972 7374  first: The first
+000021b0: 2064 6972 6563 7465 6420 6772 6170 6820   directed graph 
+000021c0: 6f62 6a65 6374 0a2f 2f2f 2020 3a70 6172  object.///  :par
+000021d0: 616d 2050 7944 6947 7261 7068 2073 6563  am PyDiGraph sec
+000021e0: 6f6e 643a 2054 6865 2073 6563 6f6e 6420  ond: The second 
+000021f0: 6469 7265 6374 6564 2067 7261 7068 206f  directed graph o
+00002200: 626a 6563 740a 2f2f 2f20 203a 7061 7261  bject.///  :para
+00002210: 6d20 626f 6f6c 206d 6572 6765 5f6e 6f64  m bool merge_nod
+00002220: 6573 3a20 4966 2073 6574 2074 6f20 6060  es: If set to ``
+00002230: 5472 7565 6060 206e 6f64 6573 2077 696c  True`` nodes wil
+00002240: 6c20 6265 206d 6572 6765 6420 6265 7477  l be merged betw
+00002250: 6565 6e0a 2f2f 2f20 2020 2020 6060 7365  een.///     ``se
+00002260: 636f 6e64 6060 2061 6e64 2060 6066 6972  cond`` and ``fir
+00002270: 7374 6060 2069 6620 7468 6520 7765 6967  st`` if the weig
+00002280: 6874 7320 6172 6520 6571 7561 6c2e 0a2f  hts are equal../
+00002290: 2f2f 2020 3a70 6172 616d 2062 6f6f 6c20  //  :param bool 
+000022a0: 6d65 7267 655f 6564 6765 733a 2049 6620  merge_edges: If 
+000022b0: 7365 7420 746f 2060 6054 7275 6560 6020  set to ``True`` 
+000022c0: 6564 6765 7320 7769 6c6c 2062 6520 6d65  edges will be me
+000022d0: 7267 6564 2062 6574 7765 656e 0a2f 2f2f  rged between.///
+000022e0: 2020 2020 2060 6073 6563 6f6e 6460 6020       ``second`` 
+000022f0: 616e 6420 6060 6669 7273 7460 6020 6966  and ``first`` if
+00002300: 2074 6865 2077 6569 6768 7473 2061 7265   the weights are
+00002310: 2065 7175 616c 2e0a 2f2f 2f0a 2f2f 2f20   equal..///./// 
+00002320: 203a 7265 7475 726e 733a 2041 206e 6577   :returns: A new
+00002330: 2050 7944 6947 7261 7068 206f 626a 6563   PyDiGraph objec
+00002340: 7420 7468 6174 2069 7320 7468 6520 756e  t that is the un
+00002350: 696f 6e20 6f66 2060 6073 6563 6f6e 6460  ion of ``second`
+00002360: 6020 616e 640a 2f2f 2f20 2020 2020 6060  ` and.///     ``
+00002370: 6669 7273 7460 602e 2049 7427 7320 776f  first``. It's wo
+00002380: 7274 6820 6e6f 7469 6e67 2074 6865 2077  rth noting the w
+00002390: 6569 6768 742f 6461 7461 2070 6179 6c6f  eight/data paylo
+000023a0: 6164 206f 626a 6563 7473 2061 7265 0a2f  ad objects are./
+000023b0: 2f2f 2020 2020 2070 6173 7365 6420 6279  //     passed by
+000023c0: 2072 6566 6572 656e 6365 2066 726f 6d20   reference from 
+000023d0: 6060 6669 7273 7460 6020 616e 6420 6060  ``first`` and ``
+000023e0: 7365 636f 6e64 6060 2074 6f20 7468 6973  second`` to this
+000023f0: 206e 6577 206f 626a 6563 742e 0a2f 2f2f   new object..///
+00002400: 2020 3a72 7479 7065 3a20 5079 4469 4772    :rtype: PyDiGr
+00002410: 6170 680a 235b 7079 6675 6e63 7469 6f6e  aph.#[pyfunction
+00002420: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+00002430: 7265 203d 2022 2866 6972 7374 2c20 7365  re = "(first, se
+00002440: 636f 6e64 2c20 6d65 7267 655f 6e6f 6465  cond, merge_node
+00002450: 732c 206d 6572 6765 5f65 6467 6573 2c20  s, merge_edges, 
+00002460: 2f29 225d 0a66 6e20 6469 6772 6170 685f  /)"].fn digraph_
+00002470: 756e 696f 6e28 0a20 2020 2070 793a 2050  union(.    py: P
+00002480: 7974 686f 6e2c 0a20 2020 2066 6972 7374  ython,.    first
+00002490: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+000024a0: 4772 6170 682c 0a20 2020 2073 6563 6f6e  Graph,.    secon
+000024b0: 643a 2026 6469 6772 6170 683a 3a50 7944  d: &digraph::PyD
+000024c0: 6947 7261 7068 2c0a 2020 2020 6d65 7267  iGraph,.    merg
+000024d0: 655f 6e6f 6465 733a 2062 6f6f 6c2c 0a20  e_nodes: bool,. 
+000024e0: 2020 206d 6572 6765 5f65 6467 6573 3a20     merge_edges: 
+000024f0: 626f 6f6c 2c0a 2920 2d3e 2050 7952 6573  bool,.) -> PyRes
+00002500: 756c 743c 6469 6772 6170 683a 3a50 7944  ult<digraph::PyD
+00002510: 6947 7261 7068 3e20 7b0a 2020 2020 6c65  iGraph> {.    le
+00002520: 7420 7265 7320 3d0a 2020 2020 2020 2020  t res =.        
+00002530: 756e 696f 6e3a 3a64 6967 7261 7068 5f75  union::digraph_u
+00002540: 6e69 6f6e 2870 792c 2066 6972 7374 2c20  nion(py, first, 
+00002550: 7365 636f 6e64 2c20 6d65 7267 655f 6e6f  second, merge_no
+00002560: 6465 732c 206d 6572 6765 5f65 6467 6573  des, merge_edges
+00002570: 293f 3b0a 2020 2020 4f6b 2872 6573 290a  )?;.    Ok(res).
+00002580: 7d0a 0a2f 2f2f 2044 6574 6572 6d69 6e65  }../// Determine
+00002590: 2069 6620 3220 6469 7265 6374 6564 2067   if 2 directed g
+000025a0: 7261 7068 7320 6172 6520 6973 6f6d 6f72  raphs are isomor
+000025b0: 7068 6963 0a2f 2f2f 0a2f 2f2f 2054 6869  phic.///./// Thi
+000025c0: 7320 6368 6563 6b73 2069 6620 3220 6772  s checks if 2 gr
+000025d0: 6170 6873 2061 7265 2069 736f 6d6f 7270  aphs are isomorp
+000025e0: 6869 6320 626f 7468 2073 7472 7563 7475  hic both structu
+000025f0: 7261 6c6c 7920 616e 6420 616c 736f 0a2f  rally and also./
+00002600: 2f2f 2063 6f6d 7061 7269 6e67 2074 6865  // comparing the
+00002610: 206e 6f64 6520 6461 7461 2061 6e64 2065   node data and e
+00002620: 6467 6520 6461 7461 2075 7369 6e67 2074  dge data using t
+00002630: 6865 2070 726f 7669 6465 6420 6d61 7463  he provided matc
+00002640: 6865 7220 6675 6e63 7469 6f6e 732e 0a2f  her functions../
+00002650: 2f2f 2054 6865 206d 6174 6368 6572 2066  // The matcher f
+00002660: 756e 6374 696f 6e20 7461 6b65 7320 696e  unction takes in
+00002670: 2032 2064 6174 6120 6f62 6a65 6374 7320   2 data objects 
+00002680: 616e 6420 7769 6c6c 2063 6f6d 7061 7265  and will compare
+00002690: 2074 6865 6d2e 2041 2073 696d 706c 650a   them. A simple.
+000026a0: 2f2f 2f20 6578 616d 706c 6520 7468 6174  /// example that
+000026b0: 2063 6865 636b 7320 6966 2074 6865 7927   checks if they'
+000026c0: 7265 206a 7573 7420 6571 7561 6c20 776f  re just equal wo
+000026d0: 756c 6420 6265 3a3a 0a2f 2f2f 0a2f 2f2f  uld be::.///.///
+000026e0: 2020 2020 2067 7261 7068 5f61 203d 2072       graph_a = r
+000026f0: 6574 776f 726b 782e 5079 4469 4772 6170  etworkx.PyDiGrap
+00002700: 6828 290a 2f2f 2f20 2020 2020 6772 6170  h().///     grap
+00002710: 685f 6220 3d20 7265 7477 6f72 6b78 2e50  h_b = retworkx.P
+00002720: 7944 6947 7261 7068 2829 0a2f 2f2f 2020  yDiGraph().///  
+00002730: 2020 2072 6574 776f 726b 782e 6973 5f69     retworkx.is_i
+00002740: 736f 6d6f 7270 6869 6328 6772 6170 685f  somorphic(graph_
+00002750: 612c 2067 7261 7068 5f62 2c0a 2f2f 2f20  a, graph_b,./// 
+00002760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002770: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
+00002780: 6120 782c 2079 3a20 7820 3d3d 2079 290a  a x, y: x == y).
+00002790: 2f2f 2f0a 2f2f 2f20 2e2e 206e 6f74 653a  ///./// .. note:
+000027a0: 3a0a 2f2f 2f0a 2f2f 2f20 2020 2020 466f  :.///.///     Fo
+000027b0: 7220 6265 7474 6572 2070 6572 666f 726d  r better perform
+000027c0: 616e 6365 206f 6e20 6c61 7267 6520 6772  ance on large gr
+000027d0: 6170 6873 2c20 636f 6e73 6964 6572 2073  aphs, consider s
+000027e0: 6574 7469 6e67 2060 6964 5f6f 7264 6572  etting `id_order
+000027f0: 3d46 616c 7365 602e 0a2f 2f2f 0a2f 2f2f  =False`..///.///
+00002800: 203a 7061 7261 6d20 5079 4469 4772 6170   :param PyDiGrap
+00002810: 6820 6669 7273 743a 2054 6865 2066 6972  h first: The fir
+00002820: 7374 2067 7261 7068 2074 6f20 636f 6d70  st graph to comp
+00002830: 6172 650a 2f2f 2f20 3a70 6172 616d 2050  are./// :param P
+00002840: 7944 6947 7261 7068 2073 6563 6f6e 643a  yDiGraph second:
+00002850: 2054 6865 2073 6563 6f6e 6420 6772 6170   The second grap
+00002860: 6820 746f 2063 6f6d 7061 7265 0a2f 2f2f  h to compare.///
+00002870: 203a 7061 7261 6d20 6361 6c6c 6162 6c65   :param callable
+00002880: 206e 6f64 655f 6d61 7463 6865 723a 2041   node_matcher: A
+00002890: 2070 7974 686f 6e20 6361 6c6c 6162 6c65   python callable
+000028a0: 206f 626a 6563 7420 7468 6174 2074 616b   object that tak
+000028b0: 6573 2032 2070 6f73 6974 696f 6e61 6c0a  es 2 positional.
+000028c0: 2f2f 2f20 2020 2020 6f6e 6520 666f 7220  ///     one for 
+000028d0: 6561 6368 206e 6f64 6520 6461 7461 206f  each node data o
+000028e0: 626a 6563 742e 2049 6620 7468 6520 7265  bject. If the re
+000028f0: 7475 726e 206f 6620 7468 6973 0a2f 2f2f  turn of this.///
+00002900: 2020 2020 2066 756e 6374 696f 6e20 6576       function ev
+00002910: 616c 7561 7465 7320 746f 2054 7275 6520  aluates to True 
+00002920: 7468 656e 2074 6865 206e 6f64 6573 2070  then the nodes p
+00002930: 6173 7365 6420 746f 2069 7420 6172 6520  assed to it are 
+00002940: 7669 6564 6564 0a2f 2f2f 2020 2020 2061  vieded.///     a
+00002950: 7320 6d61 7463 6869 6e67 2e0a 2f2f 2f20  s matching../// 
+00002960: 3a70 6172 616d 2063 616c 6c61 626c 6520  :param callable 
+00002970: 6564 6765 5f6d 6174 6368 6572 3a20 4120  edge_matcher: A 
+00002980: 7079 7468 6f6e 2063 616c 6c61 626c 6520  python callable 
+00002990: 6f62 6a65 6374 2074 6861 7420 7461 6b65  object that take
+000029a0: 7320 3220 706f 7369 7469 6f6e 616c 0a2f  s 2 positional./
+000029b0: 2f2f 2020 2020 206f 6e65 2066 6f72 2065  //     one for e
+000029c0: 6163 6820 6564 6765 2064 6174 6120 6f62  ach edge data ob
+000029d0: 6a65 6374 2e20 4966 2074 6865 2072 6574  ject. If the ret
+000029e0: 7572 6e20 6f66 2074 6869 730a 2f2f 2f20  urn of this./// 
+000029f0: 2020 2020 6675 6e63 7469 6f6e 2065 7661      function eva
+00002a00: 6c75 6174 6573 2074 6f20 5472 7565 2074  luates to True t
+00002a10: 6865 6e20 7468 6520 6564 6765 7320 7061  hen the edges pa
+00002a20: 7373 6564 2074 6f20 6974 2061 7265 2076  ssed to it are v
+00002a30: 6965 6465 640a 2f2f 2f20 2020 2020 6173  ieded.///     as
+00002a40: 206d 6174 6368 696e 672e 0a2f 2f2f 203a   matching../// :
+00002a50: 7061 7261 6d20 626f 6f6c 2069 645f 6f72  param bool id_or
+00002a60: 6465 723a 2049 6620 7365 7420 746f 2060  der: If set to `
+00002a70: 6046 616c 7365 6060 2074 6869 7320 6675  `False`` this fu
+00002a80: 6e63 7469 6f6e 2077 696c 6c20 7573 6520  nction will use 
+00002a90: 610a 2f2f 2f20 2020 2020 6865 7572 6973  a.///     heuris
+00002aa0: 7469 6320 6d61 7463 6869 6e67 206f 7264  tic matching ord
+00002ab0: 6572 2062 6173 6564 206f 6e20 5b56 4632  er based on [VF2
+00002ac0: 5d5f 2070 6170 6572 2e20 4f74 6865 7277  ]_ paper. Otherw
+00002ad0: 6973 6520 6974 2077 696c 6c0a 2f2f 2f20  ise it will./// 
+00002ae0: 2020 2020 6465 6661 756c 7420 746f 206d      default to m
+00002af0: 6174 6368 696e 6720 7468 6520 6e6f 6465  atching the node
+00002b00: 7320 696e 206f 7264 6572 2073 7065 6369  s in order speci
+00002b10: 6669 6564 2062 7920 7468 6569 7220 6964  fied by their id
+00002b20: 732e 0a2f 2f2f 0a2f 2f2f 203a 7265 7475  s..///./// :retu
+00002b30: 726e 733a 2060 6054 7275 6560 6020 6966  rns: ``True`` if
+00002b40: 2074 6865 2032 2067 7261 7068 7320 6172   the 2 graphs ar
+00002b50: 6520 6973 6f6d 6f72 7068 6963 2060 6046  e isomorphic ``F
+00002b60: 616c 7365 6060 2069 6620 7468 6579 2061  alse`` if they a
+00002b70: 7265 0a2f 2f2f 2020 2020 206e 6f74 2e0a  re.///     not..
+00002b80: 2f2f 2f20 3a72 7479 7065 3a20 626f 6f6c  /// :rtype: bool
+00002b90: 0a23 5b70 7966 756e 6374 696f 6e28 6964  .#[pyfunction(id
+00002ba0: 5f6f 7264 6572 203d 2022 7472 7565 2229  _order = "true")
+00002bb0: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+00002bc0: 7265 203d 2022 2866 6972 7374 2c20 7365  re = "(first, se
+00002bd0: 636f 6e64 2c20 6e6f 6465 5f6d 6174 6368  cond, node_match
+00002be0: 6572 3d4e 6f6e 652c 2065 6467 655f 6d61  er=None, edge_ma
+00002bf0: 7463 6865 723d 4e6f 6e65 2c20 6964 5f6f  tcher=None, id_o
+00002c00: 7264 6572 3d54 7275 652c 202f 2922 5d0a  rder=True, /)"].
+00002c10: 666e 2064 6967 7261 7068 5f69 735f 6973  fn digraph_is_is
+00002c20: 6f6d 6f72 7068 6963 280a 2020 2020 7079  omorphic(.    py
+00002c30: 3a20 5079 7468 6f6e 2c0a 2020 2020 6669  : Python,.    fi
+00002c40: 7273 743a 2026 6469 6772 6170 683a 3a50  rst: &digraph::P
+00002c50: 7944 6947 7261 7068 2c0a 2020 2020 7365  yDiGraph,.    se
+00002c60: 636f 6e64 3a20 2664 6967 7261 7068 3a3a  cond: &digraph::
+00002c70: 5079 4469 4772 6170 682c 0a20 2020 206e  PyDiGraph,.    n
+00002c80: 6f64 655f 6d61 7463 6865 723a 204f 7074  ode_matcher: Opt
+00002c90: 696f 6e3c 5079 4f62 6a65 6374 3e2c 0a20  ion<PyObject>,. 
+00002ca0: 2020 2065 6467 655f 6d61 7463 6865 723a     edge_matcher:
+00002cb0: 204f 7074 696f 6e3c 5079 4f62 6a65 6374   Option<PyObject
+00002cc0: 3e2c 0a20 2020 2069 645f 6f72 6465 723a  >,.    id_order:
+00002cd0: 2062 6f6f 6c2c 0a29 202d 3e20 5079 5265   bool,.) -> PyRe
+00002ce0: 7375 6c74 3c62 6f6f 6c3e 207b 0a20 2020  sult<bool> {.   
+00002cf0: 206c 6574 2063 6f6d 7061 7265 5f6e 6f64   let compare_nod
+00002d00: 6573 203d 206e 6f64 655f 6d61 7463 6865  es = node_matche
+00002d10: 722e 6d61 7028 7c66 7c20 7b0a 2020 2020  r.map(|f| {.    
+00002d20: 2020 2020 6d6f 7665 207c 613a 2026 5079      move |a: &Py
+00002d30: 4f62 6a65 6374 2c20 623a 2026 5079 4f62  Object, b: &PyOb
+00002d40: 6a65 6374 7c20 2d3e 2050 7952 6573 756c  ject| -> PyResul
+00002d50: 743c 626f 6f6c 3e20 7b0a 2020 2020 2020  t<bool> {.      
+00002d60: 2020 2020 2020 6c65 7420 7265 7320 3d20        let res = 
+00002d70: 662e 6361 6c6c 3128 7079 2c20 2861 2c20  f.call1(py, (a, 
+00002d80: 6229 293f 3b0a 2020 2020 2020 2020 2020  b))?;.          
+00002d90: 2020 4f6b 2872 6573 2e69 735f 7472 7565    Ok(res.is_true
+00002da0: 2870 7929 2e75 6e77 7261 7028 2929 0a20  (py).unwrap()). 
+00002db0: 2020 2020 2020 207d 0a20 2020 207d 293b         }.    });
+00002dc0: 0a0a 2020 2020 6c65 7420 636f 6d70 6172  ..    let compar
+00002dd0: 655f 6564 6765 7320 3d20 6564 6765 5f6d  e_edges = edge_m
+00002de0: 6174 6368 6572 2e6d 6170 287c 667c 207b  atcher.map(|f| {
+00002df0: 0a20 2020 2020 2020 206d 6f76 6520 7c61  .        move |a
+00002e00: 3a20 2650 794f 626a 6563 742c 2062 3a20  : &PyObject, b: 
+00002e10: 2650 794f 626a 6563 747c 202d 3e20 5079  &PyObject| -> Py
+00002e20: 5265 7375 6c74 3c62 6f6f 6c3e 207b 0a20  Result<bool> {. 
+00002e30: 2020 2020 2020 2020 2020 206c 6574 2072             let r
+00002e40: 6573 203d 2066 2e63 616c 6c31 2870 792c  es = f.call1(py,
+00002e50: 2028 612c 2062 2929 3f3b 0a20 2020 2020   (a, b))?;.     
+00002e60: 2020 2020 2020 204f 6b28 7265 732e 6973         Ok(res.is
+00002e70: 5f74 7275 6528 7079 292e 756e 7772 6170  _true(py).unwrap
+00002e80: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
+00002e90: 2020 7d29 3b0a 0a20 2020 206c 6574 2072    });..    let r
+00002ea0: 6573 203d 2069 736f 6d6f 7270 6869 736d  es = isomorphism
+00002eb0: 3a3a 6973 5f69 736f 6d6f 7270 6869 6328  ::is_isomorphic(
+00002ec0: 0a20 2020 2020 2020 2070 792c 0a20 2020  .        py,.   
+00002ed0: 2020 2020 2026 6669 7273 742e 6772 6170       &first.grap
+00002ee0: 682c 0a20 2020 2020 2020 2026 7365 636f  h,.        &seco
+00002ef0: 6e64 2e67 7261 7068 2c0a 2020 2020 2020  nd.graph,.      
+00002f00: 2020 636f 6d70 6172 655f 6e6f 6465 732c    compare_nodes,
+00002f10: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00002f20: 5f65 6467 6573 2c0a 2020 2020 2020 2020  _edges,.        
+00002f30: 6964 5f6f 7264 6572 2c0a 2020 2020 2020  id_order,.      
+00002f40: 2020 4f72 6465 7269 6e67 3a3a 4571 7561    Ordering::Equa
+00002f50: 6c2c 0a20 2020 2029 3f3b 0a20 2020 204f  l,.    )?;.    O
+00002f60: 6b28 7265 7329 0a7d 0a0a 2f2f 2f20 4465  k(res).}../// De
+00002f70: 7465 726d 696e 6520 6966 2032 2075 6e64  termine if 2 und
+00002f80: 6972 6563 7465 6420 6772 6170 6873 2061  irected graphs a
+00002f90: 7265 2069 736f 6d6f 7270 6869 630a 2f2f  re isomorphic.//
+00002fa0: 2f0a 2f2f 2f20 5468 6973 2063 6865 636b  /./// This check
+00002fb0: 7320 6966 2032 2067 7261 7068 7320 6172  s if 2 graphs ar
+00002fc0: 6520 6973 6f6d 6f72 7068 6963 2062 6f74  e isomorphic bot
+00002fd0: 6820 7374 7275 6374 7572 616c 6c79 2061  h structurally a
+00002fe0: 6e64 2061 6c73 6f0a 2f2f 2f20 636f 6d70  nd also./// comp
+00002ff0: 6172 696e 6720 7468 6520 6e6f 6465 2064  aring the node d
+00003000: 6174 6120 616e 6420 6564 6765 2064 6174  ata and edge dat
+00003010: 6120 7573 696e 6720 7468 6520 7072 6f76  a using the prov
+00003020: 6964 6564 206d 6174 6368 6572 2066 756e  ided matcher fun
+00003030: 6374 696f 6e73 2e0a 2f2f 2f20 5468 6520  ctions../// The 
+00003040: 6d61 7463 6865 7220 6675 6e63 7469 6f6e  matcher function
+00003050: 2074 616b 6573 2069 6e20 3220 6461 7461   takes in 2 data
+00003060: 206f 626a 6563 7473 2061 6e64 2077 696c   objects and wil
+00003070: 6c20 636f 6d70 6172 6520 7468 656d 2e20  l compare them. 
+00003080: 4120 7369 6d70 6c65 0a2f 2f2f 2065 7861  A simple./// exa
+00003090: 6d70 6c65 2074 6861 7420 6368 6563 6b73  mple that checks
+000030a0: 2069 6620 7468 6579 2772 6520 6a75 7374   if they're just
+000030b0: 2065 7175 616c 2077 6f75 6c64 2062 653a   equal would be:
+000030c0: 3a0a 2f2f 2f0a 2f2f 2f20 2020 2020 6772  :.///.///     gr
+000030d0: 6170 685f 6120 3d20 7265 7477 6f72 6b78  aph_a = retworkx
+000030e0: 2e50 7947 7261 7068 2829 0a2f 2f2f 2020  .PyGraph().///  
+000030f0: 2020 2067 7261 7068 5f62 203d 2072 6574     graph_b = ret
+00003100: 776f 726b 782e 5079 4772 6170 6828 290a  workx.PyGraph().
+00003110: 2f2f 2f20 2020 2020 7265 7477 6f72 6b78  ///     retworkx
+00003120: 2e69 735f 6973 6f6d 6f72 7068 6963 2867  .is_isomorphic(g
+00003130: 7261 7068 5f61 2c20 6772 6170 685f 622c  raph_a, graph_b,
+00003140: 0a2f 2f2f 2020 2020 2020 2020 2020 2020  .///            
+00003150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003160: 6c61 6d62 6461 2078 2c20 793a 2078 203d  lambda x, y: x =
+00003170: 3d20 7929 0a2f 2f2f 0a2f 2f2f 202e 2e20  = y).///./// .. 
+00003180: 6e6f 7465 3a3a 0a2f 2f2f 0a2f 2f2f 2020  note::.///.///  
+00003190: 2020 2046 6f72 2062 6574 7465 7220 7065     For better pe
+000031a0: 7266 6f72 6d61 6e63 6520 6f6e 206c 6172  rformance on lar
+000031b0: 6765 2067 7261 7068 732c 2063 6f6e 7369  ge graphs, consi
+000031c0: 6465 7220 7365 7474 696e 6720 6069 645f  der setting `id_
+000031d0: 6f72 6465 723d 4661 6c73 6560 2e0a 2f2f  order=False`..//
+000031e0: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7947  /./// :param PyG
+000031f0: 7261 7068 2066 6972 7374 3a20 5468 6520  raph first: The 
+00003200: 6669 7273 7420 6772 6170 6820 746f 2063  first graph to c
+00003210: 6f6d 7061 7265 0a2f 2f2f 203a 7061 7261  ompare./// :para
+00003220: 6d20 5079 4772 6170 6820 7365 636f 6e64  m PyGraph second
+00003230: 3a20 5468 6520 7365 636f 6e64 2067 7261  : The second gra
+00003240: 7068 2074 6f20 636f 6d70 6172 650a 2f2f  ph to compare.//
+00003250: 2f20 3a70 6172 616d 2063 616c 6c61 626c  / :param callabl
+00003260: 6520 6e6f 6465 5f6d 6174 6368 6572 3a20  e node_matcher: 
+00003270: 4120 7079 7468 6f6e 2063 616c 6c61 626c  A python callabl
+00003280: 6520 6f62 6a65 6374 2074 6861 7420 7461  e object that ta
+00003290: 6b65 7320 3220 706f 7369 7469 6f6e 616c  kes 2 positional
+000032a0: 0a2f 2f2f 2020 2020 206f 6e65 2066 6f72  .///     one for
+000032b0: 2065 6163 6820 6e6f 6465 2064 6174 6120   each node data 
+000032c0: 6f62 6a65 6374 2e20 4966 2074 6865 2072  object. If the r
+000032d0: 6574 7572 6e20 6f66 2074 6869 730a 2f2f  eturn of this.//
+000032e0: 2f20 2020 2020 6675 6e63 7469 6f6e 2065  /     function e
+000032f0: 7661 6c75 6174 6573 2074 6f20 5472 7565  valuates to True
+00003300: 2074 6865 6e20 7468 6520 6e6f 6465 7320   then the nodes 
+00003310: 7061 7373 6564 2074 6f20 6974 2061 7265  passed to it are
+00003320: 2076 6965 6465 640a 2f2f 2f20 2020 2020   vieded.///     
+00003330: 6173 206d 6174 6368 696e 672e 0a2f 2f2f  as matching..///
+00003340: 203a 7061 7261 6d20 6361 6c6c 6162 6c65   :param callable
+00003350: 2065 6467 655f 6d61 7463 6865 723a 2041   edge_matcher: A
+00003360: 2070 7974 686f 6e20 6361 6c6c 6162 6c65   python callable
+00003370: 206f 626a 6563 7420 7468 6174 2074 616b   object that tak
+00003380: 6573 2032 2070 6f73 6974 696f 6e61 6c0a  es 2 positional.
+00003390: 2f2f 2f20 2020 2020 6f6e 6520 666f 7220  ///     one for 
+000033a0: 6561 6368 2065 6467 6520 6461 7461 206f  each edge data o
+000033b0: 626a 6563 742e 2049 6620 7468 6520 7265  bject. If the re
+000033c0: 7475 726e 206f 6620 7468 6973 0a2f 2f2f  turn of this.///
+000033d0: 2020 2020 2066 756e 6374 696f 6e20 6576       function ev
+000033e0: 616c 7561 7465 7320 746f 2054 7275 6520  aluates to True 
+000033f0: 7468 656e 2074 6865 2065 6467 6573 2070  then the edges p
+00003400: 6173 7365 6420 746f 2069 7420 6172 6520  assed to it are 
+00003410: 7669 6564 6564 0a2f 2f2f 2020 2020 2061  vieded.///     a
+00003420: 7320 6d61 7463 6869 6e67 2e0a 2f2f 2f20  s matching../// 
+00003430: 3a70 6172 616d 2062 6f6f 6c20 2864 6566  :param bool (def
+00003440: 6175 6c74 3d54 7275 6529 2069 645f 6f72  ault=True) id_or
+00003450: 6465 723a 2020 4966 2073 6574 2074 6f20  der:  If set to 
+00003460: 7472 7565 2c20 7468 6520 616c 676f 7269  true, the algori
+00003470: 7468 6d20 6d61 7463 6865 7320 7468 650a  thm matches the.
+00003480: 2f2f 2f20 2020 2020 6e6f 6465 7320 696e  ///     nodes in
+00003490: 206f 7264 6572 2073 7065 6369 6669 6564   order specified
+000034a0: 2062 7920 7468 6569 7220 6964 732e 204f   by their ids. O
+000034b0: 7468 6572 7769 7365 2c20 6974 2075 7365  therwise, it use
+000034c0: 7320 6120 6865 7572 6973 7469 630a 2f2f  s a heuristic.//
+000034d0: 2f20 2020 2020 6d61 7463 6869 6e67 206f  /     matching o
+000034e0: 7264 6572 2062 6173 6564 2069 6e20 5b56  rder based in [V
+000034f0: 4632 5d5f 2070 6170 6572 2e0a 2f2f 2f0a  F2]_ paper..///.
+00003500: 2f2f 2f20 3a72 6574 7572 6e73 3a20 6060  /// :returns: ``
+00003510: 5472 7565 6060 2069 6620 7468 6520 3220  True`` if the 2 
+00003520: 6772 6170 6873 2061 7265 2069 736f 6d6f  graphs are isomo
+00003530: 7270 6869 6320 6060 4661 6c73 6560 6020  rphic ``False`` 
+00003540: 6966 2074 6865 7920 6172 650a 2f2f 2f20  if they are./// 
+00003550: 2020 2020 6e6f 742e 0a2f 2f2f 203a 7274      not../// :rt
+00003560: 7970 653a 2062 6f6f 6c0a 235b 7079 6675  ype: bool.#[pyfu
+00003570: 6e63 7469 6f6e 2869 645f 6f72 6465 7220  nction(id_order 
+00003580: 3d20 2274 7275 6522 295d 0a23 5b74 6578  = "true")].#[tex
+00003590: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+000035a0: 6669 7273 742c 2073 6563 6f6e 642c 206e  first, second, n
+000035b0: 6f64 655f 6d61 7463 6865 723d 4e6f 6e65  ode_matcher=None
+000035c0: 2c20 6564 6765 5f6d 6174 6368 6572 3d4e  , edge_matcher=N
+000035d0: 6f6e 652c 2069 645f 6f72 6465 723d 5472  one, id_order=Tr
+000035e0: 7565 2c20 2f29 225d 0a66 6e20 6772 6170  ue, /)"].fn grap
+000035f0: 685f 6973 5f69 736f 6d6f 7270 6869 6328  h_is_isomorphic(
+00003600: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
+00003610: 0a20 2020 2066 6972 7374 3a20 2667 7261  .    first: &gra
+00003620: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
+00003630: 2073 6563 6f6e 643a 2026 6772 6170 683a   second: &graph:
+00003640: 3a50 7947 7261 7068 2c0a 2020 2020 6e6f  :PyGraph,.    no
+00003650: 6465 5f6d 6174 6368 6572 3a20 4f70 7469  de_matcher: Opti
+00003660: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
+00003670: 2020 6564 6765 5f6d 6174 6368 6572 3a20    edge_matcher: 
+00003680: 4f70 7469 6f6e 3c50 794f 626a 6563 743e  Option<PyObject>
+00003690: 2c0a 2020 2020 6964 5f6f 7264 6572 3a20  ,.    id_order: 
+000036a0: 626f 6f6c 2c0a 2920 2d3e 2050 7952 6573  bool,.) -> PyRes
+000036b0: 756c 743c 626f 6f6c 3e20 7b0a 2020 2020  ult<bool> {.    
+000036c0: 6c65 7420 636f 6d70 6172 655f 6e6f 6465  let compare_node
+000036d0: 7320 3d20 6e6f 6465 5f6d 6174 6368 6572  s = node_matcher
+000036e0: 2e6d 6170 287c 667c 207b 0a20 2020 2020  .map(|f| {.     
+000036f0: 2020 206d 6f76 6520 7c61 3a20 2650 794f     move |a: &PyO
+00003700: 626a 6563 742c 2062 3a20 2650 794f 626a  bject, b: &PyObj
+00003710: 6563 747c 202d 3e20 5079 5265 7375 6c74  ect| -> PyResult
+00003720: 3c62 6f6f 6c3e 207b 0a20 2020 2020 2020  <bool> {.       
+00003730: 2020 2020 206c 6574 2072 6573 203d 2066       let res = f
+00003740: 2e63 616c 6c31 2870 792c 2028 612c 2062  .call1(py, (a, b
+00003750: 2929 3f3b 0a20 2020 2020 2020 2020 2020  ))?;.           
+00003760: 204f 6b28 7265 732e 6973 5f74 7275 6528   Ok(res.is_true(
+00003770: 7079 292e 756e 7772 6170 2829 290a 2020  py).unwrap()).  
+00003780: 2020 2020 2020 7d0a 2020 2020 7d29 3b0a        }.    });.
+00003790: 0a20 2020 206c 6574 2063 6f6d 7061 7265  .    let compare
+000037a0: 5f65 6467 6573 203d 2065 6467 655f 6d61  _edges = edge_ma
+000037b0: 7463 6865 722e 6d61 7028 7c66 7c20 7b0a  tcher.map(|f| {.
+000037c0: 2020 2020 2020 2020 6d6f 7665 207c 613a          move |a:
+000037d0: 2026 5079 4f62 6a65 6374 2c20 623a 2026   &PyObject, b: &
+000037e0: 5079 4f62 6a65 6374 7c20 2d3e 2050 7952  PyObject| -> PyR
+000037f0: 6573 756c 743c 626f 6f6c 3e20 7b0a 2020  esult<bool> {.  
+00003800: 2020 2020 2020 2020 2020 6c65 7420 7265            let re
+00003810: 7320 3d20 662e 6361 6c6c 3128 7079 2c20  s = f.call1(py, 
+00003820: 2861 2c20 6229 293f 3b0a 2020 2020 2020  (a, b))?;.      
+00003830: 2020 2020 2020 4f6b 2872 6573 2e69 735f        Ok(res.is_
+00003840: 7472 7565 2870 7929 2e75 6e77 7261 7028  true(py).unwrap(
+00003850: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
+00003860: 207d 293b 0a0a 2020 2020 6c65 7420 7265   });..    let re
+00003870: 7320 3d20 6973 6f6d 6f72 7068 6973 6d3a  s = isomorphism:
+00003880: 3a69 735f 6973 6f6d 6f72 7068 6963 280a  :is_isomorphic(.
+00003890: 2020 2020 2020 2020 7079 2c0a 2020 2020          py,.    
+000038a0: 2020 2020 2666 6972 7374 2e67 7261 7068      &first.graph
+000038b0: 2c0a 2020 2020 2020 2020 2673 6563 6f6e  ,.        &secon
+000038c0: 642e 6772 6170 682c 0a20 2020 2020 2020  d.graph,.       
+000038d0: 2063 6f6d 7061 7265 5f6e 6f64 6573 2c0a   compare_nodes,.
+000038e0: 2020 2020 2020 2020 636f 6d70 6172 655f          compare_
+000038f0: 6564 6765 732c 0a20 2020 2020 2020 2069  edges,.        i
+00003900: 645f 6f72 6465 722c 0a20 2020 2020 2020  d_order,.       
+00003910: 204f 7264 6572 696e 673a 3a45 7175 616c   Ordering::Equal
+00003920: 2c0a 2020 2020 293f 3b0a 2020 2020 4f6b  ,.    )?;.    Ok
+00003930: 2872 6573 290a 7d0a 0a2f 2f2f 2044 6574  (res).}../// Det
+00003940: 6572 6d69 6e65 2069 6620 3220 6469 7265  ermine if 2 dire
+00003950: 6374 6564 2067 7261 7068 7320 6172 6520  cted graphs are 
+00003960: 7375 6267 7261 7068 202d 2069 736f 6d6f  subgraph - isomo
+00003970: 7270 6869 630a 2f2f 2f0a 2f2f 2f20 5468  rphic.///./// Th
+00003980: 6973 2063 6865 636b 7320 6966 2032 2067  is checks if 2 g
+00003990: 7261 7068 7320 6172 6520 7375 6267 7261  raphs are subgra
+000039a0: 7068 2069 736f 6d6f 7270 6869 6320 626f  ph isomorphic bo
+000039b0: 7468 2073 7472 7563 7475 7261 6c6c 7920  th structurally 
+000039c0: 616e 6420 616c 736f 0a2f 2f2f 2063 6f6d  and also./// com
+000039d0: 7061 7269 6e67 2074 6865 206e 6f64 6520  paring the node 
+000039e0: 6461 7461 2061 6e64 2065 6467 6520 6461  data and edge da
+000039f0: 7461 2075 7369 6e67 2074 6865 2070 726f  ta using the pro
+00003a00: 7669 6465 6420 6d61 7463 6865 7220 6675  vided matcher fu
+00003a10: 6e63 7469 6f6e 732e 0a2f 2f2f 2054 6865  nctions../// The
+00003a20: 206d 6174 6368 6572 2066 756e 6374 696f   matcher functio
+00003a30: 6e20 7461 6b65 7320 696e 2032 2064 6174  n takes in 2 dat
+00003a40: 6120 6f62 6a65 6374 7320 616e 6420 7769  a objects and wi
+00003a50: 6c6c 2063 6f6d 7061 7265 2074 6865 6d2e  ll compare them.
+00003a60: 2041 2073 696d 706c 650a 2f2f 2f20 6578   A simple./// ex
+00003a70: 616d 706c 6520 7468 6174 2063 6865 636b  ample that check
+00003a80: 7320 6966 2074 6865 7927 7265 206a 7573  s if they're jus
+00003a90: 7420 6571 7561 6c20 776f 756c 6420 6265  t equal would be
+00003aa0: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2067  ::.///.///     g
+00003ab0: 7261 7068 5f61 203d 2072 6574 776f 726b  raph_a = retwork
+00003ac0: 782e 5079 4469 4772 6170 6828 290a 2f2f  x.PyDiGraph().//
+00003ad0: 2f20 2020 2020 6772 6170 685f 6220 3d20  /     graph_b = 
+00003ae0: 7265 7477 6f72 6b78 2e50 7944 6947 7261  retworkx.PyDiGra
+00003af0: 7068 2829 0a2f 2f2f 2020 2020 2072 6574  ph().///     ret
+00003b00: 776f 726b 782e 6973 5f73 7562 6772 6170  workx.is_subgrap
+00003b10: 685f 6973 6f6d 6f72 7068 6963 2867 7261  h_isomorphic(gra
+00003b20: 7068 5f61 2c20 6772 6170 685f 622c 0a2f  ph_a, graph_b,./
+00003b30: 2f2f 2020 2020 2020 2020 2020 2020 2020  //              
+00003b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b50: 2020 2020 2020 206c 616d 6264 6120 782c         lambda x,
+00003b60: 2079 3a20 7820 3d3d 2079 290a 2f2f 2f0a   y: x == y).///.
+00003b70: 2f2f 2f20 2e2e 206e 6f74 653a 3a0a 2f2f  /// .. note::.//
+00003b80: 2f0a 2f2f 2f20 2020 2020 466f 7220 6265  /.///     For be
+00003b90: 7474 6572 2070 6572 666f 726d 616e 6365  tter performance
+00003ba0: 206f 6e20 6c61 7267 6520 6772 6170 6873   on large graphs
+00003bb0: 2c20 636f 6e73 6964 6572 2073 6574 7469  , consider setti
+00003bc0: 6e67 2060 6964 5f6f 7264 6572 3d46 616c  ng `id_order=Fal
+00003bd0: 7365 602e 0a2f 2f2f 0a2f 2f2f 203a 7061  se`..///./// :pa
+00003be0: 7261 6d20 5079 4469 4772 6170 6820 6669  ram PyDiGraph fi
+00003bf0: 7273 743a 2054 6865 2066 6972 7374 2067  rst: The first g
+00003c00: 7261 7068 2074 6f20 636f 6d70 6172 650a  raph to compare.
+00003c10: 2f2f 2f20 3a70 6172 616d 2050 7944 6947  /// :param PyDiG
+00003c20: 7261 7068 2073 6563 6f6e 643a 2054 6865  raph second: The
+00003c30: 2073 6563 6f6e 6420 6772 6170 6820 746f   second graph to
+00003c40: 2063 6f6d 7061 7265 0a2f 2f2f 203a 7061   compare./// :pa
+00003c50: 7261 6d20 6361 6c6c 6162 6c65 206e 6f64  ram callable nod
+00003c60: 655f 6d61 7463 6865 723a 2041 2070 7974  e_matcher: A pyt
+00003c70: 686f 6e20 6361 6c6c 6162 6c65 206f 626a  hon callable obj
+00003c80: 6563 7420 7468 6174 2074 616b 6573 2032  ect that takes 2
+00003c90: 2070 6f73 6974 696f 6e61 6c0a 2f2f 2f20   positional./// 
+00003ca0: 2020 2020 6f6e 6520 666f 7220 6561 6368      one for each
+00003cb0: 206e 6f64 6520 6461 7461 206f 626a 6563   node data objec
+00003cc0: 742e 2049 6620 7468 6520 7265 7475 726e  t. If the return
+00003cd0: 206f 6620 7468 6973 0a2f 2f2f 2020 2020   of this.///    
+00003ce0: 2066 756e 6374 696f 6e20 6576 616c 7561   function evalua
+00003cf0: 7465 7320 746f 2054 7275 6520 7468 656e  tes to True then
+00003d00: 2074 6865 206e 6f64 6573 2070 6173 7365   the nodes passe
+00003d10: 6420 746f 2069 7420 6172 6520 7669 6564  d to it are vied
+00003d20: 6564 0a2f 2f2f 2020 2020 2061 7320 6d61  ed.///     as ma
+00003d30: 7463 6869 6e67 2e0a 2f2f 2f20 3a70 6172  tching../// :par
+00003d40: 616d 2063 616c 6c61 626c 6520 6564 6765  am callable edge
+00003d50: 5f6d 6174 6368 6572 3a20 4120 7079 7468  _matcher: A pyth
+00003d60: 6f6e 2063 616c 6c61 626c 6520 6f62 6a65  on callable obje
+00003d70: 6374 2074 6861 7420 7461 6b65 7320 3220  ct that takes 2 
+00003d80: 706f 7369 7469 6f6e 616c 0a2f 2f2f 2020  positional.///  
+00003d90: 2020 206f 6e65 2066 6f72 2065 6163 6820     one for each 
+00003da0: 6564 6765 2064 6174 6120 6f62 6a65 6374  edge data object
+00003db0: 2e20 4966 2074 6865 2072 6574 7572 6e20  . If the return 
+00003dc0: 6f66 2074 6869 730a 2f2f 2f20 2020 2020  of this.///     
+00003dd0: 6675 6e63 7469 6f6e 2065 7661 6c75 6174  function evaluat
+00003de0: 6573 2074 6f20 5472 7565 2074 6865 6e20  es to True then 
+00003df0: 7468 6520 6564 6765 7320 7061 7373 6564  the edges passed
+00003e00: 2074 6f20 6974 2061 7265 2076 6965 6465   to it are viede
+00003e10: 640a 2f2f 2f20 2020 2020 6173 206d 6174  d.///     as mat
+00003e20: 6368 696e 672e 0a2f 2f2f 203a 7061 7261  ching../// :para
+00003e30: 6d20 626f 6f6c 2069 645f 6f72 6465 723a  m bool id_order:
+00003e40: 2049 6620 7365 7420 746f 2060 6054 7275   If set to ``Tru
+00003e50: 6560 6020 7468 6973 2066 756e 6374 696f  e`` this functio
+00003e60: 6e20 7769 6c6c 206d 6174 6368 2074 6865  n will match the
+00003e70: 206e 6f64 6573 0a2f 2f2f 2020 2020 2069   nodes.///     i
+00003e80: 6e20 6f72 6465 7220 7370 6563 6966 6965  n order specifie
+00003e90: 6420 6279 2074 6865 6972 2069 6473 2e20  d by their ids. 
+00003ea0: 4f74 6865 7277 6973 6520 6974 2077 696c  Otherwise it wil
+00003eb0: 6c20 6465 6661 756c 7420 746f 2061 2068  l default to a h
+00003ec0: 6575 7269 7374 6963 0a2f 2f2f 2020 2020  euristic.///    
+00003ed0: 206d 6174 6368 696e 6720 6f72 6465 7220   matching order 
+00003ee0: 6261 7365 6420 6f6e 205b 5646 325d 5f20  based on [VF2]_ 
+00003ef0: 7061 7065 722e 0a2f 2f2f 0a2f 2f2f 203a  paper..///./// :
+00003f00: 7265 7475 726e 733a 2060 6054 7275 6560  returns: ``True`
+00003f10: 6020 6966 2074 6865 7265 2069 7320 6120  ` if there is a 
+00003f20: 7375 6267 7261 7068 206f 6620 6066 6972  subgraph of `fir
+00003f30: 7374 6020 6973 6f6d 6f72 7068 6963 2074  st` isomorphic t
+00003f40: 6f20 6073 6563 6f6e 6460 2c0a 2f2f 2f20  o `second`,./// 
+00003f50: 2020 2020 6060 4661 6c73 6560 6020 6966      ``False`` if
+00003f60: 2074 6865 7265 2069 7320 6e6f 742e 0a2f   there is not../
+00003f70: 2f2f 203a 7274 7970 653a 2062 6f6f 6c0a  // :rtype: bool.
+00003f80: 235b 7079 6675 6e63 7469 6f6e 2869 645f  #[pyfunction(id_
+00003f90: 6f72 6465 7220 3d20 2266 616c 7365 2229  order = "false")
+00003fa0: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+00003fb0: 7265 203d 2022 2866 6972 7374 2c20 7365  re = "(first, se
+00003fc0: 636f 6e64 2c20 6e6f 6465 5f6d 6174 6368  cond, node_match
+00003fd0: 6572 3d4e 6f6e 652c 2065 6467 655f 6d61  er=None, edge_ma
+00003fe0: 7463 6865 723d 4e6f 6e65 2c20 6964 5f6f  tcher=None, id_o
+00003ff0: 7264 6572 3d46 616c 7365 2c20 2f29 225d  rder=False, /)"]
+00004000: 0a66 6e20 6469 6772 6170 685f 6973 5f73  .fn digraph_is_s
+00004010: 7562 6772 6170 685f 6973 6f6d 6f72 7068  ubgraph_isomorph
+00004020: 6963 280a 2020 2020 7079 3a20 5079 7468  ic(.    py: Pyth
+00004030: 6f6e 2c0a 2020 2020 6669 7273 743a 2026  on,.    first: &
+00004040: 6469 6772 6170 683a 3a50 7944 6947 7261  digraph::PyDiGra
+00004050: 7068 2c0a 2020 2020 7365 636f 6e64 3a20  ph,.    second: 
+00004060: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
+00004070: 6170 682c 0a20 2020 206e 6f64 655f 6d61  aph,.    node_ma
+00004080: 7463 6865 723a 204f 7074 696f 6e3c 5079  tcher: Option<Py
+00004090: 4f62 6a65 6374 3e2c 0a20 2020 2065 6467  Object>,.    edg
+000040a0: 655f 6d61 7463 6865 723a 204f 7074 696f  e_matcher: Optio
+000040b0: 6e3c 5079 4f62 6a65 6374 3e2c 0a20 2020  n<PyObject>,.   
+000040c0: 2069 645f 6f72 6465 723a 2062 6f6f 6c2c   id_order: bool,
+000040d0: 0a29 202d 3e20 5079 5265 7375 6c74 3c62  .) -> PyResult<b
+000040e0: 6f6f 6c3e 207b 0a20 2020 206c 6574 2063  ool> {.    let c
+000040f0: 6f6d 7061 7265 5f6e 6f64 6573 203d 206e  ompare_nodes = n
+00004100: 6f64 655f 6d61 7463 6865 722e 6d61 7028  ode_matcher.map(
+00004110: 7c66 7c20 7b0a 2020 2020 2020 2020 6d6f  |f| {.        mo
+00004120: 7665 207c 613a 2026 5079 4f62 6a65 6374  ve |a: &PyObject
+00004130: 2c20 623a 2026 5079 4f62 6a65 6374 7c20  , b: &PyObject| 
+00004140: 2d3e 2050 7952 6573 756c 743c 626f 6f6c  -> PyResult<bool
+00004150: 3e20 7b0a 2020 2020 2020 2020 2020 2020  > {.            
+00004160: 6c65 7420 7265 7320 3d20 662e 6361 6c6c  let res = f.call
+00004170: 3128 7079 2c20 2861 2c20 6229 293f 3b0a  1(py, (a, b))?;.
+00004180: 2020 2020 2020 2020 2020 2020 4f6b 2872              Ok(r
+00004190: 6573 2e69 735f 7472 7565 2870 7929 2e75  es.is_true(py).u
+000041a0: 6e77 7261 7028 2929 0a20 2020 2020 2020  nwrap()).       
+000041b0: 207d 0a20 2020 207d 293b 0a0a 2020 2020   }.    });..    
+000041c0: 6c65 7420 636f 6d70 6172 655f 6564 6765  let compare_edge
+000041d0: 7320 3d20 6564 6765 5f6d 6174 6368 6572  s = edge_matcher
+000041e0: 2e6d 6170 287c 667c 207b 0a20 2020 2020  .map(|f| {.     
+000041f0: 2020 206d 6f76 6520 7c61 3a20 2650 794f     move |a: &PyO
+00004200: 626a 6563 742c 2062 3a20 2650 794f 626a  bject, b: &PyObj
+00004210: 6563 747c 202d 3e20 5079 5265 7375 6c74  ect| -> PyResult
+00004220: 3c62 6f6f 6c3e 207b 0a20 2020 2020 2020  <bool> {.       
+00004230: 2020 2020 206c 6574 2072 6573 203d 2066       let res = f
+00004240: 2e63 616c 6c31 2870 792c 2028 612c 2062  .call1(py, (a, b
+00004250: 2929 3f3b 0a20 2020 2020 2020 2020 2020  ))?;.           
+00004260: 204f 6b28 7265 732e 6973 5f74 7275 6528   Ok(res.is_true(
+00004270: 7079 292e 756e 7772 6170 2829 290a 2020  py).unwrap()).  
+00004280: 2020 2020 2020 7d0a 2020 2020 7d29 3b0a        }.    });.
+00004290: 0a20 2020 206c 6574 2072 6573 203d 2069  .    let res = i
+000042a0: 736f 6d6f 7270 6869 736d 3a3a 6973 5f69  somorphism::is_i
+000042b0: 736f 6d6f 7270 6869 6328 0a20 2020 2020  somorphic(.     
+000042c0: 2020 2070 792c 0a20 2020 2020 2020 2026     py,.        &
+000042d0: 6669 7273 742e 6772 6170 682c 0a20 2020  first.graph,.   
+000042e0: 2020 2020 2026 7365 636f 6e64 2e67 7261       &second.gra
+000042f0: 7068 2c0a 2020 2020 2020 2020 636f 6d70  ph,.        comp
+00004300: 6172 655f 6e6f 6465 732c 0a20 2020 2020  are_nodes,.     
+00004310: 2020 2063 6f6d 7061 7265 5f65 6467 6573     compare_edges
+00004320: 2c0a 2020 2020 2020 2020 6964 5f6f 7264  ,.        id_ord
+00004330: 6572 2c0a 2020 2020 2020 2020 4f72 6465  er,.        Orde
+00004340: 7269 6e67 3a3a 4772 6561 7465 722c 0a20  ring::Greater,. 
+00004350: 2020 2029 3f3b 0a20 2020 204f 6b28 7265     )?;.    Ok(re
+00004360: 7329 0a7d 0a0a 2f2f 2f20 4465 7465 726d  s).}../// Determ
+00004370: 696e 6520 6966 2032 2075 6e64 6972 6563  ine if 2 undirec
+00004380: 7465 6420 6772 6170 6873 2061 7265 2073  ted graphs are s
+00004390: 7562 6772 6170 6820 2d20 6973 6f6d 6f72  ubgraph - isomor
+000043a0: 7068 6963 0a2f 2f2f 0a2f 2f2f 2054 6869  phic.///./// Thi
+000043b0: 7320 6368 6563 6b73 2069 6620 3220 6772  s checks if 2 gr
+000043c0: 6170 6873 2061 7265 2073 7562 6772 6170  aphs are subgrap
+000043d0: 6820 6973 6f6d 6f72 7068 6963 2062 6f74  h isomorphic bot
+000043e0: 6820 7374 7275 6374 7572 616c 6c79 2061  h structurally a
+000043f0: 6e64 2061 6c73 6f0a 2f2f 2f20 636f 6d70  nd also./// comp
+00004400: 6172 696e 6720 7468 6520 6e6f 6465 2064  aring the node d
+00004410: 6174 6120 616e 6420 6564 6765 2064 6174  ata and edge dat
+00004420: 6120 7573 696e 6720 7468 6520 7072 6f76  a using the prov
+00004430: 6964 6564 206d 6174 6368 6572 2066 756e  ided matcher fun
+00004440: 6374 696f 6e73 2e0a 2f2f 2f20 5468 6520  ctions../// The 
+00004450: 6d61 7463 6865 7220 6675 6e63 7469 6f6e  matcher function
+00004460: 2074 616b 6573 2069 6e20 3220 6461 7461   takes in 2 data
+00004470: 206f 626a 6563 7473 2061 6e64 2077 696c   objects and wil
+00004480: 6c20 636f 6d70 6172 6520 7468 656d 2e20  l compare them. 
+00004490: 4120 7369 6d70 6c65 0a2f 2f2f 2065 7861  A simple./// exa
+000044a0: 6d70 6c65 2074 6861 7420 6368 6563 6b73  mple that checks
+000044b0: 2069 6620 7468 6579 2772 6520 6a75 7374   if they're just
+000044c0: 2065 7175 616c 2077 6f75 6c64 2062 653a   equal would be:
+000044d0: 3a0a 2f2f 2f0a 2f2f 2f20 2020 2020 6772  :.///.///     gr
+000044e0: 6170 685f 6120 3d20 7265 7477 6f72 6b78  aph_a = retworkx
+000044f0: 2e50 7947 7261 7068 2829 0a2f 2f2f 2020  .PyGraph().///  
+00004500: 2020 2067 7261 7068 5f62 203d 2072 6574     graph_b = ret
+00004510: 776f 726b 782e 5079 4772 6170 6828 290a  workx.PyGraph().
+00004520: 2f2f 2f20 2020 2020 7265 7477 6f72 6b78  ///     retworkx
+00004530: 2e69 735f 7375 6267 7261 7068 5f69 736f  .is_subgraph_iso
+00004540: 6d6f 7270 6869 6328 6772 6170 685f 612c  morphic(graph_a,
+00004550: 2067 7261 7068 5f62 2c0a 2f2f 2f20 2020   graph_b,.///   
+00004560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004580: 2020 6c61 6d62 6461 2078 2c20 793a 2078    lambda x, y: x
+00004590: 203d 3d20 7929 0a2f 2f2f 0a2f 2f2f 202e   == y).///./// .
+000045a0: 2e20 6e6f 7465 3a3a 0a2f 2f2f 0a2f 2f2f  . note::.///.///
+000045b0: 2020 2020 2046 6f72 2062 6574 7465 7220       For better 
+000045c0: 7065 7266 6f72 6d61 6e63 6520 6f6e 206c  performance on l
+000045d0: 6172 6765 2067 7261 7068 732c 2063 6f6e  arge graphs, con
+000045e0: 7369 6465 7220 7365 7474 696e 6720 6069  sider setting `i
+000045f0: 645f 6f72 6465 723d 4661 6c73 6560 2e0a  d_order=False`..
+00004600: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+00004610: 7947 7261 7068 2066 6972 7374 3a20 5468  yGraph first: Th
+00004620: 6520 6669 7273 7420 6772 6170 6820 746f  e first graph to
+00004630: 2063 6f6d 7061 7265 0a2f 2f2f 203a 7061   compare./// :pa
+00004640: 7261 6d20 5079 4772 6170 6820 7365 636f  ram PyGraph seco
+00004650: 6e64 3a20 5468 6520 7365 636f 6e64 2067  nd: The second g
+00004660: 7261 7068 2074 6f20 636f 6d70 6172 650a  raph to compare.
+00004670: 2f2f 2f20 3a70 6172 616d 2063 616c 6c61  /// :param calla
+00004680: 626c 6520 6e6f 6465 5f6d 6174 6368 6572  ble node_matcher
+00004690: 3a20 4120 7079 7468 6f6e 2063 616c 6c61  : A python calla
+000046a0: 626c 6520 6f62 6a65 6374 2074 6861 7420  ble object that 
+000046b0: 7461 6b65 7320 3220 706f 7369 7469 6f6e  takes 2 position
+000046c0: 616c 0a2f 2f2f 2020 2020 206f 6e65 2066  al.///     one f
+000046d0: 6f72 2065 6163 6820 6e6f 6465 2064 6174  or each node dat
+000046e0: 6120 6f62 6a65 6374 2e20 4966 2074 6865  a object. If the
+000046f0: 2072 6574 7572 6e20 6f66 2074 6869 730a   return of this.
+00004700: 2f2f 2f20 2020 2020 6675 6e63 7469 6f6e  ///     function
+00004710: 2065 7661 6c75 6174 6573 2074 6f20 5472   evaluates to Tr
+00004720: 7565 2074 6865 6e20 7468 6520 6e6f 6465  ue then the node
+00004730: 7320 7061 7373 6564 2074 6f20 6974 2061  s passed to it a
+00004740: 7265 2076 6965 6465 640a 2f2f 2f20 2020  re vieded.///   
+00004750: 2020 6173 206d 6174 6368 696e 672e 0a2f    as matching../
+00004760: 2f2f 203a 7061 7261 6d20 6361 6c6c 6162  // :param callab
+00004770: 6c65 2065 6467 655f 6d61 7463 6865 723a  le edge_matcher:
+00004780: 2041 2070 7974 686f 6e20 6361 6c6c 6162   A python callab
+00004790: 6c65 206f 626a 6563 7420 7468 6174 2074  le object that t
+000047a0: 616b 6573 2032 2070 6f73 6974 696f 6e61  akes 2 positiona
+000047b0: 6c0a 2f2f 2f20 2020 2020 6f6e 6520 666f  l.///     one fo
+000047c0: 7220 6561 6368 2065 6467 6520 6461 7461  r each edge data
+000047d0: 206f 626a 6563 742e 2049 6620 7468 6520   object. If the 
+000047e0: 7265 7475 726e 206f 6620 7468 6973 0a2f  return of this./
+000047f0: 2f2f 2020 2020 2066 756e 6374 696f 6e20  //     function 
+00004800: 6576 616c 7561 7465 7320 746f 2054 7275  evaluates to Tru
+00004810: 6520 7468 656e 2074 6865 2065 6467 6573  e then the edges
+00004820: 2070 6173 7365 6420 746f 2069 7420 6172   passed to it ar
+00004830: 6520 7669 6564 6564 0a2f 2f2f 2020 2020  e vieded.///    
+00004840: 2061 7320 6d61 7463 6869 6e67 2e0a 2f2f   as matching..//
+00004850: 2f20 3a70 6172 616d 2062 6f6f 6c20 6964  / :param bool id
+00004860: 5f6f 7264 6572 3a20 4966 2073 6574 2074  _order: If set t
+00004870: 6f20 6060 5472 7565 6060 2074 6869 7320  o ``True`` this 
+00004880: 6675 6e63 7469 6f6e 2077 696c 6c20 6d61  function will ma
+00004890: 7463 6820 7468 6520 6e6f 6465 730a 2f2f  tch the nodes.//
+000048a0: 2f20 2020 2020 696e 206f 7264 6572 2073  /     in order s
+000048b0: 7065 6369 6669 6564 2062 7920 7468 6569  pecified by thei
+000048c0: 7220 6964 732e 204f 7468 6572 7769 7365  r ids. Otherwise
+000048d0: 2069 7420 7769 6c6c 2064 6566 6175 6c74   it will default
+000048e0: 2074 6f20 6120 6865 7572 6973 7469 630a   to a heuristic.
+000048f0: 2f2f 2f20 2020 2020 6d61 7463 6869 6e67  ///     matching
+00004900: 206f 7264 6572 2062 6173 6564 206f 6e20   order based on 
+00004910: 5b56 4632 5d5f 2070 6170 6572 2e0a 2f2f  [VF2]_ paper..//
+00004920: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+00004930: 6060 5472 7565 6060 2069 6620 7468 6572  ``True`` if ther
+00004940: 6520 6973 2061 2073 7562 6772 6170 6820  e is a subgraph 
+00004950: 6f66 2060 6669 7273 7460 2069 736f 6d6f  of `first` isomo
+00004960: 7270 6869 6320 746f 2060 7365 636f 6e64  rphic to `second
+00004970: 602c 0a2f 2f2f 2020 2020 2060 6046 616c  `,.///     ``Fal
+00004980: 7365 6060 2069 6620 7468 6572 6520 6973  se`` if there is
+00004990: 206e 6f74 2e0a 2f2f 2f20 3a72 7479 7065   not../// :rtype
+000049a0: 3a20 626f 6f6c 0a23 5b70 7966 756e 6374  : bool.#[pyfunct
+000049b0: 696f 6e28 6964 5f6f 7264 6572 203d 2022  ion(id_order = "
+000049c0: 6661 6c73 6522 295d 0a23 5b74 6578 745f  false")].#[text_
+000049d0: 7369 676e 6174 7572 6520 3d20 2228 6669  signature = "(fi
+000049e0: 7273 742c 2073 6563 6f6e 642c 206e 6f64  rst, second, nod
+000049f0: 655f 6d61 7463 6865 723d 4e6f 6e65 2c20  e_matcher=None, 
+00004a00: 6564 6765 5f6d 6174 6368 6572 3d4e 6f6e  edge_matcher=Non
+00004a10: 652c 2069 645f 6f72 6465 723d 4661 6c73  e, id_order=Fals
+00004a20: 652c 202f 2922 5d0a 666e 2067 7261 7068  e, /)"].fn graph
+00004a30: 5f69 735f 7375 6267 7261 7068 5f69 736f  _is_subgraph_iso
+00004a40: 6d6f 7270 6869 6328 0a20 2020 2070 793a  morphic(.    py:
+00004a50: 2050 7974 686f 6e2c 0a20 2020 2066 6972   Python,.    fir
+00004a60: 7374 3a20 2667 7261 7068 3a3a 5079 4772  st: &graph::PyGr
+00004a70: 6170 682c 0a20 2020 2073 6563 6f6e 643a  aph,.    second:
+00004a80: 2026 6772 6170 683a 3a50 7947 7261 7068   &graph::PyGraph
+00004a90: 2c0a 2020 2020 6e6f 6465 5f6d 6174 6368  ,.    node_match
+00004aa0: 6572 3a20 4f70 7469 6f6e 3c50 794f 626a  er: Option<PyObj
+00004ab0: 6563 743e 2c0a 2020 2020 6564 6765 5f6d  ect>,.    edge_m
+00004ac0: 6174 6368 6572 3a20 4f70 7469 6f6e 3c50  atcher: Option<P
+00004ad0: 794f 626a 6563 743e 2c0a 2020 2020 6964  yObject>,.    id
+00004ae0: 5f6f 7264 6572 3a20 626f 6f6c 2c0a 2920  _order: bool,.) 
+00004af0: 2d3e 2050 7952 6573 756c 743c 626f 6f6c  -> PyResult<bool
+00004b00: 3e20 7b0a 2020 2020 6c65 7420 636f 6d70  > {.    let comp
+00004b10: 6172 655f 6e6f 6465 7320 3d20 6e6f 6465  are_nodes = node
+00004b20: 5f6d 6174 6368 6572 2e6d 6170 287c 667c  _matcher.map(|f|
+00004b30: 207b 0a20 2020 2020 2020 206d 6f76 6520   {.        move 
+00004b40: 7c61 3a20 2650 794f 626a 6563 742c 2062  |a: &PyObject, b
+00004b50: 3a20 2650 794f 626a 6563 747c 202d 3e20  : &PyObject| -> 
+00004b60: 5079 5265 7375 6c74 3c62 6f6f 6c3e 207b  PyResult<bool> {
+00004b70: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00004b80: 2072 6573 203d 2066 2e63 616c 6c31 2870   res = f.call1(p
+00004b90: 792c 2028 612c 2062 2929 3f3b 0a20 2020  y, (a, b))?;.   
+00004ba0: 2020 2020 2020 2020 204f 6b28 7265 732e           Ok(res.
+00004bb0: 6973 5f74 7275 6528 7079 292e 756e 7772  is_true(py).unwr
+00004bc0: 6170 2829 290a 2020 2020 2020 2020 7d0a  ap()).        }.
+00004bd0: 2020 2020 7d29 3b0a 0a20 2020 206c 6574      });..    let
+00004be0: 2063 6f6d 7061 7265 5f65 6467 6573 203d   compare_edges =
+00004bf0: 2065 6467 655f 6d61 7463 6865 722e 6d61   edge_matcher.ma
+00004c00: 7028 7c66 7c20 7b0a 2020 2020 2020 2020  p(|f| {.        
+00004c10: 6d6f 7665 207c 613a 2026 5079 4f62 6a65  move |a: &PyObje
+00004c20: 6374 2c20 623a 2026 5079 4f62 6a65 6374  ct, b: &PyObject
+00004c30: 7c20 2d3e 2050 7952 6573 756c 743c 626f  | -> PyResult<bo
+00004c40: 6f6c 3e20 7b0a 2020 2020 2020 2020 2020  ol> {.          
+00004c50: 2020 6c65 7420 7265 7320 3d20 662e 6361    let res = f.ca
+00004c60: 6c6c 3128 7079 2c20 2861 2c20 6229 293f  ll1(py, (a, b))?
+00004c70: 3b0a 2020 2020 2020 2020 2020 2020 4f6b  ;.            Ok
+00004c80: 2872 6573 2e69 735f 7472 7565 2870 7929  (res.is_true(py)
+00004c90: 2e75 6e77 7261 7028 2929 0a20 2020 2020  .unwrap()).     
+00004ca0: 2020 207d 0a20 2020 207d 293b 0a0a 2020     }.    });..  
+00004cb0: 2020 6c65 7420 7265 7320 3d20 6973 6f6d    let res = isom
+00004cc0: 6f72 7068 6973 6d3a 3a69 735f 6973 6f6d  orphism::is_isom
+00004cd0: 6f72 7068 6963 280a 2020 2020 2020 2020  orphic(.        
+00004ce0: 7079 2c0a 2020 2020 2020 2020 2666 6972  py,.        &fir
+00004cf0: 7374 2e67 7261 7068 2c0a 2020 2020 2020  st.graph,.      
+00004d00: 2020 2673 6563 6f6e 642e 6772 6170 682c    &second.graph,
+00004d10: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00004d20: 5f6e 6f64 6573 2c0a 2020 2020 2020 2020  _nodes,.        
+00004d30: 636f 6d70 6172 655f 6564 6765 732c 0a20  compare_edges,. 
+00004d40: 2020 2020 2020 2069 645f 6f72 6465 722c         id_order,
+00004d50: 0a20 2020 2020 2020 204f 7264 6572 696e  .        Orderin
+00004d60: 673a 3a47 7265 6174 6572 2c0a 2020 2020  g::Greater,.    
+00004d70: 293f 3b0a 2020 2020 4f6b 2872 6573 290a  )?;.    Ok(res).
+00004d80: 7d0a 0a2f 2f2f 2052 6574 7572 6e20 7468  }../// Return th
+00004d90: 6520 746f 706f 6c6f 6769 6361 6c20 736f  e topological so
+00004da0: 7274 206f 6620 6e6f 6465 2069 6e64 6578  rt of node index
+00004db0: 6573 2066 726f 6d20 7468 6520 7072 6f76  es from the prov
+00004dc0: 6964 6564 2067 7261 7068 0a2f 2f2f 0a2f  ided graph.///./
+00004dd0: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
+00004de0: 6170 6820 6772 6170 683a 2054 6865 2044  aph graph: The D
+00004df0: 4147 2074 6f20 6765 7420 7468 6520 746f  AG to get the to
+00004e00: 706f 6c6f 6769 6361 6c20 736f 7274 206f  pological sort o
+00004e10: 6e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  n.///./// :retur
+00004e20: 6e73 3a20 4120 6c69 7374 206f 6620 6e6f  ns: A list of no
+00004e30: 6465 2069 6e64 6963 6573 2074 6f70 6f6c  de indices topol
+00004e40: 6f67 6963 616c 6c79 2073 6f72 7465 642e  ogically sorted.
+00004e50: 0a2f 2f2f 203a 7274 7970 653a 204e 6f64  ./// :rtype: Nod
+00004e60: 6549 6e64 6963 6573 0a2f 2f2f 0a2f 2f2f  eIndices.///.///
+00004e70: 203a 7261 6973 6573 2044 4147 4861 7343   :raises DAGHasC
+00004e80: 7963 6c65 3a20 6966 2061 2063 7963 6c65  ycle: if a cycle
+00004e90: 2069 7320 656e 636f 756e 7465 7265 6420   is encountered 
+00004ea0: 7768 696c 6520 736f 7274 696e 6720 7468  while sorting th
+00004eb0: 6520 6772 6170 680a 235b 7079 6675 6e63  e graph.#[pyfunc
+00004ec0: 7469 6f6e 5d0a 235b 7465 7874 5f73 6967  tion].#[text_sig
+00004ed0: 6e61 7475 7265 203d 2022 2867 7261 7068  nature = "(graph
+00004ee0: 2c20 2f29 225d 0a66 6e20 746f 706f 6c6f  , /)"].fn topolo
+00004ef0: 6769 6361 6c5f 736f 7274 2867 7261 7068  gical_sort(graph
+00004f00: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+00004f10: 4772 6170 6829 202d 3e20 5079 5265 7375  Graph) -> PyResu
+00004f20: 6c74 3c4e 6f64 6549 6e64 6963 6573 3e20  lt<NodeIndices> 
+00004f30: 7b0a 2020 2020 6c65 7420 6e6f 6465 7320  {.    let nodes 
+00004f40: 3d20 6d61 7463 6820 616c 676f 3a3a 746f  = match algo::to
+00004f50: 706f 736f 7274 2867 7261 7068 2c20 4e6f  posort(graph, No
+00004f60: 6e65 2920 7b0a 2020 2020 2020 2020 4f6b  ne) {.        Ok
+00004f70: 286e 6f64 6573 2920 3d3e 206e 6f64 6573  (nodes) => nodes
+00004f80: 2c0a 2020 2020 2020 2020 4572 7228 5f65  ,.        Err(_e
+00004f90: 7272 2920 3d3e 207b 0a20 2020 2020 2020  rr) => {.       
+00004fa0: 2020 2020 2072 6574 7572 6e20 4572 7228       return Err(
+00004fb0: 4441 4748 6173 4379 636c 653a 3a6e 6577  DAGHasCycle::new
+00004fc0: 5f65 7272 2822 536f 7274 2065 6e63 6f75  _err("Sort encou
+00004fd0: 6e74 6572 6564 2061 2063 7963 6c65 2229  ntered a cycle")
+00004fe0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+00004ff0: 7d3b 0a20 2020 204f 6b28 4e6f 6465 496e  };.    Ok(NodeIn
+00005000: 6469 6365 7320 7b0a 2020 2020 2020 2020  dices {.        
+00005010: 6e6f 6465 733a 206e 6f64 6573 2e69 7465  nodes: nodes.ite
+00005020: 7228 292e 6d61 7028 7c6e 6f64 657c 206e  r().map(|node| n
+00005030: 6f64 652e 696e 6465 7828 2929 2e63 6f6c  ode.index()).col
+00005040: 6c65 6374 2829 2c0a 2020 2020 7d29 0a7d  lect(),.    }).}
+00005050: 0a0a 666e 2064 6673 5f65 6467 6573 3c47  ..fn dfs_edges<G
+00005060: 3e28 0a20 2020 2067 7261 7068 3a20 472c  >(.    graph: G,
+00005070: 0a20 2020 2073 6f75 7263 653a 204f 7074  .    source: Opt
+00005080: 696f 6e3c 7573 697a 653e 2c0a 2020 2020  ion<usize>,.    
+00005090: 6564 6765 5f63 6f75 6e74 3a20 7573 697a  edge_count: usiz
+000050a0: 652c 0a29 202d 3e20 5665 633c 2875 7369  e,.) -> Vec<(usi
+000050b0: 7a65 2c20 7573 697a 6529 3e0a 7768 6572  ze, usize)>.wher
+000050c0: 650a 2020 2020 473a 2047 7261 7068 4261  e.    G: GraphBa
+000050d0: 7365 3c4e 6f64 6549 6420 3d20 4e6f 6465  se<NodeId = Node
+000050e0: 496e 6465 783e 0a20 2020 2020 2020 202b  Index>.        +
+000050f0: 2049 6e74 6f4e 6f64 6549 6465 6e74 6966   IntoNodeIdentif
+00005100: 6965 7273 0a20 2020 2020 2020 202b 204e  iers.        + N
+00005110: 6f64 6549 6e64 6578 6162 6c65 0a20 2020  odeIndexable.   
+00005120: 2020 2020 202b 2049 6e74 6f4e 6569 6768       + IntoNeigh
+00005130: 626f 7273 0a20 2020 2020 2020 202b 204e  bors.        + N
+00005140: 6f64 6543 6f75 6e74 0a20 2020 2020 2020  odeCount.       
+00005150: 202b 2056 6973 6974 6162 6c65 2c0a 2020   + Visitable,.  
+00005160: 2020 3c47 2061 7320 5669 7369 7461 626c    <G as Visitabl
+00005170: 653e 3a3a 4d61 703a 2056 6973 6974 4d61  e>::Map: VisitMa
+00005180: 703c 4e6f 6465 496e 6465 783e 2c0a 7b0a  p<NodeIndex>,.{.
+00005190: 2020 2020 6c65 7420 6e6f 6465 733a 2056      let nodes: V
+000051a0: 6563 3c4e 6f64 6549 6e64 6578 3e20 3d20  ec<NodeIndex> = 
+000051b0: 6d61 7463 6820 736f 7572 6365 207b 0a20  match source {. 
+000051c0: 2020 2020 2020 2053 6f6d 6528 7374 6172         Some(star
+000051d0: 7429 203d 3e20 7665 6321 5b4e 6f64 6549  t) => vec![NodeI
+000051e0: 6e64 6578 3a3a 6e65 7728 7374 6172 7429  ndex::new(start)
+000051f0: 5d2c 0a20 2020 2020 2020 204e 6f6e 6520  ],.        None 
+00005200: 3d3e 2067 7261 7068 0a20 2020 2020 2020  => graph.       
+00005210: 2020 2020 202e 6e6f 6465 5f69 6465 6e74       .node_ident
+00005220: 6966 6965 7273 2829 0a20 2020 2020 2020  ifiers().       
+00005230: 2020 2020 202e 6d61 7028 7c69 6e64 7c20       .map(|ind| 
+00005240: 4e6f 6465 496e 6465 783a 3a6e 6577 2867  NodeIndex::new(g
+00005250: 7261 7068 2e74 6f5f 696e 6465 7828 696e  raph.to_index(in
+00005260: 6429 2929 0a20 2020 2020 2020 2020 2020  d))).           
+00005270: 202e 636f 6c6c 6563 7428 292c 0a20 2020   .collect(),.   
+00005280: 207d 3b0a 2020 2020 6c65 7420 6e6f 6465   };.    let node
+00005290: 5f63 6f75 6e74 203d 2067 7261 7068 2e6e  _count = graph.n
+000052a0: 6f64 655f 636f 756e 7428 293b 0a20 2020  ode_count();.   
+000052b0: 206c 6574 206d 7574 2076 6973 6974 6564   let mut visited
+000052c0: 3a20 4861 7368 5365 743c 4e6f 6465 496e  : HashSet<NodeIn
+000052d0: 6465 783e 203d 2048 6173 6853 6574 3a3a  dex> = HashSet::
+000052e0: 7769 7468 5f63 6170 6163 6974 7928 6e6f  with_capacity(no
+000052f0: 6465 5f63 6f75 6e74 293b 0a20 2020 206c  de_count);.    l
+00005300: 6574 206d 7574 206f 7574 5f76 6563 3a20  et mut out_vec: 
+00005310: 5665 633c 2875 7369 7a65 2c20 7573 697a  Vec<(usize, usiz
+00005320: 6529 3e20 3d20 5665 633a 3a77 6974 685f  e)> = Vec::with_
+00005330: 6361 7061 6369 7479 2865 6467 655f 636f  capacity(edge_co
+00005340: 756e 7429 3b0a 2020 2020 666f 7220 7374  unt);.    for st
+00005350: 6172 7420 696e 206e 6f64 6573 207b 0a20  art in nodes {. 
+00005360: 2020 2020 2020 2069 6620 7669 7369 7465         if visite
+00005370: 642e 636f 6e74 6169 6e73 2826 7374 6172  d.contains(&star
+00005380: 7429 207b 0a20 2020 2020 2020 2020 2020  t) {.           
+00005390: 2063 6f6e 7469 6e75 653b 0a20 2020 2020   continue;.     
+000053a0: 2020 207d 0a20 2020 2020 2020 2076 6973     }.        vis
+000053b0: 6974 6564 2e69 6e73 6572 7428 7374 6172  ited.insert(star
+000053c0: 7429 3b0a 2020 2020 2020 2020 6c65 7420  t);.        let 
+000053d0: 6d75 7420 6368 696c 6472 656e 3a20 5665  mut children: Ve
+000053e0: 633c 4e6f 6465 496e 6465 783e 203d 2067  c<NodeIndex> = g
+000053f0: 7261 7068 2e6e 6569 6768 626f 7273 2873  raph.neighbors(s
+00005400: 7461 7274 292e 636f 6c6c 6563 7428 293b  tart).collect();
+00005410: 0a20 2020 2020 2020 2063 6869 6c64 7265  .        childre
+00005420: 6e2e 7265 7665 7273 6528 293b 0a20 2020  n.reverse();.   
+00005430: 2020 2020 206c 6574 206d 7574 2073 7461       let mut sta
+00005440: 636b 3a20 5665 633c 284e 6f64 6549 6e64  ck: Vec<(NodeInd
+00005450: 6578 2c20 5665 633c 4e6f 6465 496e 6465  ex, Vec<NodeInde
+00005460: 783e 293e 203d 0a20 2020 2020 2020 2020  x>)> =.         
+00005470: 2020 2076 6563 215b 2873 7461 7274 2c20     vec![(start, 
+00005480: 6368 696c 6472 656e 295d 3b0a 2020 2020  children)];.    
+00005490: 2020 2020 2f2f 2055 7365 6420 746f 2074      // Used to t
+000054a0: 7261 636b 2074 6865 206c 6173 7420 706f  rack the last po
+000054b0: 7369 7469 6f6e 2069 6e20 6368 696c 6472  sition in childr
+000054c0: 656e 2076 6563 2061 6372 6f73 7320 6974  en vec across it
+000054d0: 6572 6174 696f 6e73 0a20 2020 2020 2020  erations.       
+000054e0: 206c 6574 206d 7574 2069 6e64 6578 5f6d   let mut index_m
+000054f0: 6170 3a20 4861 7368 4d61 703c 4e6f 6465  ap: HashMap<Node
+00005500: 496e 6465 782c 2075 7369 7a65 3e20 3d0a  Index, usize> =.
+00005510: 2020 2020 2020 2020 2020 2020 4861 7368              Hash
+00005520: 4d61 703a 3a77 6974 685f 6361 7061 6369  Map::with_capaci
+00005530: 7479 286e 6f64 655f 636f 756e 7429 3b0a  ty(node_count);.
+00005540: 2020 2020 2020 2020 696e 6465 785f 6d61          index_ma
+00005550: 702e 696e 7365 7274 2873 7461 7274 2c20  p.insert(start, 
+00005560: 3029 3b0a 2020 2020 2020 2020 7768 696c  0);.        whil
+00005570: 6520 2173 7461 636b 2e69 735f 656d 7074  e !stack.is_empt
+00005580: 7928 2920 7b0a 2020 2020 2020 2020 2020  y() {.          
+00005590: 2020 6c65 7420 7465 6d70 5f70 6172 656e    let temp_paren
+000055a0: 7420 3d20 7374 6163 6b2e 6c61 7374 2829  t = stack.last()
+000055b0: 2e75 6e77 7261 7028 293b 0a20 2020 2020  .unwrap();.     
+000055c0: 2020 2020 2020 206c 6574 2070 6172 656e         let paren
+000055d0: 7420 3d20 7465 6d70 5f70 6172 656e 742e  t = temp_parent.
+000055e0: 303b 0a20 2020 2020 2020 2020 2020 206c  0;.            l
+000055f0: 6574 2063 6869 6c64 7265 6e20 3d20 7465  et children = te
+00005600: 6d70 5f70 6172 656e 742e 312e 636c 6f6e  mp_parent.1.clon
+00005610: 6528 293b 0a20 2020 2020 2020 2020 2020  e();.           
+00005620: 206c 6574 2063 6f75 6e74 203d 202a 696e   let count = *in
+00005630: 6465 785f 6d61 702e 6765 7428 2670 6172  dex_map.get(&par
+00005640: 656e 7429 2e75 6e77 7261 7028 293b 0a20  ent).unwrap();. 
+00005650: 2020 2020 2020 2020 2020 206c 6574 206d             let m
+00005660: 7574 2066 6f75 6e64 203d 2066 616c 7365  ut found = false
+00005670: 3b0a 2020 2020 2020 2020 2020 2020 6c65  ;.            le
+00005680: 7420 6d75 7420 696e 6465 7820 3d20 636f  t mut index = co
+00005690: 756e 743b 0a20 2020 2020 2020 2020 2020  unt;.           
+000056a0: 2066 6f72 2063 6869 6c64 2069 6e20 2663   for child in &c
+000056b0: 6869 6c64 7265 6e5b 696e 6465 782e 2e5d  hildren[index..]
+000056c0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000056d0: 2020 2069 6e64 6578 202b 3d20 313b 0a20     index += 1;. 
+000056e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000056f0: 6620 2176 6973 6974 6564 2e63 6f6e 7461  f !visited.conta
+00005700: 696e 7328 2663 6869 6c64 2920 7b0a 2020  ins(&child) {.  
+00005710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005720: 2020 6f75 745f 7665 632e 7075 7368 2828    out_vec.push((
+00005730: 7061 7265 6e74 2e69 6e64 6578 2829 2c20  parent.index(), 
+00005740: 6368 696c 642e 696e 6465 7828 2929 293b  child.index()));
+00005750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005760: 2020 2020 2076 6973 6974 6564 2e69 6e73       visited.ins
+00005770: 6572 7428 2a63 6869 6c64 293b 0a20 2020  ert(*child);.   
+00005780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005790: 206c 6574 206d 7574 2067 7261 6e64 6368   let mut grandch
+000057a0: 696c 6472 656e 3a20 5665 633c 4e6f 6465  ildren: Vec<Node
+000057b0: 496e 6465 783e 203d 0a20 2020 2020 2020  Index> =.       
+000057c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057d0: 2067 7261 7068 2e6e 6569 6768 626f 7273   graph.neighbors
+000057e0: 282a 6368 696c 6429 2e63 6f6c 6c65 6374  (*child).collect
+000057f0: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
+00005800: 2020 2020 2020 2020 6772 616e 6463 6869          grandchi
+00005810: 6c64 7265 6e2e 7265 7665 7273 6528 293b  ldren.reverse();
+00005820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005830: 2020 2020 2073 7461 636b 2e70 7573 6828       stack.push(
+00005840: 282a 6368 696c 642c 2067 7261 6e64 6368  (*child, grandch
+00005850: 696c 6472 656e 2929 3b0a 2020 2020 2020  ildren));.      
+00005860: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00005870: 6465 785f 6d61 702e 696e 7365 7274 282a  dex_map.insert(*
+00005880: 6368 696c 642c 2030 293b 0a20 2020 2020  child, 0);.     
+00005890: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+000058a0: 696e 6465 785f 6d61 702e 6765 745f 6d75  index_map.get_mu
+000058b0: 7428 2670 6172 656e 7429 2e75 6e77 7261  t(&parent).unwra
+000058c0: 7028 2920 3d20 696e 6465 783b 0a20 2020  p() = index;.   
+000058d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058e0: 2066 6f75 6e64 203d 2074 7275 653b 0a20   found = true;. 
+000058f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005900: 2020 2062 7265 616b 3b0a 2020 2020 2020     break;.      
+00005910: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00005920: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00005930: 2020 2020 2020 6966 2021 666f 756e 6420        if !found 
+00005940: 7c7c 2063 6869 6c64 7265 6e2e 6973 5f65  || children.is_e
+00005950: 6d70 7479 2829 207b 0a20 2020 2020 2020  mpty() {.       
+00005960: 2020 2020 2020 2020 2073 7461 636b 2e70           stack.p
+00005970: 6f70 2829 3b0a 2020 2020 2020 2020 2020  op();.          
+00005980: 2020 7d0a 2020 2020 2020 2020 7d0a 2020    }.        }.  
+00005990: 2020 7d0a 2020 2020 6f75 745f 7665 630a    }.    out_vec.
+000059a0: 7d0a 0a2f 2f2f 2047 6574 2065 6467 6520  }../// Get edge 
+000059b0: 6c69 7374 2069 6e20 6465 7074 6820 6669  list in depth fi
+000059c0: 7273 7420 6f72 6465 720a 2f2f 2f0a 2f2f  rst order.///.//
+000059d0: 2f20 3a70 6172 616d 2050 7944 6947 7261  / :param PyDiGra
+000059e0: 7068 2067 7261 7068 3a20 5468 6520 6772  ph graph: The gr
+000059f0: 6170 6820 746f 2067 6574 2074 6865 2044  aph to get the D
+00005a00: 4653 2065 6467 6520 6c69 7374 2066 726f  FS edge list fro
+00005a10: 6d0a 2f2f 2f20 3a70 6172 616d 2069 6e74  m./// :param int
+00005a20: 2073 6f75 7263 653a 2041 6e20 6f70 7469   source: An opti
+00005a30: 6f6e 616c 206e 6f64 6520 696e 6465 7820  onal node index 
+00005a40: 746f 2075 7365 2061 7320 7468 6520 7374  to use as the st
+00005a50: 6172 7469 6e67 206e 6f64 650a 2f2f 2f20  arting node./// 
+00005a60: 2020 2020 666f 7220 7468 6520 6465 7074      for the dept
+00005a70: 682d 6669 7273 7420 7365 6172 6368 2e20  h-first search. 
+00005a80: 5468 6520 6564 6765 206c 6973 7420 7769  The edge list wi
+00005a90: 6c6c 206f 6e6c 7920 7265 7475 726e 2065  ll only return e
+00005aa0: 6467 6573 2069 6e0a 2f2f 2f20 2020 2020  dges in.///     
+00005ab0: 7468 6520 636f 6d70 6f6e 656e 7473 2072  the components r
+00005ac0: 6561 6368 6162 6c65 2066 726f 6d20 7468  eachable from th
+00005ad0: 6973 2069 6e64 6578 2e20 4966 2074 6869  is index. If thi
+00005ae0: 7320 6973 206e 6f74 2073 7065 6369 6669  s is not specifi
+00005af0: 6564 0a2f 2f2f 2020 2020 2074 6865 6e20  ed.///     then 
+00005b00: 6120 736f 7572 6365 2077 696c 6c20 6265  a source will be
+00005b10: 2063 686f 7365 6e20 6172 6269 7472 6172   chosen arbitrar
+00005b20: 6c79 2061 6e64 2072 6570 6561 7465 6420  ly and repeated 
+00005b30: 756e 7469 6c20 616c 6c0a 2f2f 2f20 2020  until all.///   
+00005b40: 2020 636f 6d70 6f6e 656e 7473 206f 6620    components of 
+00005b50: 7468 6520 6772 6170 6820 6172 6520 7365  the graph are se
+00005b60: 6172 6368 6564 2e0a 2f2f 2f0a 2f2f 2f20  arched..///./// 
+00005b70: 3a72 6574 7572 6e73 3a20 4120 6c69 7374  :returns: A list
+00005b80: 206f 6620 6564 6765 7320 6173 2061 2074   of edges as a t
+00005b90: 7570 6c65 206f 6620 7468 6520 666f 726d  uple of the form
+00005ba0: 2060 6028 736f 7572 6365 2c20 7461 7267   ``(source, targ
+00005bb0: 6574 2960 6020 696e 0a2f 2f2f 2020 2020  et)`` in.///    
+00005bc0: 2064 6570 7468 2d66 6972 7374 206f 7264   depth-first ord
+00005bd0: 6572 0a2f 2f2f 203a 7274 7970 653a 2045  er./// :rtype: E
+00005be0: 6467 654c 6973 740a 235b 7079 6675 6e63  dgeList.#[pyfunc
+00005bf0: 7469 6f6e 5d0a 235b 7465 7874 5f73 6967  tion].#[text_sig
+00005c00: 6e61 7475 7265 203d 2022 2867 7261 7068  nature = "(graph
+00005c10: 2c20 2f2c 2073 6f75 7263 653d 4e6f 6e65  , /, source=None
+00005c20: 2922 5d0a 666e 2064 6967 7261 7068 5f64  )"].fn digraph_d
+00005c30: 6673 5f65 6467 6573 280a 2020 2020 6772  fs_edges(.    gr
+00005c40: 6170 683a 2026 6469 6772 6170 683a 3a50  aph: &digraph::P
+00005c50: 7944 6947 7261 7068 2c0a 2020 2020 736f  yDiGraph,.    so
+00005c60: 7572 6365 3a20 4f70 7469 6f6e 3c75 7369  urce: Option<usi
+00005c70: 7a65 3e2c 0a29 202d 3e20 4564 6765 4c69  ze>,.) -> EdgeLi
+00005c80: 7374 207b 0a20 2020 2045 6467 654c 6973  st {.    EdgeLis
+00005c90: 7420 7b0a 2020 2020 2020 2020 6564 6765  t {.        edge
+00005ca0: 733a 2064 6673 5f65 6467 6573 2867 7261  s: dfs_edges(gra
+00005cb0: 7068 2c20 736f 7572 6365 2c20 6772 6170  ph, source, grap
+00005cc0: 682e 6772 6170 682e 6564 6765 5f63 6f75  h.graph.edge_cou
+00005cd0: 6e74 2829 292c 0a20 2020 207d 0a7d 0a0a  nt()),.    }.}..
+00005ce0: 2f2f 2f20 4765 7420 6564 6765 206c 6973  /// Get edge lis
+00005cf0: 7420 696e 2064 6570 7468 2066 6972 7374  t in depth first
+00005d00: 206f 7264 6572 0a2f 2f2f 0a2f 2f2f 203a   order.///./// :
+00005d10: 7061 7261 6d20 5079 4772 6170 6820 6772  param PyGraph gr
+00005d20: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
+00005d30: 6f20 6765 7420 7468 6520 4446 5320 6564  o get the DFS ed
+00005d40: 6765 206c 6973 7420 6672 6f6d 0a2f 2f2f  ge list from.///
+00005d50: 203a 7061 7261 6d20 696e 7420 736f 7572   :param int sour
+00005d60: 6365 3a20 416e 206f 7074 696f 6e61 6c20  ce: An optional 
+00005d70: 6e6f 6465 2069 6e64 6578 2074 6f20 7573  node index to us
+00005d80: 6520 6173 2074 6865 2073 7461 7274 696e  e as the startin
+00005d90: 6720 6e6f 6465 0a2f 2f2f 2020 2020 2066  g node.///     f
+00005da0: 6f72 2074 6865 2064 6570 7468 2d66 6972  or the depth-fir
+00005db0: 7374 2073 6561 7263 682e 2054 6865 2065  st search. The e
+00005dc0: 6467 6520 6c69 7374 2077 696c 6c20 6f6e  dge list will on
+00005dd0: 6c79 2072 6574 7572 6e20 6564 6765 7320  ly return edges 
+00005de0: 696e 0a2f 2f2f 2020 2020 2074 6865 2063  in.///     the c
+00005df0: 6f6d 706f 6e65 6e74 7320 7265 6163 6861  omponents reacha
+00005e00: 626c 6520 6672 6f6d 2074 6869 7320 696e  ble from this in
+00005e10: 6465 782e 2049 6620 7468 6973 2069 7320  dex. If this is 
+00005e20: 6e6f 7420 7370 6563 6966 6965 640a 2f2f  not specified.//
+00005e30: 2f20 2020 2020 7468 656e 2061 2073 6f75  /     then a sou
+00005e40: 7263 6520 7769 6c6c 2062 6520 6368 6f73  rce will be chos
+00005e50: 656e 2061 7262 6974 7261 726c 7920 616e  en arbitrarly an
+00005e60: 6420 7265 7065 6174 6564 2075 6e74 696c  d repeated until
+00005e70: 2061 6c6c 0a2f 2f2f 2020 2020 2063 6f6d   all.///     com
+00005e80: 706f 6e65 6e74 7320 6f66 2074 6865 2067  ponents of the g
+00005e90: 7261 7068 2061 7265 2073 6561 7263 6865  raph are searche
+00005ea0: 642e 0a2f 2f2f 0a2f 2f2f 203a 7265 7475  d..///./// :retu
+00005eb0: 726e 733a 2041 206c 6973 7420 6f66 2065  rns: A list of e
+00005ec0: 6467 6573 2061 7320 6120 7475 706c 6520  dges as a tuple 
+00005ed0: 6f66 2074 6865 2066 6f72 6d20 6060 2873  of the form ``(s
+00005ee0: 6f75 7263 652c 2074 6172 6765 7429 6060  ource, target)``
+00005ef0: 2069 6e0a 2f2f 2f20 2020 2020 6465 7074   in.///     dept
+00005f00: 682d 6669 7273 7420 6f72 6465 720a 2f2f  h-first order.//
+00005f10: 2f20 3a72 7479 7065 3a20 4564 6765 4c69  / :rtype: EdgeLi
+00005f20: 7374 0a23 5b70 7966 756e 6374 696f 6e5d  st.#[pyfunction]
+00005f30: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
+00005f40: 6520 3d20 2228 6772 6170 682c 202f 2c20  e = "(graph, /, 
+00005f50: 736f 7572 6365 3d4e 6f6e 6529 225d 0a66  source=None)"].f
+00005f60: 6e20 6772 6170 685f 6466 735f 6564 6765  n graph_dfs_edge
+00005f70: 7328 6772 6170 683a 2026 6772 6170 683a  s(graph: &graph:
+00005f80: 3a50 7947 7261 7068 2c20 736f 7572 6365  :PyGraph, source
+00005f90: 3a20 4f70 7469 6f6e 3c75 7369 7a65 3e29  : Option<usize>)
+00005fa0: 202d 3e20 4564 6765 4c69 7374 207b 0a20   -> EdgeList {. 
+00005fb0: 2020 2045 6467 654c 6973 7420 7b0a 2020     EdgeList {.  
+00005fc0: 2020 2020 2020 6564 6765 733a 2064 6673        edges: dfs
+00005fd0: 5f65 6467 6573 2867 7261 7068 2c20 736f  _edges(graph, so
+00005fe0: 7572 6365 2c20 6772 6170 682e 6772 6170  urce, graph.grap
+00005ff0: 682e 6564 6765 5f63 6f75 6e74 2829 292c  h.edge_count()),
+00006000: 0a20 2020 207d 0a7d 0a0a 2f2f 2f20 5265  .    }.}../// Re
+00006010: 7475 726e 2073 7563 6365 7373 6f72 7320  turn successors 
+00006020: 696e 2061 2062 7265 6164 7468 2d66 6972  in a breadth-fir
+00006030: 7374 2d73 6561 7263 6820 6672 6f6d 2061  st-search from a
+00006040: 2073 6f75 7263 6520 6e6f 6465 2e0a 2f2f   source node..//
+00006050: 2f0a 2f2f 2f20 5468 6520 7265 7475 726e  /./// The return
+00006060: 2066 6f72 6d61 7420 6973 2060 605b 2850   format is ``[(P
+00006070: 6172 656e 7420 4e6f 6465 2c20 5b43 6869  arent Node, [Chi
+00006080: 6c64 7265 6e20 4e6f 6465 735d 295d 6060  ldren Nodes])]``
+00006090: 2069 6e20 6120 6266 7320 6f72 6465 720a   in a bfs order.
+000060a0: 2f2f 2f20 6672 6f6d 2074 6865 2073 6f75  /// from the sou
+000060b0: 7263 6520 6e6f 6465 2070 726f 7669 6465  rce node provide
+000060c0: 642e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  d..///./// :para
+000060d0: 6d20 5079 4469 4772 6170 6820 6772 6170  m PyDiGraph grap
+000060e0: 683a 2054 6865 2044 4147 2074 6f20 6765  h: The DAG to ge
+000060f0: 7420 7468 6520 6266 735f 7375 6363 6573  t the bfs_succes
+00006100: 736f 7273 2066 726f 6d0a 2f2f 2f20 3a70  sors from./// :p
+00006110: 6172 616d 2069 6e74 206e 6f64 653a 2054  aram int node: T
+00006120: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
+00006130: 6461 6720 6e6f 6465 2074 6f20 6765 7420  dag node to get 
+00006140: 7468 6520 6266 7320 7375 6363 6573 736f  the bfs successo
+00006150: 7273 2066 6f72 0a2f 2f2f 0a2f 2f2f 203a  rs for.///./// :
+00006160: 7265 7475 726e 733a 2041 206c 6973 7420  returns: A list 
+00006170: 6f66 206e 6f64 6573 2773 2064 6174 6120  of nodes's data 
+00006180: 616e 6420 7468 6569 7220 6368 696c 6472  and their childr
+00006190: 656e 2069 6e20 6266 7320 6f72 6465 722e  en in bfs order.
+000061a0: 2054 6865 0a2f 2f2f 2020 2020 2042 4653   The.///     BFS
+000061b0: 5375 6363 6573 736f 7273 2063 6c61 7373  Successors class
+000061c0: 2074 6861 7420 6973 2072 6574 7572 6e65   that is returne
+000061d0: 6420 6973 2061 2063 7573 746f 6d20 636f  d is a custom co
+000061e0: 6e74 6169 6e65 7220 636c 6173 7320 7468  ntainer class th
+000061f0: 6174 0a2f 2f2f 2020 2020 2069 6d70 6c65  at.///     imple
+00006200: 6d65 6e74 7320 7468 6520 7365 7175 656e  ments the sequen
+00006210: 6365 2070 726f 746f 636f 6c2e 2054 6869  ce protocol. Thi
+00006220: 7320 6361 6e20 6265 2075 7365 6420 6173  s can be used as
+00006230: 2061 2070 7974 686f 6e20 6c69 7374 0a2f   a python list./
+00006240: 2f2f 2020 2020 2077 6974 6820 696e 6465  //     with inde
+00006250: 7820 6261 7365 6420 6163 6365 7373 2e0a  x based access..
+00006260: 2f2f 2f20 3a72 7479 7065 3a20 4246 5353  /// :rtype: BFSS
+00006270: 7563 6365 7373 6f72 730a 235b 7079 6675  uccessors.#[pyfu
+00006280: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
+00006290: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+000062a0: 7068 2c20 6e6f 6465 2c20 2f29 225d 0a66  ph, node, /)"].f
+000062b0: 6e20 6266 735f 7375 6363 6573 736f 7273  n bfs_successors
+000062c0: 280a 2020 2020 7079 3a20 5079 7468 6f6e  (.    py: Python
+000062d0: 2c0a 2020 2020 6772 6170 683a 2026 6469  ,.    graph: &di
+000062e0: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
+000062f0: 2c0a 2020 2020 6e6f 6465 3a20 7573 697a  ,.    node: usiz
+00006300: 652c 0a29 202d 3e20 6974 6572 6174 6f72  e,.) -> iterator
+00006310: 733a 3a42 4653 5375 6363 6573 736f 7273  s::BFSSuccessors
+00006320: 207b 0a20 2020 206c 6574 2069 6e64 6578   {.    let index
+00006330: 203d 204e 6f64 6549 6e64 6578 3a3a 6e65   = NodeIndex::ne
+00006340: 7728 6e6f 6465 293b 0a20 2020 206c 6574  w(node);.    let
+00006350: 206d 7574 2062 6673 203d 2042 6673 3a3a   mut bfs = Bfs::
+00006360: 6e65 7728 6772 6170 682c 2069 6e64 6578  new(graph, index
+00006370: 293b 0a20 2020 206c 6574 206d 7574 206f  );.    let mut o
+00006380: 7574 5f6c 6973 743a 2056 6563 3c28 5079  ut_list: Vec<(Py
+00006390: 4f62 6a65 6374 2c20 5665 633c 5079 4f62  Object, Vec<PyOb
+000063a0: 6a65 6374 3e29 3e20 3d0a 2020 2020 2020  ject>)> =.      
+000063b0: 2020 5665 633a 3a77 6974 685f 6361 7061    Vec::with_capa
+000063c0: 6369 7479 2867 7261 7068 2e6e 6f64 655f  city(graph.node_
+000063d0: 636f 756e 7428 2929 3b0a 2020 2020 7768  count());.    wh
+000063e0: 696c 6520 6c65 7420 536f 6d65 286e 7829  ile let Some(nx)
+000063f0: 203d 2062 6673 2e6e 6578 7428 6772 6170   = bfs.next(grap
+00006400: 6829 207b 0a20 2020 2020 2020 206c 6574  h) {.        let
+00006410: 2063 6869 6c64 7265 6e20 3d20 6772 6170   children = grap
+00006420: 680a 2020 2020 2020 2020 2020 2020 2e67  h.            .g
+00006430: 7261 7068 0a20 2020 2020 2020 2020 2020  raph.           
+00006440: 202e 6e65 6967 6862 6f72 735f 6469 7265   .neighbors_dire
+00006450: 6374 6564 286e 782c 2070 6574 6772 6170  cted(nx, petgrap
+00006460: 683a 3a44 6972 6563 7469 6f6e 3a3a 4f75  h::Direction::Ou
+00006470: 7467 6f69 6e67 293b 0a20 2020 2020 2020  tgoing);.       
+00006480: 206c 6574 206d 7574 2073 7563 6365 736f   let mut succeso
+00006490: 7273 3a20 5665 633c 5079 4f62 6a65 6374  rs: Vec<PyObject
+000064a0: 3e20 3d20 5665 633a 3a6e 6577 2829 3b0a  > = Vec::new();.
+000064b0: 2020 2020 2020 2020 666f 7220 7375 6363          for succ
+000064c0: 2069 6e20 6368 696c 6472 656e 207b 0a20   in children {. 
+000064d0: 2020 2020 2020 2020 2020 2073 7563 6365             succe
+000064e0: 736f 7273 0a20 2020 2020 2020 2020 2020  sors.           
+000064f0: 2020 2020 202e 7075 7368 2867 7261 7068       .push(graph
+00006500: 2e67 7261 7068 2e6e 6f64 655f 7765 6967  .graph.node_weig
+00006510: 6874 2873 7563 6329 2e75 6e77 7261 7028  ht(succ).unwrap(
+00006520: 292e 636c 6f6e 655f 7265 6628 7079 2929  ).clone_ref(py))
+00006530: 3b0a 2020 2020 2020 2020 7d0a 2020 2020  ;.        }.    
+00006540: 2020 2020 6966 2021 7375 6363 6573 6f72      if !succesor
+00006550: 732e 6973 5f65 6d70 7479 2829 207b 0a20  s.is_empty() {. 
+00006560: 2020 2020 2020 2020 2020 206f 7574 5f6c             out_l
+00006570: 6973 742e 7075 7368 2828 0a20 2020 2020  ist.push((.     
+00006580: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+00006590: 2e67 7261 7068 2e6e 6f64 655f 7765 6967  .graph.node_weig
+000065a0: 6874 286e 7829 2e75 6e77 7261 7028 292e  ht(nx).unwrap().
+000065b0: 636c 6f6e 655f 7265 6628 7079 292c 0a20  clone_ref(py),. 
+000065c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000065d0: 7563 6365 736f 7273 2c0a 2020 2020 2020  uccesors,.      
+000065e0: 2020 2020 2020 2929 3b0a 2020 2020 2020        ));.      
+000065f0: 2020 7d0a 2020 2020 7d0a 2020 2020 6974    }.    }.    it
+00006600: 6572 6174 6f72 733a 3a42 4653 5375 6363  erators::BFSSucc
+00006610: 6573 736f 7273 207b 0a20 2020 2020 2020  essors {.       
+00006620: 2062 6673 5f73 7563 6365 7373 6f72 733a   bfs_successors:
+00006630: 206f 7574 5f6c 6973 742c 0a20 2020 207d   out_list,.    }
+00006640: 0a7d 0a0a 2f2f 2f20 5265 7475 726e 2074  .}../// Return t
+00006650: 6865 2061 6e63 6573 746f 7273 206f 6620  he ancestors of 
+00006660: 6120 6e6f 6465 2069 6e20 6120 6772 6170  a node in a grap
+00006670: 682e 0a2f 2f2f 0a2f 2f2f 2054 6869 7320  h..///./// This 
+00006680: 6469 6666 6572 7320 6672 6f6d 203a 6d65  differs from :me
+00006690: 7468 3a60 5079 4469 4772 6170 682e 7072  th:`PyDiGraph.pr
+000066a0: 6564 6563 6573 736f 7273 6020 6d65 7468  edecessors` meth
+000066b0: 6f64 2020 696e 2074 6861 740a 2f2f 2f20  od  in that./// 
+000066c0: 6060 7072 6564 6563 6573 736f 7273 6060  ``predecessors``
+000066d0: 2072 6574 7572 6e73 206f 6e6c 7920 6e6f   returns only no
+000066e0: 6465 7320 7769 7468 2061 2064 6972 6563  des with a direc
+000066f0: 7420 6564 6765 2069 6e74 6f20 7468 6520  t edge into the 
+00006700: 7072 6f76 6964 6564 0a2f 2f2f 206e 6f64  provided./// nod
+00006710: 652e 2057 6869 6c65 2074 6869 7320 6675  e. While this fu
+00006720: 6e63 7469 6f6e 2072 6574 7572 6e73 2061  nction returns a
+00006730: 6c6c 206e 6f64 6573 2074 6861 7420 6861  ll nodes that ha
+00006740: 7665 2061 2070 6174 6820 696e 746f 2074  ve a path into t
+00006750: 6865 0a2f 2f2f 2070 726f 7669 6465 6420  he./// provided 
+00006760: 6e6f 6465 2e0a 2f2f 2f0a 2f2f 2f20 3a70  node..///./// :p
+00006770: 6172 616d 2050 7944 6947 7261 7068 2067  aram PyDiGraph g
+00006780: 7261 7068 3a20 5468 6520 6772 6170 6820  raph: The graph 
+00006790: 746f 2067 6574 2074 6865 2064 6573 6365  to get the desce
+000067a0: 6e64 616e 7473 2066 726f 6d0a 2f2f 2f20  ndants from./// 
+000067b0: 3a70 6172 616d 2069 6e74 206e 6f64 653a  :param int node:
+000067c0: 2054 6865 2069 6e64 6578 206f 6620 7468   The index of th
+000067d0: 6520 6772 6170 6820 6e6f 6465 2074 6f20  e graph node to 
+000067e0: 6765 7420 7468 6520 616e 6365 7374 6f72  get the ancestor
+000067f0: 7320 666f 720a 2f2f 2f0a 2f2f 2f20 3a72  s for.///./// :r
+00006800: 6574 7572 6e73 3a20 4120 6c69 7374 206f  eturns: A list o
+00006810: 6620 6e6f 6465 2069 6e64 6578 6573 206f  f node indexes o
+00006820: 6620 616e 6365 7374 6f72 7320 6f66 2070  f ancestors of p
+00006830: 726f 7669 6465 6420 6e6f 6465 2e0a 2f2f  rovided node..//
+00006840: 2f20 3a72 7479 7065 3a20 6c69 7374 0a23  / :rtype: list.#
+00006850: 5b70 7966 756e 6374 696f 6e5d 0a23 5b74  [pyfunction].#[t
+00006860: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
+00006870: 2228 6772 6170 682c 206e 6f64 652c 202f  "(graph, node, /
+00006880: 2922 5d0a 666e 2061 6e63 6573 746f 7273  )"].fn ancestors
+00006890: 2867 7261 7068 3a20 2664 6967 7261 7068  (graph: &digraph
+000068a0: 3a3a 5079 4469 4772 6170 682c 206e 6f64  ::PyDiGraph, nod
+000068b0: 653a 2075 7369 7a65 2920 2d3e 2048 6173  e: usize) -> Has
+000068c0: 6853 6574 3c75 7369 7a65 3e20 7b0a 2020  hSet<usize> {.  
+000068d0: 2020 6c65 7420 696e 6465 7820 3d20 4e6f    let index = No
+000068e0: 6465 496e 6465 783a 3a6e 6577 286e 6f64  deIndex::new(nod
+000068f0: 6529 3b0a 2020 2020 6c65 7420 6d75 7420  e);.    let mut 
+00006900: 6f75 745f 7365 743a 2048 6173 6853 6574  out_set: HashSet
+00006910: 3c75 7369 7a65 3e20 3d20 4861 7368 5365  <usize> = HashSe
+00006920: 743a 3a6e 6577 2829 3b0a 2020 2020 6c65  t::new();.    le
+00006930: 7420 7265 7665 7273 655f 6772 6170 6820  t reverse_graph 
+00006940: 3d20 5265 7665 7273 6564 2867 7261 7068  = Reversed(graph
+00006950: 293b 0a20 2020 206c 6574 2072 6573 203d  );.    let res =
+00006960: 2061 6c67 6f3a 3a64 696a 6b73 7472 6128   algo::dijkstra(
+00006970: 7265 7665 7273 655f 6772 6170 682c 2069  reverse_graph, i
+00006980: 6e64 6578 2c20 4e6f 6e65 2c20 7c5f 7c20  ndex, None, |_| 
+00006990: 3129 3b0a 2020 2020 666f 7220 6e20 696e  1);.    for n in
+000069a0: 2072 6573 2e6b 6579 7328 2920 7b0a 2020   res.keys() {.  
+000069b0: 2020 2020 2020 6c65 7420 6e5f 696e 7420        let n_int 
+000069c0: 3d20 6e2e 696e 6465 7828 293b 0a20 2020  = n.index();.   
+000069d0: 2020 2020 206f 7574 5f73 6574 2e69 6e73       out_set.ins
+000069e0: 6572 7428 6e5f 696e 7429 3b0a 2020 2020  ert(n_int);.    
+000069f0: 7d0a 2020 2020 6f75 745f 7365 742e 7265  }.    out_set.re
+00006a00: 6d6f 7665 2826 6e6f 6465 293b 0a20 2020  move(&node);.   
+00006a10: 206f 7574 5f73 6574 0a7d 0a0a 2f2f 2f20   out_set.}../// 
+00006a20: 5265 7475 726e 2074 6865 2064 6573 6365  Return the desce
+00006a30: 6e64 616e 7473 206f 6620 6120 6e6f 6465  ndants of a node
+00006a40: 2069 6e20 6120 6772 6170 682e 0a2f 2f2f   in a graph..///
+00006a50: 0a2f 2f2f 2054 6869 7320 6469 6666 6572  ./// This differ
+00006a60: 7320 6672 6f6d 203a 6d65 7468 3a60 5079  s from :meth:`Py
+00006a70: 4469 4772 6170 682e 7375 6363 6573 736f  DiGraph.successo
+00006a80: 7273 6020 6d65 7468 6f64 2069 6e20 7468  rs` method in th
+00006a90: 6174 0a2f 2f2f 2060 6073 7563 6365 7373  at./// ``success
+00006aa0: 6f72 7360 6060 2072 6574 7572 6e73 206f  ors``` returns o
+00006ab0: 6e6c 7920 6e6f 6465 7320 7769 7468 2061  nly nodes with a
+00006ac0: 2064 6972 6563 7420 6564 6765 206f 7574   direct edge out
+00006ad0: 206f 6620 7468 6520 7072 6f76 6964 6564   of the provided
+00006ae0: 0a2f 2f2f 206e 6f64 652e 2057 6869 6c65  ./// node. While
+00006af0: 2074 6869 7320 6675 6e63 7469 6f6e 2072   this function r
+00006b00: 6574 7572 6e73 2061 6c6c 206e 6f64 6573  eturns all nodes
+00006b10: 2074 6861 7420 6861 7665 2061 2070 6174   that have a pat
+00006b20: 6820 6672 6f6d 2074 6865 0a2f 2f2f 2070  h from the./// p
+00006b30: 726f 7669 6465 6420 6e6f 6465 2e0a 2f2f  rovided node..//
+00006b40: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
+00006b50: 6947 7261 7068 2067 7261 7068 3a20 5468  iGraph graph: Th
+00006b60: 6520 6772 6170 6820 746f 2067 6574 2074  e graph to get t
+00006b70: 6865 2064 6573 6365 6e64 616e 7473 2066  he descendants f
+00006b80: 726f 6d0a 2f2f 2f20 3a70 6172 616d 2069  rom./// :param i
+00006b90: 6e74 206e 6f64 653a 2054 6865 2069 6e64  nt node: The ind
+00006ba0: 6578 206f 6620 7468 6520 6772 6170 6820  ex of the graph 
+00006bb0: 6e6f 6465 2074 6f20 6765 7420 7468 6520  node to get the 
+00006bc0: 6465 7363 656e 6461 6e74 7320 666f 720a  descendants for.
+00006bd0: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
+00006be0: 3a20 4120 6c69 7374 206f 6620 6e6f 6465  : A list of node
+00006bf0: 2069 6e64 6578 6573 206f 6620 6465 7363   indexes of desc
+00006c00: 656e 6461 6e74 7320 6f66 2070 726f 7669  endants of provi
+00006c10: 6465 6420 6e6f 6465 2e0a 2f2f 2f20 3a72  ded node../// :r
+00006c20: 7479 7065 3a20 6c69 7374 0a23 5b70 7966  type: list.#[pyf
+00006c30: 756e 6374 696f 6e5d 0a23 5b74 6578 745f  unction].#[text_
+00006c40: 7369 676e 6174 7572 6520 3d20 2228 6772  signature = "(gr
+00006c50: 6170 682c 206e 6f64 652c 202f 2922 5d0a  aph, node, /)"].
+00006c60: 666e 2064 6573 6365 6e64 616e 7473 2867  fn descendants(g
+00006c70: 7261 7068 3a20 2664 6967 7261 7068 3a3a  raph: &digraph::
+00006c80: 5079 4469 4772 6170 682c 206e 6f64 653a  PyDiGraph, node:
+00006c90: 2075 7369 7a65 2920 2d3e 2048 6173 6853   usize) -> HashS
+00006ca0: 6574 3c75 7369 7a65 3e20 7b0a 2020 2020  et<usize> {.    
+00006cb0: 6c65 7420 696e 6465 7820 3d20 4e6f 6465  let index = Node
+00006cc0: 496e 6465 783a 3a6e 6577 286e 6f64 6529  Index::new(node)
+00006cd0: 3b0a 2020 2020 6c65 7420 6d75 7420 6f75  ;.    let mut ou
+00006ce0: 745f 7365 743a 2048 6173 6853 6574 3c75  t_set: HashSet<u
+00006cf0: 7369 7a65 3e20 3d20 4861 7368 5365 743a  size> = HashSet:
+00006d00: 3a6e 6577 2829 3b0a 2020 2020 6c65 7420  :new();.    let 
+00006d10: 7265 7320 3d20 616c 676f 3a3a 6469 6a6b  res = algo::dijk
+00006d20: 7374 7261 2867 7261 7068 2c20 696e 6465  stra(graph, inde
+00006d30: 782c 204e 6f6e 652c 207c 5f7c 2031 293b  x, None, |_| 1);
+00006d40: 0a20 2020 2066 6f72 206e 2069 6e20 7265  .    for n in re
+00006d50: 732e 6b65 7973 2829 207b 0a20 2020 2020  s.keys() {.     
+00006d60: 2020 206c 6574 206e 5f69 6e74 203d 206e     let n_int = n
+00006d70: 2e69 6e64 6578 2829 3b0a 2020 2020 2020  .index();.      
+00006d80: 2020 6f75 745f 7365 742e 696e 7365 7274    out_set.insert
+00006d90: 286e 5f69 6e74 293b 0a20 2020 207d 0a20  (n_int);.    }. 
+00006da0: 2020 206f 7574 5f73 6574 2e72 656d 6f76     out_set.remov
+00006db0: 6528 266e 6f64 6529 3b0a 2020 2020 6f75  e(&node);.    ou
+00006dc0: 745f 7365 740a 7d0a 0a2f 2f2f 2047 6574  t_set.}../// Get
+00006dd0: 2074 6865 206c 6578 6963 6f67 7261 7068   the lexicograph
+00006de0: 6963 616c 2074 6f70 6f6c 6f67 6963 616c  ical topological
+00006df0: 2073 6f72 7465 6420 6e6f 6465 7320 6672   sorted nodes fr
+00006e00: 6f6d 2074 6865 2070 726f 7669 6465 6420  om the provided 
+00006e10: 4441 470a 2f2f 2f20 200a 2f2f 2f20 5468  DAG.///  ./// Th
+00006e20: 6973 2066 756e 6374 696f 6e20 7265 7475  is function retu
+00006e30: 726e 7320 6120 6c69 7374 206f 6620 6e6f  rns a list of no
+00006e40: 6465 7320 6461 7461 2069 6e20 6120 6772  des data in a gr
+00006e50: 6170 6820 6c65 7869 636f 6772 6170 6869  aph lexicographi
+00006e60: 6361 6c6c 790a 2f2f 2f20 746f 706f 6c6f  cally./// topolo
+00006e70: 6769 6361 6c6c 7920 736f 7274 6564 2075  gically sorted u
+00006e80: 7369 6e67 2074 6865 2070 726f 7669 6465  sing the provide
+00006e90: 6420 6b65 7920 6675 6e63 7469 6f6e 2e0a  d key function..
+00006ea0: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+00006eb0: 7944 6947 7261 7068 2064 6167 3a20 5468  yDiGraph dag: Th
+00006ec0: 6520 4441 4720 746f 2067 6574 2074 6865  e DAG to get the
+00006ed0: 2074 6f70 6f6c 6f67 6963 616c 2073 6f72   topological sor
+00006ee0: 7465 6420 6e6f 6465 7320 6672 6f6d 0a2f  ted nodes from./
+00006ef0: 2f2f 203a 7061 7261 6d20 6361 6c6c 6162  // :param callab
+00006f00: 6c65 206b 6579 3a20 6b65 7920 6973 2061  le key: key is a
+00006f10: 2070 7974 686f 6e20 6675 6e63 7469 6f6e   python function
+00006f20: 206f 7220 6f74 6865 7220 6361 6c6c 6162   or other callab
+00006f30: 6c65 2074 6861 740a 2f2f 2f20 2020 2020  le that.///     
+00006f40: 6765 7473 2070 6173 7365 6420 6120 7369  gets passed a si
+00006f50: 6e67 6c65 2061 7267 756d 656e 7420 7468  ngle argument th
+00006f60: 6520 6e6f 6465 2064 6174 6120 6672 6f6d  e node data from
+00006f70: 2074 6865 2067 7261 7068 2061 6e64 2069   the graph and i
+00006f80: 730a 2f2f 2f20 2020 2020 6578 7065 6374  s.///     expect
+00006f90: 6564 2074 6f20 7265 7475 726e 2061 2073  ed to return a s
+00006fa0: 7472 696e 6720 7768 6963 6820 7769 6c6c  tring which will
+00006fb0: 2062 6520 7573 6564 2066 6f72 2073 6f72   be used for sor
+00006fc0: 7469 6e67 2e0a 2f2f 2f0a 2f2f 2f20 3a72  ting..///./// :r
+00006fd0: 6574 7572 6e73 3a20 4120 6c69 7374 206f  eturns: A list o
+00006fe0: 6620 6e6f 6465 2773 2064 6174 6120 6c65  f node's data le
+00006ff0: 7869 636f 6772 6170 6869 6361 6c6c 7920  xicographically 
+00007000: 746f 706f 6c6f 6769 6361 6c6c 7920 736f  topologically so
+00007010: 7274 6564 2e0a 2f2f 2f20 3a72 7479 7065  rted../// :rtype
+00007020: 3a20 6c69 7374 0a23 5b70 7966 756e 6374  : list.#[pyfunct
+00007030: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
+00007040: 6174 7572 6520 3d20 2228 6461 672c 206b  ature = "(dag, k
+00007050: 6579 2c20 2f29 225d 0a66 6e20 6c65 7869  ey, /)"].fn lexi
+00007060: 636f 6772 6170 6869 6361 6c5f 746f 706f  cographical_topo
+00007070: 6c6f 6769 6361 6c5f 736f 7274 280a 2020  logical_sort(.  
+00007080: 2020 7079 3a20 5079 7468 6f6e 2c0a 2020    py: Python,.  
+00007090: 2020 6461 673a 2026 6469 6772 6170 683a    dag: &digraph:
+000070a0: 3a50 7944 6947 7261 7068 2c0a 2020 2020  :PyDiGraph,.    
+000070b0: 6b65 793a 2050 794f 626a 6563 742c 0a29  key: PyObject,.)
+000070c0: 202d 3e20 5079 5265 7375 6c74 3c50 794f   -> PyResult<PyO
+000070d0: 626a 6563 743e 207b 0a20 2020 206c 6574  bject> {.    let
+000070e0: 206b 6579 5f63 616c 6c61 626c 6520 3d20   key_callable = 
+000070f0: 7c61 3a20 2650 794f 626a 6563 747c 202d  |a: &PyObject| -
+00007100: 3e20 5079 5265 7375 6c74 3c50 794f 626a  > PyResult<PyObj
+00007110: 6563 743e 207b 0a20 2020 2020 2020 206c  ect> {.        l
+00007120: 6574 2072 6573 203d 206b 6579 2e63 616c  et res = key.cal
+00007130: 6c31 2870 792c 2028 612c 2929 3f3b 0a20  l1(py, (a,))?;. 
+00007140: 2020 2020 2020 204f 6b28 7265 732e 746f         Ok(res.to
+00007150: 5f6f 626a 6563 7428 7079 2929 0a20 2020  _object(py)).   
+00007160: 207d 3b0a 2020 2020 2f2f 2048 6173 684d   };.    // HashM
+00007170: 6170 206f 6620 6e6f 6465 5f69 6e64 6578  ap of node_index
+00007180: 2069 6e64 6567 7265 650a 2020 2020 6c65   indegree.    le
+00007190: 7420 6e6f 6465 5f63 6f75 6e74 203d 2064  t node_count = d
+000071a0: 6167 2e6e 6f64 655f 636f 756e 7428 293b  ag.node_count();
+000071b0: 0a20 2020 206c 6574 206d 7574 2069 6e5f  .    let mut in_
+000071c0: 6465 6772 6565 5f6d 6170 3a20 4861 7368  degree_map: Hash
+000071d0: 4d61 703c 4e6f 6465 496e 6465 782c 2075  Map<NodeIndex, u
+000071e0: 7369 7a65 3e20 3d0a 2020 2020 2020 2020  size> =.        
+000071f0: 4861 7368 4d61 703a 3a77 6974 685f 6361  HashMap::with_ca
+00007200: 7061 6369 7479 286e 6f64 655f 636f 756e  pacity(node_coun
+00007210: 7429 3b0a 2020 2020 666f 7220 6e6f 6465  t);.    for node
+00007220: 2069 6e20 6461 672e 6772 6170 682e 6e6f   in dag.graph.no
+00007230: 6465 5f69 6e64 6963 6573 2829 207b 0a20  de_indices() {. 
+00007240: 2020 2020 2020 2069 6e5f 6465 6772 6565         in_degree
+00007250: 5f6d 6170 2e69 6e73 6572 7428 6e6f 6465  _map.insert(node
+00007260: 2c20 6461 672e 696e 5f64 6567 7265 6528  , dag.in_degree(
+00007270: 6e6f 6465 2e69 6e64 6578 2829 2929 3b0a  node.index()));.
+00007280: 2020 2020 7d0a 0a20 2020 2023 5b64 6572      }..    #[der
+00007290: 6976 6528 436c 6f6e 652c 2045 712c 2050  ive(Clone, Eq, P
+000072a0: 6172 7469 616c 4571 295d 0a20 2020 2073  artialEq)].    s
+000072b0: 7472 7563 7420 5374 6174 6520 7b0a 2020  truct State {.  
+000072c0: 2020 2020 2020 6b65 793a 2053 7472 696e        key: Strin
+000072d0: 672c 0a20 2020 2020 2020 206e 6f64 653a  g,.        node:
+000072e0: 204e 6f64 6549 6e64 6578 2c0a 2020 2020   NodeIndex,.    
+000072f0: 7d0a 0a20 2020 2069 6d70 6c20 4f72 6420  }..    impl Ord 
+00007300: 666f 7220 5374 6174 6520 7b0a 2020 2020  for State {.    
+00007310: 2020 2020 666e 2063 6d70 2826 7365 6c66      fn cmp(&self
+00007320: 2c20 6f74 6865 723a 2026 5374 6174 6529  , other: &State)
+00007330: 202d 3e20 4f72 6465 7269 6e67 207b 0a20   -> Ordering {. 
+00007340: 2020 2020 2020 2020 2020 202f 2f20 4e6f             // No
+00007350: 7469 6365 2074 6861 7420 7468 6520 7765  tice that the we
+00007360: 2066 6c69 7020 7468 6520 6f72 6465 7269   flip the orderi
+00007370: 6e67 206f 6e20 636f 7374 732e 0a20 2020  ng on costs..   
+00007380: 2020 2020 2020 2020 202f 2f20 496e 2063           // In c
+00007390: 6173 6520 6f66 2061 2074 6965 2077 6520  ase of a tie we 
+000073a0: 636f 6d70 6172 6520 706f 7369 7469 6f6e  compare position
+000073b0: 7320 2d20 7468 6973 2073 7465 7020 6973  s - this step is
+000073c0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
+000073d0: 2020 2020 2020 202f 2f20 746f 206d 616b         // to mak
+000073e0: 6520 696d 706c 656d 656e 7461 7469 6f6e  e implementation
+000073f0: 7320 6f66 2060 5061 7274 6961 6c45 7160  s of `PartialEq`
+00007400: 2061 6e64 2060 4f72 6460 2063 6f6e 7369   and `Ord` consi
+00007410: 7374 656e 742e 0a20 2020 2020 2020 2020  stent..         
+00007420: 2020 206f 7468 6572 0a20 2020 2020 2020     other.       
+00007430: 2020 2020 2020 2020 202e 6b65 790a 2020           .key.  
+00007440: 2020 2020 2020 2020 2020 2020 2020 2e63                .c
+00007450: 6d70 2826 7365 6c66 2e6b 6579 290a 2020  mp(&self.key).  
+00007460: 2020 2020 2020 2020 2020 2020 2020 2e74                .t
+00007470: 6865 6e5f 7769 7468 287c 7c20 6f74 6865  hen_with(|| othe
+00007480: 722e 6e6f 6465 2e69 6e64 6578 2829 2e63  r.node.index().c
+00007490: 6d70 2826 7365 6c66 2e6e 6f64 652e 696e  mp(&self.node.in
+000074a0: 6465 7828 2929 290a 2020 2020 2020 2020  dex())).        
+000074b0: 7d0a 2020 2020 7d0a 0a20 2020 202f 2f20  }.    }..    // 
+000074c0: 6050 6172 7469 616c 4f72 6460 206e 6565  `PartialOrd` nee
+000074d0: 6473 2074 6f20 6265 2069 6d70 6c65 6d65  ds to be impleme
+000074e0: 6e74 6564 2061 7320 7765 6c6c 2e0a 2020  nted as well..  
+000074f0: 2020 696d 706c 2050 6172 7469 616c 4f72    impl PartialOr
+00007500: 6420 666f 7220 5374 6174 6520 7b0a 2020  d for State {.  
+00007510: 2020 2020 2020 666e 2070 6172 7469 616c        fn partial
+00007520: 5f63 6d70 2826 7365 6c66 2c20 6f74 6865  _cmp(&self, othe
+00007530: 723a 2026 5374 6174 6529 202d 3e20 4f70  r: &State) -> Op
+00007540: 7469 6f6e 3c4f 7264 6572 696e 673e 207b  tion<Ordering> {
+00007550: 0a20 2020 2020 2020 2020 2020 2053 6f6d  .            Som
+00007560: 6528 7365 6c66 2e63 6d70 286f 7468 6572  e(self.cmp(other
+00007570: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
+00007580: 207d 0a20 2020 206c 6574 206d 7574 207a   }.    let mut z
+00007590: 6572 6f5f 696e 6465 6772 6565 203d 2042  ero_indegree = B
+000075a0: 696e 6172 7948 6561 703a 3a77 6974 685f  inaryHeap::with_
+000075b0: 6361 7061 6369 7479 286e 6f64 655f 636f  capacity(node_co
+000075c0: 756e 7429 3b0a 2020 2020 666f 7220 286e  unt);.    for (n
+000075d0: 6f64 652c 2064 6567 7265 6529 2069 6e20  ode, degree) in 
+000075e0: 696e 5f64 6567 7265 655f 6d61 702e 6974  in_degree_map.it
+000075f0: 6572 2829 207b 0a20 2020 2020 2020 2069  er() {.        i
+00007600: 6620 2a64 6567 7265 6520 3d3d 2030 207b  f *degree == 0 {
+00007610: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00007620: 206d 6170 5f6b 6579 5f72 6177 203d 206b   map_key_raw = k
+00007630: 6579 5f63 616c 6c61 626c 6528 2664 6167  ey_callable(&dag
+00007640: 2e67 7261 7068 5b2a 6e6f 6465 5d29 3f3b  .graph[*node])?;
+00007650: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00007660: 206d 6170 5f6b 6579 3a20 5374 7269 6e67   map_key: String
+00007670: 203d 206d 6170 5f6b 6579 5f72 6177 2e65   = map_key_raw.e
+00007680: 7874 7261 6374 2870 7929 3f3b 0a20 2020  xtract(py)?;.   
+00007690: 2020 2020 2020 2020 207a 6572 6f5f 696e           zero_in
+000076a0: 6465 6772 6565 2e70 7573 6828 5374 6174  degree.push(Stat
+000076b0: 6520 7b0a 2020 2020 2020 2020 2020 2020  e {.            
+000076c0: 2020 2020 6b65 793a 206d 6170 5f6b 6579      key: map_key
+000076d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000076e0: 2020 6e6f 6465 3a20 2a6e 6f64 652c 0a20    node: *node,. 
+000076f0: 2020 2020 2020 2020 2020 207d 293b 0a20             });. 
+00007700: 2020 2020 2020 207d 0a20 2020 207d 0a20         }.    }. 
+00007710: 2020 206c 6574 206d 7574 206f 7574 5f6c     let mut out_l
+00007720: 6973 743a 2056 6563 3c26 5079 4f62 6a65  ist: Vec<&PyObje
+00007730: 6374 3e20 3d20 5665 633a 3a77 6974 685f  ct> = Vec::with_
+00007740: 6361 7061 6369 7479 286e 6f64 655f 636f  capacity(node_co
+00007750: 756e 7429 3b0a 2020 2020 6c65 7420 6469  unt);.    let di
+00007760: 7220 3d20 7065 7467 7261 7068 3a3a 4469  r = petgraph::Di
+00007770: 7265 6374 696f 6e3a 3a4f 7574 676f 696e  rection::Outgoin
+00007780: 673b 0a20 2020 2077 6869 6c65 206c 6574  g;.    while let
+00007790: 2053 6f6d 6528 5374 6174 6520 7b20 6e6f   Some(State { no
+000077a0: 6465 2c20 2e2e 207d 2920 3d20 7a65 726f  de, .. }) = zero
+000077b0: 5f69 6e64 6567 7265 652e 706f 7028 2920  _indegree.pop() 
+000077c0: 7b0a 2020 2020 2020 2020 6c65 7420 6e65  {.        let ne
+000077d0: 6967 6862 6f72 7320 3d20 6461 672e 6772  ighbors = dag.gr
+000077e0: 6170 682e 6e65 6967 6862 6f72 735f 6469  aph.neighbors_di
+000077f0: 7265 6374 6564 286e 6f64 652c 2064 6972  rected(node, dir
+00007800: 293b 0a20 2020 2020 2020 2066 6f72 2063  );.        for c
+00007810: 6869 6c64 2069 6e20 6e65 6967 6862 6f72  hild in neighbor
+00007820: 7320 7b0a 2020 2020 2020 2020 2020 2020  s {.            
+00007830: 6c65 7420 6368 696c 645f 6465 6772 6565  let child_degree
+00007840: 203d 2069 6e5f 6465 6772 6565 5f6d 6170   = in_degree_map
+00007850: 2e67 6574 5f6d 7574 2826 6368 696c 6429  .get_mut(&child)
+00007860: 2e75 6e77 7261 7028 293b 0a20 2020 2020  .unwrap();.     
+00007870: 2020 2020 2020 202a 6368 696c 645f 6465         *child_de
+00007880: 6772 6565 202d 3d20 313b 0a20 2020 2020  gree -= 1;.     
+00007890: 2020 2020 2020 2069 6620 2a63 6869 6c64         if *child
+000078a0: 5f64 6567 7265 6520 3d3d 2030 207b 0a20  _degree == 0 {. 
+000078b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000078c0: 6574 206d 6170 5f6b 6579 5f72 6177 203d  et map_key_raw =
+000078d0: 206b 6579 5f63 616c 6c61 626c 6528 2664   key_callable(&d
+000078e0: 6167 2e67 7261 7068 5b63 6869 6c64 5d29  ag.graph[child])
+000078f0: 3f3b 0a20 2020 2020 2020 2020 2020 2020  ?;.             
+00007900: 2020 206c 6574 206d 6170 5f6b 6579 3a20     let map_key: 
+00007910: 5374 7269 6e67 203d 206d 6170 5f6b 6579  String = map_key
+00007920: 5f72 6177 2e65 7874 7261 6374 2870 7929  _raw.extract(py)
+00007930: 3f3b 0a20 2020 2020 2020 2020 2020 2020  ?;.             
+00007940: 2020 207a 6572 6f5f 696e 6465 6772 6565     zero_indegree
+00007950: 2e70 7573 6828 5374 6174 6520 7b0a 2020  .push(State {.  
 00007960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007970: 7d3b 0a20 2020 2020 2020 2020 2020 2020  };.             
-00007980: 2020 2069 6620 755f 775f 6469 7374 203d     if u_w_dist =
-00007990: 3d20 7374 643a 3a75 7369 7a65 3a3a 4d41  = std::usize::MA
-000079a0: 5820 7c7c 2077 5f76 5f64 6973 7420 3d3d  X || w_v_dist ==
-000079b0: 2073 7464 3a3a 7573 697a 653a 3a4d 4158   std::usize::MAX
-000079c0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000079d0: 2020 2020 2020 202f 2f20 4176 6f69 6420         // Avoid 
-000079e0: 6f76 6572 666c 6f77 210a 2020 2020 2020  overflow!.      
-000079f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00007a00: 6e74 696e 7565 3b0a 2020 2020 2020 2020  ntinue;.        
-00007a10: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00007a20: 2020 2020 2020 2020 2020 6966 2075 5f76            if u_v
-00007a30: 5f64 6973 7420 3e20 755f 775f 6469 7374  _dist > u_w_dist
-00007a40: 202b 2077 5f76 5f64 6973 7420 7b0a 2020   + w_v_dist {.  
-00007a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a60: 2020 6469 7374 2e69 6e73 6572 7428 2875    dist.insert((u
-00007a70: 2e69 6e64 6578 2829 2c20 762e 696e 6465  .index(), v.inde
-00007a80: 7828 2929 2c20 755f 775f 6469 7374 202b  x()), u_w_dist +
-00007a90: 2077 5f76 5f64 6973 7429 3b0a 2020 2020   w_v_dist);.    
-00007aa0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00007ab0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-00007ac0: 2020 2020 7d0a 2020 2020 7d0a 0a20 2020      }.    }..   
-00007ad0: 202f 2f20 536f 6d65 2072 652d 666f 726d   // Some re-form
-00007ae0: 6174 7469 6e67 2066 6f72 2050 7974 686f  atting for Pytho
-00007af0: 6e3a 2044 6963 745b 696e 742c 2044 6963  n: Dict[int, Dic
-00007b00: 745b 696e 742c 2069 6e74 5d5d 0a20 2020  t[int, int]].   
-00007b10: 206c 6574 206f 7574 5f64 6963 7420 3d20   let out_dict = 
-00007b20: 5079 4469 6374 3a3a 6e65 7728 7079 293b  PyDict::new(py);
-00007b30: 0a20 2020 2066 6f72 2028 6e6f 6465 732c  .    for (nodes,
-00007b40: 2064 6973 7461 6e63 6529 2069 6e20 6469   distance) in di
-00007b50: 7374 207b 0a20 2020 2020 2020 206c 6574  st {.        let
-00007b60: 2075 5f69 6e64 6578 203d 206e 6f64 6573   u_index = nodes
-00007b70: 2e30 3b0a 2020 2020 2020 2020 6c65 7420  .0;.        let 
-00007b80: 765f 696e 6465 7820 3d20 6e6f 6465 732e  v_index = nodes.
-00007b90: 313b 0a20 2020 2020 2020 2069 6620 6f75  1;.        if ou
-00007ba0: 745f 6469 6374 2e63 6f6e 7461 696e 7328  t_dict.contains(
-00007bb0: 755f 696e 6465 7829 3f20 7b0a 2020 2020  u_index)? {.    
-00007bc0: 2020 2020 2020 2020 6c65 7420 755f 6469          let u_di
-00007bd0: 6374 203d 0a20 2020 2020 2020 2020 2020  ct =.           
-00007be0: 2020 2020 206f 7574 5f64 6963 742e 6765       out_dict.ge
-00007bf0: 745f 6974 656d 2875 5f69 6e64 6578 292e  t_item(u_index).
-00007c00: 756e 7772 6170 2829 2e64 6f77 6e63 6173  unwrap().downcas
-00007c10: 743a 3a3c 5079 4469 6374 3e28 293f 3b0a  t::<PyDict>()?;.
-00007c20: 2020 2020 2020 2020 2020 2020 755f 6469              u_di
-00007c30: 6374 2e73 6574 5f69 7465 6d28 765f 696e  ct.set_item(v_in
-00007c40: 6465 782c 2064 6973 7461 6e63 6529 3f3b  dex, distance)?;
-00007c50: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00007c60: 5f64 6963 742e 7365 745f 6974 656d 2875  _dict.set_item(u
-00007c70: 5f69 6e64 6578 2c20 755f 6469 6374 293f  _index, u_dict)?
-00007c80: 3b0a 2020 2020 2020 2020 7d20 656c 7365  ;.        } else
-00007c90: 207b 0a20 2020 2020 2020 2020 2020 206c   {.            l
-00007ca0: 6574 2075 5f64 6963 7420 3d20 5079 4469  et u_dict = PyDi
-00007cb0: 6374 3a3a 6e65 7728 7079 293b 0a20 2020  ct::new(py);.   
-00007cc0: 2020 2020 2020 2020 2075 5f64 6963 742e           u_dict.
-00007cd0: 7365 745f 6974 656d 2876 5f69 6e64 6578  set_item(v_index
-00007ce0: 2c20 6469 7374 616e 6365 293f 3b0a 2020  , distance)?;.  
-00007cf0: 2020 2020 2020 2020 2020 6f75 745f 6469            out_di
-00007d00: 6374 2e73 6574 5f69 7465 6d28 755f 696e  ct.set_item(u_in
-00007d10: 6465 782c 2075 5f64 6963 7429 3f3b 0a20  dex, u_dict)?;. 
-00007d20: 2020 2020 2020 207d 0a20 2020 207d 0a20         }.    }. 
-00007d30: 2020 204f 6b28 6f75 745f 6469 6374 2e69     Ok(out_dict.i
-00007d40: 6e74 6f28 2929 0a7d 0a0a 666e 2067 6574  nto()).}..fn get
-00007d50: 5f65 6467 655f 6974 6572 5f77 6974 685f  _edge_iter_with_
-00007d60: 7765 6967 6874 733c 473e 280a 2020 2020  weights<G>(.    
-00007d70: 6772 6170 683a 2047 2c0a 2920 2d3e 2069  graph: G,.) -> i
-00007d80: 6d70 6c20 4974 6572 6174 6f72 3c49 7465  mpl Iterator<Ite
-00007d90: 6d20 3d20 2875 7369 7a65 2c20 7573 697a  m = (usize, usiz
-00007da0: 652c 2050 794f 626a 6563 7429 3e0a 7768  e, PyObject)>.wh
-00007db0: 6572 650a 2020 2020 473a 2047 7261 7068  ere.    G: Graph
-00007dc0: 4261 7365 0a20 2020 2020 2020 202b 2049  Base.        + I
-00007dd0: 6e74 6f45 6467 6552 6566 6572 656e 6365  ntoEdgeReference
-00007de0: 730a 2020 2020 2020 2020 2b20 496e 746f  s.        + Into
-00007df0: 4e6f 6465 4964 656e 7469 6669 6572 730a  NodeIdentifiers.
-00007e00: 2020 2020 2020 2020 2b20 4e6f 6465 496e          + NodeIn
-00007e10: 6465 7861 626c 650a 2020 2020 2020 2020  dexable.        
-00007e20: 2b20 4e6f 6465 436f 756e 740a 2020 2020  + NodeCount.    
-00007e30: 2020 2020 2b20 4772 6170 6850 726f 700a      + GraphProp.
-00007e40: 2020 2020 2020 2020 2b20 4e6f 6465 7352          + NodesR
-00007e50: 656d 6f76 6564 2c0a 2020 2020 473a 2044  emoved,.    G: D
-00007e60: 6174 613c 4e6f 6465 5765 6967 6874 203d  ata<NodeWeight =
-00007e70: 2050 794f 626a 6563 742c 2045 6467 6557   PyObject, EdgeW
-00007e80: 6569 6768 7420 3d20 5079 4f62 6a65 6374  eight = PyObject
-00007e90: 3e2c 0a7b 0a20 2020 206c 6574 206e 6f64  >,.{.    let nod
-00007ea0: 655f 6d61 703a 204f 7074 696f 6e3c 4861  e_map: Option<Ha
-00007eb0: 7368 4d61 703c 4e6f 6465 496e 6465 782c  shMap<NodeIndex,
-00007ec0: 2075 7369 7a65 3e3e 3b0a 2020 2020 6966   usize>>;.    if
-00007ed0: 2067 7261 7068 2e6e 6f64 6573 5f72 656d   graph.nodes_rem
-00007ee0: 6f76 6564 2829 207b 0a20 2020 2020 2020  oved() {.       
-00007ef0: 206c 6574 206d 7574 206e 6f64 655f 6861   let mut node_ha
-00007f00: 7368 5f6d 6170 3a20 4861 7368 4d61 703c  sh_map: HashMap<
-00007f10: 4e6f 6465 496e 6465 782c 2075 7369 7a65  NodeIndex, usize
-00007f20: 3e20 3d0a 2020 2020 2020 2020 2020 2020  > =.            
-00007f30: 4861 7368 4d61 703a 3a77 6974 685f 6361  HashMap::with_ca
-00007f40: 7061 6369 7479 2867 7261 7068 2e6e 6f64  pacity(graph.nod
-00007f50: 655f 636f 756e 7428 2929 3b0a 2020 2020  e_count());.    
-00007f60: 2020 2020 666f 7220 2863 6f75 6e74 2c20      for (count, 
-00007f70: 6e6f 6465 2920 696e 2067 7261 7068 2e6e  node) in graph.n
-00007f80: 6f64 655f 6964 656e 7469 6669 6572 7328  ode_identifiers(
-00007f90: 292e 656e 756d 6572 6174 6528 2920 7b0a  ).enumerate() {.
-00007fa0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00007fb0: 696e 6465 7820 3d20 4e6f 6465 496e 6465  index = NodeInde
-00007fc0: 783a 3a6e 6577 2867 7261 7068 2e74 6f5f  x::new(graph.to_
-00007fd0: 696e 6465 7828 6e6f 6465 2929 3b0a 2020  index(node));.  
-00007fe0: 2020 2020 2020 2020 2020 6e6f 6465 5f68            node_h
-00007ff0: 6173 685f 6d61 702e 696e 7365 7274 2869  ash_map.insert(i
-00008000: 6e64 6578 2c20 636f 756e 7429 3b0a 2020  ndex, count);.  
-00008010: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00008020: 6e6f 6465 5f6d 6170 203d 2053 6f6d 6528  node_map = Some(
-00008030: 6e6f 6465 5f68 6173 685f 6d61 7029 3b0a  node_hash_map);.
-00008040: 2020 2020 7d20 656c 7365 207b 0a20 2020      } else {.   
-00008050: 2020 2020 206e 6f64 655f 6d61 7020 3d20       node_map = 
-00008060: 4e6f 6e65 3b0a 2020 2020 7d0a 0a20 2020  None;.    }..   
-00008070: 2067 7261 7068 2e65 6467 655f 7265 6665   graph.edge_refe
-00008080: 7265 6e63 6573 2829 2e6d 6170 286d 6f76  rences().map(mov
-00008090: 6520 7c65 6467 657c 207b 0a20 2020 2020  e |edge| {.     
-000080a0: 2020 206c 6574 2069 3a20 7573 697a 653b     let i: usize;
-000080b0: 0a20 2020 2020 2020 206c 6574 206a 3a20  .        let j: 
-000080c0: 7573 697a 653b 0a20 2020 2020 2020 206d  usize;.        m
-000080d0: 6174 6368 2026 6e6f 6465 5f6d 6170 207b  atch &node_map {
-000080e0: 0a20 2020 2020 2020 2020 2020 2053 6f6d  .            Som
-000080f0: 6528 6d61 7029 203d 3e20 7b0a 2020 2020  e(map) => {.    
-00008100: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00008110: 736f 7572 6365 5f69 6e64 6578 203d 0a20  source_index =. 
-00008120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008130: 2020 204e 6f64 6549 6e64 6578 3a3a 6e65     NodeIndex::ne
-00008140: 7728 6772 6170 682e 746f 5f69 6e64 6578  w(graph.to_index
-00008150: 2865 6467 652e 736f 7572 6365 2829 2929  (edge.source()))
-00008160: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00008170: 2020 6c65 7420 7461 7267 6574 5f69 6e64    let target_ind
-00008180: 6578 203d 0a20 2020 2020 2020 2020 2020  ex =.           
-00008190: 2020 2020 2020 2020 204e 6f64 6549 6e64           NodeInd
-000081a0: 6578 3a3a 6e65 7728 6772 6170 682e 746f  ex::new(graph.to
-000081b0: 5f69 6e64 6578 2865 6467 652e 7461 7267  _index(edge.targ
-000081c0: 6574 2829 2929 3b0a 2020 2020 2020 2020  et()));.        
-000081d0: 2020 2020 2020 2020 6920 3d20 2a6d 6170          i = *map
-000081e0: 2e67 6574 2826 736f 7572 6365 5f69 6e64  .get(&source_ind
-000081f0: 6578 292e 756e 7772 6170 2829 3b0a 2020  ex).unwrap();.  
-00008200: 2020 2020 2020 2020 2020 2020 2020 6a20                j 
-00008210: 3d20 2a6d 6170 2e67 6574 2826 7461 7267  = *map.get(&targ
-00008220: 6574 5f69 6e64 6578 292e 756e 7772 6170  et_index).unwrap
-00008230: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
-00008240: 7d0a 2020 2020 2020 2020 2020 2020 4e6f  }.            No
-00008250: 6e65 203d 3e20 7b0a 2020 2020 2020 2020  ne => {.        
-00008260: 2020 2020 2020 2020 6920 3d20 6772 6170          i = grap
-00008270: 682e 746f 5f69 6e64 6578 2865 6467 652e  h.to_index(edge.
-00008280: 736f 7572 6365 2829 293b 0a20 2020 2020  source());.     
-00008290: 2020 2020 2020 2020 2020 206a 203d 2067             j = g
-000082a0: 7261 7068 2e74 6f5f 696e 6465 7828 6564  raph.to_index(ed
-000082b0: 6765 2e74 6172 6765 7428 2929 3b0a 2020  ge.target());.  
-000082c0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-000082d0: 2020 2020 7d0a 2020 2020 2020 2020 2869      }.        (i
-000082e0: 2c20 6a2c 2065 6467 652e 7765 6967 6874  , j, edge.weight
-000082f0: 2829 2e63 6c6f 6e65 2829 290a 2020 2020  ().clone()).    
-00008300: 7d29 0a7d 0a0a 2f2f 2f20 4669 6e64 2061  }).}../// Find a
-00008310: 6c6c 2d70 6169 7273 2073 686f 7274 6573  ll-pairs shortes
-00008320: 7420 7061 7468 206c 656e 6774 6873 2075  t path lengths u
-00008330: 7369 6e67 2046 6c6f 7964 2773 2061 6c67  sing Floyd's alg
-00008340: 6f72 6974 686d 0a2f 2f2f 0a2f 2f2f 2046  orithm.///./// F
-00008350: 6c6f 7964 2773 2061 6c67 6f72 6974 686d  loyd's algorithm
-00008360: 2069 7320 7573 6564 2066 6f72 2066 696e   is used for fin
-00008370: 6469 6e67 2073 686f 7274 6573 7420 7061  ding shortest pa
-00008380: 7468 7320 696e 2064 656e 7365 2067 7261  ths in dense gra
-00008390: 7068 730a 2f2f 2f20 6f72 2067 7261 7068  phs./// or graph
-000083a0: 7320 7769 7468 206e 6567 6174 6976 6520  s with negative 
-000083b0: 7765 6967 6874 7320 2877 6865 7265 2044  weights (where D
-000083c0: 696a 6b73 7472 6127 7320 616c 676f 7269  ijkstra's algori
-000083d0: 7468 6d20 6661 696c 7329 2e0a 2f2f 2f0a  thm fails)..///.
-000083e0: 2f2f 2f20 3a70 6172 616d 2050 7947 7261  /// :param PyGra
-000083f0: 7068 2067 7261 7068 3a20 5468 6520 6772  ph graph: The gr
-00008400: 6170 6820 746f 2072 756e 2046 6c6f 7964  aph to run Floyd
-00008410: 2773 2061 6c67 6f72 6974 686d 206f 6e0a  's algorithm on.
-00008420: 2f2f 2f20 3a70 6172 616d 2077 6569 6768  /// :param weigh
-00008430: 745f 666e 3a20 4120 6361 6c6c 6162 6c65  t_fn: A callable
-00008440: 206f 626a 6563 7420 2866 756e 6374 696f   object (functio
-00008450: 6e2c 206c 616d 6264 612c 2065 7463 2920  n, lambda, etc) 
-00008460: 7768 6963 680a 2f2f 2f20 2020 2020 7769  which.///     wi
-00008470: 6c6c 2062 6520 7061 7373 6564 2074 6865  ll be passed the
-00008480: 2065 6467 6520 6f62 6a65 6374 2061 6e64   edge object and
-00008490: 2065 7870 6563 7465 6420 746f 2072 6574   expected to ret
-000084a0: 7572 6e20 6120 6060 666c 6f61 7460 602e  urn a ``float``.
-000084b0: 2054 6869 730a 2f2f 2f20 2020 2020 7465   This.///     te
-000084c0: 6c6c 7320 7265 7477 6f72 6b78 2f72 7573  lls retworkx/rus
-000084d0: 7420 686f 7720 746f 2065 7874 7261 6374  t how to extract
-000084e0: 2061 206e 756d 6572 6963 616c 2077 6569   a numerical wei
-000084f0: 6768 7420 6173 2061 2060 6066 6c6f 6174  ght as a ``float
-00008500: 6060 0a2f 2f2f 2020 2020 2066 6f72 2065  ``.///     for e
-00008510: 6467 6520 6f62 6a65 6374 2e20 536f 6d65  dge object. Some
-00008520: 2073 696d 706c 6520 6578 616d 706c 6573   simple examples
-00008530: 2061 7265 3a3a 0a2f 2f2f 0a2f 2f2f 2020   are::.///.///  
-00008540: 2020 2020 2020 2067 7261 7068 5f66 6c6f         graph_flo
-00008550: 7964 5f77 6172 7368 616c 6c5f 6e75 6d70  yd_warshall_nump
-00008560: 7928 6772 6170 682c 2077 6569 6768 745f  y(graph, weight_
-00008570: 666e 3a20 6c61 6d62 6461 2078 3a20 3129  fn: lambda x: 1)
-00008580: 0a2f 2f2f 0a2f 2f2f 2020 2020 2074 6f20  .///.///     to 
-00008590: 7265 7475 726e 2061 2077 6569 6768 7420  return a weight 
-000085a0: 6f66 2031 2066 6f72 2061 6c6c 2065 6467  of 1 for all edg
-000085b0: 6573 2e20 416c 736f 3a3a 0a2f 2f2f 0a2f  es. Also::.///./
-000085c0: 2f2f 2020 2020 2020 2020 2067 7261 7068  //         graph
-000085d0: 5f66 6c6f 7964 5f77 6172 7368 616c 6c5f  _floyd_warshall_
-000085e0: 6e75 6d70 7928 6772 6170 682c 2077 6569  numpy(graph, wei
-000085f0: 6768 745f 666e 3a20 6c61 6d62 6461 2078  ght_fn: lambda x
-00008600: 3a20 666c 6f61 7428 7829 290a 2f2f 2f0a  : float(x)).///.
-00008610: 2f2f 2f20 2020 2020 746f 2063 6173 7420  ///     to cast 
-00008620: 7468 6520 6564 6765 206f 626a 6563 7420  the edge object 
-00008630: 6173 2061 2066 6c6f 6174 2061 7320 7468  as a float as th
-00008640: 6520 7765 6967 6874 2e0a 2f2f 2f0a 2f2f  e weight..///.//
-00008650: 2f20 3a72 6574 7572 6e73 3a20 4120 6d61  / :returns: A ma
-00008660: 7472 6978 206f 6620 7368 6f72 7465 7374  trix of shortest
-00008670: 2070 6174 6820 6469 7374 616e 6365 7320   path distances 
-00008680: 6265 7477 6565 6e20 6e6f 6465 732e 2049  between nodes. I
-00008690: 6620 7468 6572 6520 6973 206e 6f0a 2f2f  f there is no.//
-000086a0: 2f20 2020 2020 7061 7468 2062 6574 7765  /     path betwe
-000086b0: 656e 2074 776f 206e 6f64 6573 2074 6865  en two nodes the
-000086c0: 6e20 7468 6520 636f 7272 6573 706f 6e64  n the correspond
-000086d0: 696e 6720 6d61 7472 6978 2065 6e74 7279  ing matrix entry
-000086e0: 2077 696c 6c20 6265 0a2f 2f2f 2020 2020   will be.///    
-000086f0: 2060 606e 702e 696e 6660 602e 0a2f 2f2f   ``np.inf``..///
-00008700: 203a 7274 7970 653a 206e 756d 7079 2e6e   :rtype: numpy.n
-00008710: 6461 7272 6179 0a23 5b70 7966 756e 6374  darray.#[pyfunct
-00008720: 696f 6e28 6465 6661 756c 745f 7765 6967  ion(default_weig
-00008730: 6874 203d 2022 312e 3022 295d 0a23 5b74  ht = "1.0")].#[t
-00008740: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
-00008750: 2228 6772 6170 682c 202f 2c20 7765 6967  "(graph, /, weig
-00008760: 6874 5f66 6e3d 4e6f 6e65 2c20 6465 6661  ht_fn=None, defa
-00008770: 756c 745f 7765 6967 6874 3d31 2e30 2922  ult_weight=1.0)"
-00008780: 5d0a 666e 2067 7261 7068 5f66 6c6f 7964  ].fn graph_floyd
-00008790: 5f77 6172 7368 616c 6c5f 6e75 6d70 7928  _warshall_numpy(
-000087a0: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
-000087b0: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
-000087c0: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
-000087d0: 2077 6569 6768 745f 666e 3a20 4f70 7469   weight_fn: Opti
-000087e0: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
-000087f0: 2020 6465 6661 756c 745f 7765 6967 6874    default_weight
-00008800: 3a20 6636 342c 0a29 202d 3e20 5079 5265  : f64,.) -> PyRe
-00008810: 7375 6c74 3c50 794f 626a 6563 743e 207b  sult<PyObject> {
-00008820: 0a20 2020 206c 6574 206e 203d 2067 7261  .    let n = gra
-00008830: 7068 2e6e 6f64 655f 636f 756e 7428 293b  ph.node_count();
-00008840: 0a20 2020 202f 2f20 416c 6c6f 6361 7465  .    // Allocate
-00008850: 2065 6d70 7479 206d 6174 7269 780a 2020   empty matrix.  
-00008860: 2020 6c65 7420 6d75 7420 6d61 7420 3d20    let mut mat = 
-00008870: 4172 7261 7932 3a3a 3c66 3634 3e3a 3a66  Array2::<f64>::f
-00008880: 726f 6d5f 656c 656d 2828 6e2c 206e 292c  rom_elem((n, n),
-00008890: 2073 7464 3a3a 6636 343a 3a49 4e46 494e   std::f64::INFIN
-000088a0: 4954 5929 3b0a 0a20 2020 202f 2f20 4275  ITY);..    // Bu
-000088b0: 696c 6420 6164 6a61 6365 6e63 7920 6d61  ild adjacency ma
-000088c0: 7472 6978 0a20 2020 2066 6f72 2028 692c  trix.    for (i,
-000088d0: 206a 2c20 7765 6967 6874 2920 696e 2067   j, weight) in g
-000088e0: 6574 5f65 6467 655f 6974 6572 5f77 6974  et_edge_iter_wit
-000088f0: 685f 7765 6967 6874 7328 6772 6170 6829  h_weights(graph)
-00008900: 207b 0a20 2020 2020 2020 206c 6574 2065   {.        let e
-00008910: 6467 655f 7765 6967 6874 203d 0a20 2020  dge_weight =.   
-00008920: 2020 2020 2020 2020 2077 6569 6768 745f           weight_
-00008930: 6361 6c6c 6162 6c65 2870 792c 2026 7765  callable(py, &we
-00008940: 6967 6874 5f66 6e2c 2026 7765 6967 6874  ight_fn, &weight
-00008950: 2c20 6465 6661 756c 745f 7765 6967 6874  , default_weight
-00008960: 293f 3b0a 2020 2020 2020 2020 6d61 745b  )?;.        mat[
-00008970: 5b69 2c20 6a5d 5d20 3d20 6d61 745b 5b69  [i, j]] = mat[[i
-00008980: 2c20 6a5d 5d2e 6d69 6e28 6564 6765 5f77  , j]].min(edge_w
-00008990: 6569 6768 7429 3b0a 2020 2020 2020 2020  eight);.        
-000089a0: 6d61 745b 5b6a 2c20 695d 5d20 3d20 6d61  mat[[j, i]] = ma
-000089b0: 745b 5b6a 2c20 695d 5d2e 6d69 6e28 6564  t[[j, i]].min(ed
-000089c0: 6765 5f77 6569 6768 7429 3b0a 2020 2020  ge_weight);.    
-000089d0: 7d0a 0a20 2020 202f 2f20 3020 6f75 7420  }..    // 0 out 
-000089e0: 7468 6520 6469 6167 6f6e 616c 0a20 2020  the diagonal.   
-000089f0: 2066 6f72 2078 2069 6e20 6d61 742e 6469   for x in mat.di
-00008a00: 6167 5f6d 7574 2829 207b 0a20 2020 2020  ag_mut() {.     
-00008a10: 2020 202a 7820 3d20 302e 303b 0a20 2020     *x = 0.0;.   
-00008a20: 207d 0a20 2020 202f 2f20 5065 7266 6f72   }.    // Perfor
-00008a30: 6d20 7468 6520 466c 6f79 642d 5761 7273  m the Floyd-Wars
-00008a40: 6861 6c6c 2061 6c67 6f72 6974 686d 2e0a  hall algorithm..
-00008a50: 2020 2020 2f2f 2049 6e20 6561 6368 206c      // In each l
-00008a60: 6f6f 702c 2074 6869 7320 6669 6e64 7320  oop, this finds 
-00008a70: 7468 6520 7368 6f72 7465 7374 2070 6174  the shortest pat
-00008a80: 6820 6672 6f6d 2070 6f69 6e74 2069 0a20  h from point i. 
-00008a90: 2020 202f 2f20 746f 2070 6f69 6e74 206a     // to point j
-00008aa0: 2075 7369 6e67 2069 6e74 6572 6d65 6469   using intermedi
-00008ab0: 6174 6520 6e6f 6465 7320 302e 2e6b 0a20  ate nodes 0..k. 
-00008ac0: 2020 2066 6f72 206b 2069 6e20 302e 2e6e     for k in 0..n
-00008ad0: 207b 0a20 2020 2020 2020 2066 6f72 2069   {.        for i
-00008ae0: 2069 6e20 302e 2e6e 207b 0a20 2020 2020   in 0..n {.     
-00008af0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00008b00: 302e 2e6e 207b 0a20 2020 2020 2020 2020  0..n {.         
-00008b10: 2020 2020 2020 206c 6574 2064 5f69 6a6b         let d_ijk
-00008b20: 203d 206d 6174 5b5b 692c 206b 5d5d 202b   = mat[[i, k]] +
-00008b30: 206d 6174 5b5b 6b2c 206a 5d5d 3b0a 2020   mat[[k, j]];.  
-00008b40: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00008b50: 2064 5f69 6a6b 203c 206d 6174 5b5b 692c   d_ijk < mat[[i,
-00008b60: 206a 5d5d 207b 0a20 2020 2020 2020 2020   j]] {.         
-00008b70: 2020 2020 2020 2020 2020 206d 6174 5b5b             mat[[
-00008b80: 692c 206a 5d5d 203d 2064 5f69 6a6b 3b0a  i, j]] = d_ijk;.
-00008b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ba0: 7d0a 2020 2020 2020 2020 2020 2020 7d0a  }.            }.
-00008bb0: 2020 2020 2020 2020 7d0a 2020 2020 7d0a          }.    }.
-00008bc0: 2020 2020 4f6b 286d 6174 2e69 6e74 6f5f      Ok(mat.into_
-00008bd0: 7079 6172 7261 7928 7079 292e 696e 746f  pyarray(py).into
-00008be0: 2829 290a 7d0a 0a2f 2f2f 2046 696e 6420  ()).}../// Find 
-00008bf0: 616c 6c2d 7061 6972 7320 7368 6f72 7465  all-pairs shorte
-00008c00: 7374 2070 6174 6820 6c65 6e67 7468 7320  st path lengths 
-00008c10: 7573 696e 6720 466c 6f79 6427 7320 616c  using Floyd's al
-00008c20: 676f 7269 7468 6d0a 2f2f 2f0a 2f2f 2f20  gorithm.///./// 
-00008c30: 466c 6f79 6427 7320 616c 676f 7269 7468  Floyd's algorith
-00008c40: 6d20 6973 2075 7365 6420 666f 7220 6669  m is used for fi
-00008c50: 6e64 696e 6720 7368 6f72 7465 7374 2070  nding shortest p
-00008c60: 6174 6873 2069 6e20 6465 6e73 6520 6772  aths in dense gr
-00008c70: 6170 6873 0a2f 2f2f 206f 7220 6772 6170  aphs./// or grap
-00008c80: 6873 2077 6974 6820 6e65 6761 7469 7665  hs with negative
-00008c90: 2077 6569 6768 7473 2028 7768 6572 6520   weights (where 
-00008ca0: 4469 6a6b 7374 7261 2773 2061 6c67 6f72  Dijkstra's algor
-00008cb0: 6974 686d 2066 6169 6c73 292e 0a2f 2f2f  ithm fails)..///
-00008cc0: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
-00008cd0: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-00008ce0: 2064 6972 6563 7465 6420 6772 6170 6820   directed graph 
-00008cf0: 746f 2072 756e 2046 6c6f 7964 2773 2061  to run Floyd's a
-00008d00: 6c67 6f72 6974 686d 206f 6e0a 2f2f 2f20  lgorithm on./// 
-00008d10: 3a70 6172 616d 2077 6569 6768 745f 666e  :param weight_fn
-00008d20: 3a20 4120 6361 6c6c 6162 6c65 206f 626a  : A callable obj
-00008d30: 6563 7420 2866 756e 6374 696f 6e2c 206c  ect (function, l
-00008d40: 616d 6264 612c 2065 7463 2920 7768 6963  ambda, etc) whic
-00008d50: 680a 2f2f 2f20 2020 2020 7769 6c6c 2062  h.///     will b
-00008d60: 6520 7061 7373 6564 2074 6865 2065 6467  e passed the edg
-00008d70: 6520 6f62 6a65 6374 2061 6e64 2065 7870  e object and exp
-00008d80: 6563 7465 6420 746f 2072 6574 7572 6e20  ected to return 
-00008d90: 6120 6060 666c 6f61 7460 602e 2054 6869  a ``float``. Thi
-00008da0: 730a 2f2f 2f20 2020 2020 7465 6c6c 7320  s.///     tells 
-00008db0: 7265 7477 6f72 6b78 2f72 7573 7420 686f  retworkx/rust ho
-00008dc0: 7720 746f 2065 7874 7261 6374 2061 206e  w to extract a n
-00008dd0: 756d 6572 6963 616c 2077 6569 6768 7420  umerical weight 
-00008de0: 6173 2061 2060 6066 6c6f 6174 6060 0a2f  as a ``float``./
-00008df0: 2f2f 2020 2020 2066 6f72 2065 6467 6520  //     for edge 
-00008e00: 6f62 6a65 6374 2e20 536f 6d65 2073 696d  object. Some sim
-00008e10: 706c 6520 6578 616d 706c 6573 2061 7265  ple examples are
-00008e20: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2020  ::.///.///      
-00008e30: 2020 2067 7261 7068 5f66 6c6f 7964 5f77     graph_floyd_w
-00008e40: 6172 7368 616c 6c5f 6e75 6d70 7928 6772  arshall_numpy(gr
-00008e50: 6170 682c 2077 6569 6768 745f 666e 3a20  aph, weight_fn: 
-00008e60: 6c61 6d62 6461 2078 3a20 3129 0a2f 2f2f  lambda x: 1).///
-00008e70: 0a2f 2f2f 2020 2020 2074 6f20 7265 7475  .///     to retu
-00008e80: 726e 2061 2077 6569 6768 7420 6f66 2031  rn a weight of 1
-00008e90: 2066 6f72 2061 6c6c 2065 6467 6573 2e20   for all edges. 
-00008ea0: 416c 736f 3a3a 0a2f 2f2f 0a2f 2f2f 2020  Also::.///.///  
-00008eb0: 2020 2020 2020 2067 7261 7068 5f66 6c6f         graph_flo
-00008ec0: 7964 5f77 6172 7368 616c 6c5f 6e75 6d70  yd_warshall_nump
-00008ed0: 7928 6772 6170 682c 2077 6569 6768 745f  y(graph, weight_
-00008ee0: 666e 3a20 6c61 6d62 6461 2078 3a20 666c  fn: lambda x: fl
-00008ef0: 6f61 7428 7829 290a 2f2f 2f0a 2f2f 2f20  oat(x)).///./// 
-00008f00: 2020 2020 746f 2063 6173 7420 7468 6520      to cast the 
-00008f10: 6564 6765 206f 626a 6563 7420 6173 2061  edge object as a
-00008f20: 2066 6c6f 6174 2061 7320 7468 6520 7765   float as the we
-00008f30: 6967 6874 2e0a 2f2f 2f20 3a70 6172 616d  ight../// :param
-00008f40: 2061 735f 756e 6469 7265 6374 6564 3a20   as_undirected: 
-00008f50: 4966 2073 6574 2074 6f20 7472 7565 2065  If set to true e
-00008f60: 6163 6820 6469 7265 6374 6564 2065 6467  ach directed edg
-00008f70: 6520 7769 6c6c 2062 6520 7472 6561 7465  e will be treate
-00008f80: 6420 6173 0a2f 2f2f 2020 2020 2062 6964  d as.///     bid
-00008f90: 6972 6563 7469 6f6e 616c 2f75 6e64 6972  irectional/undir
-00008fa0: 6563 7465 642e 0a2f 2f2f 0a2f 2f2f 203a  ected..///./// :
-00008fb0: 7265 7475 726e 733a 2041 206d 6174 7269  returns: A matri
-00008fc0: 7820 6f66 2073 686f 7274 6573 7420 7061  x of shortest pa
-00008fd0: 7468 2064 6973 7461 6e63 6573 2062 6574  th distances bet
-00008fe0: 7765 656e 206e 6f64 6573 2e20 4966 2074  ween nodes. If t
-00008ff0: 6865 7265 2069 7320 6e6f 0a2f 2f2f 2020  here is no.///  
-00009000: 2020 2070 6174 6820 6265 7477 6565 6e20     path between 
-00009010: 7477 6f20 6e6f 6465 7320 7468 656e 2074  two nodes then t
-00009020: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
-00009030: 206d 6174 7269 7820 656e 7472 7920 7769   matrix entry wi
-00009040: 6c6c 2062 650a 2f2f 2f20 2020 2020 6060  ll be.///     ``
-00009050: 6e70 2e69 6e66 6060 2e0a 2f2f 2f20 3a72  np.inf``../// :r
-00009060: 7479 7065 3a20 6e75 6d70 792e 6e64 6172  type: numpy.ndar
-00009070: 7261 790a 235b 7079 6675 6e63 7469 6f6e  ray.#[pyfunction
-00009080: 2861 735f 756e 6469 7265 6374 6564 203d  (as_undirected =
-00009090: 2022 6661 6c73 6522 2c20 6465 6661 756c   "false", defaul
-000090a0: 745f 7765 6967 6874 203d 2022 312e 3022  t_weight = "1.0"
-000090b0: 295d 0a23 5b74 6578 745f 7369 676e 6174  )].#[text_signat
-000090c0: 7572 6520 3d20 2228 6772 6170 682c 202f  ure = "(graph, /
-000090d0: 2c20 7765 6967 6874 5f66 6e3d 4e6f 6e65  , weight_fn=None
-000090e0: 2061 735f 756e 6469 7265 6374 6564 3d46   as_undirected=F
-000090f0: 616c 7365 2c20 6465 6661 756c 745f 7765  alse, default_we
-00009100: 6967 6874 3d31 2e30 2922 5d0a 666e 2064  ight=1.0)"].fn d
-00009110: 6967 7261 7068 5f66 6c6f 7964 5f77 6172  igraph_floyd_war
-00009120: 7368 616c 6c5f 6e75 6d70 7928 0a20 2020  shall_numpy(.   
-00009130: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
-00009140: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
-00009150: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
-00009160: 2077 6569 6768 745f 666e 3a20 4f70 7469   weight_fn: Opti
-00009170: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
-00009180: 2020 6173 5f75 6e64 6972 6563 7465 643a    as_undirected:
-00009190: 2062 6f6f 6c2c 0a20 2020 2064 6566 6175   bool,.    defau
-000091a0: 6c74 5f77 6569 6768 743a 2066 3634 2c0a  lt_weight: f64,.
-000091b0: 2920 2d3e 2050 7952 6573 756c 743c 5079  ) -> PyResult<Py
-000091c0: 4f62 6a65 6374 3e20 7b0a 2020 2020 6c65  Object> {.    le
-000091d0: 7420 6e20 3d20 6772 6170 682e 6e6f 6465  t n = graph.node
-000091e0: 5f63 6f75 6e74 2829 3b0a 0a20 2020 202f  _count();..    /
-000091f0: 2f20 416c 6c6f 6361 7465 2065 6d70 7479  / Allocate empty
-00009200: 206d 6174 7269 780a 2020 2020 6c65 7420   matrix.    let 
-00009210: 6d75 7420 6d61 7420 3d20 4172 7261 7932  mut mat = Array2
-00009220: 3a3a 3c66 3634 3e3a 3a66 726f 6d5f 656c  ::<f64>::from_el
-00009230: 656d 2828 6e2c 206e 292c 2073 7464 3a3a  em((n, n), std::
-00009240: 6636 343a 3a49 4e46 494e 4954 5929 3b0a  f64::INFINITY);.
-00009250: 0a20 2020 202f 2f20 4275 696c 6420 6164  .    // Build ad
-00009260: 6a61 6365 6e63 7920 6d61 7472 6978 0a20  jacency matrix. 
-00009270: 2020 2066 6f72 2028 692c 206a 2c20 7765     for (i, j, we
-00009280: 6967 6874 2920 696e 2067 6574 5f65 6467  ight) in get_edg
-00009290: 655f 6974 6572 5f77 6974 685f 7765 6967  e_iter_with_weig
-000092a0: 6874 7328 6772 6170 6829 207b 0a20 2020  hts(graph) {.   
-000092b0: 2020 2020 206c 6574 2065 6467 655f 7765       let edge_we
-000092c0: 6967 6874 203d 0a20 2020 2020 2020 2020  ight =.         
-000092d0: 2020 2077 6569 6768 745f 6361 6c6c 6162     weight_callab
-000092e0: 6c65 2870 792c 2026 7765 6967 6874 5f66  le(py, &weight_f
-000092f0: 6e2c 2026 7765 6967 6874 2c20 6465 6661  n, &weight, defa
-00009300: 756c 745f 7765 6967 6874 293f 3b0a 2020  ult_weight)?;.  
-00009310: 2020 2020 2020 6d61 745b 5b69 2c20 6a5d        mat[[i, j]
-00009320: 5d20 3d20 6d61 745b 5b69 2c20 6a5d 5d2e  ] = mat[[i, j]].
-00009330: 6d69 6e28 6564 6765 5f77 6569 6768 7429  min(edge_weight)
-00009340: 3b0a 2020 2020 2020 2020 6966 2061 735f  ;.        if as_
-00009350: 756e 6469 7265 6374 6564 207b 0a20 2020  undirected {.   
-00009360: 2020 2020 2020 2020 206d 6174 5b5b 6a2c           mat[[j,
-00009370: 2069 5d5d 203d 206d 6174 5b5b 6a2c 2069   i]] = mat[[j, i
-00009380: 5d5d 2e6d 696e 2865 6467 655f 7765 6967  ]].min(edge_weig
-00009390: 6874 293b 0a20 2020 2020 2020 207d 0a20  ht);.        }. 
-000093a0: 2020 207d 0a20 2020 202f 2f20 3020 6f75     }.    // 0 ou
-000093b0: 7420 7468 6520 6469 6167 6f6e 616c 0a20  t the diagonal. 
-000093c0: 2020 2066 6f72 2078 2069 6e20 6d61 742e     for x in mat.
-000093d0: 6469 6167 5f6d 7574 2829 207b 0a20 2020  diag_mut() {.   
-000093e0: 2020 2020 202a 7820 3d20 302e 303b 0a20       *x = 0.0;. 
-000093f0: 2020 207d 0a20 2020 202f 2f20 5065 7266     }.    // Perf
-00009400: 6f72 6d20 7468 6520 466c 6f79 642d 5761  orm the Floyd-Wa
-00009410: 7273 6861 6c6c 2061 6c67 6f72 6974 686d  rshall algorithm
-00009420: 2e0a 2020 2020 2f2f 2049 6e20 6561 6368  ..    // In each
-00009430: 206c 6f6f 702c 2074 6869 7320 6669 6e64   loop, this find
-00009440: 7320 7468 6520 7368 6f72 7465 7374 2070  s the shortest p
-00009450: 6174 6820 6672 6f6d 2070 6f69 6e74 2069  ath from point i
-00009460: 0a20 2020 202f 2f20 746f 2070 6f69 6e74  .    // to point
-00009470: 206a 2075 7369 6e67 2069 6e74 6572 6d65   j using interme
-00009480: 6469 6174 6520 6e6f 6465 7320 302e 2e6b  diate nodes 0..k
-00009490: 0a20 2020 2066 6f72 206b 2069 6e20 302e  .    for k in 0.
-000094a0: 2e6e 207b 0a20 2020 2020 2020 2066 6f72  .n {.        for
-000094b0: 2069 2069 6e20 302e 2e6e 207b 0a20 2020   i in 0..n {.   
-000094c0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-000094d0: 6e20 302e 2e6e 207b 0a20 2020 2020 2020  n 0..n {.       
-000094e0: 2020 2020 2020 2020 206c 6574 2064 5f69           let d_i
-000094f0: 6a6b 203d 206d 6174 5b5b 692c 206b 5d5d  jk = mat[[i, k]]
-00009500: 202b 206d 6174 5b5b 6b2c 206a 5d5d 3b0a   + mat[[k, j]];.
-00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009520: 6966 2064 5f69 6a6b 203c 206d 6174 5b5b  if d_ijk < mat[[
-00009530: 692c 206a 5d5d 207b 0a20 2020 2020 2020  i, j]] {.       
-00009540: 2020 2020 2020 2020 2020 2020 206d 6174               mat
-00009550: 5b5b 692c 206a 5d5d 203d 2064 5f69 6a6b  [[i, j]] = d_ijk
-00009560: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00009570: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00009580: 7d0a 2020 2020 2020 2020 7d0a 2020 2020  }.        }.    
-00009590: 7d0a 2020 2020 4f6b 286d 6174 2e69 6e74  }.    Ok(mat.int
-000095a0: 6f5f 7079 6172 7261 7928 7079 292e 696e  o_pyarray(py).in
-000095b0: 746f 2829 290a 7d0a 0a2f 2f2f 2043 6f6c  to()).}../// Col
-000095c0: 6c65 6374 2072 756e 7320 7468 6174 206d  lect runs that m
-000095d0: 6174 6368 2061 2066 696c 7465 7220 6675  atch a filter fu
-000095e0: 6e63 7469 6f6e 0a2f 2f2f 0a2f 2f2f 2041  nction.///./// A
-000095f0: 2072 756e 2069 7320 6120 7061 7468 206f   run is a path o
-00009600: 6620 6e6f 6465 7320 7768 6572 6520 7468  f nodes where th
-00009610: 6572 6520 6973 206f 6e6c 7920 6120 7369  ere is only a si
-00009620: 6e67 6c65 2073 7563 6365 7373 6f72 2061  ngle successor a
-00009630: 6e64 2061 6c6c 0a2f 2f2f 206e 6f64 6573  nd all./// nodes
-00009640: 2069 6e20 7468 6520 7061 7468 206d 6174   in the path mat
-00009650: 6368 2074 6865 2067 6976 656e 2063 6f6e  ch the given con
-00009660: 6469 7469 6f6e 2e20 4561 6368 206e 6f64  dition. Each nod
-00009670: 6520 696e 2074 6865 2067 7261 7068 2063  e in the graph c
-00009680: 616e 0a2f 2f2f 2061 7070 6561 7220 696e  an./// appear in
-00009690: 206f 6e6c 7920 6120 7369 6e67 6c65 2072   only a single r
-000096a0: 756e 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  un..///./// :par
-000096b0: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
-000096c0: 7068 3a20 5468 6520 6772 6170 6820 746f  ph: The graph to
-000096d0: 2066 696e 6420 7275 6e73 2069 6e0a 2f2f   find runs in.//
-000096e0: 2f20 3a70 6172 616d 2066 696c 7465 725f  / :param filter_
-000096f0: 666e 3a20 5468 6520 6669 6c74 6572 2066  fn: The filter f
-00009700: 756e 6374 696f 6e20 746f 2075 7365 2066  unction to use f
-00009710: 6f72 206d 6174 6368 696e 6720 6e6f 6465  or matching node
-00009720: 732e 2049 7420 7461 6b65 730a 2f2f 2f20  s. It takes./// 
-00009730: 2020 2020 696e 206f 6e65 2061 7267 756d      in one argum
-00009740: 656e 742c 2074 6865 206e 6f64 6520 6461  ent, the node da
-00009750: 7461 2070 6179 6c6f 6164 2f77 6569 6768  ta payload/weigh
-00009760: 7420 6f62 6a65 6374 2c20 616e 6420 7769  t object, and wi
-00009770: 6c6c 2072 6574 7572 6e20 610a 2f2f 2f20  ll return a./// 
-00009780: 2020 2020 626f 6f6c 6561 6e20 7768 6574      boolean whet
-00009790: 6865 7220 7468 6520 6e6f 6465 206d 6174  her the node mat
-000097a0: 6368 6573 2074 6865 2063 6f6e 6469 7469  ches the conditi
-000097b0: 6f6e 7320 6f72 206e 6f74 2e20 4966 2069  ons or not. If i
-000097c0: 7420 7265 7475 726e 730a 2f2f 2f20 2020  t returns.///   
-000097d0: 2020 6060 4661 6c73 6560 6020 6974 2077    ``False`` it w
-000097e0: 696c 6c20 736b 6970 2074 6861 7420 6e6f  ill skip that no
-000097f0: 6465 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  de..///./// :ret
-00009800: 7572 6e73 3a20 6120 6c69 7374 206f 6620  urns: a list of 
-00009810: 7275 6e73 2c20 7768 6572 6520 6561 6368  runs, where each
-00009820: 2072 756e 2069 7320 6120 6c69 7374 206f   run is a list o
-00009830: 6620 6e6f 6465 2064 6174 610a 2f2f 2f20  f node data./// 
-00009840: 2020 2020 7061 796c 6f61 642f 7765 6967      payload/weig
-00009850: 6874 2066 6f72 2074 6865 206e 6f64 6573  ht for the nodes
-00009860: 2069 6e20 7468 6520 7275 6e0a 2f2f 2f20   in the run./// 
-00009870: 3a72 7479 7065 3a20 6c69 7374 0a23 5b70  :rtype: list.#[p
-00009880: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
-00009890: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
-000098a0: 6772 6170 682c 2066 696c 7465 7229 225d  graph, filter)"]
-000098b0: 0a66 6e20 636f 6c6c 6563 745f 7275 6e73  .fn collect_runs
-000098c0: 280a 2020 2020 7079 3a20 5079 7468 6f6e  (.    py: Python
-000098d0: 2c0a 2020 2020 6772 6170 683a 2026 6469  ,.    graph: &di
-000098e0: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
-000098f0: 2c0a 2020 2020 6669 6c74 6572 5f66 6e3a  ,.    filter_fn:
-00009900: 2050 794f 626a 6563 742c 0a29 202d 3e20   PyObject,.) -> 
-00009910: 5079 5265 7375 6c74 3c56 6563 3c56 6563  PyResult<Vec<Vec
-00009920: 3c50 794f 626a 6563 743e 3e3e 207b 0a20  <PyObject>>> {. 
-00009930: 2020 206c 6574 206d 7574 206f 7574 5f6c     let mut out_l
-00009940: 6973 743a 2056 6563 3c56 6563 3c50 794f  ist: Vec<Vec<PyO
-00009950: 626a 6563 743e 3e20 3d20 5665 633a 3a6e  bject>> = Vec::n
-00009960: 6577 2829 3b0a 2020 2020 6c65 7420 6d75  ew();.    let mu
-00009970: 7420 7365 656e 3a20 4861 7368 5365 743c  t seen: HashSet<
-00009980: 4e6f 6465 496e 6465 783e 203d 0a20 2020  NodeIndex> =.   
-00009990: 2020 2020 2048 6173 6853 6574 3a3a 7769       HashSet::wi
-000099a0: 7468 5f63 6170 6163 6974 7928 6772 6170  th_capacity(grap
-000099b0: 682e 6e6f 6465 5f63 6f75 6e74 2829 293b  h.node_count());
-000099c0: 0a0a 2020 2020 6c65 7420 6669 6c74 6572  ..    let filter
-000099d0: 5f6e 6f64 6520 3d20 7c6e 6f64 653a 2026  _node = |node: &
-000099e0: 5079 4f62 6a65 6374 7c20 2d3e 2050 7952  PyObject| -> PyR
-000099f0: 6573 756c 743c 626f 6f6c 3e20 7b0a 2020  esult<bool> {.  
-00009a00: 2020 2020 2020 6c65 7420 7265 7320 3d20        let res = 
-00009a10: 6669 6c74 6572 5f66 6e2e 6361 6c6c 3128  filter_fn.call1(
-00009a20: 7079 2c20 286e 6f64 652c 2929 3f3b 0a20  py, (node,))?;. 
-00009a30: 2020 2020 2020 2072 6573 2e65 7874 7261         res.extra
-00009a40: 6374 2870 7929 0a20 2020 207d 3b0a 0a20  ct(py).    };.. 
-00009a50: 2020 206c 6574 206e 6f64 6573 203d 206d     let nodes = m
-00009a60: 6174 6368 2061 6c67 6f3a 3a74 6f70 6f73  atch algo::topos
-00009a70: 6f72 7428 6772 6170 682c 204e 6f6e 6529  ort(graph, None)
-00009a80: 207b 0a20 2020 2020 2020 204f 6b28 6e6f   {.        Ok(no
-00009a90: 6465 7329 203d 3e20 6e6f 6465 732c 0a20  des) => nodes,. 
-00009aa0: 2020 2020 2020 2045 7272 285f 6572 7229         Err(_err)
-00009ab0: 203d 3e20 7b0a 2020 2020 2020 2020 2020   => {.          
-00009ac0: 2020 7265 7475 726e 2045 7272 2844 4147    return Err(DAG
-00009ad0: 4861 7343 7963 6c65 3a3a 6e65 775f 6572  HasCycle::new_er
-00009ae0: 7228 2253 6f72 7420 656e 636f 756e 7465  r("Sort encounte
-00009af0: 7265 6420 6120 6379 636c 6522 2929 0a20  red a cycle")). 
-00009b00: 2020 2020 2020 207d 0a20 2020 207d 3b0a         }.    };.
-00009b10: 2020 2020 666f 7220 6e6f 6465 2069 6e20      for node in 
-00009b20: 6e6f 6465 7320 7b0a 2020 2020 2020 2020  nodes {.        
-00009b30: 6966 2021 6669 6c74 6572 5f6e 6f64 6528  if !filter_node(
-00009b40: 2667 7261 7068 2e67 7261 7068 5b6e 6f64  &graph.graph[nod
-00009b50: 655d 293f 207c 7c20 7365 656e 2e63 6f6e  e])? || seen.con
-00009b60: 7461 696e 7328 266e 6f64 6529 207b 0a20  tains(&node) {. 
-00009b70: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00009b80: 6e75 653b 0a20 2020 2020 2020 207d 0a20  nue;.        }. 
-00009b90: 2020 2020 2020 2073 6565 6e2e 696e 7365         seen.inse
-00009ba0: 7274 286e 6f64 6529 3b0a 2020 2020 2020  rt(node);.      
-00009bb0: 2020 6c65 7420 6d75 7420 6772 6f75 703a    let mut group:
-00009bc0: 2056 6563 3c50 794f 626a 6563 743e 203d   Vec<PyObject> =
-00009bd0: 2076 6563 215b 6772 6170 682e 6772 6170   vec![graph.grap
-00009be0: 685b 6e6f 6465 5d2e 636c 6f6e 655f 7265  h[node].clone_re
-00009bf0: 6628 7079 295d 3b0a 2020 2020 2020 2020  f(py)];.        
-00009c00: 6c65 7420 6d75 7420 7375 6363 6573 736f  let mut successo
-00009c10: 7273 3a20 5665 633c 4e6f 6465 496e 6465  rs: Vec<NodeInde
-00009c20: 783e 203d 2067 7261 7068 0a20 2020 2020  x> = graph.     
-00009c30: 2020 2020 2020 202e 6772 6170 680a 2020         .graph.  
-00009c40: 2020 2020 2020 2020 2020 2e6e 6569 6768            .neigh
-00009c50: 626f 7273 5f64 6972 6563 7465 6428 6e6f  bors_directed(no
-00009c60: 6465 2c20 7065 7467 7261 7068 3a3a 4469  de, petgraph::Di
-00009c70: 7265 6374 696f 6e3a 3a4f 7574 676f 696e  rection::Outgoin
-00009c80: 6729 0a20 2020 2020 2020 2020 2020 202e  g).            .
-00009c90: 636f 6c6c 6563 7428 293b 0a20 2020 2020  collect();.     
-00009ca0: 2020 2073 7563 6365 7373 6f72 732e 6465     successors.de
-00009cb0: 6475 7028 293b 0a0a 2020 2020 2020 2020  dup();..        
-00009cc0: 7768 696c 6520 7375 6363 6573 736f 7273  while successors
-00009cd0: 2e6c 656e 2829 203d 3d20 310a 2020 2020  .len() == 1.    
-00009ce0: 2020 2020 2020 2020 2626 2066 696c 7465          && filte
-00009cf0: 725f 6e6f 6465 2826 6772 6170 682e 6772  r_node(&graph.gr
-00009d00: 6170 685b 7375 6363 6573 736f 7273 5b30  aph[successors[0
-00009d10: 5d5d 293f 0a20 2020 2020 2020 2020 2020  ]])?.           
-00009d20: 2026 2620 2173 6565 6e2e 636f 6e74 6169   && !seen.contai
-00009d30: 6e73 2826 7375 6363 6573 736f 7273 5b30  ns(&successors[0
-00009d40: 5d29 0a20 2020 2020 2020 207b 0a20 2020  ]).        {.   
-00009d50: 2020 2020 2020 2020 2067 726f 7570 2e70           group.p
-00009d60: 7573 6828 6772 6170 682e 6772 6170 685b  ush(graph.graph[
-00009d70: 7375 6363 6573 736f 7273 5b30 5d5d 2e63  successors[0]].c
-00009d80: 6c6f 6e65 5f72 6566 2870 7929 293b 0a20  lone_ref(py));. 
-00009d90: 2020 2020 2020 2020 2020 2073 6565 6e2e             seen.
-00009da0: 696e 7365 7274 2873 7563 6365 7373 6f72  insert(successor
-00009db0: 735b 305d 293b 0a20 2020 2020 2020 2020  s[0]);.         
-00009dc0: 2020 2073 7563 6365 7373 6f72 7320 3d20     successors = 
-00009dd0: 6772 6170 680a 2020 2020 2020 2020 2020  graph.          
-00009de0: 2020 2020 2020 2e67 7261 7068 0a20 2020        .graph.   
-00009df0: 2020 2020 2020 2020 2020 2020 202e 6e65               .ne
-00009e00: 6967 6862 6f72 735f 6469 7265 6374 6564  ighbors_directed
-00009e10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00009e20: 2020 2020 2020 7375 6363 6573 736f 7273        successors
-00009e30: 5b30 5d2c 0a20 2020 2020 2020 2020 2020  [0],.           
-00009e40: 2020 2020 2020 2020 2070 6574 6772 6170           petgrap
-00009e50: 683a 3a44 6972 6563 7469 6f6e 3a3a 4f75  h::Direction::Ou
-00009e60: 7467 6f69 6e67 2c0a 2020 2020 2020 2020  tgoing,.        
-00009e70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009e80: 2020 2020 2020 2020 2020 2e63 6f6c 6c65            .colle
-00009e90: 6374 2829 3b0a 2020 2020 2020 2020 2020  ct();.          
-00009ea0: 2020 7375 6363 6573 736f 7273 2e64 6564    successors.ded
-00009eb0: 7570 2829 3b0a 2020 2020 2020 2020 7d0a  up();.        }.
-00009ec0: 2020 2020 2020 2020 6966 2021 6772 6f75          if !grou
-00009ed0: 702e 6973 5f65 6d70 7479 2829 207b 0a20  p.is_empty() {. 
-00009ee0: 2020 2020 2020 2020 2020 206f 7574 5f6c             out_l
-00009ef0: 6973 742e 7075 7368 2867 726f 7570 293b  ist.push(group);
-00009f00: 0a20 2020 2020 2020 207d 0a20 2020 207d  .        }.    }
-00009f10: 0a20 2020 204f 6b28 6f75 745f 6c69 7374  .    Ok(out_list
-00009f20: 290a 7d0a 0a2f 2f2f 2052 6574 7572 6e20  ).}../// Return 
-00009f30: 6120 6c69 7374 206f 6620 6c61 7965 7273  a list of layers
-00009f40: 0a2f 2f2f 2020 0a2f 2f2f 2041 206c 6179  .///  ./// A lay
-00009f50: 6572 2069 7320 6120 7375 6267 7261 7068  er is a subgraph
-00009f60: 2077 686f 7365 206e 6f64 6573 2061 7265   whose nodes are
-00009f70: 2064 6973 6a6f 696e 742c 2069 2e65 2e2c   disjoint, i.e.,
-00009f80: 0a2f 2f2f 2061 206c 6179 6572 2068 6173  ./// a layer has
-00009f90: 2064 6570 7468 2031 2e20 5468 6520 6c61   depth 1. The la
-00009fa0: 7965 7273 2061 7265 2063 6f6e 7374 7275  yers are constru
-00009fb0: 6374 6564 2075 7369 6e67 2061 2067 7265  cted using a gre
-00009fc0: 6564 7920 616c 676f 7269 7468 6d2e 0a2f  edy algorithm../
-00009fd0: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
-00009fe0: 4469 4772 6170 6820 6772 6170 683a 2054  DiGraph graph: T
-00009ff0: 6865 2044 4147 2074 6f20 6765 7420 7468  he DAG to get th
-0000a000: 6520 6c61 7965 7273 2066 726f 6d0a 2f2f  e layers from.//
-0000a010: 2f20 3a70 6172 616d 206c 6973 7420 6669  / :param list fi
-0000a020: 7273 745f 6c61 7965 723a 2041 206c 6973  rst_layer: A lis
-0000a030: 7420 6f66 206e 6f64 6520 6964 7320 666f  t of node ids fo
-0000a040: 7220 7468 6520 6669 7273 7420 6c61 7965  r the first laye
-0000a050: 722e 2054 6869 730a 2f2f 2f20 2020 2020  r. This.///     
-0000a060: 7769 6c6c 2062 6520 7468 6520 6669 7273  will be the firs
-0000a070: 7420 6c61 7965 7220 696e 2074 6865 206f  t layer in the o
-0000a080: 7574 7075 740a 2f2f 2f0a 2f2f 2f20 3a72  utput.///./// :r
-0000a090: 6574 7572 6e73 3a20 4120 6c69 7374 206f  eturns: A list o
-0000a0a0: 6620 6c61 7965 7273 2c20 6561 6368 206c  f layers, each l
-0000a0b0: 6179 6572 2069 7320 6120 6c69 7374 206f  ayer is a list o
-0000a0c0: 6620 6e6f 6465 2064 6174 610a 2f2f 2f20  f node data./// 
-0000a0d0: 3a72 7479 7065 3a20 6c69 7374 0a2f 2f2f  :rtype: list.///
-0000a0e0: 0a2f 2f2f 203a 7261 6973 6573 2049 6e76  ./// :raises Inv
-0000a0f0: 616c 6964 4e6f 6465 3a20 4966 2061 206e  alidNode: If a n
-0000a100: 6f64 6520 696e 6465 7820 696e 2060 6066  ode index in ``f
-0000a110: 6972 7374 5f6c 6179 6572 6060 2069 7320  irst_layer`` is 
-0000a120: 6e6f 7420 696e 2074 6865 2067 7261 7068  not in the graph
-0000a130: 0a23 5b70 7966 756e 6374 696f 6e5d 0a23  .#[pyfunction].#
-0000a140: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
-0000a150: 3d20 2228 6461 672c 2066 6972 7374 5f6c  = "(dag, first_l
-0000a160: 6179 6572 2c20 2f29 225d 0a66 6e20 6c61  ayer, /)"].fn la
-0000a170: 7965 7273 280a 2020 2020 7079 3a20 5079  yers(.    py: Py
-0000a180: 7468 6f6e 2c0a 2020 2020 6461 673a 2026  thon,.    dag: &
-0000a190: 6469 6772 6170 683a 3a50 7944 6947 7261  digraph::PyDiGra
-0000a1a0: 7068 2c0a 2020 2020 6669 7273 745f 6c61  ph,.    first_la
-0000a1b0: 7965 723a 2056 6563 3c75 7369 7a65 3e2c  yer: Vec<usize>,
-0000a1c0: 0a29 202d 3e20 5079 5265 7375 6c74 3c50  .) -> PyResult<P
-0000a1d0: 794f 626a 6563 743e 207b 0a20 2020 206c  yObject> {.    l
-0000a1e0: 6574 206d 7574 206f 7574 7075 743a 2056  et mut output: V
-0000a1f0: 6563 3c56 6563 3c26 5079 4f62 6a65 6374  ec<Vec<&PyObject
-0000a200: 3e3e 203d 2056 6563 3a3a 6e65 7728 293b  >> = Vec::new();
-0000a210: 0a20 2020 202f 2f20 436f 6e76 6572 7420  .    // Convert 
-0000a220: 7573 697a 6520 746f 204e 6f64 6549 6e64  usize to NodeInd
-0000a230: 6578 0a20 2020 206c 6574 206d 7574 2066  ex.    let mut f
-0000a240: 6972 7374 5f6c 6179 6572 5f69 6e64 6578  irst_layer_index
-0000a250: 3a20 5665 633c 4e6f 6465 496e 6465 783e  : Vec<NodeIndex>
-0000a260: 203d 2056 6563 3a3a 6e65 7728 293b 0a20   = Vec::new();. 
-0000a270: 2020 2066 6f72 2069 6e64 6578 2069 6e20     for index in 
-0000a280: 6669 7273 745f 6c61 7965 7220 7b0a 2020  first_layer {.  
-0000a290: 2020 2020 2020 6669 7273 745f 6c61 7965        first_laye
-0000a2a0: 725f 696e 6465 782e 7075 7368 284e 6f64  r_index.push(Nod
-0000a2b0: 6549 6e64 6578 3a3a 6e65 7728 696e 6465  eIndex::new(inde
-0000a2c0: 7829 293b 0a20 2020 207d 0a0a 2020 2020  x));.    }..    
-0000a2d0: 6c65 7420 6d75 7420 6375 725f 6c61 7965  let mut cur_laye
-0000a2e0: 7220 3d20 6669 7273 745f 6c61 7965 725f  r = first_layer_
-0000a2f0: 696e 6465 783b 0a20 2020 206c 6574 206d  index;.    let m
-0000a300: 7574 206e 6578 745f 6c61 7965 723a 2056  ut next_layer: V
-0000a310: 6563 3c4e 6f64 6549 6e64 6578 3e20 3d20  ec<NodeIndex> = 
-0000a320: 5665 633a 3a6e 6577 2829 3b0a 2020 2020  Vec::new();.    
-0000a330: 6c65 7420 6d75 7420 7072 6564 6563 6573  let mut predeces
-0000a340: 736f 725f 636f 756e 743a 2048 6173 684d  sor_count: HashM
-0000a350: 6170 3c4e 6f64 6549 6e64 6578 2c20 7573  ap<NodeIndex, us
-0000a360: 697a 653e 203d 2048 6173 684d 6170 3a3a  ize> = HashMap::
-0000a370: 6e65 7728 293b 0a0a 2020 2020 6c65 7420  new();..    let 
-0000a380: 6d75 7420 6c61 7965 725f 6e6f 6465 5f64  mut layer_node_d
-0000a390: 6174 613a 2056 6563 3c26 5079 4f62 6a65  ata: Vec<&PyObje
-0000a3a0: 6374 3e20 3d20 5665 633a 3a6e 6577 2829  ct> = Vec::new()
-0000a3b0: 3b0a 2020 2020 666f 7220 6c61 7965 725f  ;.    for layer_
-0000a3c0: 6e6f 6465 2069 6e20 2663 7572 5f6c 6179  node in &cur_lay
-0000a3d0: 6572 207b 0a20 2020 2020 2020 206c 6574  er {.        let
-0000a3e0: 206e 6f64 655f 6461 7461 203d 206d 6174   node_data = mat
-0000a3f0: 6368 2064 6167 2e67 7261 7068 2e6e 6f64  ch dag.graph.nod
-0000a400: 655f 7765 6967 6874 282a 6c61 7965 725f  e_weight(*layer_
-0000a410: 6e6f 6465 2920 7b0a 2020 2020 2020 2020  node) {.        
-0000a420: 2020 2020 536f 6d65 2864 6174 6129 203d      Some(data) =
-0000a430: 3e20 6461 7461 2c0a 2020 2020 2020 2020  > data,.        
-0000a440: 2020 2020 4e6f 6e65 203d 3e20 7b0a 2020      None => {.  
-0000a450: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000a460: 7475 726e 2045 7272 2849 6e76 616c 6964  turn Err(Invalid
-0000a470: 4e6f 6465 3a3a 6e65 775f 6572 7228 666f  Node::new_err(fo
-0000a480: 726d 6174 2128 0a20 2020 2020 2020 2020  rmat!(.         
-0000a490: 2020 2020 2020 2020 2020 2022 416e 2069             "An i
-0000a4a0: 6e64 6578 2069 6e70 7574 2069 6e20 2766  ndex input in 'f
-0000a4b0: 6972 7374 5f6c 6179 6572 2720 7b7d 2069  irst_layer' {} i
-0000a4c0: 7320 6e6f 7420 6120 7661 6c69 6420 6e6f  s not a valid no
-0000a4d0: 6465 2069 6e64 6578 2069 6e20 7468 6520  de index in the 
-0000a4e0: 6772 6170 6822 2c0a 2020 2020 2020 2020  graph",.        
-0000a4f0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-0000a500: 725f 6e6f 6465 2e69 6e64 6578 2829 292c  r_node.index()),
-0000a510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a520: 2029 290a 2020 2020 2020 2020 2020 2020   )).            
-0000a530: 7d0a 2020 2020 2020 2020 7d3b 0a20 2020  }.        };.   
-0000a540: 2020 2020 206c 6179 6572 5f6e 6f64 655f       layer_node_
-0000a550: 6461 7461 2e70 7573 6828 6e6f 6465 5f64  data.push(node_d
-0000a560: 6174 6129 3b0a 2020 2020 7d0a 2020 2020  ata);.    }.    
-0000a570: 6f75 7470 7574 2e70 7573 6828 6c61 7965  output.push(laye
-0000a580: 725f 6e6f 6465 5f64 6174 6129 3b0a 0a20  r_node_data);.. 
-0000a590: 2020 202f 2f20 4974 6572 6174 6520 756e     // Iterate un
-0000a5a0: 7469 6c20 7468 6572 6520 6172 6520 6e6f  til there are no
-0000a5b0: 206d 6f72 650a 2020 2020 7768 696c 6520   more.    while 
-0000a5c0: 2163 7572 5f6c 6179 6572 2e69 735f 656d  !cur_layer.is_em
-0000a5d0: 7074 7928 2920 7b0a 2020 2020 2020 2020  pty() {.        
-0000a5e0: 666f 7220 6e6f 6465 2069 6e20 2663 7572  for node in &cur
-0000a5f0: 5f6c 6179 6572 207b 0a20 2020 2020 2020  _layer {.       
-0000a600: 2020 2020 206c 6574 2063 6869 6c64 7265       let childre
-0000a610: 6e20 3d20 6461 670a 2020 2020 2020 2020  n = dag.        
-0000a620: 2020 2020 2020 2020 2e67 7261 7068 0a20          .graph. 
-0000a630: 2020 2020 2020 2020 2020 2020 2020 202e                 .
-0000a640: 6e65 6967 6862 6f72 735f 6469 7265 6374  neighbors_direct
-0000a650: 6564 282a 6e6f 6465 2c20 7065 7467 7261  ed(*node, petgra
-0000a660: 7068 3a3a 4469 7265 6374 696f 6e3a 3a4f  ph::Direction::O
-0000a670: 7574 676f 696e 6729 3b0a 2020 2020 2020  utgoing);.      
-0000a680: 2020 2020 2020 6c65 7420 6d75 7420 7573        let mut us
-0000a690: 6564 5f69 6e64 6578 6573 3a20 4861 7368  ed_indexes: Hash
-0000a6a0: 5365 743c 4e6f 6465 496e 6465 783e 203d  Set<NodeIndex> =
-0000a6b0: 2048 6173 6853 6574 3a3a 6e65 7728 293b   HashSet::new();
-0000a6c0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000a6d0: 2073 7563 6320 696e 2063 6869 6c64 7265   succ in childre
-0000a6e0: 6e20 7b0a 2020 2020 2020 2020 2020 2020  n {.            
-0000a6f0: 2020 2020 2f2f 2053 6b69 7020 6475 706c      // Skip dupl
-0000a700: 6963 6174 6520 7375 6363 6573 736f 7273  icate successors
-0000a710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a720: 2069 6620 7573 6564 5f69 6e64 6578 6573   if used_indexes
-0000a730: 2e63 6f6e 7461 696e 7328 2673 7563 6329  .contains(&succ)
-0000a740: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0000a750: 2020 2020 2020 2063 6f6e 7469 6e75 653b         continue;
-0000a760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a770: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
-0000a780: 2020 2075 7365 645f 696e 6465 7865 732e     used_indexes.
-0000a790: 696e 7365 7274 2873 7563 6329 3b0a 2020  insert(succ);.  
-0000a7a0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-0000a7b0: 7420 6d75 7420 6d75 6c74 6970 6c69 6369  t mut multiplici
-0000a7c0: 7479 3a20 7573 697a 6520 3d20 303b 0a20  ty: usize = 0;. 
-0000a7d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000a7e0: 6574 2072 6177 5f65 6467 6573 203d 2064  et raw_edges = d
-0000a7f0: 6167 0a20 2020 2020 2020 2020 2020 2020  ag.             
-0000a800: 2020 2020 2020 202e 6772 6170 680a 2020         .graph.  
-0000a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a820: 2020 2e65 6467 6573 5f64 6972 6563 7465    .edges_directe
-0000a830: 6428 2a6e 6f64 652c 2070 6574 6772 6170  d(*node, petgrap
-0000a840: 683a 3a44 6972 6563 7469 6f6e 3a3a 4f75  h::Direction::Ou
-0000a850: 7467 6f69 6e67 293b 0a20 2020 2020 2020  tgoing);.       
-0000a860: 2020 2020 2020 2020 2066 6f72 2065 6467           for edg
-0000a870: 6520 696e 2072 6177 5f65 6467 6573 207b  e in raw_edges {
-0000a880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a890: 2020 2020 2069 6620 6564 6765 2e74 6172       if edge.tar
-0000a8a0: 6765 7428 2920 3d3d 2073 7563 6320 7b0a  get() == succ {.
-0000a8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8c0: 2020 2020 2020 2020 6d75 6c74 6970 6c69          multipli
-0000a8d0: 6369 7479 202b 3d20 313b 0a20 2020 2020  city += 1;.     
-0000a8e0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0000a8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a900: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
-0000a910: 2020 2070 7265 6465 6365 7373 6f72 5f63     predecessor_c
-0000a920: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
-0000a930: 2020 2020 2020 2020 202e 656e 7472 7928           .entry(
-0000a940: 7375 6363 290a 2020 2020 2020 2020 2020  succ).          
-0000a950: 2020 2020 2020 2020 2020 2e61 6e64 5f6d            .and_m
-0000a960: 6f64 6966 7928 7c65 7c20 2a65 202d 3d20  odify(|e| *e -= 
-0000a970: 6d75 6c74 6970 6c69 6369 7479 290a 2020  multiplicity).  
-0000a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a990: 2020 2e6f 725f 696e 7365 7274 2864 6167    .or_insert(dag
-0000a9a0: 2e69 6e5f 6465 6772 6565 2873 7563 632e  .in_degree(succ.
-0000a9b0: 696e 6465 7828 2929 202d 206d 756c 7469  index()) - multi
-0000a9c0: 706c 6963 6974 7929 3b0a 2020 2020 2020  plicity);.      
-0000a9d0: 2020 2020 2020 2020 2020 6966 202a 7072            if *pr
-0000a9e0: 6564 6563 6573 736f 725f 636f 756e 742e  edecessor_count.
-0000a9f0: 6765 7428 2673 7563 6329 2e75 6e77 7261  get(&succ).unwra
-0000aa00: 7028 2920 3d3d 2030 207b 0a20 2020 2020  p() == 0 {.     
-0000aa10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000aa20: 6578 745f 6c61 7965 722e 7075 7368 2873  ext_layer.push(s
-0000aa30: 7563 6329 3b0a 2020 2020 2020 2020 2020  ucc);.          
-0000aa40: 2020 2020 2020 2020 2020 7072 6564 6563            predec
-0000aa50: 6573 736f 725f 636f 756e 742e 7265 6d6f  essor_count.remo
-0000aa60: 7665 2826 7375 6363 293b 0a20 2020 2020  ve(&succ);.     
-0000aa70: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0000aa80: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0000aa90: 2020 207d 0a20 2020 2020 2020 206c 6574     }.        let
-0000aaa0: 206d 7574 206c 6179 6572 5f6e 6f64 655f   mut layer_node_
-0000aab0: 6461 7461 3a20 5665 633c 2650 794f 626a  data: Vec<&PyObj
-0000aac0: 6563 743e 203d 2056 6563 3a3a 6e65 7728  ect> = Vec::new(
-0000aad0: 293b 0a20 2020 2020 2020 2066 6f72 206c  );.        for l
-0000aae0: 6179 6572 5f6e 6f64 6520 696e 2026 6e65  ayer_node in &ne
-0000aaf0: 7874 5f6c 6179 6572 207b 0a20 2020 2020  xt_layer {.     
-0000ab00: 2020 2020 2020 206c 6179 6572 5f6e 6f64         layer_nod
-0000ab10: 655f 6461 7461 2e70 7573 6828 2664 6167  e_data.push(&dag
-0000ab20: 5b2a 6c61 7965 725f 6e6f 6465 5d29 3b0a  [*layer_node]);.
-0000ab30: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0000ab40: 2020 6966 2021 6c61 7965 725f 6e6f 6465    if !layer_node
-0000ab50: 5f64 6174 612e 6973 5f65 6d70 7479 2829  _data.is_empty()
-0000ab60: 207b 0a20 2020 2020 2020 2020 2020 206f   {.            o
-0000ab70: 7574 7075 742e 7075 7368 286c 6179 6572  utput.push(layer
-0000ab80: 5f6e 6f64 655f 6461 7461 293b 0a20 2020  _node_data);.   
-0000ab90: 2020 2020 207d 0a20 2020 2020 2020 2063       }.        c
-0000aba0: 7572 5f6c 6179 6572 203d 206e 6578 745f  ur_layer = next_
-0000abb0: 6c61 7965 723b 0a20 2020 2020 2020 206e  layer;.        n
-0000abc0: 6578 745f 6c61 7965 7220 3d20 5665 633a  ext_layer = Vec:
-0000abd0: 3a6e 6577 2829 3b0a 2020 2020 7d0a 2020  :new();.    }.  
-0000abe0: 2020 4f6b 2850 794c 6973 743a 3a6e 6577    Ok(PyList::new
-0000abf0: 2870 792c 206f 7574 7075 7429 2e69 6e74  (py, output).int
-0000ac00: 6f28 2929 0a7d 0a0a 2f2f 2f20 4765 7420  o()).}../// Get 
-0000ac10: 7468 6520 6469 7374 616e 6365 206d 6174  the distance mat
-0000ac20: 7269 7820 666f 7220 6120 6469 7265 6374  rix for a direct
-0000ac30: 6564 2067 7261 7068 0a2f 2f2f 0a2f 2f2f  ed graph.///.///
-0000ac40: 2054 6869 7320 6469 6666 6572 7320 6672   This differs fr
-0000ac50: 6f6d 2066 756e 6374 696f 6e73 206c 696b  om functions lik
-0000ac60: 6520 6469 6772 6170 685f 666c 6f79 645f  e digraph_floyd_
-0000ac70: 7761 7273 6861 6c6c 5f6e 756d 7079 2069  warshall_numpy i
-0000ac80: 6e20 7468 6174 2074 6865 0a2f 2f2f 2065  n that the./// e
-0000ac90: 6467 6520 7765 6967 6874 2f64 6174 6120  dge weight/data 
-0000aca0: 7061 796c 6f61 6420 6973 206e 6f74 2075  payload is not u
-0000acb0: 7365 6420 616e 6420 6561 6368 2065 6467  sed and each edg
-0000acc0: 6520 6973 2074 7265 6174 6564 2061 7320  e is treated as 
-0000acd0: 610a 2f2f 2f20 6469 7374 616e 6365 206f  a./// distance o
-0000ace0: 6620 312e 0a2f 2f2f 0a2f 2f2f 2054 6869  f 1..///./// Thi
-0000acf0: 7320 6675 6e63 7469 6f6e 2069 7320 616c  s function is al
-0000ad00: 736f 206d 756c 7469 7468 7265 6164 6564  so multithreaded
-0000ad10: 2061 6e64 2077 696c 6c20 7275 6e20 696e   and will run in
-0000ad20: 2070 6172 616c 6c65 6c20 6966 2074 6865   parallel if the
-0000ad30: 206e 756d 6265 720a 2f2f 2f20 6f66 206e   number./// of n
-0000ad40: 6f64 6573 2069 6e20 7468 6520 6772 6170  odes in the grap
-0000ad50: 6820 6973 2061 626f 7665 2074 6865 2076  h is above the v
-0000ad60: 616c 7565 206f 6620 6060 7061 7261 6c6c  alue of ``parall
-0000ad70: 656c 5f74 6872 6573 686f 6c64 6060 2028  el_threshold`` (
-0000ad80: 6974 0a2f 2f2f 2064 6566 6175 6c74 7320  it./// defaults 
-0000ad90: 746f 2033 3030 292e 2049 6620 7468 6520  to 300). If the 
-0000ada0: 6675 6e63 7469 6f6e 2077 696c 6c20 6265  function will be
-0000adb0: 2072 756e 6e69 6e67 2069 6e20 7061 7261   running in para
-0000adc0: 6c6c 656c 2074 6865 2065 6e76 2076 6172  llel the env var
-0000add0: 0a2f 2f2f 2060 6052 4159 4f4e 5f4e 554d  ./// ``RAYON_NUM
-0000ade0: 5f54 4852 4541 4453 6060 2063 616e 2062  _THREADS`` can b
-0000adf0: 6520 7573 6564 2074 6f20 6164 6a75 7374  e used to adjust
-0000ae00: 2068 6f77 206d 616e 7920 7468 7265 6164   how many thread
-0000ae10: 7320 7769 6c6c 2062 6520 7573 6564 2e0a  s will be used..
-0000ae20: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
-0000ae30: 7944 6947 7261 7068 2067 7261 7068 3a20  yDiGraph graph: 
-0000ae40: 5468 6520 6772 6170 6820 746f 2067 6574  The graph to get
-0000ae50: 2074 6865 2064 6973 7461 6e63 6520 6d61   the distance ma
-0000ae60: 7472 6978 2066 6f72 0a2f 2f2f 203a 7061  trix for./// :pa
-0000ae70: 7261 6d20 696e 7420 7061 7261 6c6c 656c  ram int parallel
-0000ae80: 5f74 6872 6573 686f 6c64 3a20 5468 6520  _threshold: The 
-0000ae90: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
-0000aea0: 746f 2063 616c 6375 6c61 7465 2074 6865  to calculate the
-0000aeb0: 0a2f 2f2f 2020 2020 2074 6865 2064 6973  .///     the dis
-0000aec0: 7461 6e63 6520 6d61 7472 6978 2069 6e20  tance matrix in 
-0000aed0: 7061 7261 6c6c 656c 2061 742e 2049 7420  parallel at. It 
-0000aee0: 6465 6661 756c 7473 2074 6f20 3330 302c  defaults to 300,
-0000aef0: 2062 7574 2074 6869 7320 6361 6e0a 2f2f   but this can.//
-0000af00: 2f20 2020 2020 6265 2074 756e 6564 0a2f  /     be tuned./
-0000af10: 2f2f 203a 7061 7261 6d20 626f 6f6c 2061  // :param bool a
-0000af20: 735f 756e 6469 7265 6374 6564 3a20 4966  s_undirected: If
-0000af30: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-0000af40: 2074 6865 2069 6e70 7574 2064 6972 6563   the input direc
-0000af50: 7465 6420 6772 6170 680a 2f2f 2f20 2020  ted graph.///   
-0000af60: 2020 7769 6c6c 2062 6520 7472 6561 7420    will be treat 
-0000af70: 6173 2069 6620 6561 6368 2065 6467 6520  as if each edge 
-0000af80: 7761 7320 6269 6469 7265 6374 696f 6e61  was bidirectiona
-0000af90: 6c2f 756e 6469 7265 6374 6564 2069 6e20  l/undirected in 
-0000afa0: 7468 650a 2f2f 2f20 2020 2020 6f75 7470  the.///     outp
-0000afb0: 7574 2064 6973 7461 6e63 6520 6d61 7472  ut distance matr
-0000afc0: 6978 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  ix..///./// :ret
-0000afd0: 7572 6e73 3a20 5468 6520 6469 7374 616e  urns: The distan
-0000afe0: 6365 206d 6174 7269 780a 2f2f 2f20 3a72  ce matrix./// :r
-0000aff0: 7479 7065 3a20 6e75 6d70 792e 6e64 6172  type: numpy.ndar
-0000b000: 7261 790a 235b 7079 6675 6e63 7469 6f6e  ray.#[pyfunction
-0000b010: 2870 6172 616c 6c65 6c5f 7468 7265 7368  (parallel_thresh
-0000b020: 6f6c 6420 3d20 2233 3030 222c 2061 735f  old = "300", as_
-0000b030: 756e 6469 7265 6374 6564 203d 2022 6661  undirected = "fa
-0000b040: 6c73 6522 295d 0a23 5b74 6578 745f 7369  lse")].#[text_si
-0000b050: 676e 6174 7572 6520 3d20 2228 6772 6170  gnature = "(grap
-0000b060: 682c 202f 2c20 7061 7261 6c6c 656c 5f74  h, /, parallel_t
-0000b070: 6872 6573 686f 6c64 3d33 3030 2c20 6173  hreshold=300, as
-0000b080: 5f75 6e64 6972 6563 7465 643d 4661 6c73  _undirected=Fals
-0000b090: 6529 225d 0a70 7562 2066 6e20 6469 6772  e)"].pub fn digr
-0000b0a0: 6170 685f 6469 7374 616e 6365 5f6d 6174  aph_distance_mat
-0000b0b0: 7269 7828 0a20 2020 2070 793a 2050 7974  rix(.    py: Pyt
-0000b0c0: 686f 6e2c 0a20 2020 2067 7261 7068 3a20  hon,.    graph: 
-0000b0d0: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
-0000b0e0: 6170 682c 0a20 2020 2070 6172 616c 6c65  aph,.    paralle
-0000b0f0: 6c5f 7468 7265 7368 6f6c 643a 2075 7369  l_threshold: usi
-0000b100: 7a65 2c0a 2020 2020 6173 5f75 6e64 6972  ze,.    as_undir
-0000b110: 6563 7465 643a 2062 6f6f 6c2c 0a29 202d  ected: bool,.) -
-0000b120: 3e20 5079 5265 7375 6c74 3c50 794f 626a  > PyResult<PyObj
-0000b130: 6563 743e 207b 0a20 2020 206c 6574 206e  ect> {.    let n
-0000b140: 203d 2067 7261 7068 2e6e 6f64 655f 636f   = graph.node_co
-0000b150: 756e 7428 293b 0a20 2020 206c 6574 206d  unt();.    let m
-0000b160: 7574 206d 6174 7269 7820 3d20 4172 7261  ut matrix = Arra
-0000b170: 7932 3a3a 3c66 3634 3e3a 3a7a 6572 6f73  y2::<f64>::zeros
-0000b180: 2828 6e2c 206e 2929 3b0a 2020 2020 6c65  ((n, n));.    le
-0000b190: 7420 6266 735f 7472 6176 6572 7361 6c20  t bfs_traversal 
-0000b1a0: 3d20 7c69 6e64 6578 3a20 7573 697a 652c  = |index: usize,
-0000b1b0: 206d 7574 2072 6f77 3a20 4172 7261 7956   mut row: ArrayV
-0000b1c0: 6965 774d 7574 313c 6636 343e 7c20 7b0a  iewMut1<f64>| {.
-0000b1d0: 2020 2020 2020 2020 6c65 7420 6d75 7420          let mut 
-0000b1e0: 7365 656e 3a20 4861 7368 4d61 703c 4e6f  seen: HashMap<No
-0000b1f0: 6465 496e 6465 782c 2075 7369 7a65 3e20  deIndex, usize> 
-0000b200: 3d20 4861 7368 4d61 703a 3a77 6974 685f  = HashMap::with_
-0000b210: 6361 7061 6369 7479 286e 293b 0a20 2020  capacity(n);.   
-0000b220: 2020 2020 206c 6574 2073 7461 7274 5f69       let start_i
-0000b230: 6e64 6578 203d 204e 6f64 6549 6e64 6578  ndex = NodeIndex
-0000b240: 3a3a 6e65 7728 696e 6465 7829 3b0a 2020  ::new(index);.  
-0000b250: 2020 2020 2020 6c65 7420 6d75 7420 6c65        let mut le
-0000b260: 7665 6c20 3d20 303b 0a20 2020 2020 2020  vel = 0;.       
-0000b270: 206c 6574 206d 7574 206e 6578 745f 6c65   let mut next_le
-0000b280: 7665 6c3a 2048 6173 6853 6574 3c4e 6f64  vel: HashSet<Nod
-0000b290: 6549 6e64 6578 3e20 3d20 4861 7368 5365  eIndex> = HashSe
-0000b2a0: 743a 3a6e 6577 2829 3b0a 2020 2020 2020  t::new();.      
-0000b2b0: 2020 6e65 7874 5f6c 6576 656c 2e69 6e73    next_level.ins
-0000b2c0: 6572 7428 7374 6172 745f 696e 6465 7829  ert(start_index)
-0000b2d0: 3b0a 2020 2020 2020 2020 7768 696c 6520  ;.        while 
-0000b2e0: 216e 6578 745f 6c65 7665 6c2e 6973 5f65  !next_level.is_e
-0000b2f0: 6d70 7479 2829 207b 0a20 2020 2020 2020  mpty() {.       
-0000b300: 2020 2020 206c 6574 2074 6869 735f 6c65       let this_le
-0000b310: 7665 6c20 3d20 6e65 7874 5f6c 6576 656c  vel = next_level
-0000b320: 3b0a 2020 2020 2020 2020 2020 2020 6e65  ;.            ne
-0000b330: 7874 5f6c 6576 656c 203d 2048 6173 6853  xt_level = HashS
-0000b340: 6574 3a3a 6e65 7728 293b 0a20 2020 2020  et::new();.     
-0000b350: 2020 2020 2020 206c 6574 206d 7574 2066         let mut f
-0000b360: 6f75 6e64 3a20 5665 633c 4e6f 6465 496e  ound: Vec<NodeIn
-0000b370: 6465 783e 203d 2056 6563 3a3a 6e65 7728  dex> = Vec::new(
-0000b380: 293b 0a20 2020 2020 2020 2020 2020 2066  );.            f
-0000b390: 6f72 2076 2069 6e20 7468 6973 5f6c 6576  or v in this_lev
-0000b3a0: 656c 207b 0a20 2020 2020 2020 2020 2020  el {.           
-0000b3b0: 2020 2020 2069 6620 2173 6565 6e2e 636f       if !seen.co
-0000b3c0: 6e74 6169 6e73 5f6b 6579 2826 7629 207b  ntains_key(&v) {
-0000b3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b3e0: 2020 2020 2073 6565 6e2e 696e 7365 7274       seen.insert
-0000b3f0: 2876 2c20 6c65 7665 6c29 3b0a 2020 2020  (v, level);.    
-0000b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b410: 666f 756e 642e 7075 7368 2876 293b 0a20  found.push(v);. 
-0000b420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b430: 2020 2072 6f77 5b5b 762e 696e 6465 7828     row[[v.index(
-0000b440: 295d 5d20 3d20 6c65 7665 6c20 6173 2066  )]] = level as f
-0000b450: 3634 3b0a 2020 2020 2020 2020 2020 2020  64;.            
-0000b460: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-0000b470: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-0000b480: 6966 2073 6565 6e2e 6c65 6e28 2920 3d3d  if seen.len() ==
-0000b490: 206e 207b 0a20 2020 2020 2020 2020 2020   n {.           
-0000b4a0: 2020 2020 2072 6574 7572 6e3b 0a20 2020       return;.   
-0000b4b0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0000b4c0: 2020 2020 2020 2066 6f72 206e 6f64 6520         for node 
-0000b4d0: 696e 2066 6f75 6e64 207b 0a20 2020 2020  in found {.     
-0000b4e0: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-0000b4f0: 2069 6e20 6772 6170 680a 2020 2020 2020   in graph.      
-0000b500: 2020 2020 2020 2020 2020 2020 2020 2e67                .g
-0000b510: 7261 7068 0a20 2020 2020 2020 2020 2020  raph.           
-0000b520: 2020 2020 2020 2020 202e 6e65 6967 6862           .neighb
-0000b530: 6f72 735f 6469 7265 6374 6564 286e 6f64  ors_directed(nod
-0000b540: 652c 2070 6574 6772 6170 683a 3a44 6972  e, petgraph::Dir
-0000b550: 6563 7469 6f6e 3a3a 4f75 7467 6f69 6e67  ection::Outgoing
-0000b560: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000b570: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-0000b580: 2020 2020 2020 2020 6e65 7874 5f6c 6576          next_lev
-0000b590: 656c 2e69 6e73 6572 7428 7629 3b0a 2020  el.insert(v);.  
-0000b5a0: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-0000b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b5c0: 6966 2061 735f 756e 6469 7265 6374 6564  if as_undirected
-0000b5d0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0000b5e0: 2020 2020 2020 2066 6f72 2076 2069 6e20         for v in 
-0000b5f0: 6772 6170 680a 2020 2020 2020 2020 2020  graph.          
-0000b600: 2020 2020 2020 2020 2020 2020 2020 2e67                .g
-0000b610: 7261 7068 0a20 2020 2020 2020 2020 2020  raph.           
-0000b620: 2020 2020 2020 2020 2020 2020 202e 6e65               .ne
-0000b630: 6967 6862 6f72 735f 6469 7265 6374 6564  ighbors_directed
-0000b640: 286e 6f64 652c 2070 6574 6772 6170 683a  (node, petgraph:
-0000b650: 3a44 6972 6563 7469 6f6e 3a3a 496e 636f  :Direction::Inco
-0000b660: 6d69 6e67 290a 2020 2020 2020 2020 2020  ming).          
-0000b670: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0000b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b690: 2020 2020 6e65 7874 5f6c 6576 656c 2e69      next_level.i
-0000b6a0: 6e73 6572 7428 7629 3b0a 2020 2020 2020  nsert(v);.      
-0000b6b0: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-0000b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b6d0: 7d0a 2020 2020 2020 2020 2020 2020 7d0a  }.            }.
-0000b6e0: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
-0000b6f0: 6c20 2b3d 2031 0a20 2020 2020 2020 207d  l += 1.        }
-0000b700: 0a20 2020 207d 3b0a 2020 2020 6966 206e  .    };.    if n
-0000b710: 203c 2070 6172 616c 6c65 6c5f 7468 7265   < parallel_thre
-0000b720: 7368 6f6c 6420 7b0a 2020 2020 2020 2020  shold {.        
-0000b730: 6d61 7472 6978 0a20 2020 2020 2020 2020  matrix.         
-0000b740: 2020 202e 6178 6973 5f69 7465 725f 6d75     .axis_iter_mu
-0000b750: 7428 4178 6973 2830 2929 0a20 2020 2020  t(Axis(0)).     
-0000b760: 2020 2020 2020 202e 656e 756d 6572 6174         .enumerat
-0000b770: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0000b780: 2e66 6f72 5f65 6163 6828 7c28 696e 6465  .for_each(|(inde
-0000b790: 782c 2072 6f77 297c 2062 6673 5f74 7261  x, row)| bfs_tra
-0000b7a0: 7665 7273 616c 2869 6e64 6578 2c20 726f  versal(index, ro
-0000b7b0: 7729 293b 0a20 2020 207d 2065 6c73 6520  w));.    } else 
-0000b7c0: 7b0a 2020 2020 2020 2020 2f2f 2050 6172  {.        // Par
-0000b7d0: 616c 6c65 6c69 7a65 2062 7920 726f 7720  allelize by row 
-0000b7e0: 616e 6420 6974 6572 6174 6520 6672 6f6d  and iterate from
-0000b7f0: 2065 6163 6820 726f 7720 696e 6465 7820   each row index 
-0000b800: 696e 2042 4653 206f 7264 6572 0a20 2020  in BFS order.   
-0000b810: 2020 2020 206d 6174 7269 780a 2020 2020       matrix.    
-0000b820: 2020 2020 2020 2020 2e61 7869 735f 6974          .axis_it
-0000b830: 6572 5f6d 7574 2841 7869 7328 3029 290a  er_mut(Axis(0)).
-0000b840: 2020 2020 2020 2020 2020 2020 2e69 6e74              .int
-0000b850: 6f5f 7061 725f 6974 6572 2829 0a20 2020  o_par_iter().   
-0000b860: 2020 2020 2020 2020 202e 656e 756d 6572           .enumer
-0000b870: 6174 6528 290a 2020 2020 2020 2020 2020  ate().          
-0000b880: 2020 2e66 6f72 5f65 6163 6828 7c28 696e    .for_each(|(in
-0000b890: 6465 782c 2072 6f77 297c 2062 6673 5f74  dex, row)| bfs_t
-0000b8a0: 7261 7665 7273 616c 2869 6e64 6578 2c20  raversal(index, 
-0000b8b0: 726f 7729 293b 0a20 2020 207d 0a20 2020  row));.    }.   
-0000b8c0: 204f 6b28 6d61 7472 6978 2e69 6e74 6f5f   Ok(matrix.into_
-0000b8d0: 7079 6172 7261 7928 7079 292e 696e 746f  pyarray(py).into
-0000b8e0: 2829 290a 7d0a 0a2f 2f2f 2047 6574 2074  ()).}../// Get t
-0000b8f0: 6865 2064 6973 7461 6e63 6520 6d61 7472  he distance matr
-0000b900: 6978 2066 6f72 2061 6e20 756e 6469 7265  ix for an undire
-0000b910: 6374 6564 2067 7261 7068 0a2f 2f2f 0a2f  cted graph.///./
-0000b920: 2f2f 2054 6869 7320 6469 6666 6572 7320  // This differs 
-0000b930: 6672 6f6d 2066 756e 6374 696f 6e73 206c  from functions l
-0000b940: 696b 6520 6469 6772 6170 685f 666c 6f79  ike digraph_floy
-0000b950: 645f 7761 7273 6861 6c6c 5f6e 756d 7079  d_warshall_numpy
-0000b960: 2069 6e20 7468 6174 2074 6865 0a2f 2f2f   in that the.///
-0000b970: 2065 6467 6520 7765 6967 6874 2f64 6174   edge weight/dat
-0000b980: 6120 7061 796c 6f61 6420 6973 206e 6f74  a payload is not
-0000b990: 2075 7365 6420 616e 6420 6561 6368 2065   used and each e
-0000b9a0: 6467 6520 6973 2074 7265 6174 6564 2061  dge is treated a
-0000b9b0: 7320 610a 2f2f 2f20 6469 7374 616e 6365  s a./// distance
-0000b9c0: 206f 6620 312e 0a2f 2f2f 0a2f 2f2f 2054   of 1..///./// T
-0000b9d0: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-0000b9e0: 616c 736f 206d 756c 7469 7468 7265 6164  also multithread
-0000b9f0: 6564 2061 6e64 2077 696c 6c20 7275 6e20  ed and will run 
-0000ba00: 696e 2070 6172 616c 6c65 6c20 6966 2074  in parallel if t
-0000ba10: 6865 206e 756d 6265 720a 2f2f 2f20 6f66  he number./// of
-0000ba20: 206e 6f64 6573 2069 6e20 7468 6520 6772   nodes in the gr
-0000ba30: 6170 6820 6973 2061 626f 7665 2074 6865  aph is above the
-0000ba40: 2076 616c 7565 206f 6620 6060 7061 7261   value of ``para
-0000ba50: 6c6c 6c65 6c5f 7468 7265 7368 6f6c 6460  lllel_threshold`
-0000ba60: 6020 2869 740a 2f2f 2f20 6465 6661 756c  ` (it./// defaul
-0000ba70: 7473 2074 6f20 3330 3029 2e20 4966 2074  ts to 300). If t
-0000ba80: 6865 2066 756e 6374 696f 6e20 7769 6c6c  he function will
-0000ba90: 2062 6520 7275 6e6e 696e 6720 696e 2070   be running in p
-0000baa0: 6172 616c 6c65 6c20 7468 6520 656e 7620  arallel the env 
-0000bab0: 7661 720a 2f2f 2f20 6060 5241 594f 4e5f  var./// ``RAYON_
-0000bac0: 4e55 4d5f 5448 5245 4144 5360 6020 6361  NUM_THREADS`` ca
-0000bad0: 6e20 6265 2075 7365 6420 746f 2061 646a  n be used to adj
-0000bae0: 7573 7420 686f 7720 6d61 6e79 2074 6872  ust how many thr
-0000baf0: 6561 6473 2077 696c 6c20 6265 2075 7365  eads will be use
-0000bb00: 642e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  d..///./// :para
-0000bb10: 6d20 5079 4772 6170 6820 6772 6170 683a  m PyGraph graph:
-0000bb20: 2054 6865 2067 7261 7068 2074 6f20 6765   The graph to ge
-0000bb30: 7420 7468 6520 6469 7374 616e 6365 206d  t the distance m
-0000bb40: 6174 7269 7820 666f 720a 2f2f 2f20 3a70  atrix for./// :p
-0000bb50: 6172 616d 2069 6e74 2070 6172 616c 6c65  aram int paralle
-0000bb60: 6c5f 7468 7265 7368 6f6c 643a 2054 6865  l_threshold: The
-0000bb70: 206e 756d 6265 7220 6f66 206e 6f64 6573   number of nodes
-0000bb80: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
-0000bb90: 650a 2f2f 2f20 2020 2020 7468 6520 6469  e.///     the di
-0000bba0: 7374 616e 6365 206d 6174 7269 7820 696e  stance matrix in
-0000bbb0: 2070 6172 616c 6c65 6c20 6174 2e20 4974   parallel at. It
-0000bbc0: 2064 6566 6175 6c74 7320 746f 2033 3030   defaults to 300
-0000bbd0: 2c20 6275 7420 7468 6973 2063 616e 0a2f  , but this can./
-0000bbe0: 2f2f 2020 2020 2062 6520 7475 6e65 640a  //     be tuned.
-0000bbf0: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
-0000bc00: 3a20 5468 6520 6469 7374 616e 6365 206d  : The distance m
-0000bc10: 6174 7269 780a 2f2f 2f20 3a72 7479 7065  atrix./// :rtype
-0000bc20: 3a20 6e75 6d70 792e 6e64 6172 7261 790a  : numpy.ndarray.
-0000bc30: 235b 7079 6675 6e63 7469 6f6e 2870 6172  #[pyfunction(par
-0000bc40: 616c 6c65 6c5f 7468 7265 7368 6f6c 6420  allel_threshold 
-0000bc50: 3d20 2233 3030 2229 5d0a 235b 7465 7874  = "300")].#[text
-0000bc60: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
-0000bc70: 7261 7068 2c20 2f2c 2070 6172 616c 6c65  raph, /, paralle
-0000bc80: 6c5f 7468 7265 7368 6f6c 643d 3330 3029  l_threshold=300)
-0000bc90: 225d 0a70 7562 2066 6e20 6772 6170 685f  "].pub fn graph_
-0000bca0: 6469 7374 616e 6365 5f6d 6174 7269 7828  distance_matrix(
-0000bcb0: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
-0000bcc0: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
-0000bcd0: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
-0000bce0: 2070 6172 616c 6c65 6c5f 7468 7265 7368   parallel_thresh
-0000bcf0: 6f6c 643a 2075 7369 7a65 2c0a 2920 2d3e  old: usize,.) ->
-0000bd00: 2050 7952 6573 756c 743c 5079 4f62 6a65   PyResult<PyObje
-0000bd10: 6374 3e20 7b0a 2020 2020 6c65 7420 6e20  ct> {.    let n 
-0000bd20: 3d20 6772 6170 682e 6e6f 6465 5f63 6f75  = graph.node_cou
-0000bd30: 6e74 2829 3b0a 2020 2020 6c65 7420 6d75  nt();.    let mu
-0000bd40: 7420 6d61 7472 6978 203d 2041 7272 6179  t matrix = Array
-0000bd50: 323a 3a3c 6636 343e 3a3a 7a65 726f 7328  2::<f64>::zeros(
-0000bd60: 286e 2c20 6e29 293b 0a20 2020 206c 6574  (n, n));.    let
-0000bd70: 2062 6673 5f74 7261 7665 7273 616c 203d   bfs_traversal =
-0000bd80: 207c 696e 6465 783a 2075 7369 7a65 2c20   |index: usize, 
-0000bd90: 6d75 7420 726f 773a 2041 7272 6179 5669  mut row: ArrayVi
-0000bda0: 6577 4d75 7431 3c66 3634 3e7c 207b 0a20  ewMut1<f64>| {. 
-0000bdb0: 2020 2020 2020 206c 6574 206d 7574 2073         let mut s
-0000bdc0: 6565 6e3a 2048 6173 684d 6170 3c4e 6f64  een: HashMap<Nod
-0000bdd0: 6549 6e64 6578 2c20 7573 697a 653e 203d  eIndex, usize> =
-0000bde0: 2048 6173 684d 6170 3a3a 7769 7468 5f63   HashMap::with_c
-0000bdf0: 6170 6163 6974 7928 6e29 3b0a 2020 2020  apacity(n);.    
-0000be00: 2020 2020 6c65 7420 7374 6172 745f 696e      let start_in
-0000be10: 6465 7820 3d20 4e6f 6465 496e 6465 783a  dex = NodeIndex:
-0000be20: 3a6e 6577 2869 6e64 6578 293b 0a20 2020  :new(index);.   
-0000be30: 2020 2020 206c 6574 206d 7574 206c 6576       let mut lev
-0000be40: 656c 203d 2030 3b0a 2020 2020 2020 2020  el = 0;.        
-0000be50: 6c65 7420 6d75 7420 6e65 7874 5f6c 6576  let mut next_lev
-0000be60: 656c 3a20 4861 7368 5365 743c 4e6f 6465  el: HashSet<Node
-0000be70: 496e 6465 783e 203d 2048 6173 6853 6574  Index> = HashSet
-0000be80: 3a3a 6e65 7728 293b 0a20 2020 2020 2020  ::new();.       
-0000be90: 206e 6578 745f 6c65 7665 6c2e 696e 7365   next_level.inse
-0000bea0: 7274 2873 7461 7274 5f69 6e64 6578 293b  rt(start_index);
-0000beb0: 0a20 2020 2020 2020 2077 6869 6c65 2021  .        while !
-0000bec0: 6e65 7874 5f6c 6576 656c 2e69 735f 656d  next_level.is_em
-0000bed0: 7074 7928 2920 7b0a 2020 2020 2020 2020  pty() {.        
-0000bee0: 2020 2020 6c65 7420 7468 6973 5f6c 6576      let this_lev
-0000bef0: 656c 203d 206e 6578 745f 6c65 7665 6c3b  el = next_level;
-0000bf00: 0a20 2020 2020 2020 2020 2020 206e 6578  .            nex
-0000bf10: 745f 6c65 7665 6c20 3d20 4861 7368 5365  t_level = HashSe
-0000bf20: 743a 3a6e 6577 2829 3b0a 2020 2020 2020  t::new();.      
-0000bf30: 2020 2020 2020 6c65 7420 6d75 7420 666f        let mut fo
-0000bf40: 756e 643a 2056 6563 3c4e 6f64 6549 6e64  und: Vec<NodeInd
-0000bf50: 6578 3e20 3d20 5665 633a 3a6e 6577 2829  ex> = Vec::new()
-0000bf60: 3b0a 2020 2020 2020 2020 2020 2020 666f  ;.            fo
-0000bf70: 7220 7620 696e 2074 6869 735f 6c65 7665  r v in this_leve
-0000bf80: 6c20 7b0a 2020 2020 2020 2020 2020 2020  l {.            
-0000bf90: 2020 2020 6966 2021 7365 656e 2e63 6f6e      if !seen.con
-0000bfa0: 7461 696e 735f 6b65 7928 2676 2920 7b0a  tains_key(&v) {.
-0000bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfc0: 2020 2020 7365 656e 2e69 6e73 6572 7428      seen.insert(
-0000bfd0: 762c 206c 6576 656c 293b 0a20 2020 2020  v, level);.     
-0000bfe0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000bff0: 6f75 6e64 2e70 7573 6828 7629 3b0a 2020  ound.push(v);.  
+00007970: 2020 6b65 793a 206d 6170 5f6b 6579 2c0a    key: map_key,.
+00007980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007990: 2020 2020 6e6f 6465 3a20 6368 696c 642c      node: child,
+000079a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000079b0: 207d 293b 0a20 2020 2020 2020 2020 2020   });.           
+000079c0: 2020 2020 2069 6e5f 6465 6772 6565 5f6d       in_degree_m
+000079d0: 6170 2e72 656d 6f76 6528 2663 6869 6c64  ap.remove(&child
+000079e0: 293b 0a20 2020 2020 2020 2020 2020 207d  );.            }
+000079f0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00007a00: 2020 206f 7574 5f6c 6973 742e 7075 7368     out_list.push
+00007a10: 2826 6461 672e 6772 6170 685b 6e6f 6465  (&dag.graph[node
+00007a20: 5d29 0a20 2020 207d 0a20 2020 204f 6b28  ]).    }.    Ok(
+00007a30: 5079 4c69 7374 3a3a 6e65 7728 7079 2c20  PyList::new(py, 
+00007a40: 6f75 745f 6c69 7374 292e 696e 746f 2829  out_list).into()
+00007a50: 290a 7d0a 0a2f 2f2f 2043 6f6c 6f72 2061  ).}../// Color a
+00007a60: 2050 7947 7261 7068 2075 7369 6e67 2061   PyGraph using a
+00007a70: 206c 6172 6765 7374 5f66 6972 7374 2073   largest_first s
+00007a80: 7472 6174 6567 7920 6772 6565 6479 2067  trategy greedy g
+00007a90: 7261 7068 2063 6f6c 6f72 696e 672e 0a2f  raph coloring../
+00007aa0: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
+00007ab0: 4772 6170 683a 2054 6865 2069 6e70 7574  Graph: The input
+00007ac0: 2050 7947 7261 7068 206f 626a 6563 7420   PyGraph object 
+00007ad0: 746f 2063 6f6c 6f72 0a2f 2f2f 0a2f 2f2f  to color.///.///
+00007ae0: 203a 7265 7475 726e 733a 2041 2064 6963   :returns: A dic
+00007af0: 7469 6f6e 6172 7920 7768 6572 6520 6b65  tionary where ke
+00007b00: 7973 2061 7265 206e 6f64 6520 696e 6469  ys are node indi
+00007b10: 6365 7320 616e 6420 7468 6520 7661 6c75  ces and the valu
+00007b20: 6520 6973 0a2f 2f2f 2020 2020 2074 6865  e is.///     the
+00007b30: 2063 6f6c 6f72 0a2f 2f2f 203a 7274 7970   color./// :rtyp
+00007b40: 653a 2064 6963 740a 235b 7079 6675 6e63  e: dict.#[pyfunc
+00007b50: 7469 6f6e 5d0a 235b 7465 7874 5f73 6967  tion].#[text_sig
+00007b60: 6e61 7475 7265 203d 2022 2867 7261 7068  nature = "(graph
+00007b70: 2c20 2f29 225d 0a66 6e20 6772 6170 685f  , /)"].fn graph_
+00007b80: 6772 6565 6479 5f63 6f6c 6f72 280a 2020  greedy_color(.  
+00007b90: 2020 7079 3a20 5079 7468 6f6e 2c0a 2020    py: Python,.  
+00007ba0: 2020 6772 6170 683a 2026 6772 6170 683a    graph: &graph:
+00007bb0: 3a50 7947 7261 7068 2c0a 2920 2d3e 2050  :PyGraph,.) -> P
+00007bc0: 7952 6573 756c 743c 5079 4f62 6a65 6374  yResult<PyObject
+00007bd0: 3e20 7b0a 2020 2020 6c65 7420 6d75 7420  > {.    let mut 
+00007be0: 636f 6c6f 7273 3a20 4861 7368 4d61 703c  colors: HashMap<
+00007bf0: 7573 697a 652c 2075 7369 7a65 3e20 3d20  usize, usize> = 
+00007c00: 4861 7368 4d61 703a 3a6e 6577 2829 3b0a  HashMap::new();.
+00007c10: 2020 2020 6c65 7420 6d75 7420 6e6f 6465      let mut node
+00007c20: 5f76 6563 3a20 5665 633c 4e6f 6465 496e  _vec: Vec<NodeIn
+00007c30: 6465 783e 203d 2067 7261 7068 2e67 7261  dex> = graph.gra
+00007c40: 7068 2e6e 6f64 655f 696e 6469 6365 7328  ph.node_indices(
+00007c50: 292e 636f 6c6c 6563 7428 293b 0a20 2020  ).collect();.   
+00007c60: 206c 6574 206d 7574 2073 6f72 745f 6d61   let mut sort_ma
+00007c70: 703a 2048 6173 684d 6170 3c4e 6f64 6549  p: HashMap<NodeI
+00007c80: 6e64 6578 2c20 7573 697a 653e 203d 0a20  ndex, usize> =. 
+00007c90: 2020 2020 2020 2048 6173 684d 6170 3a3a         HashMap::
+00007ca0: 7769 7468 5f63 6170 6163 6974 7928 6772  with_capacity(gr
+00007cb0: 6170 682e 6e6f 6465 5f63 6f75 6e74 2829  aph.node_count()
+00007cc0: 293b 0a20 2020 2066 6f72 206b 2069 6e20  );.    for k in 
+00007cd0: 6e6f 6465 5f76 6563 2e69 7465 7228 2920  node_vec.iter() 
+00007ce0: 7b0a 2020 2020 2020 2020 736f 7274 5f6d  {.        sort_m
+00007cf0: 6170 2e69 6e73 6572 7428 2a6b 2c20 6772  ap.insert(*k, gr
+00007d00: 6170 682e 6772 6170 682e 6564 6765 7328  aph.graph.edges(
+00007d10: 2a6b 292e 636f 756e 7428 2929 3b0a 2020  *k).count());.  
+00007d20: 2020 7d0a 2020 2020 6e6f 6465 5f76 6563    }.    node_vec
+00007d30: 2e70 6172 5f73 6f72 745f 6279 5f6b 6579  .par_sort_by_key
+00007d40: 287c 6b7c 2052 6576 6572 7365 2873 6f72  (|k| Reverse(sor
+00007d50: 745f 6d61 702e 6765 7428 6b29 2929 3b0a  t_map.get(k)));.
+00007d60: 2020 2020 666f 7220 755f 696e 6465 7820      for u_index 
+00007d70: 696e 206e 6f64 655f 7665 6320 7b0a 2020  in node_vec {.  
+00007d80: 2020 2020 2020 6c65 7420 6d75 7420 6e65        let mut ne
+00007d90: 6967 6862 6f72 5f63 6f6c 6f72 733a 2048  ighbor_colors: H
+00007da0: 6173 6853 6574 3c75 7369 7a65 3e20 3d20  ashSet<usize> = 
+00007db0: 4861 7368 5365 743a 3a6e 6577 2829 3b0a  HashSet::new();.
+00007dc0: 2020 2020 2020 2020 666f 7220 6564 6765          for edge
+00007dd0: 2069 6e20 6772 6170 682e 6772 6170 682e   in graph.graph.
+00007de0: 6564 6765 7328 755f 696e 6465 7829 207b  edges(u_index) {
+00007df0: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00007e00: 2074 6172 6765 7420 3d20 6564 6765 2e74   target = edge.t
+00007e10: 6172 6765 7428 292e 696e 6465 7828 293b  arget().index();
+00007e20: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00007e30: 2065 7869 7374 696e 675f 636f 6c6f 7220   existing_color 
+00007e40: 3d20 6d61 7463 6820 636f 6c6f 7273 2e67  = match colors.g
+00007e50: 6574 2826 7461 7267 6574 2920 7b0a 2020  et(&target) {.  
+00007e60: 2020 2020 2020 2020 2020 2020 2020 536f                So
+00007e70: 6d65 286e 6f64 6529 203d 3e20 6e6f 6465  me(node) => node
+00007e80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00007e90: 2020 4e6f 6e65 203d 3e20 636f 6e74 696e    None => contin
+00007ea0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00007eb0: 7d3b 0a20 2020 2020 2020 2020 2020 206e  };.            n
+00007ec0: 6569 6768 626f 725f 636f 6c6f 7273 2e69  eighbor_colors.i
+00007ed0: 6e73 6572 7428 2a65 7869 7374 696e 675f  nsert(*existing_
+00007ee0: 636f 6c6f 7229 3b0a 2020 2020 2020 2020  color);.        
+00007ef0: 7d0a 2020 2020 2020 2020 6c65 7420 6d75  }.        let mu
+00007f00: 7420 636f 756e 743a 2075 7369 7a65 203d  t count: usize =
+00007f10: 2030 3b0a 2020 2020 2020 2020 6c6f 6f70   0;.        loop
+00007f20: 207b 0a20 2020 2020 2020 2020 2020 2069   {.            i
+00007f30: 6620 216e 6569 6768 626f 725f 636f 6c6f  f !neighbor_colo
+00007f40: 7273 2e63 6f6e 7461 696e 7328 2663 6f75  rs.contains(&cou
+00007f50: 6e74 2920 7b0a 2020 2020 2020 2020 2020  nt) {.          
+00007f60: 2020 2020 2020 6272 6561 6b3b 0a20 2020        break;.   
+00007f70: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00007f80: 2020 2020 2020 2063 6f75 6e74 202b 3d20         count += 
+00007f90: 313b 0a20 2020 2020 2020 207d 0a20 2020  1;.        }.   
+00007fa0: 2020 2020 2063 6f6c 6f72 732e 696e 7365       colors.inse
+00007fb0: 7274 2875 5f69 6e64 6578 2e69 6e64 6578  rt(u_index.index
+00007fc0: 2829 2c20 636f 756e 7429 3b0a 2020 2020  (), count);.    
+00007fd0: 7d0a 2020 2020 6c65 7420 6f75 745f 6469  }.    let out_di
+00007fe0: 6374 203d 2050 7944 6963 743a 3a6e 6577  ct = PyDict::new
+00007ff0: 2870 7929 3b0a 2020 2020 666f 7220 2869  (py);.    for (i
+00008000: 6e64 6578 2c20 636f 6c6f 7229 2069 6e20  ndex, color) in 
+00008010: 636f 6c6f 7273 207b 0a20 2020 2020 2020  colors {.       
+00008020: 206f 7574 5f64 6963 742e 7365 745f 6974   out_dict.set_it
+00008030: 656d 2869 6e64 6578 2c20 636f 6c6f 7229  em(index, color)
+00008040: 3f3b 0a20 2020 207d 0a20 2020 204f 6b28  ?;.    }.    Ok(
+00008050: 6f75 745f 6469 6374 2e69 6e74 6f28 2929  out_dict.into())
+00008060: 0a7d 0a0a 2f2f 2f20 436f 6d70 7574 6520  .}../// Compute 
+00008070: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
+00008080: 6520 6b74 6820 7368 6f72 7465 7374 2070  e kth shortest p
+00008090: 6174 680a 2f2f 2f0a 2f2f 2f20 436f 6d70  ath.///./// Comp
+000080a0: 7574 6573 2074 6865 206c 656e 6774 6873  utes the lengths
+000080b0: 206f 6620 7468 6520 6b74 6820 7368 6f72   of the kth shor
+000080c0: 7465 7374 2070 6174 6820 6672 6f6d 2060  test path from `
+000080d0: 6073 7461 7274 6060 2074 6f20 6576 6572  `start`` to ever
+000080e0: 790a 2f2f 2f20 7265 6163 6861 626c 6520  y./// reachable 
+000080f0: 6e6f 6465 2e0a 2f2f 2f0a 2f2f 2f20 436f  node..///./// Co
+00008100: 6d70 7574 6573 2069 6e20 3a6d 6174 683a  mputes in :math:
+00008110: 604f 286b 202a 2028 7c45 7c20 2b20 7c56  `O(k * (|E| + |V
+00008120: 7c2a 6c6f 6728 7c56 7c29 2929 6020 7469  |*log(|V|)))` ti
+00008130: 6d65 2028 6176 6572 6167 6529 2e0a 2f2f  me (average)..//
+00008140: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7947  /./// :param PyG
+00008150: 7261 7068 2067 7261 7068 3a20 5468 6520  raph graph: The 
+00008160: 6772 6170 6820 746f 2066 696e 6420 7468  graph to find th
+00008170: 6520 7368 6f72 7465 7374 2070 6174 6873  e shortest paths
+00008180: 2069 6e0a 2f2f 2f20 3a70 6172 616d 2069   in./// :param i
+00008190: 6e74 2073 7461 7274 3a20 5468 6520 6e6f  nt start: The no
+000081a0: 6465 2069 6e64 6578 2074 6f20 6669 6e64  de index to find
+000081b0: 2074 6865 2073 686f 7274 6573 7420 7061   the shortest pa
+000081c0: 7468 7320 6672 6f6d 0a2f 2f2f 203a 7061  ths from./// :pa
+000081d0: 7261 6d20 696e 7420 6b3a 2054 6865 206b  ram int k: The k
+000081e0: 7468 2073 686f 7274 6573 7420 7061 7468  th shortest path
+000081f0: 2074 6f20 6669 6e64 2074 6865 206c 656e   to find the len
+00008200: 6774 6873 206f 660a 2f2f 2f20 3a70 6172  gths of./// :par
+00008210: 616d 2065 6467 655f 636f 7374 3a20 4120  am edge_cost: A 
+00008220: 7079 7468 6f6e 2063 616c 6c61 626c 6520  python callable 
+00008230: 7468 6174 2077 696c 6c20 7265 6365 6976  that will receiv
+00008240: 6520 616e 2065 6467 6520 7061 796c 6f61  e an edge payloa
+00008250: 6420 616e 640a 2f2f 2f20 2020 2020 7265  d and.///     re
+00008260: 7475 726e 2061 2066 6c6f 6174 2066 6f72  turn a float for
+00008270: 2074 6865 2063 6f73 7420 6f66 2074 6861   the cost of tha
+00008280: 7420 6565 6467 650a 2f2f 2f20 3a70 6172  t eedge./// :par
+00008290: 616d 2069 6e74 2067 6f61 6c3a 2041 6e20  am int goal: An 
+000082a0: 6f70 7469 6f6e 616c 2067 6f61 6c20 6e6f  optional goal no
+000082b0: 6465 2069 6e64 6578 2c20 6966 2073 7065  de index, if spe
+000082c0: 6369 6669 6564 2074 6865 206f 7574 7075  cified the outpu
+000082d0: 740a 2f2f 2f20 2020 2020 6469 6374 696f  t.///     dictio
+000082e0: 6e61 7279 0a2f 2f2f 0a2f 2f2f 203a 7265  nary.///./// :re
+000082f0: 7475 726e 733a 2041 2064 6963 7420 6f66  turns: A dict of
+00008300: 206c 656e 6774 6873 2077 6865 7265 2074   lengths where t
+00008310: 6865 206b 6579 2069 7320 7468 6520 6465  he key is the de
+00008320: 7374 696e 6174 696f 6e20 6e6f 6465 2069  stination node i
+00008330: 6e64 6578 2061 6e64 0a2f 2f2f 2020 2020  ndex and.///    
+00008340: 2074 6865 2076 616c 7565 2069 7320 7468   the value is th
+00008350: 6520 6c65 6e67 7468 206f 6620 7468 6520  e length of the 
+00008360: 7061 7468 2e0a 2f2f 2f20 3a72 7479 7065  path../// :rtype
+00008370: 3a20 5061 7468 4c65 6e67 7468 4d61 7070  : PathLengthMapp
+00008380: 696e 670a 235b 7079 6675 6e63 7469 6f6e  ing.#[pyfunction
+00008390: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+000083a0: 7265 203d 2022 2867 7261 7068 2c20 7374  re = "(graph, st
+000083b0: 6172 742c 206b 2c20 6564 6765 5f63 6f73  art, k, edge_cos
+000083c0: 742c 202f 2c20 676f 616c 3d4e 6f6e 6529  t, /, goal=None)
+000083d0: 225d 0a66 6e20 6469 6772 6170 685f 6b5f  "].fn digraph_k_
+000083e0: 7368 6f72 7465 7374 5f70 6174 685f 6c65  shortest_path_le
+000083f0: 6e67 7468 7328 0a20 2020 2070 793a 2050  ngths(.    py: P
+00008400: 7974 686f 6e2c 0a20 2020 2067 7261 7068  ython,.    graph
+00008410: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+00008420: 4772 6170 682c 0a20 2020 2073 7461 7274  Graph,.    start
+00008430: 3a20 7573 697a 652c 0a20 2020 206b 3a20  : usize,.    k: 
+00008440: 7573 697a 652c 0a20 2020 2065 6467 655f  usize,.    edge_
+00008450: 636f 7374 3a20 5079 4f62 6a65 6374 2c0a  cost: PyObject,.
+00008460: 2020 2020 676f 616c 3a20 4f70 7469 6f6e      goal: Option
+00008470: 3c75 7369 7a65 3e2c 0a29 202d 3e20 5079  <usize>,.) -> Py
+00008480: 5265 7375 6c74 3c50 6174 684c 656e 6774  Result<PathLengt
+00008490: 684d 6170 7069 6e67 3e20 7b0a 2020 2020  hMapping> {.    
+000084a0: 6c65 7420 6f75 745f 676f 616c 203d 2067  let out_goal = g
+000084b0: 6f61 6c2e 6d61 7028 4e6f 6465 496e 6465  oal.map(NodeInde
+000084c0: 783a 3a6e 6577 293b 0a20 2020 206c 6574  x::new);.    let
+000084d0: 2065 6467 655f 636f 7374 5f63 616c 6c61   edge_cost_calla
+000084e0: 626c 6520 3d20 7c65 6467 653a 2026 5079  ble = |edge: &Py
+000084f0: 4f62 6a65 6374 7c20 2d3e 2050 7952 6573  Object| -> PyRes
+00008500: 756c 743c 6636 343e 207b 0a20 2020 2020  ult<f64> {.     
+00008510: 2020 206c 6574 2072 6573 203d 2065 6467     let res = edg
+00008520: 655f 636f 7374 2e63 616c 6c31 2870 792c  e_cost.call1(py,
+00008530: 2028 6564 6765 2c29 293f 3b0a 2020 2020   (edge,))?;.    
+00008540: 2020 2020 7265 732e 6578 7472 6163 7428      res.extract(
+00008550: 7079 290a 2020 2020 7d3b 0a0a 2020 2020  py).    };..    
+00008560: 6c65 7420 6f75 745f 6d61 7020 3d20 6b5f  let out_map = k_
+00008570: 7368 6f72 7465 7374 5f70 6174 683a 3a6b  shortest_path::k
+00008580: 5f73 686f 7274 6573 745f 7061 7468 280a  _shortest_path(.
+00008590: 2020 2020 2020 2020 6772 6170 682c 0a20          graph,. 
+000085a0: 2020 2020 2020 204e 6f64 6549 6e64 6578         NodeIndex
+000085b0: 3a3a 6e65 7728 7374 6172 7429 2c0a 2020  ::new(start),.  
+000085c0: 2020 2020 2020 6f75 745f 676f 616c 2c0a        out_goal,.
+000085d0: 2020 2020 2020 2020 6b2c 0a20 2020 2020          k,.     
+000085e0: 2020 2065 6467 655f 636f 7374 5f63 616c     edge_cost_cal
+000085f0: 6c61 626c 652c 0a20 2020 2029 3f3b 0a20  lable,.    )?;. 
+00008600: 2020 204f 6b28 5061 7468 4c65 6e67 7468     Ok(PathLength
+00008610: 4d61 7070 696e 6720 7b0a 2020 2020 2020  Mapping {.      
+00008620: 2020 7061 7468 5f6c 656e 6774 6873 3a20    path_lengths: 
+00008630: 6f75 745f 6d61 700a 2020 2020 2020 2020  out_map.        
+00008640: 2020 2020 2e69 7465 7228 290a 2020 2020      .iter().    
+00008650: 2020 2020 2020 2020 2e66 696c 7465 725f          .filter_
+00008660: 6d61 7028 7c28 6b2c 2076 297c 207b 0a20  map(|(k, v)| {. 
+00008670: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00008680: 6574 206b 5f69 6e74 203d 206b 2e69 6e64  et k_int = k.ind
+00008690: 6578 2829 3b0a 2020 2020 2020 2020 2020  ex();.          
+000086a0: 2020 2020 2020 6966 2067 6f61 6c2e 6973        if goal.is
+000086b0: 5f73 6f6d 6528 2920 2626 2067 6f61 6c2e  _some() && goal.
+000086c0: 756e 7772 6170 2829 2021 3d20 6b5f 696e  unwrap() != k_in
+000086d0: 7420 7b0a 2020 2020 2020 2020 2020 2020  t {.            
+000086e0: 2020 2020 2020 2020 4e6f 6e65 0a20 2020          None.   
+000086f0: 2020 2020 2020 2020 2020 2020 207d 2065               } e
+00008700: 6c73 6520 7b0a 2020 2020 2020 2020 2020  lse {.          
+00008710: 2020 2020 2020 2020 2020 536f 6d65 2828            Some((
+00008720: 6b5f 696e 742c 202a 7629 290a 2020 2020  k_int, *v)).    
+00008730: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00008740: 2020 2020 2020 2020 2020 7d29 0a20 2020            }).   
+00008750: 2020 2020 2020 2020 202e 636f 6c6c 6563           .collec
+00008760: 7428 292c 0a20 2020 207d 290a 7d0a 0a2f  t(),.    }).}../
+00008770: 2f2f 2043 6f6d 7075 7465 2074 6865 206c  // Compute the l
+00008780: 656e 6774 6820 6f66 2074 6865 206b 7468  ength of the kth
+00008790: 2073 686f 7274 6573 7420 7061 7468 0a2f   shortest path./
+000087a0: 2f2f 0a2f 2f2f 2043 6f6d 7075 7465 7320  //./// Computes 
+000087b0: 7468 6520 6c65 6e67 7468 7320 6f66 2074  the lengths of t
+000087c0: 6865 206b 7468 2073 686f 7274 6573 7420  he kth shortest 
+000087d0: 7061 7468 2066 726f 6d20 6060 7374 6172  path from ``star
+000087e0: 7460 6020 746f 2065 7665 7279 0a2f 2f2f  t`` to every.///
+000087f0: 2072 6561 6368 6162 6c65 206e 6f64 652e   reachable node.
+00008800: 0a2f 2f2f 0a2f 2f2f 2043 6f6d 7075 7465  .///./// Compute
+00008810: 7320 696e 203a 6d61 7468 3a60 4f28 6b20  s in :math:`O(k 
+00008820: 2a20 287c 457c 202b 207c 567c 2a6c 6f67  * (|E| + |V|*log
+00008830: 287c 567c 2929 2960 2074 696d 6520 2861  (|V|)))` time (a
+00008840: 7665 7261 6765 292e 0a2f 2f2f 0a2f 2f2f  verage)..///.///
+00008850: 203a 7061 7261 6d20 5079 4772 6170 6820   :param PyGraph 
+00008860: 6772 6170 683a 2054 6865 2067 7261 7068  graph: The graph
+00008870: 2074 6f20 6669 6e64 2074 6865 2073 686f   to find the sho
+00008880: 7274 6573 7420 7061 7468 7320 696e 0a2f  rtest paths in./
+00008890: 2f2f 203a 7061 7261 6d20 696e 7420 7374  // :param int st
+000088a0: 6172 743a 2054 6865 206e 6f64 6520 696e  art: The node in
+000088b0: 6465 7820 746f 2066 696e 6420 7468 6520  dex to find the 
+000088c0: 7368 6f72 7465 7374 2070 6174 6873 2066  shortest paths f
+000088d0: 726f 6d0a 2f2f 2f20 3a70 6172 616d 2069  rom./// :param i
+000088e0: 6e74 206b 3a20 5468 6520 6b74 6820 7368  nt k: The kth sh
+000088f0: 6f72 7465 7374 2070 6174 6820 746f 2066  ortest path to f
+00008900: 696e 6420 7468 6520 6c65 6e67 7468 7320  ind the lengths 
+00008910: 6f66 0a2f 2f2f 203a 7061 7261 6d20 6564  of./// :param ed
+00008920: 6765 5f63 6f73 743a 2041 2070 7974 686f  ge_cost: A pytho
+00008930: 6e20 6361 6c6c 6162 6c65 2074 6861 7420  n callable that 
+00008940: 7769 6c6c 2072 6563 6569 7665 2061 6e20  will receive an 
+00008950: 6564 6765 2070 6179 6c6f 6164 2061 6e64  edge payload and
+00008960: 0a2f 2f2f 2020 2020 2072 6574 7572 6e20  .///     return 
+00008970: 6120 666c 6f61 7420 666f 7220 7468 6520  a float for the 
+00008980: 636f 7374 206f 6620 7468 6174 2065 6564  cost of that eed
+00008990: 6765 0a2f 2f2f 203a 7061 7261 6d20 696e  ge./// :param in
+000089a0: 7420 676f 616c 3a20 416e 206f 7074 696f  t goal: An optio
+000089b0: 6e61 6c20 676f 616c 206e 6f64 6520 696e  nal goal node in
+000089c0: 6465 782c 2069 6620 7370 6563 6966 6965  dex, if specifie
+000089d0: 6420 7468 6520 6f75 7470 7574 0a2f 2f2f  d the output.///
+000089e0: 2020 2020 2064 6963 7469 6f6e 6172 790a       dictionary.
+000089f0: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
+00008a00: 3a20 4120 6469 6374 206f 6620 6c65 6e67  : A dict of leng
+00008a10: 7468 7320 7768 6572 6520 7468 6520 6b65  ths where the ke
+00008a20: 7920 6973 2074 6865 2064 6573 7469 6e61  y is the destina
+00008a30: 7469 6f6e 206e 6f64 6520 696e 6465 7820  tion node index 
+00008a40: 616e 640a 2f2f 2f20 2020 2020 7468 6520  and.///     the 
+00008a50: 7661 6c75 6520 6973 2074 6865 206c 656e  value is the len
+00008a60: 6774 6820 6f66 2074 6865 2070 6174 682e  gth of the path.
+00008a70: 0a2f 2f2f 203a 7274 7970 653a 2050 6174  ./// :rtype: Pat
+00008a80: 684c 656e 6774 684d 6170 7069 6e67 0a23  hLengthMapping.#
+00008a90: 5b70 7966 756e 6374 696f 6e5d 0a23 5b74  [pyfunction].#[t
+00008aa0: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
+00008ab0: 2228 6772 6170 682c 2073 7461 7274 2c20  "(graph, start, 
+00008ac0: 6b2c 2065 6467 655f 636f 7374 2c20 2f2c  k, edge_cost, /,
+00008ad0: 2067 6f61 6c3d 4e6f 6e65 2922 5d0a 666e   goal=None)"].fn
+00008ae0: 2067 7261 7068 5f6b 5f73 686f 7274 6573   graph_k_shortes
+00008af0: 745f 7061 7468 5f6c 656e 6774 6873 280a  t_path_lengths(.
+00008b00: 2020 2020 7079 3a20 5079 7468 6f6e 2c0a      py: Python,.
+00008b10: 2020 2020 6772 6170 683a 2026 6772 6170      graph: &grap
+00008b20: 683a 3a50 7947 7261 7068 2c0a 2020 2020  h::PyGraph,.    
+00008b30: 7374 6172 743a 2075 7369 7a65 2c0a 2020  start: usize,.  
+00008b40: 2020 6b3a 2075 7369 7a65 2c0a 2020 2020    k: usize,.    
+00008b50: 6564 6765 5f63 6f73 743a 2050 794f 626a  edge_cost: PyObj
+00008b60: 6563 742c 0a20 2020 2067 6f61 6c3a 204f  ect,.    goal: O
+00008b70: 7074 696f 6e3c 7573 697a 653e 2c0a 2920  ption<usize>,.) 
+00008b80: 2d3e 2050 7952 6573 756c 743c 5061 7468  -> PyResult<Path
+00008b90: 4c65 6e67 7468 4d61 7070 696e 673e 207b  LengthMapping> {
+00008ba0: 0a20 2020 206c 6574 206f 7574 5f67 6f61  .    let out_goa
+00008bb0: 6c20 3d20 676f 616c 2e6d 6170 284e 6f64  l = goal.map(Nod
+00008bc0: 6549 6e64 6578 3a3a 6e65 7729 3b0a 2020  eIndex::new);.  
+00008bd0: 2020 6c65 7420 6564 6765 5f63 6f73 745f    let edge_cost_
+00008be0: 6361 6c6c 6162 6c65 203d 207c 6564 6765  callable = |edge
+00008bf0: 3a20 2650 794f 626a 6563 747c 202d 3e20  : &PyObject| -> 
+00008c00: 5079 5265 7375 6c74 3c66 3634 3e20 7b0a  PyResult<f64> {.
+00008c10: 2020 2020 2020 2020 6c65 7420 7265 7320          let res 
+00008c20: 3d20 6564 6765 5f63 6f73 742e 6361 6c6c  = edge_cost.call
+00008c30: 3128 7079 2c20 2865 6467 652c 2929 3f3b  1(py, (edge,))?;
+00008c40: 0a20 2020 2020 2020 2072 6573 2e65 7874  .        res.ext
+00008c50: 7261 6374 2870 7929 0a20 2020 207d 3b0a  ract(py).    };.
+00008c60: 0a20 2020 206c 6574 206f 7574 5f6d 6170  .    let out_map
+00008c70: 203d 206b 5f73 686f 7274 6573 745f 7061   = k_shortest_pa
+00008c80: 7468 3a3a 6b5f 7368 6f72 7465 7374 5f70  th::k_shortest_p
+00008c90: 6174 6828 0a20 2020 2020 2020 2067 7261  ath(.        gra
+00008ca0: 7068 2c0a 2020 2020 2020 2020 4e6f 6465  ph,.        Node
+00008cb0: 496e 6465 783a 3a6e 6577 2873 7461 7274  Index::new(start
+00008cc0: 292c 0a20 2020 2020 2020 206f 7574 5f67  ),.        out_g
+00008cd0: 6f61 6c2c 0a20 2020 2020 2020 206b 2c0a  oal,.        k,.
+00008ce0: 2020 2020 2020 2020 6564 6765 5f63 6f73          edge_cos
+00008cf0: 745f 6361 6c6c 6162 6c65 2c0a 2020 2020  t_callable,.    
+00008d00: 293f 3b0a 2020 2020 4f6b 2850 6174 684c  )?;.    Ok(PathL
+00008d10: 656e 6774 684d 6170 7069 6e67 207b 0a20  engthMapping {. 
+00008d20: 2020 2020 2020 2070 6174 685f 6c65 6e67         path_leng
+00008d30: 7468 733a 206f 7574 5f6d 6170 0a20 2020  ths: out_map.   
+00008d40: 2020 2020 2020 2020 202e 6974 6572 2829           .iter()
+00008d50: 0a20 2020 2020 2020 2020 2020 202e 6669  .            .fi
+00008d60: 6c74 6572 5f6d 6170 287c 286b 2c20 7629  lter_map(|(k, v)
+00008d70: 7c20 7b0a 2020 2020 2020 2020 2020 2020  | {.            
+00008d80: 2020 2020 6c65 7420 6b5f 696e 7420 3d20      let k_int = 
+00008d90: 6b2e 696e 6465 7828 293b 0a20 2020 2020  k.index();.     
+00008da0: 2020 2020 2020 2020 2020 2069 6620 676f             if go
+00008db0: 616c 2e69 735f 736f 6d65 2829 2026 2620  al.is_some() && 
+00008dc0: 676f 616c 2e75 6e77 7261 7028 2920 213d  goal.unwrap() !=
+00008dd0: 206b 5f69 6e74 207b 0a20 2020 2020 2020   k_int {.       
+00008de0: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
+00008df0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00008e00: 2020 7d20 656c 7365 207b 0a20 2020 2020    } else {.     
+00008e10: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00008e20: 6f6d 6528 286b 5f69 6e74 2c20 2a76 2929  ome((k_int, *v))
+00008e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008e40: 207d 0a20 2020 2020 2020 2020 2020 207d   }.            }
+00008e50: 290a 2020 2020 2020 2020 2020 2020 2e63  ).            .c
+00008e60: 6f6c 6c65 6374 2829 2c0a 2020 2020 7d29  ollect(),.    })
+00008e70: 0a7d 0a2f 2f2f 2052 6574 7572 6e20 7468  .}./// Return th
+00008e80: 6520 7368 6f72 7465 7374 2070 6174 6820  e shortest path 
+00008e90: 6c65 6e67 7468 7320 6265 7477 6565 6e20  lengths between 
+00008ea0: 6576 6572 2070 6169 7220 6f66 206e 6f64  ever pair of nod
+00008eb0: 6573 2074 6861 7420 6861 7320 610a 2f2f  es that has a.//
+00008ec0: 2f20 7061 7468 2063 6f6e 6e65 6374 696e  / path connectin
+00008ed0: 6720 7468 656d 0a2f 2f2f 0a2f 2f2f 2054  g them.///./// T
+00008ee0: 6865 2072 756e 7469 6d65 2069 7320 3a6d  he runtime is :m
+00008ef0: 6174 683a 604f 287c 4e7c 5e33 202b 207c  ath:`O(|N|^3 + |
+00008f00: 457c 2960 2077 6865 7265 203a 6d61 7468  E|)` where :math
+00008f10: 3a60 7c4e 7c60 2069 7320 7468 6520 6e75  :`|N|` is the nu
+00008f20: 6d62 6572 0a2f 2f2f 206f 6620 6e6f 6465  mber./// of node
+00008f30: 7320 616e 6420 3a6d 6174 683a 607c 457c  s and :math:`|E|
+00008f40: 6020 6973 2074 6865 206e 756d 6265 7220  ` is the number 
+00008f50: 6f66 2065 6467 6573 2e0a 2f2f 2f0a 2f2f  of edges..///.//
+00008f60: 2f20 5468 6973 2069 7320 646f 6e65 2077  / This is done w
+00008f70: 6974 6820 7468 6520 466c 6f79 6420 5761  ith the Floyd Wa
+00008f80: 7273 6861 6c6c 2061 6c67 6f72 6974 686d  rshall algorithm
+00008f90: 3a0a 2f2f 2f20 2020 2020 200a 2f2f 2f20  :.///      ./// 
+00008fa0: 312e 2050 726f 6365 7373 2061 6c6c 2065  1. Process all e
+00008fb0: 6467 6573 2062 7920 7365 7474 696e 6720  dges by setting 
+00008fc0: 7468 6520 6469 7374 616e 6365 2066 726f  the distance fro
+00008fd0: 6d20 7468 6520 7061 7265 6e74 2074 6f0a  m the parent to.
+00008fe0: 2f2f 2f20 2020 2074 6865 2063 6869 6c64  ///    the child
+00008ff0: 2065 7175 616c 2074 6f20 7468 6520 6564   equal to the ed
+00009000: 6765 2077 6569 6768 742e 0a2f 2f2f 2032  ge weight../// 2
+00009010: 2e20 4974 6572 6174 6520 7468 726f 7567  . Iterate throug
+00009020: 6820 6576 6572 7920 7061 6972 206f 6620  h every pair of 
+00009030: 6e6f 6465 7320 2873 6f75 7263 652c 2074  nodes (source, t
+00009040: 6172 6765 7429 2061 6e64 2061 6e20 6164  arget) and an ad
+00009050: 6469 7469 6f6e 616c 0a2f 2f2f 2020 2020  ditional.///    
+00009060: 6974 6572 6d65 6469 6172 7920 6e6f 6465  itermediary node
+00009070: 2028 7729 2e20 4966 2074 6865 2064 6973   (w). If the dis
+00009080: 7461 6e63 6520 6672 6f6d 2073 6f75 7263  tance from sourc
+00009090: 6520 3a6d 6174 683a 605c 7269 6768 7461  e :math:`\righta
+000090a0: 7272 6f77 6020 770a 2f2f 2f20 2020 203a  rrow` w.///    :
+000090b0: 6d61 7468 3a60 5c72 6967 6874 6172 726f  math:`\rightarro
+000090c0: 7760 2074 6172 6765 7420 6973 206c 6573  w` target is les
+000090d0: 7320 7468 616e 2074 6865 2064 6973 7461  s than the dista
+000090e0: 6e63 6520 6672 6f6d 2073 6f75 7263 650a  nce from source.
+000090f0: 2f2f 2f20 2020 203a 6d61 7468 3a60 5c72  ///    :math:`\r
+00009100: 6967 6874 6172 726f 7760 2074 6172 6765  ightarrow` targe
+00009110: 742c 2075 7064 6174 6520 7468 6520 736f  t, update the so
+00009120: 7572 6365 203a 6d61 7468 3a60 5c72 6967  urce :math:`\rig
+00009130: 6874 6172 726f 7760 2074 6172 6765 740a  htarrow` target.
+00009140: 2f2f 2f20 2020 2064 6973 7461 6e63 6520  ///    distance 
+00009150: 2874 6f20 7061 7373 2074 6872 6f75 6768  (to pass through
+00009160: 2077 292e 0a2f 2f2f 0a2f 2f2f 2054 6865   w)..///./// The
+00009170: 2072 6574 7572 6e20 666f 726d 6174 2069   return format i
+00009180: 7320 6060 7b53 6f75 7263 6520 4e6f 6465  s ``{Source Node
+00009190: 3a20 7b54 6172 6765 7420 4e6f 6465 3a20  : {Target Node: 
+000091a0: 4469 7374 616e 6365 7d7d 6060 2e0a 2f2f  Distance}}``..//
+000091b0: 2f0a 2f2f 2f20 2e2e 206e 6f74 653a 3a0a  /./// .. note::.
+000091c0: 2f2f 2f0a 2f2f 2f20 2020 2020 5061 7468  ///.///     Path
+000091d0: 7320 7468 6174 2064 6f20 6e6f 7420 6578  s that do not ex
+000091e0: 6973 7420 6172 6520 7369 6d70 6c79 206e  ist are simply n
+000091f0: 6f74 2066 6f75 6e64 2069 6e20 7468 6520  ot found in the 
+00009200: 7265 7475 726e 2064 6963 7469 6f6e 6172  return dictionar
+00009210: 792c 0a2f 2f2f 2020 2020 2072 6174 6865  y,.///     rathe
+00009220: 7220 7468 616e 2073 6574 7469 6e67 2074  r than setting t
+00009230: 6865 2064 6973 7461 6e63 6520 746f 2069  he distance to i
+00009240: 6e66 696e 6974 792c 206f 7220 2d31 2e0a  nfinity, or -1..
+00009250: 2f2f 2f0a 2f2f 2f20 2e2e 206e 6f74 653a  ///./// .. note:
+00009260: 3a0a 2f2f 2f0a 2f2f 2f20 2020 2020 4564  :.///.///     Ed
+00009270: 6765 2077 6569 6768 7473 2061 7265 2072  ge weights are r
+00009280: 6573 7472 6963 7465 6420 746f 2031 2069  estricted to 1 i
+00009290: 6e20 7468 6520 6375 7272 656e 7420 696d  n the current im
+000092a0: 706c 656d 656e 7461 7469 6f6e 2e0a 2f2f  plementation..//
+000092b0: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
+000092c0: 6967 7261 7068 2067 7261 7068 3a20 5468  igraph graph: Th
+000092d0: 6520 4469 4772 6170 6820 746f 2067 6574  e DiGraph to get
+000092e0: 2061 6c6c 2073 686f 7274 6573 7420 7061   all shortest pa
+000092f0: 7468 7320 6672 6f6d 0a2f 2f2f 0a2f 2f2f  ths from.///.///
+00009300: 203a 7265 7475 726e 733a 2041 2064 6963   :returns: A dic
+00009310: 7469 6f6e 6172 7920 6f66 2073 686f 7274  tionary of short
+00009320: 6573 7420 7061 7468 730a 2f2f 2f20 3a72  est paths./// :r
+00009330: 7479 7065 3a20 6469 6374 0a23 5b70 7966  type: dict.#[pyf
+00009340: 756e 6374 696f 6e5d 0a23 5b74 6578 745f  unction].#[text_
+00009350: 7369 676e 6174 7572 6520 3d20 2228 6461  signature = "(da
+00009360: 672c 202f 2922 5d0a 666e 2066 6c6f 7964  g, /)"].fn floyd
+00009370: 5f77 6172 7368 616c 6c28 7079 3a20 5079  _warshall(py: Py
+00009380: 7468 6f6e 2c20 6461 673a 2026 6469 6772  thon, dag: &digr
+00009390: 6170 683a 3a50 7944 6947 7261 7068 2920  aph::PyDiGraph) 
+000093a0: 2d3e 2050 7952 6573 756c 743c 5079 4f62  -> PyResult<PyOb
+000093b0: 6a65 6374 3e20 7b0a 2020 2020 6c65 7420  ject> {.    let 
+000093c0: 6d75 7420 6469 7374 3a20 4861 7368 4d61  mut dist: HashMa
+000093d0: 703c 2875 7369 7a65 2c20 7573 697a 6529  p<(usize, usize)
+000093e0: 2c20 7573 697a 653e 203d 0a20 2020 2020  , usize> =.     
+000093f0: 2020 2048 6173 684d 6170 3a3a 7769 7468     HashMap::with
+00009400: 5f63 6170 6163 6974 7928 6461 672e 6e6f  _capacity(dag.no
+00009410: 6465 5f63 6f75 6e74 2829 293b 0a20 2020  de_count());.   
+00009420: 2066 6f72 206e 6f64 6520 696e 2064 6167   for node in dag
+00009430: 2e67 7261 7068 2e6e 6f64 655f 696e 6469  .graph.node_indi
+00009440: 6365 7328 2920 7b0a 2020 2020 2020 2020  ces() {.        
+00009450: 2f2f 2044 6973 7461 6e63 6520 6672 6f6d  // Distance from
+00009460: 2061 206e 6f64 6520 746f 2069 7473 656c   a node to itsel
+00009470: 6620 6973 207a 6572 6f0a 2020 2020 2020  f is zero.      
+00009480: 2020 6469 7374 2e69 6e73 6572 7428 286e    dist.insert((n
+00009490: 6f64 652e 696e 6465 7828 292c 206e 6f64  ode.index(), nod
+000094a0: 652e 696e 6465 7828 2929 2c20 3029 3b0a  e.index()), 0);.
+000094b0: 2020 2020 7d0a 2020 2020 666f 7220 6564      }.    for ed
+000094c0: 6765 2069 6e20 6461 672e 6772 6170 682e  ge in dag.graph.
+000094d0: 6564 6765 5f69 6e64 6963 6573 2829 207b  edge_indices() {
+000094e0: 0a20 2020 2020 2020 202f 2f20 4469 7374  .        // Dist
+000094f0: 616e 6365 2062 6574 7765 656e 206e 6f64  ance between nod
+00009500: 6573 2074 6861 7420 7368 6172 6520 616e  es that share an
+00009510: 2065 6467 6520 6973 2031 0a20 2020 2020   edge is 1.     
+00009520: 2020 206c 6574 2073 6f75 7263 655f 7461     let source_ta
+00009530: 7267 6574 203d 2064 6167 2e67 7261 7068  rget = dag.graph
+00009540: 2e65 6467 655f 656e 6470 6f69 6e74 7328  .edge_endpoints(
+00009550: 6564 6765 292e 756e 7772 6170 2829 3b0a  edge).unwrap();.
+00009560: 2020 2020 2020 2020 6c65 7420 7520 3d20          let u = 
+00009570: 736f 7572 6365 5f74 6172 6765 742e 302e  source_target.0.
+00009580: 696e 6465 7828 293b 0a20 2020 2020 2020  index();.       
+00009590: 206c 6574 2076 203d 2073 6f75 7263 655f   let v = source_
+000095a0: 7461 7267 6574 2e31 2e69 6e64 6578 2829  target.1.index()
+000095b0: 3b0a 2020 2020 2020 2020 2f2f 2055 7064  ;.        // Upd
+000095c0: 6174 6520 6469 7374 206f 6e6c 7920 6966  ate dist only if
+000095d0: 2074 6865 206b 6579 2068 6173 6e27 7420   the key hasn't 
+000095e0: 6265 656e 2073 6574 2074 6f20 3020 616c  been set to 0 al
+000095f0: 7265 6164 790a 2020 2020 2020 2020 2f2f  ready.        //
+00009600: 2028 692e 652e 2069 6e20 6361 7365 2065   (i.e. in case e
+00009610: 6467 6520 6973 2061 2073 656c 6620 6564  dge is a self ed
+00009620: 6765 292e 2041 7373 756d 6573 2065 6467  ge). Assumes edg
+00009630: 6520 7765 6967 6874 203d 2031 2e0a 2020  e weight = 1..  
+00009640: 2020 2020 2020 6469 7374 2e65 6e74 7279        dist.entry
+00009650: 2828 752c 2076 2929 2e6f 725f 696e 7365  ((u, v)).or_inse
+00009660: 7274 2831 293b 0a20 2020 207d 0a20 2020  rt(1);.    }.   
+00009670: 202f 2f20 5468 6520 7368 6f72 7465 7374   // The shortest
+00009680: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
+00009690: 6e20 616e 7920 7061 6972 206f 6620 6e6f  n any pair of no
+000096a0: 6465 7320 752c 2076 2069 7320 7468 6520  des u, v is the 
+000096b0: 6d69 6e20 6f66 2074 6865 0a20 2020 202f  min of the.    /
+000096c0: 2f20 6469 7374 616e 6365 2074 7261 636b  / distance track
+000096d0: 6564 2073 6f20 6661 7220 6672 6f6d 2075  ed so far from u
+000096e0: 2d3e 7620 616e 6420 7468 6520 6469 7374  ->v and the dist
+000096f0: 616e 6365 2066 726f 6d20 7520 746f 2076  ance from u to v
+00009700: 2074 686f 726f 7567 680a 2020 2020 2f2f   thorough.    //
+00009710: 2061 6e6f 7468 6572 206e 6f64 6520 772c   another node w,
+00009720: 2066 6f72 2061 6e79 2077 2e0a 2020 2020   for any w..    
+00009730: 666f 7220 7720 696e 2064 6167 2e67 7261  for w in dag.gra
+00009740: 7068 2e6e 6f64 655f 696e 6469 6365 7328  ph.node_indices(
+00009750: 2920 7b0a 2020 2020 2020 2020 666f 7220  ) {.        for 
+00009760: 7520 696e 2064 6167 2e67 7261 7068 2e6e  u in dag.graph.n
+00009770: 6f64 655f 696e 6469 6365 7328 2920 7b0a  ode_indices() {.
+00009780: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00009790: 7620 696e 2064 6167 2e67 7261 7068 2e6e  v in dag.graph.n
+000097a0: 6f64 655f 696e 6469 6365 7328 2920 7b0a  ode_indices() {.
+000097b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097c0: 6c65 7420 755f 765f 6469 7374 203d 206d  let u_v_dist = m
+000097d0: 6174 6368 2064 6973 742e 6765 7428 2628  atch dist.get(&(
+000097e0: 752e 696e 6465 7828 292c 2076 2e69 6e64  u.index(), v.ind
+000097f0: 6578 2829 2929 207b 0a20 2020 2020 2020  ex())) {.       
+00009800: 2020 2020 2020 2020 2020 2020 2053 6f6d               Som
+00009810: 6528 755f 765f 6469 7374 2920 3d3e 202a  e(u_v_dist) => *
+00009820: 755f 765f 6469 7374 2c0a 2020 2020 2020  u_v_dist,.      
+00009830: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+00009840: 6e65 203d 3e20 7374 643a 3a75 7369 7a65  ne => std::usize
+00009850: 3a3a 4d41 582c 0a20 2020 2020 2020 2020  ::MAX,.         
+00009860: 2020 2020 2020 207d 3b0a 2020 2020 2020         };.      
+00009870: 2020 2020 2020 2020 2020 6c65 7420 755f            let u_
+00009880: 775f 6469 7374 203d 206d 6174 6368 2064  w_dist = match d
+00009890: 6973 742e 6765 7428 2628 752e 696e 6465  ist.get(&(u.inde
+000098a0: 7828 292c 2077 2e69 6e64 6578 2829 2929  x(), w.index()))
+000098b0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000098c0: 2020 2020 2020 2053 6f6d 6528 755f 775f         Some(u_w_
+000098d0: 6469 7374 2920 3d3e 202a 755f 775f 6469  dist) => *u_w_di
+000098e0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+000098f0: 2020 2020 2020 2020 4e6f 6e65 203d 3e20          None => 
+00009900: 7374 643a 3a75 7369 7a65 3a3a 4d41 582c  std::usize::MAX,
+00009910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009920: 207d 3b0a 2020 2020 2020 2020 2020 2020   };.            
+00009930: 2020 2020 6c65 7420 775f 765f 6469 7374      let w_v_dist
+00009940: 203d 206d 6174 6368 2064 6973 742e 6765   = match dist.ge
+00009950: 7428 2628 772e 696e 6465 7828 292c 2076  t(&(w.index(), v
+00009960: 2e69 6e64 6578 2829 2929 207b 0a20 2020  .index())) {.   
+00009970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009980: 2053 6f6d 6528 775f 765f 6469 7374 2920   Some(w_v_dist) 
+00009990: 3d3e 202a 775f 765f 6469 7374 2c0a 2020  => *w_v_dist,.  
+000099a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099b0: 2020 4e6f 6e65 203d 3e20 7374 643a 3a75    None => std::u
+000099c0: 7369 7a65 3a3a 4d41 582c 0a20 2020 2020  size::MAX,.     
+000099d0: 2020 2020 2020 2020 2020 207d 3b0a 2020             };.  
+000099e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000099f0: 2075 5f77 5f64 6973 7420 3d3d 2073 7464   u_w_dist == std
+00009a00: 3a3a 7573 697a 653a 3a4d 4158 207c 7c20  ::usize::MAX || 
+00009a10: 775f 765f 6469 7374 203d 3d20 7374 643a  w_v_dist == std:
+00009a20: 3a75 7369 7a65 3a3a 4d41 5820 7b0a 2020  :usize::MAX {.  
+00009a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a40: 2020 2f2f 2041 766f 6964 206f 7665 7266    // Avoid overf
+00009a50: 6c6f 7721 0a20 2020 2020 2020 2020 2020  low!.           
+00009a60: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00009a70: 653b 0a20 2020 2020 2020 2020 2020 2020  e;.             
+00009a80: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00009a90: 2020 2020 2069 6620 755f 765f 6469 7374       if u_v_dist
+00009aa0: 203e 2075 5f77 5f64 6973 7420 2b20 775f   > u_w_dist + w_
+00009ab0: 765f 6469 7374 207b 0a20 2020 2020 2020  v_dist {.       
+00009ac0: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+00009ad0: 742e 696e 7365 7274 2828 752e 696e 6465  t.insert((u.inde
+00009ae0: 7828 292c 2076 2e69 6e64 6578 2829 292c  x(), v.index()),
+00009af0: 2075 5f77 5f64 6973 7420 2b20 775f 765f   u_w_dist + w_v_
+00009b00: 6469 7374 293b 0a20 2020 2020 2020 2020  dist);.         
+00009b10: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00009b20: 2020 2020 207d 0a20 2020 2020 2020 207d       }.        }
+00009b30: 0a20 2020 207d 0a0a 2020 2020 2f2f 2053  .    }..    // S
+00009b40: 6f6d 6520 7265 2d66 6f72 6d61 7474 696e  ome re-formattin
+00009b50: 6720 666f 7220 5079 7468 6f6e 3a20 4469  g for Python: Di
+00009b60: 6374 5b69 6e74 2c20 4469 6374 5b69 6e74  ct[int, Dict[int
+00009b70: 2c20 696e 745d 5d0a 2020 2020 6c65 7420  , int]].    let 
+00009b80: 6f75 745f 6469 6374 203d 2050 7944 6963  out_dict = PyDic
+00009b90: 743a 3a6e 6577 2870 7929 3b0a 2020 2020  t::new(py);.    
+00009ba0: 666f 7220 286e 6f64 6573 2c20 6469 7374  for (nodes, dist
+00009bb0: 616e 6365 2920 696e 2064 6973 7420 7b0a  ance) in dist {.
+00009bc0: 2020 2020 2020 2020 6c65 7420 755f 696e          let u_in
+00009bd0: 6465 7820 3d20 6e6f 6465 732e 303b 0a20  dex = nodes.0;. 
+00009be0: 2020 2020 2020 206c 6574 2076 5f69 6e64         let v_ind
+00009bf0: 6578 203d 206e 6f64 6573 2e31 3b0a 2020  ex = nodes.1;.  
+00009c00: 2020 2020 2020 6966 206f 7574 5f64 6963        if out_dic
+00009c10: 742e 636f 6e74 6169 6e73 2875 5f69 6e64  t.contains(u_ind
+00009c20: 6578 293f 207b 0a20 2020 2020 2020 2020  ex)? {.         
+00009c30: 2020 206c 6574 2075 5f64 6963 7420 3d0a     let u_dict =.
+00009c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c50: 6f75 745f 6469 6374 2e67 6574 5f69 7465  out_dict.get_ite
+00009c60: 6d28 755f 696e 6465 7829 2e75 6e77 7261  m(u_index).unwra
+00009c70: 7028 292e 646f 776e 6361 7374 3a3a 3c50  p().downcast::<P
+00009c80: 7944 6963 743e 2829 3f3b 0a20 2020 2020  yDict>()?;.     
+00009c90: 2020 2020 2020 2075 5f64 6963 742e 7365         u_dict.se
+00009ca0: 745f 6974 656d 2876 5f69 6e64 6578 2c20  t_item(v_index, 
+00009cb0: 6469 7374 616e 6365 293f 3b0a 2020 2020  distance)?;.    
+00009cc0: 2020 2020 2020 2020 6f75 745f 6469 6374          out_dict
+00009cd0: 2e73 6574 5f69 7465 6d28 755f 696e 6465  .set_item(u_inde
+00009ce0: 782c 2075 5f64 6963 7429 3f3b 0a20 2020  x, u_dict)?;.   
+00009cf0: 2020 2020 207d 2065 6c73 6520 7b0a 2020       } else {.  
+00009d00: 2020 2020 2020 2020 2020 6c65 7420 755f            let u_
+00009d10: 6469 6374 203d 2050 7944 6963 743a 3a6e  dict = PyDict::n
+00009d20: 6577 2870 7929 3b0a 2020 2020 2020 2020  ew(py);.        
+00009d30: 2020 2020 755f 6469 6374 2e73 6574 5f69      u_dict.set_i
+00009d40: 7465 6d28 765f 696e 6465 782c 2064 6973  tem(v_index, dis
+00009d50: 7461 6e63 6529 3f3b 0a20 2020 2020 2020  tance)?;.       
+00009d60: 2020 2020 206f 7574 5f64 6963 742e 7365       out_dict.se
+00009d70: 745f 6974 656d 2875 5f69 6e64 6578 2c20  t_item(u_index, 
+00009d80: 755f 6469 6374 293f 3b0a 2020 2020 2020  u_dict)?;.      
+00009d90: 2020 7d0a 2020 2020 7d0a 2020 2020 4f6b    }.    }.    Ok
+00009da0: 286f 7574 5f64 6963 742e 696e 746f 2829  (out_dict.into()
+00009db0: 290a 7d0a 0a66 6e20 6765 745f 6564 6765  ).}..fn get_edge
+00009dc0: 5f69 7465 725f 7769 7468 5f77 6569 6768  _iter_with_weigh
+00009dd0: 7473 3c47 3e28 0a20 2020 2067 7261 7068  ts<G>(.    graph
+00009de0: 3a20 472c 0a29 202d 3e20 696d 706c 2049  : G,.) -> impl I
+00009df0: 7465 7261 746f 723c 4974 656d 203d 2028  terator<Item = (
+00009e00: 7573 697a 652c 2075 7369 7a65 2c20 5079  usize, usize, Py
+00009e10: 4f62 6a65 6374 293e 0a77 6865 7265 0a20  Object)>.where. 
+00009e20: 2020 2047 3a20 4772 6170 6842 6173 650a     G: GraphBase.
+00009e30: 2020 2020 2020 2020 2b20 496e 746f 4564          + IntoEd
+00009e40: 6765 5265 6665 7265 6e63 6573 0a20 2020  geReferences.   
+00009e50: 2020 2020 202b 2049 6e74 6f4e 6f64 6549       + IntoNodeI
+00009e60: 6465 6e74 6966 6965 7273 0a20 2020 2020  dentifiers.     
+00009e70: 2020 202b 204e 6f64 6549 6e64 6578 6162     + NodeIndexab
+00009e80: 6c65 0a20 2020 2020 2020 202b 204e 6f64  le.        + Nod
+00009e90: 6543 6f75 6e74 0a20 2020 2020 2020 202b  eCount.        +
+00009ea0: 2047 7261 7068 5072 6f70 0a20 2020 2020   GraphProp.     
+00009eb0: 2020 202b 204e 6f64 6573 5265 6d6f 7665     + NodesRemove
+00009ec0: 642c 0a20 2020 2047 3a20 4461 7461 3c4e  d,.    G: Data<N
+00009ed0: 6f64 6557 6569 6768 7420 3d20 5079 4f62  odeWeight = PyOb
+00009ee0: 6a65 6374 2c20 4564 6765 5765 6967 6874  ject, EdgeWeight
+00009ef0: 203d 2050 794f 626a 6563 743e 2c0a 7b0a   = PyObject>,.{.
+00009f00: 2020 2020 6c65 7420 6e6f 6465 5f6d 6170      let node_map
+00009f10: 3a20 4f70 7469 6f6e 3c48 6173 684d 6170  : Option<HashMap
+00009f20: 3c4e 6f64 6549 6e64 6578 2c20 7573 697a  <NodeIndex, usiz
+00009f30: 653e 3e20 3d20 6966 2067 7261 7068 2e6e  e>> = if graph.n
+00009f40: 6f64 6573 5f72 656d 6f76 6564 2829 207b  odes_removed() {
+00009f50: 0a20 2020 2020 2020 206c 6574 206d 7574  .        let mut
+00009f60: 206e 6f64 655f 6861 7368 5f6d 6170 3a20   node_hash_map: 
+00009f70: 4861 7368 4d61 703c 4e6f 6465 496e 6465  HashMap<NodeInde
+00009f80: 782c 2075 7369 7a65 3e20 3d0a 2020 2020  x, usize> =.    
+00009f90: 2020 2020 2020 2020 4861 7368 4d61 703a          HashMap:
+00009fa0: 3a77 6974 685f 6361 7061 6369 7479 2867  :with_capacity(g
+00009fb0: 7261 7068 2e6e 6f64 655f 636f 756e 7428  raph.node_count(
+00009fc0: 2929 3b0a 2020 2020 2020 2020 666f 7220  ));.        for 
+00009fd0: 2863 6f75 6e74 2c20 6e6f 6465 2920 696e  (count, node) in
+00009fe0: 2067 7261 7068 2e6e 6f64 655f 6964 656e   graph.node_iden
+00009ff0: 7469 6669 6572 7328 292e 656e 756d 6572  tifiers().enumer
+0000a000: 6174 6528 2920 7b0a 2020 2020 2020 2020  ate() {.        
+0000a010: 2020 2020 6c65 7420 696e 6465 7820 3d20      let index = 
+0000a020: 4e6f 6465 496e 6465 783a 3a6e 6577 2867  NodeIndex::new(g
+0000a030: 7261 7068 2e74 6f5f 696e 6465 7828 6e6f  raph.to_index(no
+0000a040: 6465 2929 3b0a 2020 2020 2020 2020 2020  de));.          
+0000a050: 2020 6e6f 6465 5f68 6173 685f 6d61 702e    node_hash_map.
+0000a060: 696e 7365 7274 2869 6e64 6578 2c20 636f  insert(index, co
+0000a070: 756e 7429 3b0a 2020 2020 2020 2020 7d0a  unt);.        }.
+0000a080: 2020 2020 2020 2020 536f 6d65 286e 6f64          Some(nod
+0000a090: 655f 6861 7368 5f6d 6170 290a 2020 2020  e_hash_map).    
+0000a0a0: 7d20 656c 7365 207b 0a20 2020 2020 2020  } else {.       
+0000a0b0: 204e 6f6e 650a 2020 2020 7d3b 0a0a 2020   None.    };..  
+0000a0c0: 2020 6772 6170 682e 6564 6765 5f72 6566    graph.edge_ref
+0000a0d0: 6572 656e 6365 7328 292e 6d61 7028 6d6f  erences().map(mo
+0000a0e0: 7665 207c 6564 6765 7c20 7b0a 2020 2020  ve |edge| {.    
+0000a0f0: 2020 2020 6c65 7420 693a 2075 7369 7a65      let i: usize
+0000a100: 3b0a 2020 2020 2020 2020 6c65 7420 6a3a  ;.        let j:
+0000a110: 2075 7369 7a65 3b0a 2020 2020 2020 2020   usize;.        
+0000a120: 6d61 7463 6820 266e 6f64 655f 6d61 7020  match &node_map 
+0000a130: 7b0a 2020 2020 2020 2020 2020 2020 536f  {.            So
+0000a140: 6d65 286d 6170 2920 3d3e 207b 0a20 2020  me(map) => {.   
+0000a150: 2020 2020 2020 2020 2020 2020 206c 6574               let
+0000a160: 2073 6f75 7263 655f 696e 6465 7820 3d0a   source_index =.
+0000a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a180: 2020 2020 4e6f 6465 496e 6465 783a 3a6e      NodeIndex::n
+0000a190: 6577 2867 7261 7068 2e74 6f5f 696e 6465  ew(graph.to_inde
+0000a1a0: 7828 6564 6765 2e73 6f75 7263 6528 2929  x(edge.source())
+0000a1b0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
+0000a1c0: 2020 206c 6574 2074 6172 6765 745f 696e     let target_in
+0000a1d0: 6465 7820 3d0a 2020 2020 2020 2020 2020  dex =.          
+0000a1e0: 2020 2020 2020 2020 2020 4e6f 6465 496e            NodeIn
+0000a1f0: 6465 783a 3a6e 6577 2867 7261 7068 2e74  dex::new(graph.t
+0000a200: 6f5f 696e 6465 7828 6564 6765 2e74 6172  o_index(edge.tar
+0000a210: 6765 7428 2929 293b 0a20 2020 2020 2020  get()));.       
+0000a220: 2020 2020 2020 2020 2069 203d 202a 6d61           i = *ma
+0000a230: 702e 6765 7428 2673 6f75 7263 655f 696e  p.get(&source_in
+0000a240: 6465 7829 2e75 6e77 7261 7028 293b 0a20  dex).unwrap();. 
+0000a250: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+0000a260: 203d 202a 6d61 702e 6765 7428 2674 6172   = *map.get(&tar
+0000a270: 6765 745f 696e 6465 7829 2e75 6e77 7261  get_index).unwra
+0000a280: 7028 293b 0a20 2020 2020 2020 2020 2020  p();.           
+0000a290: 207d 0a20 2020 2020 2020 2020 2020 204e   }.            N
+0000a2a0: 6f6e 6520 3d3e 207b 0a20 2020 2020 2020  one => {.       
+0000a2b0: 2020 2020 2020 2020 2069 203d 2067 7261           i = gra
+0000a2c0: 7068 2e74 6f5f 696e 6465 7828 6564 6765  ph.to_index(edge
+0000a2d0: 2e73 6f75 7263 6528 2929 3b0a 2020 2020  .source());.    
+0000a2e0: 2020 2020 2020 2020 2020 2020 6a20 3d20              j = 
+0000a2f0: 6772 6170 682e 746f 5f69 6e64 6578 2865  graph.to_index(e
+0000a300: 6467 652e 7461 7267 6574 2829 293b 0a20  dge.target());. 
+0000a310: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0000a320: 2020 2020 207d 0a20 2020 2020 2020 2028       }.        (
+0000a330: 692c 206a 2c20 6564 6765 2e77 6569 6768  i, j, edge.weigh
+0000a340: 7428 292e 636c 6f6e 6528 2929 0a20 2020  t().clone()).   
+0000a350: 207d 290a 7d0a 0a2f 2f2f 2046 696e 6420   }).}../// Find 
+0000a360: 616c 6c2d 7061 6972 7320 7368 6f72 7465  all-pairs shorte
+0000a370: 7374 2070 6174 6820 6c65 6e67 7468 7320  st path lengths 
+0000a380: 7573 696e 6720 466c 6f79 6427 7320 616c  using Floyd's al
+0000a390: 676f 7269 7468 6d0a 2f2f 2f0a 2f2f 2f20  gorithm.///./// 
+0000a3a0: 466c 6f79 6427 7320 616c 676f 7269 7468  Floyd's algorith
+0000a3b0: 6d20 6973 2075 7365 6420 666f 7220 6669  m is used for fi
+0000a3c0: 6e64 696e 6720 7368 6f72 7465 7374 2070  nding shortest p
+0000a3d0: 6174 6873 2069 6e20 6465 6e73 6520 6772  aths in dense gr
+0000a3e0: 6170 6873 0a2f 2f2f 206f 7220 6772 6170  aphs./// or grap
+0000a3f0: 6873 2077 6974 6820 6e65 6761 7469 7665  hs with negative
+0000a400: 2077 6569 6768 7473 2028 7768 6572 6520   weights (where 
+0000a410: 4469 6a6b 7374 7261 2773 2061 6c67 6f72  Dijkstra's algor
+0000a420: 6974 686d 2066 6169 6c73 292e 0a2f 2f2f  ithm fails)..///
+0000a430: 0a2f 2f2f 2054 6869 7320 6675 6e63 7469  ./// This functi
+0000a440: 6f6e 2069 7320 6d75 6c74 6974 6872 6561  on is multithrea
+0000a450: 6465 6420 616e 6420 7769 6c6c 206c 6175  ded and will lau
+0000a460: 6e63 6820 6120 706f 6f6c 2077 6974 6820  nch a pool with 
+0000a470: 7468 7265 6164 7320 6571 7561 6c0a 2f2f  threads equal.//
+0000a480: 2f20 746f 2074 6865 206e 756d 6265 7220  / to the number 
+0000a490: 6f66 2043 5055 7320 6279 2064 6566 6175  of CPUs by defau
+0000a4a0: 6c74 2069 6620 7468 6520 6e75 6d62 6572  lt if the number
+0000a4b0: 206f 6620 6e6f 6465 7320 696e 2074 6865   of nodes in the
+0000a4c0: 2067 7261 7068 2069 730a 2f2f 2f20 6162   graph is./// ab
+0000a4d0: 6f76 6520 7468 6520 7661 6c75 6520 6f66  ove the value of
+0000a4e0: 2060 6070 6172 616c 6c65 6c5f 7468 7265   ``parallel_thre
+0000a4f0: 7368 6f6c 6460 6020 2869 7420 6465 6661  shold`` (it defa
+0000a500: 756c 7473 2074 6f20 3330 3029 2e0a 2f2f  ults to 300)..//
+0000a510: 2f20 596f 7520 6361 6e20 7475 6e65 2074  / You can tune t
+0000a520: 6865 206e 756d 6265 7220 6f66 2074 6872  he number of thr
+0000a530: 6561 6473 2077 6974 6820 7468 6520 6060  eads with the ``
+0000a540: 5241 594f 4e5f 4e55 4d5f 5448 5245 4144  RAYON_NUM_THREAD
+0000a550: 5360 600a 2f2f 2f20 656e 7669 726f 6e6d  S``./// environm
+0000a560: 656e 7420 7661 7269 6162 6c65 2e20 466f  ent variable. Fo
+0000a570: 7220 6578 616d 706c 652c 2073 6574 7469  r example, setti
+0000a580: 6e67 2060 6052 4159 4f4e 5f4e 554d 5f54  ng ``RAYON_NUM_T
+0000a590: 4852 4541 4453 3d34 6060 2077 6f75 6c64  HREADS=4`` would
+0000a5a0: 0a2f 2f2f 206c 696d 6974 2074 6865 2074  ./// limit the t
+0000a5b0: 6872 6561 6420 706f 6f6c 2074 6f20 3420  hread pool to 4 
+0000a5c0: 7468 7265 6164 7320 6966 2070 6172 616c  threads if paral
+0000a5d0: 6c65 6c69 7a61 7469 6f6e 2077 6173 2065  lelization was e
+0000a5e0: 6e61 626c 6564 2e0a 2f2f 2f0a 2f2f 2f20  nabled..///./// 
+0000a5f0: 3a70 6172 616d 2050 7947 7261 7068 2067  :param PyGraph g
+0000a600: 7261 7068 3a20 5468 6520 6772 6170 6820  raph: The graph 
+0000a610: 746f 2072 756e 2046 6c6f 7964 2773 2061  to run Floyd's a
+0000a620: 6c67 6f72 6974 686d 206f 6e0a 2f2f 2f20  lgorithm on./// 
+0000a630: 3a70 6172 616d 2077 6569 6768 745f 666e  :param weight_fn
+0000a640: 3a20 4120 6361 6c6c 6162 6c65 206f 626a  : A callable obj
+0000a650: 6563 7420 2866 756e 6374 696f 6e2c 206c  ect (function, l
+0000a660: 616d 6264 612c 2065 7463 2920 7768 6963  ambda, etc) whic
+0000a670: 680a 2f2f 2f20 2020 2020 7769 6c6c 2062  h.///     will b
+0000a680: 6520 7061 7373 6564 2074 6865 2065 6467  e passed the edg
+0000a690: 6520 6f62 6a65 6374 2061 6e64 2065 7870  e object and exp
+0000a6a0: 6563 7465 6420 746f 2072 6574 7572 6e20  ected to return 
+0000a6b0: 6120 6060 666c 6f61 7460 602e 2054 6869  a ``float``. Thi
+0000a6c0: 730a 2f2f 2f20 2020 2020 7465 6c6c 7320  s.///     tells 
+0000a6d0: 7265 7477 6f72 6b78 2f72 7573 7420 686f  retworkx/rust ho
+0000a6e0: 7720 746f 2065 7874 7261 6374 2061 206e  w to extract a n
+0000a6f0: 756d 6572 6963 616c 2077 6569 6768 7420  umerical weight 
+0000a700: 6173 2061 2060 6066 6c6f 6174 6060 0a2f  as a ``float``./
+0000a710: 2f2f 2020 2020 2066 6f72 2065 6467 6520  //     for edge 
+0000a720: 6f62 6a65 6374 2e20 536f 6d65 2073 696d  object. Some sim
+0000a730: 706c 6520 6578 616d 706c 6573 2061 7265  ple examples are
+0000a740: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2020  ::.///.///      
+0000a750: 2020 2067 7261 7068 5f66 6c6f 7964 5f77     graph_floyd_w
+0000a760: 6172 7368 616c 6c5f 6e75 6d70 7928 6772  arshall_numpy(gr
+0000a770: 6170 682c 2077 6569 6768 745f 666e 3a20  aph, weight_fn: 
+0000a780: 6c61 6d62 6461 2078 3a20 3129 0a2f 2f2f  lambda x: 1).///
+0000a790: 0a2f 2f2f 2020 2020 2074 6f20 7265 7475  .///     to retu
+0000a7a0: 726e 2061 2077 6569 6768 7420 6f66 2031  rn a weight of 1
+0000a7b0: 2066 6f72 2061 6c6c 2065 6467 6573 2e20   for all edges. 
+0000a7c0: 416c 736f 3a3a 0a2f 2f2f 0a2f 2f2f 2020  Also::.///.///  
+0000a7d0: 2020 2020 2020 2067 7261 7068 5f66 6c6f         graph_flo
+0000a7e0: 7964 5f77 6172 7368 616c 6c5f 6e75 6d70  yd_warshall_nump
+0000a7f0: 7928 6772 6170 682c 2077 6569 6768 745f  y(graph, weight_
+0000a800: 666e 3a20 6c61 6d62 6461 2078 3a20 666c  fn: lambda x: fl
+0000a810: 6f61 7428 7829 290a 2f2f 2f0a 2f2f 2f20  oat(x)).///./// 
+0000a820: 2020 2020 746f 2063 6173 7420 7468 6520      to cast the 
+0000a830: 6564 6765 206f 626a 6563 7420 6173 2061  edge object as a
+0000a840: 2066 6c6f 6174 2061 7320 7468 6520 7765   float as the we
+0000a850: 6967 6874 2e0a 2f2f 2f20 3a70 6172 616d  ight../// :param
+0000a860: 2069 6e74 2070 6172 616c 6c65 6c5f 7468   int parallel_th
+0000a870: 7265 7368 6f6c 643a 2054 6865 206e 756d  reshold: The num
+0000a880: 6265 7220 6f66 206e 6f64 6573 2074 6f20  ber of nodes to 
+0000a890: 6578 6563 7574 650a 2f2f 2f20 2020 2020  execute.///     
+0000a8a0: 7468 6520 616c 676f 7269 7468 6d20 696e  the algorithm in
+0000a8b0: 2070 6172 616c 6c65 6c20 6174 2e20 4974   parallel at. It
+0000a8c0: 2064 6566 6175 6c74 7320 746f 2033 3030   defaults to 300
+0000a8d0: 2c20 6275 7420 7468 6973 2063 616e 0a2f  , but this can./
+0000a8e0: 2f2f 2020 2020 2062 6520 7475 6e65 640a  //     be tuned.
+0000a8f0: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
+0000a900: 3a20 4120 6d61 7472 6978 206f 6620 7368  : A matrix of sh
+0000a910: 6f72 7465 7374 2070 6174 6820 6469 7374  ortest path dist
+0000a920: 616e 6365 7320 6265 7477 6565 6e20 6e6f  ances between no
+0000a930: 6465 732e 2049 6620 7468 6572 6520 6973  des. If there is
+0000a940: 206e 6f0a 2f2f 2f20 2020 2020 7061 7468   no.///     path
+0000a950: 2062 6574 7765 656e 2074 776f 206e 6f64   between two nod
+0000a960: 6573 2074 6865 6e20 7468 6520 636f 7272  es then the corr
+0000a970: 6573 706f 6e64 696e 6720 6d61 7472 6978  esponding matrix
+0000a980: 2065 6e74 7279 2077 696c 6c20 6265 0a2f   entry will be./
+0000a990: 2f2f 2020 2020 2060 606e 702e 696e 6660  //     ``np.inf`
+0000a9a0: 602e 0a2f 2f2f 203a 7274 7970 653a 206e  `../// :rtype: n
+0000a9b0: 756d 7079 2e6e 6461 7272 6179 0a23 5b70  umpy.ndarray.#[p
+0000a9c0: 7966 756e 6374 696f 6e28 7061 7261 6c6c  yfunction(parall
+0000a9d0: 656c 5f74 6872 6573 686f 6c64 203d 2022  el_threshold = "
+0000a9e0: 3330 3022 2c20 6465 6661 756c 745f 7765  300", default_we
+0000a9f0: 6967 6874 203d 2022 312e 3022 295d 0a23  ight = "1.0")].#
+0000aa00: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
+0000aa10: 3d20 2228 6772 6170 682c 202f 2c20 7765  = "(graph, /, we
+0000aa20: 6967 6874 5f66 6e3d 4e6f 6e65 2c20 6465  ight_fn=None, de
+0000aa30: 6661 756c 745f 7765 6967 6874 3d31 2e30  fault_weight=1.0
+0000aa40: 2c20 7061 7261 6c6c 656c 5f74 6872 6573  , parallel_thres
+0000aa50: 686f 6c64 3d33 3030 2922 5d0a 666e 2067  hold=300)"].fn g
+0000aa60: 7261 7068 5f66 6c6f 7964 5f77 6172 7368  raph_floyd_warsh
+0000aa70: 616c 6c5f 6e75 6d70 7928 0a20 2020 2070  all_numpy(.    p
+0000aa80: 793a 2050 7974 686f 6e2c 0a20 2020 2067  y: Python,.    g
+0000aa90: 7261 7068 3a20 2667 7261 7068 3a3a 5079  raph: &graph::Py
+0000aaa0: 4772 6170 682c 0a20 2020 2077 6569 6768  Graph,.    weigh
+0000aab0: 745f 666e 3a20 4f70 7469 6f6e 3c50 794f  t_fn: Option<PyO
+0000aac0: 626a 6563 743e 2c0a 2020 2020 6465 6661  bject>,.    defa
+0000aad0: 756c 745f 7765 6967 6874 3a20 6636 342c  ult_weight: f64,
+0000aae0: 0a20 2020 2070 6172 616c 6c65 6c5f 7468  .    parallel_th
+0000aaf0: 7265 7368 6f6c 643a 2075 7369 7a65 2c0a  reshold: usize,.
+0000ab00: 2920 2d3e 2050 7952 6573 756c 743c 5079  ) -> PyResult<Py
+0000ab10: 4f62 6a65 6374 3e20 7b0a 2020 2020 6c65  Object> {.    le
+0000ab20: 7420 6e20 3d20 6772 6170 682e 6e6f 6465  t n = graph.node
+0000ab30: 5f63 6f75 6e74 2829 3b0a 2020 2020 2f2f  _count();.    //
+0000ab40: 2041 6c6c 6f63 6174 6520 656d 7074 7920   Allocate empty 
+0000ab50: 6d61 7472 6978 0a20 2020 206c 6574 206d  matrix.    let m
+0000ab60: 7574 206d 6174 203d 2041 7272 6179 323a  ut mat = Array2:
+0000ab70: 3a3c 6636 343e 3a3a 6672 6f6d 5f65 6c65  :<f64>::from_ele
+0000ab80: 6d28 286e 2c20 6e29 2c20 7374 643a 3a66  m((n, n), std::f
+0000ab90: 3634 3a3a 494e 4649 4e49 5459 293b 0a0a  64::INFINITY);..
+0000aba0: 2020 2020 2f2f 2042 7569 6c64 2061 646a      // Build adj
+0000abb0: 6163 656e 6379 206d 6174 7269 780a 2020  acency matrix.  
+0000abc0: 2020 666f 7220 2869 2c20 6a2c 2077 6569    for (i, j, wei
+0000abd0: 6768 7429 2069 6e20 6765 745f 6564 6765  ght) in get_edge
+0000abe0: 5f69 7465 725f 7769 7468 5f77 6569 6768  _iter_with_weigh
+0000abf0: 7473 2867 7261 7068 2920 7b0a 2020 2020  ts(graph) {.    
+0000ac00: 2020 2020 6c65 7420 6564 6765 5f77 6569      let edge_wei
+0000ac10: 6768 7420 3d0a 2020 2020 2020 2020 2020  ght =.          
+0000ac20: 2020 7765 6967 6874 5f63 616c 6c61 626c    weight_callabl
+0000ac30: 6528 7079 2c20 2677 6569 6768 745f 666e  e(py, &weight_fn
+0000ac40: 2c20 2677 6569 6768 742c 2064 6566 6175  , &weight, defau
+0000ac50: 6c74 5f77 6569 6768 7429 3f3b 0a20 2020  lt_weight)?;.   
+0000ac60: 2020 2020 206d 6174 5b5b 692c 206a 5d5d       mat[[i, j]]
+0000ac70: 203d 206d 6174 5b5b 692c 206a 5d5d 2e6d   = mat[[i, j]].m
+0000ac80: 696e 2865 6467 655f 7765 6967 6874 293b  in(edge_weight);
+0000ac90: 0a20 2020 2020 2020 206d 6174 5b5b 6a2c  .        mat[[j,
+0000aca0: 2069 5d5d 203d 206d 6174 5b5b 6a2c 2069   i]] = mat[[j, i
+0000acb0: 5d5d 2e6d 696e 2865 6467 655f 7765 6967  ]].min(edge_weig
+0000acc0: 6874 293b 0a20 2020 207d 0a0a 2020 2020  ht);.    }..    
+0000acd0: 2f2f 2030 206f 7574 2074 6865 2064 6961  // 0 out the dia
+0000ace0: 676f 6e61 6c0a 2020 2020 666f 7220 7820  gonal.    for x 
+0000acf0: 696e 206d 6174 2e64 6961 675f 6d75 7428  in mat.diag_mut(
+0000ad00: 2920 7b0a 2020 2020 2020 2020 2a78 203d  ) {.        *x =
+0000ad10: 2030 2e30 3b0a 2020 2020 7d0a 2020 2020   0.0;.    }.    
+0000ad20: 2f2f 2050 6572 666f 726d 2074 6865 2046  // Perform the F
+0000ad30: 6c6f 7964 2d57 6172 7368 616c 6c20 616c  loyd-Warshall al
+0000ad40: 676f 7269 7468 6d2e 0a20 2020 202f 2f20  gorithm..    // 
+0000ad50: 496e 2065 6163 6820 6c6f 6f70 2c20 7468  In each loop, th
+0000ad60: 6973 2066 696e 6473 2074 6865 2073 686f  is finds the sho
+0000ad70: 7274 6573 7420 7061 7468 2066 726f 6d20  rtest path from 
+0000ad80: 706f 696e 7420 690a 2020 2020 2f2f 2074  point i.    // t
+0000ad90: 6f20 706f 696e 7420 6a20 7573 696e 6720  o point j using 
+0000ada0: 696e 7465 726d 6564 6961 7465 206e 6f64  intermediate nod
+0000adb0: 6573 2030 2e2e 6b0a 2020 2020 6966 206e  es 0..k.    if n
+0000adc0: 203c 2070 6172 616c 6c65 6c5f 7468 7265   < parallel_thre
+0000add0: 7368 6f6c 6420 7b0a 2020 2020 2020 2020  shold {.        
+0000ade0: 666f 7220 6b20 696e 2030 2e2e 6e20 7b0a  for k in 0..n {.
+0000adf0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000ae00: 6920 696e 2030 2e2e 6e20 7b0a 2020 2020  i in 0..n {.    
+0000ae10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000ae20: 6a20 696e 2030 2e2e 6e20 7b0a 2020 2020  j in 0..n {.    
+0000ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae40: 6c65 7420 645f 696a 6b20 3d20 6d61 745b  let d_ijk = mat[
+0000ae50: 5b69 2c20 6b5d 5d20 2b20 6d61 745b 5b6b  [i, k]] + mat[[k
+0000ae60: 2c20 6a5d 5d3b 0a20 2020 2020 2020 2020  , j]];.         
+0000ae70: 2020 2020 2020 2020 2020 2069 6620 645f             if d_
+0000ae80: 696a 6b20 3c20 6d61 745b 5b69 2c20 6a5d  ijk < mat[[i, j]
+0000ae90: 5d20 7b0a 2020 2020 2020 2020 2020 2020  ] {.            
+0000aea0: 2020 2020 2020 2020 2020 2020 6d61 745b              mat[
+0000aeb0: 5b69 2c20 6a5d 5d20 3d20 645f 696a 6b3b  [i, j]] = d_ijk;
+0000aec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aed0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+0000aee0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000aef0: 2020 2020 207d 0a20 2020 2020 2020 207d       }.        }
+0000af00: 0a20 2020 207d 2065 6c73 6520 7b0a 2020  .    } else {.  
+0000af10: 2020 2020 2020 666f 7220 6b20 696e 2030        for k in 0
+0000af20: 2e2e 6e20 7b0a 2020 2020 2020 2020 2020  ..n {.          
+0000af30: 2020 6c65 7420 726f 775f 6b20 3d20 6d61    let row_k = ma
+0000af40: 742e 736c 6963 6528 7321 5b6b 2c20 2e2e  t.slice(s![k, ..
+0000af50: 5d29 2e74 6f5f 6f77 6e65 6428 293b 0a20  ]).to_owned();. 
+0000af60: 2020 2020 2020 2020 2020 206d 6174 2e61             mat.a
+0000af70: 7869 735f 6974 6572 5f6d 7574 2841 7869  xis_iter_mut(Axi
+0000af80: 7328 3029 290a 2020 2020 2020 2020 2020  s(0)).          
+0000af90: 2020 2020 2020 2e69 6e74 6f5f 7061 725f        .into_par_
+0000afa0: 6974 6572 2829 0a20 2020 2020 2020 2020  iter().         
+0000afb0: 2020 2020 2020 202e 666f 725f 6561 6368         .for_each
+0000afc0: 287c 6d75 7420 726f 775f 697c 207b 0a20  (|mut row_i| {. 
+0000afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afe0: 2020 206c 6574 206d 5f69 6b20 3d20 726f     let m_ik = ro
+0000aff0: 775f 695b 6b5d 3b0a 2020 2020 2020 2020  w_i[k];.        
+0000b000: 2020 2020 2020 2020 2020 2020 726f 775f              row_
+0000b010: 692e 6974 6572 5f6d 7574 2829 2e7a 6970  i.iter_mut().zip
+0000b020: 2872 6f77 5f6b 2e69 7465 7228 2929 2e66  (row_k.iter()).f
+0000b030: 6f72 5f65 6163 6828 0a20 2020 2020 2020  or_each(.       
+0000b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b050: 207c 286d 5f69 6a2c 206d 5f6b 6a29 7c20   |(m_ij, m_kj)| 
+0000b060: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000b070: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+0000b080: 7420 645f 696a 6b20 3d20 6d5f 696b 202b  t d_ijk = m_ik +
+0000b090: 202a 6d5f 6b6a 3b0a 2020 2020 2020 2020   *m_kj;.        
+0000b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0b0: 2020 2020 6966 2064 5f69 6a6b 203c 202a      if d_ijk < *
+0000b0c0: 6d5f 696a 207b 0a20 2020 2020 2020 2020  m_ij {.         
+0000b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0e0: 2020 2020 2020 202a 6d5f 696a 203d 2064         *m_ij = d
+0000b0f0: 5f69 6a6b 3b0a 2020 2020 2020 2020 2020  _ijk;.          
+0000b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b110: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0000b120: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0000b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b140: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000b150: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0000b160: 7d0a 2020 2020 7d0a 2020 2020 4f6b 286d  }.    }.    Ok(m
+0000b170: 6174 2e69 6e74 6f5f 7079 6172 7261 7928  at.into_pyarray(
+0000b180: 7079 292e 696e 746f 2829 290a 7d0a 0a2f  py).into()).}../
+0000b190: 2f2f 2046 696e 6420 616c 6c2d 7061 6972  // Find all-pair
+0000b1a0: 7320 7368 6f72 7465 7374 2070 6174 6820  s shortest path 
+0000b1b0: 6c65 6e67 7468 7320 7573 696e 6720 466c  lengths using Fl
+0000b1c0: 6f79 6427 7320 616c 676f 7269 7468 6d0a  oyd's algorithm.
+0000b1d0: 2f2f 2f0a 2f2f 2f20 466c 6f79 6427 7320  ///./// Floyd's 
+0000b1e0: 616c 676f 7269 7468 6d20 6973 2075 7365  algorithm is use
+0000b1f0: 6420 666f 7220 6669 6e64 696e 6720 7368  d for finding sh
+0000b200: 6f72 7465 7374 2070 6174 6873 2069 6e20  ortest paths in 
+0000b210: 6465 6e73 6520 6772 6170 6873 0a2f 2f2f  dense graphs.///
+0000b220: 206f 7220 6772 6170 6873 2077 6974 6820   or graphs with 
+0000b230: 6e65 6761 7469 7665 2077 6569 6768 7473  negative weights
+0000b240: 2028 7768 6572 6520 4469 6a6b 7374 7261   (where Dijkstra
+0000b250: 2773 2061 6c67 6f72 6974 686d 2066 6169  's algorithm fai
+0000b260: 6c73 292e 0a2f 2f2f 0a2f 2f2f 2054 6869  ls)..///./// Thi
+0000b270: 7320 6675 6e63 7469 6f6e 2069 7320 6d75  s function is mu
+0000b280: 6c74 6974 6872 6561 6465 6420 616e 6420  ltithreaded and 
+0000b290: 7769 6c6c 206c 6175 6e63 6820 6120 706f  will launch a po
+0000b2a0: 6f6c 2077 6974 6820 7468 7265 6164 7320  ol with threads 
+0000b2b0: 6571 7561 6c0a 2f2f 2f20 746f 2074 6865  equal./// to the
+0000b2c0: 206e 756d 6265 7220 6f66 2043 5055 7320   number of CPUs 
+0000b2d0: 6279 2064 6566 6175 6c74 2069 6620 7468  by default if th
+0000b2e0: 6520 6e75 6d62 6572 206f 6620 6e6f 6465  e number of node
+0000b2f0: 7320 696e 2074 6865 2067 7261 7068 2069  s in the graph i
+0000b300: 730a 2f2f 2f20 6162 6f76 6520 7468 6520  s./// above the 
+0000b310: 7661 6c75 6520 6f66 2060 6070 6172 616c  value of ``paral
+0000b320: 6c65 6c5f 7468 7265 7368 6f6c 6460 6020  lel_threshold`` 
+0000b330: 2869 7420 6465 6661 756c 7473 2074 6f20  (it defaults to 
+0000b340: 3330 3029 2e0a 2f2f 2f20 596f 7520 6361  300)../// You ca
+0000b350: 6e20 7475 6e65 2074 6865 206e 756d 6265  n tune the numbe
+0000b360: 7220 6f66 2074 6872 6561 6473 2077 6974  r of threads wit
+0000b370: 6820 7468 6520 6060 5241 594f 4e5f 4e55  h the ``RAYON_NU
+0000b380: 4d5f 5448 5245 4144 5360 600a 2f2f 2f20  M_THREADS``./// 
+0000b390: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
+0000b3a0: 6162 6c65 2e20 466f 7220 6578 616d 706c  able. For exampl
+0000b3b0: 652c 2073 6574 7469 6e67 2060 6052 4159  e, setting ``RAY
+0000b3c0: 4f4e 5f4e 554d 5f54 4852 4541 4453 3d34  ON_NUM_THREADS=4
+0000b3d0: 6060 2077 6f75 6c64 0a2f 2f2f 206c 696d  `` would./// lim
+0000b3e0: 6974 2074 6865 2074 6872 6561 6420 706f  it the thread po
+0000b3f0: 6f6c 2074 6f20 3420 7468 7265 6164 7320  ol to 4 threads 
+0000b400: 6966 2070 6172 616c 6c65 6c69 7a61 7469  if parallelizati
+0000b410: 6f6e 2077 6173 2065 6e61 626c 6564 2e0a  on was enabled..
+0000b420: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+0000b430: 7944 6947 7261 7068 2067 7261 7068 3a20  yDiGraph graph: 
+0000b440: 5468 6520 6469 7265 6374 6564 2067 7261  The directed gra
+0000b450: 7068 2074 6f20 7275 6e20 466c 6f79 6427  ph to run Floyd'
+0000b460: 7320 616c 676f 7269 7468 6d20 6f6e 0a2f  s algorithm on./
+0000b470: 2f2f 203a 7061 7261 6d20 7765 6967 6874  // :param weight
+0000b480: 5f66 6e3a 2041 2063 616c 6c61 626c 6520  _fn: A callable 
+0000b490: 6f62 6a65 6374 2028 6675 6e63 7469 6f6e  object (function
+0000b4a0: 2c20 6c61 6d62 6461 2c20 6574 6329 2077  , lambda, etc) w
+0000b4b0: 6869 6368 0a2f 2f2f 2020 2020 2077 696c  hich.///     wil
+0000b4c0: 6c20 6265 2070 6173 7365 6420 7468 6520  l be passed the 
+0000b4d0: 6564 6765 206f 626a 6563 7420 616e 6420  edge object and 
+0000b4e0: 6578 7065 6374 6564 2074 6f20 7265 7475  expected to retu
+0000b4f0: 726e 2061 2060 6066 6c6f 6174 6060 2e20  rn a ``float``. 
+0000b500: 5468 6973 0a2f 2f2f 2020 2020 2074 656c  This.///     tel
+0000b510: 6c73 2072 6574 776f 726b 782f 7275 7374  ls retworkx/rust
+0000b520: 2068 6f77 2074 6f20 6578 7472 6163 7420   how to extract 
+0000b530: 6120 6e75 6d65 7269 6361 6c20 7765 6967  a numerical weig
+0000b540: 6874 2061 7320 6120 6060 666c 6f61 7460  ht as a ``float`
+0000b550: 600a 2f2f 2f20 2020 2020 666f 7220 6564  `.///     for ed
+0000b560: 6765 206f 626a 6563 742e 2053 6f6d 6520  ge object. Some 
+0000b570: 7369 6d70 6c65 2065 7861 6d70 6c65 7320  simple examples 
+0000b580: 6172 653a 3a0a 2f2f 2f0a 2f2f 2f20 2020  are::.///.///   
+0000b590: 2020 2020 2020 6772 6170 685f 666c 6f79        graph_floy
+0000b5a0: 645f 7761 7273 6861 6c6c 5f6e 756d 7079  d_warshall_numpy
+0000b5b0: 2867 7261 7068 2c20 7765 6967 6874 5f66  (graph, weight_f
+0000b5c0: 6e3a 206c 616d 6264 6120 783a 2031 290a  n: lambda x: 1).
+0000b5d0: 2f2f 2f0a 2f2f 2f20 2020 2020 746f 2072  ///.///     to r
+0000b5e0: 6574 7572 6e20 6120 7765 6967 6874 206f  eturn a weight o
+0000b5f0: 6620 3120 666f 7220 616c 6c20 6564 6765  f 1 for all edge
+0000b600: 732e 2041 6c73 6f3a 3a0a 2f2f 2f0a 2f2f  s. Also::.///.//
+0000b610: 2f20 2020 2020 2020 2020 6772 6170 685f  /         graph_
+0000b620: 666c 6f79 645f 7761 7273 6861 6c6c 5f6e  floyd_warshall_n
+0000b630: 756d 7079 2867 7261 7068 2c20 7765 6967  umpy(graph, weig
+0000b640: 6874 5f66 6e3a 206c 616d 6264 6120 783a  ht_fn: lambda x:
+0000b650: 2066 6c6f 6174 2878 2929 0a2f 2f2f 0a2f   float(x)).///./
+0000b660: 2f2f 2020 2020 2074 6f20 6361 7374 2074  //     to cast t
+0000b670: 6865 2065 6467 6520 6f62 6a65 6374 2061  he edge object a
+0000b680: 7320 6120 666c 6f61 7420 6173 2074 6865  s a float as the
+0000b690: 2077 6569 6768 742e 0a2f 2f2f 203a 7061   weight../// :pa
+0000b6a0: 7261 6d20 6173 5f75 6e64 6972 6563 7465  ram as_undirecte
+0000b6b0: 643a 2049 6620 7365 7420 746f 2074 7275  d: If set to tru
+0000b6c0: 6520 6561 6368 2064 6972 6563 7465 6420  e each directed 
+0000b6d0: 6564 6765 2077 696c 6c20 6265 2074 7265  edge will be tre
+0000b6e0: 6174 6564 2061 730a 2f2f 2f20 2020 2020  ated as.///     
+0000b6f0: 6269 6469 7265 6374 696f 6e61 6c2f 756e  bidirectional/un
+0000b700: 6469 7265 6374 6564 2e0a 2f2f 2f20 3a70  directed../// :p
+0000b710: 6172 616d 2069 6e74 2070 6172 616c 6c65  aram int paralle
+0000b720: 6c5f 7468 7265 7368 6f6c 643a 2054 6865  l_threshold: The
+0000b730: 206e 756d 6265 7220 6f66 206e 6f64 6573   number of nodes
+0000b740: 2074 6f20 6578 6563 7574 650a 2f2f 2f20   to execute./// 
+0000b750: 2020 2020 7468 6520 616c 676f 7269 7468      the algorith
+0000b760: 6d20 696e 2070 6172 616c 6c65 6c20 6174  m in parallel at
+0000b770: 2e20 4974 2064 6566 6175 6c74 7320 746f  . It defaults to
+0000b780: 2033 3030 2c20 6275 7420 7468 6973 2063   300, but this c
+0000b790: 616e 0a2f 2f2f 2020 2020 2062 6520 7475  an.///     be tu
+0000b7a0: 6e65 640a 2f2f 2f0a 2f2f 2f20 3a72 6574  ned.///./// :ret
+0000b7b0: 7572 6e73 3a20 4120 6d61 7472 6978 206f  urns: A matrix o
+0000b7c0: 6620 7368 6f72 7465 7374 2070 6174 6820  f shortest path 
+0000b7d0: 6469 7374 616e 6365 7320 6265 7477 6565  distances betwee
+0000b7e0: 6e20 6e6f 6465 732e 2049 6620 7468 6572  n nodes. If ther
+0000b7f0: 6520 6973 206e 6f0a 2f2f 2f20 2020 2020  e is no.///     
+0000b800: 7061 7468 2062 6574 7765 656e 2074 776f  path between two
+0000b810: 206e 6f64 6573 2074 6865 6e20 7468 6520   nodes then the 
+0000b820: 636f 7272 6573 706f 6e64 696e 6720 6d61  corresponding ma
+0000b830: 7472 6978 2065 6e74 7279 2077 696c 6c20  trix entry will 
+0000b840: 6265 0a2f 2f2f 2020 2020 2060 606e 702e  be.///     ``np.
+0000b850: 696e 6660 602e 0a2f 2f2f 203a 7274 7970  inf``../// :rtyp
+0000b860: 653a 206e 756d 7079 2e6e 6461 7272 6179  e: numpy.ndarray
+0000b870: 0a23 5b70 7966 756e 6374 696f 6e28 0a20  .#[pyfunction(. 
+0000b880: 2020 2070 6172 616c 6c65 6c5f 7468 7265     parallel_thre
+0000b890: 7368 6f6c 6420 3d20 2233 3030 222c 0a20  shold = "300",. 
+0000b8a0: 2020 2061 735f 756e 6469 7265 6374 6564     as_undirected
+0000b8b0: 203d 2022 6661 6c73 6522 2c0a 2020 2020   = "false",.    
+0000b8c0: 6465 6661 756c 745f 7765 6967 6874 203d  default_weight =
+0000b8d0: 2022 312e 3022 0a29 5d0a 235b 7465 7874   "1.0".)].#[text
+0000b8e0: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+0000b8f0: 7261 7068 2c20 2f2c 2077 6569 6768 745f  raph, /, weight_
+0000b900: 666e 3d4e 6f6e 652c 2061 735f 756e 6469  fn=None, as_undi
+0000b910: 7265 6374 6564 3d46 616c 7365 2c20 6465  rected=False, de
+0000b920: 6661 756c 745f 7765 6967 6874 3d31 2e30  fault_weight=1.0
+0000b930: 2c20 7061 7261 6c6c 656c 5f74 6872 6573  , parallel_thres
+0000b940: 686f 6c64 3d33 3030 2922 5d0a 666e 2064  hold=300)"].fn d
+0000b950: 6967 7261 7068 5f66 6c6f 7964 5f77 6172  igraph_floyd_war
+0000b960: 7368 616c 6c5f 6e75 6d70 7928 0a20 2020  shall_numpy(.   
+0000b970: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
+0000b980: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
+0000b990: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
+0000b9a0: 2077 6569 6768 745f 666e 3a20 4f70 7469   weight_fn: Opti
+0000b9b0: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
+0000b9c0: 2020 6173 5f75 6e64 6972 6563 7465 643a    as_undirected:
+0000b9d0: 2062 6f6f 6c2c 0a20 2020 2064 6566 6175   bool,.    defau
+0000b9e0: 6c74 5f77 6569 6768 743a 2066 3634 2c0a  lt_weight: f64,.
+0000b9f0: 2020 2020 7061 7261 6c6c 656c 5f74 6872      parallel_thr
+0000ba00: 6573 686f 6c64 3a20 7573 697a 652c 0a29  eshold: usize,.)
+0000ba10: 202d 3e20 5079 5265 7375 6c74 3c50 794f   -> PyResult<PyO
+0000ba20: 626a 6563 743e 207b 0a20 2020 206c 6574  bject> {.    let
+0000ba30: 206e 203d 2067 7261 7068 2e6e 6f64 655f   n = graph.node_
+0000ba40: 636f 756e 7428 293b 0a0a 2020 2020 2f2f  count();..    //
+0000ba50: 2041 6c6c 6f63 6174 6520 656d 7074 7920   Allocate empty 
+0000ba60: 6d61 7472 6978 0a20 2020 206c 6574 206d  matrix.    let m
+0000ba70: 7574 206d 6174 203d 2041 7272 6179 323a  ut mat = Array2:
+0000ba80: 3a3c 6636 343e 3a3a 6672 6f6d 5f65 6c65  :<f64>::from_ele
+0000ba90: 6d28 286e 2c20 6e29 2c20 7374 643a 3a66  m((n, n), std::f
+0000baa0: 3634 3a3a 494e 4649 4e49 5459 293b 0a0a  64::INFINITY);..
+0000bab0: 2020 2020 2f2f 2042 7569 6c64 2061 646a      // Build adj
+0000bac0: 6163 656e 6379 206d 6174 7269 780a 2020  acency matrix.  
+0000bad0: 2020 666f 7220 2869 2c20 6a2c 2077 6569    for (i, j, wei
+0000bae0: 6768 7429 2069 6e20 6765 745f 6564 6765  ght) in get_edge
+0000baf0: 5f69 7465 725f 7769 7468 5f77 6569 6768  _iter_with_weigh
+0000bb00: 7473 2867 7261 7068 2920 7b0a 2020 2020  ts(graph) {.    
+0000bb10: 2020 2020 6c65 7420 6564 6765 5f77 6569      let edge_wei
+0000bb20: 6768 7420 3d0a 2020 2020 2020 2020 2020  ght =.          
+0000bb30: 2020 7765 6967 6874 5f63 616c 6c61 626c    weight_callabl
+0000bb40: 6528 7079 2c20 2677 6569 6768 745f 666e  e(py, &weight_fn
+0000bb50: 2c20 2677 6569 6768 742c 2064 6566 6175  , &weight, defau
+0000bb60: 6c74 5f77 6569 6768 7429 3f3b 0a20 2020  lt_weight)?;.   
+0000bb70: 2020 2020 206d 6174 5b5b 692c 206a 5d5d       mat[[i, j]]
+0000bb80: 203d 206d 6174 5b5b 692c 206a 5d5d 2e6d   = mat[[i, j]].m
+0000bb90: 696e 2865 6467 655f 7765 6967 6874 293b  in(edge_weight);
+0000bba0: 0a20 2020 2020 2020 2069 6620 6173 5f75  .        if as_u
+0000bbb0: 6e64 6972 6563 7465 6420 7b0a 2020 2020  ndirected {.    
+0000bbc0: 2020 2020 2020 2020 6d61 745b 5b6a 2c20          mat[[j, 
+0000bbd0: 695d 5d20 3d20 6d61 745b 5b6a 2c20 695d  i]] = mat[[j, i]
+0000bbe0: 5d2e 6d69 6e28 6564 6765 5f77 6569 6768  ].min(edge_weigh
+0000bbf0: 7429 3b0a 2020 2020 2020 2020 7d0a 2020  t);.        }.  
+0000bc00: 2020 7d0a 2020 2020 2f2f 2030 206f 7574    }.    // 0 out
+0000bc10: 2074 6865 2064 6961 676f 6e61 6c0a 2020   the diagonal.  
+0000bc20: 2020 666f 7220 7820 696e 206d 6174 2e64    for x in mat.d
+0000bc30: 6961 675f 6d75 7428 2920 7b0a 2020 2020  iag_mut() {.    
+0000bc40: 2020 2020 2a78 203d 2030 2e30 3b0a 2020      *x = 0.0;.  
+0000bc50: 2020 7d0a 2020 2020 2f2f 2050 6572 666f    }.    // Perfo
+0000bc60: 726d 2074 6865 2046 6c6f 7964 2d57 6172  rm the Floyd-War
+0000bc70: 7368 616c 6c20 616c 676f 7269 7468 6d2e  shall algorithm.
+0000bc80: 0a20 2020 202f 2f20 496e 2065 6163 6820  .    // In each 
+0000bc90: 6c6f 6f70 2c20 7468 6973 2066 696e 6473  loop, this finds
+0000bca0: 2074 6865 2073 686f 7274 6573 7420 7061   the shortest pa
+0000bcb0: 7468 2066 726f 6d20 706f 696e 7420 690a  th from point i.
+0000bcc0: 2020 2020 2f2f 2074 6f20 706f 696e 7420      // to point 
+0000bcd0: 6a20 7573 696e 6720 696e 7465 726d 6564  j using intermed
+0000bce0: 6961 7465 206e 6f64 6573 2030 2e2e 6b0a  iate nodes 0..k.
+0000bcf0: 2020 2020 6966 206e 203c 2070 6172 616c      if n < paral
+0000bd00: 6c65 6c5f 7468 7265 7368 6f6c 6420 7b0a  lel_threshold {.
+0000bd10: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+0000bd20: 2030 2e2e 6e20 7b0a 2020 2020 2020 2020   0..n {.        
+0000bd30: 2020 2020 666f 7220 6920 696e 2030 2e2e      for i in 0..
+0000bd40: 6e20 7b0a 2020 2020 2020 2020 2020 2020  n {.            
+0000bd50: 2020 2020 666f 7220 6a20 696e 2030 2e2e      for j in 0..
+0000bd60: 6e20 7b0a 2020 2020 2020 2020 2020 2020  n {.            
+0000bd70: 2020 2020 2020 2020 6c65 7420 645f 696a          let d_ij
+0000bd80: 6b20 3d20 6d61 745b 5b69 2c20 6b5d 5d20  k = mat[[i, k]] 
+0000bd90: 2b20 6d61 745b 5b6b 2c20 6a5d 5d3b 0a20  + mat[[k, j]];. 
+0000bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdb0: 2020 2069 6620 645f 696a 6b20 3c20 6d61     if d_ijk < ma
+0000bdc0: 745b 5b69 2c20 6a5d 5d20 7b0a 2020 2020  t[[i, j]] {.    
+0000bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bde0: 2020 2020 6d61 745b 5b69 2c20 6a5d 5d20      mat[[i, j]] 
+0000bdf0: 3d20 645f 696a 6b3b 0a20 2020 2020 2020  = d_ijk;.       
+0000be00: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+0000be10: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0000be20: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0000be30: 2020 2020 2020 207d 0a20 2020 207d 2065         }.    } e
+0000be40: 6c73 6520 7b0a 2020 2020 2020 2020 666f  lse {.        fo
+0000be50: 7220 6b20 696e 2030 2e2e 6e20 7b0a 2020  r k in 0..n {.  
+0000be60: 2020 2020 2020 2020 2020 6c65 7420 726f            let ro
+0000be70: 775f 6b20 3d20 6d61 742e 736c 6963 6528  w_k = mat.slice(
+0000be80: 7321 5b6b 2c20 2e2e 5d29 2e74 6f5f 6f77  s![k, ..]).to_ow
+0000be90: 6e65 6428 293b 0a20 2020 2020 2020 2020  ned();.         
+0000bea0: 2020 206d 6174 2e61 7869 735f 6974 6572     mat.axis_iter
+0000beb0: 5f6d 7574 2841 7869 7328 3029 290a 2020  _mut(Axis(0)).  
+0000bec0: 2020 2020 2020 2020 2020 2020 2020 2e69                .i
+0000bed0: 6e74 6f5f 7061 725f 6974 6572 2829 0a20  nto_par_iter(). 
+0000bee0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0000bef0: 666f 725f 6561 6368 287c 6d75 7420 726f  for_each(|mut ro
+0000bf00: 775f 697c 207b 0a20 2020 2020 2020 2020  w_i| {.         
+0000bf10: 2020 2020 2020 2020 2020 206c 6574 206d             let m
+0000bf20: 5f69 6b20 3d20 726f 775f 695b 6b5d 3b0a  _ik = row_i[k];.
+0000bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf40: 2020 2020 726f 775f 692e 6974 6572 5f6d      row_i.iter_m
+0000bf50: 7574 2829 2e7a 6970 2872 6f77 5f6b 2e69  ut().zip(row_k.i
+0000bf60: 7465 7228 2929 2e66 6f72 5f65 6163 6828  ter()).for_each(
+0000bf70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bf80: 2020 2020 2020 2020 207c 286d 5f69 6a2c           |(m_ij,
+0000bf90: 206d 5f6b 6a29 7c20 7b0a 2020 2020 2020   m_kj)| {.      
+0000bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfb0: 2020 2020 2020 6c65 7420 645f 696a 6b20        let d_ijk 
+0000bfc0: 3d20 6d5f 696b 202b 202a 6d5f 6b6a 3b0a  = m_ik + *m_kj;.
+0000bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfe0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0000bff0: 5f69 6a6b 203c 202a 6d5f 696a 207b 0a20  _ijk < *m_ij {. 
 0000c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c010: 2020 726f 775b 5b76 2e69 6e64 6578 2829    row[[v.index()
-0000c020: 5d5d 203d 206c 6576 656c 2061 7320 6636  ]] = level as f6
-0000c030: 343b 0a20 2020 2020 2020 2020 2020 2020  4;.             
-0000c040: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0000c050: 207d 0a20 2020 2020 2020 2020 2020 2069   }.            i
-0000c060: 6620 7365 656e 2e6c 656e 2829 203d 3d20  f seen.len() == 
-0000c070: 6e20 7b0a 2020 2020 2020 2020 2020 2020  n {.            
-0000c080: 2020 2020 7265 7475 726e 3b0a 2020 2020      return;.    
-0000c090: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0000c0a0: 2020 2020 2020 666f 7220 6e6f 6465 2069        for node i
-0000c0b0: 6e20 666f 756e 6420 7b0a 2020 2020 2020  n found {.      
-0000c0c0: 2020 2020 2020 2020 2020 666f 7220 7620            for v 
-0000c0d0: 696e 2067 7261 7068 2e67 7261 7068 2e6e  in graph.graph.n
-0000c0e0: 6569 6768 626f 7273 286e 6f64 6529 207b  eighbors(node) {
-0000c0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c100: 2020 2020 206e 6578 745f 6c65 7665 6c2e       next_level.
-0000c110: 696e 7365 7274 2876 293b 0a20 2020 2020  insert(v);.     
-0000c120: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0000c130: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0000c140: 2020 2020 2020 206c 6576 656c 202b 3d20         level += 
-0000c150: 310a 2020 2020 2020 2020 7d0a 2020 2020  1.        }.    
-0000c160: 7d3b 0a20 2020 2069 6620 6e20 3c20 7061  };.    if n < pa
-0000c170: 7261 6c6c 656c 5f74 6872 6573 686f 6c64  rallel_threshold
-0000c180: 207b 0a20 2020 2020 2020 206d 6174 7269   {.        matri
-0000c190: 780a 2020 2020 2020 2020 2020 2020 2e61  x.            .a
-0000c1a0: 7869 735f 6974 6572 5f6d 7574 2841 7869  xis_iter_mut(Axi
-0000c1b0: 7328 3029 290a 2020 2020 2020 2020 2020  s(0)).          
-0000c1c0: 2020 2e65 6e75 6d65 7261 7465 2829 0a20    .enumerate(). 
-0000c1d0: 2020 2020 2020 2020 2020 202e 666f 725f             .for_
-0000c1e0: 6561 6368 287c 2869 6e64 6578 2c20 726f  each(|(index, ro
-0000c1f0: 7729 7c20 6266 735f 7472 6176 6572 7361  w)| bfs_traversa
-0000c200: 6c28 696e 6465 782c 2072 6f77 2929 3b0a  l(index, row));.
-0000c210: 2020 2020 7d20 656c 7365 207b 0a20 2020      } else {.   
-0000c220: 2020 2020 202f 2f20 5061 7261 6c6c 656c       // Parallel
-0000c230: 697a 6520 6279 2072 6f77 2061 6e64 2069  ize by row and i
-0000c240: 7465 7261 7465 2066 726f 6d20 6561 6368  terate from each
-0000c250: 2072 6f77 2069 6e64 6578 2069 6e20 4246   row index in BF
-0000c260: 5320 6f72 6465 720a 2020 2020 2020 2020  S order.        
-0000c270: 6d61 7472 6978 0a20 2020 2020 2020 2020  matrix.         
-0000c280: 2020 202e 6178 6973 5f69 7465 725f 6d75     .axis_iter_mu
-0000c290: 7428 4178 6973 2830 2929 0a20 2020 2020  t(Axis(0)).     
-0000c2a0: 2020 2020 2020 202e 696e 746f 5f70 6172         .into_par
-0000c2b0: 5f69 7465 7228 290a 2020 2020 2020 2020  _iter().        
-0000c2c0: 2020 2020 2e65 6e75 6d65 7261 7465 2829      .enumerate()
-0000c2d0: 0a20 2020 2020 2020 2020 2020 202e 666f  .            .fo
-0000c2e0: 725f 6561 6368 287c 2869 6e64 6578 2c20  r_each(|(index, 
-0000c2f0: 726f 7729 7c20 6266 735f 7472 6176 6572  row)| bfs_traver
-0000c300: 7361 6c28 696e 6465 782c 2072 6f77 2929  sal(index, row))
-0000c310: 3b0a 2020 2020 7d0a 2020 2020 4f6b 286d  ;.    }.    Ok(m
-0000c320: 6174 7269 782e 696e 746f 5f70 7961 7272  atrix.into_pyarr
-0000c330: 6179 2870 7929 2e69 6e74 6f28 2929 0a7d  ay(py).into()).}
-0000c340: 0a0a 2f2f 2f20 5265 7475 726e 2074 6865  ../// Return the
-0000c350: 2061 646a 6163 656e 6379 206d 6174 7269   adjacency matri
-0000c360: 7820 666f 7220 6120 5079 4469 4772 6170  x for a PyDiGrap
-0000c370: 6820 6f62 6a65 6374 0a2f 2f2f 0a2f 2f2f  h object.///.///
-0000c380: 2049 6e20 7468 6520 6361 7365 2077 6865   In the case whe
-0000c390: 7265 2074 6865 7265 2061 7265 206d 756c  re there are mul
-0000c3a0: 7469 706c 6520 6564 6765 7320 6265 7477  tiple edges betw
-0000c3b0: 6565 6e20 6e6f 6465 7320 7468 6520 7661  een nodes the va
-0000c3c0: 6c75 6520 696e 2074 6865 0a2f 2f2f 206f  lue in the./// o
-0000c3d0: 7574 7075 7420 6d61 7472 6978 2077 696c  utput matrix wil
-0000c3e0: 6c20 6265 2074 6865 2073 756d 206f 6620  l be the sum of 
-0000c3f0: 7468 6520 6564 6765 7327 2077 6569 6768  the edges' weigh
-0000c400: 7473 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  ts..///./// :par
-0000c410: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
-0000c420: 7068 3a20 5468 6520 4469 4772 6170 6820  ph: The DiGraph 
-0000c430: 7573 6564 2074 6f20 6765 6e65 7261 7465  used to generate
-0000c440: 2074 6865 2061 646a 6163 656e 6379 206d   the adjacency m
-0000c450: 6174 7269 780a 2f2f 2f20 2020 2020 6672  atrix.///     fr
-0000c460: 6f6d 0a2f 2f2f 203a 7061 7261 6d20 6361  om./// :param ca
-0000c470: 6c6c 6162 6c65 2077 6569 6768 745f 666e  llable weight_fn
-0000c480: 3a20 4120 6361 6c6c 6162 6c65 206f 626a  : A callable obj
-0000c490: 6563 7420 2866 756e 6374 696f 6e2c 206c  ect (function, l
-0000c4a0: 616d 6264 612c 2065 7463 2920 7768 6963  ambda, etc) whic
-0000c4b0: 680a 2f2f 2f20 2020 2020 7769 6c6c 2062  h.///     will b
-0000c4c0: 6520 7061 7373 6564 2074 6865 2065 6467  e passed the edg
-0000c4d0: 6520 6f62 6a65 6374 2061 6e64 2065 7870  e object and exp
-0000c4e0: 6563 7465 6420 746f 2072 6574 7572 6e20  ected to return 
-0000c4f0: 6120 6060 666c 6f61 7460 602e 2054 6869  a ``float``. Thi
-0000c500: 730a 2f2f 2f20 2020 2020 7465 6c6c 7320  s.///     tells 
-0000c510: 7265 7477 6f72 6b78 2f72 7573 7420 686f  retworkx/rust ho
-0000c520: 7720 746f 2065 7874 7261 6374 2061 206e  w to extract a n
-0000c530: 756d 6572 6963 616c 2077 6569 6768 7420  umerical weight 
-0000c540: 6173 2061 2060 6066 6c6f 6174 6060 0a2f  as a ``float``./
-0000c550: 2f2f 2020 2020 2066 6f72 2065 6467 6520  //     for edge 
-0000c560: 6f62 6a65 6374 2e20 536f 6d65 2073 696d  object. Some sim
-0000c570: 706c 6520 6578 616d 706c 6573 2061 7265  ple examples are
-0000c580: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2020  ::.///.///      
-0000c590: 2020 2064 6167 5f61 646a 6163 656e 6379     dag_adjacency
-0000c5a0: 5f6d 6174 7269 7828 6461 672c 2077 6569  _matrix(dag, wei
-0000c5b0: 6768 745f 666e 3a20 6c61 6d62 6461 2078  ght_fn: lambda x
-0000c5c0: 3a20 3129 0a2f 2f2f 0a2f 2f2f 2020 2020  : 1).///.///    
-0000c5d0: 2074 6f20 7265 7475 726e 2061 2077 6569   to return a wei
-0000c5e0: 6768 7420 6f66 2031 2066 6f72 2061 6c6c  ght of 1 for all
-0000c5f0: 2065 6467 6573 2e20 416c 736f 3a3a 0a2f   edges. Also::./
-0000c600: 2f2f 0a2f 2f2f 2020 2020 2020 2020 2064  //.///         d
-0000c610: 6167 5f61 646a 6163 656e 6379 5f6d 6174  ag_adjacency_mat
-0000c620: 7269 7828 6461 672c 2077 6569 6768 745f  rix(dag, weight_
-0000c630: 666e 3a20 6c61 6d62 6461 2078 3a20 666c  fn: lambda x: fl
-0000c640: 6f61 7428 7829 290a 2f2f 2f0a 2f2f 2f20  oat(x)).///./// 
-0000c650: 2020 2020 746f 2063 6173 7420 7468 6520      to cast the 
-0000c660: 6564 6765 206f 626a 6563 7420 6173 2061  edge object as a
-0000c670: 2066 6c6f 6174 2061 7320 7468 6520 7765   float as the we
-0000c680: 6967 6874 2e20 4966 2074 6869 7320 6973  ight. If this is
-0000c690: 206e 6f74 0a2f 2f2f 2020 2020 2073 7065   not.///     spe
-0000c6a0: 6369 6669 6564 2061 2064 6566 6175 6c74  cified a default
-0000c6b0: 2076 616c 7565 2028 6569 7468 6572 2060   value (either `
-0000c6c0: 6064 6566 6175 6c74 5f77 6569 6768 7460  `default_weight`
-0000c6d0: 6020 6f72 2031 2920 7769 6c6c 2062 6520  ` or 1) will be 
-0000c6e0: 7573 6564 0a2f 2f2f 2020 2020 2066 6f72  used.///     for
-0000c6f0: 2061 6c6c 2065 6467 6573 2e0a 2f2f 2f20   all edges../// 
-0000c700: 3a70 6172 616d 2066 6c6f 6174 2064 6566  :param float def
-0000c710: 6175 6c74 5f77 6569 6768 743a 2049 6620  ault_weight: If 
-0000c720: 6060 7765 6967 6874 5f66 6e60 6020 6973  ``weight_fn`` is
-0000c730: 206e 6f74 2075 7365 6420 7468 6973 2063   not used this c
-0000c740: 616e 2062 650a 2f2f 2f20 2020 2020 6f70  an be.///     op
-0000c750: 7469 6f6e 616c 6c79 2075 7365 6420 746f  tionally used to
-0000c760: 2073 7065 6369 6679 2061 2064 6566 6175   specify a defau
-0000c770: 6c74 2077 6569 6768 7420 746f 2075 7365  lt weight to use
-0000c780: 2066 6f72 2061 6c6c 2065 6467 6573 2e0a   for all edges..
-0000c790: 2f2f 2f0a 2f2f 2f20 203a 7265 7475 726e  ///.///  :return
-0000c7a0: 3a20 5468 6520 6164 6a61 6365 6e63 7920  : The adjacency 
-0000c7b0: 6d61 7472 6978 2066 6f72 2074 6865 2069  matrix for the i
-0000c7c0: 6e70 7574 2064 6167 2061 7320 6120 6e75  nput dag as a nu
-0000c7d0: 6d70 7920 6172 7261 790a 2f2f 2f20 203a  mpy array.///  :
-0000c7e0: 7274 7970 653a 206e 756d 7079 2e6e 6461  rtype: numpy.nda
-0000c7f0: 7272 6179 0a23 5b70 7966 756e 6374 696f  rray.#[pyfunctio
-0000c800: 6e28 6465 6661 756c 745f 7765 6967 6874  n(default_weight
-0000c810: 203d 2022 312e 3022 295d 0a23 5b74 6578   = "1.0")].#[tex
-0000c820: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
-0000c830: 6772 6170 682c 202f 2c20 7765 6967 6874  graph, /, weight
-0000c840: 5f66 6e3d 4e6f 6e65 2c20 6465 6661 756c  _fn=None, defaul
-0000c850: 745f 7765 6967 6874 3d31 2e30 2922 5d0a  t_weight=1.0)"].
-0000c860: 666e 2064 6967 7261 7068 5f61 646a 6163  fn digraph_adjac
-0000c870: 656e 6379 5f6d 6174 7269 7828 0a20 2020  ency_matrix(.   
-0000c880: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
-0000c890: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
-0000c8a0: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
-0000c8b0: 2077 6569 6768 745f 666e 3a20 4f70 7469   weight_fn: Opti
-0000c8c0: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
-0000c8d0: 2020 6465 6661 756c 745f 7765 6967 6874    default_weight
-0000c8e0: 3a20 6636 342c 0a29 202d 3e20 5079 5265  : f64,.) -> PyRe
-0000c8f0: 7375 6c74 3c50 794f 626a 6563 743e 207b  sult<PyObject> {
-0000c900: 0a20 2020 206c 6574 206e 203d 2067 7261  .    let n = gra
-0000c910: 7068 2e6e 6f64 655f 636f 756e 7428 293b  ph.node_count();
-0000c920: 0a20 2020 206c 6574 206d 7574 206d 6174  .    let mut mat
-0000c930: 7269 7820 3d20 4172 7261 7932 3a3a 3c66  rix = Array2::<f
-0000c940: 3634 3e3a 3a7a 6572 6f73 2828 6e2c 206e  64>::zeros((n, n
-0000c950: 2929 3b0a 2020 2020 666f 7220 2869 2c20  ));.    for (i, 
-0000c960: 6a2c 2077 6569 6768 7429 2069 6e20 6765  j, weight) in ge
-0000c970: 745f 6564 6765 5f69 7465 725f 7769 7468  t_edge_iter_with
-0000c980: 5f77 6569 6768 7473 2867 7261 7068 2920  _weights(graph) 
-0000c990: 7b0a 2020 2020 2020 2020 6c65 7420 6564  {.        let ed
-0000c9a0: 6765 5f77 6569 6768 7420 3d0a 2020 2020  ge_weight =.    
-0000c9b0: 2020 2020 2020 2020 7765 6967 6874 5f63          weight_c
-0000c9c0: 616c 6c61 626c 6528 7079 2c20 2677 6569  allable(py, &wei
-0000c9d0: 6768 745f 666e 2c20 2677 6569 6768 742c  ght_fn, &weight,
-0000c9e0: 2064 6566 6175 6c74 5f77 6569 6768 7429   default_weight)
-0000c9f0: 3f3b 0a20 2020 2020 2020 206d 6174 7269  ?;.        matri
-0000ca00: 785b 5b69 2c20 6a5d 5d20 2b3d 2065 6467  x[[i, j]] += edg
-0000ca10: 655f 7765 6967 6874 3b0a 2020 2020 7d0a  e_weight;.    }.
-0000ca20: 2020 2020 4f6b 286d 6174 7269 782e 696e      Ok(matrix.in
-0000ca30: 746f 5f70 7961 7272 6179 2870 7929 2e69  to_pyarray(py).i
-0000ca40: 6e74 6f28 2929 0a7d 0a0a 2f2f 2f20 5265  nto()).}../// Re
-0000ca50: 7475 726e 2074 6865 2061 646a 6163 656e  turn the adjacen
-0000ca60: 6379 206d 6174 7269 7820 666f 7220 6120  cy matrix for a 
-0000ca70: 5079 4772 6170 6820 636c 6173 730a 2f2f  PyGraph class.//
-0000ca80: 2f0a 2f2f 2f20 496e 2074 6865 2063 6173  /./// In the cas
-0000ca90: 6520 7768 6572 6520 7468 6572 6520 6172  e where there ar
-0000caa0: 6520 6d75 6c74 6970 6c65 2065 6467 6573  e multiple edges
-0000cab0: 2062 6574 7765 656e 206e 6f64 6573 2074   between nodes t
-0000cac0: 6865 2076 616c 7565 2069 6e20 7468 650a  he value in the.
-0000cad0: 2f2f 2f20 6f75 7470 7574 206d 6174 7269  /// output matri
-0000cae0: 7820 7769 6c6c 2062 6520 7468 6520 7375  x will be the su
-0000caf0: 6d20 6f66 2074 6865 2065 6467 6573 2720  m of the edges' 
-0000cb00: 7765 6967 6874 732e 0a2f 2f2f 0a2f 2f2f  weights..///.///
-0000cb10: 203a 7061 7261 6d20 5079 4772 6170 6820   :param PyGraph 
-0000cb20: 6772 6170 683a 2054 6865 2067 7261 7068  graph: The graph
-0000cb30: 2075 7365 6420 746f 2067 656e 6572 6174   used to generat
-0000cb40: 6520 7468 6520 6164 6a61 6365 6e63 7920  e the adjacency 
-0000cb50: 6d61 7472 6978 2066 726f 6d0a 2f2f 2f20  matrix from./// 
-0000cb60: 3a70 6172 616d 2077 6569 6768 745f 666e  :param weight_fn
-0000cb70: 3a20 4120 6361 6c6c 6162 6c65 206f 626a  : A callable obj
-0000cb80: 6563 7420 2866 756e 6374 696f 6e2c 206c  ect (function, l
-0000cb90: 616d 6264 612c 2065 7463 2920 7768 6963  ambda, etc) whic
-0000cba0: 680a 2f2f 2f20 2020 2020 7769 6c6c 2062  h.///     will b
-0000cbb0: 6520 7061 7373 6564 2074 6865 2065 6467  e passed the edg
-0000cbc0: 6520 6f62 6a65 6374 2061 6e64 2065 7870  e object and exp
-0000cbd0: 6563 7465 6420 746f 2072 6574 7572 6e20  ected to return 
-0000cbe0: 6120 6060 666c 6f61 7460 602e 2054 6869  a ``float``. Thi
-0000cbf0: 730a 2f2f 2f20 2020 2020 7465 6c6c 7320  s.///     tells 
-0000cc00: 7265 7477 6f72 6b78 2f72 7573 7420 686f  retworkx/rust ho
-0000cc10: 7720 746f 2065 7874 7261 6374 2061 206e  w to extract a n
-0000cc20: 756d 6572 6963 616c 2077 6569 6768 7420  umerical weight 
-0000cc30: 6173 2061 2060 6066 6c6f 6174 6060 0a2f  as a ``float``./
-0000cc40: 2f2f 2020 2020 2066 6f72 2065 6467 6520  //     for edge 
-0000cc50: 6f62 6a65 6374 2e20 536f 6d65 2073 696d  object. Some sim
-0000cc60: 706c 6520 6578 616d 706c 6573 2061 7265  ple examples are
-0000cc70: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2020  ::.///.///      
-0000cc80: 2020 2067 7261 7068 5f61 646a 6163 656e     graph_adjacen
-0000cc90: 6379 5f6d 6174 7269 7828 6772 6170 682c  cy_matrix(graph,
-0000cca0: 2077 6569 6768 745f 666e 3a20 6c61 6d62   weight_fn: lamb
-0000ccb0: 6461 2078 3a20 3129 0a2f 2f2f 0a2f 2f2f  da x: 1).///.///
-0000ccc0: 2020 2020 2074 6f20 7265 7475 726e 2061       to return a
-0000ccd0: 2077 6569 6768 7420 6f66 2031 2066 6f72   weight of 1 for
-0000cce0: 2061 6c6c 2065 6467 6573 2e20 416c 736f   all edges. Also
-0000ccf0: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2020  ::.///.///      
-0000cd00: 2020 2067 7261 7068 5f61 646a 6163 656e     graph_adjacen
-0000cd10: 6379 5f6d 6174 7269 7828 6772 6170 682c  cy_matrix(graph,
-0000cd20: 2077 6569 6768 745f 666e 3a20 6c61 6d62   weight_fn: lamb
-0000cd30: 6461 2078 3a20 666c 6f61 7428 7829 290a  da x: float(x)).
-0000cd40: 2f2f 2f0a 2f2f 2f20 2020 2020 746f 2063  ///.///     to c
-0000cd50: 6173 7420 7468 6520 6564 6765 206f 626a  ast the edge obj
-0000cd60: 6563 7420 6173 2061 2066 6c6f 6174 2061  ect as a float a
-0000cd70: 7320 7468 6520 7765 6967 6874 2e20 4966  s the weight. If
-0000cd80: 2074 6869 7320 6973 206e 6f74 0a2f 2f2f   this is not.///
-0000cd90: 2020 2020 2073 7065 6369 6669 6564 2061       specified a
-0000cda0: 2064 6566 6175 6c74 2076 616c 7565 2028   default value (
-0000cdb0: 6569 7468 6572 2060 6064 6566 6175 6c74  either ``default
-0000cdc0: 5f77 6569 6768 7460 6020 6f72 2031 2920  _weight`` or 1) 
-0000cdd0: 7769 6c6c 2062 6520 7573 6564 0a2f 2f2f  will be used.///
-0000cde0: 2020 2020 2066 6f72 2061 6c6c 2065 6467       for all edg
-0000cdf0: 6573 2e0a 2f2f 2f20 3a70 6172 616d 2066  es../// :param f
-0000ce00: 6c6f 6174 2064 6566 6175 6c74 5f77 6569  loat default_wei
-0000ce10: 6768 743a 2049 6620 6060 7765 6967 6874  ght: If ``weight
-0000ce20: 5f66 6e60 6020 6973 206e 6f74 2075 7365  _fn`` is not use
-0000ce30: 6420 7468 6973 2063 616e 2062 650a 2f2f  d this can be.//
-0000ce40: 2f20 2020 2020 6f70 7469 6f6e 616c 6c79  /     optionally
-0000ce50: 2075 7365 6420 746f 2073 7065 6369 6679   used to specify
-0000ce60: 2061 2064 6566 6175 6c74 2077 6569 6768   a default weigh
-0000ce70: 7420 746f 2075 7365 2066 6f72 2061 6c6c  t to use for all
-0000ce80: 2065 6467 6573 2e0a 2f2f 2f0a 2f2f 2f20   edges..///./// 
-0000ce90: 3a72 6574 7572 6e3a 2054 6865 2061 646a  :return: The adj
-0000cea0: 6163 656e 6379 206d 6174 7269 7820 666f  acency matrix fo
-0000ceb0: 7220 7468 6520 696e 7075 7420 6461 6720  r the input dag 
-0000cec0: 6173 2061 206e 756d 7079 2061 7272 6179  as a numpy array
-0000ced0: 0a2f 2f2f 203a 7274 7970 653a 206e 756d  ./// :rtype: num
-0000cee0: 7079 2e6e 6461 7272 6179 0a23 5b70 7966  py.ndarray.#[pyf
-0000cef0: 756e 6374 696f 6e28 6465 6661 756c 745f  unction(default_
-0000cf00: 7765 6967 6874 203d 2022 312e 3022 295d  weight = "1.0")]
-0000cf10: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
-0000cf20: 6520 3d20 2228 6772 6170 682c 202f 2c20  e = "(graph, /, 
-0000cf30: 7765 6967 6874 5f66 6e3d 4e6f 6e65 2c20  weight_fn=None, 
-0000cf40: 6465 6661 756c 745f 7765 6967 6874 3d31  default_weight=1
-0000cf50: 2e30 2922 5d0a 666e 2067 7261 7068 5f61  .0)"].fn graph_a
-0000cf60: 646a 6163 656e 6379 5f6d 6174 7269 7828  djacency_matrix(
-0000cf70: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
-0000cf80: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
-0000cf90: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
-0000cfa0: 2077 6569 6768 745f 666e 3a20 4f70 7469   weight_fn: Opti
-0000cfb0: 6f6e 3c50 794f 626a 6563 743e 2c0a 2020  on<PyObject>,.  
-0000cfc0: 2020 6465 6661 756c 745f 7765 6967 6874    default_weight
-0000cfd0: 3a20 6636 342c 0a29 202d 3e20 5079 5265  : f64,.) -> PyRe
-0000cfe0: 7375 6c74 3c50 794f 626a 6563 743e 207b  sult<PyObject> {
-0000cff0: 0a20 2020 206c 6574 206e 203d 2067 7261  .    let n = gra
-0000d000: 7068 2e6e 6f64 655f 636f 756e 7428 293b  ph.node_count();
-0000d010: 0a20 2020 206c 6574 206d 7574 206d 6174  .    let mut mat
-0000d020: 7269 7820 3d20 4172 7261 7932 3a3a 3c66  rix = Array2::<f
-0000d030: 3634 3e3a 3a7a 6572 6f73 2828 6e2c 206e  64>::zeros((n, n
-0000d040: 2929 3b0a 2020 2020 666f 7220 2869 2c20  ));.    for (i, 
-0000d050: 6a2c 2077 6569 6768 7429 2069 6e20 6765  j, weight) in ge
-0000d060: 745f 6564 6765 5f69 7465 725f 7769 7468  t_edge_iter_with
-0000d070: 5f77 6569 6768 7473 2867 7261 7068 2920  _weights(graph) 
-0000d080: 7b0a 2020 2020 2020 2020 6c65 7420 6564  {.        let ed
-0000d090: 6765 5f77 6569 6768 7420 3d0a 2020 2020  ge_weight =.    
-0000d0a0: 2020 2020 2020 2020 7765 6967 6874 5f63          weight_c
-0000d0b0: 616c 6c61 626c 6528 7079 2c20 2677 6569  allable(py, &wei
-0000d0c0: 6768 745f 666e 2c20 2677 6569 6768 742c  ght_fn, &weight,
-0000d0d0: 2064 6566 6175 6c74 5f77 6569 6768 7429   default_weight)
-0000d0e0: 3f3b 0a20 2020 2020 2020 206d 6174 7269  ?;.        matri
-0000d0f0: 785b 5b69 2c20 6a5d 5d20 2b3d 2065 6467  x[[i, j]] += edg
-0000d100: 655f 7765 6967 6874 3b0a 2020 2020 2020  e_weight;.      
-0000d110: 2020 6d61 7472 6978 5b5b 6a2c 2069 5d5d    matrix[[j, i]]
-0000d120: 202b 3d20 6564 6765 5f77 6569 6768 743b   += edge_weight;
-0000d130: 0a20 2020 207d 0a20 2020 204f 6b28 6d61  .    }.    Ok(ma
-0000d140: 7472 6978 2e69 6e74 6f5f 7079 6172 7261  trix.into_pyarra
-0000d150: 7928 7079 292e 696e 746f 2829 290a 7d0a  y(py).into()).}.
-0000d160: 0a2f 2f2f 2052 6574 7572 6e20 616c 6c20  ./// Return all 
-0000d170: 7369 6d70 6c65 2070 6174 6873 2062 6574  simple paths bet
-0000d180: 7765 656e 2032 206e 6f64 6573 2069 6e20  ween 2 nodes in 
-0000d190: 6120 5079 4772 6170 6820 6f62 6a65 6374  a PyGraph object
-0000d1a0: 0a2f 2f2f 0a2f 2f2f 2041 2073 696d 706c  .///./// A simpl
-0000d1b0: 6520 7061 7468 2069 7320 6120 7061 7468  e path is a path
-0000d1c0: 2077 6974 6820 6e6f 2072 6570 6561 7465   with no repeate
-0000d1d0: 6420 6e6f 6465 732e 0a2f 2f2f 0a2f 2f2f  d nodes..///.///
-0000d1e0: 203a 7061 7261 6d20 5079 4772 6170 6820   :param PyGraph 
-0000d1f0: 6772 6170 683a 2054 6865 2067 7261 7068  graph: The graph
-0000d200: 2074 6f20 6669 6e64 2074 6865 2070 6174   to find the pat
-0000d210: 6820 696e 0a2f 2f2f 203a 7061 7261 6d20  h in./// :param 
-0000d220: 696e 7420 6672 6f6d 3a20 5468 6520 6e6f  int from: The no
-0000d230: 6465 2069 6e64 6578 2074 6f20 6669 6e64  de index to find
-0000d240: 2074 6865 2070 6174 6873 2066 726f 6d0a   the paths from.
-0000d250: 2f2f 2f20 3a70 6172 616d 2069 6e74 2074  /// :param int t
-0000d260: 6f3a 2054 6865 206e 6f64 6520 696e 6465  o: The node inde
-0000d270: 7820 746f 2066 696e 6420 7468 6520 7061  x to find the pa
-0000d280: 7468 7320 746f 0a2f 2f2f 203a 7061 7261  ths to./// :para
-0000d290: 6d20 696e 7420 6d69 6e5f 6465 7074 683a  m int min_depth:
-0000d2a0: 2054 6865 206d 696e 696d 756d 2064 6570   The minimum dep
-0000d2b0: 7468 206f 6620 7468 6520 7061 7468 2074  th of the path t
-0000d2c0: 6f20 696e 636c 7564 6520 696e 2074 6865  o include in the
-0000d2d0: 206f 7574 7075 740a 2f2f 2f20 2020 2020   output.///     
-0000d2e0: 6c69 7374 206f 6620 7061 7468 732e 2042  list of paths. B
-0000d2f0: 7920 6465 6661 756c 7420 616c 6c20 7061  y default all pa
-0000d300: 7468 7320 6172 6520 696e 636c 7564 6564  ths are included
-0000d310: 2072 6567 6172 646c 6573 7320 6f66 2064   regardless of d
-0000d320: 6570 7468 2c0a 2f2f 2f20 2020 2020 7365  epth,.///     se
-0000d330: 7474 696e 6720 746f 2030 2077 696c 6c20  tting to 0 will 
-0000d340: 6265 6861 7665 206c 696b 6520 7468 6520  behave like the 
-0000d350: 6465 6661 756c 742e 0a2f 2f2f 203a 7061  default../// :pa
-0000d360: 7261 6d20 696e 7420 6375 746f 6666 3a20  ram int cutoff: 
-0000d370: 5468 6520 6d61 7869 6d75 6d20 6465 7074  The maximum dept
-0000d380: 6820 6f66 2070 6174 6820 746f 2069 6e63  h of path to inc
-0000d390: 6c75 6465 2069 6e20 7468 6520 6f75 7470  lude in the outp
-0000d3a0: 7574 206c 6973 740a 2f2f 2f20 2020 2020  ut list.///     
-0000d3b0: 6f66 2070 6174 6873 2e20 4279 2064 6566  of paths. By def
-0000d3c0: 6175 6c74 2069 6e63 6c75 6465 7320 616c  ault includes al
-0000d3d0: 6c20 7061 7468 7320 7265 6761 7264 6c65  l paths regardle
-0000d3e0: 7373 206f 6620 6465 7074 682c 2073 6574  ss of depth, set
-0000d3f0: 7469 6e67 2074 6f0a 2f2f 2f20 2020 2020  ting to.///     
-0000d400: 3020 7769 6c6c 2062 6568 6176 6520 6c69  0 will behave li
-0000d410: 6b65 2064 6566 6175 6c74 2e0a 2f2f 2f0a  ke default..///.
-0000d420: 2f2f 2f20 3a72 6574 7572 6e73 3a20 4120  /// :returns: A 
-0000d430: 6c69 7374 206f 6620 6c69 7374 7320 7768  list of lists wh
-0000d440: 6572 6520 6561 6368 2069 6e6e 6572 206c  ere each inner l
-0000d450: 6973 7420 6973 2061 2070 6174 6820 6f66  ist is a path of
-0000d460: 206e 6f64 6520 696e 6469 6365 730a 2f2f   node indices.//
-0000d470: 2f20 3a72 7479 7065 3a20 6c69 7374 0a23  / :rtype: list.#
-0000d480: 5b70 7966 756e 6374 696f 6e5d 0a23 5b74  [pyfunction].#[t
-0000d490: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
-0000d4a0: 2228 6772 6170 682c 2066 726f 6d2c 2074  "(graph, from, t
-0000d4b0: 6f2c 202f 2c20 6d69 6e3d 4e6f 6e65 2c20  o, /, min=None, 
-0000d4c0: 6375 746f 6666 3d4e 6f6e 6529 225d 0a66  cutoff=None)"].f
-0000d4d0: 6e20 6772 6170 685f 616c 6c5f 7369 6d70  n graph_all_simp
-0000d4e0: 6c65 5f70 6174 6873 280a 2020 2020 6772  le_paths(.    gr
-0000d4f0: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
-0000d500: 7261 7068 2c0a 2020 2020 6672 6f6d 3a20  raph,.    from: 
-0000d510: 7573 697a 652c 0a20 2020 2074 6f3a 2075  usize,.    to: u
-0000d520: 7369 7a65 2c0a 2020 2020 6d69 6e5f 6465  size,.    min_de
-0000d530: 7074 683a 204f 7074 696f 6e3c 7573 697a  pth: Option<usiz
-0000d540: 653e 2c0a 2020 2020 6375 746f 6666 3a20  e>,.    cutoff: 
-0000d550: 4f70 7469 6f6e 3c75 7369 7a65 3e2c 0a29  Option<usize>,.)
-0000d560: 202d 3e20 5079 5265 7375 6c74 3c56 6563   -> PyResult<Vec
-0000d570: 3c56 6563 3c75 7369 7a65 3e3e 3e20 7b0a  <Vec<usize>>> {.
-0000d580: 2020 2020 6c65 7420 6672 6f6d 5f69 6e64      let from_ind
-0000d590: 6578 203d 204e 6f64 6549 6e64 6578 3a3a  ex = NodeIndex::
-0000d5a0: 6e65 7728 6672 6f6d 293b 0a20 2020 2069  new(from);.    i
-0000d5b0: 6620 2167 7261 7068 2e67 7261 7068 2e63  f !graph.graph.c
-0000d5c0: 6f6e 7461 696e 735f 6e6f 6465 2866 726f  ontains_node(fro
-0000d5d0: 6d5f 696e 6465 7829 207b 0a20 2020 2020  m_index) {.     
-0000d5e0: 2020 2072 6574 7572 6e20 4572 7228 496e     return Err(In
-0000d5f0: 7661 6c69 644e 6f64 653a 3a6e 6577 5f65  validNode::new_e
-0000d600: 7272 280a 2020 2020 2020 2020 2020 2020  rr(.            
-0000d610: 2254 6865 2069 6e70 7574 2069 6e64 6578  "The input index
-0000d620: 2066 6f72 2027 6672 6f6d 2720 6973 206e   for 'from' is n
-0000d630: 6f74 2061 2076 616c 6964 206e 6f64 6520  ot a valid node 
-0000d640: 696e 6465 7822 2c0a 2020 2020 2020 2020  index",.        
-0000d650: 2929 3b0a 2020 2020 7d0a 2020 2020 6c65  ));.    }.    le
-0000d660: 7420 746f 5f69 6e64 6578 203d 204e 6f64  t to_index = Nod
-0000d670: 6549 6e64 6578 3a3a 6e65 7728 746f 293b  eIndex::new(to);
-0000d680: 0a20 2020 2069 6620 2167 7261 7068 2e67  .    if !graph.g
-0000d690: 7261 7068 2e63 6f6e 7461 696e 735f 6e6f  raph.contains_no
-0000d6a0: 6465 2874 6f5f 696e 6465 7829 207b 0a20  de(to_index) {. 
-0000d6b0: 2020 2020 2020 2072 6574 7572 6e20 4572         return Er
-0000d6c0: 7228 496e 7661 6c69 644e 6f64 653a 3a6e  r(InvalidNode::n
-0000d6d0: 6577 5f65 7272 280a 2020 2020 2020 2020  ew_err(.        
-0000d6e0: 2020 2020 2254 6865 2069 6e70 7574 2069      "The input i
-0000d6f0: 6e64 6578 2066 6f72 2027 746f 2720 6973  ndex for 'to' is
-0000d700: 206e 6f74 2061 2076 616c 6964 206e 6f64   not a valid nod
-0000d710: 6520 696e 6465 7822 2c0a 2020 2020 2020  e index",.      
-0000d720: 2020 2929 3b0a 2020 2020 7d0a 2020 2020    ));.    }.    
-0000d730: 6c65 7420 6d69 6e5f 696e 7465 726d 6564  let min_intermed
-0000d740: 6961 7465 5f6e 6f64 6573 3a20 7573 697a  iate_nodes: usiz
-0000d750: 6520 3d20 6d61 7463 6820 6d69 6e5f 6465  e = match min_de
-0000d760: 7074 6820 7b0a 2020 2020 2020 2020 536f  pth {.        So
-0000d770: 6d65 2864 6570 7468 2920 3d3e 2064 6570  me(depth) => dep
-0000d780: 7468 202d 2032 2c0a 2020 2020 2020 2020  th - 2,.        
-0000d790: 4e6f 6e65 203d 3e20 302c 0a20 2020 207d  None => 0,.    }
-0000d7a0: 3b0a 2020 2020 6c65 7420 6375 746f 6666  ;.    let cutoff
-0000d7b0: 5f70 6574 6772 6170 683a 204f 7074 696f  _petgraph: Optio
-0000d7c0: 6e3c 7573 697a 653e 203d 206d 6174 6368  n<usize> = match
-0000d7d0: 2063 7574 6f66 6620 7b0a 2020 2020 2020   cutoff {.      
-0000d7e0: 2020 536f 6d65 2864 6570 7468 2920 3d3e    Some(depth) =>
-0000d7f0: 2053 6f6d 6528 6465 7074 6820 2d20 3229   Some(depth - 2)
-0000d800: 2c0a 2020 2020 2020 2020 4e6f 6e65 203d  ,.        None =
-0000d810: 3e20 4e6f 6e65 2c0a 2020 2020 7d3b 0a20  > None,.    };. 
-0000d820: 2020 206c 6574 2072 6573 756c 743a 2056     let result: V
-0000d830: 6563 3c56 6563 3c75 7369 7a65 3e3e 203d  ec<Vec<usize>> =
-0000d840: 2061 6c67 6f3a 3a61 6c6c 5f73 696d 706c   algo::all_simpl
-0000d850: 655f 7061 7468 7328 0a20 2020 2020 2020  e_paths(.       
-0000d860: 2067 7261 7068 2c0a 2020 2020 2020 2020   graph,.        
-0000d870: 6672 6f6d 5f69 6e64 6578 2c0a 2020 2020  from_index,.    
-0000d880: 2020 2020 746f 5f69 6e64 6578 2c0a 2020      to_index,.  
-0000d890: 2020 2020 2020 6d69 6e5f 696e 7465 726d        min_interm
-0000d8a0: 6564 6961 7465 5f6e 6f64 6573 2c0a 2020  ediate_nodes,.  
-0000d8b0: 2020 2020 2020 6375 746f 6666 5f70 6574        cutoff_pet
-0000d8c0: 6772 6170 682c 0a20 2020 2029 0a20 2020  graph,.    ).   
-0000d8d0: 202e 6d61 7028 7c76 3a20 5665 633c 4e6f   .map(|v: Vec<No
-0000d8e0: 6465 496e 6465 783e 7c20 762e 696e 746f  deIndex>| v.into
-0000d8f0: 5f69 7465 7228 292e 6d61 7028 7c69 7c20  _iter().map(|i| 
-0000d900: 692e 696e 6465 7828 2929 2e63 6f6c 6c65  i.index()).colle
-0000d910: 6374 2829 290a 2020 2020 2e63 6f6c 6c65  ct()).    .colle
-0000d920: 6374 2829 3b0a 2020 2020 4f6b 2872 6573  ct();.    Ok(res
-0000d930: 756c 7429 0a7d 0a0a 2f2f 2f20 5265 7475  ult).}../// Retu
-0000d940: 726e 2061 6c6c 2073 696d 706c 6520 7061  rn all simple pa
-0000d950: 7468 7320 6265 7477 6565 6e20 3220 6e6f  ths between 2 no
-0000d960: 6465 7320 696e 2061 2050 7944 6947 7261  des in a PyDiGra
-0000d970: 7068 206f 626a 6563 740a 2f2f 2f0a 2f2f  ph object.///.//
-0000d980: 2f20 4120 7369 6d70 6c65 2070 6174 6820  / A simple path 
-0000d990: 6973 2061 2070 6174 6820 7769 7468 206e  is a path with n
-0000d9a0: 6f20 7265 7065 6174 6564 206e 6f64 6573  o repeated nodes
-0000d9b0: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
-0000d9c0: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
-0000d9d0: 3a20 5468 6520 6772 6170 6820 746f 2066  : The graph to f
-0000d9e0: 696e 6420 7468 6520 7061 7468 2069 6e0a  ind the path in.
-0000d9f0: 2f2f 2f20 3a70 6172 616d 2069 6e74 2066  /// :param int f
-0000da00: 726f 6d3a 2054 6865 206e 6f64 6520 696e  rom: The node in
-0000da10: 6465 7820 746f 2066 696e 6420 7468 6520  dex to find the 
-0000da20: 7061 7468 7320 6672 6f6d 0a2f 2f2f 203a  paths from./// :
-0000da30: 7061 7261 6d20 696e 7420 746f 3a20 5468  param int to: Th
-0000da40: 6520 6e6f 6465 2069 6e64 6578 2074 6f20  e node index to 
-0000da50: 6669 6e64 2074 6865 2070 6174 6873 2074  find the paths t
-0000da60: 6f0a 2f2f 2f20 3a70 6172 616d 2069 6e74  o./// :param int
-0000da70: 206d 696e 5f64 6570 7468 3a20 5468 6520   min_depth: The 
-0000da80: 6d69 6e69 6d75 6d20 6465 7074 6820 6f66  minimum depth of
-0000da90: 2074 6865 2070 6174 6820 746f 2069 6e63   the path to inc
-0000daa0: 6c75 6465 2069 6e20 7468 6520 6f75 7470  lude in the outp
-0000dab0: 7574 0a2f 2f2f 2020 2020 206c 6973 7420  ut.///     list 
-0000dac0: 6f66 2070 6174 6873 2e20 4279 2064 6566  of paths. By def
-0000dad0: 6175 6c74 2061 6c6c 2070 6174 6873 2061  ault all paths a
-0000dae0: 7265 2069 6e63 6c75 6465 6420 7265 6761  re included rega
-0000daf0: 7264 6c65 7373 206f 6620 6465 7074 682c  rdless of depth,
-0000db00: 0a2f 2f2f 2020 2020 2073 6574 7420 746f  .///     sett to
-0000db10: 2030 2077 696c 6c20 6265 6861 7665 206c   0 will behave l
-0000db20: 696b 6520 7468 6520 6465 6661 756c 742e  ike the default.
-0000db30: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
-0000db40: 6375 746f 6666 3a20 5468 6520 6d61 7869  cutoff: The maxi
-0000db50: 6d75 6d20 6465 7074 6820 6f66 2070 6174  mum depth of pat
-0000db60: 6820 746f 2069 6e63 6c75 6465 2069 6e20  h to include in 
-0000db70: 7468 6520 6f75 7470 7574 206c 6973 740a  the output list.
-0000db80: 2f2f 2f20 2020 2020 6f66 2070 6174 6873  ///     of paths
-0000db90: 2e20 4279 2064 6566 6175 6c74 2069 6e63  . By default inc
-0000dba0: 6c75 6465 7320 616c 6c20 7061 7468 7320  ludes all paths 
-0000dbb0: 7265 6761 7264 6c65 7373 206f 6620 6465  regardless of de
-0000dbc0: 7074 682c 2073 6574 7469 6e67 2074 6f0a  pth, setting to.
-0000dbd0: 2f2f 2f20 2020 2020 3020 7769 6c6c 2062  ///     0 will b
-0000dbe0: 6568 6176 6520 6c69 6b65 2064 6566 6175  ehave like defau
-0000dbf0: 6c74 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  lt..///./// :ret
-0000dc00: 7572 6e73 3a20 4120 6c69 7374 206f 6620  urns: A list of 
-0000dc10: 6c69 7374 7320 7768 6572 6520 6561 6368  lists where each
-0000dc20: 2069 6e6e 6572 206c 6973 7420 6973 2061   inner list is a
-0000dc30: 2070 6174 680a 2f2f 2f20 3a72 7479 7065   path./// :rtype
-0000dc40: 3a20 6c69 7374 0a23 5b70 7966 756e 6374  : list.#[pyfunct
-0000dc50: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
-0000dc60: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
-0000dc70: 2066 726f 6d2c 2074 6f2c 202f 2c20 6d69   from, to, /, mi
-0000dc80: 6e5f 6465 7074 683d 4e6f 6e65 2c20 6375  n_depth=None, cu
-0000dc90: 746f 6666 3d4e 6f6e 6529 225d 0a66 6e20  toff=None)"].fn 
-0000dca0: 6469 6772 6170 685f 616c 6c5f 7369 6d70  digraph_all_simp
-0000dcb0: 6c65 5f70 6174 6873 280a 2020 2020 6772  le_paths(.    gr
-0000dcc0: 6170 683a 2026 6469 6772 6170 683a 3a50  aph: &digraph::P
-0000dcd0: 7944 6947 7261 7068 2c0a 2020 2020 6672  yDiGraph,.    fr
-0000dce0: 6f6d 3a20 7573 697a 652c 0a20 2020 2074  om: usize,.    t
-0000dcf0: 6f3a 2075 7369 7a65 2c0a 2020 2020 6d69  o: usize,.    mi
-0000dd00: 6e5f 6465 7074 683a 204f 7074 696f 6e3c  n_depth: Option<
-0000dd10: 7573 697a 653e 2c0a 2020 2020 6375 746f  usize>,.    cuto
-0000dd20: 6666 3a20 4f70 7469 6f6e 3c75 7369 7a65  ff: Option<usize
-0000dd30: 3e2c 0a29 202d 3e20 5079 5265 7375 6c74  >,.) -> PyResult
-0000dd40: 3c56 6563 3c56 6563 3c75 7369 7a65 3e3e  <Vec<Vec<usize>>
-0000dd50: 3e20 7b0a 2020 2020 6c65 7420 6672 6f6d  > {.    let from
-0000dd60: 5f69 6e64 6578 203d 204e 6f64 6549 6e64  _index = NodeInd
-0000dd70: 6578 3a3a 6e65 7728 6672 6f6d 293b 0a20  ex::new(from);. 
-0000dd80: 2020 2069 6620 2167 7261 7068 2e67 7261     if !graph.gra
-0000dd90: 7068 2e63 6f6e 7461 696e 735f 6e6f 6465  ph.contains_node
-0000dda0: 2866 726f 6d5f 696e 6465 7829 207b 0a20  (from_index) {. 
-0000ddb0: 2020 2020 2020 2072 6574 7572 6e20 4572         return Er
-0000ddc0: 7228 496e 7661 6c69 644e 6f64 653a 3a6e  r(InvalidNode::n
-0000ddd0: 6577 5f65 7272 280a 2020 2020 2020 2020  ew_err(.        
-0000dde0: 2020 2020 2254 6865 2069 6e70 7574 2069      "The input i
-0000ddf0: 6e64 6578 2066 6f72 2027 6672 6f6d 2720  ndex for 'from' 
-0000de00: 6973 206e 6f74 2061 2076 616c 6964 206e  is not a valid n
-0000de10: 6f64 6520 696e 6465 7822 2c0a 2020 2020  ode index",.    
-0000de20: 2020 2020 2929 3b0a 2020 2020 7d0a 2020      ));.    }.  
-0000de30: 2020 6c65 7420 746f 5f69 6e64 6578 203d    let to_index =
-0000de40: 204e 6f64 6549 6e64 6578 3a3a 6e65 7728   NodeIndex::new(
-0000de50: 746f 293b 0a20 2020 2069 6620 2167 7261  to);.    if !gra
-0000de60: 7068 2e67 7261 7068 2e63 6f6e 7461 696e  ph.graph.contain
-0000de70: 735f 6e6f 6465 2874 6f5f 696e 6465 7829  s_node(to_index)
-0000de80: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
-0000de90: 6e20 4572 7228 496e 7661 6c69 644e 6f64  n Err(InvalidNod
-0000dea0: 653a 3a6e 6577 5f65 7272 280a 2020 2020  e::new_err(.    
-0000deb0: 2020 2020 2020 2020 2254 6865 2069 6e70          "The inp
-0000dec0: 7574 2069 6e64 6578 2066 6f72 2027 746f  ut index for 'to
-0000ded0: 2720 6973 206e 6f74 2061 2076 616c 6964  ' is not a valid
-0000dee0: 206e 6f64 6520 696e 6465 7822 2c0a 2020   node index",.  
-0000def0: 2020 2020 2020 2929 3b0a 2020 2020 7d0a        ));.    }.
-0000df00: 2020 2020 6c65 7420 6d69 6e5f 696e 7465      let min_inte
-0000df10: 726d 6564 6961 7465 5f6e 6f64 6573 3a20  rmediate_nodes: 
-0000df20: 7573 697a 6520 3d20 6d61 7463 6820 6d69  usize = match mi
-0000df30: 6e5f 6465 7074 6820 7b0a 2020 2020 2020  n_depth {.      
-0000df40: 2020 536f 6d65 2864 6570 7468 2920 3d3e    Some(depth) =>
-0000df50: 2064 6570 7468 202d 2032 2c0a 2020 2020   depth - 2,.    
-0000df60: 2020 2020 4e6f 6e65 203d 3e20 302c 0a20      None => 0,. 
-0000df70: 2020 207d 3b0a 2020 2020 6c65 7420 6375     };.    let cu
-0000df80: 746f 6666 5f70 6574 6772 6170 683a 204f  toff_petgraph: O
-0000df90: 7074 696f 6e3c 7573 697a 653e 203d 206d  ption<usize> = m
-0000dfa0: 6174 6368 2063 7574 6f66 6620 7b0a 2020  atch cutoff {.  
-0000dfb0: 2020 2020 2020 536f 6d65 2864 6570 7468        Some(depth
-0000dfc0: 2920 3d3e 2053 6f6d 6528 6465 7074 6820  ) => Some(depth 
-0000dfd0: 2d20 3229 2c0a 2020 2020 2020 2020 4e6f  - 2),.        No
-0000dfe0: 6e65 203d 3e20 4e6f 6e65 2c0a 2020 2020  ne => None,.    
-0000dff0: 7d3b 0a20 2020 206c 6574 2072 6573 756c  };.    let resul
-0000e000: 743a 2056 6563 3c56 6563 3c75 7369 7a65  t: Vec<Vec<usize
-0000e010: 3e3e 203d 2061 6c67 6f3a 3a61 6c6c 5f73  >> = algo::all_s
-0000e020: 696d 706c 655f 7061 7468 7328 0a20 2020  imple_paths(.   
-0000e030: 2020 2020 2067 7261 7068 2c0a 2020 2020       graph,.    
-0000e040: 2020 2020 6672 6f6d 5f69 6e64 6578 2c0a      from_index,.
-0000e050: 2020 2020 2020 2020 746f 5f69 6e64 6578          to_index
-0000e060: 2c0a 2020 2020 2020 2020 6d69 6e5f 696e  ,.        min_in
-0000e070: 7465 726d 6564 6961 7465 5f6e 6f64 6573  termediate_nodes
-0000e080: 2c0a 2020 2020 2020 2020 6375 746f 6666  ,.        cutoff
-0000e090: 5f70 6574 6772 6170 682c 0a20 2020 2029  _petgraph,.    )
-0000e0a0: 0a20 2020 202e 6d61 7028 7c76 3a20 5665  .    .map(|v: Ve
-0000e0b0: 633c 4e6f 6465 496e 6465 783e 7c20 762e  c<NodeIndex>| v.
-0000e0c0: 696e 746f 5f69 7465 7228 292e 6d61 7028  into_iter().map(
-0000e0d0: 7c69 7c20 692e 696e 6465 7828 2929 2e63  |i| i.index()).c
-0000e0e0: 6f6c 6c65 6374 2829 290a 2020 2020 2e63  ollect()).    .c
-0000e0f0: 6f6c 6c65 6374 2829 3b0a 2020 2020 4f6b  ollect();.    Ok
-0000e100: 2872 6573 756c 7429 0a7d 0a0a 666e 2077  (result).}..fn w
-0000e110: 6569 6768 745f 6361 6c6c 6162 6c65 280a  eight_callable(.
-0000e120: 2020 2020 7079 3a20 5079 7468 6f6e 2c0a      py: Python,.
-0000e130: 2020 2020 7765 6967 6874 5f66 6e3a 2026      weight_fn: &
-0000e140: 4f70 7469 6f6e 3c50 794f 626a 6563 743e  Option<PyObject>
-0000e150: 2c0a 2020 2020 7765 6967 6874 3a20 2650  ,.    weight: &P
-0000e160: 794f 626a 6563 742c 0a20 2020 2064 6566  yObject,.    def
-0000e170: 6175 6c74 3a20 6636 342c 0a29 202d 3e20  ault: f64,.) -> 
-0000e180: 5079 5265 7375 6c74 3c66 3634 3e20 7b0a  PyResult<f64> {.
-0000e190: 2020 2020 6d61 7463 6820 7765 6967 6874      match weight
-0000e1a0: 5f66 6e20 7b0a 2020 2020 2020 2020 536f  _fn {.        So
-0000e1b0: 6d65 2877 6569 6768 745f 666e 2920 3d3e  me(weight_fn) =>
-0000e1c0: 207b 0a20 2020 2020 2020 2020 2020 206c   {.            l
-0000e1d0: 6574 2072 6573 203d 2077 6569 6768 745f  et res = weight_
-0000e1e0: 666e 2e63 616c 6c31 2870 792c 2028 7765  fn.call1(py, (we
-0000e1f0: 6967 6874 2c29 293f 3b0a 2020 2020 2020  ight,))?;.      
-0000e200: 2020 2020 2020 7265 732e 6578 7472 6163        res.extrac
-0000e210: 7428 7079 290a 2020 2020 2020 2020 7d0a  t(py).        }.
-0000e220: 2020 2020 2020 2020 4e6f 6e65 203d 3e20          None => 
-0000e230: 4f6b 2864 6566 6175 6c74 292c 0a20 2020  Ok(default),.   
-0000e240: 207d 0a7d 0a0a 2f2f 2f20 4669 6e64 2074   }.}../// Find t
-0000e250: 6865 2073 686f 7274 6573 7420 7061 7468  he shortest path
-0000e260: 2066 726f 6d20 6120 6e6f 6465 0a2f 2f2f   from a node.///
-0000e270: 0a2f 2f2f 2054 6869 7320 6675 6e63 7469  ./// This functi
-0000e280: 6f6e 2077 696c 6c20 6765 6e65 7261 7465  on will generate
-0000e290: 2074 6865 2073 686f 7274 6573 7420 7061   the shortest pa
-0000e2a0: 7468 2066 726f 6d20 6120 736f 7572 6365  th from a source
-0000e2b0: 206e 6f64 6520 7573 696e 670a 2f2f 2f20   node using./// 
-0000e2c0: 4469 6a6b 7374 7261 2773 2061 6c67 6f72  Dijkstra's algor
-0000e2d0: 6974 686d 2e0a 2f2f 2f0a 2f2f 2f20 3a70  ithm..///./// :p
-0000e2e0: 6172 616d 2050 7947 7261 7068 2067 7261  aram PyGraph gra
-0000e2f0: 7068 3a0a 2f2f 2f20 3a70 6172 616d 2069  ph:./// :param i
-0000e300: 6e74 2073 6f75 7263 653a 2054 6865 206e  nt source: The n
-0000e310: 6f64 6520 696e 6465 7820 746f 2066 696e  ode index to fin
-0000e320: 6420 7061 7468 7320 6672 6f6d 0a2f 2f2f  d paths from.///
-0000e330: 203a 7061 7261 6d20 696e 7420 7461 7267   :param int targ
-0000e340: 6574 3a20 416e 206f 7074 696f 6e61 6c20  et: An optional 
-0000e350: 7461 7267 6574 2074 6f20 6669 6e64 2061  target to find a
-0000e360: 2070 6174 6820 746f 0a2f 2f2f 203a 7061   path to./// :pa
-0000e370: 7261 6d20 7765 6967 6874 5f66 6e3a 2041  ram weight_fn: A
-0000e380: 6e20 6f70 7469 6f6e 616c 2077 6569 6768  n optional weigh
-0000e390: 7420 6675 6e63 7469 6f6e 2066 6f72 2061  t function for a
-0000e3a0: 6e20 6564 6765 2e20 4974 2077 696c 6c20  n edge. It will 
-0000e3b0: 6163 6365 7074 0a2f 2f2f 2020 2020 2061  accept.///     a
-0000e3c0: 2073 696e 676c 6520 6172 6775 6d65 6e74   single argument
-0000e3d0: 2c20 7468 6520 6564 6765 2773 2077 6569  , the edge's wei
-0000e3e0: 6768 7420 6f62 6a65 6374 2061 6e64 2077  ght object and w
-0000e3f0: 696c 6c20 7265 7475 726e 2061 2066 6c6f  ill return a flo
-0000e400: 6174 2077 6869 6368 0a2f 2f2f 2020 2020  at which.///    
-0000e410: 2077 696c 6c20 6265 2075 7365 6420 746f   will be used to
-0000e420: 2072 6570 7265 7365 6e74 2074 6865 2077   represent the w
-0000e430: 6569 6768 742f 636f 7374 206f 6620 7468  eight/cost of th
-0000e440: 6520 6564 6765 0a2f 2f2f 203a 7061 7261  e edge./// :para
-0000e450: 6d20 666c 6f61 7420 6465 6661 756c 745f  m float default_
-0000e460: 7765 6967 6874 3a20 4966 2060 6077 6569  weight: If ``wei
-0000e470: 6768 745f 666e 6060 2069 736e 2774 2073  ght_fn`` isn't s
-0000e480: 7065 6369 6669 6564 2074 6869 7320 6f70  pecified this op
-0000e490: 7469 6f6e 616c 0a2f 2f2f 2020 2020 2066  tional.///     f
-0000e4a0: 6c6f 6174 2076 616c 7565 2077 696c 6c20  loat value will 
-0000e4b0: 6265 2075 7365 6420 666f 7220 7468 6520  be used for the 
-0000e4c0: 7765 6967 6874 2f63 6f73 7420 6f66 2065  weight/cost of e
-0000e4d0: 6163 6820 6564 6765 2e0a 2f2f 2f20 3a70  ach edge../// :p
-0000e4e0: 6172 616d 2062 6f6f 6c20 6173 5f75 6e64  aram bool as_und
-0000e4f0: 6972 6563 7465 643a 2049 6620 7365 7420  irected: If set 
-0000e500: 746f 2074 7275 6520 7468 6520 6772 6170  to true the grap
-0000e510: 6820 7769 6c6c 2062 6520 7472 6561 7465  h will be treate
-0000e520: 6420 6173 0a2f 2f2f 2020 2020 2075 6e64  d as.///     und
-0000e530: 6972 6563 7465 6420 666f 7220 6669 6e64  irected for find
-0000e540: 696e 6720 7468 6520 7368 6f72 7465 7374  ing the shortest
-0000e550: 2070 6174 682e 0a2f 2f2f 0a2f 2f2f 203a   path..///./// :
-0000e560: 7265 7475 726e 3a20 4469 6374 696f 6e61  return: Dictiona
-0000e570: 7279 206f 6620 7061 7468 732e 2054 6865  ry of paths. The
-0000e580: 206b 6579 7320 6172 6520 6465 7374 696e   keys are destin
-0000e590: 6174 696f 6e20 6e6f 6465 2069 6e64 6963  ation node indic
-0000e5a0: 6573 2061 6e64 0a2f 2f2f 2020 2020 2074  es and.///     t
-0000e5b0: 6865 2064 6963 7420 7661 6c75 6573 2061  he dict values a
-0000e5c0: 7265 206c 6973 7473 206f 6620 6e6f 6465  re lists of node
-0000e5d0: 2069 6e64 6963 6573 206d 616b 696e 6720   indices making 
-0000e5e0: 7468 6520 7061 7468 2e0a 2f2f 2f20 3a72  the path../// :r
-0000e5f0: 7479 7065 3a20 6469 6374 0a23 5b70 7966  type: dict.#[pyf
-0000e600: 756e 6374 696f 6e28 6465 6661 756c 745f  unction(default_
-0000e610: 7765 6967 6874 203d 2022 312e 3022 2c20  weight = "1.0", 
-0000e620: 6173 5f75 6e64 6972 6563 7465 6420 3d20  as_undirected = 
-0000e630: 2266 616c 7365 2229 5d0a 235b 7465 7874  "false")].#[text
-0000e640: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
-0000e650: 7261 7068 2c20 736f 7572 6365 2c20 2f2c  raph, source, /,
-0000e660: 2074 6172 6765 743d 4e6f 6e65 2077 6569   target=None wei
-0000e670: 6768 745f 666e 3d4e 6f6e 652c 2064 6566  ght_fn=None, def
-0000e680: 6175 6c74 5f77 6569 6768 743d 312e 3029  ault_weight=1.0)
-0000e690: 225d 0a70 7562 2066 6e20 6772 6170 685f  "].pub fn graph_
-0000e6a0: 6469 6a6b 7374 7261 5f73 686f 7274 6573  dijkstra_shortes
-0000e6b0: 745f 7061 7468 7328 0a20 2020 2070 793a  t_paths(.    py:
-0000e6c0: 2050 7974 686f 6e2c 0a20 2020 2067 7261   Python,.    gra
-0000e6d0: 7068 3a20 2667 7261 7068 3a3a 5079 4772  ph: &graph::PyGr
-0000e6e0: 6170 682c 0a20 2020 2073 6f75 7263 653a  aph,.    source:
-0000e6f0: 2075 7369 7a65 2c0a 2020 2020 7461 7267   usize,.    targ
-0000e700: 6574 3a20 4f70 7469 6f6e 3c75 7369 7a65  et: Option<usize
-0000e710: 3e2c 0a20 2020 2077 6569 6768 745f 666e  >,.    weight_fn
-0000e720: 3a20 4f70 7469 6f6e 3c50 794f 626a 6563  : Option<PyObjec
-0000e730: 743e 2c0a 2020 2020 6465 6661 756c 745f  t>,.    default_
-0000e740: 7765 6967 6874 3a20 6636 342c 0a29 202d  weight: f64,.) -
-0000e750: 3e20 5079 5265 7375 6c74 3c50 794f 626a  > PyResult<PyObj
-0000e760: 6563 743e 207b 0a20 2020 206c 6574 2073  ect> {.    let s
-0000e770: 7461 7274 203d 204e 6f64 6549 6e64 6578  tart = NodeIndex
-0000e780: 3a3a 6e65 7728 736f 7572 6365 293b 0a20  ::new(source);. 
-0000e790: 2020 206c 6574 2067 6f61 6c5f 696e 6465     let goal_inde
-0000e7a0: 783a 204f 7074 696f 6e3c 4e6f 6465 496e  x: Option<NodeIn
-0000e7b0: 6465 783e 203d 206d 6174 6368 2074 6172  dex> = match tar
-0000e7c0: 6765 7420 7b0a 2020 2020 2020 2020 536f  get {.        So
-0000e7d0: 6d65 286e 6f64 6529 203d 3e20 536f 6d65  me(node) => Some
-0000e7e0: 284e 6f64 6549 6e64 6578 3a3a 6e65 7728  (NodeIndex::new(
-0000e7f0: 6e6f 6465 2929 2c0a 2020 2020 2020 2020  node)),.        
-0000e800: 4e6f 6e65 203d 3e20 4e6f 6e65 2c0a 2020  None => None,.  
-0000e810: 2020 7d3b 0a20 2020 206c 6574 206d 7574    };.    let mut
-0000e820: 2070 6174 6873 3a20 4861 7368 4d61 703c   paths: HashMap<
-0000e830: 4e6f 6465 496e 6465 782c 2056 6563 3c4e  NodeIndex, Vec<N
-0000e840: 6f64 6549 6e64 6578 3e3e 203d 0a20 2020  odeIndex>> =.   
-0000e850: 2020 2020 2048 6173 684d 6170 3a3a 7769       HashMap::wi
-0000e860: 7468 5f63 6170 6163 6974 7928 6772 6170  th_capacity(grap
-0000e870: 682e 6e6f 6465 5f63 6f75 6e74 2829 293b  h.node_count());
-0000e880: 0a20 2020 2064 696a 6b73 7472 613a 3a64  .    dijkstra::d
-0000e890: 696a 6b73 7472 6128 0a20 2020 2020 2020  ijkstra(.       
-0000e8a0: 2067 7261 7068 2c0a 2020 2020 2020 2020   graph,.        
-0000e8b0: 7374 6172 742c 0a20 2020 2020 2020 2067  start,.        g
-0000e8c0: 6f61 6c5f 696e 6465 782c 0a20 2020 2020  oal_index,.     
-0000e8d0: 2020 207c 657c 2077 6569 6768 745f 6361     |e| weight_ca
-0000e8e0: 6c6c 6162 6c65 2870 792c 2026 7765 6967  llable(py, &weig
-0000e8f0: 6874 5f66 6e2c 2065 2e77 6569 6768 7428  ht_fn, e.weight(
-0000e900: 292c 2064 6566 6175 6c74 5f77 6569 6768  ), default_weigh
-0000e910: 7429 2c0a 2020 2020 2020 2020 536f 6d65  t),.        Some
-0000e920: 2826 6d75 7420 7061 7468 7329 2c0a 2020  (&mut paths),.  
-0000e930: 2020 293f 3b0a 0a20 2020 206c 6574 206f    )?;..    let o
-0000e940: 7574 5f64 6963 7420 3d20 5079 4469 6374  ut_dict = PyDict
-0000e950: 3a3a 6e65 7728 7079 293b 0a20 2020 2066  ::new(py);.    f
-0000e960: 6f72 2028 696e 6465 782c 2076 616c 7565  or (index, value
-0000e970: 2920 696e 2070 6174 6873 207b 0a20 2020  ) in paths {.   
-0000e980: 2020 2020 206c 6574 2069 6e74 5f69 6e64       let int_ind
-0000e990: 6578 203d 2069 6e64 6578 2e69 6e64 6578  ex = index.index
-0000e9a0: 2829 3b0a 2020 2020 2020 2020 6966 2069  ();.        if i
-0000e9b0: 6e74 5f69 6e64 6578 203d 3d20 736f 7572  nt_index == sour
-0000e9c0: 6365 207b 0a20 2020 2020 2020 2020 2020  ce {.           
-0000e9d0: 2063 6f6e 7469 6e75 653b 0a20 2020 2020   continue;.     
-0000e9e0: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
-0000e9f0: 2874 6172 6765 742e 6973 5f73 6f6d 6528  (target.is_some(
-0000ea00: 2920 2626 2074 6172 6765 742e 756e 7772  ) && target.unwr
-0000ea10: 6170 2829 203d 3d20 696e 745f 696e 6465  ap() == int_inde
-0000ea20: 7829 0a20 2020 2020 2020 2020 2020 207c  x).            |
-0000ea30: 7c20 7461 7267 6574 2e69 735f 6e6f 6e65  | target.is_none
-0000ea40: 2829 0a20 2020 2020 2020 207b 0a20 2020  ().        {.   
-0000ea50: 2020 2020 2020 2020 206f 7574 5f64 6963           out_dic
-0000ea60: 742e 7365 745f 6974 656d 280a 2020 2020  t.set_item(.    
-0000ea70: 2020 2020 2020 2020 2020 2020 696e 745f              int_
-0000ea80: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-0000ea90: 2020 2020 2020 2076 616c 7565 0a20 2020         value.   
-0000eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eab0: 202e 6974 6572 2829 0a20 2020 2020 2020   .iter().       
-0000eac0: 2020 2020 2020 2020 2020 2020 202e 6d61               .ma
-0000ead0: 7028 7c69 6e64 6578 7c20 696e 6465 782e  p(|index| index.
-0000eae0: 696e 6465 7828 2929 0a20 2020 2020 2020  index()).       
-0000eaf0: 2020 2020 2020 2020 2020 2020 202e 636f               .co
-0000eb00: 6c6c 6563 743a 3a3c 5665 633c 7573 697a  llect::<Vec<usiz
-0000eb10: 653e 3e28 292c 0a20 2020 2020 2020 2020  e>>(),.         
-0000eb20: 2020 2029 3f3b 0a20 2020 2020 2020 207d     )?;.        }
-0000eb30: 0a20 2020 207d 0a20 2020 204f 6b28 6f75  .    }.    Ok(ou
-0000eb40: 745f 6469 6374 2e69 6e74 6f28 2929 0a7d  t_dict.into()).}
-0000eb50: 0a0a 2f2f 2f20 4669 6e64 2074 6865 2073  ../// Find the s
-0000eb60: 686f 7274 6573 7420 7061 7468 2066 726f  hortest path fro
-0000eb70: 6d20 6120 6e6f 6465 0a2f 2f2f 0a2f 2f2f  m a node.///.///
-0000eb80: 2054 6869 7320 6675 6e63 7469 6f6e 2077   This function w
-0000eb90: 696c 6c20 6765 6e65 7261 7465 2074 6865  ill generate the
-0000eba0: 2073 686f 7274 6573 7420 7061 7468 2066   shortest path f
-0000ebb0: 726f 6d20 6120 736f 7572 6365 206e 6f64  rom a source nod
-0000ebc0: 6520 7573 696e 670a 2f2f 2f20 4469 6a6b  e using./// Dijk
-0000ebd0: 7374 7261 2773 2061 6c67 6f72 6974 686d  stra's algorithm
-0000ebe0: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
-0000ebf0: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
-0000ec00: 3a0a 2f2f 2f20 3a70 6172 616d 2069 6e74  :./// :param int
-0000ec10: 2073 6f75 7263 653a 2054 6865 206e 6f64   source: The nod
-0000ec20: 6520 696e 6465 7820 746f 2066 696e 6420  e index to find 
-0000ec30: 7061 7468 7320 6672 6f6d 0a2f 2f2f 203a  paths from./// :
-0000ec40: 7061 7261 6d20 696e 7420 7461 7267 6574  param int target
-0000ec50: 3a20 416e 206f 7074 696f 6e61 6c20 7461  : An optional ta
-0000ec60: 7267 6574 2070 6174 6820 746f 2066 696e  rget path to fin
-0000ec70: 6420 7468 6520 7061 7468 0a2f 2f2f 203a  d the path./// :
-0000ec80: 7061 7261 6d20 7765 6967 6874 5f66 6e3a  param weight_fn:
-0000ec90: 2041 6e20 6f70 7469 6f6e 616c 2077 6569   An optional wei
-0000eca0: 6768 7420 6675 6e63 7469 6f6e 2066 6f72  ght function for
-0000ecb0: 2061 6e20 6564 6765 2e20 4974 2077 696c   an edge. It wil
-0000ecc0: 6c20 6163 6365 7074 0a2f 2f2f 2020 2020  l accept.///    
-0000ecd0: 2061 2073 696e 676c 6520 6172 6775 6d65   a single argume
-0000ece0: 6e74 2c20 7468 6520 6564 6765 2773 2077  nt, the edge's w
-0000ecf0: 6569 6768 7420 6f62 6a65 6374 2061 6e64  eight object and
-0000ed00: 2077 696c 6c20 7265 7475 726e 2061 2066   will return a f
-0000ed10: 6c6f 6174 2077 6869 6368 0a2f 2f2f 2020  loat which.///  
-0000ed20: 2020 2077 696c 6c20 6265 2075 7365 6420     will be used 
-0000ed30: 746f 2072 6570 7265 7365 6e74 2074 6865  to represent the
-0000ed40: 2077 6569 6768 742f 636f 7374 206f 6620   weight/cost of 
-0000ed50: 7468 6520 6564 6765 0a2f 2f2f 203a 7061  the edge./// :pa
-0000ed60: 7261 6d20 666c 6f61 7420 6465 6661 756c  ram float defaul
-0000ed70: 745f 7765 6967 6874 3a20 4966 2060 6077  t_weight: If ``w
-0000ed80: 6569 6768 745f 666e 6060 2069 736e 2774  eight_fn`` isn't
-0000ed90: 2073 7065 6369 6669 6564 2074 6869 7320   specified this 
-0000eda0: 6f70 7469 6f6e 616c 0a2f 2f2f 2020 2020  optional.///    
-0000edb0: 2066 6c6f 6174 2076 616c 7565 2077 696c   float value wil
-0000edc0: 6c20 6265 2075 7365 6420 666f 7220 7468  l be used for th
-0000edd0: 6520 7765 6967 6874 2f63 6f73 7420 6f66  e weight/cost of
-0000ede0: 2065 6163 6820 6564 6765 2e0a 2f2f 2f20   each edge../// 
-0000edf0: 3a70 6172 616d 2062 6f6f 6c20 6173 5f75  :param bool as_u
-0000ee00: 6e64 6972 6563 7465 643a 2049 6620 7365  ndirected: If se
-0000ee10: 7420 746f 2074 7275 6520 7468 6520 6772  t to true the gr
-0000ee20: 6170 6820 7769 6c6c 2062 6520 7472 6561  aph will be trea
-0000ee30: 7465 6420 6173 0a2f 2f2f 2020 2020 2075  ted as.///     u
-0000ee40: 6e64 6972 6563 7465 6420 666f 7220 6669  ndirected for fi
-0000ee50: 6e64 696e 6720 7468 6520 7368 6f72 7465  nding the shorte
-0000ee60: 7374 2070 6174 682e 0a2f 2f2f 0a2f 2f2f  st path..///.///
-0000ee70: 203a 7265 7475 726e 3a20 4469 6374 696f   :return: Dictio
-0000ee80: 6e61 7279 206f 6620 7061 7468 732e 2054  nary of paths. T
-0000ee90: 6865 206b 6579 7320 6172 6520 6465 7374  he keys are dest
-0000eea0: 696e 6174 696f 6e20 6e6f 6465 2069 6e64  ination node ind
-0000eeb0: 6963 6573 2061 6e64 0a2f 2f2f 2020 2020  ices and.///    
-0000eec0: 2074 6865 2064 6963 7420 7661 6c75 6573   the dict values
-0000eed0: 2061 7265 206c 6973 7473 206f 6620 6e6f   are lists of no
-0000eee0: 6465 2069 6e64 6963 6573 206d 616b 696e  de indices makin
-0000eef0: 6720 7468 6520 7061 7468 2e0a 2f2f 2f20  g the path../// 
-0000ef00: 3a72 7479 7065 3a20 6469 6374 0a23 5b70  :rtype: dict.#[p
-0000ef10: 7966 756e 6374 696f 6e28 6465 6661 756c  yfunction(defaul
-0000ef20: 745f 7765 6967 6874 203d 2022 312e 3022  t_weight = "1.0"
-0000ef30: 2c20 6173 5f75 6e64 6972 6563 7465 6420  , as_undirected 
-0000ef40: 3d20 2266 616c 7365 2229 5d0a 235b 7465  = "false")].#[te
-0000ef50: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
-0000ef60: 2867 7261 7068 2c20 736f 7572 6365 2c20  (graph, source, 
-0000ef70: 2f2c 2074 6172 6765 743d 4e6f 6e65 2077  /, target=None w
-0000ef80: 6569 6768 745f 666e 3d4e 6f6e 652c 2064  eight_fn=None, d
-0000ef90: 6566 6175 6c74 5f77 6569 6768 743d 312e  efault_weight=1.
-0000efa0: 302c 2061 735f 756e 6469 7265 6374 6564  0, as_undirected
-0000efb0: 3d46 616c 7365 2922 5d0a 7075 6220 666e  =False)"].pub fn
-0000efc0: 2064 6967 7261 7068 5f64 696a 6b73 7472   digraph_dijkstr
-0000efd0: 615f 7368 6f72 7465 7374 5f70 6174 6873  a_shortest_paths
-0000efe0: 280a 2020 2020 7079 3a20 5079 7468 6f6e  (.    py: Python
-0000eff0: 2c0a 2020 2020 6772 6170 683a 2026 6469  ,.    graph: &di
-0000f000: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
-0000f010: 2c0a 2020 2020 736f 7572 6365 3a20 7573  ,.    source: us
-0000f020: 697a 652c 0a20 2020 2074 6172 6765 743a  ize,.    target:
-0000f030: 204f 7074 696f 6e3c 7573 697a 653e 2c0a   Option<usize>,.
-0000f040: 2020 2020 7765 6967 6874 5f66 6e3a 204f      weight_fn: O
-0000f050: 7074 696f 6e3c 5079 4f62 6a65 6374 3e2c  ption<PyObject>,
-0000f060: 0a20 2020 2064 6566 6175 6c74 5f77 6569  .    default_wei
-0000f070: 6768 743a 2066 3634 2c0a 2020 2020 6173  ght: f64,.    as
-0000f080: 5f75 6e64 6972 6563 7465 643a 2062 6f6f  _undirected: boo
-0000f090: 6c2c 0a29 202d 3e20 5079 5265 7375 6c74  l,.) -> PyResult
-0000f0a0: 3c50 794f 626a 6563 743e 207b 0a20 2020  <PyObject> {.   
-0000f0b0: 206c 6574 2073 7461 7274 203d 204e 6f64   let start = Nod
-0000f0c0: 6549 6e64 6578 3a3a 6e65 7728 736f 7572  eIndex::new(sour
-0000f0d0: 6365 293b 0a20 2020 206c 6574 2067 6f61  ce);.    let goa
-0000f0e0: 6c5f 696e 6465 783a 204f 7074 696f 6e3c  l_index: Option<
-0000f0f0: 4e6f 6465 496e 6465 783e 203d 206d 6174  NodeIndex> = mat
-0000f100: 6368 2074 6172 6765 7420 7b0a 2020 2020  ch target {.    
-0000f110: 2020 2020 536f 6d65 286e 6f64 6529 203d      Some(node) =
-0000f120: 3e20 536f 6d65 284e 6f64 6549 6e64 6578  > Some(NodeIndex
-0000f130: 3a3a 6e65 7728 6e6f 6465 2929 2c0a 2020  ::new(node)),.  
-0000f140: 2020 2020 2020 4e6f 6e65 203d 3e20 4e6f        None => No
-0000f150: 6e65 2c0a 2020 2020 7d3b 0a20 2020 206c  ne,.    };.    l
-0000f160: 6574 206d 7574 2070 6174 6873 3a20 4861  et mut paths: Ha
-0000f170: 7368 4d61 703c 4e6f 6465 496e 6465 782c  shMap<NodeIndex,
-0000f180: 2056 6563 3c4e 6f64 6549 6e64 6578 3e3e   Vec<NodeIndex>>
-0000f190: 203d 0a20 2020 2020 2020 2048 6173 684d   =.        HashM
-0000f1a0: 6170 3a3a 7769 7468 5f63 6170 6163 6974  ap::with_capacit
-0000f1b0: 7928 6772 6170 682e 6e6f 6465 5f63 6f75  y(graph.node_cou
-0000f1c0: 6e74 2829 293b 0a20 2020 2069 6620 6173  nt());.    if as
-0000f1d0: 5f75 6e64 6972 6563 7465 6420 7b0a 2020  _undirected {.  
-0000f1e0: 2020 2020 2020 6469 6a6b 7374 7261 3a3a        dijkstra::
-0000f1f0: 6469 6a6b 7374 7261 280a 2020 2020 2020  dijkstra(.      
-0000f200: 2020 2020 2020 2f2f 2054 4f44 4f3a 2055        // TODO: U
-0000f210: 7365 2070 6574 6772 6170 6820 756e 6469  se petgraph undi
-0000f220: 7265 6374 6564 2061 6461 7074 6572 2061  rected adapter a
-0000f230: 6674 6572 0a20 2020 2020 2020 2020 2020  fter.           
-0000f240: 202f 2f20 6874 7470 733a 2f2f 6769 7468   // https://gith
-0000f250: 7562 2e63 6f6d 2f70 6574 6772 6170 682f  ub.com/petgraph/
-0000f260: 7065 7467 7261 7068 2f70 756c 6c2f 3331  petgraph/pull/31
-0000f270: 3820 6973 2061 7661 696c 6162 6c65 2069  8 is available i
-0000f280: 6e0a 2020 2020 2020 2020 2020 2020 2f2f  n.            //
-0000f290: 2061 2070 6574 6772 6170 6820 7265 6c65   a petgraph rele
-0000f2a0: 6173 652e 0a20 2020 2020 2020 2020 2020  ase..           
-0000f2b0: 2026 6772 6170 682e 746f 5f75 6e64 6972   &graph.to_undir
-0000f2c0: 6563 7465 6428 7079 292c 0a20 2020 2020  ected(py),.     
-0000f2d0: 2020 2020 2020 2073 7461 7274 2c0a 2020         start,.  
-0000f2e0: 2020 2020 2020 2020 2020 676f 616c 5f69            goal_i
-0000f2f0: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
-0000f300: 2020 7c65 7c20 7765 6967 6874 5f63 616c    |e| weight_cal
-0000f310: 6c61 626c 6528 7079 2c20 2677 6569 6768  lable(py, &weigh
-0000f320: 745f 666e 2c20 652e 7765 6967 6874 2829  t_fn, e.weight()
-0000f330: 2c20 6465 6661 756c 745f 7765 6967 6874  , default_weight
-0000f340: 292c 0a20 2020 2020 2020 2020 2020 2053  ),.            S
-0000f350: 6f6d 6528 266d 7574 2070 6174 6873 292c  ome(&mut paths),
-0000f360: 0a20 2020 2020 2020 2029 3f3b 0a20 2020  .        )?;.   
-0000f370: 207d 2065 6c73 6520 7b0a 2020 2020 2020   } else {.      
-0000f380: 2020 6469 6a6b 7374 7261 3a3a 6469 6a6b    dijkstra::dijk
-0000f390: 7374 7261 280a 2020 2020 2020 2020 2020  stra(.          
-0000f3a0: 2020 6772 6170 682c 0a20 2020 2020 2020    graph,.       
-0000f3b0: 2020 2020 2073 7461 7274 2c0a 2020 2020       start,.    
-0000f3c0: 2020 2020 2020 2020 676f 616c 5f69 6e64          goal_ind
-0000f3d0: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-0000f3e0: 7c65 7c20 7765 6967 6874 5f63 616c 6c61  |e| weight_calla
-0000f3f0: 626c 6528 7079 2c20 2677 6569 6768 745f  ble(py, &weight_
-0000f400: 666e 2c20 652e 7765 6967 6874 2829 2c20  fn, e.weight(), 
-0000f410: 6465 6661 756c 745f 7765 6967 6874 292c  default_weight),
-0000f420: 0a20 2020 2020 2020 2020 2020 2053 6f6d  .            Som
-0000f430: 6528 266d 7574 2070 6174 6873 292c 0a20  e(&mut paths),. 
-0000f440: 2020 2020 2020 2029 3f3b 0a20 2020 207d         )?;.    }
-0000f450: 0a0a 2020 2020 6c65 7420 6f75 745f 6469  ..    let out_di
-0000f460: 6374 203d 2050 7944 6963 743a 3a6e 6577  ct = PyDict::new
-0000f470: 2870 7929 3b0a 2020 2020 666f 7220 2869  (py);.    for (i
-0000f480: 6e64 6578 2c20 7661 6c75 6529 2069 6e20  ndex, value) in 
-0000f490: 7061 7468 7320 7b0a 2020 2020 2020 2020  paths {.        
-0000f4a0: 6c65 7420 696e 745f 696e 6465 7820 3d20  let int_index = 
-0000f4b0: 696e 6465 782e 696e 6465 7828 293b 0a20  index.index();. 
-0000f4c0: 2020 2020 2020 2069 6620 696e 745f 696e         if int_in
-0000f4d0: 6465 7820 3d3d 2073 6f75 7263 6520 7b0a  dex == source {.
-0000f4e0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0000f4f0: 696e 7565 3b0a 2020 2020 2020 2020 7d0a  inue;.        }.
-0000f500: 2020 2020 2020 2020 6966 2028 7461 7267          if (targ
-0000f510: 6574 2e69 735f 736f 6d65 2829 2026 2620  et.is_some() && 
-0000f520: 7461 7267 6574 2e75 6e77 7261 7028 2920  target.unwrap() 
-0000f530: 3d3d 2069 6e74 5f69 6e64 6578 290a 2020  == int_index).  
-0000f540: 2020 2020 2020 2020 2020 7c7c 2074 6172            || tar
-0000f550: 6765 742e 6973 5f6e 6f6e 6528 290a 2020  get.is_none().  
-0000f560: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0000f570: 2020 2020 6f75 745f 6469 6374 2e73 6574      out_dict.set
-0000f580: 5f69 7465 6d28 0a20 2020 2020 2020 2020  _item(.         
-0000f590: 2020 2020 2020 2069 6e74 5f69 6e64 6578         int_index
-0000f5a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f5b0: 2020 7661 6c75 650a 2020 2020 2020 2020    value.        
-0000f5c0: 2020 2020 2020 2020 2020 2020 2e69 7465              .ite
-0000f5d0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-0000f5e0: 2020 2020 2020 2020 2e6d 6170 287c 696e          .map(|in
-0000f5f0: 6465 787c 2069 6e64 6578 2e69 6e64 6578  dex| index.index
-0000f600: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-0000f610: 2020 2020 2020 2020 2e63 6f6c 6c65 6374          .collect
-0000f620: 3a3a 3c56 6563 3c75 7369 7a65 3e3e 2829  ::<Vec<usize>>()
-0000f630: 2c0a 2020 2020 2020 2020 2020 2020 293f  ,.            )?
-0000f640: 3b0a 2020 2020 2020 2020 7d0a 2020 2020  ;.        }.    
-0000f650: 7d0a 2020 2020 4f6b 286f 7574 5f64 6963  }.    Ok(out_dic
-0000f660: 742e 696e 746f 2829 290a 7d0a 0a2f 2f2f  t.into()).}..///
-0000f670: 2043 6f6d 7075 7465 2074 6865 206c 656e   Compute the len
-0000f680: 6774 6873 206f 6620 7468 6520 7368 6f72  gths of the shor
-0000f690: 7465 7374 2070 6174 6873 2066 6f72 2061  test paths for a
-0000f6a0: 2050 7947 7261 7068 206f 626a 6563 7420   PyGraph object 
-0000f6b0: 7573 696e 670a 2f2f 2f20 4469 6a6b 7374  using./// Dijkst
-0000f6c0: 7261 2773 2061 6c67 6f72 6974 686d 0a2f  ra's algorithm./
-0000f6d0: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
-0000f6e0: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-0000f6f0: 2069 6e70 7574 2067 7261 7068 2074 6f20   input graph to 
-0000f700: 7573 650a 2f2f 2f20 3a70 6172 616d 2069  use./// :param i
-0000f710: 6e74 206e 6f64 653a 2054 6865 206e 6f64  nt node: The nod
-0000f720: 6520 696e 6465 7820 746f 2075 7365 2061  e index to use a
-0000f730: 7320 7468 6520 736f 7572 6365 2066 6f72  s the source for
-0000f740: 2066 696e 6469 6e67 2074 6865 0a2f 2f2f   finding the.///
-0000f750: 2020 2020 2073 686f 7274 6573 7420 7061       shortest pa
-0000f760: 7468 7320 6672 6f6d 0a2f 2f2f 203a 7061  ths from./// :pa
-0000f770: 7261 6d20 6564 6765 5f63 6f73 745f 666e  ram edge_cost_fn
-0000f780: 3a20 4120 7079 7468 6f6e 2063 616c 6c61  : A python calla
-0000f790: 626c 6520 7468 6174 2077 696c 6c20 7461  ble that will ta
-0000f7a0: 6b65 2069 6e20 3120 7061 7261 6d65 7465  ke in 1 paramete
-0000f7b0: 722c 2061 6e0a 2f2f 2f20 2020 2020 6564  r, an.///     ed
-0000f7c0: 6765 2773 2064 6174 6120 6f62 6a65 6374  ge's data object
-0000f7d0: 2061 6e64 2077 696c 6c20 7265 7475 726e   and will return
-0000f7e0: 2061 2066 6c6f 6174 2074 6861 7420 7265   a float that re
-0000f7f0: 7072 6573 656e 7473 2074 6865 0a2f 2f2f  presents the.///
-0000f800: 2020 2020 2063 6f73 742f 7765 6967 6874       cost/weight
-0000f810: 206f 6620 7468 6174 2065 6467 652e 2049   of that edge. I
-0000f820: 7420 6d75 7374 2062 6520 6e6f 6e2d 6e65  t must be non-ne
-0000f830: 6761 7469 7665 0a2f 2f2f 203a 7061 7261  gative./// :para
-0000f840: 6d20 696e 7420 676f 616c 3a20 416e 206f  m int goal: An o
-0000f850: 7074 696f 6e61 6c20 6e6f 6465 2069 6e64  ptional node ind
-0000f860: 6578 2074 6f20 7573 6520 6173 2074 6865  ex to use as the
-0000f870: 2065 6e64 206f 6620 7468 6520 7061 7468   end of the path
-0000f880: 2e0a 2f2f 2f20 2020 2020 5768 656e 2073  ..///     When s
-0000f890: 7065 6369 6669 6564 2074 6865 2074 7261  pecified the tra
-0000f8a0: 7665 7273 616c 2077 696c 6c20 7374 6f70  versal will stop
-0000f8b0: 2077 6865 6e20 7468 6520 676f 616c 2069   when the goal i
-0000f8c0: 7320 7265 6163 6865 6420 616e 640a 2f2f  s reached and.//
-0000f8d0: 2f20 2020 2020 7468 6520 6f75 7470 7574  /     the output
-0000f8e0: 2064 6963 7469 6f6e 6172 7920 7769 6c6c   dictionary will
-0000f8f0: 206f 6e6c 7920 6861 7665 2061 2073 696e   only have a sin
-0000f900: 676c 6520 656e 7472 7920 7769 7468 2074  gle entry with t
-0000f910: 6865 206c 656e 6774 680a 2f2f 2f20 2020  he length.///   
-0000f920: 2020 6f66 2074 6865 2073 686f 7274 6573    of the shortes
-0000f930: 7420 7061 7468 2074 6f20 7468 6520 676f  t path to the go
-0000f940: 616c 206e 6f64 652e 0a2f 2f2f 0a2f 2f2f  al node..///.///
-0000f950: 203a 7265 7475 726e 733a 2041 2064 6963   :returns: A dic
-0000f960: 7469 6f6e 6172 7920 6f66 2074 6865 2073  tionary of the s
-0000f970: 686f 7274 6573 7420 7061 7468 7320 6672  hortest paths fr
-0000f980: 6f6d 2074 6865 2070 726f 7669 6465 6420  om the provided 
-0000f990: 6e6f 6465 2077 6865 7265 0a2f 2f2f 2020  node where.///  
-0000f9a0: 2020 2074 6865 206b 6579 2069 7320 7468     the key is th
-0000f9b0: 6520 6e6f 6465 2069 6e64 6578 206f 6620  e node index of 
-0000f9c0: 7468 6520 656e 6420 6f66 2074 6865 2070  the end of the p
-0000f9d0: 6174 6820 616e 6420 7468 6520 7661 6c75  ath and the valu
-0000f9e0: 6520 6973 2074 6865 0a2f 2f2f 2020 2020  e is the.///    
-0000f9f0: 2063 6f73 742f 7375 6d20 6f66 2074 6865   cost/sum of the
-0000fa00: 2077 6569 6768 7473 206f 6620 7061 7468   weights of path
-0000fa10: 0a2f 2f2f 203a 7274 7970 653a 2064 6963  ./// :rtype: dic
-0000fa20: 740a 235b 7079 6675 6e63 7469 6f6e 5d0a  t.#[pyfunction].
-0000fa30: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
-0000fa40: 203d 2022 2867 7261 7068 2c20 6e6f 6465   = "(graph, node
-0000fa50: 2c20 6564 6765 5f63 6f73 745f 666e 2c20  , edge_cost_fn, 
-0000fa60: 2f2c 2067 6f61 6c3d 4e6f 6e65 2922 5d0a  /, goal=None)"].
-0000fa70: 666e 2067 7261 7068 5f64 696a 6b73 7472  fn graph_dijkstr
-0000fa80: 615f 7368 6f72 7465 7374 5f70 6174 685f  a_shortest_path_
-0000fa90: 6c65 6e67 7468 7328 0a20 2020 2070 793a  lengths(.    py:
-0000faa0: 2050 7974 686f 6e2c 0a20 2020 2067 7261   Python,.    gra
-0000fab0: 7068 3a20 2667 7261 7068 3a3a 5079 4772  ph: &graph::PyGr
-0000fac0: 6170 682c 0a20 2020 206e 6f64 653a 2075  aph,.    node: u
-0000fad0: 7369 7a65 2c0a 2020 2020 6564 6765 5f63  size,.    edge_c
-0000fae0: 6f73 745f 666e 3a20 5079 4f62 6a65 6374  ost_fn: PyObject
-0000faf0: 2c0a 2020 2020 676f 616c 3a20 4f70 7469  ,.    goal: Opti
-0000fb00: 6f6e 3c75 7369 7a65 3e2c 0a29 202d 3e20  on<usize>,.) -> 
-0000fb10: 5079 5265 7375 6c74 3c50 794f 626a 6563  PyResult<PyObjec
-0000fb20: 743e 207b 0a20 2020 206c 6574 2065 6467  t> {.    let edg
-0000fb30: 655f 636f 7374 5f63 616c 6c61 626c 6520  e_cost_callable 
-0000fb40: 3d20 7c61 3a20 2650 794f 626a 6563 747c  = |a: &PyObject|
-0000fb50: 202d 3e20 5079 5265 7375 6c74 3c66 3634   -> PyResult<f64
-0000fb60: 3e20 7b0a 2020 2020 2020 2020 6c65 7420  > {.        let 
-0000fb70: 7265 7320 3d20 6564 6765 5f63 6f73 745f  res = edge_cost_
-0000fb80: 666e 2e63 616c 6c31 2870 792c 2028 612c  fn.call1(py, (a,
-0000fb90: 2929 3f3b 0a20 2020 2020 2020 206c 6574  ))?;.        let
-0000fba0: 2072 6177 203d 2072 6573 2e74 6f5f 6f62   raw = res.to_ob
-0000fbb0: 6a65 6374 2870 7929 3b0a 2020 2020 2020  ject(py);.      
-0000fbc0: 2020 7261 772e 6578 7472 6163 7428 7079    raw.extract(py
-0000fbd0: 290a 2020 2020 7d3b 0a0a 2020 2020 6c65  ).    };..    le
-0000fbe0: 7420 7374 6172 7420 3d20 4e6f 6465 496e  t start = NodeIn
-0000fbf0: 6465 783a 3a6e 6577 286e 6f64 6529 3b0a  dex::new(node);.
-0000fc00: 2020 2020 6c65 7420 676f 616c 5f69 6e64      let goal_ind
-0000fc10: 6578 3a20 4f70 7469 6f6e 3c4e 6f64 6549  ex: Option<NodeI
-0000fc20: 6e64 6578 3e20 3d20 6d61 7463 6820 676f  ndex> = match go
-0000fc30: 616c 207b 0a20 2020 2020 2020 2053 6f6d  al {.        Som
-0000fc40: 6528 6e6f 6465 2920 3d3e 2053 6f6d 6528  e(node) => Some(
-0000fc50: 4e6f 6465 496e 6465 783a 3a6e 6577 286e  NodeIndex::new(n
-0000fc60: 6f64 6529 292c 0a20 2020 2020 2020 204e  ode)),.        N
-0000fc70: 6f6e 6520 3d3e 204e 6f6e 652c 0a20 2020  one => None,.   
-0000fc80: 207d 3b0a 0a20 2020 206c 6574 2072 6573   };..    let res
-0000fc90: 203d 2064 696a 6b73 7472 613a 3a64 696a   = dijkstra::dij
-0000fca0: 6b73 7472 6128 0a20 2020 2020 2020 2067  kstra(.        g
-0000fcb0: 7261 7068 2c0a 2020 2020 2020 2020 7374  raph,.        st
-0000fcc0: 6172 742c 0a20 2020 2020 2020 2067 6f61  art,.        goa
-0000fcd0: 6c5f 696e 6465 782c 0a20 2020 2020 2020  l_index,.       
-0000fce0: 207c 657c 2065 6467 655f 636f 7374 5f63   |e| edge_cost_c
-0000fcf0: 616c 6c61 626c 6528 652e 7765 6967 6874  allable(e.weight
-0000fd00: 2829 292c 0a20 2020 2020 2020 204e 6f6e  ()),.        Non
-0000fd10: 652c 0a20 2020 2029 3f3b 0a20 2020 206c  e,.    )?;.    l
-0000fd20: 6574 206f 7574 5f64 6963 7420 3d20 5079  et out_dict = Py
-0000fd30: 4469 6374 3a3a 6e65 7728 7079 293b 0a20  Dict::new(py);. 
-0000fd40: 2020 2066 6f72 2028 696e 6465 782c 2076     for (index, v
-0000fd50: 616c 7565 2920 696e 2072 6573 207b 0a20  alue) in res {. 
-0000fd60: 2020 2020 2020 206c 6574 2069 6e74 5f69         let int_i
-0000fd70: 6e64 6578 203d 2069 6e64 6578 2e69 6e64  ndex = index.ind
-0000fd80: 6578 2829 3b0a 2020 2020 2020 2020 6966  ex();.        if
-0000fd90: 2069 6e74 5f69 6e64 6578 203d 3d20 6e6f   int_index == no
-0000fda0: 6465 207b 0a20 2020 2020 2020 2020 2020  de {.           
-0000fdb0: 2063 6f6e 7469 6e75 653b 0a20 2020 2020   continue;.     
-0000fdc0: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
-0000fdd0: 2867 6f61 6c2e 6973 5f73 6f6d 6528 2920  (goal.is_some() 
-0000fde0: 2626 2067 6f61 6c2e 756e 7772 6170 2829  && goal.unwrap()
-0000fdf0: 203d 3d20 696e 745f 696e 6465 7829 207c   == int_index) |
-0000fe00: 7c20 676f 616c 2e69 735f 6e6f 6e65 2829  | goal.is_none()
-0000fe10: 207b 0a20 2020 2020 2020 2020 2020 206f   {.            o
-0000fe20: 7574 5f64 6963 742e 7365 745f 6974 656d  ut_dict.set_item
-0000fe30: 2869 6e74 5f69 6e64 6578 2c20 7661 6c75  (int_index, valu
-0000fe40: 6529 3f3b 0a20 2020 2020 2020 207d 0a20  e)?;.        }. 
-0000fe50: 2020 207d 0a20 2020 204f 6b28 6f75 745f     }.    Ok(out_
-0000fe60: 6469 6374 2e69 6e74 6f28 2929 0a7d 0a0a  dict.into()).}..
-0000fe70: 2f2f 2f20 436f 6d70 7574 6520 7468 6520  /// Compute the 
-0000fe80: 6c65 6e67 7468 7320 6f66 2074 6865 2073  lengths of the s
-0000fe90: 686f 7274 6573 7420 7061 7468 7320 666f  hortest paths fo
-0000fea0: 7220 6120 5079 4469 4772 6170 6820 6f62  r a PyDiGraph ob
-0000feb0: 6a65 6374 2075 7369 6e67 0a2f 2f2f 2044  ject using./// D
-0000fec0: 696a 6b73 7472 6127 7320 616c 676f 7269  ijkstra's algori
-0000fed0: 7468 6d0a 2f2f 2f0a 2f2f 2f20 3a70 6172  thm.///./// :par
-0000fee0: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
-0000fef0: 7068 3a20 5468 6520 696e 7075 7420 6772  ph: The input gr
-0000ff00: 6170 6820 746f 2075 7365 0a2f 2f2f 203a  aph to use./// :
-0000ff10: 7061 7261 6d20 696e 7420 6e6f 6465 3a20  param int node: 
-0000ff20: 5468 6520 6e6f 6465 2069 6e64 6578 2074  The node index t
-0000ff30: 6f20 7573 6520 6173 2074 6865 2073 6f75  o use as the sou
-0000ff40: 7263 6520 666f 7220 6669 6e64 696e 6720  rce for finding 
-0000ff50: 7468 650a 2f2f 2f20 2020 2020 7368 6f72  the.///     shor
-0000ff60: 7465 7374 2070 6174 6873 2066 726f 6d0a  test paths from.
-0000ff70: 2f2f 2f20 3a70 6172 616d 2065 6467 655f  /// :param edge_
-0000ff80: 636f 7374 5f66 6e3a 2041 2070 7974 686f  cost_fn: A pytho
-0000ff90: 6e20 6361 6c6c 6162 6c65 2074 6861 7420  n callable that 
-0000ffa0: 7769 6c6c 2074 616b 6520 696e 2031 2070  will take in 1 p
-0000ffb0: 6172 616d 6574 6572 2c20 616e 0a2f 2f2f  arameter, an.///
-0000ffc0: 2020 2020 2065 6467 6527 7320 6461 7461       edge's data
-0000ffd0: 206f 626a 6563 7420 616e 6420 7769 6c6c   object and will
-0000ffe0: 2072 6574 7572 6e20 6120 666c 6f61 7420   return a float 
-0000fff0: 7468 6174 2072 6570 7265 7365 6e74 7320  that represents 
-00010000: 7468 650a 2f2f 2f20 2020 2020 636f 7374  the.///     cost
-00010010: 2f77 6569 6768 7420 6f66 2074 6861 7420  /weight of that 
-00010020: 6564 6765 2e20 4974 206d 7573 7420 6265  edge. It must be
-00010030: 206e 6f6e 2d6e 6567 6174 6976 650a 2f2f   non-negative.//
-00010040: 2f20 3a70 6172 616d 2069 6e74 2067 6f61  / :param int goa
-00010050: 6c3a 2041 6e20 6f70 7469 6f6e 616c 206e  l: An optional n
-00010060: 6f64 6520 696e 6465 7820 746f 2075 7365  ode index to use
-00010070: 2061 7320 7468 6520 656e 6420 6f66 2074   as the end of t
-00010080: 6865 2070 6174 682e 0a2f 2f2f 2020 2020  he path..///    
-00010090: 2057 6865 6e20 7370 6563 6966 6965 6420   When specified 
-000100a0: 7468 6520 7472 6176 6572 7361 6c20 7769  the traversal wi
-000100b0: 6c6c 2073 746f 7020 7768 656e 2074 6865  ll stop when the
-000100c0: 2067 6f61 6c20 6973 2072 6561 6368 6564   goal is reached
-000100d0: 2061 6e64 0a2f 2f2f 2020 2020 2074 6865   and.///     the
-000100e0: 206f 7574 7075 7420 6469 6374 696f 6e61   output dictiona
-000100f0: 7279 2077 696c 6c20 6f6e 6c79 2068 6176  ry will only hav
-00010100: 6520 6120 7369 6e67 6c65 2065 6e74 7279  e a single entry
-00010110: 2077 6974 6820 7468 6520 6c65 6e67 7468   with the length
-00010120: 0a2f 2f2f 2020 2020 206f 6620 7468 6520  .///     of the 
-00010130: 7368 6f72 7465 7374 2070 6174 6820 746f  shortest path to
-00010140: 2074 6865 2067 6f61 6c20 6e6f 6465 2e0a   the goal node..
-00010150: 2f2f 2f0a 2f2f 2f20 3a72 6574 7572 6e73  ///./// :returns
-00010160: 3a20 4120 6469 6374 696f 6e61 7279 206f  : A dictionary o
-00010170: 6620 7468 6520 7368 6f72 7465 7374 2070  f the shortest p
-00010180: 6174 6873 2066 726f 6d20 7468 6520 7072  aths from the pr
-00010190: 6f76 6964 6564 206e 6f64 6520 7768 6572  ovided node wher
-000101a0: 650a 2f2f 2f20 2020 2020 7468 6520 6b65  e.///     the ke
-000101b0: 7920 6973 2074 6865 206e 6f64 6520 696e  y is the node in
-000101c0: 6465 7820 6f66 2074 6865 2065 6e64 206f  dex of the end o
-000101d0: 6620 7468 6520 7061 7468 2061 6e64 2074  f the path and t
-000101e0: 6865 2076 616c 7565 2069 7320 7468 650a  he value is the.
-000101f0: 2f2f 2f20 2020 2020 636f 7374 2f73 756d  ///     cost/sum
-00010200: 206f 6620 7468 6520 7765 6967 6874 7320   of the weights 
-00010210: 6f66 2070 6174 680a 2f2f 2f20 3a72 7479  of path./// :rty
-00010220: 7065 3a20 6469 6374 0a23 5b70 7966 756e  pe: dict.#[pyfun
-00010230: 6374 696f 6e5d 0a23 5b74 6578 745f 7369  ction].#[text_si
-00010240: 676e 6174 7572 6520 3d20 2228 6772 6170  gnature = "(grap
-00010250: 682c 206e 6f64 652c 2065 6467 655f 636f  h, node, edge_co
-00010260: 7374 5f66 6e2c 202f 2c20 676f 616c 3d4e  st_fn, /, goal=N
-00010270: 6f6e 6529 225d 0a66 6e20 6469 6772 6170  one)"].fn digrap
-00010280: 685f 6469 6a6b 7374 7261 5f73 686f 7274  h_dijkstra_short
-00010290: 6573 745f 7061 7468 5f6c 656e 6774 6873  est_path_lengths
-000102a0: 280a 2020 2020 7079 3a20 5079 7468 6f6e  (.    py: Python
-000102b0: 2c0a 2020 2020 6772 6170 683a 2026 6469  ,.    graph: &di
-000102c0: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
-000102d0: 2c0a 2020 2020 6e6f 6465 3a20 7573 697a  ,.    node: usiz
-000102e0: 652c 0a20 2020 2065 6467 655f 636f 7374  e,.    edge_cost
-000102f0: 5f66 6e3a 2050 794f 626a 6563 742c 0a20  _fn: PyObject,. 
-00010300: 2020 2067 6f61 6c3a 204f 7074 696f 6e3c     goal: Option<
-00010310: 7573 697a 653e 2c0a 2920 2d3e 2050 7952  usize>,.) -> PyR
-00010320: 6573 756c 743c 5079 4f62 6a65 6374 3e20  esult<PyObject> 
-00010330: 7b0a 2020 2020 6c65 7420 6564 6765 5f63  {.    let edge_c
-00010340: 6f73 745f 6361 6c6c 6162 6c65 203d 207c  ost_callable = |
-00010350: 613a 2026 5079 4f62 6a65 6374 7c20 2d3e  a: &PyObject| ->
-00010360: 2050 7952 6573 756c 743c 6636 343e 207b   PyResult<f64> {
-00010370: 0a20 2020 2020 2020 206c 6574 2072 6573  .        let res
-00010380: 203d 2065 6467 655f 636f 7374 5f66 6e2e   = edge_cost_fn.
-00010390: 6361 6c6c 3128 7079 2c20 2861 2c29 293f  call1(py, (a,))?
-000103a0: 3b0a 2020 2020 2020 2020 6c65 7420 7261  ;.        let ra
-000103b0: 7720 3d20 7265 732e 746f 5f6f 626a 6563  w = res.to_objec
-000103c0: 7428 7079 293b 0a20 2020 2020 2020 2072  t(py);.        r
-000103d0: 6177 2e65 7874 7261 6374 2870 7929 0a20  aw.extract(py). 
-000103e0: 2020 207d 3b0a 0a20 2020 206c 6574 2073     };..    let s
-000103f0: 7461 7274 203d 204e 6f64 6549 6e64 6578  tart = NodeIndex
-00010400: 3a3a 6e65 7728 6e6f 6465 293b 0a20 2020  ::new(node);.   
-00010410: 206c 6574 2067 6f61 6c5f 696e 6465 783a   let goal_index:
-00010420: 204f 7074 696f 6e3c 4e6f 6465 496e 6465   Option<NodeInde
-00010430: 783e 203d 206d 6174 6368 2067 6f61 6c20  x> = match goal 
-00010440: 7b0a 2020 2020 2020 2020 536f 6d65 286e  {.        Some(n
-00010450: 6f64 6529 203d 3e20 536f 6d65 284e 6f64  ode) => Some(Nod
-00010460: 6549 6e64 6578 3a3a 6e65 7728 6e6f 6465  eIndex::new(node
-00010470: 2929 2c0a 2020 2020 2020 2020 4e6f 6e65  )),.        None
-00010480: 203d 3e20 4e6f 6e65 2c0a 2020 2020 7d3b   => None,.    };
-00010490: 0a0a 2020 2020 6c65 7420 7265 7320 3d20  ..    let res = 
-000104a0: 6469 6a6b 7374 7261 3a3a 6469 6a6b 7374  dijkstra::dijkst
-000104b0: 7261 280a 2020 2020 2020 2020 6772 6170  ra(.        grap
-000104c0: 682c 0a20 2020 2020 2020 2073 7461 7274  h,.        start
-000104d0: 2c0a 2020 2020 2020 2020 676f 616c 5f69  ,.        goal_i
-000104e0: 6e64 6578 2c0a 2020 2020 2020 2020 7c65  ndex,.        |e
-000104f0: 7c20 6564 6765 5f63 6f73 745f 6361 6c6c  | edge_cost_call
-00010500: 6162 6c65 2865 2e77 6569 6768 7428 2929  able(e.weight())
-00010510: 2c0a 2020 2020 2020 2020 4e6f 6e65 2c0a  ,.        None,.
-00010520: 2020 2020 293f 3b0a 2020 2020 6c65 7420      )?;.    let 
-00010530: 6f75 745f 6469 6374 203d 2050 7944 6963  out_dict = PyDic
-00010540: 743a 3a6e 6577 2870 7929 3b0a 2020 2020  t::new(py);.    
-00010550: 666f 7220 2869 6e64 6578 2c20 7661 6c75  for (index, valu
-00010560: 6529 2069 6e20 7265 7320 7b0a 2020 2020  e) in res {.    
-00010570: 2020 2020 6c65 7420 696e 745f 696e 6465      let int_inde
-00010580: 7820 3d20 696e 6465 782e 696e 6465 7828  x = index.index(
-00010590: 293b 0a20 2020 2020 2020 2069 6620 696e  );.        if in
-000105a0: 745f 696e 6465 7820 3d3d 206e 6f64 6520  t_index == node 
-000105b0: 7b0a 2020 2020 2020 2020 2020 2020 636f  {.            co
-000105c0: 6e74 696e 7565 3b0a 2020 2020 2020 2020  ntinue;.        
-000105d0: 7d0a 2020 2020 2020 2020 6966 2028 676f  }.        if (go
-000105e0: 616c 2e69 735f 736f 6d65 2829 2026 2620  al.is_some() && 
-000105f0: 676f 616c 2e75 6e77 7261 7028 2920 3d3d  goal.unwrap() ==
-00010600: 2069 6e74 5f69 6e64 6578 2920 7c7c 2067   int_index) || g
-00010610: 6f61 6c2e 6973 5f6e 6f6e 6528 2920 7b0a  oal.is_none() {.
-00010620: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-00010630: 6469 6374 2e73 6574 5f69 7465 6d28 696e  dict.set_item(in
-00010640: 745f 696e 6465 782c 2076 616c 7565 293f  t_index, value)?
-00010650: 3b0a 2020 2020 2020 2020 7d0a 2020 2020  ;.        }.    
-00010660: 7d0a 2020 2020 4f6b 286f 7574 5f64 6963  }.    Ok(out_dic
-00010670: 742e 696e 746f 2829 290a 7d0a 0a2f 2f2f  t.into()).}..///
-00010680: 2043 6f6d 7075 7465 2074 6865 2041 2a20   Compute the A* 
-00010690: 7368 6f72 7465 7374 2070 6174 6820 666f  shortest path fo
-000106a0: 7220 6120 5079 4772 6170 680a 2f2f 2f0a  r a PyGraph.///.
-000106b0: 2f2f 2f20 3a70 6172 616d 2050 7947 7261  /// :param PyGra
-000106c0: 7068 2067 7261 7068 3a20 5468 6520 696e  ph graph: The in
-000106d0: 7075 7420 6772 6170 6820 746f 2075 7365  put graph to use
-000106e0: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
-000106f0: 6e6f 6465 3a20 5468 6520 6e6f 6465 2069  node: The node i
-00010700: 6e64 6578 2074 6f20 636f 6d70 7574 6520  ndex to compute 
-00010710: 7468 6520 7061 7468 2066 726f 6d0a 2f2f  the path from.//
-00010720: 2f20 3a70 6172 616d 2067 6f61 6c5f 666e  / :param goal_fn
-00010730: 3a20 4120 7079 7468 6f6e 2063 616c 6c61  : A python calla
-00010740: 626c 6520 7468 6174 2077 696c 6c20 7461  ble that will ta
-00010750: 6b65 2069 6e20 3120 7061 7261 6d65 7465  ke in 1 paramete
-00010760: 722c 2061 206e 6f64 6527 7320 6461 7461  r, a node's data
-00010770: 0a2f 2f2f 2020 2020 206f 626a 6563 7420  .///     object 
-00010780: 616e 6420 7769 6c6c 2072 6574 7572 6e20  and will return 
-00010790: 6120 626f 6f6c 6561 6e20 7768 6963 6820  a boolean which 
-000107a0: 7769 6c6c 2062 6520 5472 7565 2069 6620  will be True if 
-000107b0: 6974 2069 7320 7468 6520 6669 6e69 7368  it is the finish
-000107c0: 0a2f 2f2f 2020 2020 206e 6f64 652e 0a2f  .///     node../
-000107d0: 2f2f 203a 7061 7261 6d20 6564 6765 5f63  // :param edge_c
-000107e0: 6f73 745f 666e 3a20 4120 7079 7468 6f6e  ost_fn: A python
-000107f0: 2063 616c 6c61 626c 6520 7468 6174 2077   callable that w
-00010800: 696c 6c20 7461 6b65 2069 6e20 3120 7061  ill take in 1 pa
-00010810: 7261 6d65 7465 722c 2061 6e20 6564 6765  rameter, an edge
-00010820: 2773 0a2f 2f2f 2020 2020 2064 6174 6120  's.///     data 
-00010830: 6f62 6a65 6374 2061 6e64 2077 696c 6c20  object and will 
-00010840: 7265 7475 726e 2061 2066 6c6f 6174 2074  return a float t
-00010850: 6861 7420 7265 7072 6573 656e 7473 2074  hat represents t
-00010860: 6865 2063 6f73 7420 6f66 2074 6861 740a  he cost of that.
-00010870: 2f2f 2f20 2020 2020 6564 6765 2e20 4974  ///     edge. It
-00010880: 206d 7573 7420 6265 206e 6f6e 2d6e 6567   must be non-neg
-00010890: 6174 6976 652e 0a2f 2f2f 203a 7061 7261  ative../// :para
-000108a0: 6d20 6573 7469 6d61 7465 5f63 6f73 745f  m estimate_cost_
-000108b0: 666e 3a20 4120 7079 7468 6f6e 2063 616c  fn: A python cal
-000108c0: 6c61 626c 6520 7468 6174 2077 696c 6c20  lable that will 
-000108d0: 7461 6b65 2069 6e20 3120 7061 7261 6d65  take in 1 parame
-000108e0: 7465 722c 2061 0a2f 2f2f 2020 2020 206e  ter, a.///     n
-000108f0: 6f64 6527 7320 6461 7461 206f 626a 6563  ode's data objec
-00010900: 7420 616e 6420 7769 6c6c 2072 6574 7572  t and will retur
-00010910: 6e20 6120 666c 6f61 7420 7768 6963 6820  n a float which 
-00010920: 7265 7072 6573 656e 7473 2074 6865 2065  represents the e
-00010930: 7374 696d 6174 6564 0a2f 2f2f 2020 2020  stimated.///    
-00010940: 2063 6f73 7420 666f 7220 7468 6520 6e65   cost for the ne
-00010950: 7874 206e 6f64 652e 2054 6865 2072 6574  xt node. The ret
-00010960: 7572 6e20 6d75 7374 2062 6520 6e6f 6e2d  urn must be non-
-00010970: 6e65 6761 7469 7665 2e20 466f 7220 7468  negative. For th
-00010980: 650a 2f2f 2f20 2020 2020 616c 676f 7269  e.///     algori
-00010990: 7468 6d20 746f 2066 696e 6420 7468 6520  thm to find the 
-000109a0: 6163 7475 616c 2073 686f 7274 6573 7420  actual shortest 
-000109b0: 7061 7468 2c20 6974 2073 686f 756c 6420  path, it should 
-000109c0: 6265 2061 646d 6973 7369 626c 652c 0a2f  be admissible,./
-000109d0: 2f2f 2020 2020 206d 6561 6e69 6e67 2074  //     meaning t
-000109e0: 6861 7420 6974 2073 686f 756c 6420 6e65  hat it should ne
-000109f0: 7665 7220 6f76 6572 6573 7469 6d61 7465  ver overestimate
-00010a00: 2074 6865 2061 6374 7561 6c20 636f 7374   the actual cost
-00010a10: 2074 6f20 6765 7420 746f 2074 6865 0a2f   to get to the./
-00010a20: 2f2f 2020 2020 206e 6561 7265 7374 2067  //     nearest g
-00010a30: 6f61 6c20 6e6f 6465 2e0a 2f2f 2f0a 2f2f  oal node..///.//
-00010a40: 2f20 3a72 6574 7572 6e73 3a20 5468 6520  / :returns: The 
-00010a50: 636f 6d70 7574 6564 2073 686f 7274 6573  computed shortes
-00010a60: 7420 7061 7468 2062 6574 7765 656e 206e  t path between n
-00010a70: 6f64 6520 616e 6420 6669 6e69 7368 2061  ode and finish a
-00010a80: 7320 6120 6c69 7374 0a2f 2f2f 2020 2020  s a list.///    
-00010a90: 206f 6620 6e6f 6465 2069 6e64 6963 6573   of node indices
-00010aa0: 2e0a 2f2f 2f20 3a72 7479 7065 3a20 4e6f  ../// :rtype: No
-00010ab0: 6465 496e 6469 6365 730a 235b 7079 6675  deIndices.#[pyfu
-00010ac0: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
-00010ad0: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
-00010ae0: 7068 2c20 6e6f 6465 2c20 676f 616c 5f66  ph, node, goal_f
-00010af0: 6e2c 2065 6467 655f 636f 7374 2c20 6573  n, edge_cost, es
-00010b00: 7469 6d61 7465 5f63 6f73 742c 202f 2922  timate_cost, /)"
-00010b10: 5d0a 666e 2067 7261 7068 5f61 7374 6172  ].fn graph_astar
-00010b20: 5f73 686f 7274 6573 745f 7061 7468 280a  _shortest_path(.
-00010b30: 2020 2020 7079 3a20 5079 7468 6f6e 2c0a      py: Python,.
-00010b40: 2020 2020 6772 6170 683a 2026 6772 6170      graph: &grap
-00010b50: 683a 3a50 7947 7261 7068 2c0a 2020 2020  h::PyGraph,.    
-00010b60: 6e6f 6465 3a20 7573 697a 652c 0a20 2020  node: usize,.   
-00010b70: 2067 6f61 6c5f 666e 3a20 5079 4f62 6a65   goal_fn: PyObje
-00010b80: 6374 2c0a 2020 2020 6564 6765 5f63 6f73  ct,.    edge_cos
-00010b90: 745f 666e 3a20 5079 4f62 6a65 6374 2c0a  t_fn: PyObject,.
-00010ba0: 2020 2020 6573 7469 6d61 7465 5f63 6f73      estimate_cos
-00010bb0: 745f 666e 3a20 5079 4f62 6a65 6374 2c0a  t_fn: PyObject,.
-00010bc0: 2920 2d3e 2050 7952 6573 756c 743c 4e6f  ) -> PyResult<No
-00010bd0: 6465 496e 6469 6365 733e 207b 0a20 2020  deIndices> {.   
-00010be0: 206c 6574 2067 6f61 6c5f 666e 5f63 616c   let goal_fn_cal
-00010bf0: 6c61 626c 6520 3d20 7c61 3a20 2650 794f  lable = |a: &PyO
-00010c00: 626a 6563 747c 202d 3e20 5079 5265 7375  bject| -> PyResu
-00010c10: 6c74 3c62 6f6f 6c3e 207b 0a20 2020 2020  lt<bool> {.     
-00010c20: 2020 206c 6574 2072 6573 203d 2067 6f61     let res = goa
-00010c30: 6c5f 666e 2e63 616c 6c31 2870 792c 2028  l_fn.call1(py, (
-00010c40: 612c 2929 3f3b 0a20 2020 2020 2020 206c  a,))?;.        l
-00010c50: 6574 2072 6177 203d 2072 6573 2e74 6f5f  et raw = res.to_
-00010c60: 6f62 6a65 6374 2870 7929 3b0a 2020 2020  object(py);.    
-00010c70: 2020 2020 6c65 7420 6f75 7470 7574 3a20      let output: 
-00010c80: 626f 6f6c 203d 2072 6177 2e65 7874 7261  bool = raw.extra
-00010c90: 6374 2870 7929 3f3b 0a20 2020 2020 2020  ct(py)?;.       
-00010ca0: 204f 6b28 6f75 7470 7574 290a 2020 2020   Ok(output).    
-00010cb0: 7d3b 0a0a 2020 2020 6c65 7420 6564 6765  };..    let edge
-00010cc0: 5f63 6f73 745f 6361 6c6c 6162 6c65 203d  _cost_callable =
-00010cd0: 207c 613a 2026 5079 4f62 6a65 6374 7c20   |a: &PyObject| 
-00010ce0: 2d3e 2050 7952 6573 756c 743c 6636 343e  -> PyResult<f64>
-00010cf0: 207b 0a20 2020 2020 2020 206c 6574 2072   {.        let r
-00010d00: 6573 203d 2065 6467 655f 636f 7374 5f66  es = edge_cost_f
-00010d10: 6e2e 6361 6c6c 3128 7079 2c20 2861 2c29  n.call1(py, (a,)
-00010d20: 293f 3b0a 2020 2020 2020 2020 6c65 7420  )?;.        let 
-00010d30: 7261 7720 3d20 7265 732e 746f 5f6f 626a  raw = res.to_obj
-00010d40: 6563 7428 7079 293b 0a20 2020 2020 2020  ect(py);.       
-00010d50: 206c 6574 206f 7574 7075 743a 2066 3634   let output: f64
-00010d60: 203d 2072 6177 2e65 7874 7261 6374 2870   = raw.extract(p
-00010d70: 7929 3f3b 0a20 2020 2020 2020 204f 6b28  y)?;.        Ok(
-00010d80: 6f75 7470 7574 290a 2020 2020 7d3b 0a0a  output).    };..
-00010d90: 2020 2020 6c65 7420 6573 7469 6d61 7465      let estimate
-00010da0: 5f63 6f73 745f 6361 6c6c 6162 6c65 203d  _cost_callable =
-00010db0: 207c 613a 2026 5079 4f62 6a65 6374 7c20   |a: &PyObject| 
-00010dc0: 2d3e 2050 7952 6573 756c 743c 6636 343e  -> PyResult<f64>
-00010dd0: 207b 0a20 2020 2020 2020 206c 6574 2072   {.        let r
-00010de0: 6573 203d 2065 7374 696d 6174 655f 636f  es = estimate_co
-00010df0: 7374 5f66 6e2e 6361 6c6c 3128 7079 2c20  st_fn.call1(py, 
-00010e00: 2861 2c29 293f 3b0a 2020 2020 2020 2020  (a,))?;.        
-00010e10: 6c65 7420 7261 7720 3d20 7265 732e 746f  let raw = res.to
-00010e20: 5f6f 626a 6563 7428 7079 293b 0a20 2020  _object(py);.   
-00010e30: 2020 2020 206c 6574 206f 7574 7075 743a       let output:
-00010e40: 2066 3634 203d 2072 6177 2e65 7874 7261   f64 = raw.extra
-00010e50: 6374 2870 7929 3f3b 0a20 2020 2020 2020  ct(py)?;.       
-00010e60: 204f 6b28 6f75 7470 7574 290a 2020 2020   Ok(output).    
-00010e70: 7d3b 0a20 2020 206c 6574 2073 7461 7274  };.    let start
-00010e80: 203d 204e 6f64 6549 6e64 6578 3a3a 6e65   = NodeIndex::ne
-00010e90: 7728 6e6f 6465 293b 0a0a 2020 2020 6c65  w(node);..    le
-00010ea0: 7420 6173 7461 725f 7265 7320 3d20 6173  t astar_res = as
-00010eb0: 7461 723a 3a61 7374 6172 280a 2020 2020  tar::astar(.    
-00010ec0: 2020 2020 6772 6170 682c 0a20 2020 2020      graph,.     
-00010ed0: 2020 2073 7461 7274 2c0a 2020 2020 2020     start,.      
-00010ee0: 2020 7c66 7c20 676f 616c 5f66 6e5f 6361    |f| goal_fn_ca
-00010ef0: 6c6c 6162 6c65 2867 7261 7068 2e67 7261  llable(graph.gra
-00010f00: 7068 2e6e 6f64 655f 7765 6967 6874 2866  ph.node_weight(f
-00010f10: 292e 756e 7772 6170 2829 292c 0a20 2020  ).unwrap()),.   
-00010f20: 2020 2020 207c 657c 2065 6467 655f 636f       |e| edge_co
-00010f30: 7374 5f63 616c 6c61 626c 6528 652e 7765  st_callable(e.we
-00010f40: 6967 6874 2829 292c 0a20 2020 2020 2020  ight()),.       
-00010f50: 207c 6573 7469 6d61 7465 7c20 7b0a 2020   |estimate| {.  
-00010f60: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00010f70: 7465 5f63 6f73 745f 6361 6c6c 6162 6c65  te_cost_callable
-00010f80: 2867 7261 7068 2e67 7261 7068 2e6e 6f64  (graph.graph.nod
-00010f90: 655f 7765 6967 6874 2865 7374 696d 6174  e_weight(estimat
-00010fa0: 6529 2e75 6e77 7261 7028 2929 0a20 2020  e).unwrap()).   
-00010fb0: 2020 2020 207d 2c0a 2020 2020 293f 3b0a       },.    )?;.
-00010fc0: 2020 2020 6c65 7420 7061 7468 203d 206d      let path = m
-00010fd0: 6174 6368 2061 7374 6172 5f72 6573 207b  atch astar_res {
-00010fe0: 0a20 2020 2020 2020 2053 6f6d 6528 7061  .        Some(pa
-00010ff0: 7468 2920 3d3e 2070 6174 682c 0a20 2020  th) => path,.   
-00011000: 2020 2020 204e 6f6e 6520 3d3e 207b 0a20       None => {. 
-00011010: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00011020: 6e20 4572 7228 4e6f 5061 7468 466f 756e  n Err(NoPathFoun
-00011030: 643a 3a6e 6577 5f65 7272 280a 2020 2020  d::new_err(.    
-00011040: 2020 2020 2020 2020 2020 2020 224e 6f20              "No 
-00011050: 7061 7468 2066 6f75 6e64 2074 6861 7420  path found that 
-00011060: 7361 7469 7366 6965 7320 676f 616c 5f66  satisfies goal_f
-00011070: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
-00011080: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
-00011090: 207d 3b0a 2020 2020 4f6b 284e 6f64 6549   };.    Ok(NodeI
-000110a0: 6e64 6963 6573 207b 0a20 2020 2020 2020  ndices {.       
-000110b0: 206e 6f64 6573 3a20 7061 7468 2e31 2e69   nodes: path.1.i
-000110c0: 6e74 6f5f 6974 6572 2829 2e6d 6170 287c  nto_iter().map(|
-000110d0: 787c 2078 2e69 6e64 6578 2829 292e 636f  x| x.index()).co
-000110e0: 6c6c 6563 7428 292c 0a20 2020 207d 290a  llect(),.    }).
-000110f0: 7d0a 0a2f 2f2f 2043 6f6d 7075 7465 2074  }../// Compute t
-00011100: 6865 2041 2a20 7368 6f72 7465 7374 2070  he A* shortest p
-00011110: 6174 6820 666f 7220 6120 5079 4469 4772  ath for a PyDiGr
-00011120: 6170 680a 2f2f 2f0a 2f2f 2f20 3a70 6172  aph.///./// :par
-00011130: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
-00011140: 7068 3a20 5468 6520 696e 7075 7420 6772  ph: The input gr
-00011150: 6170 6820 746f 2075 7365 0a2f 2f2f 203a  aph to use./// :
-00011160: 7061 7261 6d20 696e 7420 6e6f 6465 3a20  param int node: 
-00011170: 5468 6520 6e6f 6465 2069 6e64 6578 2074  The node index t
-00011180: 6f20 636f 6d70 7574 6520 7468 6520 7061  o compute the pa
-00011190: 7468 2066 726f 6d0a 2f2f 2f20 3a70 6172  th from./// :par
-000111a0: 616d 2067 6f61 6c5f 666e 3a20 4120 7079  am goal_fn: A py
-000111b0: 7468 6f6e 2063 616c 6c61 626c 6520 7468  thon callable th
-000111c0: 6174 2077 696c 6c20 7461 6b65 2069 6e20  at will take in 
-000111d0: 3120 7061 7261 6d65 7465 722c 2061 206e  1 parameter, a n
-000111e0: 6f64 6527 730a 2f2f 2f20 2020 2020 6461  ode's.///     da
-000111f0: 7461 206f 626a 6563 7420 616e 6420 7769  ta object and wi
-00011200: 6c6c 2072 6574 7572 6e20 6120 626f 6f6c  ll return a bool
-00011210: 6561 6e20 7768 6963 6820 7769 6c6c 2062  ean which will b
-00011220: 6520 5472 7565 2069 6620 6974 2069 7320  e True if it is 
-00011230: 7468 650a 2f2f 2f20 2020 2020 6669 6e69  the.///     fini
-00011240: 7368 206e 6f64 652e 0a2f 2f2f 203a 7061  sh node../// :pa
-00011250: 7261 6d20 6564 6765 5f63 6f73 745f 666e  ram edge_cost_fn
-00011260: 3a20 4120 7079 7468 6f6e 2063 616c 6c61  : A python calla
-00011270: 626c 6520 7468 6174 2077 696c 6c20 7461  ble that will ta
-00011280: 6b65 2069 6e20 3120 7061 7261 6d65 7465  ke in 1 paramete
-00011290: 722c 2061 6e0a 2f2f 2f20 2020 2020 6564  r, an.///     ed
-000112a0: 6765 2773 2064 6174 6120 6f62 6a65 6374  ge's data object
-000112b0: 2061 6e64 2077 696c 6c20 7265 7475 726e   and will return
-000112c0: 2061 2066 6c6f 6174 2074 6861 7420 7265   a float that re
-000112d0: 7072 6573 656e 7473 2074 6865 2063 6f73  presents the cos
-000112e0: 7420 6f66 0a2f 2f2f 2020 2020 2074 6861  t of.///     tha
-000112f0: 7420 6564 6765 2e20 4974 206d 7573 7420  t edge. It must 
-00011300: 6265 206e 6f6e 2d6e 6567 6174 6976 652e  be non-negative.
-00011310: 0a2f 2f2f 203a 7061 7261 6d20 6573 7469  ./// :param esti
-00011320: 6d61 7465 5f63 6f73 745f 666e 3a20 4120  mate_cost_fn: A 
-00011330: 7079 7468 6f6e 2063 616c 6c61 626c 6520  python callable 
-00011340: 7468 6174 2077 696c 6c20 7461 6b65 2069  that will take i
-00011350: 6e20 3120 7061 7261 6d65 7465 722c 2061  n 1 parameter, a
-00011360: 0a2f 2f2f 2020 2020 206e 6f64 6527 7320  .///     node's 
-00011370: 6461 7461 206f 626a 6563 7420 616e 6420  data object and 
-00011380: 7769 6c6c 2072 6574 7572 6e20 6120 666c  will return a fl
-00011390: 6f61 7420 7768 6963 6820 7265 7072 6573  oat which repres
-000113a0: 656e 7473 2074 6865 0a2f 2f2f 2020 2020  ents the.///    
-000113b0: 2065 7374 696d 6174 6564 2063 6f73 7420   estimated cost 
-000113c0: 666f 7220 7468 6520 6e65 7874 206e 6f64  for the next nod
-000113d0: 652e 2054 6865 2072 6574 7572 6e20 6d75  e. The return mu
-000113e0: 7374 2062 6520 6e6f 6e2d 6e65 6761 7469  st be non-negati
-000113f0: 7665 2e20 466f 720a 2f2f 2f20 2020 2020  ve. For.///     
-00011400: 7468 6520 616c 676f 7269 7468 6d20 746f  the algorithm to
-00011410: 2066 696e 6420 7468 6520 6163 7475 616c   find the actual
-00011420: 2073 686f 7274 6573 7420 7061 7468 2c20   shortest path, 
-00011430: 6974 2073 686f 756c 6420 6265 0a2f 2f2f  it should be.///
-00011440: 2020 2020 2061 646d 6973 7369 626c 652c       admissible,
-00011450: 206d 6561 6e69 6e67 2074 6861 7420 6974   meaning that it
-00011460: 2073 686f 756c 6420 6e65 7665 7220 6f76   should never ov
-00011470: 6572 6573 7469 6d61 7465 2074 6865 2061  erestimate the a
-00011480: 6374 7561 6c20 636f 7374 0a2f 2f2f 2020  ctual cost.///  
-00011490: 2020 2074 6f20 6765 7420 746f 2074 6865     to get to the
-000114a0: 206e 6561 7265 7374 2067 6f61 6c20 6e6f   nearest goal no
-000114b0: 6465 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  de..///./// :ret
-000114c0: 7572 6e3a 2054 6865 2063 6f6d 7075 7465  urn: The compute
-000114d0: 6420 7368 6f72 7465 7374 2070 6174 6820  d shortest path 
-000114e0: 6265 7477 6565 6e20 6e6f 6465 2061 6e64  between node and
-000114f0: 2066 696e 6973 6820 6173 2061 206c 6973   finish as a lis
-00011500: 740a 2f2f 2f20 2020 2020 6f66 206e 6f64  t.///     of nod
-00011510: 6520 696e 6469 6365 732e 0a2f 2f2f 203a  e indices../// :
-00011520: 7274 7970 653a 204e 6f64 6549 6e64 6963  rtype: NodeIndic
-00011530: 6573 0a23 5b70 7966 756e 6374 696f 6e5d  es.#[pyfunction]
-00011540: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
-00011550: 6520 3d20 2228 6772 6170 682c 206e 6f64  e = "(graph, nod
-00011560: 652c 2067 6f61 6c5f 666e 2c20 6564 6765  e, goal_fn, edge
-00011570: 5f63 6f73 742c 2065 7374 696d 6174 655f  _cost, estimate_
-00011580: 636f 7374 2c20 2f29 225d 0a66 6e20 6469  cost, /)"].fn di
-00011590: 6772 6170 685f 6173 7461 725f 7368 6f72  graph_astar_shor
-000115a0: 7465 7374 5f70 6174 6828 0a20 2020 2070  test_path(.    p
-000115b0: 793a 2050 7974 686f 6e2c 0a20 2020 2067  y: Python,.    g
-000115c0: 7261 7068 3a20 2664 6967 7261 7068 3a3a  raph: &digraph::
-000115d0: 5079 4469 4772 6170 682c 0a20 2020 206e  PyDiGraph,.    n
-000115e0: 6f64 653a 2075 7369 7a65 2c0a 2020 2020  ode: usize,.    
-000115f0: 676f 616c 5f66 6e3a 2050 794f 626a 6563  goal_fn: PyObjec
-00011600: 742c 0a20 2020 2065 6467 655f 636f 7374  t,.    edge_cost
-00011610: 5f66 6e3a 2050 794f 626a 6563 742c 0a20  _fn: PyObject,. 
-00011620: 2020 2065 7374 696d 6174 655f 636f 7374     estimate_cost
-00011630: 5f66 6e3a 2050 794f 626a 6563 742c 0a29  _fn: PyObject,.)
-00011640: 202d 3e20 5079 5265 7375 6c74 3c4e 6f64   -> PyResult<Nod
-00011650: 6549 6e64 6963 6573 3e20 7b0a 2020 2020  eIndices> {.    
-00011660: 6c65 7420 676f 616c 5f66 6e5f 6361 6c6c  let goal_fn_call
-00011670: 6162 6c65 203d 207c 613a 2026 5079 4f62  able = |a: &PyOb
-00011680: 6a65 6374 7c20 2d3e 2050 7952 6573 756c  ject| -> PyResul
-00011690: 743c 626f 6f6c 3e20 7b0a 2020 2020 2020  t<bool> {.      
-000116a0: 2020 6c65 7420 7265 7320 3d20 676f 616c    let res = goal
-000116b0: 5f66 6e2e 6361 6c6c 3128 7079 2c20 2861  _fn.call1(py, (a
-000116c0: 2c29 293f 3b0a 2020 2020 2020 2020 6c65  ,))?;.        le
-000116d0: 7420 7261 7720 3d20 7265 732e 746f 5f6f  t raw = res.to_o
-000116e0: 626a 6563 7428 7079 293b 0a20 2020 2020  bject(py);.     
-000116f0: 2020 206c 6574 206f 7574 7075 743a 2062     let output: b
-00011700: 6f6f 6c20 3d20 7261 772e 6578 7472 6163  ool = raw.extrac
-00011710: 7428 7079 293f 3b0a 2020 2020 2020 2020  t(py)?;.        
-00011720: 4f6b 286f 7574 7075 7429 0a20 2020 207d  Ok(output).    }
-00011730: 3b0a 0a20 2020 206c 6574 2065 6467 655f  ;..    let edge_
-00011740: 636f 7374 5f63 616c 6c61 626c 6520 3d20  cost_callable = 
-00011750: 7c61 3a20 2650 794f 626a 6563 747c 202d  |a: &PyObject| -
-00011760: 3e20 5079 5265 7375 6c74 3c66 3634 3e20  > PyResult<f64> 
-00011770: 7b0a 2020 2020 2020 2020 6c65 7420 7265  {.        let re
-00011780: 7320 3d20 6564 6765 5f63 6f73 745f 666e  s = edge_cost_fn
-00011790: 2e63 616c 6c31 2870 792c 2028 612c 2929  .call1(py, (a,))
-000117a0: 3f3b 0a20 2020 2020 2020 206c 6574 2072  ?;.        let r
-000117b0: 6177 203d 2072 6573 2e74 6f5f 6f62 6a65  aw = res.to_obje
-000117c0: 6374 2870 7929 3b0a 2020 2020 2020 2020  ct(py);.        
-000117d0: 6c65 7420 6f75 7470 7574 3a20 6636 3420  let output: f64 
-000117e0: 3d20 7261 772e 6578 7472 6163 7428 7079  = raw.extract(py
-000117f0: 293f 3b0a 2020 2020 2020 2020 4f6b 286f  )?;.        Ok(o
-00011800: 7574 7075 7429 0a20 2020 207d 3b0a 0a20  utput).    };.. 
-00011810: 2020 206c 6574 2065 7374 696d 6174 655f     let estimate_
-00011820: 636f 7374 5f63 616c 6c61 626c 6520 3d20  cost_callable = 
-00011830: 7c61 3a20 2650 794f 626a 6563 747c 202d  |a: &PyObject| -
-00011840: 3e20 5079 5265 7375 6c74 3c66 3634 3e20  > PyResult<f64> 
-00011850: 7b0a 2020 2020 2020 2020 6c65 7420 7265  {.        let re
-00011860: 7320 3d20 6573 7469 6d61 7465 5f63 6f73  s = estimate_cos
-00011870: 745f 666e 2e63 616c 6c31 2870 792c 2028  t_fn.call1(py, (
-00011880: 612c 2929 3f3b 0a20 2020 2020 2020 206c  a,))?;.        l
-00011890: 6574 2072 6177 203d 2072 6573 2e74 6f5f  et raw = res.to_
-000118a0: 6f62 6a65 6374 2870 7929 3b0a 2020 2020  object(py);.    
-000118b0: 2020 2020 6c65 7420 6f75 7470 7574 3a20      let output: 
-000118c0: 6636 3420 3d20 7261 772e 6578 7472 6163  f64 = raw.extrac
-000118d0: 7428 7079 293f 3b0a 2020 2020 2020 2020  t(py)?;.        
-000118e0: 4f6b 286f 7574 7075 7429 0a20 2020 207d  Ok(output).    }
-000118f0: 3b0a 2020 2020 6c65 7420 7374 6172 7420  ;.    let start 
-00011900: 3d20 4e6f 6465 496e 6465 783a 3a6e 6577  = NodeIndex::new
-00011910: 286e 6f64 6529 3b0a 0a20 2020 206c 6574  (node);..    let
-00011920: 2061 7374 6172 5f72 6573 203d 2061 7374   astar_res = ast
-00011930: 6172 3a3a 6173 7461 7228 0a20 2020 2020  ar::astar(.     
-00011940: 2020 2067 7261 7068 2c0a 2020 2020 2020     graph,.      
-00011950: 2020 7374 6172 742c 0a20 2020 2020 2020    start,.       
-00011960: 207c 667c 2067 6f61 6c5f 666e 5f63 616c   |f| goal_fn_cal
-00011970: 6c61 626c 6528 6772 6170 682e 6772 6170  lable(graph.grap
-00011980: 682e 6e6f 6465 5f77 6569 6768 7428 6629  h.node_weight(f)
-00011990: 2e75 6e77 7261 7028 2929 2c0a 2020 2020  .unwrap()),.    
-000119a0: 2020 2020 7c65 7c20 6564 6765 5f63 6f73      |e| edge_cos
-000119b0: 745f 6361 6c6c 6162 6c65 2865 2e77 6569  t_callable(e.wei
-000119c0: 6768 7428 2929 2c0a 2020 2020 2020 2020  ght()),.        
-000119d0: 7c65 7374 696d 6174 657c 207b 0a20 2020  |estimate| {.   
-000119e0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-000119f0: 655f 636f 7374 5f63 616c 6c61 626c 6528  e_cost_callable(
-00011a00: 6772 6170 682e 6772 6170 682e 6e6f 6465  graph.graph.node
-00011a10: 5f77 6569 6768 7428 6573 7469 6d61 7465  _weight(estimate
-00011a20: 292e 756e 7772 6170 2829 290a 2020 2020  ).unwrap()).    
-00011a30: 2020 2020 7d2c 0a20 2020 2029 3f3b 0a20      },.    )?;. 
-00011a40: 2020 206c 6574 2070 6174 6820 3d20 6d61     let path = ma
-00011a50: 7463 6820 6173 7461 725f 7265 7320 7b0a  tch astar_res {.
-00011a60: 2020 2020 2020 2020 536f 6d65 2870 6174          Some(pat
-00011a70: 6829 203d 3e20 7061 7468 2c0a 2020 2020  h) => path,.    
-00011a80: 2020 2020 4e6f 6e65 203d 3e20 7b0a 2020      None => {.  
-00011a90: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011aa0: 2045 7272 284e 6f50 6174 6846 6f75 6e64   Err(NoPathFound
-00011ab0: 3a3a 6e65 775f 6572 7228 0a20 2020 2020  ::new_err(.     
-00011ac0: 2020 2020 2020 2020 2020 2022 4e6f 2070             "No p
-00011ad0: 6174 6820 666f 756e 6420 7468 6174 2073  ath found that s
-00011ae0: 6174 6973 6669 6573 2067 6f61 6c5f 666e  atisfies goal_fn
-00011af0: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
-00011b00: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-00011b10: 7d3b 0a20 2020 204f 6b28 4e6f 6465 496e  };.    Ok(NodeIn
-00011b20: 6469 6365 7320 7b0a 2020 2020 2020 2020  dices {.        
-00011b30: 6e6f 6465 733a 2070 6174 682e 312e 696e  nodes: path.1.in
-00011b40: 746f 5f69 7465 7228 292e 6d61 7028 7c78  to_iter().map(|x
-00011b50: 7c20 782e 696e 6465 7828 2929 2e63 6f6c  | x.index()).col
-00011b60: 6c65 6374 2829 2c0a 2020 2020 7d29 0a7d  lect(),.    }).}
-00011b70: 0a0a 2f2f 2f20 5265 7475 726e 2061 203a  ../// Return a :
-00011b80: 6d61 7468 3a60 475f 7b6e 707d 6020 6469  math:`G_{np}` di
-00011b90: 7265 6374 6564 2072 616e 646f 6d20 6772  rected random gr
-00011ba0: 6170 682c 2061 6c73 6f20 6b6e 6f77 6e20  aph, also known 
-00011bb0: 6173 2061 6e0a 2f2f 2f20 4572 64c5 9173  as an./// Erd..s
-00011bc0: 2d52 c3a9 6e79 6920 6772 6170 6820 6f72  -R..nyi graph or
-00011bd0: 2061 2062 696e 6f6d 6961 6c20 6772 6170   a binomial grap
-00011be0: 682e 0a2f 2f2f 0a2f 2f2f 2046 6f72 206e  h..///./// For n
-00011bf0: 756d 6265 7220 6f66 206e 6f64 6573 203a  umber of nodes :
-00011c00: 6d61 7468 3a60 6e60 2061 6e64 2070 726f  math:`n` and pro
-00011c10: 6261 6269 6c69 7479 203a 6d61 7468 3a60  bability :math:`
-00011c20: 7060 2c20 7468 6520 3a6d 6174 683a 6047  p`, the :math:`G
-00011c30: 5f7b 6e2c 707d 600a 2f2f 2f20 6772 6170  _{n,p}`./// grap
-00011c40: 6820 616c 676f 7269 7468 6d20 6372 6561  h algorithm crea
-00011c50: 7465 7320 3a6d 6174 683a 606e 6020 6e6f  tes :math:`n` no
-00011c60: 6465 732c 2061 6e64 2066 6f72 2061 6c6c  des, and for all
-00011c70: 2074 6865 203a 6d61 7468 3a60 6e20 286e   the :math:`n (n
-00011c80: 202d 2031 2960 2070 6f73 7369 626c 6520   - 1)` possible 
-00011c90: 6564 6765 732c 0a2f 2f2f 2065 6163 6820  edges,./// each 
-00011ca0: 6564 6765 2069 7320 6372 6561 7465 6420  edge is created 
-00011cb0: 696e 6465 7065 6e64 656e 746c 7920 7769  independently wi
-00011cc0: 7468 2070 726f 6261 6269 6c69 7479 203a  th probability :
-00011cd0: 6d61 7468 3a60 7060 2e0a 2f2f 2f20 496e  math:`p`../// In
-00011ce0: 2067 656e 6572 616c 2c20 666f 7220 616e   general, for an
-00011cf0: 7920 7072 6f62 6162 696c 6974 7920 3a6d  y probability :m
-00011d00: 6174 683a 6070 602c 2074 6865 2065 7870  ath:`p`, the exp
-00011d10: 6563 7465 6420 6e75 6d62 6572 206f 6620  ected number of 
-00011d20: 6564 6765 7320 7265 7475 726e 6564 0a2f  edges returned./
-00011d30: 2f2f 2069 7320 3a6d 6174 683a 606d 203d  // is :math:`m =
-00011d40: 2070 206e 2028 6e20 2d20 3129 602e 2049   p n (n - 1)`. I
-00011d50: 6620 3a6d 6174 683a 6070 203d 2030 6020  f :math:`p = 0` 
-00011d60: 6f72 203a 6d61 7468 3a60 7020 3d20 3160  or :math:`p = 1`
-00011d70: 2c20 7468 6520 7265 7475 726e 6564 0a2f  , the returned./
-00011d80: 2f2f 2067 7261 7068 2069 7320 6e6f 7420  // graph is not 
-00011d90: 7261 6e64 6f6d 2061 6e64 2077 696c 6c20  random and will 
-00011da0: 616c 7761 7973 2062 6520 616e 2065 6d70  always be an emp
-00011db0: 7479 206f 7220 6120 636f 6d70 6c65 7465  ty or a complete
-00011dc0: 2067 7261 7068 2072 6573 7065 6374 6976   graph respectiv
-00011dd0: 656c 792e 0a2f 2f2f 2041 6e20 656d 7074  ely../// An empt
-00011de0: 7920 6772 6170 6820 6861 7320 7a65 726f  y graph has zero
-00011df0: 2065 6467 6573 2061 6e64 2061 2063 6f6d   edges and a com
-00011e00: 706c 6574 6520 6469 7265 6374 6564 2067  plete directed g
-00011e10: 7261 7068 2068 6173 203a 6d61 7468 3a60  raph has :math:`
-00011e20: 6e20 286e 202d 2031 2960 2065 6467 6573  n (n - 1)` edges
-00011e30: 2e0a 2f2f 2f20 5468 6520 7275 6e20 7469  ../// The run ti
-00011e40: 6d65 2069 7320 3a6d 6174 683a 604f 286e  me is :math:`O(n
-00011e50: 202b 206d 2960 2077 6865 7265 203a 6d61   + m)` where :ma
-00011e60: 7468 3a60 6d60 2069 7320 7468 6520 6578  th:`m` is the ex
-00011e70: 7065 6374 6564 206e 756d 6265 7220 6f66  pected number of
-00011e80: 2065 6467 6573 206d 656e 7469 6f6e 6564   edges mentioned
-00011e90: 2061 626f 7665 2e0a 2f2f 2f20 5768 656e   above../// When
-00011ea0: 203a 6d61 7468 3a60 7020 3d20 3060 2c20   :math:`p = 0`, 
-00011eb0: 7275 6e20 7469 6d65 2061 6c77 6179 7320  run time always 
-00011ec0: 7265 6475 6365 7320 746f 203a 6d61 7468  reduces to :math
-00011ed0: 3a60 4f28 6e29 602c 2061 7320 7468 6520  :`O(n)`, as the 
-00011ee0: 6c6f 7765 7220 626f 756e 642e 0a2f 2f2f  lower bound..///
-00011ef0: 2057 6865 6e20 3a6d 6174 683a 6070 203d   When :math:`p =
-00011f00: 2031 602c 2072 756e 2074 696d 6520 616c   1`, run time al
-00011f10: 7761 7973 2067 6f65 7320 746f 203a 6d61  ways goes to :ma
-00011f20: 7468 3a60 4f28 6e20 2b20 6e20 286e 202d  th:`O(n + n (n -
-00011f30: 2031 2929 602c 2061 7320 7468 6520 7570   1))`, as the up
-00011f40: 7065 7220 626f 756e 642e 0a2f 2f2f 2046  per bound../// F
-00011f50: 6f72 206f 7468 6572 2070 726f 6261 6269  or other probabi
-00011f60: 6c69 7469 6573 2c20 7468 6973 2061 6c67  lities, this alg
-00011f70: 6f72 6974 686d 205b 315d 5f20 7275 6e73  orithm [1]_ runs
-00011f80: 2069 6e20 3a6d 6174 683a 604f 286e 202b   in :math:`O(n +
-00011f90: 206d 2960 2074 696d 652e 0a2f 2f2f 0a2f   m)` time..///./
-00011fa0: 2f2f 2046 6f72 203a 6d61 7468 3a60 3020  // For :math:`0 
-00011fb0: 3c20 7020 3c20 3160 2c20 7468 6520 616c  < p < 1`, the al
-00011fc0: 676f 7269 7468 6d20 6973 2062 6173 6564  gorithm is based
-00011fd0: 206f 6e20 7468 6520 696d 706c 656d 656e   on the implemen
-00011fe0: 7461 7469 6f6e 206f 6620 7468 6520 6e65  tation of the ne
-00011ff0: 7477 6f72 6b78 2066 756e 6374 696f 6e0a  tworkx function.
-00012000: 2f2f 2f20 6060 6661 7374 5f67 6e70 5f72  /// ``fast_gnp_r
-00012010: 616e 646f 6d5f 6772 6170 6860 6020 5b32  andom_graph`` [2
-00012020: 5d5f 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  ]_.///./// :para
-00012030: 6d20 696e 7420 6e75 6d5f 6e6f 6465 733a  m int num_nodes:
-00012040: 2054 6865 206e 756d 6265 7220 6f66 206e   The number of n
-00012050: 6f64 6573 2074 6f20 6372 6561 7465 2069  odes to create i
-00012060: 6e20 7468 6520 6772 6170 680a 2f2f 2f20  n the graph./// 
-00012070: 3a70 6172 616d 2066 6c6f 6174 2070 726f  :param float pro
-00012080: 6261 6269 6c69 7479 3a20 5468 6520 7072  bability: The pr
-00012090: 6f62 6162 696c 6974 7920 6f66 2063 7265  obability of cre
-000120a0: 6174 696e 6720 616e 2065 6467 6520 6265  ating an edge be
-000120b0: 7477 6565 6e20 7477 6f20 6e6f 6465 730a  tween two nodes.
-000120c0: 2f2f 2f20 3a70 6172 616d 2069 6e74 2073  /// :param int s
-000120d0: 6565 643a 2041 6e20 6f70 7469 6f6e 616c  eed: An optional
-000120e0: 2073 6565 6420 746f 2075 7365 2066 6f72   seed to use for
-000120f0: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
-00012100: 6572 2067 656e 6572 6174 6f72 0a2f 2f2f  er generator.///
-00012110: 0a2f 2f2f 203a 7265 7475 726e 3a20 4120  ./// :return: A 
-00012120: 5079 4469 4772 6170 6820 6f62 6a65 6374  PyDiGraph object
-00012130: 0a2f 2f2f 203a 7274 7970 653a 2050 7944  ./// :rtype: PyD
-00012140: 6947 7261 7068 0a2f 2f2f 0a2f 2f2f 202e  iGraph.///./// .
-00012150: 2e20 5b31 5d20 566c 6164 696d 6972 2042  . [1] Vladimir B
-00012160: 6174 6167 656c 6a20 616e 6420 556c 7269  atagelj and Ulri
-00012170: 6b20 4272 616e 6465 732c 0a2f 2f2f 2020  k Brandes,.///  
-00012180: 2020 2245 6666 6963 6965 6e74 2067 656e    "Efficient gen
-00012190: 6572 6174 696f 6e20 6f66 206c 6172 6765  eration of large
-000121a0: 2072 616e 646f 6d20 6e65 7477 6f72 6b73   random networks
-000121b0: 222c 0a2f 2f2f 2020 2020 5068 7973 2e20  ",.///    Phys. 
-000121c0: 5265 762e 2045 2c20 3731 2c20 3033 3631  Rev. E, 71, 0361
-000121d0: 3133 2c20 3230 3035 2e0a 2f2f 2f20 2e2e  13, 2005../// ..
-000121e0: 205b 325d 2068 7474 7073 3a2f 2f67 6974   [2] https://git
-000121f0: 6875 622e 636f 6d2f 6e65 7477 6f72 6b78  hub.com/networkx
-00012200: 2f6e 6574 776f 726b 782f 626c 6f62 2f6e  /networkx/blob/n
-00012210: 6574 776f 726b 782d 322e 342f 6e65 7477  etworkx-2.4/netw
-00012220: 6f72 6b78 2f67 656e 6572 6174 6f72 732f  orkx/generators/
-00012230: 7261 6e64 6f6d 5f67 7261 7068 732e 7079  random_graphs.py
-00012240: 234c 3439 2d4c 3132 300a 235b 7079 6675  #L49-L120.#[pyfu
-00012250: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
-00012260: 6967 6e61 7475 7265 203d 2022 286e 756d  ignature = "(num
-00012270: 5f6e 6f64 6573 2c20 7072 6f62 6162 696c  _nodes, probabil
-00012280: 6974 792c 2073 6565 643d 4e6f 6e65 2c20  ity, seed=None, 
-00012290: 2f29 225d 0a70 7562 2066 6e20 6469 7265  /)"].pub fn dire
-000122a0: 6374 6564 5f67 6e70 5f72 616e 646f 6d5f  cted_gnp_random_
-000122b0: 6772 6170 6828 0a20 2020 2070 793a 2050  graph(.    py: P
-000122c0: 7974 686f 6e2c 0a20 2020 206e 756d 5f6e  ython,.    num_n
-000122d0: 6f64 6573 3a20 6973 697a 652c 0a20 2020  odes: isize,.   
-000122e0: 2070 726f 6261 6269 6c69 7479 3a20 6636   probability: f6
-000122f0: 342c 0a20 2020 2073 6565 643a 204f 7074  4,.    seed: Opt
-00012300: 696f 6e3c 7536 343e 2c0a 2920 2d3e 2050  ion<u64>,.) -> P
-00012310: 7952 6573 756c 743c 6469 6772 6170 683a  yResult<digraph:
-00012320: 3a50 7944 6947 7261 7068 3e20 7b0a 2020  :PyDiGraph> {.  
-00012330: 2020 6966 206e 756d 5f6e 6f64 6573 203c    if num_nodes <
-00012340: 3d20 3020 7b0a 2020 2020 2020 2020 7265  = 0 {.        re
-00012350: 7475 726e 2045 7272 2850 7956 616c 7565  turn Err(PyValue
-00012360: 4572 726f 723a 3a6e 6577 5f65 7272 2822  Error::new_err("
-00012370: 6e75 6d5f 6e6f 6465 7320 6d75 7374 2062  num_nodes must b
-00012380: 6520 3e20 3022 2929 3b0a 2020 2020 7d0a  e > 0"));.    }.
-00012390: 2020 2020 6c65 7420 6d75 7420 726e 673a      let mut rng:
-000123a0: 2050 6367 3634 203d 206d 6174 6368 2073   Pcg64 = match s
-000123b0: 6565 6420 7b0a 2020 2020 2020 2020 536f  eed {.        So
-000123c0: 6d65 2873 6565 6429 203d 3e20 5063 6736  me(seed) => Pcg6
-000123d0: 343a 3a73 6565 645f 6672 6f6d 5f75 3634  4::seed_from_u64
-000123e0: 2873 6565 6429 2c0a 2020 2020 2020 2020  (seed),.        
-000123f0: 4e6f 6e65 203d 3e20 5063 6736 343a 3a66  None => Pcg64::f
-00012400: 726f 6d5f 656e 7472 6f70 7928 292c 0a20  rom_entropy(),. 
-00012410: 2020 207d 3b0a 2020 2020 6c65 7420 6d75     };.    let mu
-00012420: 7420 696e 6e65 725f 6772 6170 6820 3d20  t inner_graph = 
-00012430: 5374 6162 6c65 4469 4772 6170 683a 3a3c  StableDiGraph::<
-00012440: 5079 4f62 6a65 6374 2c20 5079 4f62 6a65  PyObject, PyObje
-00012450: 6374 3e3a 3a6e 6577 2829 3b0a 2020 2020  ct>::new();.    
-00012460: 666f 7220 7820 696e 2030 2e2e 6e75 6d5f  for x in 0..num_
-00012470: 6e6f 6465 7320 7b0a 2020 2020 2020 2020  nodes {.        
-00012480: 696e 6e65 725f 6772 6170 682e 6164 645f  inner_graph.add_
-00012490: 6e6f 6465 2878 2e74 6f5f 6f62 6a65 6374  node(x.to_object
-000124a0: 2870 7929 293b 0a20 2020 207d 0a20 2020  (py));.    }.   
-000124b0: 2069 6620 2128 302e 302e 2e3d 312e 3029   if !(0.0..=1.0)
-000124c0: 2e63 6f6e 7461 696e 7328 2670 726f 6261  .contains(&proba
-000124d0: 6269 6c69 7479 2920 7b0a 2020 2020 2020  bility) {.      
-000124e0: 2020 7265 7475 726e 2045 7272 2850 7956    return Err(PyV
-000124f0: 616c 7565 4572 726f 723a 3a6e 6577 5f65  alueError::new_e
-00012500: 7272 280a 2020 2020 2020 2020 2020 2020  rr(.            
-00012510: 2250 726f 6261 6269 6c69 7479 206f 7574  "Probability out
-00012520: 206f 6620 7261 6e67 652c 206d 7573 7420   of range, must 
-00012530: 6265 2030 203c 3d20 7020 3c3d 2031 222c  be 0 <= p <= 1",
-00012540: 0a20 2020 2020 2020 2029 293b 0a20 2020  .        ));.   
-00012550: 207d 0a20 2020 2069 6620 7072 6f62 6162   }.    if probab
-00012560: 696c 6974 7920 3e20 302e 3020 7b0a 2020  ility > 0.0 {.  
-00012570: 2020 2020 2020 6966 2028 7072 6f62 6162        if (probab
-00012580: 696c 6974 7920 2d20 312e 3029 2e61 6273  ility - 1.0).abs
-00012590: 2829 203c 2073 7464 3a3a 6636 343a 3a45  () < std::f64::E
-000125a0: 5053 494c 4f4e 207b 0a20 2020 2020 2020  PSILON {.       
-000125b0: 2020 2020 2066 6f72 2075 2069 6e20 302e       for u in 0.
-000125c0: 2e6e 756d 5f6e 6f64 6573 207b 0a20 2020  .num_nodes {.   
-000125d0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000125e0: 2076 2069 6e20 302e 2e6e 756d 5f6e 6f64   v in 0..num_nod
-000125f0: 6573 207b 0a20 2020 2020 2020 2020 2020  es {.           
-00012600: 2020 2020 2020 2020 2069 6620 7520 213d           if u !=
-00012610: 2076 207b 0a20 2020 2020 2020 2020 2020   v {.           
-00012620: 2020 2020 2020 2020 2020 2020 202f 2f20               // 
-00012630: 6578 636c 7564 6520 7365 6c66 2d6c 6f6f  exclude self-loo
-00012640: 7073 0a20 2020 2020 2020 2020 2020 2020  ps.             
-00012650: 2020 2020 2020 2020 2020 206c 6574 2075             let u
-00012660: 5f69 6e64 6578 203d 204e 6f64 6549 6e64  _index = NodeInd
-00012670: 6578 3a3a 6e65 7728 7520 6173 2075 7369  ex::new(u as usi
-00012680: 7a65 293b 0a20 2020 2020 2020 2020 2020  ze);.           
-00012690: 2020 2020 2020 2020 2020 2020 206c 6574               let
-000126a0: 2076 5f69 6e64 6578 203d 204e 6f64 6549   v_index = NodeI
-000126b0: 6e64 6578 3a3a 6e65 7728 7620 6173 2075  ndex::new(v as u
-000126c0: 7369 7a65 293b 0a20 2020 2020 2020 2020  size);.         
-000126d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000126e0: 6e6e 6572 5f67 7261 7068 2e61 6464 5f65  nner_graph.add_e
-000126f0: 6467 6528 755f 696e 6465 782c 2076 5f69  dge(u_index, v_i
-00012700: 6e64 6578 2c20 7079 2e4e 6f6e 6528 2929  ndex, py.None())
-00012710: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00012720: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00012730: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00012740: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00012750: 7d20 656c 7365 207b 0a20 2020 2020 2020  } else {.       
-00012760: 2020 2020 206c 6574 206d 7574 2076 3a20       let mut v: 
-00012770: 6973 697a 6520 3d20 303b 0a20 2020 2020  isize = 0;.     
-00012780: 2020 2020 2020 206c 6574 206d 7574 2077         let mut w
-00012790: 3a20 6973 697a 6520 3d20 2d31 3b0a 2020  : isize = -1;.  
-000127a0: 2020 2020 2020 2020 2020 6c65 7420 6c70            let lp
-000127b0: 3a20 6636 3420 3d20 2831 2e30 202d 2070  : f64 = (1.0 - p
-000127c0: 726f 6261 6269 6c69 7479 292e 6c6e 2829  robability).ln()
-000127d0: 3b0a 0a20 2020 2020 2020 2020 2020 206c  ;..            l
-000127e0: 6574 2062 6574 7765 656e 203d 2055 6e69  et between = Uni
-000127f0: 666f 726d 3a3a 6e65 7728 302e 302c 2031  form::new(0.0, 1
-00012800: 2e30 293b 0a20 2020 2020 2020 2020 2020  .0);.           
-00012810: 2077 6869 6c65 2076 203c 206e 756d 5f6e   while v < num_n
-00012820: 6f64 6573 207b 0a20 2020 2020 2020 2020  odes {.         
-00012830: 2020 2020 2020 206c 6574 2072 616e 646f         let rando
-00012840: 6d3a 2066 3634 203d 2062 6574 7765 656e  m: f64 = between
-00012850: 2e73 616d 706c 6528 266d 7574 2072 6e67  .sample(&mut rng
-00012860: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-00012870: 2020 206c 6574 206c 723a 2066 3634 203d     let lr: f64 =
-00012880: 2028 312e 3020 2d20 7261 6e64 6f6d 292e   (1.0 - random).
-00012890: 6c6e 2829 3b0a 2020 2020 2020 2020 2020  ln();.          
-000128a0: 2020 2020 2020 6c65 7420 7261 7469 6f3a        let ratio:
-000128b0: 2069 7369 7a65 203d 2028 6c72 202f 206c   isize = (lr / l
-000128c0: 7029 2061 7320 6973 697a 653b 0a20 2020  p) as isize;.   
-000128d0: 2020 2020 2020 2020 2020 2020 2077 203d               w =
-000128e0: 2077 202b 2031 202b 2072 6174 696f 3b0a   w + 1 + ratio;.
-000128f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012900: 2f2f 2061 766f 6964 2073 656c 6620 6c6f  // avoid self lo
-00012910: 6f70 730a 2020 2020 2020 2020 2020 2020  ops.            
-00012920: 2020 2020 6966 2076 203d 3d20 7720 7b0a      if v == w {.
-00012930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012940: 2020 2020 7720 2b3d 2031 3b0a 2020 2020      w += 1;.    
-00012950: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00012960: 2020 2020 2020 2020 2020 2020 2020 7768                wh
-00012970: 696c 6520 7620 3c20 6e75 6d5f 6e6f 6465  ile v < num_node
-00012980: 7320 2626 206e 756d 5f6e 6f64 6573 203c  s && num_nodes <
-00012990: 3d20 7720 7b0a 2020 2020 2020 2020 2020  = w {.          
-000129a0: 2020 2020 2020 2020 2020 7720 2d3d 2076            w -= v
-000129b0: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-000129c0: 2020 2020 2020 7620 2b3d 2031 3b0a 2020        v += 1;.  
-000129d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129e0: 2020 2f2f 2061 766f 6964 2073 656c 6620    // avoid self 
-000129f0: 6c6f 6f70 730a 2020 2020 2020 2020 2020  loops.          
-00012a00: 2020 2020 2020 2020 2020 6966 2076 203d            if v =
-00012a10: 3d20 7720 7b0a 2020 2020 2020 2020 2020  = w {.          
-00012a20: 2020 2020 2020 2020 2020 2020 2020 7720                w 
-00012a30: 2d3d 2076 3b0a 2020 2020 2020 2020 2020  -= v;.          
-00012a40: 2020 2020 2020 2020 2020 2020 2020 7620                v 
-00012a50: 2b3d 2031 3b0a 2020 2020 2020 2020 2020  += 1;.          
-00012a60: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-00012a70: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00012a80: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00012a90: 2076 203c 206e 756d 5f6e 6f64 6573 207b   v < num_nodes {
-00012aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012ab0: 2020 2020 206c 6574 2076 5f69 6e64 6578       let v_index
-00012ac0: 203d 204e 6f64 6549 6e64 6578 3a3a 6e65   = NodeIndex::ne
-00012ad0: 7728 7620 6173 2075 7369 7a65 293b 0a20  w(v as usize);. 
-00012ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012af0: 2020 206c 6574 2077 5f69 6e64 6578 203d     let w_index =
-00012b00: 204e 6f64 6549 6e64 6578 3a3a 6e65 7728   NodeIndex::new(
-00012b10: 7720 6173 2075 7369 7a65 293b 0a20 2020  w as usize);.   
-00012b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b30: 2069 6e6e 6572 5f67 7261 7068 2e61 6464   inner_graph.add
-00012b40: 5f65 6467 6528 765f 696e 6465 782c 2077  _edge(v_index, w
-00012b50: 5f69 6e64 6578 2c20 7079 2e4e 6f6e 6528  _index, py.None(
-00012b60: 2929 3b0a 2020 2020 2020 2020 2020 2020  ));.            
-00012b70: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00012b80: 2020 7d0a 2020 2020 2020 2020 7d0a 2020    }.        }.  
-00012b90: 2020 7d0a 0a20 2020 206c 6574 2067 7261    }..    let gra
-00012ba0: 7068 203d 2064 6967 7261 7068 3a3a 5079  ph = digraph::Py
-00012bb0: 4469 4772 6170 6820 7b0a 2020 2020 2020  DiGraph {.      
-00012bc0: 2020 6772 6170 683a 2069 6e6e 6572 5f67    graph: inner_g
-00012bd0: 7261 7068 2c0a 2020 2020 2020 2020 6379  raph,.        cy
-00012be0: 636c 655f 7374 6174 653a 2061 6c67 6f3a  cle_state: algo:
-00012bf0: 3a44 6673 5370 6163 653a 3a64 6566 6175  :DfsSpace::defau
-00012c00: 6c74 2829 2c0a 2020 2020 2020 2020 6368  lt(),.        ch
-00012c10: 6563 6b5f 6379 636c 653a 2066 616c 7365  eck_cycle: false
-00012c20: 2c0a 2020 2020 2020 2020 6e6f 6465 5f72  ,.        node_r
-00012c30: 656d 6f76 6564 3a20 6661 6c73 652c 0a20  emoved: false,. 
-00012c40: 2020 2020 2020 206d 756c 7469 6772 6170         multigrap
-00012c50: 683a 2074 7275 652c 0a20 2020 207d 3b0a  h: true,.    };.
-00012c60: 2020 2020 4f6b 2867 7261 7068 290a 7d0a      Ok(graph).}.
-00012c70: 0a2f 2f2f 2052 6574 7572 6e20 6120 3a6d  ./// Return a :m
-00012c80: 6174 683a 6047 5f7b 6e70 7d60 2072 616e  ath:`G_{np}` ran
-00012c90: 646f 6d20 756e 6469 7265 6374 6564 2067  dom undirected g
-00012ca0: 7261 7068 2c20 616c 736f 206b 6e6f 776e  raph, also known
-00012cb0: 2061 7320 616e 0a2f 2f2f 2045 7264 c591   as an./// Erd..
-00012cc0: 732d 52c3 a96e 7969 2067 7261 7068 206f  s-R..nyi graph o
-00012cd0: 7220 6120 6269 6e6f 6d69 616c 2067 7261  r a binomial gra
-00012ce0: 7068 2e0a 2f2f 2f0a 2f2f 2f20 466f 7220  ph..///./// For 
-00012cf0: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
-00012d00: 3a6d 6174 683a 606e 6020 616e 6420 7072  :math:`n` and pr
-00012d10: 6f62 6162 696c 6974 7920 3a6d 6174 683a  obability :math:
-00012d20: 6070 602c 2074 6865 203a 6d61 7468 3a60  `p`, the :math:`
-00012d30: 475f 7b6e 2c70 7d60 0a2f 2f2f 2067 7261  G_{n,p}`./// gra
-00012d40: 7068 2061 6c67 6f72 6974 686d 2063 7265  ph algorithm cre
-00012d50: 6174 6573 203a 6d61 7468 3a60 6e60 206e  ates :math:`n` n
-00012d60: 6f64 6573 2c20 616e 6420 666f 7220 616c  odes, and for al
-00012d70: 6c20 7468 6520 3a6d 6174 683a 606e 2028  l the :math:`n (
-00012d80: 6e20 2d20 3129 2f32 6020 706f 7373 6962  n - 1)/2` possib
-00012d90: 6c65 2065 6467 6573 2c0a 2f2f 2f20 6561  le edges,./// ea
-00012da0: 6368 2065 6467 6520 6973 2063 7265 6174  ch edge is creat
-00012db0: 6564 2069 6e64 6570 656e 6465 6e74 6c79  ed independently
-00012dc0: 2077 6974 6820 7072 6f62 6162 696c 6974   with probabilit
-00012dd0: 7920 3a6d 6174 683a 6070 602e 0a2f 2f2f  y :math:`p`..///
-00012de0: 2049 6e20 6765 6e65 7261 6c2c 2066 6f72   In general, for
-00012df0: 2061 6e79 2070 726f 6261 6269 6c69 7479   any probability
-00012e00: 203a 6d61 7468 3a60 7060 2c20 7468 6520   :math:`p`, the 
-00012e10: 6578 7065 6374 6564 206e 756d 6265 7220  expected number 
-00012e20: 6f66 2065 6467 6573 2072 6574 7572 6e65  of edges returne
-00012e30: 640a 2f2f 2f20 6973 203a 6d61 7468 3a60  d./// is :math:`
-00012e40: 6d20 3d20 7020 6e20 286e 202d 2031 292f  m = p n (n - 1)/
-00012e50: 3260 2e20 4966 203a 6d61 7468 3a60 7020  2`. If :math:`p 
-00012e60: 3d20 3060 206f 7220 3a6d 6174 683a 6070  = 0` or :math:`p
-00012e70: 203d 2031 602c 2074 6865 2072 6574 7572   = 1`, the retur
-00012e80: 6e65 640a 2f2f 2f20 6772 6170 6820 6973  ned./// graph is
-00012e90: 206e 6f74 2072 616e 646f 6d20 616e 6420   not random and 
-00012ea0: 7769 6c6c 2061 6c77 6179 7320 6265 2061  will always be a
-00012eb0: 6e20 656d 7074 7920 6f72 2061 2063 6f6d  n empty or a com
-00012ec0: 706c 6574 6520 6772 6170 6820 7265 7370  plete graph resp
-00012ed0: 6563 7469 7665 6c79 2e0a 2f2f 2f20 416e  ectively../// An
-00012ee0: 2065 6d70 7479 2067 7261 7068 2068 6173   empty graph has
-00012ef0: 207a 6572 6f20 6564 6765 7320 616e 6420   zero edges and 
-00012f00: 6120 636f 6d70 6c65 7465 2075 6e64 6972  a complete undir
-00012f10: 6563 7465 6420 6772 6170 6820 6861 7320  ected graph has 
-00012f20: 3a6d 6174 683a 606e 2028 6e20 2d20 3129  :math:`n (n - 1)
-00012f30: 2f32 6020 6564 6765 732e 0a2f 2f2f 2054  /2` edges../// T
-00012f40: 6865 2072 756e 2074 696d 6520 6973 203a  he run time is :
-00012f50: 6d61 7468 3a60 4f28 6e20 2b20 6d29 6020  math:`O(n + m)` 
-00012f60: 7768 6572 6520 3a6d 6174 683a 606d 6020  where :math:`m` 
-00012f70: 6973 2074 6865 2065 7870 6563 7465 6420  is the expected 
-00012f80: 6e75 6d62 6572 206f 6620 6564 6765 7320  number of edges 
-00012f90: 6d65 6e74 696f 6e65 6420 6162 6f76 652e  mentioned above.
-00012fa0: 0a2f 2f2f 2057 6865 6e20 3a6d 6174 683a  ./// When :math:
-00012fb0: 6070 203d 2030 602c 2072 756e 2074 696d  `p = 0`, run tim
-00012fc0: 6520 616c 7761 7973 2072 6564 7563 6573  e always reduces
-00012fd0: 2074 6f20 3a6d 6174 683a 604f 286e 2960   to :math:`O(n)`
-00012fe0: 2c20 6173 2074 6865 206c 6f77 6572 2062  , as the lower b
-00012ff0: 6f75 6e64 2e0a 2f2f 2f20 5768 656e 203a  ound../// When :
-00013000: 6d61 7468 3a60 7020 3d20 3160 2c20 7275  math:`p = 1`, ru
-00013010: 6e20 7469 6d65 2061 6c77 6179 7320 676f  n time always go
-00013020: 6573 2074 6f20 3a6d 6174 683a 604f 286e  es to :math:`O(n
-00013030: 202b 206e 2028 6e20 2d20 3129 2f32 2960   + n (n - 1)/2)`
-00013040: 2c20 6173 2074 6865 2075 7070 6572 2062  , as the upper b
-00013050: 6f75 6e64 2e0a 2f2f 2f20 466f 7220 6f74  ound../// For ot
-00013060: 6865 7220 7072 6f62 6162 696c 6974 6965  her probabilitie
-00013070: 732c 2074 6869 7320 616c 676f 7269 7468  s, this algorith
-00013080: 6d20 5b31 5d5f 2072 756e 7320 696e 203a  m [1]_ runs in :
-00013090: 6d61 7468 3a60 4f28 6e20 2b20 6d29 6020  math:`O(n + m)` 
-000130a0: 7469 6d65 2e0a 2f2f 2f0a 2f2f 2f20 466f  time..///./// Fo
-000130b0: 7220 3a6d 6174 683a 6030 203c 2070 203c  r :math:`0 < p <
-000130c0: 2031 602c 2074 6865 2061 6c67 6f72 6974   1`, the algorit
-000130d0: 686d 2069 7320 6261 7365 6420 6f6e 2074  hm is based on t
-000130e0: 6865 2069 6d70 6c65 6d65 6e74 6174 696f  he implementatio
-000130f0: 6e20 6f66 2074 6865 206e 6574 776f 726b  n of the network
-00013100: 7820 6675 6e63 7469 6f6e 0a2f 2f2f 2060  x function./// `
-00013110: 6066 6173 745f 676e 705f 7261 6e64 6f6d  `fast_gnp_random
-00013120: 5f67 7261 7068 6060 205b 325d 5f0a 2f2f  _graph`` [2]_.//
-00013130: 2f0a 2f2f 2f20 3a70 6172 616d 2069 6e74  /./// :param int
-00013140: 206e 756d 5f6e 6f64 6573 3a20 5468 6520   num_nodes: The 
-00013150: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
-00013160: 746f 2063 7265 6174 6520 696e 2074 6865  to create in the
-00013170: 2067 7261 7068 0a2f 2f2f 203a 7061 7261   graph./// :para
-00013180: 6d20 666c 6f61 7420 7072 6f62 6162 696c  m float probabil
-00013190: 6974 793a 2054 6865 2070 726f 6261 6269  ity: The probabi
-000131a0: 6c69 7479 206f 6620 6372 6561 7469 6e67  lity of creating
-000131b0: 2061 6e20 6564 6765 2062 6574 7765 656e   an edge between
-000131c0: 2074 776f 206e 6f64 6573 0a2f 2f2f 203a   two nodes./// :
-000131d0: 7061 7261 6d20 696e 7420 7365 6564 3a20  param int seed: 
-000131e0: 416e 206f 7074 696f 6e61 6c20 7365 6564  An optional seed
-000131f0: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
-00013200: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
-00013210: 6e65 7261 746f 720a 2f2f 2f0a 2f2f 2f20  nerator.///./// 
-00013220: 3a72 6574 7572 6e3a 2041 2050 7947 7261  :return: A PyGra
-00013230: 7068 206f 626a 6563 740a 2f2f 2f20 3a72  ph object./// :r
-00013240: 7479 7065 3a20 5079 4772 6170 680a 2f2f  type: PyGraph.//
-00013250: 2f0a 2f2f 2f20 2e2e 205b 315d 2056 6c61  /./// .. [1] Vla
-00013260: 6469 6d69 7220 4261 7461 6765 6c6a 2061  dimir Batagelj a
-00013270: 6e64 2055 6c72 696b 2042 7261 6e64 6573  nd Ulrik Brandes
-00013280: 2c0a 2f2f 2f20 2020 2022 4566 6669 6369  ,.///    "Effici
-00013290: 656e 7420 6765 6e65 7261 7469 6f6e 206f  ent generation o
-000132a0: 6620 6c61 7267 6520 7261 6e64 6f6d 206e  f large random n
-000132b0: 6574 776f 726b 7322 2c0a 2f2f 2f20 2020  etworks",.///   
-000132c0: 2050 6879 732e 2052 6576 2e20 452c 2037   Phys. Rev. E, 7
-000132d0: 312c 2030 3336 3131 332c 2032 3030 352e  1, 036113, 2005.
-000132e0: 0a2f 2f2f 202e 2e20 5b32 5d20 6874 7470  ./// .. [2] http
-000132f0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f6e  s://github.com/n
-00013300: 6574 776f 726b 782f 6e65 7477 6f72 6b78  etworkx/networkx
-00013310: 2f62 6c6f 622f 6e65 7477 6f72 6b78 2d32  /blob/networkx-2
-00013320: 2e34 2f6e 6574 776f 726b 782f 6765 6e65  .4/networkx/gene
-00013330: 7261 746f 7273 2f72 616e 646f 6d5f 6772  rators/random_gr
-00013340: 6170 6873 2e70 7923 4c34 392d 4c31 3230  aphs.py#L49-L120
-00013350: 0a23 5b70 7966 756e 6374 696f 6e5d 0a23  .#[pyfunction].#
-00013360: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
-00013370: 3d20 2228 6e75 6d5f 6e6f 6465 732c 2070  = "(num_nodes, p
-00013380: 726f 6261 6269 6c69 7479 2c20 7365 6564  robability, seed
-00013390: 3d4e 6f6e 652c 202f 2922 5d0a 7075 6220  =None, /)"].pub 
-000133a0: 666e 2075 6e64 6972 6563 7465 645f 676e  fn undirected_gn
-000133b0: 705f 7261 6e64 6f6d 5f67 7261 7068 280a  p_random_graph(.
-000133c0: 2020 2020 7079 3a20 5079 7468 6f6e 2c0a      py: Python,.
-000133d0: 2020 2020 6e75 6d5f 6e6f 6465 733a 2069      num_nodes: i
-000133e0: 7369 7a65 2c0a 2020 2020 7072 6f62 6162  size,.    probab
-000133f0: 696c 6974 793a 2066 3634 2c0a 2020 2020  ility: f64,.    
-00013400: 7365 6564 3a20 4f70 7469 6f6e 3c75 3634  seed: Option<u64
-00013410: 3e2c 0a29 202d 3e20 5079 5265 7375 6c74  >,.) -> PyResult
-00013420: 3c67 7261 7068 3a3a 5079 4772 6170 683e  <graph::PyGraph>
-00013430: 207b 0a20 2020 2069 6620 6e75 6d5f 6e6f   {.    if num_no
-00013440: 6465 7320 3c3d 2030 207b 0a20 2020 2020  des <= 0 {.     
-00013450: 2020 2072 6574 7572 6e20 4572 7228 5079     return Err(Py
-00013460: 5661 6c75 6545 7272 6f72 3a3a 6e65 775f  ValueError::new_
-00013470: 6572 7228 226e 756d 5f6e 6f64 6573 206d  err("num_nodes m
-00013480: 7573 7420 6265 203e 2030 2229 293b 0a20  ust be > 0"));. 
-00013490: 2020 207d 0a20 2020 206c 6574 206d 7574     }.    let mut
-000134a0: 2072 6e67 3a20 5063 6736 3420 3d20 6d61   rng: Pcg64 = ma
-000134b0: 7463 6820 7365 6564 207b 0a20 2020 2020  tch seed {.     
-000134c0: 2020 2053 6f6d 6528 7365 6564 2920 3d3e     Some(seed) =>
-000134d0: 2050 6367 3634 3a3a 7365 6564 5f66 726f   Pcg64::seed_fro
-000134e0: 6d5f 7536 3428 7365 6564 292c 0a20 2020  m_u64(seed),.   
-000134f0: 2020 2020 204e 6f6e 6520 3d3e 2050 6367       None => Pcg
-00013500: 3634 3a3a 6672 6f6d 5f65 6e74 726f 7079  64::from_entropy
-00013510: 2829 2c0a 2020 2020 7d3b 0a20 2020 206c  (),.    };.    l
-00013520: 6574 206d 7574 2069 6e6e 6572 5f67 7261  et mut inner_gra
-00013530: 7068 203d 2053 7461 626c 6555 6e47 7261  ph = StableUnGra
-00013540: 7068 3a3a 3c50 794f 626a 6563 742c 2050  ph::<PyObject, P
-00013550: 794f 626a 6563 743e 3a3a 6465 6661 756c  yObject>::defaul
-00013560: 7428 293b 0a20 2020 2066 6f72 2078 2069  t();.    for x i
-00013570: 6e20 302e 2e6e 756d 5f6e 6f64 6573 207b  n 0..num_nodes {
-00013580: 0a20 2020 2020 2020 2069 6e6e 6572 5f67  .        inner_g
-00013590: 7261 7068 2e61 6464 5f6e 6f64 6528 782e  raph.add_node(x.
-000135a0: 746f 5f6f 626a 6563 7428 7079 2929 3b0a  to_object(py));.
-000135b0: 2020 2020 7d0a 2020 2020 6966 2021 2830      }.    if !(0
-000135c0: 2e30 2e2e 3d31 2e30 292e 636f 6e74 6169  .0..=1.0).contai
-000135d0: 6e73 2826 7072 6f62 6162 696c 6974 7929  ns(&probability)
-000135e0: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
-000135f0: 6e20 4572 7228 5079 5661 6c75 6545 7272  n Err(PyValueErr
-00013600: 6f72 3a3a 6e65 775f 6572 7228 0a20 2020  or::new_err(.   
-00013610: 2020 2020 2020 2020 2022 5072 6f62 6162           "Probab
-00013620: 696c 6974 7920 6f75 7420 6f66 2072 616e  ility out of ran
-00013630: 6765 2c20 6d75 7374 2062 6520 3020 3c3d  ge, must be 0 <=
-00013640: 2070 203c 3d20 3122 2c0a 2020 2020 2020   p <= 1",.      
-00013650: 2020 2929 3b0a 2020 2020 7d0a 2020 2020    ));.    }.    
-00013660: 6966 2070 726f 6261 6269 6c69 7479 203e  if probability >
-00013670: 2030 2e30 207b 0a20 2020 2020 2020 2069   0.0 {.        i
-00013680: 6620 2870 726f 6261 6269 6c69 7479 202d  f (probability -
-00013690: 2031 2e30 292e 6162 7328 2920 3c20 7374   1.0).abs() < st
-000136a0: 643a 3a66 3634 3a3a 4550 5349 4c4f 4e20  d::f64::EPSILON 
-000136b0: 7b0a 2020 2020 2020 2020 2020 2020 666f  {.            fo
-000136c0: 7220 7520 696e 2030 2e2e 6e75 6d5f 6e6f  r u in 0..num_no
-000136d0: 6465 7320 7b0a 2020 2020 2020 2020 2020  des {.          
-000136e0: 2020 2020 2020 666f 7220 7620 696e 2075        for v in u
-000136f0: 202b 2031 2e2e 6e75 6d5f 6e6f 6465 7320   + 1..num_nodes 
-00013700: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00013710: 2020 2020 2020 6c65 7420 755f 696e 6465        let u_inde
-00013720: 7820 3d20 4e6f 6465 496e 6465 783a 3a6e  x = NodeIndex::n
-00013730: 6577 2875 2061 7320 7573 697a 6529 3b0a  ew(u as usize);.
-00013740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013750: 2020 2020 6c65 7420 765f 696e 6465 7820      let v_index 
-00013760: 3d20 4e6f 6465 496e 6465 783a 3a6e 6577  = NodeIndex::new
-00013770: 2876 2061 7320 7573 697a 6529 3b0a 2020  (v as usize);.  
-00013780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013790: 2020 696e 6e65 725f 6772 6170 682e 6164    inner_graph.ad
-000137a0: 645f 6564 6765 2875 5f69 6e64 6578 2c20  d_edge(u_index, 
-000137b0: 765f 696e 6465 782c 2070 792e 4e6f 6e65  v_index, py.None
-000137c0: 2829 293b 0a20 2020 2020 2020 2020 2020  ());.           
-000137d0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-000137e0: 2020 207d 0a20 2020 2020 2020 207d 2065     }.        } e
-000137f0: 6c73 6520 7b0a 2020 2020 2020 2020 2020  lse {.          
-00013800: 2020 6c65 7420 6d75 7420 763a 2069 7369    let mut v: isi
-00013810: 7a65 203d 2031 3b0a 2020 2020 2020 2020  ze = 1;.        
-00013820: 2020 2020 6c65 7420 6d75 7420 773a 2069      let mut w: i
-00013830: 7369 7a65 203d 202d 313b 0a20 2020 2020  size = -1;.     
-00013840: 2020 2020 2020 206c 6574 206c 703a 2066         let lp: f
-00013850: 3634 203d 2028 312e 3020 2d20 7072 6f62  64 = (1.0 - prob
-00013860: 6162 696c 6974 7929 2e6c 6e28 293b 0a0a  ability).ln();..
-00013870: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00013880: 6265 7477 6565 6e20 3d20 556e 6966 6f72  between = Unifor
-00013890: 6d3a 3a6e 6577 2830 2e30 2c20 312e 3029  m::new(0.0, 1.0)
-000138a0: 3b0a 2020 2020 2020 2020 2020 2020 7768  ;.            wh
-000138b0: 696c 6520 7620 3c20 6e75 6d5f 6e6f 6465  ile v < num_node
-000138c0: 7320 7b0a 2020 2020 2020 2020 2020 2020  s {.            
-000138d0: 2020 2020 6c65 7420 7261 6e64 6f6d 3a20      let random: 
-000138e0: 6636 3420 3d20 6265 7477 6565 6e2e 7361  f64 = between.sa
-000138f0: 6d70 6c65 2826 6d75 7420 726e 6729 3b0a  mple(&mut rng);.
-00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013910: 6c65 7420 6c72 203d 2028 312e 3020 2d20  let lr = (1.0 - 
-00013920: 7261 6e64 6f6d 292e 6c6e 2829 3b0a 2020  random).ln();.  
-00013930: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00013940: 7420 7261 7469 6f3a 2069 7369 7a65 203d  t ratio: isize =
-00013950: 2028 6c72 202f 206c 7029 2061 7320 6973   (lr / lp) as is
-00013960: 697a 653b 0a20 2020 2020 2020 2020 2020  ize;.           
-00013970: 2020 2020 2077 203d 2077 202b 2031 202b       w = w + 1 +
-00013980: 2072 6174 696f 3b0a 2020 2020 2020 2020   ratio;.        
-00013990: 2020 2020 2020 2020 7768 696c 6520 7720          while w 
-000139a0: 3e3d 2076 2026 2620 7620 3c20 6e75 6d5f  >= v && v < num_
-000139b0: 6e6f 6465 7320 7b0a 2020 2020 2020 2020  nodes {.        
-000139c0: 2020 2020 2020 2020 2020 2020 7720 2d3d              w -=
-000139d0: 2076 3b0a 2020 2020 2020 2020 2020 2020   v;.            
-000139e0: 2020 2020 2020 2020 7620 2b3d 2031 3b0a          v += 1;.
-000139f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a00: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00013a10: 2020 6966 2076 203c 206e 756d 5f6e 6f64    if v < num_nod
-00013a20: 6573 207b 0a20 2020 2020 2020 2020 2020  es {.           
-00013a30: 2020 2020 2020 2020 206c 6574 2076 5f69           let v_i
-00013a40: 6e64 6578 203d 204e 6f64 6549 6e64 6578  ndex = NodeIndex
-00013a50: 3a3a 6e65 7728 7620 6173 2075 7369 7a65  ::new(v as usize
-00013a60: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-00013a70: 2020 2020 2020 206c 6574 2077 5f69 6e64         let w_ind
-00013a80: 6578 203d 204e 6f64 6549 6e64 6578 3a3a  ex = NodeIndex::
-00013a90: 6e65 7728 7720 6173 2075 7369 7a65 293b  new(w as usize);
-00013aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ab0: 2020 2020 2069 6e6e 6572 5f67 7261 7068       inner_graph
-00013ac0: 2e61 6464 5f65 6467 6528 765f 696e 6465  .add_edge(v_inde
-00013ad0: 782c 2077 5f69 6e64 6578 2c20 7079 2e4e  x, w_index, py.N
-00013ae0: 6f6e 6528 2929 3b0a 2020 2020 2020 2020  one());.        
-00013af0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00013b00: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00013b10: 7d0a 2020 2020 7d0a 0a20 2020 206c 6574  }.    }..    let
-00013b20: 2067 7261 7068 203d 2067 7261 7068 3a3a   graph = graph::
-00013b30: 5079 4772 6170 6820 7b0a 2020 2020 2020  PyGraph {.      
-00013b40: 2020 6772 6170 683a 2069 6e6e 6572 5f67    graph: inner_g
-00013b50: 7261 7068 2c0a 2020 2020 2020 2020 6e6f  raph,.        no
-00013b60: 6465 5f72 656d 6f76 6564 3a20 6661 6c73  de_removed: fals
-00013b70: 652c 0a20 2020 2020 2020 206d 756c 7469  e,.        multi
-00013b80: 6772 6170 683a 2074 7275 652c 0a20 2020  graph: true,.   
-00013b90: 207d 3b0a 2020 2020 4f6b 2867 7261 7068   };.    Ok(graph
-00013ba0: 290a 7d0a 0a2f 2f2f 2052 6574 7572 6e20  ).}../// Return 
-00013bb0: 6120 3a6d 6174 683a 6047 5f7b 6e6d 7d60  a :math:`G_{nm}`
-00013bc0: 206f 6620 6120 6469 7265 6374 6564 2067   of a directed g
-00013bd0: 7261 7068 0a2f 2f2f 0a2f 2f2f 2047 656e  raph.///./// Gen
-00013be0: 6572 6174 6573 2061 2072 616e 646f 6d20  erates a random 
-00013bf0: 6469 7265 6374 6564 2067 7261 7068 206f  directed graph o
-00013c00: 7574 206f 6620 616c 6c20 7468 6520 706f  ut of all the po
-00013c10: 7373 6962 6c65 2067 7261 7068 7320 7769  ssible graphs wi
-00013c20: 7468 203a 6d61 7468 3a60 6e60 206e 6f64  th :math:`n` nod
-00013c30: 6573 2061 6e64 0a2f 2f2f 203a 6d61 7468  es and./// :math
-00013c40: 3a60 6d60 2065 6467 6573 2e20 5468 6520  :`m` edges. The 
-00013c50: 6765 6e65 7261 7465 6420 6772 6170 6820  generated graph 
-00013c60: 7769 6c6c 206e 6f74 2062 6520 6120 6d75  will not be a mu
-00013c70: 6c74 6967 7261 7068 2061 6e64 2077 696c  ltigraph and wil
-00013c80: 6c20 6e6f 7420 6861 7665 2073 656c 6620  l not have self 
-00013c90: 6c6f 6f70 732e 0a2f 2f2f 0a2f 2f2f 2046  loops..///./// F
-00013ca0: 6f72 203a 6d61 7468 3a60 6e60 206e 6f64  or :math:`n` nod
-00013cb0: 6573 2c20 7468 6520 6d61 7869 6d75 6d20  es, the maximum 
-00013cc0: 6564 6765 7320 7468 6174 2063 616e 2062  edges that can b
-00013cd0: 6520 7265 7475 726e 6564 2069 7320 3a6d  e returned is :m
-00013ce0: 6174 683a 606e 2028 6e20 2d20 3129 602e  ath:`n (n - 1)`.
-00013cf0: 0a2f 2f2f 2050 6173 7369 6e67 203a 6d61  ./// Passing :ma
-00013d00: 7468 3a60 6d60 2068 6967 6865 7220 7468  th:`m` higher th
-00013d10: 616e 2074 6861 7420 7769 6c6c 2073 7469  an that will sti
-00013d20: 6c6c 2072 6574 7572 6e20 7468 6520 6d61  ll return the ma
-00013d30: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
-00013d40: 6564 6765 732e 0a2f 2f2f 2049 6620 3a6d  edges../// If :m
-00013d50: 6174 683a 606d 203d 2030 602c 2074 6865  ath:`m = 0`, the
-00013d60: 2072 6574 7572 6e65 6420 6772 6170 6820   returned graph 
-00013d70: 7769 6c6c 2061 6c77 6179 7320 6265 2065  will always be e
-00013d80: 6d70 7479 2028 6e6f 2065 6467 6573 292e  mpty (no edges).
-00013d90: 0a2f 2f2f 2057 6865 6e20 6120 7365 6564  ./// When a seed
-00013da0: 2069 7320 7072 6f76 6964 6564 2c20 7468   is provided, th
-00013db0: 6520 7265 7375 6c74 7320 6172 6520 7265  e results are re
-00013dc0: 7072 6f64 7563 6962 6c65 2e20 5061 7373  producible. Pass
-00013dd0: 696e 6720 6120 7365 6564 2077 6865 6e20  ing a seed when 
-00013de0: 3a6d 6174 683a 606d 203d 2030 600a 2f2f  :math:`m = 0`.//
-00013df0: 2f20 6f72 203a 6d61 7468 3a60 6d20 3e3d  / or :math:`m >=
-00013e00: 206e 2028 6e20 2d20 3129 6020 6861 7320   n (n - 1)` has 
-00013e10: 6e6f 2065 6666 6563 742c 2061 7320 7468  no effect, as th
-00013e20: 6520 7265 7375 6c74 2077 696c 6c20 616c  e result will al
-00013e30: 7761 7973 2062 6520 616e 2065 6d70 7479  ways be an empty
-00013e40: 206f 7220 6120 636f 6d70 6c65 7465 2067   or a complete g
-00013e50: 7261 7068 2072 6573 7065 6374 6976 656c  raph respectivel
-00013e60: 792e 0a2f 2f2f 0a2f 2f2f 2054 6869 7320  y..///./// This 
-00013e70: 616c 676f 7269 7468 6d20 6861 7320 6120  algorithm has a 
-00013e80: 7469 6d65 2063 6f6d 706c 6578 6974 7920  time complexity 
-00013e90: 6f66 203a 6d61 7468 3a60 4f28 6e20 2b20  of :math:`O(n + 
-00013ea0: 6d29 600a 2f2f 2f0a 2f2f 2f20 3a70 6172  m)`.///./// :par
-00013eb0: 616d 2069 6e74 206e 756d 5f6e 6f64 6573  am int num_nodes
-00013ec0: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
-00013ed0: 6e6f 6465 7320 746f 2063 7265 6174 6520  nodes to create 
-00013ee0: 696e 2074 6865 2067 7261 7068 0a2f 2f2f  in the graph.///
-00013ef0: 203a 7061 7261 6d20 696e 7420 6e75 6d5f   :param int num_
-00013f00: 6564 6765 733a 2054 6865 206e 756d 6265  edges: The numbe
-00013f10: 7220 6f66 2065 6467 6573 2074 6f20 6372  r of edges to cr
-00013f20: 6561 7465 2069 6e20 7468 6520 6772 6170  eate in the grap
-00013f30: 680a 2f2f 2f20 3a70 6172 616d 2069 6e74  h./// :param int
-00013f40: 2073 6565 643a 2041 6e20 6f70 7469 6f6e   seed: An option
-00013f50: 616c 2073 6565 6420 746f 2075 7365 2066  al seed to use f
-00013f60: 6f72 2074 6865 2072 616e 646f 6d20 6e75  or the random nu
-00013f70: 6d62 6572 2067 656e 6572 6174 6f72 0a2f  mber generator./
-00013f80: 2f2f 0a2f 2f2f 203a 7265 7475 726e 3a20  //./// :return: 
-00013f90: 4120 5079 4469 4772 6170 6820 6f62 6a65  A PyDiGraph obje
-00013fa0: 6374 0a2f 2f2f 203a 7274 7970 653a 2050  ct./// :rtype: P
-00013fb0: 7944 6947 7261 7068 0a2f 2f2f 0a23 5b70  yDiGraph.///.#[p
-00013fc0: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
-00013fd0: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
-00013fe0: 6e75 6d5f 6e6f 6465 732c 206e 756d 5f65  num_nodes, num_e
-00013ff0: 6467 6573 2c20 7365 6564 3d4e 6f6e 652c  dges, seed=None,
-00014000: 202f 2922 5d0a 7075 6220 666e 2064 6972   /)"].pub fn dir
-00014010: 6563 7465 645f 676e 6d5f 7261 6e64 6f6d  ected_gnm_random
-00014020: 5f67 7261 7068 280a 2020 2020 7079 3a20  _graph(.    py: 
-00014030: 5079 7468 6f6e 2c0a 2020 2020 6e75 6d5f  Python,.    num_
-00014040: 6e6f 6465 733a 2069 7369 7a65 2c0a 2020  nodes: isize,.  
-00014050: 2020 6e75 6d5f 6564 6765 733a 2069 7369    num_edges: isi
-00014060: 7a65 2c0a 2020 2020 7365 6564 3a20 4f70  ze,.    seed: Op
-00014070: 7469 6f6e 3c75 3634 3e2c 0a29 202d 3e20  tion<u64>,.) -> 
-00014080: 5079 5265 7375 6c74 3c64 6967 7261 7068  PyResult<digraph
-00014090: 3a3a 5079 4469 4772 6170 683e 207b 0a20  ::PyDiGraph> {. 
-000140a0: 2020 2069 6620 6e75 6d5f 6e6f 6465 7320     if num_nodes 
-000140b0: 3c3d 2030 207b 0a20 2020 2020 2020 2072  <= 0 {.        r
-000140c0: 6574 7572 6e20 4572 7228 5079 5661 6c75  eturn Err(PyValu
-000140d0: 6545 7272 6f72 3a3a 6e65 775f 6572 7228  eError::new_err(
-000140e0: 226e 756d 5f6e 6f64 6573 206d 7573 7420  "num_nodes must 
-000140f0: 6265 203e 2030 2229 293b 0a20 2020 207d  be > 0"));.    }
-00014100: 0a20 2020 2069 6620 6e75 6d5f 6564 6765  .    if num_edge
-00014110: 7320 3c20 3020 7b0a 2020 2020 2020 2020  s < 0 {.        
-00014120: 7265 7475 726e 2045 7272 2850 7956 616c  return Err(PyVal
-00014130: 7565 4572 726f 723a 3a6e 6577 5f65 7272  ueError::new_err
-00014140: 2822 6e75 6d5f 6564 6765 7320 6d75 7374  ("num_edges must
-00014150: 2062 6520 3e3d 2030 2229 293b 0a20 2020   be >= 0"));.   
-00014160: 207d 0a20 2020 206c 6574 206d 7574 2072   }.    let mut r
-00014170: 6e67 3a20 5063 6736 3420 3d20 6d61 7463  ng: Pcg64 = matc
-00014180: 6820 7365 6564 207b 0a20 2020 2020 2020  h seed {.       
-00014190: 2053 6f6d 6528 7365 6564 2920 3d3e 2050   Some(seed) => P
-000141a0: 6367 3634 3a3a 7365 6564 5f66 726f 6d5f  cg64::seed_from_
-000141b0: 7536 3428 7365 6564 292c 0a20 2020 2020  u64(seed),.     
-000141c0: 2020 204e 6f6e 6520 3d3e 2050 6367 3634     None => Pcg64
-000141d0: 3a3a 6672 6f6d 5f65 6e74 726f 7079 2829  ::from_entropy()
-000141e0: 2c0a 2020 2020 7d3b 0a20 2020 206c 6574  ,.    };.    let
-000141f0: 206d 7574 2069 6e6e 6572 5f67 7261 7068   mut inner_graph
-00014200: 203d 2053 7461 626c 6544 6947 7261 7068   = StableDiGraph
-00014210: 3a3a 3c50 794f 626a 6563 742c 2050 794f  ::<PyObject, PyO
-00014220: 626a 6563 743e 3a3a 6e65 7728 293b 0a20  bject>::new();. 
-00014230: 2020 2066 6f72 2078 2069 6e20 302e 2e6e     for x in 0..n
-00014240: 756d 5f6e 6f64 6573 207b 0a20 2020 2020  um_nodes {.     
-00014250: 2020 2069 6e6e 6572 5f67 7261 7068 2e61     inner_graph.a
-00014260: 6464 5f6e 6f64 6528 782e 746f 5f6f 626a  dd_node(x.to_obj
-00014270: 6563 7428 7079 2929 3b0a 2020 2020 7d0a  ect(py));.    }.
-00014280: 2020 2020 2f2f 2069 6620 6e75 6d62 6572      // if number
-00014290: 206f 6620 6564 6765 7320 746f 2062 6520   of edges to be 
-000142a0: 6372 6561 7465 6420 6973 203e 3d20 6d61  created is >= ma
-000142b0: 782c 0a20 2020 202f 2f20 6176 6f69 6420  x,.    // avoid 
-000142c0: 7261 6e64 6f6d 6c79 206d 6973 7365 6420  randomly missed 
-000142d0: 7472 6961 6c73 2061 6e64 2064 6972 6563  trials and direc
-000142e0: 746c 7920 6164 6420 6564 6765 7320 6265  tly add edges be
-000142f0: 7477 6565 6e20 6576 6572 7920 6e6f 6465  tween every node
-00014300: 0a20 2020 2069 6620 6e75 6d5f 6564 6765  .    if num_edge
-00014310: 7320 3e3d 206e 756d 5f6e 6f64 6573 202a  s >= num_nodes *
-00014320: 2028 6e75 6d5f 6e6f 6465 7320 2d20 3129   (num_nodes - 1)
-00014330: 207b 0a20 2020 2020 2020 2066 6f72 2075   {.        for u
-00014340: 2069 6e20 302e 2e6e 756d 5f6e 6f64 6573   in 0..num_nodes
-00014350: 207b 0a20 2020 2020 2020 2020 2020 2066   {.            f
-00014360: 6f72 2076 2069 6e20 302e 2e6e 756d 5f6e  or v in 0..num_n
-00014370: 6f64 6573 207b 0a20 2020 2020 2020 2020  odes {.         
-00014380: 2020 2020 2020 202f 2f20 6176 6f69 6420         // avoid 
-00014390: 7365 6c66 2d6c 6f6f 7073 0a20 2020 2020  self-loops.     
-000143a0: 2020 2020 2020 2020 2020 2069 6620 7520             if u 
-000143b0: 213d 2076 207b 0a20 2020 2020 2020 2020  != v {.         
-000143c0: 2020 2020 2020 2020 2020 206c 6574 2075             let u
-000143d0: 5f69 6e64 6578 203d 204e 6f64 6549 6e64  _index = NodeInd
-000143e0: 6578 3a3a 6e65 7728 7520 6173 2075 7369  ex::new(u as usi
-000143f0: 7a65 293b 0a20 2020 2020 2020 2020 2020  ze);.           
-00014400: 2020 2020 2020 2020 206c 6574 2076 5f69           let v_i
-00014410: 6e64 6578 203d 204e 6f64 6549 6e64 6578  ndex = NodeIndex
-00014420: 3a3a 6e65 7728 7620 6173 2075 7369 7a65  ::new(v as usize
-00014430: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-00014440: 2020 2020 2020 2069 6e6e 6572 5f67 7261         inner_gra
-00014450: 7068 2e61 6464 5f65 6467 6528 755f 696e  ph.add_edge(u_in
-00014460: 6465 782c 2076 5f69 6e64 6578 2c20 7079  dex, v_index, py
-00014470: 2e4e 6f6e 6528 2929 3b0a 2020 2020 2020  .None());.      
-00014480: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-00014490: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000144a0: 2020 7d0a 2020 2020 7d20 656c 7365 207b    }.    } else {
-000144b0: 0a20 2020 2020 2020 206c 6574 206d 7574  .        let mut
-000144c0: 2063 7265 6174 6564 5f65 6467 6573 3a20   created_edges: 
-000144d0: 6973 697a 6520 3d20 303b 0a20 2020 2020  isize = 0;.     
-000144e0: 2020 206c 6574 2062 6574 7765 656e 203d     let between =
-000144f0: 2055 6e69 666f 726d 3a3a 6e65 7728 302c   Uniform::new(0,
-00014500: 206e 756d 5f6e 6f64 6573 293b 0a20 2020   num_nodes);.   
-00014510: 2020 2020 2077 6869 6c65 2063 7265 6174       while creat
-00014520: 6564 5f65 6467 6573 203c 206e 756d 5f65  ed_edges < num_e
-00014530: 6467 6573 207b 0a20 2020 2020 2020 2020  dges {.         
-00014540: 2020 206c 6574 2075 203d 2062 6574 7765     let u = betwe
-00014550: 656e 2e73 616d 706c 6528 266d 7574 2072  en.sample(&mut r
-00014560: 6e67 293b 0a20 2020 2020 2020 2020 2020  ng);.           
-00014570: 206c 6574 2076 203d 2062 6574 7765 656e   let v = between
-00014580: 2e73 616d 706c 6528 266d 7574 2072 6e67  .sample(&mut rng
-00014590: 293b 0a20 2020 2020 2020 2020 2020 206c  );.            l
-000145a0: 6574 2075 5f69 6e64 6578 203d 204e 6f64  et u_index = Nod
-000145b0: 6549 6e64 6578 3a3a 6e65 7728 7520 6173  eIndex::new(u as
-000145c0: 2075 7369 7a65 293b 0a20 2020 2020 2020   usize);.       
-000145d0: 2020 2020 206c 6574 2076 5f69 6e64 6578       let v_index
-000145e0: 203d 204e 6f64 6549 6e64 6578 3a3a 6e65   = NodeIndex::ne
-000145f0: 7728 7620 6173 2075 7369 7a65 293b 0a20  w(v as usize);. 
-00014600: 2020 2020 2020 2020 2020 202f 2f20 6176             // av
-00014610: 6f69 6420 7365 6c66 2d6c 6f6f 7073 2061  oid self-loops a
-00014620: 6e64 206d 756c 7469 2d67 7261 7068 730a  nd multi-graphs.
-00014630: 2020 2020 2020 2020 2020 2020 6966 2075              if u
-00014640: 2021 3d20 7620 2626 2069 6e6e 6572 5f67   != v && inner_g
-00014650: 7261 7068 2e66 696e 645f 6564 6765 2875  raph.find_edge(u
-00014660: 5f69 6e64 6578 2c20 765f 696e 6465 7829  _index, v_index)
-00014670: 2e69 735f 6e6f 6e65 2829 207b 0a20 2020  .is_none() {.   
-00014680: 2020 2020 2020 2020 2020 2020 2069 6e6e               inn
-00014690: 6572 5f67 7261 7068 2e61 6464 5f65 6467  er_graph.add_edg
-000146a0: 6528 755f 696e 6465 782c 2076 5f69 6e64  e(u_index, v_ind
-000146b0: 6578 2c20 7079 2e4e 6f6e 6528 2929 3b0a  ex, py.None());.
-000146c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146d0: 6372 6561 7465 645f 6564 6765 7320 2b3d  created_edges +=
-000146e0: 2031 3b0a 2020 2020 2020 2020 2020 2020   1;.            
-000146f0: 7d0a 2020 2020 2020 2020 7d0a 2020 2020  }.        }.    
-00014700: 7d0a 2020 2020 6c65 7420 6772 6170 6820  }.    let graph 
-00014710: 3d20 6469 6772 6170 683a 3a50 7944 6947  = digraph::PyDiG
-00014720: 7261 7068 207b 0a20 2020 2020 2020 2067  raph {.        g
-00014730: 7261 7068 3a20 696e 6e65 725f 6772 6170  raph: inner_grap
-00014740: 682c 0a20 2020 2020 2020 2063 7963 6c65  h,.        cycle
-00014750: 5f73 7461 7465 3a20 616c 676f 3a3a 4466  _state: algo::Df
-00014760: 7353 7061 6365 3a3a 6465 6661 756c 7428  sSpace::default(
-00014770: 292c 0a20 2020 2020 2020 2063 6865 636b  ),.        check
-00014780: 5f63 7963 6c65 3a20 6661 6c73 652c 0a20  _cycle: false,. 
-00014790: 2020 2020 2020 206e 6f64 655f 7265 6d6f         node_remo
-000147a0: 7665 643a 2066 616c 7365 2c0a 2020 2020  ved: false,.    
-000147b0: 2020 2020 6d75 6c74 6967 7261 7068 3a20      multigraph: 
-000147c0: 7472 7565 2c0a 2020 2020 7d3b 0a20 2020  true,.    };.   
-000147d0: 204f 6b28 6772 6170 6829 0a7d 0a0a 2f2f   Ok(graph).}..//
-000147e0: 2f20 5265 7475 726e 2061 203a 6d61 7468  / Return a :math
-000147f0: 3a60 475f 7b6e 6d7d 6020 6f66 2061 6e20  :`G_{nm}` of an 
-00014800: 756e 6469 7265 6374 6564 2067 7261 7068  undirected graph
-00014810: 0a2f 2f2f 0a2f 2f2f 2047 656e 6572 6174  .///./// Generat
-00014820: 6573 2061 2072 616e 646f 6d20 756e 6469  es a random undi
-00014830: 7265 6374 6564 2067 7261 7068 206f 7574  rected graph out
-00014840: 206f 6620 616c 6c20 7468 6520 706f 7373   of all the poss
-00014850: 6962 6c65 2067 7261 7068 7320 7769 7468  ible graphs with
-00014860: 203a 6d61 7468 3a60 6e60 206e 6f64 6573   :math:`n` nodes
-00014870: 2061 6e64 0a2f 2f2f 203a 6d61 7468 3a60   and./// :math:`
-00014880: 6d60 2065 6467 6573 2e20 5468 6520 6765  m` edges. The ge
-00014890: 6e65 7261 7465 6420 6772 6170 6820 7769  nerated graph wi
-000148a0: 6c6c 206e 6f74 2062 6520 6120 6d75 6c74  ll not be a mult
-000148b0: 6967 7261 7068 2061 6e64 2077 696c 6c20  igraph and will 
-000148c0: 6e6f 7420 6861 7665 2073 656c 6620 6c6f  not have self lo
-000148d0: 6f70 732e 0a2f 2f2f 0a2f 2f2f 2046 6f72  ops..///./// For
-000148e0: 203a 6d61 7468 3a60 6e60 206e 6f64 6573   :math:`n` nodes
-000148f0: 2c20 7468 6520 6d61 7869 6d75 6d20 6564  , the maximum ed
-00014900: 6765 7320 7468 6174 2063 616e 2062 6520  ges that can be 
-00014910: 7265 7475 726e 6564 2069 7320 3a6d 6174  returned is :mat
-00014920: 683a 606e 2028 6e20 2d20 3129 2f32 602e  h:`n (n - 1)/2`.
-00014930: 0a2f 2f2f 2050 6173 7369 6e67 203a 6d61  ./// Passing :ma
-00014940: 7468 3a60 6d60 2068 6967 6865 7220 7468  th:`m` higher th
-00014950: 616e 2074 6861 7420 7769 6c6c 2073 7469  an that will sti
-00014960: 6c6c 2072 6574 7572 6e20 7468 6520 6d61  ll return the ma
-00014970: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
-00014980: 6564 6765 732e 0a2f 2f2f 2049 6620 3a6d  edges../// If :m
-00014990: 6174 683a 606d 203d 2030 602c 2074 6865  ath:`m = 0`, the
-000149a0: 2072 6574 7572 6e65 6420 6772 6170 6820   returned graph 
-000149b0: 7769 6c6c 2061 6c77 6179 7320 6265 2065  will always be e
-000149c0: 6d70 7479 2028 6e6f 2065 6467 6573 292e  mpty (no edges).
-000149d0: 0a2f 2f2f 2057 6865 6e20 6120 7365 6564  ./// When a seed
-000149e0: 2069 7320 7072 6f76 6964 6564 2c20 7468   is provided, th
-000149f0: 6520 7265 7375 6c74 7320 6172 6520 7265  e results are re
-00014a00: 7072 6f64 7563 6962 6c65 2e20 5061 7373  producible. Pass
-00014a10: 696e 6720 6120 7365 6564 2077 6865 6e20  ing a seed when 
-00014a20: 3a6d 6174 683a 606d 203d 2030 600a 2f2f  :math:`m = 0`.//
-00014a30: 2f20 6f72 203a 6d61 7468 3a60 6d20 3e3d  / or :math:`m >=
-00014a40: 206e 2028 6e20 2d20 3129 2f32 6020 6861   n (n - 1)/2` ha
-00014a50: 7320 6e6f 2065 6666 6563 742c 2061 7320  s no effect, as 
-00014a60: 7468 6520 7265 7375 6c74 2077 696c 6c20  the result will 
-00014a70: 616c 7761 7973 2062 6520 616e 2065 6d70  always be an emp
-00014a80: 7479 206f 7220 6120 636f 6d70 6c65 7465  ty or a complete
-00014a90: 2067 7261 7068 2072 6573 7065 6374 6976   graph respectiv
-00014aa0: 656c 792e 0a2f 2f2f 0a2f 2f2f 2054 6869  ely..///./// Thi
-00014ab0: 7320 616c 676f 7269 7468 6d20 6861 7320  s algorithm has 
-00014ac0: 6120 7469 6d65 2063 6f6d 706c 6578 6974  a time complexit
-00014ad0: 7920 6f66 203a 6d61 7468 3a60 4f28 6e20  y of :math:`O(n 
-00014ae0: 2b20 6d29 600a 2f2f 2f0a 2f2f 2f20 3a70  + m)`.///./// :p
-00014af0: 6172 616d 2069 6e74 206e 756d 5f6e 6f64  aram int num_nod
-00014b00: 6573 3a20 5468 6520 6e75 6d62 6572 206f  es: The number o
-00014b10: 6620 6e6f 6465 7320 746f 2063 7265 6174  f nodes to creat
-00014b20: 6520 696e 2074 6865 2067 7261 7068 0a2f  e in the graph./
-00014b30: 2f2f 203a 7061 7261 6d20 696e 7420 6e75  // :param int nu
-00014b40: 6d5f 6564 6765 733a 2054 6865 206e 756d  m_edges: The num
-00014b50: 6265 7220 6f66 2065 6467 6573 2074 6f20  ber of edges to 
-00014b60: 6372 6561 7465 2069 6e20 7468 6520 6772  create in the gr
-00014b70: 6170 680a 2f2f 2f20 3a70 6172 616d 2069  aph./// :param i
-00014b80: 6e74 2073 6565 643a 2041 6e20 6f70 7469  nt seed: An opti
-00014b90: 6f6e 616c 2073 6565 6420 746f 2075 7365  onal seed to use
-00014ba0: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
-00014bb0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
-00014bc0: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
-00014bd0: 3a20 4120 5079 4772 6170 6820 6f62 6a65  : A PyGraph obje
-00014be0: 6374 0a2f 2f2f 203a 7274 7970 653a 2050  ct./// :rtype: P
-00014bf0: 7947 7261 7068 0a0a 235b 7079 6675 6e63  yGraph..#[pyfunc
-00014c00: 7469 6f6e 5d0a 235b 7465 7874 5f73 6967  tion].#[text_sig
-00014c10: 6e61 7475 7265 203d 2022 286e 756d 5f6e  nature = "(num_n
-00014c20: 6f64 6573 2c20 7072 6f62 6162 696c 6974  odes, probabilit
-00014c30: 792c 2073 6565 643d 4e6f 6e65 2c20 2f29  y, seed=None, /)
-00014c40: 225d 0a70 7562 2066 6e20 756e 6469 7265  "].pub fn undire
-00014c50: 6374 6564 5f67 6e6d 5f72 616e 646f 6d5f  cted_gnm_random_
-00014c60: 6772 6170 6828 0a20 2020 2070 793a 2050  graph(.    py: P
-00014c70: 7974 686f 6e2c 0a20 2020 206e 756d 5f6e  ython,.    num_n
-00014c80: 6f64 6573 3a20 6973 697a 652c 0a20 2020  odes: isize,.   
-00014c90: 206e 756d 5f65 6467 6573 3a20 6973 697a   num_edges: isiz
-00014ca0: 652c 0a20 2020 2073 6565 643a 204f 7074  e,.    seed: Opt
-00014cb0: 696f 6e3c 7536 343e 2c0a 2920 2d3e 2050  ion<u64>,.) -> P
-00014cc0: 7952 6573 756c 743c 6772 6170 683a 3a50  yResult<graph::P
-00014cd0: 7947 7261 7068 3e20 7b0a 2020 2020 6966  yGraph> {.    if
-00014ce0: 206e 756d 5f6e 6f64 6573 203c 3d20 3020   num_nodes <= 0 
-00014cf0: 7b0a 2020 2020 2020 2020 7265 7475 726e  {.        return
-00014d00: 2045 7272 2850 7956 616c 7565 4572 726f   Err(PyValueErro
-00014d10: 723a 3a6e 6577 5f65 7272 2822 6e75 6d5f  r::new_err("num_
-00014d20: 6e6f 6465 7320 6d75 7374 2062 6520 3e20  nodes must be > 
-00014d30: 3022 2929 3b0a 2020 2020 7d0a 2020 2020  0"));.    }.    
-00014d40: 6966 206e 756d 5f65 6467 6573 203c 2030  if num_edges < 0
-00014d50: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
-00014d60: 6e20 4572 7228 5079 5661 6c75 6545 7272  n Err(PyValueErr
-00014d70: 6f72 3a3a 6e65 775f 6572 7228 226e 756d  or::new_err("num
-00014d80: 5f65 6467 6573 206d 7573 7420 6265 203e  _edges must be >
-00014d90: 3d20 3022 2929 3b0a 2020 2020 7d0a 2020  = 0"));.    }.  
-00014da0: 2020 6c65 7420 6d75 7420 726e 673a 2050    let mut rng: P
-00014db0: 6367 3634 203d 206d 6174 6368 2073 6565  cg64 = match see
-00014dc0: 6420 7b0a 2020 2020 2020 2020 536f 6d65  d {.        Some
-00014dd0: 2873 6565 6429 203d 3e20 5063 6736 343a  (seed) => Pcg64:
-00014de0: 3a73 6565 645f 6672 6f6d 5f75 3634 2873  :seed_from_u64(s
-00014df0: 6565 6429 2c0a 2020 2020 2020 2020 4e6f  eed),.        No
-00014e00: 6e65 203d 3e20 5063 6736 343a 3a66 726f  ne => Pcg64::fro
-00014e10: 6d5f 656e 7472 6f70 7928 292c 0a20 2020  m_entropy(),.   
-00014e20: 207d 3b0a 2020 2020 6c65 7420 6d75 7420   };.    let mut 
-00014e30: 696e 6e65 725f 6772 6170 6820 3d20 5374  inner_graph = St
-00014e40: 6162 6c65 556e 4772 6170 683a 3a3c 5079  ableUnGraph::<Py
-00014e50: 4f62 6a65 6374 2c20 5079 4f62 6a65 6374  Object, PyObject
-00014e60: 3e3a 3a64 6566 6175 6c74 2829 3b0a 2020  >::default();.  
-00014e70: 2020 666f 7220 7820 696e 2030 2e2e 6e75    for x in 0..nu
-00014e80: 6d5f 6e6f 6465 7320 7b0a 2020 2020 2020  m_nodes {.      
-00014e90: 2020 696e 6e65 725f 6772 6170 682e 6164    inner_graph.ad
-00014ea0: 645f 6e6f 6465 2878 2e74 6f5f 6f62 6a65  d_node(x.to_obje
-00014eb0: 6374 2870 7929 293b 0a20 2020 207d 0a20  ct(py));.    }. 
-00014ec0: 2020 202f 2f20 6966 206e 756d 6265 7220     // if number 
-00014ed0: 6f66 2065 6467 6573 2074 6f20 6265 2063  of edges to be c
-00014ee0: 7265 6174 6564 2069 7320 3e3d 206d 6178  reated is >= max
-00014ef0: 2c0a 2020 2020 2f2f 2061 766f 6964 2072  ,.    // avoid r
-00014f00: 616e 646f 6d6c 7920 6d69 7373 6564 2074  andomly missed t
-00014f10: 7269 616c 7320 616e 6420 6469 7265 6374  rials and direct
-00014f20: 6c79 2061 6464 2065 6467 6573 2062 6574  ly add edges bet
-00014f30: 7765 656e 2065 7665 7279 206e 6f64 650a  ween every node.
-00014f40: 2020 2020 6966 206e 756d 5f65 6467 6573      if num_edges
-00014f50: 203e 3d20 6e75 6d5f 6e6f 6465 7320 2a20   >= num_nodes * 
-00014f60: 286e 756d 5f6e 6f64 6573 202d 2031 2920  (num_nodes - 1) 
-00014f70: 2f20 3220 7b0a 2020 2020 2020 2020 666f  / 2 {.        fo
-00014f80: 7220 7520 696e 2030 2e2e 6e75 6d5f 6e6f  r u in 0..num_no
-00014f90: 6465 7320 7b0a 2020 2020 2020 2020 2020  des {.          
-00014fa0: 2020 666f 7220 7620 696e 2075 202b 2031    for v in u + 1
-00014fb0: 2e2e 6e75 6d5f 6e6f 6465 7320 7b0a 2020  ..num_nodes {.  
-00014fc0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00014fd0: 7420 755f 696e 6465 7820 3d20 4e6f 6465  t u_index = Node
-00014fe0: 496e 6465 783a 3a6e 6577 2875 2061 7320  Index::new(u as 
-00014ff0: 7573 697a 6529 3b0a 2020 2020 2020 2020  usize);.        
-00015000: 2020 2020 2020 2020 6c65 7420 765f 696e          let v_in
-00015010: 6465 7820 3d20 4e6f 6465 496e 6465 783a  dex = NodeIndex:
-00015020: 3a6e 6577 2876 2061 7320 7573 697a 6529  :new(v as usize)
-00015030: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00015040: 2020 696e 6e65 725f 6772 6170 682e 6164    inner_graph.ad
-00015050: 645f 6564 6765 2875 5f69 6e64 6578 2c20  d_edge(u_index, 
-00015060: 765f 696e 6465 782c 2070 792e 4e6f 6e65  v_index, py.None
-00015070: 2829 293b 0a20 2020 2020 2020 2020 2020  ());.           
-00015080: 207d 0a20 2020 2020 2020 207d 0a20 2020   }.        }.   
-00015090: 207d 2065 6c73 6520 7b0a 2020 2020 2020   } else {.      
-000150a0: 2020 6c65 7420 6d75 7420 6372 6561 7465    let mut create
-000150b0: 645f 6564 6765 733a 2069 7369 7a65 203d  d_edges: isize =
-000150c0: 2030 3b0a 2020 2020 2020 2020 6c65 7420   0;.        let 
-000150d0: 6265 7477 6565 6e20 3d20 556e 6966 6f72  between = Unifor
-000150e0: 6d3a 3a6e 6577 2830 2c20 6e75 6d5f 6e6f  m::new(0, num_no
-000150f0: 6465 7329 3b0a 2020 2020 2020 2020 7768  des);.        wh
-00015100: 696c 6520 6372 6561 7465 645f 6564 6765  ile created_edge
-00015110: 7320 3c20 6e75 6d5f 6564 6765 7320 7b0a  s < num_edges {.
-00015120: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00015130: 7520 3d20 6265 7477 6565 6e2e 7361 6d70  u = between.samp
-00015140: 6c65 2826 6d75 7420 726e 6729 3b0a 2020  le(&mut rng);.  
-00015150: 2020 2020 2020 2020 2020 6c65 7420 7620            let v 
-00015160: 3d20 6265 7477 6565 6e2e 7361 6d70 6c65  = between.sample
-00015170: 2826 6d75 7420 726e 6729 3b0a 2020 2020  (&mut rng);.    
-00015180: 2020 2020 2020 2020 6c65 7420 755f 696e          let u_in
-00015190: 6465 7820 3d20 4e6f 6465 496e 6465 783a  dex = NodeIndex:
-000151a0: 3a6e 6577 2875 2061 7320 7573 697a 6529  :new(u as usize)
-000151b0: 3b0a 2020 2020 2020 2020 2020 2020 6c65  ;.            le
-000151c0: 7420 765f 696e 6465 7820 3d20 4e6f 6465  t v_index = Node
-000151d0: 496e 6465 783a 3a6e 6577 2876 2061 7320  Index::new(v as 
-000151e0: 7573 697a 6529 3b0a 2020 2020 2020 2020  usize);.        
-000151f0: 2020 2020 2f2f 2061 766f 6964 2073 656c      // avoid sel
-00015200: 662d 6c6f 6f70 7320 616e 6420 6d75 6c74  f-loops and mult
-00015210: 692d 6772 6170 6873 0a20 2020 2020 2020  i-graphs.       
-00015220: 2020 2020 2069 6620 7520 213d 2076 2026       if u != v &
-00015230: 2620 696e 6e65 725f 6772 6170 682e 6669  & inner_graph.fi
-00015240: 6e64 5f65 6467 6528 755f 696e 6465 782c  nd_edge(u_index,
-00015250: 2076 5f69 6e64 6578 292e 6973 5f6e 6f6e   v_index).is_non
-00015260: 6528 2920 7b0a 2020 2020 2020 2020 2020  e() {.          
-00015270: 2020 2020 2020 696e 6e65 725f 6772 6170        inner_grap
-00015280: 682e 6164 645f 6564 6765 2875 5f69 6e64  h.add_edge(u_ind
-00015290: 6578 2c20 765f 696e 6465 782c 2070 792e  ex, v_index, py.
-000152a0: 4e6f 6e65 2829 293b 0a20 2020 2020 2020  None());.       
-000152b0: 2020 2020 2020 2020 2063 7265 6174 6564           created
-000152c0: 5f65 6467 6573 202b 3d20 313b 0a20 2020  _edges += 1;.   
-000152d0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-000152e0: 2020 207d 0a20 2020 207d 0a20 2020 206c     }.    }.    l
-000152f0: 6574 2067 7261 7068 203d 2067 7261 7068  et graph = graph
-00015300: 3a3a 5079 4772 6170 6820 7b0a 2020 2020  ::PyGraph {.    
-00015310: 2020 2020 6772 6170 683a 2069 6e6e 6572      graph: inner
-00015320: 5f67 7261 7068 2c0a 2020 2020 2020 2020  _graph,.        
-00015330: 6e6f 6465 5f72 656d 6f76 6564 3a20 6661  node_removed: fa
-00015340: 6c73 652c 0a20 2020 2020 2020 206d 756c  lse,.        mul
-00015350: 7469 6772 6170 683a 2074 7275 652c 0a20  tigraph: true,. 
-00015360: 2020 207d 3b0a 2020 2020 4f6b 2867 7261     };.    Ok(gra
-00015370: 7068 290a 7d0a 0a2f 2f2f 2052 6574 7572  ph).}../// Retur
-00015380: 6e20 6120 6c69 7374 206f 6620 6379 636c  n a list of cycl
-00015390: 6573 2077 6869 6368 2066 6f72 6d20 6120  es which form a 
-000153a0: 6261 7369 7320 666f 7220 6379 636c 6573  basis for cycles
-000153b0: 206f 6620 6120 6769 7665 6e20 5079 4772   of a given PyGr
-000153c0: 6170 680a 2f2f 2f0a 2f2f 2f20 4120 6261  aph.///./// A ba
-000153d0: 7369 7320 666f 7220 6379 636c 6573 206f  sis for cycles o
-000153e0: 6620 6120 6772 6170 6820 6973 2061 206d  f a graph is a m
-000153f0: 696e 696d 616c 2063 6f6c 6c65 6374 696f  inimal collectio
-00015400: 6e20 6f66 0a2f 2f2f 2063 7963 6c65 7320  n of./// cycles 
-00015410: 7375 6368 2074 6861 7420 616e 7920 6379  such that any cy
-00015420: 636c 6520 696e 2074 6865 2067 7261 7068  cle in the graph
-00015430: 2063 616e 2062 6520 7772 6974 7465 6e0a   can be written.
-00015440: 2f2f 2f20 6173 2061 2073 756d 206f 6620  /// as a sum of 
-00015450: 6379 636c 6573 2069 6e20 7468 6520 6261  cycles in the ba
-00015460: 7369 732e 2020 4865 7265 2073 756d 6d61  sis.  Here summa
-00015470: 7469 6f6e 206f 6620 6379 636c 6573 0a2f  tion of cycles./
-00015480: 2f2f 2069 7320 6465 6669 6e65 6420 6173  // is defined as
-00015490: 2074 6865 2065 7863 6c75 7369 7665 206f   the exclusive o
-000154a0: 7220 6f66 2074 6865 2065 6467 6573 2e0a  r of the edges..
-000154b0: 2f2f 2f0a 2f2f 2f20 5468 6973 2069 7320  ///./// This is 
-000154c0: 6164 6170 7465 6420 6672 6f6d 2061 6c67  adapted from alg
-000154d0: 6f72 6974 686d 2043 4143 4d20 3439 3120  orithm CACM 491 
-000154e0: 5b31 5d5f 2e0a 2f2f 2f0a 2f2f 2f20 3a70  [1]_..///./// :p
-000154f0: 6172 616d 2050 7947 7261 7068 2067 7261  aram PyGraph gra
-00015500: 7068 3a20 5468 6520 6772 6170 6820 746f  ph: The graph to
-00015510: 2066 696e 6420 7468 6520 6379 636c 6520   find the cycle 
-00015520: 6261 7369 7320 696e 0a2f 2f2f 203a 7061  basis in./// :pa
-00015530: 7261 6d20 696e 7420 726f 6f74 3a20 4f70  ram int root: Op
-00015540: 7469 6f6e 616c 2069 6e64 6578 2066 6f72  tional index for
-00015550: 2073 7461 7274 696e 6720 6e6f 6465 2066   starting node f
-00015560: 6f72 2062 6173 6973 0a2f 2f2f 0a2f 2f2f  or basis.///.///
-00015570: 203a 7265 7475 726e 733a 2041 206c 6973   :returns: A lis
-00015580: 7420 6f66 2063 7963 6c65 206c 6973 7473  t of cycle lists
-00015590: 2e20 4561 6368 206c 6973 7420 6973 2061  . Each list is a
-000155a0: 206c 6973 7420 6f66 206e 6f64 6520 6964   list of node id
-000155b0: 7320 7768 6963 680a 2f2f 2f20 2020 2020  s which.///     
-000155c0: 666f 726d 7320 6120 6379 636c 6520 286c  forms a cycle (l
-000155d0: 6f6f 7029 2069 6e20 7468 6520 696e 7075  oop) in the inpu
-000155e0: 7420 6772 6170 680a 2f2f 2f20 3a72 7479  t graph./// :rty
-000155f0: 7065 3a20 6c69 7374 0a2f 2f2f 0a2f 2f2f  pe: list.///.///
-00015600: 202e 2e20 5b31 5d20 5061 746f 6e2c 204b   .. [1] Paton, K
-00015610: 2e20 416e 2061 6c67 6f72 6974 686d 2066  . An algorithm f
-00015620: 6f72 2066 696e 6469 6e67 2061 2066 756e  or finding a fun
-00015630: 6461 6d65 6e74 616c 2073 6574 206f 660a  damental set of.
-00015640: 2f2f 2f20 2020 2063 7963 6c65 7320 6f66  ///    cycles of
-00015650: 2061 2067 7261 7068 2e20 436f 6d6d 2e20   a graph. Comm. 
-00015660: 4143 4d20 3132 2c20 3920 2853 6570 7420  ACM 12, 9 (Sept 
-00015670: 3139 3639 292c 2035 3134 2d35 3138 2e0a  1969), 514-518..
-00015680: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
-00015690: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
-000156a0: 2022 2867 7261 7068 2c20 2f2c 2072 6f6f   "(graph, /, roo
-000156b0: 743d 4e6f 6e65 2922 5d0a 7075 6220 666e  t=None)"].pub fn
-000156c0: 2063 7963 6c65 5f62 6173 6973 280a 2020   cycle_basis(.  
-000156d0: 2020 6772 6170 683a 2026 6772 6170 683a    graph: &graph:
-000156e0: 3a50 7947 7261 7068 2c0a 2020 2020 726f  :PyGraph,.    ro
-000156f0: 6f74 3a20 4f70 7469 6f6e 3c75 7369 7a65  ot: Option<usize
-00015700: 3e2c 0a29 202d 3e20 5665 633c 5665 633c  >,.) -> Vec<Vec<
-00015710: 7573 697a 653e 3e20 7b0a 2020 2020 6c65  usize>> {.    le
-00015720: 7420 6d75 7420 726f 6f74 5f6e 6f64 6520  t mut root_node 
-00015730: 3d20 726f 6f74 3b0a 2020 2020 6c65 7420  = root;.    let 
-00015740: 6d75 7420 6772 6170 685f 6e6f 6465 733a  mut graph_nodes:
-00015750: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
-00015760: 6578 3e20 3d0a 2020 2020 2020 2020 6772  ex> =.        gr
-00015770: 6170 682e 6772 6170 682e 6e6f 6465 5f69  aph.graph.node_i
-00015780: 6e64 6963 6573 2829 2e63 6f6c 6c65 6374  ndices().collect
-00015790: 2829 3b0a 2020 2020 6c65 7420 6d75 7420  ();.    let mut 
-000157a0: 6379 636c 6573 3a20 5665 633c 5665 633c  cycles: Vec<Vec<
-000157b0: 7573 697a 653e 3e20 3d20 5665 633a 3a6e  usize>> = Vec::n
-000157c0: 6577 2829 3b0a 2020 2020 7768 696c 6520  ew();.    while 
-000157d0: 2167 7261 7068 5f6e 6f64 6573 2e69 735f  !graph_nodes.is_
-000157e0: 656d 7074 7928 2920 7b0a 2020 2020 2020  empty() {.      
-000157f0: 2020 6c65 7420 7465 6d70 5f76 616c 7565    let temp_value
-00015800: 3a20 4e6f 6465 496e 6465 783b 0a20 2020  : NodeIndex;.   
-00015810: 2020 2020 202f 2f20 4966 2072 6f6f 745f       // If root_
-00015820: 6e6f 6465 2069 7320 6e6f 7420 7365 7420  node is not set 
-00015830: 6765 7420 616e 2061 7262 6974 7261 7279  get an arbitrary
-00015840: 206e 6f64 6520 6672 6f6d 2074 6865 2073   node from the s
-00015850: 6574 206f 6620 6772 6170 680a 2020 2020  et of graph.    
-00015860: 2020 2020 2f2f 206e 6f64 6573 2077 6527      // nodes we'
-00015870: 7665 206e 6f74 2022 6578 616d 696e 6564  ve not "examined
-00015880: 220a 2020 2020 2020 2020 6c65 7420 726f  ".        let ro
-00015890: 6f74 5f69 6e64 6578 203d 206d 6174 6368  ot_index = match
-000158a0: 2072 6f6f 745f 6e6f 6465 207b 0a20 2020   root_node {.   
-000158b0: 2020 2020 2020 2020 2053 6f6d 6528 726f           Some(ro
-000158c0: 6f74 5f76 616c 7565 2920 3d3e 204e 6f64  ot_value) => Nod
-000158d0: 6549 6e64 6578 3a3a 6e65 7728 726f 6f74  eIndex::new(root
-000158e0: 5f76 616c 7565 292c 0a20 2020 2020 2020  _value),.       
-000158f0: 2020 2020 204e 6f6e 6520 3d3e 207b 0a20       None => {. 
-00015900: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00015910: 656d 705f 7661 6c75 6520 3d20 2a67 7261  emp_value = *gra
-00015920: 7068 5f6e 6f64 6573 2e69 7465 7228 292e  ph_nodes.iter().
-00015930: 6e65 7874 2829 2e75 6e77 7261 7028 293b  next().unwrap();
-00015940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015950: 2067 7261 7068 5f6e 6f64 6573 2e72 656d   graph_nodes.rem
-00015960: 6f76 6528 2674 656d 705f 7661 6c75 6529  ove(&temp_value)
-00015970: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00015980: 2020 7465 6d70 5f76 616c 7565 0a20 2020    temp_value.   
-00015990: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-000159a0: 2020 207d 3b0a 2020 2020 2020 2020 2f2f     };.        //
-000159b0: 2053 7461 636b 2028 6965 2022 7075 7368   Stack (ie "push
-000159c0: 646f 776e 206c 6973 7422 2920 6f66 2076  down list") of v
-000159d0: 6572 7469 6365 7320 616c 7265 6164 7920  ertices already 
-000159e0: 696e 2074 6865 2073 7061 6e6e 696e 6720  in the spanning 
-000159f0: 7472 6565 0a20 2020 2020 2020 206c 6574  tree.        let
-00015a00: 206d 7574 2073 7461 636b 3a20 5665 633c   mut stack: Vec<
-00015a10: 4e6f 6465 496e 6465 783e 203d 2076 6563  NodeIndex> = vec
-00015a20: 215b 726f 6f74 5f69 6e64 6578 5d3b 0a20  ![root_index];. 
-00015a30: 2020 2020 2020 202f 2f20 4d61 7020 6f66         // Map of
-00015a40: 206e 6f64 6520 696e 6465 7820 746f 2070   node index to p
-00015a50: 7265 6465 6365 7373 6f72 206e 6f64 6520  redecessor node 
-00015a60: 696e 6465 780a 2020 2020 2020 2020 6c65  index.        le
-00015a70: 7420 6d75 7420 7072 6564 3a20 4861 7368  t mut pred: Hash
-00015a80: 4d61 703c 4e6f 6465 496e 6465 782c 204e  Map<NodeIndex, N
-00015a90: 6f64 6549 6e64 6578 3e20 3d20 4861 7368  odeIndex> = Hash
-00015aa0: 4d61 703a 3a6e 6577 2829 3b0a 2020 2020  Map::new();.    
-00015ab0: 2020 2020 7072 6564 2e69 6e73 6572 7428      pred.insert(
-00015ac0: 726f 6f74 5f69 6e64 6578 2c20 726f 6f74  root_index, root
-00015ad0: 5f69 6e64 6578 293b 0a20 2020 2020 2020  _index);.       
-00015ae0: 202f 2f20 5365 7420 6f66 2065 7861 6d69   // Set of exami
-00015af0: 6e65 6420 6e6f 6465 7320 6475 7269 6e67  ned nodes during
-00015b00: 2074 6869 7320 6974 6572 6174 696f 6e0a   this iteration.
-00015b10: 2020 2020 2020 2020 6c65 7420 6d75 7420          let mut 
-00015b20: 7573 6564 3a20 4861 7368 4d61 703c 4e6f  used: HashMap<No
-00015b30: 6465 496e 6465 782c 2048 6173 6853 6574  deIndex, HashSet
-00015b40: 3c4e 6f64 6549 6e64 6578 3e3e 203d 2048  <NodeIndex>> = H
-00015b50: 6173 684d 6170 3a3a 6e65 7728 293b 0a20  ashMap::new();. 
-00015b60: 2020 2020 2020 2075 7365 642e 696e 7365         used.inse
-00015b70: 7274 2872 6f6f 745f 696e 6465 782c 2048  rt(root_index, H
-00015b80: 6173 6853 6574 3a3a 6e65 7728 2929 3b0a  ashSet::new());.
-00015b90: 2020 2020 2020 2020 2f2f 2057 616c 6b20          // Walk 
-00015ba0: 7468 6520 7370 616e 6e69 6e67 2074 7265  the spanning tre
-00015bb0: 650a 2020 2020 2020 2020 7768 696c 6520  e.        while 
-00015bc0: 2173 7461 636b 2e69 735f 656d 7074 7928  !stack.is_empty(
-00015bd0: 2920 7b0a 2020 2020 2020 2020 2020 2020  ) {.            
-00015be0: 2f2f 2055 7365 2074 6865 206c 6173 7420  // Use the last 
-00015bf0: 656c 656d 656e 7420 6164 6465 6420 736f  element added so
-00015c00: 2074 6861 7420 6379 636c 6573 2061 7265   that cycles are
-00015c10: 2065 6173 6965 7220 746f 2066 696e 640a   easier to find.
-00015c20: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
-00015c30: 7a20 3d20 7374 6163 6b2e 706f 7028 292e  z = stack.pop().
-00015c40: 756e 7772 6170 2829 3b0a 2020 2020 2020  unwrap();.      
-00015c50: 2020 2020 2020 666f 7220 6e65 6967 6862        for neighb
-00015c60: 6f72 2069 6e20 6772 6170 682e 6772 6170  or in graph.grap
-00015c70: 682e 6e65 6967 6862 6f72 7328 7a29 207b  h.neighbors(z) {
-00015c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015c90: 202f 2f20 4120 6e65 7720 6e6f 6465 2077   // A new node w
-00015ca0: 6173 2065 6e63 6f75 6e74 6572 6564 3a0a  as encountered:.
-00015cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cc0: 6966 2021 7573 6564 2e63 6f6e 7461 696e  if !used.contain
-00015cd0: 735f 6b65 7928 266e 6569 6768 626f 7229  s_key(&neighbor)
-00015ce0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00015cf0: 2020 2020 2020 2070 7265 642e 696e 7365         pred.inse
-00015d00: 7274 286e 6569 6768 626f 722c 207a 293b  rt(neighbor, z);
-00015d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015d20: 2020 2020 2073 7461 636b 2e70 7573 6828       stack.push(
-00015d30: 6e65 6967 6862 6f72 293b 0a20 2020 2020  neighbor);.     
-00015d40: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00015d50: 6574 206d 7574 2074 656d 705f 7365 743a  et mut temp_set:
-00015d60: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
-00015d70: 6578 3e20 3d20 4861 7368 5365 743a 3a6e  ex> = HashSet::n
-00015d80: 6577 2829 3b0a 2020 2020 2020 2020 2020  ew();.          
-00015d90: 2020 2020 2020 2020 2020 7465 6d70 5f73            temp_s
-00015da0: 6574 2e69 6e73 6572 7428 7a29 3b0a 2020  et.insert(z);.  
-00015db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dc0: 2020 7573 6564 2e69 6e73 6572 7428 6e65    used.insert(ne
-00015dd0: 6967 6862 6f72 2c20 7465 6d70 5f73 6574  ighbor, temp_set
-00015de0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
-00015df0: 2020 202f 2f20 4120 7365 6c66 206c 6f6f     // A self loo
-00015e00: 703a 0a20 2020 2020 2020 2020 2020 2020  p:.             
-00015e10: 2020 207d 2065 6c73 6520 6966 207a 203d     } else if z =
-00015e20: 3d20 6e65 6967 6862 6f72 207b 0a20 2020  = neighbor {.   
-00015e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e40: 206c 6574 2063 7963 6c65 3a20 5665 633c   let cycle: Vec<
-00015e50: 7573 697a 653e 203d 2076 6563 215b 7a2e  usize> = vec![z.
-00015e60: 696e 6465 7828 295d 3b0a 2020 2020 2020  index()];.      
-00015e70: 2020 2020 2020 2020 2020 2020 2020 6379                cy
-00015e80: 636c 6573 2e70 7573 6828 6379 636c 6529  cles.push(cycle)
-00015e90: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
-00015ea0: 2020 2f2f 2041 2063 7963 6c65 2077 6173    // A cycle was
-00015eb0: 2066 6f75 6e64 3a0a 2020 2020 2020 2020   found:.        
-00015ec0: 2020 2020 2020 2020 7d20 656c 7365 2069          } else i
-00015ed0: 6620 2175 7365 642e 6765 7428 267a 292e  f !used.get(&z).
-00015ee0: 756e 7772 6170 2829 2e63 6f6e 7461 696e  unwrap().contain
-00015ef0: 7328 266e 6569 6768 626f 7229 207b 0a20  s(&neighbor) {. 
-00015f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f10: 2020 206c 6574 2070 6e20 3d20 7573 6564     let pn = used
-00015f20: 2e67 6574 2826 6e65 6967 6862 6f72 292e  .get(&neighbor).
-00015f30: 756e 7772 6170 2829 3b0a 2020 2020 2020  unwrap();.      
-00015f40: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00015f50: 7420 6d75 7420 6379 636c 653a 2056 6563  t mut cycle: Vec
-00015f60: 3c4e 6f64 6549 6e64 6578 3e20 3d20 7665  <NodeIndex> = ve
-00015f70: 6321 5b6e 6569 6768 626f 722c 207a 5d3b  c![neighbor, z];
-00015f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015f90: 2020 2020 206c 6574 206d 7574 2070 203d       let mut p =
-00015fa0: 2070 7265 642e 6765 7428 267a 292e 756e   pred.get(&z).un
-00015fb0: 7772 6170 2829 3b0a 2020 2020 2020 2020  wrap();.        
-00015fc0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-00015fd0: 6520 2170 6e2e 636f 6e74 6169 6e73 2870  e !pn.contains(p
-00015fe0: 2920 7b0a 2020 2020 2020 2020 2020 2020  ) {.            
-00015ff0: 2020 2020 2020 2020 2020 2020 6379 636c              cycl
-00016000: 652e 7075 7368 282a 7029 3b0a 2020 2020  e.push(*p);.    
-00016010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016020: 2020 2020 7020 3d20 7072 6564 2e67 6574      p = pred.get
-00016030: 2870 292e 756e 7772 6170 2829 3b0a 2020  (p).unwrap();.  
-00016040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016050: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00016060: 2020 2020 2020 2020 6379 636c 652e 7075          cycle.pu
-00016070: 7368 282a 7029 3b0a 2020 2020 2020 2020  sh(*p);.        
-00016080: 2020 2020 2020 2020 2020 2020 6379 636c              cycl
-00016090: 6573 2e70 7573 6828 6379 636c 652e 6974  es.push(cycle.it
-000160a0: 6572 2829 2e6d 6170 287c 787c 2078 2e69  er().map(|x| x.i
-000160b0: 6e64 6578 2829 292e 636f 6c6c 6563 7428  ndex()).collect(
-000160c0: 2929 3b0a 2020 2020 2020 2020 2020 2020  ));.            
-000160d0: 2020 2020 2020 2020 6c65 7420 6e65 6967          let neig
-000160e0: 6862 6f72 5f73 6574 203d 2075 7365 642e  hbor_set = used.
-000160f0: 6765 745f 6d75 7428 266e 6569 6768 626f  get_mut(&neighbo
-00016100: 7229 2e75 6e77 7261 7028 293b 0a20 2020  r).unwrap();.   
-00016110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016120: 206e 6569 6768 626f 725f 7365 742e 696e   neighbor_set.in
-00016130: 7365 7274 287a 293b 0a20 2020 2020 2020  sert(z);.       
-00016140: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00016150: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00016160: 207d 0a20 2020 2020 2020 206c 6574 206d   }.        let m
-00016170: 7574 2074 656d 705f 6861 7368 7365 743a  ut temp_hashset:
-00016180: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
-00016190: 6578 3e20 3d20 4861 7368 5365 743a 3a6e  ex> = HashSet::n
-000161a0: 6577 2829 3b0a 2020 2020 2020 2020 666f  ew();.        fo
-000161b0: 7220 6b65 7920 696e 2070 7265 642e 6b65  r key in pred.ke
-000161c0: 7973 2829 207b 0a20 2020 2020 2020 2020  ys() {.         
-000161d0: 2020 2074 656d 705f 6861 7368 7365 742e     temp_hashset.
-000161e0: 696e 7365 7274 282a 6b65 7929 3b0a 2020  insert(*key);.  
-000161f0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00016200: 6772 6170 685f 6e6f 6465 7320 3d20 6772  graph_nodes = gr
-00016210: 6170 685f 6e6f 6465 732e 6469 6666 6572  aph_nodes.differ
-00016220: 656e 6365 2826 7465 6d70 5f68 6173 6873  ence(&temp_hashs
-00016230: 6574 292e 636f 7069 6564 2829 2e63 6f6c  et).copied().col
-00016240: 6c65 6374 2829 3b0a 2020 2020 2020 2020  lect();.        
-00016250: 726f 6f74 5f6e 6f64 6520 3d20 4e6f 6e65  root_node = None
-00016260: 3b0a 2020 2020 7d0a 2020 2020 6379 636c  ;.    }.    cycl
-00016270: 6573 0a7d 0a0a 2f2f 2f20 436f 6d70 7574  es.}../// Comput
-00016280: 6520 6120 6d61 7869 6d75 6d2d 7765 6967  e a maximum-weig
-00016290: 6874 6564 206d 6174 6368 696e 6720 666f  hted matching fo
-000162a0: 7220 6120 3a63 6c61 7373 3a60 7e72 6574  r a :class:`~ret
-000162b0: 776f 726b 782e 5079 4772 6170 6860 0a2f  workx.PyGraph`./
-000162c0: 2f2f 0a2f 2f2f 2041 206d 6174 6368 696e  //./// A matchin
-000162d0: 6720 6973 2061 2073 7562 7365 7420 6f66  g is a subset of
-000162e0: 2065 6467 6573 2069 6e20 7768 6963 6820   edges in which 
-000162f0: 6e6f 206e 6f64 6520 6f63 6375 7273 206d  no node occurs m
-00016300: 6f72 6520 7468 616e 206f 6e63 652e 0a2f  ore than once../
-00016310: 2f2f 2054 6865 2077 6569 6768 7420 6f66  // The weight of
-00016320: 2061 206d 6174 6368 696e 6720 6973 2074   a matching is t
-00016330: 6865 2073 756d 206f 6620 7468 6520 7765  he sum of the we
-00016340: 6967 6874 7320 6f66 2069 7473 2065 6467  ights of its edg
-00016350: 6573 2e0a 2f2f 2f20 4120 6d61 7869 6d61  es../// A maxima
-00016360: 6c20 6d61 7463 6869 6e67 2063 616e 6e6f  l matching canno
-00016370: 7420 6164 6420 6d6f 7265 2065 6467 6573  t add more edges
-00016380: 2061 6e64 2073 7469 6c6c 2062 6520 6120   and still be a 
-00016390: 6d61 7463 6869 6e67 2e0a 2f2f 2f20 5468  matching../// Th
-000163a0: 6520 6361 7264 696e 616c 6974 7920 6f66  e cardinality of
-000163b0: 2061 206d 6174 6368 696e 6720 6973 2074   a matching is t
-000163c0: 6865 206e 756d 6265 7220 6f66 206d 6174  he number of mat
-000163d0: 6368 6564 2065 6467 6573 2e0a 2f2f 2f0a  ched edges..///.
-000163e0: 2f2f 2f20 5468 6973 2066 756e 6374 696f  /// This functio
-000163f0: 6e20 7461 6b65 7320 7469 6d65 203a 6d61  n takes time :ma
-00016400: 7468 3a60 4f28 6e5e 3329 6020 7768 6572  th:`O(n^3)` wher
-00016410: 6520 6060 6e60 6020 6973 2074 6865 206e  e ``n`` is the n
-00016420: 756d 6265 7220 6f66 206e 6f64 6573 0a2f  umber of nodes./
-00016430: 2f2f 2069 6e20 7468 6520 6772 6170 682e  // in the graph.
-00016440: 0a2f 2f2f 0a2f 2f2f 2054 6869 7320 6d65  .///./// This me
-00016450: 7468 6f64 2069 7320 6261 7365 6420 6f6e  thod is based on
-00016460: 2074 6865 2022 626c 6f73 736f 6d22 206d   the "blossom" m
-00016470: 6574 686f 6420 666f 7220 6669 6e64 696e  ethod for findin
-00016480: 6720 6175 676d 656e 7469 6e67 0a2f 2f2f  g augmenting.///
-00016490: 2070 6174 6873 2061 6e64 2074 6865 2022   paths and the "
-000164a0: 7072 696d 616c 2d64 7561 6c22 206d 6574  primal-dual" met
-000164b0: 686f 6420 666f 7220 6669 6e64 696e 6720  hod for finding 
-000164c0: 6120 6d61 7463 6869 6e67 206f 6620 6d61  a matching of ma
-000164d0: 7869 6d75 6d0a 2f2f 2f20 7765 6967 6874  ximum./// weight
-000164e0: 2c20 626f 7468 206d 6574 686f 6473 2069  , both methods i
-000164f0: 6e76 656e 7465 6420 6279 204a 6163 6b20  nvented by Jack 
-00016500: 4564 6d6f 6e64 7320 5b31 5d5f 2e0a 2f2f  Edmonds [1]_..//
-00016510: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7947  /./// :param PyG
-00016520: 7261 7068 2067 7261 7068 3a20 5468 6520  raph graph: The 
-00016530: 756e 6469 7265 6374 6564 2067 7261 7068  undirected graph
-00016540: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
-00016550: 6d61 7820 7765 6967 6874 0a2f 2f2f 2020  max weight.///  
-00016560: 2020 206d 6174 6368 696e 6720 666f 722e     matching for.
-00016570: 2045 7870 6563 7473 2074 6f20 6861 7665   Expects to have
-00016580: 206e 6f20 7061 7261 6c6c 656c 2065 6467   no parallel edg
-00016590: 6573 2028 6d75 6c74 6967 7261 7068 7320  es (multigraphs 
-000165a0: 6172 650a 2f2f 2f20 2020 2020 756e 7465  are.///     unte
-000165b0: 7374 6564 2063 7572 7265 6e74 6c79 292e  sted currently).
-000165c0: 0a2f 2f2f 203a 7061 7261 6d20 626f 6f6c  ./// :param bool
-000165d0: 206d 6178 5f63 6172 6469 6e61 6c69 7479   max_cardinality
-000165e0: 3a20 4966 2054 7275 652c 2063 6f6d 7075  : If True, compu
-000165f0: 7465 2074 6865 206d 6178 696d 756d 2d63  te the maximum-c
-00016600: 6172 6469 6e61 6c69 7479 0a2f 2f2f 2020  ardinality.///  
-00016610: 2020 206d 6174 6368 696e 6720 7769 7468     matching with
-00016620: 206d 6178 696d 756d 2077 6569 6768 7420   maximum weight 
-00016630: 616d 6f6e 6720 616c 6c20 6d61 7869 6d75  among all maximu
-00016640: 6d2d 6361 7264 696e 616c 6974 7920 6d61  m-cardinality ma
-00016650: 7463 6869 6e67 732e 0a2f 2f2f 2020 2020  tchings..///    
-00016660: 2044 6566 6175 6c74 7320 4661 6c73 652e   Defaults False.
-00016670: 0a2f 2f2f 203a 7061 7261 6d20 6361 6c6c  ./// :param call
-00016680: 6162 6c65 2077 6569 6768 745f 666e 3a20  able weight_fn: 
-00016690: 416e 206f 7074 696f 6e61 6c20 6361 6c6c  An optional call
-000166a0: 6162 6c65 2074 6861 7420 7769 6c6c 2062  able that will b
-000166b0: 6520 7061 7373 6564 2061 0a2f 2f2f 2020  e passed a.///  
-000166c0: 2020 2073 696e 676c 6520 6172 6775 6d65     single argume
-000166d0: 6e74 2074 6865 2065 6467 6520 6f62 6a65  nt the edge obje
-000166e0: 6374 2066 6f72 2065 6163 6820 6564 6765  ct for each edge
-000166f0: 2069 6e20 7468 6520 6772 6170 682e 2049   in the graph. I
-00016700: 7420 6973 0a2f 2f2f 2020 2020 2065 7870  t is.///     exp
-00016710: 6563 7465 6420 746f 2072 6574 7572 6e20  ected to return 
-00016720: 616e 2060 6069 6e74 6060 2077 6569 6768  an ``int`` weigh
-00016730: 7420 666f 7220 7468 6174 2065 6467 652e  t for that edge.
-00016740: 2046 6f72 2065 7861 6d70 6c65 2c0a 2f2f   For example,.//
-00016750: 2f20 2020 2020 6966 2074 6865 2077 6569  /     if the wei
-00016760: 6768 7473 2061 7265 2061 6c6c 2069 6e74  ghts are all int
-00016770: 6567 6572 7320 796f 7520 6361 6e20 7573  egers you can us
-00016780: 653a 2060 606c 616d 6264 6120 783a 2078  e: ``lambda x: x
-00016790: 6060 2e20 4966 206e 6f74 0a2f 2f2f 2020  ``. If not.///  
-000167a0: 2020 2073 7065 6369 6669 6564 2074 6865     specified the
-000167b0: 2076 616c 7565 2066 6f72 2060 6064 6566   value for ``def
-000167c0: 6175 6c74 5f77 6569 6768 7460 6020 7769  ault_weight`` wi
-000167d0: 6c6c 2062 6520 7573 6564 2066 6f72 2061  ll be used for a
-000167e0: 6c6c 0a2f 2f2f 2020 2020 2065 6467 6520  ll.///     edge 
-000167f0: 7765 6967 6874 732e 0a2f 2f2f 203a 7061  weights../// :pa
-00016800: 7261 6d20 696e 7420 6465 6661 756c 745f  ram int default_
-00016810: 7765 6967 6874 3a20 5468 6520 6060 696e  weight: The ``in
-00016820: 7460 6020 7661 6c75 6520 746f 2075 7365  t`` value to use
-00016830: 2066 6f72 2061 6c6c 2065 6467 6520 7765   for all edge we
-00016840: 6967 6874 730a 2f2f 2f20 2020 2020 696e  ights.///     in
-00016850: 2074 6865 2067 7261 7068 2069 6620 6060   the graph if ``
-00016860: 7765 6967 6874 5f66 6e60 6020 6973 206e  weight_fn`` is n
-00016870: 6f74 2073 7065 6369 6669 6564 2e20 4465  ot specified. De
-00016880: 6661 756c 7473 2074 6f20 6060 3160 602e  faults to ``1``.
-00016890: 0a2f 2f2f 203a 7061 7261 6d20 626f 6f6c  ./// :param bool
-000168a0: 2076 6572 6966 795f 6f70 7469 6d75 6d3a   verify_optimum:
-000168b0: 2041 2062 6f6f 6c65 616e 2066 6c61 6720   A boolean flag 
-000168c0: 746f 2072 756e 2061 2063 6865 636b 2074  to run a check t
-000168d0: 6861 7420 7468 6520 666f 756e 640a 2f2f  hat the found.//
-000168e0: 2f20 2020 2020 736f 6c75 7469 6f6e 2069  /     solution i
-000168f0: 7320 6f70 7469 6d75 6d2e 2049 6620 7365  s optimum. If se
-00016900: 7420 746f 2074 7275 6520 616e 2065 7863  t to true an exc
-00016910: 6570 7469 6f6e 2077 696c 6c20 6265 2072  eption will be r
-00016920: 6169 7365 6420 6966 0a2f 2f2f 2020 2020  aised if.///    
-00016930: 2074 6865 2066 6f75 6e64 2073 6f6c 7574   the found solut
-00016940: 696f 6e20 6973 206e 6f74 206f 7074 696d  ion is not optim
-00016950: 756d 2e20 5468 6973 2069 7320 6d6f 7374  um. This is most
-00016960: 6c79 2075 7365 6675 6c20 666f 7220 7465  ly useful for te
-00016970: 7374 696e 672e 0a2f 2f2f 0a2f 2f2f 203a  sting..///./// :
-00016980: 7265 7475 726e 733a 2041 2073 6574 206f  returns: A set o
-00016990: 6620 7475 706c 6573 206f 6674 6865 206d  f tuples ofthe m
-000169a0: 6174 6368 696e 672c 204e 6f74 6520 7468  atching, Note th
-000169b0: 6174 206f 6e6c 7920 6120 7369 6e67 6c65  at only a single
-000169c0: 0a2f 2f2f 2020 2020 2064 6972 6563 7469  .///     directi
-000169d0: 6f6e 2077 696c 6c20 6265 206c 6973 7465  on will be liste
-000169e0: 6420 696e 2074 6865 206f 7574 7075 742c  d in the output,
-000169f0: 2066 6f72 2065 7861 6d70 6c65 3a0a 2f2f   for example:.//
-00016a00: 2f20 2020 2020 6060 7b28 302c 2031 292c  /     ``{(0, 1),
-00016a10: 7d60 602e 0a2f 2f2f 203a 7274 7970 653a  }``../// :rtype:
-00016a20: 2073 6574 0a2f 2f2f 0a2f 2f2f 202e 2e20   set.///./// .. 
-00016a30: 5b31 5d20 2245 6666 6963 6965 6e74 2041  [1] "Efficient A
-00016a40: 6c67 6f72 6974 686d 7320 666f 7220 4669  lgorithms for Fi
-00016a50: 6e64 696e 6720 4d61 7869 6d75 6d20 4d61  nding Maximum Ma
-00016a60: 7463 6869 6e67 2069 6e20 4772 6170 6873  tching in Graphs
-00016a70: 222c 0a2f 2f2f 2020 2020 205a 7669 2047  ",.///     Zvi G
-00016a80: 616c 696c 2c20 4143 4d20 436f 6d70 7574  alil, ACM Comput
-00016a90: 696e 6720 5375 7276 6579 732c 2031 3938  ing Surveys, 198
-00016aa0: 362e 0a2f 2f2f 0a23 5b70 7966 756e 6374  6..///.#[pyfunct
-00016ab0: 696f 6e28 0a20 2020 206d 6178 5f63 6172  ion(.    max_car
-00016ac0: 6469 6e61 6c69 7479 203d 2022 6661 6c73  dinality = "fals
-00016ad0: 6522 2c0a 2020 2020 6465 6661 756c 745f  e",.    default_
-00016ae0: 7765 6967 6874 203d 2031 2c0a 2020 2020  weight = 1,.    
-00016af0: 7665 7269 6679 5f6f 7074 696d 756d 203d  verify_optimum =
-00016b00: 2022 6661 6c73 6522 0a29 5d0a 235b 7465   "false".)].#[te
-00016b10: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
-00016b20: 2867 7261 7068 2c20 2f2c 206d 6178 5f63  (graph, /, max_c
-00016b30: 6172 6469 6e61 6c69 7479 3d46 616c 7365  ardinality=False
-00016b40: 2c20 7765 6967 6874 5f66 6e3d 4e6f 6e65  , weight_fn=None
-00016b50: 2c20 6465 6661 756c 745f 7765 6967 6874  , default_weight
-00016b60: 3d31 2c20 7665 7269 6679 5f6f 7074 696d  =1, verify_optim
-00016b70: 756d 3d46 616c 7365 2922 5d0a 7075 6220  um=False)"].pub 
-00016b80: 666e 206d 6178 5f77 6569 6768 745f 6d61  fn max_weight_ma
-00016b90: 7463 6869 6e67 280a 2020 2020 7079 3a20  tching(.    py: 
-00016ba0: 5079 7468 6f6e 2c0a 2020 2020 6772 6170  Python,.    grap
-00016bb0: 683a 2026 6772 6170 683a 3a50 7947 7261  h: &graph::PyGra
-00016bc0: 7068 2c0a 2020 2020 6d61 785f 6361 7264  ph,.    max_card
-00016bd0: 696e 616c 6974 793a 2062 6f6f 6c2c 0a20  inality: bool,. 
-00016be0: 2020 2077 6569 6768 745f 666e 3a20 4f70     weight_fn: Op
-00016bf0: 7469 6f6e 3c50 794f 626a 6563 743e 2c0a  tion<PyObject>,.
-00016c00: 2020 2020 6465 6661 756c 745f 7765 6967      default_weig
-00016c10: 6874 3a20 6931 3238 2c0a 2020 2020 7665  ht: i128,.    ve
-00016c20: 7269 6679 5f6f 7074 696d 756d 3a20 626f  rify_optimum: bo
-00016c30: 6f6c 2c0a 2920 2d3e 2050 7952 6573 756c  ol,.) -> PyResul
-00016c40: 743c 4861 7368 5365 743c 2875 7369 7a65  t<HashSet<(usize
-00016c50: 2c20 7573 697a 6529 3e3e 207b 0a20 2020  , usize)>> {.   
-00016c60: 206d 6178 5f77 6569 6768 745f 6d61 7463   max_weight_matc
-00016c70: 6869 6e67 3a3a 6d61 785f 7765 6967 6874  hing::max_weight
-00016c80: 5f6d 6174 6368 696e 6728 0a20 2020 2020  _matching(.     
-00016c90: 2020 2070 792c 0a20 2020 2020 2020 2067     py,.        g
-00016ca0: 7261 7068 2c0a 2020 2020 2020 2020 6d61  raph,.        ma
-00016cb0: 785f 6361 7264 696e 616c 6974 792c 0a20  x_cardinality,. 
-00016cc0: 2020 2020 2020 2077 6569 6768 745f 666e         weight_fn
-00016cd0: 2c0a 2020 2020 2020 2020 6465 6661 756c  ,.        defaul
-00016ce0: 745f 7765 6967 6874 2c0a 2020 2020 2020  t_weight,.      
-00016cf0: 2020 7665 7269 6679 5f6f 7074 696d 756d    verify_optimum
-00016d00: 2c0a 2020 2020 290a 7d0a 0a2f 2f2f 2043  ,.    ).}../// C
-00016d10: 6f6d 7075 7465 2074 6865 2073 7472 6f6e  ompute the stron
-00016d20: 676c 7920 636f 6e6e 6563 7465 6420 636f  gly connected co
-00016d30: 6d70 6f6e 656e 7473 2066 6f72 2061 2064  mponents for a d
-00016d40: 6972 6563 7465 6420 6772 6170 680a 2f2f  irected graph.//
-00016d50: 2f0a 2f2f 2f20 5468 6973 2066 756e 6374  /./// This funct
-00016d60: 696f 6e20 6973 2069 6d70 6c65 6d65 6e74  ion is implement
-00016d70: 6564 2075 7369 6e67 204b 6f73 6172 616a  ed using Kosaraj
-00016d80: 7527 7320 616c 676f 7269 7468 6d0a 2f2f  u's algorithm.//
-00016d90: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
-00016da0: 6947 7261 7068 2067 7261 7068 3a20 5468  iGraph graph: Th
-00016db0: 6520 696e 7075 7420 6772 6170 6820 746f  e input graph to
-00016dc0: 2066 696e 6420 7468 6520 7374 726f 6e67   find the strong
-00016dd0: 6c79 2063 6f6e 6e65 6374 6564 0a2f 2f2f  ly connected.///
-00016de0: 2020 2020 2063 6f6d 706f 6e65 6e74 7320       components 
-00016df0: 666f 722e 0a2f 2f2f 0a2f 2f2f 203a 7265  for..///./// :re
-00016e00: 7475 726e 3a20 4120 6c69 7374 206f 6620  turn: A list of 
-00016e10: 6c69 7374 206f 6620 6e6f 6465 2069 6473  list of node ids
-00016e20: 2066 6f72 2073 7472 6f6e 676c 7920 636f   for strongly co
-00016e30: 6e6e 6563 7465 6420 636f 6d70 6f6e 656e  nnected componen
-00016e40: 7473 0a2f 2f2f 203a 7274 7970 653a 206c  ts./// :rtype: l
-00016e50: 6973 740a 235b 7079 6675 6e63 7469 6f6e  ist.#[pyfunction
-00016e60: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
-00016e70: 7265 203d 2022 2867 7261 7068 2c20 2f29  re = "(graph, /)
-00016e80: 225d 0a70 7562 2066 6e20 7374 726f 6e67  "].pub fn strong
-00016e90: 6c79 5f63 6f6e 6e65 6374 6564 5f63 6f6d  ly_connected_com
-00016ea0: 706f 6e65 6e74 7328 0a20 2020 2067 7261  ponents(.    gra
-00016eb0: 7068 3a20 2664 6967 7261 7068 3a3a 5079  ph: &digraph::Py
-00016ec0: 4469 4772 6170 682c 0a29 202d 3e20 5665  DiGraph,.) -> Ve
-00016ed0: 633c 5665 633c 7573 697a 653e 3e20 7b0a  c<Vec<usize>> {.
-00016ee0: 2020 2020 616c 676f 3a3a 6b6f 7361 7261      algo::kosara
-00016ef0: 6a75 5f73 6363 2867 7261 7068 290a 2020  ju_scc(graph).  
-00016f00: 2020 2020 2020 2e69 7465 7228 290a 2020        .iter().  
-00016f10: 2020 2020 2020 2e6d 6170 287c 787c 2078        .map(|x| x
-00016f20: 2e69 7465 7228 292e 6d61 7028 7c69 647c  .iter().map(|id|
-00016f30: 2069 642e 696e 6465 7828 2929 2e63 6f6c   id.index()).col
-00016f40: 6c65 6374 2829 290a 2020 2020 2020 2020  lect()).        
-00016f50: 2e63 6f6c 6c65 6374 2829 0a7d 0a0a 2f2f  .collect().}..//
-00016f60: 2f20 5265 7475 726e 2074 6865 2066 6972  / Return the fir
-00016f70: 7374 2063 7963 6c65 2065 6e63 6f75 6e74  st cycle encount
-00016f80: 6572 6564 2064 7572 696e 6720 4446 5320  ered during DFS 
-00016f90: 6f66 2061 2067 6976 656e 2050 7944 6947  of a given PyDiG
-00016fa0: 7261 7068 2c0a 2f2f 2f20 656d 7074 7920  raph,./// empty 
-00016fb0: 6c69 7374 2069 7320 7265 7475 726e 6564  list is returned
-00016fc0: 2069 6620 6e6f 2063 7963 6c65 2069 7320   if no cycle is 
-00016fd0: 666f 756e 640a 2f2f 2f0a 2f2f 2f20 3a70  found.///./// :p
-00016fe0: 6172 616d 2050 7944 6947 7261 7068 2067  aram PyDiGraph g
-00016ff0: 7261 7068 3a20 5468 6520 6772 6170 6820  raph: The graph 
-00017000: 746f 2066 696e 6420 7468 6520 6379 636c  to find the cycl
-00017010: 6520 696e 0a2f 2f2f 203a 7061 7261 6d20  e in./// :param 
-00017020: 696e 7420 736f 7572 6365 3a20 4f70 7469  int source: Opti
-00017030: 6f6e 616c 2069 6e64 6578 2074 6f20 6669  onal index to fi
-00017040: 6e64 2061 2063 7963 6c65 2066 6f72 2e20  nd a cycle for. 
-00017050: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
-00017060: 2061 6e0a 2f2f 2f20 2020 2020 6172 6269   an.///     arbi
-00017070: 7472 6172 7920 6e6f 6465 2077 696c 6c20  trary node will 
-00017080: 6265 2073 656c 6563 7465 6420 6672 6f6d  be selected from
-00017090: 2074 6865 2067 7261 7068 2e0a 2f2f 2f0a   the graph..///.
-000170a0: 2f2f 2f20 3a72 6574 7572 6e73 3a20 4120  /// :returns: A 
-000170b0: 6c69 7374 2064 6573 6372 6962 696e 6720  list describing 
-000170c0: 7468 6520 6379 636c 652e 2054 6865 2069  the cycle. The i
-000170d0: 6e64 6578 206f 6620 6e6f 6465 2069 6473  ndex of node ids
-000170e0: 2077 6869 6368 0a2f 2f2f 2020 2020 2066   which.///     f
-000170f0: 6f72 6d73 2061 2063 7963 6c65 2028 6c6f  orms a cycle (lo
-00017100: 6f70 2920 696e 2074 6865 2069 6e70 7574  op) in the input
-00017110: 2067 7261 7068 0a2f 2f2f 203a 7274 7970   graph./// :rtyp
-00017120: 653a 2045 6467 654c 6973 740a 235b 7079  e: EdgeList.#[py
-00017130: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
-00017140: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
-00017150: 7261 7068 2c20 2f2c 2073 6f75 7263 653d  raph, /, source=
-00017160: 4e6f 6e65 2922 5d0a 7075 6220 666e 2064  None)"].pub fn d
-00017170: 6967 7261 7068 5f66 696e 645f 6379 636c  igraph_find_cycl
-00017180: 6528 0a20 2020 2067 7261 7068 3a20 2664  e(.    graph: &d
-00017190: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
-000171a0: 682c 0a20 2020 2073 6f75 7263 653a 204f  h,.    source: O
-000171b0: 7074 696f 6e3c 7573 697a 653e 2c0a 2920  ption<usize>,.) 
-000171c0: 2d3e 2045 6467 654c 6973 7420 7b0a 2020  -> EdgeList {.  
-000171d0: 2020 6c65 7420 6d75 7420 6772 6170 685f    let mut graph_
-000171e0: 6e6f 6465 733a 2048 6173 6853 6574 3c4e  nodes: HashSet<N
-000171f0: 6f64 6549 6e64 6578 3e20 3d0a 2020 2020  odeIndex> =.    
-00017200: 2020 2020 6772 6170 682e 6772 6170 682e      graph.graph.
-00017210: 6e6f 6465 5f69 6e64 6963 6573 2829 2e63  node_indices().c
-00017220: 6f6c 6c65 6374 2829 3b0a 2020 2020 6c65  ollect();.    le
-00017230: 7420 6d75 7420 6379 636c 653a 2056 6563  t mut cycle: Vec
-00017240: 3c28 7573 697a 652c 2075 7369 7a65 293e  <(usize, usize)>
-00017250: 203d 0a20 2020 2020 2020 2056 6563 3a3a   =.        Vec::
-00017260: 7769 7468 5f63 6170 6163 6974 7928 6772  with_capacity(gr
-00017270: 6170 682e 6772 6170 682e 6564 6765 5f63  aph.graph.edge_c
-00017280: 6f75 6e74 2829 293b 0a20 2020 206c 6574  ount());.    let
-00017290: 2074 656d 705f 7661 6c75 653a 204e 6f64   temp_value: Nod
-000172a0: 6549 6e64 6578 3b0a 2020 2020 2f2f 2049  eIndex;.    // I
-000172b0: 6620 736f 7572 6365 2069 7320 6e6f 7420  f source is not 
-000172c0: 7365 7420 6765 7420 616e 2061 7262 6974  set get an arbit
-000172d0: 7261 7279 206e 6f64 6520 6672 6f6d 2074  rary node from t
-000172e0: 6865 2073 6574 206f 6620 6772 6170 680a  he set of graph.
-000172f0: 2020 2020 2f2f 206e 6f64 6573 2077 6527      // nodes we'
-00017300: 7665 206e 6f74 2022 6578 616d 696e 6564  ve not "examined
-00017310: 220a 2020 2020 6c65 7420 736f 7572 6365  ".    let source
-00017320: 5f69 6e64 6578 203d 206d 6174 6368 2073  _index = match s
-00017330: 6f75 7263 6520 7b0a 2020 2020 2020 2020  ource {.        
-00017340: 536f 6d65 2873 6f75 7263 655f 7661 6c75  Some(source_valu
-00017350: 6529 203d 3e20 4e6f 6465 496e 6465 783a  e) => NodeIndex:
-00017360: 3a6e 6577 2873 6f75 7263 655f 7661 6c75  :new(source_valu
-00017370: 6529 2c0a 2020 2020 2020 2020 4e6f 6e65  e),.        None
-00017380: 203d 3e20 7b0a 2020 2020 2020 2020 2020   => {.          
-00017390: 2020 7465 6d70 5f76 616c 7565 203d 202a    temp_value = *
-000173a0: 6772 6170 685f 6e6f 6465 732e 6974 6572  graph_nodes.iter
-000173b0: 2829 2e6e 6578 7428 292e 756e 7772 6170  ().next().unwrap
-000173c0: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
-000173d0: 6772 6170 685f 6e6f 6465 732e 7265 6d6f  graph_nodes.remo
-000173e0: 7665 2826 7465 6d70 5f76 616c 7565 293b  ve(&temp_value);
-000173f0: 0a20 2020 2020 2020 2020 2020 2074 656d  .            tem
-00017400: 705f 7661 6c75 650a 2020 2020 2020 2020  p_value.        
-00017410: 7d0a 2020 2020 7d3b 0a0a 2020 2020 2f2f  }.    };..    //
-00017420: 2053 7461 636b 2028 6965 2022 7075 7368   Stack (ie "push
-00017430: 646f 776e 206c 6973 7422 2920 6f66 2076  down list") of v
-00017440: 6572 7469 6365 7320 616c 7265 6164 7920  ertices already 
-00017450: 696e 2074 6865 2073 7061 6e6e 696e 6720  in the spanning 
-00017460: 7472 6565 0a20 2020 206c 6574 206d 7574  tree.    let mut
-00017470: 2073 7461 636b 3a20 5665 633c 4e6f 6465   stack: Vec<Node
-00017480: 496e 6465 783e 203d 2076 6563 215b 736f  Index> = vec![so
-00017490: 7572 6365 5f69 6e64 6578 5d3b 0a20 2020  urce_index];.   
-000174a0: 202f 2f20 6d61 7020 746f 2073 746f 7265   // map to store
-000174b0: 2070 6172 656e 7420 6f66 2061 206e 6f64   parent of a nod
-000174c0: 650a 2020 2020 6c65 7420 6d75 7420 7072  e.    let mut pr
-000174d0: 6564 3a20 4861 7368 4d61 703c 4e6f 6465  ed: HashMap<Node
-000174e0: 496e 6465 782c 204e 6f64 6549 6e64 6578  Index, NodeIndex
-000174f0: 3e20 3d20 4861 7368 4d61 703a 3a6e 6577  > = HashMap::new
-00017500: 2829 3b0a 2020 2020 2f2f 2061 206e 6f64  ();.    // a nod
-00017510: 6520 6973 2069 6e20 7468 6520 7669 7369  e is in the visi
-00017520: 7469 6e67 2073 6574 2069 6620 6174 206c  ting set if at l
-00017530: 6561 7374 206f 6e65 206f 6620 6974 7320  east one of its 
-00017540: 6368 696c 6420 6973 2075 6e65 7861 6d69  child is unexami
-00017550: 6e65 640a 2020 2020 6c65 7420 6d75 7420  ned.    let mut 
-00017560: 7669 7369 7469 6e67 203d 2048 6173 6853  visiting = HashS
-00017570: 6574 3a3a 6e65 7728 293b 0a20 2020 202f  et::new();.    /
-00017580: 2f20 6120 6e6f 6465 2069 7320 696e 2076  / a node is in v
-00017590: 6973 6974 6564 2073 6574 2069 6620 616c  isited set if al
-000175a0: 6c20 6f66 2069 7473 2063 6869 6c64 7265  l of its childre
-000175b0: 6e20 6861 7665 2062 6565 6e20 6578 616d  n have been exam
-000175c0: 696e 6564 0a20 2020 206c 6574 206d 7574  ined.    let mut
-000175d0: 2076 6973 6974 6564 203d 2048 6173 6853   visited = HashS
-000175e0: 6574 3a3a 6e65 7728 293b 0a20 2020 2077  et::new();.    w
-000175f0: 6869 6c65 2021 7374 6163 6b2e 6973 5f65  hile !stack.is_e
-00017600: 6d70 7479 2829 207b 0a20 2020 2020 2020  mpty() {.       
-00017610: 206c 6574 206d 7574 207a 203d 202a 7374   let mut z = *st
-00017620: 6163 6b2e 6c61 7374 2829 2e75 6e77 7261  ack.last().unwra
-00017630: 7028 293b 0a20 2020 2020 2020 2076 6973  p();.        vis
-00017640: 6974 696e 672e 696e 7365 7274 287a 293b  iting.insert(z);
-00017650: 0a0a 2020 2020 2020 2020 6c65 7420 6368  ..        let ch
-00017660: 696c 6472 656e 203d 2067 7261 7068 0a20  ildren = graph. 
-00017670: 2020 2020 2020 2020 2020 202e 6772 6170             .grap
-00017680: 680a 2020 2020 2020 2020 2020 2020 2e6e  h.            .n
-00017690: 6569 6768 626f 7273 5f64 6972 6563 7465  eighbors_directe
-000176a0: 6428 7a2c 2070 6574 6772 6170 683a 3a44  d(z, petgraph::D
-000176b0: 6972 6563 7469 6f6e 3a3a 4f75 7467 6f69  irection::Outgoi
-000176c0: 6e67 293b 0a0a 2020 2020 2020 2020 666f  ng);..        fo
-000176d0: 7220 6368 696c 6420 696e 2063 6869 6c64  r child in child
-000176e0: 7265 6e20 7b0a 2020 2020 2020 2020 2020  ren {.          
-000176f0: 2020 2f2f 6379 636c 6520 6973 2066 6f75    //cycle is fou
-00017700: 6e64 0a20 2020 2020 2020 2020 2020 2069  nd.            i
-00017710: 6620 7669 7369 7469 6e67 2e63 6f6e 7461  f visiting.conta
-00017720: 696e 7328 2663 6869 6c64 2920 7b0a 2020  ins(&child) {.  
-00017730: 2020 2020 2020 2020 2020 2020 2020 6379                cy
-00017740: 636c 652e 7075 7368 2828 7a2e 696e 6465  cle.push((z.inde
-00017750: 7828 292c 2063 6869 6c64 2e69 6e64 6578  x(), child.index
-00017760: 2829 2929 3b0a 2020 2020 2020 2020 2020  ()));.          
-00017770: 2020 2020 2020 2f2f 6261 636b 7472 6163        //backtrac
-00017780: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
-00017790: 2020 6c6f 6f70 207b 0a20 2020 2020 2020    loop {.       
-000177a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000177b0: 7a20 3d3d 2063 6869 6c64 207b 0a20 2020  z == child {.   
-000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177d0: 2020 2020 2063 7963 6c65 2e72 6576 6572       cycle.rever
-000177e0: 7365 2829 3b0a 2020 2020 2020 2020 2020  se();.          
-000177f0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00017800: 6561 6b3b 0a20 2020 2020 2020 2020 2020  eak;.           
-00017810: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00017820: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00017830: 7963 6c65 2e70 7573 6828 2870 7265 645b  ycle.push((pred[
-00017840: 267a 5d2e 696e 6465 7828 292c 207a 2e69  &z].index(), z.i
-00017850: 6e64 6578 2829 2929 3b0a 2020 2020 2020  ndex()));.      
-00017860: 2020 2020 2020 2020 2020 2020 2020 7a20                z 
-00017870: 3d20 7072 6564 5b26 7a5d 3b0a 2020 2020  = pred[&z];.    
-00017880: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00017890: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000178a0: 7475 726e 2045 6467 654c 6973 7420 7b20  turn EdgeList { 
-000178b0: 6564 6765 733a 2063 7963 6c65 207d 3b0a  edges: cycle };.
-000178c0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-000178d0: 2020 2020 2020 2020 2020 2f2f 6966 2061            //if a
-000178e0: 6e20 756e 6578 706c 6f72 6564 206e 6f64  n unexplored nod
-000178f0: 6520 6973 2065 6e63 6f75 6e74 6572 6564  e is encountered
-00017900: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00017910: 2176 6973 6974 6564 2e63 6f6e 7461 696e  !visited.contain
-00017920: 7328 2663 6869 6c64 2920 7b0a 2020 2020  s(&child) {.    
-00017930: 2020 2020 2020 2020 2020 2020 7374 6163              stac
-00017940: 6b2e 7075 7368 2863 6869 6c64 293b 0a20  k.push(child);. 
-00017950: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017960: 7265 642e 696e 7365 7274 2863 6869 6c64  red.insert(child
-00017970: 2c20 7a29 3b0a 2020 2020 2020 2020 2020  , z);.          
-00017980: 2020 7d0a 2020 2020 2020 2020 7d0a 0a20    }.        }.. 
-00017990: 2020 2020 2020 206c 6574 2074 6f70 203d         let top =
-000179a0: 202a 7374 6163 6b2e 6c61 7374 2829 2e75   *stack.last().u
-000179b0: 6e77 7261 7028 293b 0a20 2020 2020 2020  nwrap();.       
-000179c0: 202f 2f69 6620 6e6f 2066 7572 7468 6572   //if no further
-000179d0: 2063 6869 6c64 7265 6e20 616e 6420 6578   children and ex
-000179e0: 706c 6f72 6564 2c20 6d6f 7665 2074 6f20  plored, move to 
-000179f0: 7669 7369 7465 640a 2020 2020 2020 2020  visited.        
-00017a00: 6966 2074 6f70 2e69 6e64 6578 2829 203d  if top.index() =
-00017a10: 3d20 7a2e 696e 6465 7828 2920 7b0a 2020  = z.index() {.  
-00017a20: 2020 2020 2020 2020 2020 7374 6163 6b2e            stack.
-00017a30: 706f 7028 293b 0a20 2020 2020 2020 2020  pop();.         
-00017a40: 2020 2076 6973 6974 696e 672e 7265 6d6f     visiting.remo
-00017a50: 7665 2826 7a29 3b0a 2020 2020 2020 2020  ve(&z);.        
-00017a60: 2020 2020 7669 7369 7465 642e 696e 7365      visited.inse
-00017a70: 7274 287a 293b 0a20 2020 2020 2020 207d  rt(z);.        }
-00017a80: 0a20 2020 207d 0a20 2020 2045 6467 654c  .    }.    EdgeL
-00017a90: 6973 7420 7b20 6564 6765 733a 2063 7963  ist { edges: cyc
-00017aa0: 6c65 207d 0a7d 0a0a 666e 205f 696e 6e65  le }.}..fn _inne
-00017ab0: 725f 6973 5f6d 6174 6368 696e 6728 0a20  r_is_matching(. 
-00017ac0: 2020 2067 7261 7068 3a20 2667 7261 7068     graph: &graph
-00017ad0: 3a3a 5079 4772 6170 682c 0a20 2020 206d  ::PyGraph,.    m
-00017ae0: 6174 6368 696e 673a 2026 4861 7368 5365  atching: &HashSe
-00017af0: 743c 2875 7369 7a65 2c20 7573 697a 6529  t<(usize, usize)
-00017b00: 3e2c 0a29 202d 3e20 626f 6f6c 207b 0a20  >,.) -> bool {. 
-00017b10: 2020 206c 6574 2068 6173 5f65 6467 6520     let has_edge 
-00017b20: 3d20 7c65 3a20 2628 7573 697a 652c 2075  = |e: &(usize, u
-00017b30: 7369 7a65 297c 202d 3e20 626f 6f6c 207b  size)| -> bool {
-00017b40: 0a20 2020 2020 2020 2067 7261 7068 0a20  .        graph. 
-00017b50: 2020 2020 2020 2020 2020 202e 6772 6170             .grap
-00017b60: 680a 2020 2020 2020 2020 2020 2020 2e63  h.            .c
-00017b70: 6f6e 7461 696e 735f 6564 6765 284e 6f64  ontains_edge(Nod
-00017b80: 6549 6e64 6578 3a3a 6e65 7728 652e 3029  eIndex::new(e.0)
-00017b90: 2c20 4e6f 6465 496e 6465 783a 3a6e 6577  , NodeIndex::new
-00017ba0: 2865 2e31 2929 0a20 2020 207d 3b0a 0a20  (e.1)).    };.. 
-00017bb0: 2020 2069 6620 216d 6174 6368 696e 672e     if !matching.
-00017bc0: 6974 6572 2829 2e61 6c6c 287c 657c 2068  iter().all(|e| h
-00017bd0: 6173 5f65 6467 6528 6529 2920 7b0a 2020  as_edge(e)) {.  
-00017be0: 2020 2020 2020 7265 7475 726e 2066 616c        return fal
-00017bf0: 7365 3b0a 2020 2020 7d0a 2020 2020 6c65  se;.    }.    le
-00017c00: 7420 6d75 7420 666f 756e 643a 2048 6173  t mut found: Has
-00017c10: 6853 6574 3c75 7369 7a65 3e20 3d20 4861  hSet<usize> = Ha
-00017c20: 7368 5365 743a 3a77 6974 685f 6361 7061  shSet::with_capa
-00017c30: 6369 7479 2832 202a 206d 6174 6368 696e  city(2 * matchin
-00017c40: 672e 6c65 6e28 2929 3b0a 2020 2020 666f  g.len());.    fo
-00017c50: 7220 2876 312c 2076 3229 2069 6e20 6d61  r (v1, v2) in ma
-00017c60: 7463 6869 6e67 207b 0a20 2020 2020 2020  tching {.       
-00017c70: 2069 6620 666f 756e 642e 636f 6e74 6169   if found.contai
-00017c80: 6e73 2876 3129 207c 7c20 666f 756e 642e  ns(v1) || found.
-00017c90: 636f 6e74 6169 6e73 2876 3229 207b 0a20  contains(v2) {. 
-00017ca0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00017cb0: 6e20 6661 6c73 653b 0a20 2020 2020 2020  n false;.       
-00017cc0: 207d 0a20 2020 2020 2020 2066 6f75 6e64   }.        found
-00017cd0: 2e69 6e73 6572 7428 2a76 3129 3b0a 2020  .insert(*v1);.  
-00017ce0: 2020 2020 2020 666f 756e 642e 696e 7365        found.inse
-00017cf0: 7274 282a 7632 293b 0a20 2020 207d 0a20  rt(*v2);.    }. 
-00017d00: 2020 2074 7275 650a 7d0a 0a2f 2f2f 2043     true.}../// C
-00017d10: 6865 636b 2069 6620 6d61 7463 6869 6e67  heck if matching
-00017d20: 2069 7320 7661 6c69 6420 666f 7220 6772   is valid for gr
-00017d30: 6170 680a 2f2f 2f0a 2f2f 2f20 4120 2a6d  aph.///./// A *m
-00017d40: 6174 6368 696e 672a 2069 6e20 6120 6772  atching* in a gr
-00017d50: 6170 6820 6973 2061 2073 6574 206f 6620  aph is a set of 
-00017d60: 6564 6765 7320 696e 2077 6869 6368 206e  edges in which n
-00017d70: 6f20 7477 6f20 6469 7374 696e 6374 0a2f  o two distinct./
-00017d80: 2f2f 2065 6467 6573 2073 6861 7265 2061  // edges share a
-00017d90: 2063 6f6d 6d6f 6e20 656e 6470 6f69 6e74   common endpoint
-00017da0: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
-00017db0: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
-00017dc0: 3a20 5468 6520 6772 6170 6820 746f 2063  : The graph to c
-00017dd0: 6865 636b 2069 6620 7468 6520 6d61 7463  heck if the matc
-00017de0: 6869 6e67 2069 7320 7661 6c69 6420 666f  hing is valid fo
-00017df0: 720a 2f2f 2f20 3a70 6172 616d 2073 6574  r./// :param set
-00017e00: 206d 6174 6368 696e 673a 2041 2073 6574   matching: A set
-00017e10: 206f 6620 6e6f 6465 2069 6e64 6578 2074   of node index t
-00017e20: 7570 6c65 7320 666f 7220 6561 6368 2065  uples for each e
-00017e30: 6467 6520 696e 2074 6865 0a2f 2f2f 2020  dge in the.///  
-00017e40: 2020 206d 6174 6368 696e 672e 0a2f 2f2f     matching..///
-00017e50: 0a2f 2f2f 203a 7265 7475 726e 733a 2057  ./// :returns: W
-00017e60: 6865 7468 6572 2074 6865 2070 726f 7669  hether the provi
-00017e70: 6465 6420 6d61 7463 6869 6e67 2069 7320  ded matching is 
-00017e80: 6120 7661 6c69 6420 6d61 7463 6869 6e67  a valid matching
-00017e90: 2066 6f72 2074 6865 2067 7261 7068 0a2f   for the graph./
-00017ea0: 2f2f 203a 7274 7970 653a 2062 6f6f 6c0a  // :rtype: bool.
-00017eb0: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
-00017ec0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
-00017ed0: 2022 2867 7261 7068 2c20 6d61 7463 6869   "(graph, matchi
-00017ee0: 6e67 2c20 2f29 225d 0a70 7562 2066 6e20  ng, /)"].pub fn 
-00017ef0: 6973 5f6d 6174 6368 696e 6728 0a20 2020  is_matching(.   
-00017f00: 2067 7261 7068 3a20 2667 7261 7068 3a3a   graph: &graph::
-00017f10: 5079 4772 6170 682c 0a20 2020 206d 6174  PyGraph,.    mat
-00017f20: 6368 696e 673a 2048 6173 6853 6574 3c28  ching: HashSet<(
-00017f30: 7573 697a 652c 2075 7369 7a65 293e 2c0a  usize, usize)>,.
-00017f40: 2920 2d3e 2062 6f6f 6c20 7b0a 2020 2020  ) -> bool {.    
-00017f50: 5f69 6e6e 6572 5f69 735f 6d61 7463 6869  _inner_is_matchi
-00017f60: 6e67 2867 7261 7068 2c20 266d 6174 6368  ng(graph, &match
-00017f70: 696e 6729 0a7d 0a0a 2f2f 2f20 4368 6563  ing).}../// Chec
-00017f80: 6b20 6966 2061 206d 6174 6368 696e 6720  k if a matching 
-00017f90: 6973 2061 206d 6178 696d 616c 2028 2a2a  is a maximal (**
-00017fa0: 6e6f 742a 2a20 6d61 7869 6d75 6d29 206d  not** maximum) m
-00017fb0: 6174 6368 696e 6720 666f 7220 6120 6772  atching for a gr
-00017fc0: 6170 680a 2f2f 2f0a 2f2f 2f20 4120 2a6d  aph.///./// A *m
-00017fd0: 6178 696d 616c 206d 6174 6368 696e 672a  aximal matching*
-00017fe0: 2069 6e20 6120 6772 6170 6820 6973 2061   in a graph is a
-00017ff0: 206d 6174 6368 696e 6720 696e 2077 6869   matching in whi
-00018000: 6368 2061 6464 696e 6720 616e 790a 2f2f  ch adding any.//
-00018010: 2f20 6564 6765 2077 6f75 6c64 2063 6175  / edge would cau
-00018020: 7365 2074 6865 2073 6574 2074 6f20 6e6f  se the set to no
-00018030: 206c 6f6e 6765 7220 6265 2061 2076 616c   longer be a val
-00018040: 6964 206d 6174 6368 696e 672e 0a2f 2f2f  id matching..///
-00018050: 0a2f 2f2f 202e 2e20 6e6f 7465 3a3a 0a2f  ./// .. note::./
-00018060: 2f2f 0a2f 2f2f 2020 2054 6869 7320 6973  //.///   This is
-00018070: 206e 6f74 2063 6865 636b 696e 6720 666f   not checking fo
-00018080: 7220 6120 2a6d 6178 696d 756d 2a20 2867  r a *maximum* (g
-00018090: 6c6f 6261 6c6c 7920 6f70 7469 6d61 6c29  lobally optimal)
-000180a0: 206d 6174 6368 696e 672c 2062 7574 0a2f   matching, but./
-000180b0: 2f2f 2020 2061 202a 6d61 7869 6d61 6c2a  //   a *maximal*
-000180c0: 2028 6c6f 6361 6c6c 7920 6f70 7469 6d61   (locally optima
-000180d0: 6c29 206d 6174 6368 696e 672e 0a2f 2f2f  l) matching..///
-000180e0: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
-000180f0: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
-00018100: 2067 7261 7068 2074 6f20 6368 6563 6b20   graph to check 
-00018110: 6966 2074 6865 206d 6174 6368 696e 6720  if the matching 
-00018120: 6973 206d 6178 696d 616c 2066 6f72 2e0a  is maximal for..
-00018130: 2f2f 2f20 3a70 6172 616d 2073 6574 206d  /// :param set m
-00018140: 6174 6368 696e 673a 2041 2073 6574 206f  atching: A set o
-00018150: 6620 6e6f 6465 2069 6e64 6578 2074 7570  f node index tup
-00018160: 6c65 7320 666f 7220 6561 6368 2065 6467  les for each edg
-00018170: 6520 696e 2074 6865 0a2f 2f2f 2020 2020  e in the.///    
-00018180: 206d 6174 6368 696e 672e 0a2f 2f2f 0a2f   matching..///./
-00018190: 2f2f 203a 7265 7475 726e 733a 2057 6865  // :returns: Whe
-000181a0: 7468 6572 2074 6865 2070 726f 7669 6465  ther the provide
-000181b0: 6420 6d61 7463 6869 6e67 2069 7320 6120  d matching is a 
-000181c0: 7661 6c69 6420 6d61 7463 6869 6e67 2061  valid matching a
-000181d0: 6e64 2077 6865 7468 6572 2069 740a 2f2f  nd whether it.//
-000181e0: 2f20 2020 2020 6973 206d 6178 696d 616c  /     is maximal
-000181f0: 206f 7220 6e6f 742e 0a2f 2f2f 203a 7274   or not../// :rt
-00018200: 7970 653a 2062 6f6f 6c0a 235b 7079 6675  ype: bool.#[pyfu
-00018210: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
-00018220: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
-00018230: 7068 2c20 6d61 7463 6869 6e67 2c20 2f29  ph, matching, /)
-00018240: 225d 0a70 7562 2066 6e20 6973 5f6d 6178  "].pub fn is_max
-00018250: 696d 616c 5f6d 6174 6368 696e 6728 0a20  imal_matching(. 
-00018260: 2020 2067 7261 7068 3a20 2667 7261 7068     graph: &graph
-00018270: 3a3a 5079 4772 6170 682c 0a20 2020 206d  ::PyGraph,.    m
-00018280: 6174 6368 696e 673a 2048 6173 6853 6574  atching: HashSet
-00018290: 3c28 7573 697a 652c 2075 7369 7a65 293e  <(usize, usize)>
-000182a0: 2c0a 2920 2d3e 2062 6f6f 6c20 7b0a 2020  ,.) -> bool {.  
-000182b0: 2020 6966 2021 5f69 6e6e 6572 5f69 735f    if !_inner_is_
-000182c0: 6d61 7463 6869 6e67 2867 7261 7068 2c20  matching(graph, 
-000182d0: 266d 6174 6368 696e 6729 207b 0a20 2020  &matching) {.   
-000182e0: 2020 2020 2072 6574 7572 6e20 6661 6c73       return fals
-000182f0: 653b 0a20 2020 207d 0a20 2020 206c 6574  e;.    }.    let
-00018300: 2065 6467 655f 6c69 7374 3a20 4861 7368   edge_list: Hash
-00018310: 5365 743c 5b75 7369 7a65 3b20 325d 3e20  Set<[usize; 2]> 
-00018320: 3d20 6772 6170 680a 2020 2020 2020 2020  = graph.        
-00018330: 2e65 6467 655f 7265 6665 7265 6e63 6573  .edge_references
-00018340: 2829 0a20 2020 2020 2020 202e 6d61 7028  ().        .map(
-00018350: 7c65 6467 657c 207b 0a20 2020 2020 2020  |edge| {.       
-00018360: 2020 2020 206c 6574 206d 7574 2074 6d70       let mut tmp
-00018370: 5f61 7272 6179 203d 205b 6564 6765 2e73  _array = [edge.s
-00018380: 6f75 7263 6528 292e 696e 6465 7828 292c  ource().index(),
-00018390: 2065 6467 652e 7461 7267 6574 2829 2e69   edge.target().i
-000183a0: 6e64 6578 2829 5d3b 0a20 2020 2020 2020  ndex()];.       
-000183b0: 2020 2020 2074 6d70 5f61 7272 6179 2e73       tmp_array.s
-000183c0: 6f72 745f 756e 7374 6162 6c65 2829 3b0a  ort_unstable();.
-000183d0: 2020 2020 2020 2020 2020 2020 746d 705f              tmp_
-000183e0: 6172 7261 790a 2020 2020 2020 2020 7d29  array.        })
-000183f0: 0a20 2020 2020 2020 202e 636f 6c6c 6563  .        .collec
-00018400: 7428 293b 0a20 2020 206c 6574 206d 6174  t();.    let mat
-00018410: 6368 6564 5f65 6467 6573 3a20 4861 7368  ched_edges: Hash
-00018420: 5365 743c 5b75 7369 7a65 3b20 325d 3e20  Set<[usize; 2]> 
-00018430: 3d20 6d61 7463 6869 6e67 0a20 2020 2020  = matching.     
-00018440: 2020 202e 6974 6572 2829 0a20 2020 2020     .iter().     
-00018450: 2020 202e 6d61 7028 7c65 6467 657c 207b     .map(|edge| {
-00018460: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
-00018470: 206d 7574 2074 6d70 5f61 7272 6179 203d   mut tmp_array =
-00018480: 205b 6564 6765 2e30 2c20 6564 6765 2e31   [edge.0, edge.1
-00018490: 5d3b 0a20 2020 2020 2020 2020 2020 2074  ];.            t
-000184a0: 6d70 5f61 7272 6179 2e73 6f72 745f 756e  mp_array.sort_un
-000184b0: 7374 6162 6c65 2829 3b0a 2020 2020 2020  stable();.      
-000184c0: 2020 2020 2020 746d 705f 6172 7261 790a        tmp_array.
-000184d0: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
-000184e0: 2020 202e 636f 6c6c 6563 7428 293b 0a20     .collect();. 
-000184f0: 2020 206c 6574 206d 7574 2075 6e6d 6174     let mut unmat
-00018500: 6368 6564 5f65 6467 6573 203d 2065 6467  ched_edges = edg
-00018510: 655f 6c69 7374 2e64 6966 6665 7265 6e63  e_list.differenc
-00018520: 6528 266d 6174 6368 6564 5f65 6467 6573  e(&matched_edges
-00018530: 293b 0a20 2020 2075 6e6d 6174 6368 6564  );.    unmatched
-00018540: 5f65 6467 6573 2e61 6c6c 287c 657c 207b  _edges.all(|e| {
-00018550: 0a20 2020 2020 2020 206c 6574 206d 7574  .        let mut
-00018560: 2074 6d70 5f73 6574 203d 206d 6174 6368   tmp_set = match
-00018570: 696e 672e 636c 6f6e 6528 293b 0a20 2020  ing.clone();.   
-00018580: 2020 2020 2074 6d70 5f73 6574 2e69 6e73       tmp_set.ins
-00018590: 6572 7428 2865 5b30 5d2c 2065 5b31 5d29  ert((e[0], e[1])
-000185a0: 293b 0a20 2020 2020 2020 2021 5f69 6e6e  );.        !_inn
-000185b0: 6572 5f69 735f 6d61 7463 6869 6e67 2867  er_is_matching(g
-000185c0: 7261 7068 2c20 2674 6d70 5f73 6574 290a  raph, &tmp_set).
-000185d0: 2020 2020 7d29 0a7d 0a0a 2f2f 2054 6865      }).}..// The
-000185e0: 2070 726f 7669 6465 6420 6e6f 6465 2069   provided node i
-000185f0: 7320 696e 7661 6c69 642e 0a63 7265 6174  s invalid..creat
-00018600: 655f 6578 6365 7074 696f 6e21 2872 6574  e_exception!(ret
-00018610: 776f 726b 782c 2049 6e76 616c 6964 4e6f  workx, InvalidNo
-00018620: 6465 2c20 5079 4578 6365 7074 696f 6e29  de, PyException)
-00018630: 3b0a 2f2f 2050 6572 666f 726d 696e 6720  ;.// Performing 
-00018640: 7468 6973 206f 7065 7261 7469 6f6e 2077  this operation w
-00018650: 6f75 6c64 2072 6573 756c 7420 696e 2074  ould result in t
-00018660: 7279 696e 6720 746f 2061 6464 2061 2063  rying to add a c
-00018670: 7963 6c65 2074 6f20 6120 4441 472e 0a63  ycle to a DAG..c
-00018680: 7265 6174 655f 6578 6365 7074 696f 6e21  reate_exception!
-00018690: 2872 6574 776f 726b 782c 2044 4147 576f  (retworkx, DAGWo
-000186a0: 756c 6443 7963 6c65 2c20 5079 4578 6365  uldCycle, PyExce
-000186b0: 7074 696f 6e29 3b0a 2f2f 2054 6865 7265  ption);.// There
-000186c0: 2069 7320 6e6f 2065 6467 6520 7072 6573   is no edge pres
-000186d0: 656e 7420 6265 7477 6565 6e20 7468 6520  ent between the 
-000186e0: 7072 6f76 6964 6564 206e 6f64 6573 2e0a  provided nodes..
-000186f0: 6372 6561 7465 5f65 7863 6570 7469 6f6e  create_exception
-00018700: 2128 7265 7477 6f72 6b78 2c20 4e6f 4564  !(retworkx, NoEd
-00018710: 6765 4265 7477 6565 6e4e 6f64 6573 2c20  geBetweenNodes, 
-00018720: 5079 4578 6365 7074 696f 6e29 3b0a 2f2f  PyException);.//
-00018730: 2054 6865 2073 7065 6369 6669 6564 2044   The specified D
-00018740: 6972 6563 7465 6420 4772 6170 6820 6861  irected Graph ha
-00018750: 7320 6120 6379 636c 6520 616e 6420 6361  s a cycle and ca
-00018760: 6e27 7420 6265 2074 7265 6174 6564 2061  n't be treated a
-00018770: 7320 6120 4441 472e 0a63 7265 6174 655f  s a DAG..create_
-00018780: 6578 6365 7074 696f 6e21 2872 6574 776f  exception!(retwo
-00018790: 726b 782c 2044 4147 4861 7343 7963 6c65  rkx, DAGHasCycle
-000187a0: 2c20 5079 4578 6365 7074 696f 6e29 3b0a  , PyException);.
-000187b0: 2f2f 204e 6f20 6e65 6967 6862 6f72 7320  // No neighbors 
-000187c0: 666f 756e 6420 6d61 7463 6869 6e67 2074  found matching t
-000187d0: 6865 2070 726f 7669 6465 6420 7072 6564  he provided pred
-000187e0: 6963 6174 652e 0a63 7265 6174 655f 6578  icate..create_ex
-000187f0: 6365 7074 696f 6e21 2872 6574 776f 726b  ception!(retwork
-00018800: 782c 204e 6f53 7569 7461 626c 654e 6569  x, NoSuitableNei
-00018810: 6768 626f 7273 2c20 5079 4578 6365 7074  ghbors, PyExcept
-00018820: 696f 6e29 3b0a 2f2f 2049 6e76 616c 6964  ion);.// Invalid
-00018830: 206f 7065 7261 7469 6f6e 206f 6e20 6120   operation on a 
-00018840: 6e75 6c6c 2067 7261 7068 0a63 7265 6174  null graph.creat
-00018850: 655f 6578 6365 7074 696f 6e21 2872 6574  e_exception!(ret
-00018860: 776f 726b 782c 204e 756c 6c47 7261 7068  workx, NullGraph
-00018870: 2c20 5079 4578 6365 7074 696f 6e29 3b0a  , PyException);.
-00018880: 2f2f 204e 6f20 7061 7468 2077 6173 2066  // No path was f
-00018890: 6f75 6e64 2062 6574 7765 656e 2074 6865  ound between the
-000188a0: 2073 7065 6369 6669 6564 206e 6f64 6573   specified nodes
-000188b0: 2e0a 6372 6561 7465 5f65 7863 6570 7469  ..create_excepti
-000188c0: 6f6e 2128 7265 7477 6f72 6b78 2c20 4e6f  on!(retworkx, No
-000188d0: 5061 7468 466f 756e 642c 2050 7945 7863  PathFound, PyExc
-000188e0: 6570 7469 6f6e 293b 0a0a 235b 7079 6d6f  eption);..#[pymo
-000188f0: 6475 6c65 5d0a 666e 2072 6574 776f 726b  dule].fn retwork
-00018900: 7828 7079 3a20 5079 7468 6f6e 3c27 5f3e  x(py: Python<'_>
-00018910: 2c20 6d3a 2026 5079 4d6f 6475 6c65 2920  , m: &PyModule) 
-00018920: 2d3e 2050 7952 6573 756c 743c 2829 3e20  -> PyResult<()> 
-00018930: 7b0a 2020 2020 6d2e 6164 6428 225f 5f76  {.    m.add("__v
-00018940: 6572 7369 6f6e 5f5f 222c 2065 6e76 2128  ersion__", env!(
-00018950: 2243 4152 474f 5f50 4b47 5f56 4552 5349  "CARGO_PKG_VERSI
-00018960: 4f4e 2229 293f 3b0a 2020 2020 6d2e 6164  ON"))?;.    m.ad
-00018970: 6428 2249 6e76 616c 6964 4e6f 6465 222c  d("InvalidNode",
-00018980: 2070 792e 6765 745f 7479 7065 3a3a 3c49   py.get_type::<I
-00018990: 6e76 616c 6964 4e6f 6465 3e28 2929 3f3b  nvalidNode>())?;
-000189a0: 0a20 2020 206d 2e61 6464 2822 4441 4757  .    m.add("DAGW
-000189b0: 6f75 6c64 4379 636c 6522 2c20 7079 2e67  ouldCycle", py.g
-000189c0: 6574 5f74 7970 653a 3a3c 4441 4757 6f75  et_type::<DAGWou
-000189d0: 6c64 4379 636c 653e 2829 293f 3b0a 2020  ldCycle>())?;.  
-000189e0: 2020 6d2e 6164 6428 224e 6f45 6467 6542    m.add("NoEdgeB
-000189f0: 6574 7765 656e 4e6f 6465 7322 2c20 7079  etweenNodes", py
-00018a00: 2e67 6574 5f74 7970 653a 3a3c 4e6f 4564  .get_type::<NoEd
-00018a10: 6765 4265 7477 6565 6e4e 6f64 6573 3e28  geBetweenNodes>(
-00018a20: 2929 3f3b 0a20 2020 206d 2e61 6464 2822  ))?;.    m.add("
-00018a30: 4441 4748 6173 4379 636c 6522 2c20 7079  DAGHasCycle", py
-00018a40: 2e67 6574 5f74 7970 653a 3a3c 4441 4748  .get_type::<DAGH
-00018a50: 6173 4379 636c 653e 2829 293f 3b0a 2020  asCycle>())?;.  
-00018a60: 2020 6d2e 6164 6428 224e 6f53 7569 7461    m.add("NoSuita
-00018a70: 626c 654e 6569 6768 626f 7273 222c 2070  bleNeighbors", p
-00018a80: 792e 6765 745f 7479 7065 3a3a 3c4e 6f53  y.get_type::<NoS
-00018a90: 7569 7461 626c 654e 6569 6768 626f 7273  uitableNeighbors
-00018aa0: 3e28 2929 3f3b 0a20 2020 206d 2e61 6464  >())?;.    m.add
-00018ab0: 2822 4e6f 5061 7468 466f 756e 6422 2c20  ("NoPathFound", 
-00018ac0: 7079 2e67 6574 5f74 7970 653a 3a3c 4e6f  py.get_type::<No
-00018ad0: 5061 7468 466f 756e 643e 2829 293f 3b0a  PathFound>())?;.
-00018ae0: 2020 2020 6d2e 6164 6428 224e 756c 6c47      m.add("NullG
-00018af0: 7261 7068 222c 2070 792e 6765 745f 7479  raph", py.get_ty
-00018b00: 7065 3a3a 3c4e 756c 6c47 7261 7068 3e28  pe::<NullGraph>(
-00018b10: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
-00018b20: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
-00018b30: 6e63 7469 6f6e 2128 6266 735f 7375 6363  nction!(bfs_succ
-00018b40: 6573 736f 7273 2929 3f3b 0a20 2020 206d  essors))?;.    m
-00018b50: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
-00018b60: 705f 7079 6675 6e63 7469 6f6e 2128 6461  p_pyfunction!(da
-00018b70: 675f 6c6f 6e67 6573 745f 7061 7468 2929  g_longest_path))
-00018b80: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-00018b90: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-00018ba0: 7469 6f6e 2128 6461 675f 6c6f 6e67 6573  tion!(dag_longes
-00018bb0: 745f 7061 7468 5f6c 656e 6774 6829 293f  t_path_length))?
-00018bc0: 3b0a 2020 2020 6d2e 6164 645f 7772 6170  ;.    m.add_wrap
-00018bd0: 7065 6428 7772 6170 5f70 7966 756e 6374  ped(wrap_pyfunct
-00018be0: 696f 6e21 286e 756d 6265 725f 7765 616b  ion!(number_weak
-00018bf0: 6c79 5f63 6f6e 6e65 6374 6564 5f63 6f6d  ly_connected_com
-00018c00: 706f 6e65 6e74 7329 293f 3b0a 2020 2020  ponents))?;.    
-00018c10: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
-00018c20: 6170 5f70 7966 756e 6374 696f 6e21 2877  ap_pyfunction!(w
-00018c30: 6561 6b6c 795f 636f 6e6e 6563 7465 645f  eakly_connected_
-00018c40: 636f 6d70 6f6e 656e 7473 2929 3f3b 0a20  components))?;. 
-00018c50: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
-00018c60: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
-00018c70: 2128 6973 5f77 6561 6b6c 795f 636f 6e6e  !(is_weakly_conn
-00018c80: 6563 7465 6429 293f 3b0a 2020 2020 6d2e  ected))?;.    m.
-00018c90: 6164 645f 7772 6170 7065 6428 7772 6170  add_wrapped(wrap
-00018ca0: 5f70 7966 756e 6374 696f 6e21 2869 735f  _pyfunction!(is_
-00018cb0: 6469 7265 6374 6564 5f61 6379 636c 6963  directed_acyclic
-00018cc0: 5f67 7261 7068 2929 3f3b 0a20 2020 206d  _graph))?;.    m
-00018cd0: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
-00018ce0: 705f 7079 6675 6e63 7469 6f6e 2128 6973  p_pyfunction!(is
-00018cf0: 5f69 736f 6d6f 7270 6869 6329 293f 3b0a  _isomorphic))?;.
-00018d00: 2020 2020 6d2e 6164 645f 7772 6170 7065      m.add_wrappe
-00018d10: 6428 7772 6170 5f70 7966 756e 6374 696f  d(wrap_pyfunctio
-00018d20: 6e21 2864 6967 7261 7068 5f75 6e69 6f6e  n!(digraph_union
-00018d30: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
-00018d40: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
-00018d50: 6e63 7469 6f6e 2128 6973 5f69 736f 6d6f  nction!(is_isomo
-00018d60: 7270 6869 635f 6e6f 6465 5f6d 6174 6368  rphic_node_match
-00018d70: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
-00018d80: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
-00018d90: 6e63 7469 6f6e 2128 746f 706f 6c6f 6769  nction!(topologi
-00018da0: 6361 6c5f 736f 7274 2929 3f3b 0a20 2020  cal_sort))?;.   
-00018db0: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
-00018dc0: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
-00018dd0: 6465 7363 656e 6461 6e74 7329 293f 3b0a  descendants))?;.
-00018de0: 2020 2020 6d2e 6164 645f 7772 6170 7065      m.add_wrappe
-00018df0: 6428 7772 6170 5f70 7966 756e 6374 696f  d(wrap_pyfunctio
-00018e00: 6e21 2861 6e63 6573 746f 7273 2929 3f3b  n!(ancestors))?;
-00018e10: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
-00018e20: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
-00018e30: 6f6e 2128 6c65 7869 636f 6772 6170 6869  on!(lexicographi
-00018e40: 6361 6c5f 746f 706f 6c6f 6769 6361 6c5f  cal_topological_
-00018e50: 736f 7274 2929 3f3b 0a20 2020 206d 2e61  sort))?;.    m.a
-00018e60: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
-00018e70: 7079 6675 6e63 7469 6f6e 2128 666c 6f79  pyfunction!(floy
-00018e80: 645f 7761 7273 6861 6c6c 2929 3f3b 0a20  d_warshall))?;. 
-00018e90: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
-00018ea0: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
-00018eb0: 2128 6772 6170 685f 666c 6f79 645f 7761  !(graph_floyd_wa
-00018ec0: 7273 6861 6c6c 5f6e 756d 7079 2929 3f3b  rshall_numpy))?;
-00018ed0: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
-00018ee0: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
-00018ef0: 6f6e 2128 6469 6772 6170 685f 666c 6f79  on!(digraph_floy
-00018f00: 645f 7761 7273 6861 6c6c 5f6e 756d 7079  d_warshall_numpy
-00018f10: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
-00018f20: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
-00018f30: 6e63 7469 6f6e 2128 636f 6c6c 6563 745f  nction!(collect_
-00018f40: 7275 6e73 2929 3f3b 0a20 2020 206d 2e61  runs))?;.    m.a
-00018f50: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
-00018f60: 7079 6675 6e63 7469 6f6e 2128 6c61 7965  pyfunction!(laye
-00018f70: 7273 2929 3f3b 0a20 2020 206d 2e61 6464  rs))?;.    m.add
-00018f80: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
-00018f90: 6675 6e63 7469 6f6e 2128 6772 6170 685f  function!(graph_
-00018fa0: 6469 7374 616e 6365 5f6d 6174 7269 7829  distance_matrix)
-00018fb0: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
-00018fc0: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
-00018fd0: 6374 696f 6e21 2864 6967 7261 7068 5f64  ction!(digraph_d
-00018fe0: 6973 7461 6e63 655f 6d61 7472 6978 2929  istance_matrix))
-00018ff0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-00019000: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-00019010: 7469 6f6e 2128 6469 6772 6170 685f 6164  tion!(digraph_ad
-00019020: 6a61 6365 6e63 795f 6d61 7472 6978 2929  jacency_matrix))
-00019030: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-00019040: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-00019050: 7469 6f6e 2128 6772 6170 685f 6164 6a61  tion!(graph_adja
-00019060: 6365 6e63 795f 6d61 7472 6978 2929 3f3b  cency_matrix))?;
-00019070: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
-00019080: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
-00019090: 6f6e 2128 6772 6170 685f 616c 6c5f 7369  on!(graph_all_si
-000190a0: 6d70 6c65 5f70 6174 6873 2929 3f3b 0a20  mple_paths))?;. 
-000190b0: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
-000190c0: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
-000190d0: 2128 6469 6772 6170 685f 616c 6c5f 7369  !(digraph_all_si
-000190e0: 6d70 6c65 5f70 6174 6873 2929 3f3b 0a20  mple_paths))?;. 
-000190f0: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
-00019100: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
-00019110: 2128 6772 6170 685f 6469 6a6b 7374 7261  !(graph_dijkstra
-00019120: 5f73 686f 7274 6573 745f 7061 7468 7329  _shortest_paths)
-00019130: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
-00019140: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
-00019150: 6374 696f 6e21 2864 6967 7261 7068 5f64  ction!(digraph_d
-00019160: 696a 6b73 7472 615f 7368 6f72 7465 7374  ijkstra_shortest
-00019170: 5f70 6174 6873 2929 3f3b 0a20 2020 206d  _paths))?;.    m
-00019180: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
-00019190: 705f 7079 6675 6e63 7469 6f6e 2128 6772  p_pyfunction!(gr
-000191a0: 6170 685f 6469 6a6b 7374 7261 5f73 686f  aph_dijkstra_sho
-000191b0: 7274 6573 745f 7061 7468 5f6c 656e 6774  rtest_path_lengt
-000191c0: 6873 2929 3f3b 0a20 2020 206d 2e61 6464  hs))?;.    m.add
-000191d0: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
-000191e0: 6675 6e63 7469 6f6e 2128 6469 6772 6170  function!(digrap
-000191f0: 685f 6469 6a6b 7374 7261 5f73 686f 7274  h_dijkstra_short
-00019200: 6573 745f 7061 7468 5f6c 656e 6774 6873  est_path_lengths
-00019210: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
-00019220: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
-00019230: 6e63 7469 6f6e 2128 6772 6170 685f 6173  nction!(graph_as
-00019240: 7461 725f 7368 6f72 7465 7374 5f70 6174  tar_shortest_pat
-00019250: 6829 293f 3b0a 2020 2020 6d2e 6164 645f  h))?;.    m.add_
-00019260: 7772 6170 7065 6428 7772 6170 5f70 7966  wrapped(wrap_pyf
-00019270: 756e 6374 696f 6e21 2864 6967 7261 7068  unction!(digraph
-00019280: 5f61 7374 6172 5f73 686f 7274 6573 745f  _astar_shortest_
-00019290: 7061 7468 2929 3f3b 0a20 2020 206d 2e61  path))?;.    m.a
-000192a0: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
-000192b0: 7079 6675 6e63 7469 6f6e 2128 6772 6170  pyfunction!(grap
-000192c0: 685f 6772 6565 6479 5f63 6f6c 6f72 2929  h_greedy_color))
-000192d0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-000192e0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-000192f0: 7469 6f6e 2128 6469 7265 6374 6564 5f67  tion!(directed_g
-00019300: 6e70 5f72 616e 646f 6d5f 6772 6170 6829  np_random_graph)
-00019310: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
-00019320: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
-00019330: 6374 696f 6e21 2875 6e64 6972 6563 7465  ction!(undirecte
-00019340: 645f 676e 705f 7261 6e64 6f6d 5f67 7261  d_gnp_random_gra
-00019350: 7068 2929 3f3b 0a20 2020 206d 2e61 6464  ph))?;.    m.add
-00019360: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
-00019370: 6675 6e63 7469 6f6e 2128 6469 7265 6374  function!(direct
-00019380: 6564 5f67 6e6d 5f72 616e 646f 6d5f 6772  ed_gnm_random_gr
-00019390: 6170 6829 293f 3b0a 2020 2020 6d2e 6164  aph))?;.    m.ad
-000193a0: 645f 7772 6170 7065 6428 7772 6170 5f70  d_wrapped(wrap_p
-000193b0: 7966 756e 6374 696f 6e21 2875 6e64 6972  yfunction!(undir
-000193c0: 6563 7465 645f 676e 6d5f 7261 6e64 6f6d  ected_gnm_random
-000193d0: 5f67 7261 7068 2929 3f3b 0a20 2020 206d  _graph))?;.    m
-000193e0: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
-000193f0: 705f 7079 6675 6e63 7469 6f6e 2128 6379  p_pyfunction!(cy
-00019400: 636c 655f 6261 7369 7329 293f 3b0a 2020  cle_basis))?;.  
-00019410: 2020 6d2e 6164 645f 7772 6170 7065 6428    m.add_wrapped(
-00019420: 7772 6170 5f70 7966 756e 6374 696f 6e21  wrap_pyfunction!
-00019430: 2873 7472 6f6e 676c 795f 636f 6e6e 6563  (strongly_connec
-00019440: 7465 645f 636f 6d70 6f6e 656e 7473 2929  ted_components))
-00019450: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-00019460: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-00019470: 7469 6f6e 2128 6469 6772 6170 685f 6466  tion!(digraph_df
-00019480: 735f 6564 6765 7329 293f 3b0a 2020 2020  s_edges))?;.    
-00019490: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
-000194a0: 6170 5f70 7966 756e 6374 696f 6e21 2867  ap_pyfunction!(g
-000194b0: 7261 7068 5f64 6673 5f65 6467 6573 2929  raph_dfs_edges))
-000194c0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
-000194d0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
-000194e0: 7469 6f6e 2128 6469 6772 6170 685f 6669  tion!(digraph_fi
-000194f0: 6e64 5f63 7963 6c65 2929 3f3b 0a20 2020  nd_cycle))?;.   
-00019500: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
-00019510: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
-00019520: 6469 6772 6170 685f 6b5f 7368 6f72 7465  digraph_k_shorte
-00019530: 7374 5f70 6174 685f 6c65 6e67 7468 7329  st_path_lengths)
-00019540: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
-00019550: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
-00019560: 6374 696f 6e21 2867 7261 7068 5f6b 5f73  ction!(graph_k_s
-00019570: 686f 7274 6573 745f 7061 7468 5f6c 656e  hortest_path_len
-00019580: 6774 6873 2929 3f3b 0a20 2020 206d 2e61  gths))?;.    m.a
-00019590: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
-000195a0: 7079 6675 6e63 7469 6f6e 2128 6973 5f6d  pyfunction!(is_m
-000195b0: 6174 6368 696e 6729 293f 3b0a 2020 2020  atching))?;.    
-000195c0: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
-000195d0: 6170 5f70 7966 756e 6374 696f 6e21 2869  ap_pyfunction!(i
-000195e0: 735f 6d61 7869 6d61 6c5f 6d61 7463 6869  s_maximal_matchi
-000195f0: 6e67 2929 3f3b 0a20 2020 206d 2e61 6464  ng))?;.    m.add
-00019600: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
-00019610: 6675 6e63 7469 6f6e 2128 6d61 785f 7765  function!(max_we
-00019620: 6967 6874 5f6d 6174 6368 696e 6729 293f  ight_matching))?
-00019630: 3b0a 2020 2020 6d2e 6164 645f 636c 6173  ;.    m.add_clas
-00019640: 733a 3a3c 6469 6772 6170 683a 3a50 7944  s::<digraph::PyD
-00019650: 6947 7261 7068 3e28 293f 3b0a 2020 2020  iGraph>()?;.    
-00019660: 6d2e 6164 645f 636c 6173 733a 3a3c 6772  m.add_class::<gr
-00019670: 6170 683a 3a50 7947 7261 7068 3e28 293f  aph::PyGraph>()?
-00019680: 3b0a 2020 2020 6d2e 6164 645f 636c 6173  ;.    m.add_clas
-00019690: 733a 3a3c 6974 6572 6174 6f72 733a 3a42  s::<iterators::B
-000196a0: 4653 5375 6363 6573 736f 7273 3e28 293f  FSSuccessors>()?
-000196b0: 3b0a 2020 2020 6d2e 6164 645f 636c 6173  ;.    m.add_clas
-000196c0: 733a 3a3c 6974 6572 6174 6f72 733a 3a4e  s::<iterators::N
-000196d0: 6f64 6549 6e64 6963 6573 3e28 293f 3b0a  odeIndices>()?;.
-000196e0: 2020 2020 6d2e 6164 645f 636c 6173 733a      m.add_class:
-000196f0: 3a3c 6974 6572 6174 6f72 733a 3a45 6467  :<iterators::Edg
-00019700: 654c 6973 743e 2829 3f3b 0a20 2020 206d  eList>()?;.    m
-00019710: 2e61 6464 5f63 6c61 7373 3a3a 3c69 7465  .add_class::<ite
-00019720: 7261 746f 7273 3a3a 5765 6967 6874 6564  rators::Weighted
-00019730: 4564 6765 4c69 7374 3e28 293f 3b0a 2020  EdgeList>()?;.  
-00019740: 2020 6d2e 6164 645f 7772 6170 7065 6428    m.add_wrapped(
-00019750: 7772 6170 5f70 796d 6f64 756c 6521 2867  wrap_pymodule!(g
-00019760: 656e 6572 6174 6f72 7329 293f 3b0a 2020  enerators))?;.  
-00019770: 2020 4f6b 2828 2929 0a7d 0a                Ok(()).}.
+0000c010: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0000c020: 6d5f 696a 203d 2064 5f69 6a6b 3b0a 2020  m_ij = d_ijk;.  
+0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c040: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0000c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c060: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0000c070: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000c080: 2020 2020 2020 2020 2020 2020 207d 290a               }).
+0000c090: 2020 2020 2020 2020 7d0a 2020 2020 7d0a          }.    }.
+0000c0a0: 2020 2020 4f6b 286d 6174 2e69 6e74 6f5f      Ok(mat.into_
+0000c0b0: 7079 6172 7261 7928 7079 292e 696e 746f  pyarray(py).into
+0000c0c0: 2829 290a 7d0a 0a2f 2f2f 2043 6f6c 6c65  ()).}../// Colle
+0000c0d0: 6374 2072 756e 7320 7468 6174 206d 6174  ct runs that mat
+0000c0e0: 6368 2061 2066 696c 7465 7220 6675 6e63  ch a filter func
+0000c0f0: 7469 6f6e 0a2f 2f2f 0a2f 2f2f 2041 2072  tion.///./// A r
+0000c100: 756e 2069 7320 6120 7061 7468 206f 6620  un is a path of 
+0000c110: 6e6f 6465 7320 7768 6572 6520 7468 6572  nodes where ther
+0000c120: 6520 6973 206f 6e6c 7920 6120 7369 6e67  e is only a sing
+0000c130: 6c65 2073 7563 6365 7373 6f72 2061 6e64  le successor and
+0000c140: 2061 6c6c 0a2f 2f2f 206e 6f64 6573 2069   all./// nodes i
+0000c150: 6e20 7468 6520 7061 7468 206d 6174 6368  n the path match
+0000c160: 2074 6865 2067 6976 656e 2063 6f6e 6469   the given condi
+0000c170: 7469 6f6e 2e20 4561 6368 206e 6f64 6520  tion. Each node 
+0000c180: 696e 2074 6865 2067 7261 7068 2063 616e  in the graph can
+0000c190: 0a2f 2f2f 2061 7070 6561 7220 696e 206f  ./// appear in o
+0000c1a0: 6e6c 7920 6120 7369 6e67 6c65 2072 756e  nly a single run
+0000c1b0: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
+0000c1c0: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
+0000c1d0: 3a20 5468 6520 6772 6170 6820 746f 2066  : The graph to f
+0000c1e0: 696e 6420 7275 6e73 2069 6e0a 2f2f 2f20  ind runs in./// 
+0000c1f0: 3a70 6172 616d 2066 696c 7465 725f 666e  :param filter_fn
+0000c200: 3a20 5468 6520 6669 6c74 6572 2066 756e  : The filter fun
+0000c210: 6374 696f 6e20 746f 2075 7365 2066 6f72  ction to use for
+0000c220: 206d 6174 6368 696e 6720 6e6f 6465 732e   matching nodes.
+0000c230: 2049 7420 7461 6b65 730a 2f2f 2f20 2020   It takes.///   
+0000c240: 2020 696e 206f 6e65 2061 7267 756d 656e    in one argumen
+0000c250: 742c 2074 6865 206e 6f64 6520 6461 7461  t, the node data
+0000c260: 2070 6179 6c6f 6164 2f77 6569 6768 7420   payload/weight 
+0000c270: 6f62 6a65 6374 2c20 616e 6420 7769 6c6c  object, and will
+0000c280: 2072 6574 7572 6e20 610a 2f2f 2f20 2020   return a.///   
+0000c290: 2020 626f 6f6c 6561 6e20 7768 6574 6865    boolean whethe
+0000c2a0: 7220 7468 6520 6e6f 6465 206d 6174 6368  r the node match
+0000c2b0: 6573 2074 6865 2063 6f6e 6469 7469 6f6e  es the condition
+0000c2c0: 7320 6f72 206e 6f74 2e20 4966 2069 7420  s or not. If it 
+0000c2d0: 7265 7475 726e 730a 2f2f 2f20 2020 2020  returns.///     
+0000c2e0: 6060 4661 6c73 6560 6020 6974 2077 696c  ``False`` it wil
+0000c2f0: 6c20 736b 6970 2074 6861 7420 6e6f 6465  l skip that node
+0000c300: 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  ..///./// :retur
+0000c310: 6e73 3a20 6120 6c69 7374 206f 6620 7275  ns: a list of ru
+0000c320: 6e73 2c20 7768 6572 6520 6561 6368 2072  ns, where each r
+0000c330: 756e 2069 7320 6120 6c69 7374 206f 6620  un is a list of 
+0000c340: 6e6f 6465 2064 6174 610a 2f2f 2f20 2020  node data.///   
+0000c350: 2020 7061 796c 6f61 642f 7765 6967 6874    payload/weight
+0000c360: 2066 6f72 2074 6865 206e 6f64 6573 2069   for the nodes i
+0000c370: 6e20 7468 6520 7275 6e0a 2f2f 2f20 3a72  n the run./// :r
+0000c380: 7479 7065 3a20 6c69 7374 0a23 5b70 7966  type: list.#[pyf
+0000c390: 756e 6374 696f 6e5d 0a23 5b74 6578 745f  unction].#[text_
+0000c3a0: 7369 676e 6174 7572 6520 3d20 2228 6772  signature = "(gr
+0000c3b0: 6170 682c 2066 696c 7465 7229 225d 0a66  aph, filter)"].f
+0000c3c0: 6e20 636f 6c6c 6563 745f 7275 6e73 280a  n collect_runs(.
+0000c3d0: 2020 2020 7079 3a20 5079 7468 6f6e 2c0a      py: Python,.
+0000c3e0: 2020 2020 6772 6170 683a 2026 6469 6772      graph: &digr
+0000c3f0: 6170 683a 3a50 7944 6947 7261 7068 2c0a  aph::PyDiGraph,.
+0000c400: 2020 2020 6669 6c74 6572 5f66 6e3a 2050      filter_fn: P
+0000c410: 794f 626a 6563 742c 0a29 202d 3e20 5079  yObject,.) -> Py
+0000c420: 5265 7375 6c74 3c56 6563 3c56 6563 3c50  Result<Vec<Vec<P
+0000c430: 794f 626a 6563 743e 3e3e 207b 0a20 2020  yObject>>> {.   
+0000c440: 206c 6574 206d 7574 206f 7574 5f6c 6973   let mut out_lis
+0000c450: 743a 2056 6563 3c56 6563 3c50 794f 626a  t: Vec<Vec<PyObj
+0000c460: 6563 743e 3e20 3d20 5665 633a 3a6e 6577  ect>> = Vec::new
+0000c470: 2829 3b0a 2020 2020 6c65 7420 6d75 7420  ();.    let mut 
+0000c480: 7365 656e 3a20 4861 7368 5365 743c 4e6f  seen: HashSet<No
+0000c490: 6465 496e 6465 783e 203d 0a20 2020 2020  deIndex> =.     
+0000c4a0: 2020 2048 6173 6853 6574 3a3a 7769 7468     HashSet::with
+0000c4b0: 5f63 6170 6163 6974 7928 6772 6170 682e  _capacity(graph.
+0000c4c0: 6e6f 6465 5f63 6f75 6e74 2829 293b 0a0a  node_count());..
+0000c4d0: 2020 2020 6c65 7420 6669 6c74 6572 5f6e      let filter_n
+0000c4e0: 6f64 6520 3d20 7c6e 6f64 653a 2026 5079  ode = |node: &Py
+0000c4f0: 4f62 6a65 6374 7c20 2d3e 2050 7952 6573  Object| -> PyRes
+0000c500: 756c 743c 626f 6f6c 3e20 7b0a 2020 2020  ult<bool> {.    
+0000c510: 2020 2020 6c65 7420 7265 7320 3d20 6669      let res = fi
+0000c520: 6c74 6572 5f66 6e2e 6361 6c6c 3128 7079  lter_fn.call1(py
+0000c530: 2c20 286e 6f64 652c 2929 3f3b 0a20 2020  , (node,))?;.   
+0000c540: 2020 2020 2072 6573 2e65 7874 7261 6374       res.extract
+0000c550: 2870 7929 0a20 2020 207d 3b0a 0a20 2020  (py).    };..   
+0000c560: 206c 6574 206e 6f64 6573 203d 206d 6174   let nodes = mat
+0000c570: 6368 2061 6c67 6f3a 3a74 6f70 6f73 6f72  ch algo::toposor
+0000c580: 7428 6772 6170 682c 204e 6f6e 6529 207b  t(graph, None) {
+0000c590: 0a20 2020 2020 2020 204f 6b28 6e6f 6465  .        Ok(node
+0000c5a0: 7329 203d 3e20 6e6f 6465 732c 0a20 2020  s) => nodes,.   
+0000c5b0: 2020 2020 2045 7272 285f 6572 7229 203d       Err(_err) =
+0000c5c0: 3e20 7b0a 2020 2020 2020 2020 2020 2020  > {.            
+0000c5d0: 7265 7475 726e 2045 7272 2844 4147 4861  return Err(DAGHa
+0000c5e0: 7343 7963 6c65 3a3a 6e65 775f 6572 7228  sCycle::new_err(
+0000c5f0: 2253 6f72 7420 656e 636f 756e 7465 7265  "Sort encountere
+0000c600: 6420 6120 6379 636c 6522 2929 0a20 2020  d a cycle")).   
+0000c610: 2020 2020 207d 0a20 2020 207d 3b0a 2020       }.    };.  
+0000c620: 2020 666f 7220 6e6f 6465 2069 6e20 6e6f    for node in no
+0000c630: 6465 7320 7b0a 2020 2020 2020 2020 6966  des {.        if
+0000c640: 2021 6669 6c74 6572 5f6e 6f64 6528 2667   !filter_node(&g
+0000c650: 7261 7068 2e67 7261 7068 5b6e 6f64 655d  raph.graph[node]
+0000c660: 293f 207c 7c20 7365 656e 2e63 6f6e 7461  )? || seen.conta
+0000c670: 696e 7328 266e 6f64 6529 207b 0a20 2020  ins(&node) {.   
+0000c680: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0000c690: 653b 0a20 2020 2020 2020 207d 0a20 2020  e;.        }.   
+0000c6a0: 2020 2020 2073 6565 6e2e 696e 7365 7274       seen.insert
+0000c6b0: 286e 6f64 6529 3b0a 2020 2020 2020 2020  (node);.        
+0000c6c0: 6c65 7420 6d75 7420 6772 6f75 703a 2056  let mut group: V
+0000c6d0: 6563 3c50 794f 626a 6563 743e 203d 2076  ec<PyObject> = v
+0000c6e0: 6563 215b 6772 6170 682e 6772 6170 685b  ec![graph.graph[
+0000c6f0: 6e6f 6465 5d2e 636c 6f6e 655f 7265 6628  node].clone_ref(
+0000c700: 7079 295d 3b0a 2020 2020 2020 2020 6c65  py)];.        le
+0000c710: 7420 6d75 7420 7375 6363 6573 736f 7273  t mut successors
+0000c720: 3a20 5665 633c 4e6f 6465 496e 6465 783e  : Vec<NodeIndex>
+0000c730: 203d 2067 7261 7068 0a20 2020 2020 2020   = graph.       
+0000c740: 2020 2020 202e 6772 6170 680a 2020 2020       .graph.    
+0000c750: 2020 2020 2020 2020 2e6e 6569 6768 626f          .neighbo
+0000c760: 7273 5f64 6972 6563 7465 6428 6e6f 6465  rs_directed(node
+0000c770: 2c20 7065 7467 7261 7068 3a3a 4469 7265  , petgraph::Dire
+0000c780: 6374 696f 6e3a 3a4f 7574 676f 696e 6729  ction::Outgoing)
+0000c790: 0a20 2020 2020 2020 2020 2020 202e 636f  .            .co
+0000c7a0: 6c6c 6563 7428 293b 0a20 2020 2020 2020  llect();.       
+0000c7b0: 2073 7563 6365 7373 6f72 732e 6465 6475   successors.dedu
+0000c7c0: 7028 293b 0a0a 2020 2020 2020 2020 7768  p();..        wh
+0000c7d0: 696c 6520 7375 6363 6573 736f 7273 2e6c  ile successors.l
+0000c7e0: 656e 2829 203d 3d20 310a 2020 2020 2020  en() == 1.      
+0000c7f0: 2020 2020 2020 2626 2066 696c 7465 725f        && filter_
+0000c800: 6e6f 6465 2826 6772 6170 682e 6772 6170  node(&graph.grap
+0000c810: 685b 7375 6363 6573 736f 7273 5b30 5d5d  h[successors[0]]
+0000c820: 293f 0a20 2020 2020 2020 2020 2020 2026  )?.            &
+0000c830: 2620 2173 6565 6e2e 636f 6e74 6169 6e73  & !seen.contains
+0000c840: 2826 7375 6363 6573 736f 7273 5b30 5d29  (&successors[0])
+0000c850: 0a20 2020 2020 2020 207b 0a20 2020 2020  .        {.     
+0000c860: 2020 2020 2020 2067 726f 7570 2e70 7573         group.pus
+0000c870: 6828 6772 6170 682e 6772 6170 685b 7375  h(graph.graph[su
+0000c880: 6363 6573 736f 7273 5b30 5d5d 2e63 6c6f  ccessors[0]].clo
+0000c890: 6e65 5f72 6566 2870 7929 293b 0a20 2020  ne_ref(py));.   
+0000c8a0: 2020 2020 2020 2020 2073 6565 6e2e 696e           seen.in
+0000c8b0: 7365 7274 2873 7563 6365 7373 6f72 735b  sert(successors[
+0000c8c0: 305d 293b 0a20 2020 2020 2020 2020 2020  0]);.           
+0000c8d0: 2073 7563 6365 7373 6f72 7320 3d20 6772   successors = gr
+0000c8e0: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
+0000c8f0: 2020 2020 2e67 7261 7068 0a20 2020 2020      .graph.     
+0000c900: 2020 2020 2020 2020 2020 202e 6e65 6967             .neig
+0000c910: 6862 6f72 735f 6469 7265 6374 6564 280a  hbors_directed(.
+0000c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c930: 2020 2020 7375 6363 6573 736f 7273 5b30      successors[0
+0000c940: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0000c950: 2020 2020 2020 2070 6574 6772 6170 683a         petgraph:
+0000c960: 3a44 6972 6563 7469 6f6e 3a3a 4f75 7467  :Direction::Outg
+0000c970: 6f69 6e67 2c0a 2020 2020 2020 2020 2020  oing,.          
+0000c980: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000c990: 2020 2020 2020 2020 2e63 6f6c 6c65 6374          .collect
+0000c9a0: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
+0000c9b0: 7375 6363 6573 736f 7273 2e64 6564 7570  successors.dedup
+0000c9c0: 2829 3b0a 2020 2020 2020 2020 7d0a 2020  ();.        }.  
+0000c9d0: 2020 2020 2020 6966 2021 6772 6f75 702e        if !group.
+0000c9e0: 6973 5f65 6d70 7479 2829 207b 0a20 2020  is_empty() {.   
+0000c9f0: 2020 2020 2020 2020 206f 7574 5f6c 6973           out_lis
+0000ca00: 742e 7075 7368 2867 726f 7570 293b 0a20  t.push(group);. 
+0000ca10: 2020 2020 2020 207d 0a20 2020 207d 0a20         }.    }. 
+0000ca20: 2020 204f 6b28 6f75 745f 6c69 7374 290a     Ok(out_list).
+0000ca30: 7d0a 0a2f 2f2f 2052 6574 7572 6e20 6120  }../// Return a 
+0000ca40: 6c69 7374 206f 6620 6c61 7965 7273 0a2f  list of layers./
+0000ca50: 2f2f 2020 0a2f 2f2f 2041 206c 6179 6572  //  ./// A layer
+0000ca60: 2069 7320 6120 7375 6267 7261 7068 2077   is a subgraph w
+0000ca70: 686f 7365 206e 6f64 6573 2061 7265 2064  hose nodes are d
+0000ca80: 6973 6a6f 696e 742c 2069 2e65 2e2c 0a2f  isjoint, i.e.,./
+0000ca90: 2f2f 2061 206c 6179 6572 2068 6173 2064  // a layer has d
+0000caa0: 6570 7468 2031 2e20 5468 6520 6c61 7965  epth 1. The laye
+0000cab0: 7273 2061 7265 2063 6f6e 7374 7275 6374  rs are construct
+0000cac0: 6564 2075 7369 6e67 2061 2067 7265 6564  ed using a greed
+0000cad0: 7920 616c 676f 7269 7468 6d2e 0a2f 2f2f  y algorithm..///
+0000cae0: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
+0000caf0: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
+0000cb00: 2044 4147 2074 6f20 6765 7420 7468 6520   DAG to get the 
+0000cb10: 6c61 7965 7273 2066 726f 6d0a 2f2f 2f20  layers from./// 
+0000cb20: 3a70 6172 616d 206c 6973 7420 6669 7273  :param list firs
+0000cb30: 745f 6c61 7965 723a 2041 206c 6973 7420  t_layer: A list 
+0000cb40: 6f66 206e 6f64 6520 6964 7320 666f 7220  of node ids for 
+0000cb50: 7468 6520 6669 7273 7420 6c61 7965 722e  the first layer.
+0000cb60: 2054 6869 730a 2f2f 2f20 2020 2020 7769   This.///     wi
+0000cb70: 6c6c 2062 6520 7468 6520 6669 7273 7420  ll be the first 
+0000cb80: 6c61 7965 7220 696e 2074 6865 206f 7574  layer in the out
+0000cb90: 7075 740a 2f2f 2f0a 2f2f 2f20 3a72 6574  put.///./// :ret
+0000cba0: 7572 6e73 3a20 4120 6c69 7374 206f 6620  urns: A list of 
+0000cbb0: 6c61 7965 7273 2c20 6561 6368 206c 6179  layers, each lay
+0000cbc0: 6572 2069 7320 6120 6c69 7374 206f 6620  er is a list of 
+0000cbd0: 6e6f 6465 2064 6174 610a 2f2f 2f20 3a72  node data./// :r
+0000cbe0: 7479 7065 3a20 6c69 7374 0a2f 2f2f 0a2f  type: list.///./
+0000cbf0: 2f2f 203a 7261 6973 6573 2049 6e76 616c  // :raises Inval
+0000cc00: 6964 4e6f 6465 3a20 4966 2061 206e 6f64  idNode: If a nod
+0000cc10: 6520 696e 6465 7820 696e 2060 6066 6972  e index in ``fir
+0000cc20: 7374 5f6c 6179 6572 6060 2069 7320 6e6f  st_layer`` is no
+0000cc30: 7420 696e 2074 6865 2067 7261 7068 0a23  t in the graph.#
+0000cc40: 5b70 7966 756e 6374 696f 6e5d 0a23 5b74  [pyfunction].#[t
+0000cc50: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
+0000cc60: 2228 6461 672c 2066 6972 7374 5f6c 6179  "(dag, first_lay
+0000cc70: 6572 2c20 2f29 225d 0a66 6e20 6c61 7965  er, /)"].fn laye
+0000cc80: 7273 280a 2020 2020 7079 3a20 5079 7468  rs(.    py: Pyth
+0000cc90: 6f6e 2c0a 2020 2020 6461 673a 2026 6469  on,.    dag: &di
+0000cca0: 6772 6170 683a 3a50 7944 6947 7261 7068  graph::PyDiGraph
+0000ccb0: 2c0a 2020 2020 6669 7273 745f 6c61 7965  ,.    first_laye
+0000ccc0: 723a 2056 6563 3c75 7369 7a65 3e2c 0a29  r: Vec<usize>,.)
+0000ccd0: 202d 3e20 5079 5265 7375 6c74 3c50 794f   -> PyResult<PyO
+0000cce0: 626a 6563 743e 207b 0a20 2020 206c 6574  bject> {.    let
+0000ccf0: 206d 7574 206f 7574 7075 743a 2056 6563   mut output: Vec
+0000cd00: 3c56 6563 3c26 5079 4f62 6a65 6374 3e3e  <Vec<&PyObject>>
+0000cd10: 203d 2056 6563 3a3a 6e65 7728 293b 0a20   = Vec::new();. 
+0000cd20: 2020 202f 2f20 436f 6e76 6572 7420 7573     // Convert us
+0000cd30: 697a 6520 746f 204e 6f64 6549 6e64 6578  ize to NodeIndex
+0000cd40: 0a20 2020 206c 6574 206d 7574 2066 6972  .    let mut fir
+0000cd50: 7374 5f6c 6179 6572 5f69 6e64 6578 3a20  st_layer_index: 
+0000cd60: 5665 633c 4e6f 6465 496e 6465 783e 203d  Vec<NodeIndex> =
+0000cd70: 2056 6563 3a3a 6e65 7728 293b 0a20 2020   Vec::new();.   
+0000cd80: 2066 6f72 2069 6e64 6578 2069 6e20 6669   for index in fi
+0000cd90: 7273 745f 6c61 7965 7220 7b0a 2020 2020  rst_layer {.    
+0000cda0: 2020 2020 6669 7273 745f 6c61 7965 725f      first_layer_
+0000cdb0: 696e 6465 782e 7075 7368 284e 6f64 6549  index.push(NodeI
+0000cdc0: 6e64 6578 3a3a 6e65 7728 696e 6465 7829  ndex::new(index)
+0000cdd0: 293b 0a20 2020 207d 0a0a 2020 2020 6c65  );.    }..    le
+0000cde0: 7420 6d75 7420 6375 725f 6c61 7965 7220  t mut cur_layer 
+0000cdf0: 3d20 6669 7273 745f 6c61 7965 725f 696e  = first_layer_in
+0000ce00: 6465 783b 0a20 2020 206c 6574 206d 7574  dex;.    let mut
+0000ce10: 206e 6578 745f 6c61 7965 723a 2056 6563   next_layer: Vec
+0000ce20: 3c4e 6f64 6549 6e64 6578 3e20 3d20 5665  <NodeIndex> = Ve
+0000ce30: 633a 3a6e 6577 2829 3b0a 2020 2020 6c65  c::new();.    le
+0000ce40: 7420 6d75 7420 7072 6564 6563 6573 736f  t mut predecesso
+0000ce50: 725f 636f 756e 743a 2048 6173 684d 6170  r_count: HashMap
+0000ce60: 3c4e 6f64 6549 6e64 6578 2c20 7573 697a  <NodeIndex, usiz
+0000ce70: 653e 203d 2048 6173 684d 6170 3a3a 6e65  e> = HashMap::ne
+0000ce80: 7728 293b 0a0a 2020 2020 6c65 7420 6d75  w();..    let mu
+0000ce90: 7420 6c61 7965 725f 6e6f 6465 5f64 6174  t layer_node_dat
+0000cea0: 613a 2056 6563 3c26 5079 4f62 6a65 6374  a: Vec<&PyObject
+0000ceb0: 3e20 3d20 5665 633a 3a6e 6577 2829 3b0a  > = Vec::new();.
+0000cec0: 2020 2020 666f 7220 6c61 7965 725f 6e6f      for layer_no
+0000ced0: 6465 2069 6e20 2663 7572 5f6c 6179 6572  de in &cur_layer
+0000cee0: 207b 0a20 2020 2020 2020 206c 6574 206e   {.        let n
+0000cef0: 6f64 655f 6461 7461 203d 206d 6174 6368  ode_data = match
+0000cf00: 2064 6167 2e67 7261 7068 2e6e 6f64 655f   dag.graph.node_
+0000cf10: 7765 6967 6874 282a 6c61 7965 725f 6e6f  weight(*layer_no
+0000cf20: 6465 2920 7b0a 2020 2020 2020 2020 2020  de) {.          
+0000cf30: 2020 536f 6d65 2864 6174 6129 203d 3e20    Some(data) => 
+0000cf40: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+0000cf50: 2020 4e6f 6e65 203d 3e20 7b0a 2020 2020    None => {.    
+0000cf60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000cf70: 726e 2045 7272 2849 6e76 616c 6964 4e6f  rn Err(InvalidNo
+0000cf80: 6465 3a3a 6e65 775f 6572 7228 666f 726d  de::new_err(form
+0000cf90: 6174 2128 0a20 2020 2020 2020 2020 2020  at!(.           
+0000cfa0: 2020 2020 2020 2020 2022 416e 2069 6e64           "An ind
+0000cfb0: 6578 2069 6e70 7574 2069 6e20 2766 6972  ex input in 'fir
+0000cfc0: 7374 5f6c 6179 6572 2720 7b7d 2069 7320  st_layer' {} is 
+0000cfd0: 6e6f 7420 6120 7661 6c69 6420 6e6f 6465  not a valid node
+0000cfe0: 2069 6e64 6578 2069 6e20 7468 6520 6772   index in the gr
+0000cff0: 6170 6822 2c0a 2020 2020 2020 2020 2020  aph",.          
+0000d000: 2020 2020 2020 2020 2020 6c61 7965 725f            layer_
+0000d010: 6e6f 6465 2e69 6e64 6578 2829 292c 0a20  node.index()),. 
+0000d020: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000d030: 290a 2020 2020 2020 2020 2020 2020 7d0a  ).            }.
+0000d040: 2020 2020 2020 2020 7d3b 0a20 2020 2020          };.     
+0000d050: 2020 206c 6179 6572 5f6e 6f64 655f 6461     layer_node_da
+0000d060: 7461 2e70 7573 6828 6e6f 6465 5f64 6174  ta.push(node_dat
+0000d070: 6129 3b0a 2020 2020 7d0a 2020 2020 6f75  a);.    }.    ou
+0000d080: 7470 7574 2e70 7573 6828 6c61 7965 725f  tput.push(layer_
+0000d090: 6e6f 6465 5f64 6174 6129 3b0a 0a20 2020  node_data);..   
+0000d0a0: 202f 2f20 4974 6572 6174 6520 756e 7469   // Iterate unti
+0000d0b0: 6c20 7468 6572 6520 6172 6520 6e6f 206d  l there are no m
+0000d0c0: 6f72 650a 2020 2020 7768 696c 6520 2163  ore.    while !c
+0000d0d0: 7572 5f6c 6179 6572 2e69 735f 656d 7074  ur_layer.is_empt
+0000d0e0: 7928 2920 7b0a 2020 2020 2020 2020 666f  y() {.        fo
+0000d0f0: 7220 6e6f 6465 2069 6e20 2663 7572 5f6c  r node in &cur_l
+0000d100: 6179 6572 207b 0a20 2020 2020 2020 2020  ayer {.         
+0000d110: 2020 206c 6574 2063 6869 6c64 7265 6e20     let children 
+0000d120: 3d20 6461 670a 2020 2020 2020 2020 2020  = dag.          
+0000d130: 2020 2020 2020 2e67 7261 7068 0a20 2020        .graph.   
+0000d140: 2020 2020 2020 2020 2020 2020 202e 6e65               .ne
+0000d150: 6967 6862 6f72 735f 6469 7265 6374 6564  ighbors_directed
+0000d160: 282a 6e6f 6465 2c20 7065 7467 7261 7068  (*node, petgraph
+0000d170: 3a3a 4469 7265 6374 696f 6e3a 3a4f 7574  ::Direction::Out
+0000d180: 676f 696e 6729 3b0a 2020 2020 2020 2020  going);.        
+0000d190: 2020 2020 6c65 7420 6d75 7420 7573 6564      let mut used
+0000d1a0: 5f69 6e64 6578 6573 3a20 4861 7368 5365  _indexes: HashSe
+0000d1b0: 743c 4e6f 6465 496e 6465 783e 203d 2048  t<NodeIndex> = H
+0000d1c0: 6173 6853 6574 3a3a 6e65 7728 293b 0a20  ashSet::new();. 
+0000d1d0: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
+0000d1e0: 7563 6320 696e 2063 6869 6c64 7265 6e20  ucc in children 
+0000d1f0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000d200: 2020 2f2f 2053 6b69 7020 6475 706c 6963    // Skip duplic
+0000d210: 6174 6520 7375 6363 6573 736f 7273 0a20  ate successors. 
+0000d220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000d230: 6620 7573 6564 5f69 6e64 6578 6573 2e63  f used_indexes.c
+0000d240: 6f6e 7461 696e 7328 2673 7563 6329 207b  ontains(&succ) {
+0000d250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d260: 2020 2020 2063 6f6e 7469 6e75 653b 0a20       continue;. 
+0000d270: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0000d280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d290: 2075 7365 645f 696e 6465 7865 732e 696e   used_indexes.in
+0000d2a0: 7365 7274 2873 7563 6329 3b0a 2020 2020  sert(succ);.    
+0000d2b0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+0000d2c0: 6d75 7420 6d75 6c74 6970 6c69 6369 7479  mut multiplicity
+0000d2d0: 3a20 7573 697a 6520 3d20 303b 0a20 2020  : usize = 0;.   
+0000d2e0: 2020 2020 2020 2020 2020 2020 206c 6574               let
+0000d2f0: 2072 6177 5f65 6467 6573 203d 2064 6167   raw_edges = dag
+0000d300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d310: 2020 2020 202e 6772 6170 680a 2020 2020       .graph.    
+0000d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d330: 2e65 6467 6573 5f64 6972 6563 7465 6428  .edges_directed(
+0000d340: 2a6e 6f64 652c 2070 6574 6772 6170 683a  *node, petgraph:
+0000d350: 3a44 6972 6563 7469 6f6e 3a3a 4f75 7467  :Direction::Outg
+0000d360: 6f69 6e67 293b 0a20 2020 2020 2020 2020  oing);.         
+0000d370: 2020 2020 2020 2066 6f72 2065 6467 6520         for edge 
+0000d380: 696e 2072 6177 5f65 6467 6573 207b 0a20  in raw_edges {. 
+0000d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d3a0: 2020 2069 6620 6564 6765 2e74 6172 6765     if edge.targe
+0000d3b0: 7428 2920 3d3d 2073 7563 6320 7b0a 2020  t() == succ {.  
+0000d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d3d0: 2020 2020 2020 6d75 6c74 6970 6c69 6369        multiplici
+0000d3e0: 7479 202b 3d20 313b 0a20 2020 2020 2020  ty += 1;.       
+0000d3f0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+0000d400: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0000d410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d420: 2070 7265 6465 6365 7373 6f72 5f63 6f75   predecessor_cou
+0000d430: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+0000d440: 2020 2020 2020 202e 656e 7472 7928 7375         .entry(su
+0000d450: 6363 290a 2020 2020 2020 2020 2020 2020  cc).            
+0000d460: 2020 2020 2020 2020 2e61 6e64 5f6d 6f64          .and_mod
+0000d470: 6966 7928 7c65 7c20 2a65 202d 3d20 6d75  ify(|e| *e -= mu
+0000d480: 6c74 6970 6c69 6369 7479 290a 2020 2020  ltiplicity).    
+0000d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4a0: 2e6f 725f 696e 7365 7274 2864 6167 2e69  .or_insert(dag.i
+0000d4b0: 6e5f 6465 6772 6565 2873 7563 632e 696e  n_degree(succ.in
+0000d4c0: 6465 7828 2929 202d 206d 756c 7469 706c  dex()) - multipl
+0000d4d0: 6963 6974 7929 3b0a 2020 2020 2020 2020  icity);.        
+0000d4e0: 2020 2020 2020 2020 6966 202a 7072 6564          if *pred
+0000d4f0: 6563 6573 736f 725f 636f 756e 742e 6765  ecessor_count.ge
+0000d500: 7428 2673 7563 6329 2e75 6e77 7261 7028  t(&succ).unwrap(
+0000d510: 2920 3d3d 2030 207b 0a20 2020 2020 2020  ) == 0 {.       
+0000d520: 2020 2020 2020 2020 2020 2020 206e 6578               nex
+0000d530: 745f 6c61 7965 722e 7075 7368 2873 7563  t_layer.push(suc
+0000d540: 6329 3b0a 2020 2020 2020 2020 2020 2020  c);.            
+0000d550: 2020 2020 2020 2020 7072 6564 6563 6573          predeces
+0000d560: 736f 725f 636f 756e 742e 7265 6d6f 7665  sor_count.remove
+0000d570: 2826 7375 6363 293b 0a20 2020 2020 2020  (&succ);.       
+0000d580: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000d590: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000d5a0: 207d 0a20 2020 2020 2020 206c 6574 206d   }.        let m
+0000d5b0: 7574 206c 6179 6572 5f6e 6f64 655f 6461  ut layer_node_da
+0000d5c0: 7461 3a20 5665 633c 2650 794f 626a 6563  ta: Vec<&PyObjec
+0000d5d0: 743e 203d 2056 6563 3a3a 6e65 7728 293b  t> = Vec::new();
+0000d5e0: 0a20 2020 2020 2020 2066 6f72 206c 6179  .        for lay
+0000d5f0: 6572 5f6e 6f64 6520 696e 2026 6e65 7874  er_node in &next
+0000d600: 5f6c 6179 6572 207b 0a20 2020 2020 2020  _layer {.       
+0000d610: 2020 2020 206c 6179 6572 5f6e 6f64 655f       layer_node_
+0000d620: 6461 7461 2e70 7573 6828 2664 6167 5b2a  data.push(&dag[*
+0000d630: 6c61 7965 725f 6e6f 6465 5d29 3b0a 2020  layer_node]);.  
+0000d640: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0000d650: 6966 2021 6c61 7965 725f 6e6f 6465 5f64  if !layer_node_d
+0000d660: 6174 612e 6973 5f65 6d70 7479 2829 207b  ata.is_empty() {
+0000d670: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+0000d680: 7075 742e 7075 7368 286c 6179 6572 5f6e  put.push(layer_n
+0000d690: 6f64 655f 6461 7461 293b 0a20 2020 2020  ode_data);.     
+0000d6a0: 2020 207d 0a20 2020 2020 2020 2063 7572     }.        cur
+0000d6b0: 5f6c 6179 6572 203d 206e 6578 745f 6c61  _layer = next_la
+0000d6c0: 7965 723b 0a20 2020 2020 2020 206e 6578  yer;.        nex
+0000d6d0: 745f 6c61 7965 7220 3d20 5665 633a 3a6e  t_layer = Vec::n
+0000d6e0: 6577 2829 3b0a 2020 2020 7d0a 2020 2020  ew();.    }.    
+0000d6f0: 4f6b 2850 794c 6973 743a 3a6e 6577 2870  Ok(PyList::new(p
+0000d700: 792c 206f 7574 7075 7429 2e69 6e74 6f28  y, output).into(
+0000d710: 2929 0a7d 0a0a 2f2f 2f20 4765 7420 7468  )).}../// Get th
+0000d720: 6520 6469 7374 616e 6365 206d 6174 7269  e distance matri
+0000d730: 7820 666f 7220 6120 6469 7265 6374 6564  x for a directed
+0000d740: 2067 7261 7068 0a2f 2f2f 0a2f 2f2f 2054   graph.///./// T
+0000d750: 6869 7320 6469 6666 6572 7320 6672 6f6d  his differs from
+0000d760: 2066 756e 6374 696f 6e73 206c 696b 6520   functions like 
+0000d770: 6469 6772 6170 685f 666c 6f79 645f 7761  digraph_floyd_wa
+0000d780: 7273 6861 6c6c 5f6e 756d 7079 2069 6e20  rshall_numpy in 
+0000d790: 7468 6174 2074 6865 0a2f 2f2f 2065 6467  that the./// edg
+0000d7a0: 6520 7765 6967 6874 2f64 6174 6120 7061  e weight/data pa
+0000d7b0: 796c 6f61 6420 6973 206e 6f74 2075 7365  yload is not use
+0000d7c0: 6420 616e 6420 6561 6368 2065 6467 6520  d and each edge 
+0000d7d0: 6973 2074 7265 6174 6564 2061 7320 610a  is treated as a.
+0000d7e0: 2f2f 2f20 6469 7374 616e 6365 206f 6620  /// distance of 
+0000d7f0: 312e 0a2f 2f2f 0a2f 2f2f 2054 6869 7320  1..///./// This 
+0000d800: 6675 6e63 7469 6f6e 2069 7320 616c 736f  function is also
+0000d810: 206d 756c 7469 7468 7265 6164 6564 2061   multithreaded a
+0000d820: 6e64 2077 696c 6c20 7275 6e20 696e 2070  nd will run in p
+0000d830: 6172 616c 6c65 6c20 6966 2074 6865 206e  arallel if the n
+0000d840: 756d 6265 720a 2f2f 2f20 6f66 206e 6f64  umber./// of nod
+0000d850: 6573 2069 6e20 7468 6520 6772 6170 6820  es in the graph 
+0000d860: 6973 2061 626f 7665 2074 6865 2076 616c  is above the val
+0000d870: 7565 206f 6620 6060 7061 7261 6c6c 656c  ue of ``parallel
+0000d880: 5f74 6872 6573 686f 6c64 6060 2028 6974  _threshold`` (it
+0000d890: 0a2f 2f2f 2064 6566 6175 6c74 7320 746f  ./// defaults to
+0000d8a0: 2033 3030 292e 2049 6620 7468 6520 6675   300). If the fu
+0000d8b0: 6e63 7469 6f6e 2077 696c 6c20 6265 2072  nction will be r
+0000d8c0: 756e 6e69 6e67 2069 6e20 7061 7261 6c6c  unning in parall
+0000d8d0: 656c 2074 6865 2065 6e76 2076 6172 0a2f  el the env var./
+0000d8e0: 2f2f 2060 6052 4159 4f4e 5f4e 554d 5f54  // ``RAYON_NUM_T
+0000d8f0: 4852 4541 4453 6060 2063 616e 2062 6520  HREADS`` can be 
+0000d900: 7573 6564 2074 6f20 6164 6a75 7374 2068  used to adjust h
+0000d910: 6f77 206d 616e 7920 7468 7265 6164 7320  ow many threads 
+0000d920: 7769 6c6c 2062 6520 7573 6564 2e0a 2f2f  will be used..//
+0000d930: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
+0000d940: 6947 7261 7068 2067 7261 7068 3a20 5468  iGraph graph: Th
+0000d950: 6520 6772 6170 6820 746f 2067 6574 2074  e graph to get t
+0000d960: 6865 2064 6973 7461 6e63 6520 6d61 7472  he distance matr
+0000d970: 6978 2066 6f72 0a2f 2f2f 203a 7061 7261  ix for./// :para
+0000d980: 6d20 696e 7420 7061 7261 6c6c 656c 5f74  m int parallel_t
+0000d990: 6872 6573 686f 6c64 3a20 5468 6520 6e75  hreshold: The nu
+0000d9a0: 6d62 6572 206f 6620 6e6f 6465 7320 746f  mber of nodes to
+0000d9b0: 2063 616c 6375 6c61 7465 2074 6865 0a2f   calculate the./
+0000d9c0: 2f2f 2020 2020 2074 6865 2064 6973 7461  //     the dista
+0000d9d0: 6e63 6520 6d61 7472 6978 2069 6e20 7061  nce matrix in pa
+0000d9e0: 7261 6c6c 656c 2061 742e 2049 7420 6465  rallel at. It de
+0000d9f0: 6661 756c 7473 2074 6f20 3330 302c 2062  faults to 300, b
+0000da00: 7574 2074 6869 7320 6361 6e0a 2f2f 2f20  ut this can./// 
+0000da10: 2020 2020 6265 2074 756e 6564 0a2f 2f2f      be tuned.///
+0000da20: 203a 7061 7261 6d20 626f 6f6c 2061 735f   :param bool as_
+0000da30: 756e 6469 7265 6374 6564 3a20 4966 2073  undirected: If s
+0000da40: 6574 2074 6f20 6060 5472 7565 6060 2074  et to ``True`` t
+0000da50: 6865 2069 6e70 7574 2064 6972 6563 7465  he input directe
+0000da60: 6420 6772 6170 680a 2f2f 2f20 2020 2020  d graph.///     
+0000da70: 7769 6c6c 2062 6520 7472 6561 7420 6173  will be treat as
+0000da80: 2069 6620 6561 6368 2065 6467 6520 7761   if each edge wa
+0000da90: 7320 6269 6469 7265 6374 696f 6e61 6c2f  s bidirectional/
+0000daa0: 756e 6469 7265 6374 6564 2069 6e20 7468  undirected in th
+0000dab0: 650a 2f2f 2f20 2020 2020 6f75 7470 7574  e.///     output
+0000dac0: 2064 6973 7461 6e63 6520 6d61 7472 6978   distance matrix
+0000dad0: 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  ..///./// :retur
+0000dae0: 6e73 3a20 5468 6520 6469 7374 616e 6365  ns: The distance
+0000daf0: 206d 6174 7269 780a 2f2f 2f20 3a72 7479   matrix./// :rty
+0000db00: 7065 3a20 6e75 6d70 792e 6e64 6172 7261  pe: numpy.ndarra
+0000db10: 790a 235b 7079 6675 6e63 7469 6f6e 2870  y.#[pyfunction(p
+0000db20: 6172 616c 6c65 6c5f 7468 7265 7368 6f6c  arallel_threshol
+0000db30: 6420 3d20 2233 3030 222c 2061 735f 756e  d = "300", as_un
+0000db40: 6469 7265 6374 6564 203d 2022 6661 6c73  directed = "fals
+0000db50: 6522 295d 0a23 5b74 6578 745f 7369 676e  e")].#[text_sign
+0000db60: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+0000db70: 202f 2c20 7061 7261 6c6c 656c 5f74 6872   /, parallel_thr
+0000db80: 6573 686f 6c64 3d33 3030 2c20 6173 5f75  eshold=300, as_u
+0000db90: 6e64 6972 6563 7465 643d 4661 6c73 6529  ndirected=False)
+0000dba0: 225d 0a70 7562 2066 6e20 6469 6772 6170  "].pub fn digrap
+0000dbb0: 685f 6469 7374 616e 6365 5f6d 6174 7269  h_distance_matri
+0000dbc0: 7828 0a20 2020 2070 793a 2050 7974 686f  x(.    py: Pytho
+0000dbd0: 6e2c 0a20 2020 2067 7261 7068 3a20 2664  n,.    graph: &d
+0000dbe0: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
+0000dbf0: 682c 0a20 2020 2070 6172 616c 6c65 6c5f  h,.    parallel_
+0000dc00: 7468 7265 7368 6f6c 643a 2075 7369 7a65  threshold: usize
+0000dc10: 2c0a 2020 2020 6173 5f75 6e64 6972 6563  ,.    as_undirec
+0000dc20: 7465 643a 2062 6f6f 6c2c 0a29 202d 3e20  ted: bool,.) -> 
+0000dc30: 5079 5265 7375 6c74 3c50 794f 626a 6563  PyResult<PyObjec
+0000dc40: 743e 207b 0a20 2020 206c 6574 206e 203d  t> {.    let n =
+0000dc50: 2067 7261 7068 2e6e 6f64 655f 636f 756e   graph.node_coun
+0000dc60: 7428 293b 0a20 2020 206c 6574 206d 7574  t();.    let mut
+0000dc70: 206d 6174 7269 7820 3d20 4172 7261 7932   matrix = Array2
+0000dc80: 3a3a 3c66 3634 3e3a 3a7a 6572 6f73 2828  ::<f64>::zeros((
+0000dc90: 6e2c 206e 2929 3b0a 2020 2020 6c65 7420  n, n));.    let 
+0000dca0: 6266 735f 7472 6176 6572 7361 6c20 3d20  bfs_traversal = 
+0000dcb0: 7c69 6e64 6578 3a20 7573 697a 652c 206d  |index: usize, m
+0000dcc0: 7574 2072 6f77 3a20 4172 7261 7956 6965  ut row: ArrayVie
+0000dcd0: 774d 7574 313c 6636 343e 7c20 7b0a 2020  wMut1<f64>| {.  
+0000dce0: 2020 2020 2020 6c65 7420 6d75 7420 7365        let mut se
+0000dcf0: 656e 3a20 4861 7368 4d61 703c 4e6f 6465  en: HashMap<Node
+0000dd00: 496e 6465 782c 2075 7369 7a65 3e20 3d20  Index, usize> = 
+0000dd10: 4861 7368 4d61 703a 3a77 6974 685f 6361  HashMap::with_ca
+0000dd20: 7061 6369 7479 286e 293b 0a20 2020 2020  pacity(n);.     
+0000dd30: 2020 206c 6574 2073 7461 7274 5f69 6e64     let start_ind
+0000dd40: 6578 203d 204e 6f64 6549 6e64 6578 3a3a  ex = NodeIndex::
+0000dd50: 6e65 7728 696e 6465 7829 3b0a 2020 2020  new(index);.    
+0000dd60: 2020 2020 6c65 7420 6d75 7420 6c65 7665      let mut leve
+0000dd70: 6c20 3d20 303b 0a20 2020 2020 2020 206c  l = 0;.        l
+0000dd80: 6574 206d 7574 206e 6578 745f 6c65 7665  et mut next_leve
+0000dd90: 6c3a 2048 6173 6853 6574 3c4e 6f64 6549  l: HashSet<NodeI
+0000dda0: 6e64 6578 3e20 3d20 4861 7368 5365 743a  ndex> = HashSet:
+0000ddb0: 3a6e 6577 2829 3b0a 2020 2020 2020 2020  :new();.        
+0000ddc0: 6e65 7874 5f6c 6576 656c 2e69 6e73 6572  next_level.inser
+0000ddd0: 7428 7374 6172 745f 696e 6465 7829 3b0a  t(start_index);.
+0000dde0: 2020 2020 2020 2020 7768 696c 6520 216e          while !n
+0000ddf0: 6578 745f 6c65 7665 6c2e 6973 5f65 6d70  ext_level.is_emp
+0000de00: 7479 2829 207b 0a20 2020 2020 2020 2020  ty() {.         
+0000de10: 2020 206c 6574 2074 6869 735f 6c65 7665     let this_leve
+0000de20: 6c20 3d20 6e65 7874 5f6c 6576 656c 3b0a  l = next_level;.
+0000de30: 2020 2020 2020 2020 2020 2020 6e65 7874              next
+0000de40: 5f6c 6576 656c 203d 2048 6173 6853 6574  _level = HashSet
+0000de50: 3a3a 6e65 7728 293b 0a20 2020 2020 2020  ::new();.       
+0000de60: 2020 2020 206c 6574 206d 7574 2066 6f75       let mut fou
+0000de70: 6e64 3a20 5665 633c 4e6f 6465 496e 6465  nd: Vec<NodeInde
+0000de80: 783e 203d 2056 6563 3a3a 6e65 7728 293b  x> = Vec::new();
+0000de90: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000dea0: 2076 2069 6e20 7468 6973 5f6c 6576 656c   v in this_level
+0000deb0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0000dec0: 2020 2069 6620 2173 6565 6e2e 636f 6e74     if !seen.cont
+0000ded0: 6169 6e73 5f6b 6579 2826 7629 207b 0a20  ains_key(&v) {. 
+0000dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000def0: 2020 2073 6565 6e2e 696e 7365 7274 2876     seen.insert(v
+0000df00: 2c20 6c65 7665 6c29 3b0a 2020 2020 2020  , level);.      
+0000df10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000df20: 756e 642e 7075 7368 2876 293b 0a20 2020  und.push(v);.   
+0000df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df40: 2072 6f77 5b5b 762e 696e 6465 7828 295d   row[[v.index()]
+0000df50: 5d20 3d20 6c65 7665 6c20 6173 2066 3634  ] = level as f64
+0000df60: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+0000df70: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0000df80: 7d0a 2020 2020 2020 2020 2020 2020 6966  }.            if
+0000df90: 2073 6565 6e2e 6c65 6e28 2920 3d3d 206e   seen.len() == n
+0000dfa0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0000dfb0: 2020 2072 6574 7572 6e3b 0a20 2020 2020     return;.     
+0000dfc0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000dfd0: 2020 2020 2066 6f72 206e 6f64 6520 696e       for node in
+0000dfe0: 2066 6f75 6e64 207b 0a20 2020 2020 2020   found {.       
+0000dff0: 2020 2020 2020 2020 2066 6f72 2076 2069           for v i
+0000e000: 6e20 6772 6170 680a 2020 2020 2020 2020  n graph.        
+0000e010: 2020 2020 2020 2020 2020 2020 2e67 7261              .gra
+0000e020: 7068 0a20 2020 2020 2020 2020 2020 2020  ph.             
+0000e030: 2020 2020 2020 202e 6e65 6967 6862 6f72         .neighbor
+0000e040: 735f 6469 7265 6374 6564 286e 6f64 652c  s_directed(node,
+0000e050: 2070 6574 6772 6170 683a 3a44 6972 6563   petgraph::Direc
+0000e060: 7469 6f6e 3a3a 4f75 7467 6f69 6e67 290a  tion::Outgoing).
+0000e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e080: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000e090: 2020 2020 2020 6e65 7874 5f6c 6576 656c        next_level
+0000e0a0: 2e69 6e73 6572 7428 7629 3b0a 2020 2020  .insert(v);.    
+0000e0b0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+0000e0c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000e0d0: 2061 735f 756e 6469 7265 6374 6564 207b   as_undirected {
+0000e0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e0f0: 2020 2020 2066 6f72 2076 2069 6e20 6772       for v in gr
+0000e100: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
+0000e110: 2020 2020 2020 2020 2020 2020 2e67 7261              .gra
+0000e120: 7068 0a20 2020 2020 2020 2020 2020 2020  ph.             
+0000e130: 2020 2020 2020 2020 2020 202e 6e65 6967             .neig
+0000e140: 6862 6f72 735f 6469 7265 6374 6564 286e  hbors_directed(n
+0000e150: 6f64 652c 2070 6574 6772 6170 683a 3a44  ode, petgraph::D
+0000e160: 6972 6563 7469 6f6e 3a3a 496e 636f 6d69  irection::Incomi
+0000e170: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+0000e180: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0000e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1a0: 2020 6e65 7874 5f6c 6576 656c 2e69 6e73    next_level.ins
+0000e1b0: 6572 7428 7629 3b0a 2020 2020 2020 2020  ert(v);.        
+0000e1c0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+0000e1d0: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+0000e1e0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+0000e1f0: 2020 2020 2020 2020 2020 6c65 7665 6c20            level 
+0000e200: 2b3d 2031 0a20 2020 2020 2020 207d 0a20  += 1.        }. 
+0000e210: 2020 207d 3b0a 2020 2020 6966 206e 203c     };.    if n <
+0000e220: 2070 6172 616c 6c65 6c5f 7468 7265 7368   parallel_thresh
+0000e230: 6f6c 6420 7b0a 2020 2020 2020 2020 6d61  old {.        ma
+0000e240: 7472 6978 0a20 2020 2020 2020 2020 2020  trix.           
+0000e250: 202e 6178 6973 5f69 7465 725f 6d75 7428   .axis_iter_mut(
+0000e260: 4178 6973 2830 2929 0a20 2020 2020 2020  Axis(0)).       
+0000e270: 2020 2020 202e 656e 756d 6572 6174 6528       .enumerate(
+0000e280: 290a 2020 2020 2020 2020 2020 2020 2e66  ).            .f
+0000e290: 6f72 5f65 6163 6828 7c28 696e 6465 782c  or_each(|(index,
+0000e2a0: 2072 6f77 297c 2062 6673 5f74 7261 7665   row)| bfs_trave
+0000e2b0: 7273 616c 2869 6e64 6578 2c20 726f 7729  rsal(index, row)
+0000e2c0: 293b 0a20 2020 207d 2065 6c73 6520 7b0a  );.    } else {.
+0000e2d0: 2020 2020 2020 2020 2f2f 2050 6172 616c          // Paral
+0000e2e0: 6c65 6c69 7a65 2062 7920 726f 7720 616e  lelize by row an
+0000e2f0: 6420 6974 6572 6174 6520 6672 6f6d 2065  d iterate from e
+0000e300: 6163 6820 726f 7720 696e 6465 7820 696e  ach row index in
+0000e310: 2042 4653 206f 7264 6572 0a20 2020 2020   BFS order.     
+0000e320: 2020 206d 6174 7269 780a 2020 2020 2020     matrix.      
+0000e330: 2020 2020 2020 2e61 7869 735f 6974 6572        .axis_iter
+0000e340: 5f6d 7574 2841 7869 7328 3029 290a 2020  _mut(Axis(0)).  
+0000e350: 2020 2020 2020 2020 2020 2e69 6e74 6f5f            .into_
+0000e360: 7061 725f 6974 6572 2829 0a20 2020 2020  par_iter().     
+0000e370: 2020 2020 2020 202e 656e 756d 6572 6174         .enumerat
+0000e380: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0000e390: 2e66 6f72 5f65 6163 6828 7c28 696e 6465  .for_each(|(inde
+0000e3a0: 782c 2072 6f77 297c 2062 6673 5f74 7261  x, row)| bfs_tra
+0000e3b0: 7665 7273 616c 2869 6e64 6578 2c20 726f  versal(index, ro
+0000e3c0: 7729 293b 0a20 2020 207d 0a20 2020 204f  w));.    }.    O
+0000e3d0: 6b28 6d61 7472 6978 2e69 6e74 6f5f 7079  k(matrix.into_py
+0000e3e0: 6172 7261 7928 7079 292e 696e 746f 2829  array(py).into()
+0000e3f0: 290a 7d0a 0a2f 2f2f 2047 6574 2074 6865  ).}../// Get the
+0000e400: 2064 6973 7461 6e63 6520 6d61 7472 6978   distance matrix
+0000e410: 2066 6f72 2061 6e20 756e 6469 7265 6374   for an undirect
+0000e420: 6564 2067 7261 7068 0a2f 2f2f 0a2f 2f2f  ed graph.///.///
+0000e430: 2054 6869 7320 6469 6666 6572 7320 6672   This differs fr
+0000e440: 6f6d 2066 756e 6374 696f 6e73 206c 696b  om functions lik
+0000e450: 6520 6469 6772 6170 685f 666c 6f79 645f  e digraph_floyd_
+0000e460: 7761 7273 6861 6c6c 5f6e 756d 7079 2069  warshall_numpy i
+0000e470: 6e20 7468 6174 2074 6865 0a2f 2f2f 2065  n that the./// e
+0000e480: 6467 6520 7765 6967 6874 2f64 6174 6120  dge weight/data 
+0000e490: 7061 796c 6f61 6420 6973 206e 6f74 2075  payload is not u
+0000e4a0: 7365 6420 616e 6420 6561 6368 2065 6467  sed and each edg
+0000e4b0: 6520 6973 2074 7265 6174 6564 2061 7320  e is treated as 
+0000e4c0: 610a 2f2f 2f20 6469 7374 616e 6365 206f  a./// distance o
+0000e4d0: 6620 312e 0a2f 2f2f 0a2f 2f2f 2054 6869  f 1..///./// Thi
+0000e4e0: 7320 6675 6e63 7469 6f6e 2069 7320 616c  s function is al
+0000e4f0: 736f 206d 756c 7469 7468 7265 6164 6564  so multithreaded
+0000e500: 2061 6e64 2077 696c 6c20 7275 6e20 696e   and will run in
+0000e510: 2070 6172 616c 6c65 6c20 6966 2074 6865   parallel if the
+0000e520: 206e 756d 6265 720a 2f2f 2f20 6f66 206e   number./// of n
+0000e530: 6f64 6573 2069 6e20 7468 6520 6772 6170  odes in the grap
+0000e540: 6820 6973 2061 626f 7665 2074 6865 2076  h is above the v
+0000e550: 616c 7565 206f 6620 6060 7061 7261 6c6c  alue of ``parall
+0000e560: 6c65 6c5f 7468 7265 7368 6f6c 6460 6020  lel_threshold`` 
+0000e570: 2869 740a 2f2f 2f20 6465 6661 756c 7473  (it./// defaults
+0000e580: 2074 6f20 3330 3029 2e20 4966 2074 6865   to 300). If the
+0000e590: 2066 756e 6374 696f 6e20 7769 6c6c 2062   function will b
+0000e5a0: 6520 7275 6e6e 696e 6720 696e 2070 6172  e running in par
+0000e5b0: 616c 6c65 6c20 7468 6520 656e 7620 7661  allel the env va
+0000e5c0: 720a 2f2f 2f20 6060 5241 594f 4e5f 4e55  r./// ``RAYON_NU
+0000e5d0: 4d5f 5448 5245 4144 5360 6020 6361 6e20  M_THREADS`` can 
+0000e5e0: 6265 2075 7365 6420 746f 2061 646a 7573  be used to adjus
+0000e5f0: 7420 686f 7720 6d61 6e79 2074 6872 6561  t how many threa
+0000e600: 6473 2077 696c 6c20 6265 2075 7365 642e  ds will be used.
+0000e610: 0a2f 2f2f 0a2f 2f2f 203a 7061 7261 6d20  .///./// :param 
+0000e620: 5079 4772 6170 6820 6772 6170 683a 2054  PyGraph graph: T
+0000e630: 6865 2067 7261 7068 2074 6f20 6765 7420  he graph to get 
+0000e640: 7468 6520 6469 7374 616e 6365 206d 6174  the distance mat
+0000e650: 7269 7820 666f 720a 2f2f 2f20 3a70 6172  rix for./// :par
+0000e660: 616d 2069 6e74 2070 6172 616c 6c65 6c5f  am int parallel_
+0000e670: 7468 7265 7368 6f6c 643a 2054 6865 206e  threshold: The n
+0000e680: 756d 6265 7220 6f66 206e 6f64 6573 2074  umber of nodes t
+0000e690: 6f20 6361 6c63 756c 6174 6520 7468 650a  o calculate the.
+0000e6a0: 2f2f 2f20 2020 2020 7468 6520 6469 7374  ///     the dist
+0000e6b0: 616e 6365 206d 6174 7269 7820 696e 2070  ance matrix in p
+0000e6c0: 6172 616c 6c65 6c20 6174 2e20 4974 2064  arallel at. It d
+0000e6d0: 6566 6175 6c74 7320 746f 2033 3030 2c20  efaults to 300, 
+0000e6e0: 6275 7420 7468 6973 2063 616e 0a2f 2f2f  but this can.///
+0000e6f0: 2020 2020 2062 6520 7475 6e65 640a 2f2f       be tuned.//
+0000e700: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+0000e710: 5468 6520 6469 7374 616e 6365 206d 6174  The distance mat
+0000e720: 7269 780a 2f2f 2f20 3a72 7479 7065 3a20  rix./// :rtype: 
+0000e730: 6e75 6d70 792e 6e64 6172 7261 790a 235b  numpy.ndarray.#[
+0000e740: 7079 6675 6e63 7469 6f6e 2870 6172 616c  pyfunction(paral
+0000e750: 6c65 6c5f 7468 7265 7368 6f6c 6420 3d20  lel_threshold = 
+0000e760: 2233 3030 2229 5d0a 235b 7465 7874 5f73  "300")].#[text_s
+0000e770: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+0000e780: 7068 2c20 2f2c 2070 6172 616c 6c65 6c5f  ph, /, parallel_
+0000e790: 7468 7265 7368 6f6c 643d 3330 3029 225d  threshold=300)"]
+0000e7a0: 0a70 7562 2066 6e20 6772 6170 685f 6469  .pub fn graph_di
+0000e7b0: 7374 616e 6365 5f6d 6174 7269 7828 0a20  stance_matrix(. 
+0000e7c0: 2020 2070 793a 2050 7974 686f 6e2c 0a20     py: Python,. 
+0000e7d0: 2020 2067 7261 7068 3a20 2667 7261 7068     graph: &graph
+0000e7e0: 3a3a 5079 4772 6170 682c 0a20 2020 2070  ::PyGraph,.    p
+0000e7f0: 6172 616c 6c65 6c5f 7468 7265 7368 6f6c  arallel_threshol
+0000e800: 643a 2075 7369 7a65 2c0a 2920 2d3e 2050  d: usize,.) -> P
+0000e810: 7952 6573 756c 743c 5079 4f62 6a65 6374  yResult<PyObject
+0000e820: 3e20 7b0a 2020 2020 6c65 7420 6e20 3d20  > {.    let n = 
+0000e830: 6772 6170 682e 6e6f 6465 5f63 6f75 6e74  graph.node_count
+0000e840: 2829 3b0a 2020 2020 6c65 7420 6d75 7420  ();.    let mut 
+0000e850: 6d61 7472 6978 203d 2041 7272 6179 323a  matrix = Array2:
+0000e860: 3a3c 6636 343e 3a3a 7a65 726f 7328 286e  :<f64>::zeros((n
+0000e870: 2c20 6e29 293b 0a20 2020 206c 6574 2062  , n));.    let b
+0000e880: 6673 5f74 7261 7665 7273 616c 203d 207c  fs_traversal = |
+0000e890: 696e 6465 783a 2075 7369 7a65 2c20 6d75  index: usize, mu
+0000e8a0: 7420 726f 773a 2041 7272 6179 5669 6577  t row: ArrayView
+0000e8b0: 4d75 7431 3c66 3634 3e7c 207b 0a20 2020  Mut1<f64>| {.   
+0000e8c0: 2020 2020 206c 6574 206d 7574 2073 6565       let mut see
+0000e8d0: 6e3a 2048 6173 684d 6170 3c4e 6f64 6549  n: HashMap<NodeI
+0000e8e0: 6e64 6578 2c20 7573 697a 653e 203d 2048  ndex, usize> = H
+0000e8f0: 6173 684d 6170 3a3a 7769 7468 5f63 6170  ashMap::with_cap
+0000e900: 6163 6974 7928 6e29 3b0a 2020 2020 2020  acity(n);.      
+0000e910: 2020 6c65 7420 7374 6172 745f 696e 6465    let start_inde
+0000e920: 7820 3d20 4e6f 6465 496e 6465 783a 3a6e  x = NodeIndex::n
+0000e930: 6577 2869 6e64 6578 293b 0a20 2020 2020  ew(index);.     
+0000e940: 2020 206c 6574 206d 7574 206c 6576 656c     let mut level
+0000e950: 203d 2030 3b0a 2020 2020 2020 2020 6c65   = 0;.        le
+0000e960: 7420 6d75 7420 6e65 7874 5f6c 6576 656c  t mut next_level
+0000e970: 3a20 4861 7368 5365 743c 4e6f 6465 496e  : HashSet<NodeIn
+0000e980: 6465 783e 203d 2048 6173 6853 6574 3a3a  dex> = HashSet::
+0000e990: 6e65 7728 293b 0a20 2020 2020 2020 206e  new();.        n
+0000e9a0: 6578 745f 6c65 7665 6c2e 696e 7365 7274  ext_level.insert
+0000e9b0: 2873 7461 7274 5f69 6e64 6578 293b 0a20  (start_index);. 
+0000e9c0: 2020 2020 2020 2077 6869 6c65 2021 6e65         while !ne
+0000e9d0: 7874 5f6c 6576 656c 2e69 735f 656d 7074  xt_level.is_empt
+0000e9e0: 7928 2920 7b0a 2020 2020 2020 2020 2020  y() {.          
+0000e9f0: 2020 6c65 7420 7468 6973 5f6c 6576 656c    let this_level
+0000ea00: 203d 206e 6578 745f 6c65 7665 6c3b 0a20   = next_level;. 
+0000ea10: 2020 2020 2020 2020 2020 206e 6578 745f             next_
+0000ea20: 6c65 7665 6c20 3d20 4861 7368 5365 743a  level = HashSet:
+0000ea30: 3a6e 6577 2829 3b0a 2020 2020 2020 2020  :new();.        
+0000ea40: 2020 2020 6c65 7420 6d75 7420 666f 756e      let mut foun
+0000ea50: 643a 2056 6563 3c4e 6f64 6549 6e64 6578  d: Vec<NodeIndex
+0000ea60: 3e20 3d20 5665 633a 3a6e 6577 2829 3b0a  > = Vec::new();.
+0000ea70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000ea80: 7620 696e 2074 6869 735f 6c65 7665 6c20  v in this_level 
+0000ea90: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000eaa0: 2020 6966 2021 7365 656e 2e63 6f6e 7461    if !seen.conta
+0000eab0: 696e 735f 6b65 7928 2676 2920 7b0a 2020  ins_key(&v) {.  
+0000eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ead0: 2020 7365 656e 2e69 6e73 6572 7428 762c    seen.insert(v,
+0000eae0: 206c 6576 656c 293b 0a20 2020 2020 2020   level);.       
+0000eaf0: 2020 2020 2020 2020 2020 2020 2066 6f75               fou
+0000eb00: 6e64 2e70 7573 6828 7629 3b0a 2020 2020  nd.push(v);.    
+0000eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb20: 726f 775b 5b76 2e69 6e64 6578 2829 5d5d  row[[v.index()]]
+0000eb30: 203d 206c 6576 656c 2061 7320 6636 343b   = level as f64;
+0000eb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eb50: 207d 0a20 2020 2020 2020 2020 2020 207d   }.            }
+0000eb60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000eb70: 7365 656e 2e6c 656e 2829 203d 3d20 6e20  seen.len() == n 
+0000eb80: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000eb90: 2020 7265 7475 726e 3b0a 2020 2020 2020    return;.      
+0000eba0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0000ebb0: 2020 2020 666f 7220 6e6f 6465 2069 6e20      for node in 
+0000ebc0: 666f 756e 6420 7b0a 2020 2020 2020 2020  found {.        
+0000ebd0: 2020 2020 2020 2020 666f 7220 7620 696e          for v in
+0000ebe0: 2067 7261 7068 2e67 7261 7068 2e6e 6569   graph.graph.nei
+0000ebf0: 6768 626f 7273 286e 6f64 6529 207b 0a20  ghbors(node) {. 
+0000ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec10: 2020 206e 6578 745f 6c65 7665 6c2e 696e     next_level.in
+0000ec20: 7365 7274 2876 293b 0a20 2020 2020 2020  sert(v);.       
+0000ec30: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000ec40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000ec50: 2020 2020 206c 6576 656c 202b 3d20 310a       level += 1.
+0000ec60: 2020 2020 2020 2020 7d0a 2020 2020 7d3b          }.    };
+0000ec70: 0a20 2020 2069 6620 6e20 3c20 7061 7261  .    if n < para
+0000ec80: 6c6c 656c 5f74 6872 6573 686f 6c64 207b  llel_threshold {
+0000ec90: 0a20 2020 2020 2020 206d 6174 7269 780a  .        matrix.
+0000eca0: 2020 2020 2020 2020 2020 2020 2e61 7869              .axi
+0000ecb0: 735f 6974 6572 5f6d 7574 2841 7869 7328  s_iter_mut(Axis(
+0000ecc0: 3029 290a 2020 2020 2020 2020 2020 2020  0)).            
+0000ecd0: 2e65 6e75 6d65 7261 7465 2829 0a20 2020  .enumerate().   
+0000ece0: 2020 2020 2020 2020 202e 666f 725f 6561           .for_ea
+0000ecf0: 6368 287c 2869 6e64 6578 2c20 726f 7729  ch(|(index, row)
+0000ed00: 7c20 6266 735f 7472 6176 6572 7361 6c28  | bfs_traversal(
+0000ed10: 696e 6465 782c 2072 6f77 2929 3b0a 2020  index, row));.  
+0000ed20: 2020 7d20 656c 7365 207b 0a20 2020 2020    } else {.     
+0000ed30: 2020 202f 2f20 5061 7261 6c6c 656c 697a     // Paralleliz
+0000ed40: 6520 6279 2072 6f77 2061 6e64 2069 7465  e by row and ite
+0000ed50: 7261 7465 2066 726f 6d20 6561 6368 2072  rate from each r
+0000ed60: 6f77 2069 6e64 6578 2069 6e20 4246 5320  ow index in BFS 
+0000ed70: 6f72 6465 720a 2020 2020 2020 2020 6d61  order.        ma
+0000ed80: 7472 6978 0a20 2020 2020 2020 2020 2020  trix.           
+0000ed90: 202e 6178 6973 5f69 7465 725f 6d75 7428   .axis_iter_mut(
+0000eda0: 4178 6973 2830 2929 0a20 2020 2020 2020  Axis(0)).       
+0000edb0: 2020 2020 202e 696e 746f 5f70 6172 5f69       .into_par_i
+0000edc0: 7465 7228 290a 2020 2020 2020 2020 2020  ter().          
+0000edd0: 2020 2e65 6e75 6d65 7261 7465 2829 0a20    .enumerate(). 
+0000ede0: 2020 2020 2020 2020 2020 202e 666f 725f             .for_
+0000edf0: 6561 6368 287c 2869 6e64 6578 2c20 726f  each(|(index, ro
+0000ee00: 7729 7c20 6266 735f 7472 6176 6572 7361  w)| bfs_traversa
+0000ee10: 6c28 696e 6465 782c 2072 6f77 2929 3b0a  l(index, row));.
+0000ee20: 2020 2020 7d0a 2020 2020 4f6b 286d 6174      }.    Ok(mat
+0000ee30: 7269 782e 696e 746f 5f70 7961 7272 6179  rix.into_pyarray
+0000ee40: 2870 7929 2e69 6e74 6f28 2929 0a7d 0a0a  (py).into()).}..
+0000ee50: 2f2f 2f20 5265 7475 726e 2074 6865 2061  /// Return the a
+0000ee60: 646a 6163 656e 6379 206d 6174 7269 7820  djacency matrix 
+0000ee70: 666f 7220 6120 5079 4469 4772 6170 6820  for a PyDiGraph 
+0000ee80: 6f62 6a65 6374 0a2f 2f2f 0a2f 2f2f 2049  object.///./// I
+0000ee90: 6e20 7468 6520 6361 7365 2077 6865 7265  n the case where
+0000eea0: 2074 6865 7265 2061 7265 206d 756c 7469   there are multi
+0000eeb0: 706c 6520 6564 6765 7320 6265 7477 6565  ple edges betwee
+0000eec0: 6e20 6e6f 6465 7320 7468 6520 7661 6c75  n nodes the valu
+0000eed0: 6520 696e 2074 6865 0a2f 2f2f 206f 7574  e in the./// out
+0000eee0: 7075 7420 6d61 7472 6978 2077 696c 6c20  put matrix will 
+0000eef0: 6265 2074 6865 2073 756d 206f 6620 7468  be the sum of th
+0000ef00: 6520 6564 6765 7327 2077 6569 6768 7473  e edges' weights
+0000ef10: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
+0000ef20: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
+0000ef30: 3a20 5468 6520 4469 4772 6170 6820 7573  : The DiGraph us
+0000ef40: 6564 2074 6f20 6765 6e65 7261 7465 2074  ed to generate t
+0000ef50: 6865 2061 646a 6163 656e 6379 206d 6174  he adjacency mat
+0000ef60: 7269 780a 2f2f 2f20 2020 2020 6672 6f6d  rix.///     from
+0000ef70: 0a2f 2f2f 203a 7061 7261 6d20 6361 6c6c  ./// :param call
+0000ef80: 6162 6c65 2077 6569 6768 745f 666e 3a20  able weight_fn: 
+0000ef90: 4120 6361 6c6c 6162 6c65 206f 626a 6563  A callable objec
+0000efa0: 7420 2866 756e 6374 696f 6e2c 206c 616d  t (function, lam
+0000efb0: 6264 612c 2065 7463 2920 7768 6963 680a  bda, etc) which.
+0000efc0: 2f2f 2f20 2020 2020 7769 6c6c 2062 6520  ///     will be 
+0000efd0: 7061 7373 6564 2074 6865 2065 6467 6520  passed the edge 
+0000efe0: 6f62 6a65 6374 2061 6e64 2065 7870 6563  object and expec
+0000eff0: 7465 6420 746f 2072 6574 7572 6e20 6120  ted to return a 
+0000f000: 6060 666c 6f61 7460 602e 2054 6869 730a  ``float``. This.
+0000f010: 2f2f 2f20 2020 2020 7465 6c6c 7320 7265  ///     tells re
+0000f020: 7477 6f72 6b78 2f72 7573 7420 686f 7720  tworkx/rust how 
+0000f030: 746f 2065 7874 7261 6374 2061 206e 756d  to extract a num
+0000f040: 6572 6963 616c 2077 6569 6768 7420 6173  erical weight as
+0000f050: 2061 2060 6066 6c6f 6174 6060 0a2f 2f2f   a ``float``.///
+0000f060: 2020 2020 2066 6f72 2065 6467 6520 6f62       for edge ob
+0000f070: 6a65 6374 2e20 536f 6d65 2073 696d 706c  ject. Some simpl
+0000f080: 6520 6578 616d 706c 6573 2061 7265 3a3a  e examples are::
+0000f090: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+0000f0a0: 2064 6167 5f61 646a 6163 656e 6379 5f6d   dag_adjacency_m
+0000f0b0: 6174 7269 7828 6461 672c 2077 6569 6768  atrix(dag, weigh
+0000f0c0: 745f 666e 3a20 6c61 6d62 6461 2078 3a20  t_fn: lambda x: 
+0000f0d0: 3129 0a2f 2f2f 0a2f 2f2f 2020 2020 2074  1).///.///     t
+0000f0e0: 6f20 7265 7475 726e 2061 2077 6569 6768  o return a weigh
+0000f0f0: 7420 6f66 2031 2066 6f72 2061 6c6c 2065  t of 1 for all e
+0000f100: 6467 6573 2e20 416c 736f 3a3a 0a2f 2f2f  dges. Also::.///
+0000f110: 0a2f 2f2f 2020 2020 2020 2020 2064 6167  .///         dag
+0000f120: 5f61 646a 6163 656e 6379 5f6d 6174 7269  _adjacency_matri
+0000f130: 7828 6461 672c 2077 6569 6768 745f 666e  x(dag, weight_fn
+0000f140: 3a20 6c61 6d62 6461 2078 3a20 666c 6f61  : lambda x: floa
+0000f150: 7428 7829 290a 2f2f 2f0a 2f2f 2f20 2020  t(x)).///.///   
+0000f160: 2020 746f 2063 6173 7420 7468 6520 6564    to cast the ed
+0000f170: 6765 206f 626a 6563 7420 6173 2061 2066  ge object as a f
+0000f180: 6c6f 6174 2061 7320 7468 6520 7765 6967  loat as the weig
+0000f190: 6874 2e20 4966 2074 6869 7320 6973 206e  ht. If this is n
+0000f1a0: 6f74 0a2f 2f2f 2020 2020 2073 7065 6369  ot.///     speci
+0000f1b0: 6669 6564 2061 2064 6566 6175 6c74 2076  fied a default v
+0000f1c0: 616c 7565 2028 6569 7468 6572 2060 6064  alue (either ``d
+0000f1d0: 6566 6175 6c74 5f77 6569 6768 7460 6020  efault_weight`` 
+0000f1e0: 6f72 2031 2920 7769 6c6c 2062 6520 7573  or 1) will be us
+0000f1f0: 6564 0a2f 2f2f 2020 2020 2066 6f72 2061  ed.///     for a
+0000f200: 6c6c 2065 6467 6573 2e0a 2f2f 2f20 3a70  ll edges../// :p
+0000f210: 6172 616d 2066 6c6f 6174 2064 6566 6175  aram float defau
+0000f220: 6c74 5f77 6569 6768 743a 2049 6620 6060  lt_weight: If ``
+0000f230: 7765 6967 6874 5f66 6e60 6020 6973 206e  weight_fn`` is n
+0000f240: 6f74 2075 7365 6420 7468 6973 2063 616e  ot used this can
+0000f250: 2062 650a 2f2f 2f20 2020 2020 6f70 7469   be.///     opti
+0000f260: 6f6e 616c 6c79 2075 7365 6420 746f 2073  onally used to s
+0000f270: 7065 6369 6679 2061 2064 6566 6175 6c74  pecify a default
+0000f280: 2077 6569 6768 7420 746f 2075 7365 2066   weight to use f
+0000f290: 6f72 2061 6c6c 2065 6467 6573 2e0a 2f2f  or all edges..//
+0000f2a0: 2f0a 2f2f 2f20 203a 7265 7475 726e 3a20  /.///  :return: 
+0000f2b0: 5468 6520 6164 6a61 6365 6e63 7920 6d61  The adjacency ma
+0000f2c0: 7472 6978 2066 6f72 2074 6865 2069 6e70  trix for the inp
+0000f2d0: 7574 2064 6167 2061 7320 6120 6e75 6d70  ut dag as a nump
+0000f2e0: 7920 6172 7261 790a 2f2f 2f20 203a 7274  y array.///  :rt
+0000f2f0: 7970 653a 206e 756d 7079 2e6e 6461 7272  ype: numpy.ndarr
+0000f300: 6179 0a23 5b70 7966 756e 6374 696f 6e28  ay.#[pyfunction(
+0000f310: 6465 6661 756c 745f 7765 6967 6874 203d  default_weight =
+0000f320: 2022 312e 3022 295d 0a23 5b74 6578 745f   "1.0")].#[text_
+0000f330: 7369 676e 6174 7572 6520 3d20 2228 6772  signature = "(gr
+0000f340: 6170 682c 202f 2c20 7765 6967 6874 5f66  aph, /, weight_f
+0000f350: 6e3d 4e6f 6e65 2c20 6465 6661 756c 745f  n=None, default_
+0000f360: 7765 6967 6874 3d31 2e30 2922 5d0a 666e  weight=1.0)"].fn
+0000f370: 2064 6967 7261 7068 5f61 646a 6163 656e   digraph_adjacen
+0000f380: 6379 5f6d 6174 7269 7828 0a20 2020 2070  cy_matrix(.    p
+0000f390: 793a 2050 7974 686f 6e2c 0a20 2020 2067  y: Python,.    g
+0000f3a0: 7261 7068 3a20 2664 6967 7261 7068 3a3a  raph: &digraph::
+0000f3b0: 5079 4469 4772 6170 682c 0a20 2020 2077  PyDiGraph,.    w
+0000f3c0: 6569 6768 745f 666e 3a20 4f70 7469 6f6e  eight_fn: Option
+0000f3d0: 3c50 794f 626a 6563 743e 2c0a 2020 2020  <PyObject>,.    
+0000f3e0: 6465 6661 756c 745f 7765 6967 6874 3a20  default_weight: 
+0000f3f0: 6636 342c 0a29 202d 3e20 5079 5265 7375  f64,.) -> PyResu
+0000f400: 6c74 3c50 794f 626a 6563 743e 207b 0a20  lt<PyObject> {. 
+0000f410: 2020 206c 6574 206e 203d 2067 7261 7068     let n = graph
+0000f420: 2e6e 6f64 655f 636f 756e 7428 293b 0a20  .node_count();. 
+0000f430: 2020 206c 6574 206d 7574 206d 6174 7269     let mut matri
+0000f440: 7820 3d20 4172 7261 7932 3a3a 3c66 3634  x = Array2::<f64
+0000f450: 3e3a 3a7a 6572 6f73 2828 6e2c 206e 2929  >::zeros((n, n))
+0000f460: 3b0a 2020 2020 666f 7220 2869 2c20 6a2c  ;.    for (i, j,
+0000f470: 2077 6569 6768 7429 2069 6e20 6765 745f   weight) in get_
+0000f480: 6564 6765 5f69 7465 725f 7769 7468 5f77  edge_iter_with_w
+0000f490: 6569 6768 7473 2867 7261 7068 2920 7b0a  eights(graph) {.
+0000f4a0: 2020 2020 2020 2020 6c65 7420 6564 6765          let edge
+0000f4b0: 5f77 6569 6768 7420 3d0a 2020 2020 2020  _weight =.      
+0000f4c0: 2020 2020 2020 7765 6967 6874 5f63 616c        weight_cal
+0000f4d0: 6c61 626c 6528 7079 2c20 2677 6569 6768  lable(py, &weigh
+0000f4e0: 745f 666e 2c20 2677 6569 6768 742c 2064  t_fn, &weight, d
+0000f4f0: 6566 6175 6c74 5f77 6569 6768 7429 3f3b  efault_weight)?;
+0000f500: 0a20 2020 2020 2020 206d 6174 7269 785b  .        matrix[
+0000f510: 5b69 2c20 6a5d 5d20 2b3d 2065 6467 655f  [i, j]] += edge_
+0000f520: 7765 6967 6874 3b0a 2020 2020 7d0a 2020  weight;.    }.  
+0000f530: 2020 4f6b 286d 6174 7269 782e 696e 746f    Ok(matrix.into
+0000f540: 5f70 7961 7272 6179 2870 7929 2e69 6e74  _pyarray(py).int
+0000f550: 6f28 2929 0a7d 0a0a 2f2f 2f20 5265 7475  o()).}../// Retu
+0000f560: 726e 2074 6865 2061 646a 6163 656e 6379  rn the adjacency
+0000f570: 206d 6174 7269 7820 666f 7220 6120 5079   matrix for a Py
+0000f580: 4772 6170 6820 636c 6173 730a 2f2f 2f0a  Graph class.///.
+0000f590: 2f2f 2f20 496e 2074 6865 2063 6173 6520  /// In the case 
+0000f5a0: 7768 6572 6520 7468 6572 6520 6172 6520  where there are 
+0000f5b0: 6d75 6c74 6970 6c65 2065 6467 6573 2062  multiple edges b
+0000f5c0: 6574 7765 656e 206e 6f64 6573 2074 6865  etween nodes the
+0000f5d0: 2076 616c 7565 2069 6e20 7468 650a 2f2f   value in the.//
+0000f5e0: 2f20 6f75 7470 7574 206d 6174 7269 7820  / output matrix 
+0000f5f0: 7769 6c6c 2062 6520 7468 6520 7375 6d20  will be the sum 
+0000f600: 6f66 2074 6865 2065 6467 6573 2720 7765  of the edges' we
+0000f610: 6967 6874 732e 0a2f 2f2f 0a2f 2f2f 203a  ights..///./// :
+0000f620: 7061 7261 6d20 5079 4772 6170 6820 6772  param PyGraph gr
+0000f630: 6170 683a 2054 6865 2067 7261 7068 2075  aph: The graph u
+0000f640: 7365 6420 746f 2067 656e 6572 6174 6520  sed to generate 
+0000f650: 7468 6520 6164 6a61 6365 6e63 7920 6d61  the adjacency ma
+0000f660: 7472 6978 2066 726f 6d0a 2f2f 2f20 3a70  trix from./// :p
+0000f670: 6172 616d 2077 6569 6768 745f 666e 3a20  aram weight_fn: 
+0000f680: 4120 6361 6c6c 6162 6c65 206f 626a 6563  A callable objec
+0000f690: 7420 2866 756e 6374 696f 6e2c 206c 616d  t (function, lam
+0000f6a0: 6264 612c 2065 7463 2920 7768 6963 680a  bda, etc) which.
+0000f6b0: 2f2f 2f20 2020 2020 7769 6c6c 2062 6520  ///     will be 
+0000f6c0: 7061 7373 6564 2074 6865 2065 6467 6520  passed the edge 
+0000f6d0: 6f62 6a65 6374 2061 6e64 2065 7870 6563  object and expec
+0000f6e0: 7465 6420 746f 2072 6574 7572 6e20 6120  ted to return a 
+0000f6f0: 6060 666c 6f61 7460 602e 2054 6869 730a  ``float``. This.
+0000f700: 2f2f 2f20 2020 2020 7465 6c6c 7320 7265  ///     tells re
+0000f710: 7477 6f72 6b78 2f72 7573 7420 686f 7720  tworkx/rust how 
+0000f720: 746f 2065 7874 7261 6374 2061 206e 756d  to extract a num
+0000f730: 6572 6963 616c 2077 6569 6768 7420 6173  erical weight as
+0000f740: 2061 2060 6066 6c6f 6174 6060 0a2f 2f2f   a ``float``.///
+0000f750: 2020 2020 2066 6f72 2065 6467 6520 6f62       for edge ob
+0000f760: 6a65 6374 2e20 536f 6d65 2073 696d 706c  ject. Some simpl
+0000f770: 6520 6578 616d 706c 6573 2061 7265 3a3a  e examples are::
+0000f780: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+0000f790: 2067 7261 7068 5f61 646a 6163 656e 6379   graph_adjacency
+0000f7a0: 5f6d 6174 7269 7828 6772 6170 682c 2077  _matrix(graph, w
+0000f7b0: 6569 6768 745f 666e 3a20 6c61 6d62 6461  eight_fn: lambda
+0000f7c0: 2078 3a20 3129 0a2f 2f2f 0a2f 2f2f 2020   x: 1).///.///  
+0000f7d0: 2020 2074 6f20 7265 7475 726e 2061 2077     to return a w
+0000f7e0: 6569 6768 7420 6f66 2031 2066 6f72 2061  eight of 1 for a
+0000f7f0: 6c6c 2065 6467 6573 2e20 416c 736f 3a3a  ll edges. Also::
+0000f800: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+0000f810: 2067 7261 7068 5f61 646a 6163 656e 6379   graph_adjacency
+0000f820: 5f6d 6174 7269 7828 6772 6170 682c 2077  _matrix(graph, w
+0000f830: 6569 6768 745f 666e 3a20 6c61 6d62 6461  eight_fn: lambda
+0000f840: 2078 3a20 666c 6f61 7428 7829 290a 2f2f   x: float(x)).//
+0000f850: 2f0a 2f2f 2f20 2020 2020 746f 2063 6173  /.///     to cas
+0000f860: 7420 7468 6520 6564 6765 206f 626a 6563  t the edge objec
+0000f870: 7420 6173 2061 2066 6c6f 6174 2061 7320  t as a float as 
+0000f880: 7468 6520 7765 6967 6874 2e20 4966 2074  the weight. If t
+0000f890: 6869 7320 6973 206e 6f74 0a2f 2f2f 2020  his is not.///  
+0000f8a0: 2020 2073 7065 6369 6669 6564 2061 2064     specified a d
+0000f8b0: 6566 6175 6c74 2076 616c 7565 2028 6569  efault value (ei
+0000f8c0: 7468 6572 2060 6064 6566 6175 6c74 5f77  ther ``default_w
+0000f8d0: 6569 6768 7460 6020 6f72 2031 2920 7769  eight`` or 1) wi
+0000f8e0: 6c6c 2062 6520 7573 6564 0a2f 2f2f 2020  ll be used.///  
+0000f8f0: 2020 2066 6f72 2061 6c6c 2065 6467 6573     for all edges
+0000f900: 2e0a 2f2f 2f20 3a70 6172 616d 2066 6c6f  ../// :param flo
+0000f910: 6174 2064 6566 6175 6c74 5f77 6569 6768  at default_weigh
+0000f920: 743a 2049 6620 6060 7765 6967 6874 5f66  t: If ``weight_f
+0000f930: 6e60 6020 6973 206e 6f74 2075 7365 6420  n`` is not used 
+0000f940: 7468 6973 2063 616e 2062 650a 2f2f 2f20  this can be./// 
+0000f950: 2020 2020 6f70 7469 6f6e 616c 6c79 2075      optionally u
+0000f960: 7365 6420 746f 2073 7065 6369 6679 2061  sed to specify a
+0000f970: 2064 6566 6175 6c74 2077 6569 6768 7420   default weight 
+0000f980: 746f 2075 7365 2066 6f72 2061 6c6c 2065  to use for all e
+0000f990: 6467 6573 2e0a 2f2f 2f0a 2f2f 2f20 3a72  dges..///./// :r
+0000f9a0: 6574 7572 6e3a 2054 6865 2061 646a 6163  eturn: The adjac
+0000f9b0: 656e 6379 206d 6174 7269 7820 666f 7220  ency matrix for 
+0000f9c0: 7468 6520 696e 7075 7420 6461 6720 6173  the input dag as
+0000f9d0: 2061 206e 756d 7079 2061 7272 6179 0a2f   a numpy array./
+0000f9e0: 2f2f 203a 7274 7970 653a 206e 756d 7079  // :rtype: numpy
+0000f9f0: 2e6e 6461 7272 6179 0a23 5b70 7966 756e  .ndarray.#[pyfun
+0000fa00: 6374 696f 6e28 6465 6661 756c 745f 7765  ction(default_we
+0000fa10: 6967 6874 203d 2022 312e 3022 295d 0a23  ight = "1.0")].#
+0000fa20: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
+0000fa30: 3d20 2228 6772 6170 682c 202f 2c20 7765  = "(graph, /, we
+0000fa40: 6967 6874 5f66 6e3d 4e6f 6e65 2c20 6465  ight_fn=None, de
+0000fa50: 6661 756c 745f 7765 6967 6874 3d31 2e30  fault_weight=1.0
+0000fa60: 2922 5d0a 666e 2067 7261 7068 5f61 646a  )"].fn graph_adj
+0000fa70: 6163 656e 6379 5f6d 6174 7269 7828 0a20  acency_matrix(. 
+0000fa80: 2020 2070 793a 2050 7974 686f 6e2c 0a20     py: Python,. 
+0000fa90: 2020 2067 7261 7068 3a20 2667 7261 7068     graph: &graph
+0000faa0: 3a3a 5079 4772 6170 682c 0a20 2020 2077  ::PyGraph,.    w
+0000fab0: 6569 6768 745f 666e 3a20 4f70 7469 6f6e  eight_fn: Option
+0000fac0: 3c50 794f 626a 6563 743e 2c0a 2020 2020  <PyObject>,.    
+0000fad0: 6465 6661 756c 745f 7765 6967 6874 3a20  default_weight: 
+0000fae0: 6636 342c 0a29 202d 3e20 5079 5265 7375  f64,.) -> PyResu
+0000faf0: 6c74 3c50 794f 626a 6563 743e 207b 0a20  lt<PyObject> {. 
+0000fb00: 2020 206c 6574 206e 203d 2067 7261 7068     let n = graph
+0000fb10: 2e6e 6f64 655f 636f 756e 7428 293b 0a20  .node_count();. 
+0000fb20: 2020 206c 6574 206d 7574 206d 6174 7269     let mut matri
+0000fb30: 7820 3d20 4172 7261 7932 3a3a 3c66 3634  x = Array2::<f64
+0000fb40: 3e3a 3a7a 6572 6f73 2828 6e2c 206e 2929  >::zeros((n, n))
+0000fb50: 3b0a 2020 2020 666f 7220 2869 2c20 6a2c  ;.    for (i, j,
+0000fb60: 2077 6569 6768 7429 2069 6e20 6765 745f   weight) in get_
+0000fb70: 6564 6765 5f69 7465 725f 7769 7468 5f77  edge_iter_with_w
+0000fb80: 6569 6768 7473 2867 7261 7068 2920 7b0a  eights(graph) {.
+0000fb90: 2020 2020 2020 2020 6c65 7420 6564 6765          let edge
+0000fba0: 5f77 6569 6768 7420 3d0a 2020 2020 2020  _weight =.      
+0000fbb0: 2020 2020 2020 7765 6967 6874 5f63 616c        weight_cal
+0000fbc0: 6c61 626c 6528 7079 2c20 2677 6569 6768  lable(py, &weigh
+0000fbd0: 745f 666e 2c20 2677 6569 6768 742c 2064  t_fn, &weight, d
+0000fbe0: 6566 6175 6c74 5f77 6569 6768 7429 3f3b  efault_weight)?;
+0000fbf0: 0a20 2020 2020 2020 206d 6174 7269 785b  .        matrix[
+0000fc00: 5b69 2c20 6a5d 5d20 2b3d 2065 6467 655f  [i, j]] += edge_
+0000fc10: 7765 6967 6874 3b0a 2020 2020 2020 2020  weight;.        
+0000fc20: 6d61 7472 6978 5b5b 6a2c 2069 5d5d 202b  matrix[[j, i]] +
+0000fc30: 3d20 6564 6765 5f77 6569 6768 743b 0a20  = edge_weight;. 
+0000fc40: 2020 207d 0a20 2020 204f 6b28 6d61 7472     }.    Ok(matr
+0000fc50: 6978 2e69 6e74 6f5f 7079 6172 7261 7928  ix.into_pyarray(
+0000fc60: 7079 292e 696e 746f 2829 290a 7d0a 0a2f  py).into()).}../
+0000fc70: 2f2f 2052 6574 7572 6e20 616c 6c20 7369  // Return all si
+0000fc80: 6d70 6c65 2070 6174 6873 2062 6574 7765  mple paths betwe
+0000fc90: 656e 2032 206e 6f64 6573 2069 6e20 6120  en 2 nodes in a 
+0000fca0: 5079 4772 6170 6820 6f62 6a65 6374 0a2f  PyGraph object./
+0000fcb0: 2f2f 0a2f 2f2f 2041 2073 696d 706c 6520  //./// A simple 
+0000fcc0: 7061 7468 2069 7320 6120 7061 7468 2077  path is a path w
+0000fcd0: 6974 6820 6e6f 2072 6570 6561 7465 6420  ith no repeated 
+0000fce0: 6e6f 6465 732e 0a2f 2f2f 0a2f 2f2f 203a  nodes..///./// :
+0000fcf0: 7061 7261 6d20 5079 4772 6170 6820 6772  param PyGraph gr
+0000fd00: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
+0000fd10: 6f20 6669 6e64 2074 6865 2070 6174 6820  o find the path 
+0000fd20: 696e 0a2f 2f2f 203a 7061 7261 6d20 696e  in./// :param in
+0000fd30: 7420 6672 6f6d 3a20 5468 6520 6e6f 6465  t from: The node
+0000fd40: 2069 6e64 6578 2074 6f20 6669 6e64 2074   index to find t
+0000fd50: 6865 2070 6174 6873 2066 726f 6d0a 2f2f  he paths from.//
+0000fd60: 2f20 3a70 6172 616d 2069 6e74 2074 6f3a  / :param int to:
+0000fd70: 2054 6865 206e 6f64 6520 696e 6465 7820   The node index 
+0000fd80: 746f 2066 696e 6420 7468 6520 7061 7468  to find the path
+0000fd90: 7320 746f 0a2f 2f2f 203a 7061 7261 6d20  s to./// :param 
+0000fda0: 696e 7420 6d69 6e5f 6465 7074 683a 2054  int min_depth: T
+0000fdb0: 6865 206d 696e 696d 756d 2064 6570 7468  he minimum depth
+0000fdc0: 206f 6620 7468 6520 7061 7468 2074 6f20   of the path to 
+0000fdd0: 696e 636c 7564 6520 696e 2074 6865 206f  include in the o
+0000fde0: 7574 7075 740a 2f2f 2f20 2020 2020 6c69  utput.///     li
+0000fdf0: 7374 206f 6620 7061 7468 732e 2042 7920  st of paths. By 
+0000fe00: 6465 6661 756c 7420 616c 6c20 7061 7468  default all path
+0000fe10: 7320 6172 6520 696e 636c 7564 6564 2072  s are included r
+0000fe20: 6567 6172 646c 6573 7320 6f66 2064 6570  egardless of dep
+0000fe30: 7468 2c0a 2f2f 2f20 2020 2020 7365 7474  th,.///     sett
+0000fe40: 696e 6720 746f 2030 2077 696c 6c20 6265  ing to 0 will be
+0000fe50: 6861 7665 206c 696b 6520 7468 6520 6465  have like the de
+0000fe60: 6661 756c 742e 0a2f 2f2f 203a 7061 7261  fault../// :para
+0000fe70: 6d20 696e 7420 6375 746f 6666 3a20 5468  m int cutoff: Th
+0000fe80: 6520 6d61 7869 6d75 6d20 6465 7074 6820  e maximum depth 
+0000fe90: 6f66 2070 6174 6820 746f 2069 6e63 6c75  of path to inclu
+0000fea0: 6465 2069 6e20 7468 6520 6f75 7470 7574  de in the output
+0000feb0: 206c 6973 740a 2f2f 2f20 2020 2020 6f66   list.///     of
+0000fec0: 2070 6174 6873 2e20 4279 2064 6566 6175   paths. By defau
+0000fed0: 6c74 2069 6e63 6c75 6465 7320 616c 6c20  lt includes all 
+0000fee0: 7061 7468 7320 7265 6761 7264 6c65 7373  paths regardless
+0000fef0: 206f 6620 6465 7074 682c 2073 6574 7469   of depth, setti
+0000ff00: 6e67 2074 6f0a 2f2f 2f20 2020 2020 3020  ng to.///     0 
+0000ff10: 7769 6c6c 2062 6568 6176 6520 6c69 6b65  will behave like
+0000ff20: 2064 6566 6175 6c74 2e0a 2f2f 2f0a 2f2f   default..///.//
+0000ff30: 2f20 3a72 6574 7572 6e73 3a20 4120 6c69  / :returns: A li
+0000ff40: 7374 206f 6620 6c69 7374 7320 7768 6572  st of lists wher
+0000ff50: 6520 6561 6368 2069 6e6e 6572 206c 6973  e each inner lis
+0000ff60: 7420 6973 2061 2070 6174 6820 6f66 206e  t is a path of n
+0000ff70: 6f64 6520 696e 6469 6365 730a 2f2f 2f20  ode indices./// 
+0000ff80: 3a72 7479 7065 3a20 6c69 7374 0a23 5b70  :rtype: list.#[p
+0000ff90: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
+0000ffa0: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+0000ffb0: 6772 6170 682c 2066 726f 6d2c 2074 6f2c  graph, from, to,
+0000ffc0: 202f 2c20 6d69 6e3d 4e6f 6e65 2c20 6375   /, min=None, cu
+0000ffd0: 746f 6666 3d4e 6f6e 6529 225d 0a66 6e20  toff=None)"].fn 
+0000ffe0: 6772 6170 685f 616c 6c5f 7369 6d70 6c65  graph_all_simple
+0000fff0: 5f70 6174 6873 280a 2020 2020 6772 6170  _paths(.    grap
+00010000: 683a 2026 6772 6170 683a 3a50 7947 7261  h: &graph::PyGra
+00010010: 7068 2c0a 2020 2020 6672 6f6d 3a20 7573  ph,.    from: us
+00010020: 697a 652c 0a20 2020 2074 6f3a 2075 7369  ize,.    to: usi
+00010030: 7a65 2c0a 2020 2020 6d69 6e5f 6465 7074  ze,.    min_dept
+00010040: 683a 204f 7074 696f 6e3c 7573 697a 653e  h: Option<usize>
+00010050: 2c0a 2020 2020 6375 746f 6666 3a20 4f70  ,.    cutoff: Op
+00010060: 7469 6f6e 3c75 7369 7a65 3e2c 0a29 202d  tion<usize>,.) -
+00010070: 3e20 5079 5265 7375 6c74 3c56 6563 3c56  > PyResult<Vec<V
+00010080: 6563 3c75 7369 7a65 3e3e 3e20 7b0a 2020  ec<usize>>> {.  
+00010090: 2020 6c65 7420 6672 6f6d 5f69 6e64 6578    let from_index
+000100a0: 203d 204e 6f64 6549 6e64 6578 3a3a 6e65   = NodeIndex::ne
+000100b0: 7728 6672 6f6d 293b 0a20 2020 2069 6620  w(from);.    if 
+000100c0: 2167 7261 7068 2e67 7261 7068 2e63 6f6e  !graph.graph.con
+000100d0: 7461 696e 735f 6e6f 6465 2866 726f 6d5f  tains_node(from_
+000100e0: 696e 6465 7829 207b 0a20 2020 2020 2020  index) {.       
+000100f0: 2072 6574 7572 6e20 4572 7228 496e 7661   return Err(Inva
+00010100: 6c69 644e 6f64 653a 3a6e 6577 5f65 7272  lidNode::new_err
+00010110: 280a 2020 2020 2020 2020 2020 2020 2254  (.            "T
+00010120: 6865 2069 6e70 7574 2069 6e64 6578 2066  he input index f
+00010130: 6f72 2027 6672 6f6d 2720 6973 206e 6f74  or 'from' is not
+00010140: 2061 2076 616c 6964 206e 6f64 6520 696e   a valid node in
+00010150: 6465 7822 2c0a 2020 2020 2020 2020 2929  dex",.        ))
+00010160: 3b0a 2020 2020 7d0a 2020 2020 6c65 7420  ;.    }.    let 
+00010170: 746f 5f69 6e64 6578 203d 204e 6f64 6549  to_index = NodeI
+00010180: 6e64 6578 3a3a 6e65 7728 746f 293b 0a20  ndex::new(to);. 
+00010190: 2020 2069 6620 2167 7261 7068 2e67 7261     if !graph.gra
+000101a0: 7068 2e63 6f6e 7461 696e 735f 6e6f 6465  ph.contains_node
+000101b0: 2874 6f5f 696e 6465 7829 207b 0a20 2020  (to_index) {.   
+000101c0: 2020 2020 2072 6574 7572 6e20 4572 7228       return Err(
+000101d0: 496e 7661 6c69 644e 6f64 653a 3a6e 6577  InvalidNode::new
+000101e0: 5f65 7272 280a 2020 2020 2020 2020 2020  _err(.          
+000101f0: 2020 2254 6865 2069 6e70 7574 2069 6e64    "The input ind
+00010200: 6578 2066 6f72 2027 746f 2720 6973 206e  ex for 'to' is n
+00010210: 6f74 2061 2076 616c 6964 206e 6f64 6520  ot a valid node 
+00010220: 696e 6465 7822 2c0a 2020 2020 2020 2020  index",.        
+00010230: 2929 3b0a 2020 2020 7d0a 2020 2020 6c65  ));.    }.    le
+00010240: 7420 6d69 6e5f 696e 7465 726d 6564 6961  t min_intermedia
+00010250: 7465 5f6e 6f64 6573 3a20 7573 697a 6520  te_nodes: usize 
+00010260: 3d20 6d61 7463 6820 6d69 6e5f 6465 7074  = match min_dept
+00010270: 6820 7b0a 2020 2020 2020 2020 536f 6d65  h {.        Some
+00010280: 2864 6570 7468 2920 3d3e 2064 6570 7468  (depth) => depth
+00010290: 202d 2032 2c0a 2020 2020 2020 2020 4e6f   - 2,.        No
+000102a0: 6e65 203d 3e20 302c 0a20 2020 207d 3b0a  ne => 0,.    };.
+000102b0: 2020 2020 6c65 7420 6375 746f 6666 5f70      let cutoff_p
+000102c0: 6574 6772 6170 683a 204f 7074 696f 6e3c  etgraph: Option<
+000102d0: 7573 697a 653e 203d 2063 7574 6f66 662e  usize> = cutoff.
+000102e0: 6d61 7028 7c64 6570 7468 7c20 6465 7074  map(|depth| dept
+000102f0: 6820 2d20 3229 3b0a 2020 2020 6c65 7420  h - 2);.    let 
+00010300: 7265 7375 6c74 3a20 5665 633c 5665 633c  result: Vec<Vec<
+00010310: 7573 697a 653e 3e20 3d20 616c 676f 3a3a  usize>> = algo::
+00010320: 616c 6c5f 7369 6d70 6c65 5f70 6174 6873  all_simple_paths
+00010330: 280a 2020 2020 2020 2020 6772 6170 682c  (.        graph,
+00010340: 0a20 2020 2020 2020 2066 726f 6d5f 696e  .        from_in
+00010350: 6465 782c 0a20 2020 2020 2020 2074 6f5f  dex,.        to_
+00010360: 696e 6465 782c 0a20 2020 2020 2020 206d  index,.        m
+00010370: 696e 5f69 6e74 6572 6d65 6469 6174 655f  in_intermediate_
+00010380: 6e6f 6465 732c 0a20 2020 2020 2020 2063  nodes,.        c
+00010390: 7574 6f66 665f 7065 7467 7261 7068 2c0a  utoff_petgraph,.
+000103a0: 2020 2020 290a 2020 2020 2e6d 6170 287c      ).    .map(|
+000103b0: 763a 2056 6563 3c4e 6f64 6549 6e64 6578  v: Vec<NodeIndex
+000103c0: 3e7c 2076 2e69 6e74 6f5f 6974 6572 2829  >| v.into_iter()
+000103d0: 2e6d 6170 287c 697c 2069 2e69 6e64 6578  .map(|i| i.index
+000103e0: 2829 292e 636f 6c6c 6563 7428 2929 0a20  ()).collect()). 
+000103f0: 2020 202e 636f 6c6c 6563 7428 293b 0a20     .collect();. 
+00010400: 2020 204f 6b28 7265 7375 6c74 290a 7d0a     Ok(result).}.
+00010410: 0a2f 2f2f 2052 6574 7572 6e20 616c 6c20  ./// Return all 
+00010420: 7369 6d70 6c65 2070 6174 6873 2062 6574  simple paths bet
+00010430: 7765 656e 2032 206e 6f64 6573 2069 6e20  ween 2 nodes in 
+00010440: 6120 5079 4469 4772 6170 6820 6f62 6a65  a PyDiGraph obje
+00010450: 6374 0a2f 2f2f 0a2f 2f2f 2041 2073 696d  ct.///./// A sim
+00010460: 706c 6520 7061 7468 2069 7320 6120 7061  ple path is a pa
+00010470: 7468 2077 6974 6820 6e6f 2072 6570 6561  th with no repea
+00010480: 7465 6420 6e6f 6465 732e 0a2f 2f2f 0a2f  ted nodes..///./
+00010490: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
+000104a0: 6170 6820 6772 6170 683a 2054 6865 2067  aph graph: The g
+000104b0: 7261 7068 2074 6f20 6669 6e64 2074 6865  raph to find the
+000104c0: 2070 6174 6820 696e 0a2f 2f2f 203a 7061   path in./// :pa
+000104d0: 7261 6d20 696e 7420 6672 6f6d 3a20 5468  ram int from: Th
+000104e0: 6520 6e6f 6465 2069 6e64 6578 2074 6f20  e node index to 
+000104f0: 6669 6e64 2074 6865 2070 6174 6873 2066  find the paths f
+00010500: 726f 6d0a 2f2f 2f20 3a70 6172 616d 2069  rom./// :param i
+00010510: 6e74 2074 6f3a 2054 6865 206e 6f64 6520  nt to: The node 
+00010520: 696e 6465 7820 746f 2066 696e 6420 7468  index to find th
+00010530: 6520 7061 7468 7320 746f 0a2f 2f2f 203a  e paths to./// :
+00010540: 7061 7261 6d20 696e 7420 6d69 6e5f 6465  param int min_de
+00010550: 7074 683a 2054 6865 206d 696e 696d 756d  pth: The minimum
+00010560: 2064 6570 7468 206f 6620 7468 6520 7061   depth of the pa
+00010570: 7468 2074 6f20 696e 636c 7564 6520 696e  th to include in
+00010580: 2074 6865 206f 7574 7075 740a 2f2f 2f20   the output./// 
+00010590: 2020 2020 6c69 7374 206f 6620 7061 7468      list of path
+000105a0: 732e 2042 7920 6465 6661 756c 7420 616c  s. By default al
+000105b0: 6c20 7061 7468 7320 6172 6520 696e 636c  l paths are incl
+000105c0: 7564 6564 2072 6567 6172 646c 6573 7320  uded regardless 
+000105d0: 6f66 2064 6570 7468 2c0a 2f2f 2f20 2020  of depth,.///   
+000105e0: 2020 7365 7474 2074 6f20 3020 7769 6c6c    sett to 0 will
+000105f0: 2062 6568 6176 6520 6c69 6b65 2074 6865   behave like the
+00010600: 2064 6566 6175 6c74 2e0a 2f2f 2f20 3a70   default../// :p
+00010610: 6172 616d 2069 6e74 2063 7574 6f66 663a  aram int cutoff:
+00010620: 2054 6865 206d 6178 696d 756d 2064 6570   The maximum dep
+00010630: 7468 206f 6620 7061 7468 2074 6f20 696e  th of path to in
+00010640: 636c 7564 6520 696e 2074 6865 206f 7574  clude in the out
+00010650: 7075 7420 6c69 7374 0a2f 2f2f 2020 2020  put list.///    
+00010660: 206f 6620 7061 7468 732e 2042 7920 6465   of paths. By de
+00010670: 6661 756c 7420 696e 636c 7564 6573 2061  fault includes a
+00010680: 6c6c 2070 6174 6873 2072 6567 6172 646c  ll paths regardl
+00010690: 6573 7320 6f66 2064 6570 7468 2c20 7365  ess of depth, se
+000106a0: 7474 696e 6720 746f 0a2f 2f2f 2020 2020  tting to.///    
+000106b0: 2030 2077 696c 6c20 6265 6861 7665 206c   0 will behave l
+000106c0: 696b 6520 6465 6661 756c 742e 0a2f 2f2f  ike default..///
+000106d0: 0a2f 2f2f 203a 7265 7475 726e 733a 2041  ./// :returns: A
+000106e0: 206c 6973 7420 6f66 206c 6973 7473 2077   list of lists w
+000106f0: 6865 7265 2065 6163 6820 696e 6e65 7220  here each inner 
+00010700: 6c69 7374 2069 7320 6120 7061 7468 0a2f  list is a path./
+00010710: 2f2f 203a 7274 7970 653a 206c 6973 740a  // :rtype: list.
+00010720: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
+00010730: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+00010740: 2022 2867 7261 7068 2c20 6672 6f6d 2c20   "(graph, from, 
+00010750: 746f 2c20 2f2c 206d 696e 5f64 6570 7468  to, /, min_depth
+00010760: 3d4e 6f6e 652c 2063 7574 6f66 663d 4e6f  =None, cutoff=No
+00010770: 6e65 2922 5d0a 666e 2064 6967 7261 7068  ne)"].fn digraph
+00010780: 5f61 6c6c 5f73 696d 706c 655f 7061 7468  _all_simple_path
+00010790: 7328 0a20 2020 2067 7261 7068 3a20 2664  s(.    graph: &d
+000107a0: 6967 7261 7068 3a3a 5079 4469 4772 6170  igraph::PyDiGrap
+000107b0: 682c 0a20 2020 2066 726f 6d3a 2075 7369  h,.    from: usi
+000107c0: 7a65 2c0a 2020 2020 746f 3a20 7573 697a  ze,.    to: usiz
+000107d0: 652c 0a20 2020 206d 696e 5f64 6570 7468  e,.    min_depth
+000107e0: 3a20 4f70 7469 6f6e 3c75 7369 7a65 3e2c  : Option<usize>,
+000107f0: 0a20 2020 2063 7574 6f66 663a 204f 7074  .    cutoff: Opt
+00010800: 696f 6e3c 7573 697a 653e 2c0a 2920 2d3e  ion<usize>,.) ->
+00010810: 2050 7952 6573 756c 743c 5665 633c 5665   PyResult<Vec<Ve
+00010820: 633c 7573 697a 653e 3e3e 207b 0a20 2020  c<usize>>> {.   
+00010830: 206c 6574 2066 726f 6d5f 696e 6465 7820   let from_index 
+00010840: 3d20 4e6f 6465 496e 6465 783a 3a6e 6577  = NodeIndex::new
+00010850: 2866 726f 6d29 3b0a 2020 2020 6966 2021  (from);.    if !
+00010860: 6772 6170 682e 6772 6170 682e 636f 6e74  graph.graph.cont
+00010870: 6169 6e73 5f6e 6f64 6528 6672 6f6d 5f69  ains_node(from_i
+00010880: 6e64 6578 2920 7b0a 2020 2020 2020 2020  ndex) {.        
+00010890: 7265 7475 726e 2045 7272 2849 6e76 616c  return Err(Inval
+000108a0: 6964 4e6f 6465 3a3a 6e65 775f 6572 7228  idNode::new_err(
+000108b0: 0a20 2020 2020 2020 2020 2020 2022 5468  .            "Th
+000108c0: 6520 696e 7075 7420 696e 6465 7820 666f  e input index fo
+000108d0: 7220 2766 726f 6d27 2069 7320 6e6f 7420  r 'from' is not 
+000108e0: 6120 7661 6c69 6420 6e6f 6465 2069 6e64  a valid node ind
+000108f0: 6578 222c 0a20 2020 2020 2020 2029 293b  ex",.        ));
+00010900: 0a20 2020 207d 0a20 2020 206c 6574 2074  .    }.    let t
+00010910: 6f5f 696e 6465 7820 3d20 4e6f 6465 496e  o_index = NodeIn
+00010920: 6465 783a 3a6e 6577 2874 6f29 3b0a 2020  dex::new(to);.  
+00010930: 2020 6966 2021 6772 6170 682e 6772 6170    if !graph.grap
+00010940: 682e 636f 6e74 6169 6e73 5f6e 6f64 6528  h.contains_node(
+00010950: 746f 5f69 6e64 6578 2920 7b0a 2020 2020  to_index) {.    
+00010960: 2020 2020 7265 7475 726e 2045 7272 2849      return Err(I
+00010970: 6e76 616c 6964 4e6f 6465 3a3a 6e65 775f  nvalidNode::new_
+00010980: 6572 7228 0a20 2020 2020 2020 2020 2020  err(.           
+00010990: 2022 5468 6520 696e 7075 7420 696e 6465   "The input inde
+000109a0: 7820 666f 7220 2774 6f27 2069 7320 6e6f  x for 'to' is no
+000109b0: 7420 6120 7661 6c69 6420 6e6f 6465 2069  t a valid node i
+000109c0: 6e64 6578 222c 0a20 2020 2020 2020 2029  ndex",.        )
+000109d0: 293b 0a20 2020 207d 0a20 2020 206c 6574  );.    }.    let
+000109e0: 206d 696e 5f69 6e74 6572 6d65 6469 6174   min_intermediat
+000109f0: 655f 6e6f 6465 733a 2075 7369 7a65 203d  e_nodes: usize =
+00010a00: 206d 6174 6368 206d 696e 5f64 6570 7468   match min_depth
+00010a10: 207b 0a20 2020 2020 2020 2053 6f6d 6528   {.        Some(
+00010a20: 6465 7074 6829 203d 3e20 6465 7074 6820  depth) => depth 
+00010a30: 2d20 322c 0a20 2020 2020 2020 204e 6f6e  - 2,.        Non
+00010a40: 6520 3d3e 2030 2c0a 2020 2020 7d3b 0a20  e => 0,.    };. 
+00010a50: 2020 206c 6574 2063 7574 6f66 665f 7065     let cutoff_pe
+00010a60: 7467 7261 7068 3a20 4f70 7469 6f6e 3c75  tgraph: Option<u
+00010a70: 7369 7a65 3e20 3d20 6375 746f 6666 2e6d  size> = cutoff.m
+00010a80: 6170 287c 6465 7074 687c 2064 6570 7468  ap(|depth| depth
+00010a90: 202d 2032 293b 0a20 2020 206c 6574 2072   - 2);.    let r
+00010aa0: 6573 756c 743a 2056 6563 3c56 6563 3c75  esult: Vec<Vec<u
+00010ab0: 7369 7a65 3e3e 203d 2061 6c67 6f3a 3a61  size>> = algo::a
+00010ac0: 6c6c 5f73 696d 706c 655f 7061 7468 7328  ll_simple_paths(
+00010ad0: 0a20 2020 2020 2020 2067 7261 7068 2c0a  .        graph,.
+00010ae0: 2020 2020 2020 2020 6672 6f6d 5f69 6e64          from_ind
+00010af0: 6578 2c0a 2020 2020 2020 2020 746f 5f69  ex,.        to_i
+00010b00: 6e64 6578 2c0a 2020 2020 2020 2020 6d69  ndex,.        mi
+00010b10: 6e5f 696e 7465 726d 6564 6961 7465 5f6e  n_intermediate_n
+00010b20: 6f64 6573 2c0a 2020 2020 2020 2020 6375  odes,.        cu
+00010b30: 746f 6666 5f70 6574 6772 6170 682c 0a20  toff_petgraph,. 
+00010b40: 2020 2029 0a20 2020 202e 6d61 7028 7c76     ).    .map(|v
+00010b50: 3a20 5665 633c 4e6f 6465 496e 6465 783e  : Vec<NodeIndex>
+00010b60: 7c20 762e 696e 746f 5f69 7465 7228 292e  | v.into_iter().
+00010b70: 6d61 7028 7c69 7c20 692e 696e 6465 7828  map(|i| i.index(
+00010b80: 2929 2e63 6f6c 6c65 6374 2829 290a 2020  )).collect()).  
+00010b90: 2020 2e63 6f6c 6c65 6374 2829 3b0a 2020    .collect();.  
+00010ba0: 2020 4f6b 2872 6573 756c 7429 0a7d 0a0a    Ok(result).}..
+00010bb0: 666e 2077 6569 6768 745f 6361 6c6c 6162  fn weight_callab
+00010bc0: 6c65 280a 2020 2020 7079 3a20 5079 7468  le(.    py: Pyth
+00010bd0: 6f6e 2c0a 2020 2020 7765 6967 6874 5f66  on,.    weight_f
+00010be0: 6e3a 2026 4f70 7469 6f6e 3c50 794f 626a  n: &Option<PyObj
+00010bf0: 6563 743e 2c0a 2020 2020 7765 6967 6874  ect>,.    weight
+00010c00: 3a20 2650 794f 626a 6563 742c 0a20 2020  : &PyObject,.   
+00010c10: 2064 6566 6175 6c74 3a20 6636 342c 0a29   default: f64,.)
+00010c20: 202d 3e20 5079 5265 7375 6c74 3c66 3634   -> PyResult<f64
+00010c30: 3e20 7b0a 2020 2020 6d61 7463 6820 7765  > {.    match we
+00010c40: 6967 6874 5f66 6e20 7b0a 2020 2020 2020  ight_fn {.      
+00010c50: 2020 536f 6d65 2877 6569 6768 745f 666e    Some(weight_fn
+00010c60: 2920 3d3e 207b 0a20 2020 2020 2020 2020  ) => {.         
+00010c70: 2020 206c 6574 2072 6573 203d 2077 6569     let res = wei
+00010c80: 6768 745f 666e 2e63 616c 6c31 2870 792c  ght_fn.call1(py,
+00010c90: 2028 7765 6967 6874 2c29 293f 3b0a 2020   (weight,))?;.  
+00010ca0: 2020 2020 2020 2020 2020 7265 732e 6578            res.ex
+00010cb0: 7472 6163 7428 7079 290a 2020 2020 2020  tract(py).      
+00010cc0: 2020 7d0a 2020 2020 2020 2020 4e6f 6e65    }.        None
+00010cd0: 203d 3e20 4f6b 2864 6566 6175 6c74 292c   => Ok(default),
+00010ce0: 0a20 2020 207d 0a7d 0a0a 2f2f 2f20 4669  .    }.}../// Fi
+00010cf0: 6e64 2074 6865 2073 686f 7274 6573 7420  nd the shortest 
+00010d00: 7061 7468 2066 726f 6d20 6120 6e6f 6465  path from a node
+00010d10: 0a2f 2f2f 0a2f 2f2f 2054 6869 7320 6675  .///./// This fu
+00010d20: 6e63 7469 6f6e 2077 696c 6c20 6765 6e65  nction will gene
+00010d30: 7261 7465 2074 6865 2073 686f 7274 6573  rate the shortes
+00010d40: 7420 7061 7468 2066 726f 6d20 6120 736f  t path from a so
+00010d50: 7572 6365 206e 6f64 6520 7573 696e 670a  urce node using.
+00010d60: 2f2f 2f20 4469 6a6b 7374 7261 2773 2061  /// Dijkstra's a
+00010d70: 6c67 6f72 6974 686d 2e0a 2f2f 2f0a 2f2f  lgorithm..///.//
+00010d80: 2f20 3a70 6172 616d 2050 7947 7261 7068  / :param PyGraph
+00010d90: 2067 7261 7068 3a0a 2f2f 2f20 3a70 6172   graph:./// :par
+00010da0: 616d 2069 6e74 2073 6f75 7263 653a 2054  am int source: T
+00010db0: 6865 206e 6f64 6520 696e 6465 7820 746f  he node index to
+00010dc0: 2066 696e 6420 7061 7468 7320 6672 6f6d   find paths from
+00010dd0: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
+00010de0: 7461 7267 6574 3a20 416e 206f 7074 696f  target: An optio
+00010df0: 6e61 6c20 7461 7267 6574 2074 6f20 6669  nal target to fi
+00010e00: 6e64 2061 2070 6174 6820 746f 0a2f 2f2f  nd a path to.///
+00010e10: 203a 7061 7261 6d20 7765 6967 6874 5f66   :param weight_f
+00010e20: 6e3a 2041 6e20 6f70 7469 6f6e 616c 2077  n: An optional w
+00010e30: 6569 6768 7420 6675 6e63 7469 6f6e 2066  eight function f
+00010e40: 6f72 2061 6e20 6564 6765 2e20 4974 2077  or an edge. It w
+00010e50: 696c 6c20 6163 6365 7074 0a2f 2f2f 2020  ill accept.///  
+00010e60: 2020 2061 2073 696e 676c 6520 6172 6775     a single argu
+00010e70: 6d65 6e74 2c20 7468 6520 6564 6765 2773  ment, the edge's
+00010e80: 2077 6569 6768 7420 6f62 6a65 6374 2061   weight object a
+00010e90: 6e64 2077 696c 6c20 7265 7475 726e 2061  nd will return a
+00010ea0: 2066 6c6f 6174 2077 6869 6368 0a2f 2f2f   float which.///
+00010eb0: 2020 2020 2077 696c 6c20 6265 2075 7365       will be use
+00010ec0: 6420 746f 2072 6570 7265 7365 6e74 2074  d to represent t
+00010ed0: 6865 2077 6569 6768 742f 636f 7374 206f  he weight/cost o
+00010ee0: 6620 7468 6520 6564 6765 0a2f 2f2f 203a  f the edge./// :
+00010ef0: 7061 7261 6d20 666c 6f61 7420 6465 6661  param float defa
+00010f00: 756c 745f 7765 6967 6874 3a20 4966 2060  ult_weight: If `
+00010f10: 6077 6569 6768 745f 666e 6060 2069 736e  `weight_fn`` isn
+00010f20: 2774 2073 7065 6369 6669 6564 2074 6869  't specified thi
+00010f30: 7320 6f70 7469 6f6e 616c 0a2f 2f2f 2020  s optional.///  
+00010f40: 2020 2066 6c6f 6174 2076 616c 7565 2077     float value w
+00010f50: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
+00010f60: 7468 6520 7765 6967 6874 2f63 6f73 7420  the weight/cost 
+00010f70: 6f66 2065 6163 6820 6564 6765 2e0a 2f2f  of each edge..//
+00010f80: 2f20 3a70 6172 616d 2062 6f6f 6c20 6173  / :param bool as
+00010f90: 5f75 6e64 6972 6563 7465 643a 2049 6620  _undirected: If 
+00010fa0: 7365 7420 746f 2074 7275 6520 7468 6520  set to true the 
+00010fb0: 6772 6170 6820 7769 6c6c 2062 6520 7472  graph will be tr
+00010fc0: 6561 7465 6420 6173 0a2f 2f2f 2020 2020  eated as.///    
+00010fd0: 2075 6e64 6972 6563 7465 6420 666f 7220   undirected for 
+00010fe0: 6669 6e64 696e 6720 7468 6520 7368 6f72  finding the shor
+00010ff0: 7465 7374 2070 6174 682e 0a2f 2f2f 0a2f  test path..///./
+00011000: 2f2f 203a 7265 7475 726e 3a20 4469 6374  // :return: Dict
+00011010: 696f 6e61 7279 206f 6620 7061 7468 732e  ionary of paths.
+00011020: 2054 6865 206b 6579 7320 6172 6520 6465   The keys are de
+00011030: 7374 696e 6174 696f 6e20 6e6f 6465 2069  stination node i
+00011040: 6e64 6963 6573 2061 6e64 0a2f 2f2f 2020  ndices and.///  
+00011050: 2020 2074 6865 2064 6963 7420 7661 6c75     the dict valu
+00011060: 6573 2061 7265 206c 6973 7473 206f 6620  es are lists of 
+00011070: 6e6f 6465 2069 6e64 6963 6573 206d 616b  node indices mak
+00011080: 696e 6720 7468 6520 7061 7468 2e0a 2f2f  ing the path..//
+00011090: 2f20 3a72 7479 7065 3a20 6469 6374 0a23  / :rtype: dict.#
+000110a0: 5b70 7966 756e 6374 696f 6e28 6465 6661  [pyfunction(defa
+000110b0: 756c 745f 7765 6967 6874 203d 2022 312e  ult_weight = "1.
+000110c0: 3022 2c20 6173 5f75 6e64 6972 6563 7465  0", as_undirecte
+000110d0: 6420 3d20 2266 616c 7365 2229 5d0a 235b  d = "false")].#[
+000110e0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+000110f0: 2022 2867 7261 7068 2c20 736f 7572 6365   "(graph, source
+00011100: 2c20 2f2c 2074 6172 6765 743d 4e6f 6e65  , /, target=None
+00011110: 2077 6569 6768 745f 666e 3d4e 6f6e 652c   weight_fn=None,
+00011120: 2064 6566 6175 6c74 5f77 6569 6768 743d   default_weight=
+00011130: 312e 3029 225d 0a70 7562 2066 6e20 6772  1.0)"].pub fn gr
+00011140: 6170 685f 6469 6a6b 7374 7261 5f73 686f  aph_dijkstra_sho
+00011150: 7274 6573 745f 7061 7468 7328 0a20 2020  rtest_paths(.   
+00011160: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
+00011170: 2067 7261 7068 3a20 2667 7261 7068 3a3a   graph: &graph::
+00011180: 5079 4772 6170 682c 0a20 2020 2073 6f75  PyGraph,.    sou
+00011190: 7263 653a 2075 7369 7a65 2c0a 2020 2020  rce: usize,.    
+000111a0: 7461 7267 6574 3a20 4f70 7469 6f6e 3c75  target: Option<u
+000111b0: 7369 7a65 3e2c 0a20 2020 2077 6569 6768  size>,.    weigh
+000111c0: 745f 666e 3a20 4f70 7469 6f6e 3c50 794f  t_fn: Option<PyO
+000111d0: 626a 6563 743e 2c0a 2020 2020 6465 6661  bject>,.    defa
+000111e0: 756c 745f 7765 6967 6874 3a20 6636 342c  ult_weight: f64,
+000111f0: 0a29 202d 3e20 5079 5265 7375 6c74 3c50  .) -> PyResult<P
+00011200: 6174 684d 6170 7069 6e67 3e20 7b0a 2020  athMapping> {.  
+00011210: 2020 6c65 7420 7374 6172 7420 3d20 4e6f    let start = No
+00011220: 6465 496e 6465 783a 3a6e 6577 2873 6f75  deIndex::new(sou
+00011230: 7263 6529 3b0a 2020 2020 6c65 7420 676f  rce);.    let go
+00011240: 616c 5f69 6e64 6578 3a20 4f70 7469 6f6e  al_index: Option
+00011250: 3c4e 6f64 6549 6e64 6578 3e20 3d20 7461  <NodeIndex> = ta
+00011260: 7267 6574 2e6d 6170 284e 6f64 6549 6e64  rget.map(NodeInd
+00011270: 6578 3a3a 6e65 7729 3b0a 2020 2020 6c65  ex::new);.    le
+00011280: 7420 6d75 7420 7061 7468 733a 2048 6173  t mut paths: Has
+00011290: 684d 6170 3c4e 6f64 6549 6e64 6578 2c20  hMap<NodeIndex, 
+000112a0: 5665 633c 4e6f 6465 496e 6465 783e 3e20  Vec<NodeIndex>> 
+000112b0: 3d0a 2020 2020 2020 2020 4861 7368 4d61  =.        HashMa
+000112c0: 703a 3a77 6974 685f 6361 7061 6369 7479  p::with_capacity
+000112d0: 2867 7261 7068 2e6e 6f64 655f 636f 756e  (graph.node_coun
+000112e0: 7428 2929 3b0a 2020 2020 6469 6a6b 7374  t());.    dijkst
+000112f0: 7261 3a3a 6469 6a6b 7374 7261 280a 2020  ra::dijkstra(.  
+00011300: 2020 2020 2020 6772 6170 682c 0a20 2020        graph,.   
+00011310: 2020 2020 2073 7461 7274 2c0a 2020 2020       start,.    
+00011320: 2020 2020 676f 616c 5f69 6e64 6578 2c0a      goal_index,.
+00011330: 2020 2020 2020 2020 7c65 7c20 7765 6967          |e| weig
+00011340: 6874 5f63 616c 6c61 626c 6528 7079 2c20  ht_callable(py, 
+00011350: 2677 6569 6768 745f 666e 2c20 652e 7765  &weight_fn, e.we
+00011360: 6967 6874 2829 2c20 6465 6661 756c 745f  ight(), default_
+00011370: 7765 6967 6874 292c 0a20 2020 2020 2020  weight),.       
+00011380: 2053 6f6d 6528 266d 7574 2070 6174 6873   Some(&mut paths
+00011390: 292c 0a20 2020 2029 3f3b 0a0a 2020 2020  ),.    )?;..    
+000113a0: 4f6b 2850 6174 684d 6170 7069 6e67 207b  Ok(PathMapping {
+000113b0: 0a20 2020 2020 2020 2070 6174 6873 3a20  .        paths: 
+000113c0: 7061 7468 730a 2020 2020 2020 2020 2020  paths.          
+000113d0: 2020 2e69 7465 7228 290a 2020 2020 2020    .iter().      
+000113e0: 2020 2020 2020 2e66 696c 7465 725f 6d61        .filter_ma
+000113f0: 7028 7c28 6b2c 2076 297c 207b 0a20 2020  p(|(k, v)| {.   
+00011400: 2020 2020 2020 2020 2020 2020 206c 6574               let
+00011410: 206b 5f69 6e74 203d 206b 2e69 6e64 6578   k_int = k.index
+00011420: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
+00011430: 2020 2020 6966 206b 5f69 6e74 203d 3d20      if k_int == 
+00011440: 736f 7572 6365 0a20 2020 2020 2020 2020  source.         
+00011450: 2020 2020 2020 2020 2020 207c 7c20 7461             || ta
+00011460: 7267 6574 2e69 735f 736f 6d65 2829 2026  rget.is_some() &
+00011470: 2620 7461 7267 6574 2e75 6e77 7261 7028  & target.unwrap(
+00011480: 2920 213d 206b 5f69 6e74 0a20 2020 2020  ) != k_int.     
+00011490: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+000114a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114b0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+000114c0: 2020 2020 2020 7d20 656c 7365 207b 0a20        } else {. 
+000114d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114e0: 2020 2053 6f6d 6528 280a 2020 2020 2020     Some((.      
+000114f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011500: 2020 6b2e 696e 6465 7828 292c 0a20 2020    k.index(),.   
+00011510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011520: 2020 2020 2076 2e69 7465 7228 292e 6d61       v.iter().ma
+00011530: 7028 7c78 7c20 782e 696e 6465 7828 2929  p(|x| x.index())
+00011540: 2e63 6f6c 6c65 6374 3a3a 3c56 6563 3c75  .collect::<Vec<u
+00011550: 7369 7a65 3e3e 2829 2c0a 2020 2020 2020  size>>(),.      
+00011560: 2020 2020 2020 2020 2020 2020 2020 2929                ))
+00011570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011580: 207d 0a20 2020 2020 2020 2020 2020 207d   }.            }
+00011590: 290a 2020 2020 2020 2020 2020 2020 2e63  ).            .c
+000115a0: 6f6c 6c65 6374 2829 2c0a 2020 2020 7d29  ollect(),.    })
+000115b0: 0a7d 0a0a 2f2f 2f20 4669 6e64 2074 6865  .}../// Find the
+000115c0: 2073 686f 7274 6573 7420 7061 7468 2066   shortest path f
+000115d0: 726f 6d20 6120 6e6f 6465 0a2f 2f2f 0a2f  rom a node.///./
+000115e0: 2f2f 2054 6869 7320 6675 6e63 7469 6f6e  // This function
+000115f0: 2077 696c 6c20 6765 6e65 7261 7465 2074   will generate t
+00011600: 6865 2073 686f 7274 6573 7420 7061 7468  he shortest path
+00011610: 2066 726f 6d20 6120 736f 7572 6365 206e   from a source n
+00011620: 6f64 6520 7573 696e 670a 2f2f 2f20 4469  ode using./// Di
+00011630: 6a6b 7374 7261 2773 2061 6c67 6f72 6974  jkstra's algorit
+00011640: 686d 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  hm..///./// :par
+00011650: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
+00011660: 7068 3a0a 2f2f 2f20 3a70 6172 616d 2069  ph:./// :param i
+00011670: 6e74 2073 6f75 7263 653a 2054 6865 206e  nt source: The n
+00011680: 6f64 6520 696e 6465 7820 746f 2066 696e  ode index to fin
+00011690: 6420 7061 7468 7320 6672 6f6d 0a2f 2f2f  d paths from.///
+000116a0: 203a 7061 7261 6d20 696e 7420 7461 7267   :param int targ
+000116b0: 6574 3a20 416e 206f 7074 696f 6e61 6c20  et: An optional 
+000116c0: 7461 7267 6574 2070 6174 6820 746f 2066  target path to f
+000116d0: 696e 6420 7468 6520 7061 7468 0a2f 2f2f  ind the path.///
+000116e0: 203a 7061 7261 6d20 7765 6967 6874 5f66   :param weight_f
+000116f0: 6e3a 2041 6e20 6f70 7469 6f6e 616c 2077  n: An optional w
+00011700: 6569 6768 7420 6675 6e63 7469 6f6e 2066  eight function f
+00011710: 6f72 2061 6e20 6564 6765 2e20 4974 2077  or an edge. It w
+00011720: 696c 6c20 6163 6365 7074 0a2f 2f2f 2020  ill accept.///  
+00011730: 2020 2061 2073 696e 676c 6520 6172 6775     a single argu
+00011740: 6d65 6e74 2c20 7468 6520 6564 6765 2773  ment, the edge's
+00011750: 2077 6569 6768 7420 6f62 6a65 6374 2061   weight object a
+00011760: 6e64 2077 696c 6c20 7265 7475 726e 2061  nd will return a
+00011770: 2066 6c6f 6174 2077 6869 6368 0a2f 2f2f   float which.///
+00011780: 2020 2020 2077 696c 6c20 6265 2075 7365       will be use
+00011790: 6420 746f 2072 6570 7265 7365 6e74 2074  d to represent t
+000117a0: 6865 2077 6569 6768 742f 636f 7374 206f  he weight/cost o
+000117b0: 6620 7468 6520 6564 6765 0a2f 2f2f 203a  f the edge./// :
+000117c0: 7061 7261 6d20 666c 6f61 7420 6465 6661  param float defa
+000117d0: 756c 745f 7765 6967 6874 3a20 4966 2060  ult_weight: If `
+000117e0: 6077 6569 6768 745f 666e 6060 2069 736e  `weight_fn`` isn
+000117f0: 2774 2073 7065 6369 6669 6564 2074 6869  't specified thi
+00011800: 7320 6f70 7469 6f6e 616c 0a2f 2f2f 2020  s optional.///  
+00011810: 2020 2066 6c6f 6174 2076 616c 7565 2077     float value w
+00011820: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
+00011830: 7468 6520 7765 6967 6874 2f63 6f73 7420  the weight/cost 
+00011840: 6f66 2065 6163 6820 6564 6765 2e0a 2f2f  of each edge..//
+00011850: 2f20 3a70 6172 616d 2062 6f6f 6c20 6173  / :param bool as
+00011860: 5f75 6e64 6972 6563 7465 643a 2049 6620  _undirected: If 
+00011870: 7365 7420 746f 2074 7275 6520 7468 6520  set to true the 
+00011880: 6772 6170 6820 7769 6c6c 2062 6520 7472  graph will be tr
+00011890: 6561 7465 6420 6173 0a2f 2f2f 2020 2020  eated as.///    
+000118a0: 2075 6e64 6972 6563 7465 6420 666f 7220   undirected for 
+000118b0: 6669 6e64 696e 6720 7468 6520 7368 6f72  finding the shor
+000118c0: 7465 7374 2070 6174 682e 0a2f 2f2f 0a2f  test path..///./
+000118d0: 2f2f 203a 7265 7475 726e 3a20 4469 6374  // :return: Dict
+000118e0: 696f 6e61 7279 206f 6620 7061 7468 732e  ionary of paths.
+000118f0: 2054 6865 206b 6579 7320 6172 6520 6465   The keys are de
+00011900: 7374 696e 6174 696f 6e20 6e6f 6465 2069  stination node i
+00011910: 6e64 6963 6573 2061 6e64 0a2f 2f2f 2020  ndices and.///  
+00011920: 2020 2074 6865 2064 6963 7420 7661 6c75     the dict valu
+00011930: 6573 2061 7265 206c 6973 7473 206f 6620  es are lists of 
+00011940: 6e6f 6465 2069 6e64 6963 6573 206d 616b  node indices mak
+00011950: 696e 6720 7468 6520 7061 7468 2e0a 2f2f  ing the path..//
+00011960: 2f20 3a72 7479 7065 3a20 6469 6374 0a23  / :rtype: dict.#
+00011970: 5b70 7966 756e 6374 696f 6e28 6465 6661  [pyfunction(defa
+00011980: 756c 745f 7765 6967 6874 203d 2022 312e  ult_weight = "1.
+00011990: 3022 2c20 6173 5f75 6e64 6972 6563 7465  0", as_undirecte
+000119a0: 6420 3d20 2266 616c 7365 2229 5d0a 235b  d = "false")].#[
+000119b0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+000119c0: 2022 2867 7261 7068 2c20 736f 7572 6365   "(graph, source
+000119d0: 2c20 2f2c 2074 6172 6765 743d 4e6f 6e65  , /, target=None
+000119e0: 2077 6569 6768 745f 666e 3d4e 6f6e 652c   weight_fn=None,
+000119f0: 2064 6566 6175 6c74 5f77 6569 6768 743d   default_weight=
+00011a00: 312e 302c 2061 735f 756e 6469 7265 6374  1.0, as_undirect
+00011a10: 6564 3d46 616c 7365 2922 5d0a 7075 6220  ed=False)"].pub 
+00011a20: 666e 2064 6967 7261 7068 5f64 696a 6b73  fn digraph_dijks
+00011a30: 7472 615f 7368 6f72 7465 7374 5f70 6174  tra_shortest_pat
+00011a40: 6873 280a 2020 2020 7079 3a20 5079 7468  hs(.    py: Pyth
+00011a50: 6f6e 2c0a 2020 2020 6772 6170 683a 2026  on,.    graph: &
+00011a60: 6469 6772 6170 683a 3a50 7944 6947 7261  digraph::PyDiGra
+00011a70: 7068 2c0a 2020 2020 736f 7572 6365 3a20  ph,.    source: 
+00011a80: 7573 697a 652c 0a20 2020 2074 6172 6765  usize,.    targe
+00011a90: 743a 204f 7074 696f 6e3c 7573 697a 653e  t: Option<usize>
+00011aa0: 2c0a 2020 2020 7765 6967 6874 5f66 6e3a  ,.    weight_fn:
+00011ab0: 204f 7074 696f 6e3c 5079 4f62 6a65 6374   Option<PyObject
+00011ac0: 3e2c 0a20 2020 2064 6566 6175 6c74 5f77  >,.    default_w
+00011ad0: 6569 6768 743a 2066 3634 2c0a 2020 2020  eight: f64,.    
+00011ae0: 6173 5f75 6e64 6972 6563 7465 643a 2062  as_undirected: b
+00011af0: 6f6f 6c2c 0a29 202d 3e20 5079 5265 7375  ool,.) -> PyResu
+00011b00: 6c74 3c50 6174 684d 6170 7069 6e67 3e20  lt<PathMapping> 
+00011b10: 7b0a 2020 2020 6c65 7420 7374 6172 7420  {.    let start 
+00011b20: 3d20 4e6f 6465 496e 6465 783a 3a6e 6577  = NodeIndex::new
+00011b30: 2873 6f75 7263 6529 3b0a 2020 2020 6c65  (source);.    le
+00011b40: 7420 676f 616c 5f69 6e64 6578 3a20 4f70  t goal_index: Op
+00011b50: 7469 6f6e 3c4e 6f64 6549 6e64 6578 3e20  tion<NodeIndex> 
+00011b60: 3d20 7461 7267 6574 2e6d 6170 284e 6f64  = target.map(Nod
+00011b70: 6549 6e64 6578 3a3a 6e65 7729 3b0a 2020  eIndex::new);.  
+00011b80: 2020 6c65 7420 6d75 7420 7061 7468 733a    let mut paths:
+00011b90: 2048 6173 684d 6170 3c4e 6f64 6549 6e64   HashMap<NodeInd
+00011ba0: 6578 2c20 5665 633c 4e6f 6465 496e 6465  ex, Vec<NodeInde
+00011bb0: 783e 3e20 3d0a 2020 2020 2020 2020 4861  x>> =.        Ha
+00011bc0: 7368 4d61 703a 3a77 6974 685f 6361 7061  shMap::with_capa
+00011bd0: 6369 7479 2867 7261 7068 2e6e 6f64 655f  city(graph.node_
+00011be0: 636f 756e 7428 2929 3b0a 2020 2020 6966  count());.    if
+00011bf0: 2061 735f 756e 6469 7265 6374 6564 207b   as_undirected {
+00011c00: 0a20 2020 2020 2020 2064 696a 6b73 7472  .        dijkstr
+00011c10: 613a 3a64 696a 6b73 7472 6128 0a20 2020  a::dijkstra(.   
+00011c20: 2020 2020 2020 2020 202f 2f20 544f 444f           // TODO
+00011c30: 3a20 5573 6520 7065 7467 7261 7068 2075  : Use petgraph u
+00011c40: 6e64 6972 6563 7465 6420 6164 6170 7465  ndirected adapte
+00011c50: 7220 6166 7465 720a 2020 2020 2020 2020  r after.        
+00011c60: 2020 2020 2f2f 2068 7474 7073 3a2f 2f67      // https://g
+00011c70: 6974 6875 622e 636f 6d2f 7065 7467 7261  ithub.com/petgra
+00011c80: 7068 2f70 6574 6772 6170 682f 7075 6c6c  ph/petgraph/pull
+00011c90: 2f33 3138 2069 7320 6176 6169 6c61 626c  /318 is availabl
+00011ca0: 6520 696e 0a20 2020 2020 2020 2020 2020  e in.           
+00011cb0: 202f 2f20 6120 7065 7467 7261 7068 2072   // a petgraph r
+00011cc0: 656c 6561 7365 2e0a 2020 2020 2020 2020  elease..        
+00011cd0: 2020 2020 2667 7261 7068 2e74 6f5f 756e      &graph.to_un
+00011ce0: 6469 7265 6374 6564 2870 7929 2c0a 2020  directed(py),.  
+00011cf0: 2020 2020 2020 2020 2020 7374 6172 742c            start,
+00011d00: 0a20 2020 2020 2020 2020 2020 2067 6f61  .            goa
+00011d10: 6c5f 696e 6465 782c 0a20 2020 2020 2020  l_index,.       
+00011d20: 2020 2020 207c 657c 2077 6569 6768 745f       |e| weight_
+00011d30: 6361 6c6c 6162 6c65 2870 792c 2026 7765  callable(py, &we
+00011d40: 6967 6874 5f66 6e2c 2065 2e77 6569 6768  ight_fn, e.weigh
+00011d50: 7428 292c 2064 6566 6175 6c74 5f77 6569  t(), default_wei
+00011d60: 6768 7429 2c0a 2020 2020 2020 2020 2020  ght),.          
+00011d70: 2020 536f 6d65 2826 6d75 7420 7061 7468    Some(&mut path
+00011d80: 7329 2c0a 2020 2020 2020 2020 293f 3b0a  s),.        )?;.
+00011d90: 2020 2020 7d20 656c 7365 207b 0a20 2020      } else {.   
+00011da0: 2020 2020 2064 696a 6b73 7472 613a 3a64       dijkstra::d
+00011db0: 696a 6b73 7472 6128 0a20 2020 2020 2020  ijkstra(.       
+00011dc0: 2020 2020 2067 7261 7068 2c0a 2020 2020       graph,.    
+00011dd0: 2020 2020 2020 2020 7374 6172 742c 0a20          start,. 
+00011de0: 2020 2020 2020 2020 2020 2067 6f61 6c5f             goal_
+00011df0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+00011e00: 2020 207c 657c 2077 6569 6768 745f 6361     |e| weight_ca
+00011e10: 6c6c 6162 6c65 2870 792c 2026 7765 6967  llable(py, &weig
+00011e20: 6874 5f66 6e2c 2065 2e77 6569 6768 7428  ht_fn, e.weight(
+00011e30: 292c 2064 6566 6175 6c74 5f77 6569 6768  ), default_weigh
+00011e40: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
+00011e50: 536f 6d65 2826 6d75 7420 7061 7468 7329  Some(&mut paths)
+00011e60: 2c0a 2020 2020 2020 2020 293f 3b0a 2020  ,.        )?;.  
+00011e70: 2020 7d0a 2020 2020 4f6b 2850 6174 684d    }.    Ok(PathM
+00011e80: 6170 7069 6e67 207b 0a20 2020 2020 2020  apping {.       
+00011e90: 2070 6174 6873 3a20 7061 7468 730a 2020   paths: paths.  
+00011ea0: 2020 2020 2020 2020 2020 2e69 7465 7228            .iter(
+00011eb0: 290a 2020 2020 2020 2020 2020 2020 2e66  ).            .f
+00011ec0: 696c 7465 725f 6d61 7028 7c28 6b2c 2076  ilter_map(|(k, v
+00011ed0: 297c 207b 0a20 2020 2020 2020 2020 2020  )| {.           
+00011ee0: 2020 2020 206c 6574 206b 5f69 6e74 203d       let k_int =
+00011ef0: 206b 2e69 6e64 6578 2829 3b0a 2020 2020   k.index();.    
+00011f00: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+00011f10: 5f69 6e74 203d 3d20 736f 7572 6365 0a20  _int == source. 
+00011f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f30: 2020 207c 7c20 7461 7267 6574 2e69 735f     || target.is_
+00011f40: 736f 6d65 2829 2026 2620 7461 7267 6574  some() && target
+00011f50: 2e75 6e77 7261 7028 2920 213d 206b 5f69  .unwrap() != k_i
+00011f60: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+00011f70: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00011f80: 2020 2020 2020 2020 204e 6f6e 650a 2020           None.  
+00011f90: 2020 2020 2020 2020 2020 2020 2020 7d20                } 
+00011fa0: 656c 7365 207b 0a20 2020 2020 2020 2020  else {.         
+00011fb0: 2020 2020 2020 2020 2020 2053 6f6d 6528             Some(
+00011fc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00011fd0: 2020 2020 2020 2020 2020 6b5f 696e 742c            k_int,
+00011fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011ff0: 2020 2020 2020 2020 2076 2e69 7465 7228           v.iter(
+00012000: 292e 6d61 7028 7c78 7c20 782e 696e 6465  ).map(|x| x.inde
+00012010: 7828 2929 2e63 6f6c 6c65 6374 3a3a 3c56  x()).collect::<V
+00012020: 6563 3c75 7369 7a65 3e3e 2829 2c0a 2020  ec<usize>>(),.  
+00012030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012040: 2020 2929 0a20 2020 2020 2020 2020 2020    )).           
+00012050: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00012060: 2020 207d 290a 2020 2020 2020 2020 2020     }).          
+00012070: 2020 2e63 6f6c 6c65 6374 2829 2c0a 2020    .collect(),.  
+00012080: 2020 7d29 0a7d 0a0a 2f2f 2f20 436f 6d70    }).}../// Comp
+00012090: 7574 6520 7468 6520 6c65 6e67 7468 7320  ute the lengths 
+000120a0: 6f66 2074 6865 2073 686f 7274 6573 7420  of the shortest 
+000120b0: 7061 7468 7320 666f 7220 6120 5079 4772  paths for a PyGr
+000120c0: 6170 6820 6f62 6a65 6374 2075 7369 6e67  aph object using
+000120d0: 0a2f 2f2f 2044 696a 6b73 7472 6127 7320  ./// Dijkstra's 
+000120e0: 616c 676f 7269 7468 6d0a 2f2f 2f0a 2f2f  algorithm.///.//
+000120f0: 2f20 3a70 6172 616d 2050 7947 7261 7068  / :param PyGraph
+00012100: 2067 7261 7068 3a20 5468 6520 696e 7075   graph: The inpu
+00012110: 7420 6772 6170 6820 746f 2075 7365 0a2f  t graph to use./
+00012120: 2f2f 203a 7061 7261 6d20 696e 7420 6e6f  // :param int no
+00012130: 6465 3a20 5468 6520 6e6f 6465 2069 6e64  de: The node ind
+00012140: 6578 2074 6f20 7573 6520 6173 2074 6865  ex to use as the
+00012150: 2073 6f75 7263 6520 666f 7220 6669 6e64   source for find
+00012160: 696e 6720 7468 650a 2f2f 2f20 2020 2020  ing the.///     
+00012170: 7368 6f72 7465 7374 2070 6174 6873 2066  shortest paths f
+00012180: 726f 6d0a 2f2f 2f20 3a70 6172 616d 2065  rom./// :param e
+00012190: 6467 655f 636f 7374 5f66 6e3a 2041 2070  dge_cost_fn: A p
+000121a0: 7974 686f 6e20 6361 6c6c 6162 6c65 2074  ython callable t
+000121b0: 6861 7420 7769 6c6c 2074 616b 6520 696e  hat will take in
+000121c0: 2031 2070 6172 616d 6574 6572 2c20 616e   1 parameter, an
+000121d0: 0a2f 2f2f 2020 2020 2065 6467 6527 7320  .///     edge's 
+000121e0: 6461 7461 206f 626a 6563 7420 616e 6420  data object and 
+000121f0: 7769 6c6c 2072 6574 7572 6e20 6120 666c  will return a fl
+00012200: 6f61 7420 7468 6174 2072 6570 7265 7365  oat that represe
+00012210: 6e74 7320 7468 650a 2f2f 2f20 2020 2020  nts the.///     
+00012220: 636f 7374 2f77 6569 6768 7420 6f66 2074  cost/weight of t
+00012230: 6861 7420 6564 6765 2e20 4974 206d 7573  hat edge. It mus
+00012240: 7420 6265 206e 6f6e 2d6e 6567 6174 6976  t be non-negativ
+00012250: 650a 2f2f 2f20 3a70 6172 616d 2069 6e74  e./// :param int
+00012260: 2067 6f61 6c3a 2041 6e20 6f70 7469 6f6e   goal: An option
+00012270: 616c 206e 6f64 6520 696e 6465 7820 746f  al node index to
+00012280: 2075 7365 2061 7320 7468 6520 656e 6420   use as the end 
+00012290: 6f66 2074 6865 2070 6174 682e 0a2f 2f2f  of the path..///
+000122a0: 2020 2020 2057 6865 6e20 7370 6563 6966       When specif
+000122b0: 6965 6420 7468 6520 7472 6176 6572 7361  ied the traversa
+000122c0: 6c20 7769 6c6c 2073 746f 7020 7768 656e  l will stop when
+000122d0: 2074 6865 2067 6f61 6c20 6973 2072 6561   the goal is rea
+000122e0: 6368 6564 2061 6e64 0a2f 2f2f 2020 2020  ched and.///    
+000122f0: 2074 6865 206f 7574 7075 7420 6469 6374   the output dict
+00012300: 696f 6e61 7279 2077 696c 6c20 6f6e 6c79  ionary will only
+00012310: 2068 6176 6520 6120 7369 6e67 6c65 2065   have a single e
+00012320: 6e74 7279 2077 6974 6820 7468 6520 6c65  ntry with the le
+00012330: 6e67 7468 0a2f 2f2f 2020 2020 206f 6620  ngth.///     of 
+00012340: 7468 6520 7368 6f72 7465 7374 2070 6174  the shortest pat
+00012350: 6820 746f 2074 6865 2067 6f61 6c20 6e6f  h to the goal no
+00012360: 6465 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  de..///./// :ret
+00012370: 7572 6e73 3a20 4120 6469 6374 696f 6e61  urns: A dictiona
+00012380: 7279 206f 6620 7468 6520 7368 6f72 7465  ry of the shorte
+00012390: 7374 2070 6174 6873 2066 726f 6d20 7468  st paths from th
+000123a0: 6520 7072 6f76 6964 6564 206e 6f64 6520  e provided node 
+000123b0: 7768 6572 650a 2f2f 2f20 2020 2020 7468  where.///     th
+000123c0: 6520 6b65 7920 6973 2074 6865 206e 6f64  e key is the nod
+000123d0: 6520 696e 6465 7820 6f66 2074 6865 2065  e index of the e
+000123e0: 6e64 206f 6620 7468 6520 7061 7468 2061  nd of the path a
+000123f0: 6e64 2074 6865 2076 616c 7565 2069 7320  nd the value is 
+00012400: 7468 650a 2f2f 2f20 2020 2020 636f 7374  the.///     cost
+00012410: 2f73 756d 206f 6620 7468 6520 7765 6967  /sum of the weig
+00012420: 6874 7320 6f66 2070 6174 680a 2f2f 2f20  hts of path./// 
+00012430: 3a72 7479 7065 3a20 5061 7468 4c65 6e67  :rtype: PathLeng
+00012440: 7468 4d61 7070 696e 670a 235b 7079 6675  thMapping.#[pyfu
+00012450: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
+00012460: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+00012470: 7068 2c20 6e6f 6465 2c20 6564 6765 5f63  ph, node, edge_c
+00012480: 6f73 745f 666e 2c20 2f2c 2067 6f61 6c3d  ost_fn, /, goal=
+00012490: 4e6f 6e65 2922 5d0a 666e 2067 7261 7068  None)"].fn graph
+000124a0: 5f64 696a 6b73 7472 615f 7368 6f72 7465  _dijkstra_shorte
+000124b0: 7374 5f70 6174 685f 6c65 6e67 7468 7328  st_path_lengths(
+000124c0: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
+000124d0: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
+000124e0: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
+000124f0: 206e 6f64 653a 2075 7369 7a65 2c0a 2020   node: usize,.  
+00012500: 2020 6564 6765 5f63 6f73 745f 666e 3a20    edge_cost_fn: 
+00012510: 5079 4f62 6a65 6374 2c0a 2020 2020 676f  PyObject,.    go
+00012520: 616c 3a20 4f70 7469 6f6e 3c75 7369 7a65  al: Option<usize
+00012530: 3e2c 0a29 202d 3e20 5079 5265 7375 6c74  >,.) -> PyResult
+00012540: 3c50 6174 684c 656e 6774 684d 6170 7069  <PathLengthMappi
+00012550: 6e67 3e20 7b0a 2020 2020 6c65 7420 6564  ng> {.    let ed
+00012560: 6765 5f63 6f73 745f 6361 6c6c 6162 6c65  ge_cost_callable
+00012570: 203d 207c 613a 2026 5079 4f62 6a65 6374   = |a: &PyObject
+00012580: 7c20 2d3e 2050 7952 6573 756c 743c 6636  | -> PyResult<f6
+00012590: 343e 207b 0a20 2020 2020 2020 206c 6574  4> {.        let
+000125a0: 2072 6573 203d 2065 6467 655f 636f 7374   res = edge_cost
+000125b0: 5f66 6e2e 6361 6c6c 3128 7079 2c20 2861  _fn.call1(py, (a
+000125c0: 2c29 293f 3b0a 2020 2020 2020 2020 6c65  ,))?;.        le
+000125d0: 7420 7261 7720 3d20 7265 732e 746f 5f6f  t raw = res.to_o
+000125e0: 626a 6563 7428 7079 293b 0a20 2020 2020  bject(py);.     
+000125f0: 2020 2072 6177 2e65 7874 7261 6374 2870     raw.extract(p
+00012600: 7929 0a20 2020 207d 3b0a 0a20 2020 206c  y).    };..    l
+00012610: 6574 2073 7461 7274 203d 204e 6f64 6549  et start = NodeI
+00012620: 6e64 6578 3a3a 6e65 7728 6e6f 6465 293b  ndex::new(node);
+00012630: 0a20 2020 206c 6574 2067 6f61 6c5f 696e  .    let goal_in
+00012640: 6465 783a 204f 7074 696f 6e3c 4e6f 6465  dex: Option<Node
+00012650: 496e 6465 783e 203d 2067 6f61 6c2e 6d61  Index> = goal.ma
+00012660: 7028 4e6f 6465 496e 6465 783a 3a6e 6577  p(NodeIndex::new
+00012670: 293b 0a0a 2020 2020 6c65 7420 7265 7320  );..    let res 
+00012680: 3d20 6469 6a6b 7374 7261 3a3a 6469 6a6b  = dijkstra::dijk
+00012690: 7374 7261 280a 2020 2020 2020 2020 6772  stra(.        gr
+000126a0: 6170 682c 0a20 2020 2020 2020 2073 7461  aph,.        sta
+000126b0: 7274 2c0a 2020 2020 2020 2020 676f 616c  rt,.        goal
+000126c0: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
+000126d0: 7c65 7c20 6564 6765 5f63 6f73 745f 6361  |e| edge_cost_ca
+000126e0: 6c6c 6162 6c65 2865 2e77 6569 6768 7428  llable(e.weight(
+000126f0: 2929 2c0a 2020 2020 2020 2020 4e6f 6e65  )),.        None
+00012700: 2c0a 2020 2020 293f 3b0a 2020 2020 4f6b  ,.    )?;.    Ok
+00012710: 2850 6174 684c 656e 6774 684d 6170 7069  (PathLengthMappi
+00012720: 6e67 207b 0a20 2020 2020 2020 2070 6174  ng {.        pat
+00012730: 685f 6c65 6e67 7468 733a 2072 6573 0a20  h_lengths: res. 
+00012740: 2020 2020 2020 2020 2020 202e 6974 6572             .iter
+00012750: 2829 0a20 2020 2020 2020 2020 2020 202e  ().            .
+00012760: 6669 6c74 6572 5f6d 6170 287c 286b 2c20  filter_map(|(k, 
+00012770: 7629 7c20 7b0a 2020 2020 2020 2020 2020  v)| {.          
+00012780: 2020 2020 2020 6c65 7420 6b5f 696e 7420        let k_int 
+00012790: 3d20 6b2e 696e 6465 7828 293b 0a20 2020  = k.index();.   
+000127a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000127b0: 6b5f 696e 7420 3d3d 206e 6f64 6520 7c7c  k_int == node ||
+000127c0: 2067 6f61 6c2e 6973 5f73 6f6d 6528 2920   goal.is_some() 
+000127d0: 2626 2067 6f61 6c2e 756e 7772 6170 2829  && goal.unwrap()
+000127e0: 2021 3d20 6b5f 696e 7420 7b0a 2020 2020   != k_int {.    
+000127f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012800: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00012810: 2020 2020 207d 2065 6c73 6520 7b0a 2020       } else {.  
+00012820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012830: 2020 536f 6d65 2828 6b5f 696e 742c 202a    Some((k_int, *
+00012840: 7629 290a 2020 2020 2020 2020 2020 2020  v)).            
+00012850: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00012860: 2020 7d29 0a20 2020 2020 2020 2020 2020    }).           
+00012870: 202e 636f 6c6c 6563 7428 292c 0a20 2020   .collect(),.   
+00012880: 207d 290a 7d0a 0a2f 2f2f 2043 6f6d 7075   }).}../// Compu
+00012890: 7465 2074 6865 206c 656e 6774 6873 206f  te the lengths o
+000128a0: 6620 7468 6520 7368 6f72 7465 7374 2070  f the shortest p
+000128b0: 6174 6873 2066 6f72 2061 2050 7944 6947  aths for a PyDiG
+000128c0: 7261 7068 206f 626a 6563 7420 7573 696e  raph object usin
+000128d0: 670a 2f2f 2f20 4469 6a6b 7374 7261 2773  g./// Dijkstra's
+000128e0: 2061 6c67 6f72 6974 686d 0a2f 2f2f 0a2f   algorithm.///./
+000128f0: 2f2f 203a 7061 7261 6d20 5079 4469 4772  // :param PyDiGr
+00012900: 6170 6820 6772 6170 683a 2054 6865 2069  aph graph: The i
+00012910: 6e70 7574 2067 7261 7068 2074 6f20 7573  nput graph to us
+00012920: 650a 2f2f 2f20 3a70 6172 616d 2069 6e74  e./// :param int
+00012930: 206e 6f64 653a 2054 6865 206e 6f64 6520   node: The node 
+00012940: 696e 6465 7820 746f 2075 7365 2061 7320  index to use as 
+00012950: 7468 6520 736f 7572 6365 2066 6f72 2066  the source for f
+00012960: 696e 6469 6e67 2074 6865 0a2f 2f2f 2020  inding the.///  
+00012970: 2020 2073 686f 7274 6573 7420 7061 7468     shortest path
+00012980: 7320 6672 6f6d 0a2f 2f2f 203a 7061 7261  s from./// :para
+00012990: 6d20 6564 6765 5f63 6f73 745f 666e 3a20  m edge_cost_fn: 
+000129a0: 4120 7079 7468 6f6e 2063 616c 6c61 626c  A python callabl
+000129b0: 6520 7468 6174 2077 696c 6c20 7461 6b65  e that will take
+000129c0: 2069 6e20 3120 7061 7261 6d65 7465 722c   in 1 parameter,
+000129d0: 2061 6e0a 2f2f 2f20 2020 2020 6564 6765   an.///     edge
+000129e0: 2773 2064 6174 6120 6f62 6a65 6374 2061  's data object a
+000129f0: 6e64 2077 696c 6c20 7265 7475 726e 2061  nd will return a
+00012a00: 2066 6c6f 6174 2074 6861 7420 7265 7072   float that repr
+00012a10: 6573 656e 7473 2074 6865 0a2f 2f2f 2020  esents the.///  
+00012a20: 2020 2063 6f73 742f 7765 6967 6874 206f     cost/weight o
+00012a30: 6620 7468 6174 2065 6467 652e 2049 7420  f that edge. It 
+00012a40: 6d75 7374 2062 6520 6e6f 6e2d 6e65 6761  must be non-nega
+00012a50: 7469 7665 0a2f 2f2f 203a 7061 7261 6d20  tive./// :param 
+00012a60: 696e 7420 676f 616c 3a20 416e 206f 7074  int goal: An opt
+00012a70: 696f 6e61 6c20 6e6f 6465 2069 6e64 6578  ional node index
+00012a80: 2074 6f20 7573 6520 6173 2074 6865 2065   to use as the e
+00012a90: 6e64 206f 6620 7468 6520 7061 7468 2e0a  nd of the path..
+00012aa0: 2f2f 2f20 2020 2020 5768 656e 2073 7065  ///     When spe
+00012ab0: 6369 6669 6564 2074 6865 2074 7261 7665  cified the trave
+00012ac0: 7273 616c 2077 696c 6c20 7374 6f70 2077  rsal will stop w
+00012ad0: 6865 6e20 7468 6520 676f 616c 2069 7320  hen the goal is 
+00012ae0: 7265 6163 6865 6420 616e 640a 2f2f 2f20  reached and./// 
+00012af0: 2020 2020 7468 6520 6f75 7470 7574 2064      the output d
+00012b00: 6963 7469 6f6e 6172 7920 7769 6c6c 206f  ictionary will o
+00012b10: 6e6c 7920 6861 7665 2061 2073 696e 676c  nly have a singl
+00012b20: 6520 656e 7472 7920 7769 7468 2074 6865  e entry with the
+00012b30: 206c 656e 6774 680a 2f2f 2f20 2020 2020   length.///     
+00012b40: 6f66 2074 6865 2073 686f 7274 6573 7420  of the shortest 
+00012b50: 7061 7468 2074 6f20 7468 6520 676f 616c  path to the goal
+00012b60: 206e 6f64 652e 0a2f 2f2f 0a2f 2f2f 203a   node..///./// :
+00012b70: 7265 7475 726e 733a 2041 2064 6963 7469  returns: A dicti
+00012b80: 6f6e 6172 7920 6f66 2074 6865 2073 686f  onary of the sho
+00012b90: 7274 6573 7420 7061 7468 7320 6672 6f6d  rtest paths from
+00012ba0: 2074 6865 2070 726f 7669 6465 6420 6e6f   the provided no
+00012bb0: 6465 2077 6865 7265 0a2f 2f2f 2020 2020  de where.///    
+00012bc0: 2074 6865 206b 6579 2069 7320 7468 6520   the key is the 
+00012bd0: 6e6f 6465 2069 6e64 6578 206f 6620 7468  node index of th
+00012be0: 6520 656e 6420 6f66 2074 6865 2070 6174  e end of the pat
+00012bf0: 6820 616e 6420 7468 6520 7661 6c75 6520  h and the value 
+00012c00: 6973 2074 6865 0a2f 2f2f 2020 2020 2063  is the.///     c
+00012c10: 6f73 742f 7375 6d20 6f66 2074 6865 2077  ost/sum of the w
+00012c20: 6569 6768 7473 206f 6620 7061 7468 0a2f  eights of path./
+00012c30: 2f2f 203a 7274 7970 653a 2050 6174 684c  // :rtype: PathL
+00012c40: 656e 6774 684d 6170 7069 6e67 0a23 5b70  engthMapping.#[p
+00012c50: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
+00012c60: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+00012c70: 6772 6170 682c 206e 6f64 652c 2065 6467  graph, node, edg
+00012c80: 655f 636f 7374 5f66 6e2c 202f 2c20 676f  e_cost_fn, /, go
+00012c90: 616c 3d4e 6f6e 6529 225d 0a66 6e20 6469  al=None)"].fn di
+00012ca0: 6772 6170 685f 6469 6a6b 7374 7261 5f73  graph_dijkstra_s
+00012cb0: 686f 7274 6573 745f 7061 7468 5f6c 656e  hortest_path_len
+00012cc0: 6774 6873 280a 2020 2020 7079 3a20 5079  gths(.    py: Py
+00012cd0: 7468 6f6e 2c0a 2020 2020 6772 6170 683a  thon,.    graph:
+00012ce0: 2026 6469 6772 6170 683a 3a50 7944 6947   &digraph::PyDiG
+00012cf0: 7261 7068 2c0a 2020 2020 6e6f 6465 3a20  raph,.    node: 
+00012d00: 7573 697a 652c 0a20 2020 2065 6467 655f  usize,.    edge_
+00012d10: 636f 7374 5f66 6e3a 2050 794f 626a 6563  cost_fn: PyObjec
+00012d20: 742c 0a20 2020 2067 6f61 6c3a 204f 7074  t,.    goal: Opt
+00012d30: 696f 6e3c 7573 697a 653e 2c0a 2920 2d3e  ion<usize>,.) ->
+00012d40: 2050 7952 6573 756c 743c 5061 7468 4c65   PyResult<PathLe
+00012d50: 6e67 7468 4d61 7070 696e 673e 207b 0a20  ngthMapping> {. 
+00012d60: 2020 206c 6574 2065 6467 655f 636f 7374     let edge_cost
+00012d70: 5f63 616c 6c61 626c 6520 3d20 7c61 3a20  _callable = |a: 
+00012d80: 2650 794f 626a 6563 747c 202d 3e20 5079  &PyObject| -> Py
+00012d90: 5265 7375 6c74 3c66 3634 3e20 7b0a 2020  Result<f64> {.  
+00012da0: 2020 2020 2020 6c65 7420 7265 7320 3d20        let res = 
+00012db0: 6564 6765 5f63 6f73 745f 666e 2e63 616c  edge_cost_fn.cal
+00012dc0: 6c31 2870 792c 2028 612c 2929 3f3b 0a20  l1(py, (a,))?;. 
+00012dd0: 2020 2020 2020 206c 6574 2072 6177 203d         let raw =
+00012de0: 2072 6573 2e74 6f5f 6f62 6a65 6374 2870   res.to_object(p
+00012df0: 7929 3b0a 2020 2020 2020 2020 7261 772e  y);.        raw.
+00012e00: 6578 7472 6163 7428 7079 290a 2020 2020  extract(py).    
+00012e10: 7d3b 0a0a 2020 2020 6c65 7420 7374 6172  };..    let star
+00012e20: 7420 3d20 4e6f 6465 496e 6465 783a 3a6e  t = NodeIndex::n
+00012e30: 6577 286e 6f64 6529 3b0a 2020 2020 6c65  ew(node);.    le
+00012e40: 7420 676f 616c 5f69 6e64 6578 3a20 4f70  t goal_index: Op
+00012e50: 7469 6f6e 3c4e 6f64 6549 6e64 6578 3e20  tion<NodeIndex> 
+00012e60: 3d20 676f 616c 2e6d 6170 284e 6f64 6549  = goal.map(NodeI
+00012e70: 6e64 6578 3a3a 6e65 7729 3b0a 0a20 2020  ndex::new);..   
+00012e80: 206c 6574 2072 6573 203d 2064 696a 6b73   let res = dijks
+00012e90: 7472 613a 3a64 696a 6b73 7472 6128 0a20  tra::dijkstra(. 
+00012ea0: 2020 2020 2020 2067 7261 7068 2c0a 2020         graph,.  
+00012eb0: 2020 2020 2020 7374 6172 742c 0a20 2020        start,.   
+00012ec0: 2020 2020 2067 6f61 6c5f 696e 6465 782c       goal_index,
+00012ed0: 0a20 2020 2020 2020 207c 657c 2065 6467  .        |e| edg
+00012ee0: 655f 636f 7374 5f63 616c 6c61 626c 6528  e_cost_callable(
+00012ef0: 652e 7765 6967 6874 2829 292c 0a20 2020  e.weight()),.   
+00012f00: 2020 2020 204e 6f6e 652c 0a20 2020 2029       None,.    )
+00012f10: 3f3b 0a20 2020 204f 6b28 5061 7468 4c65  ?;.    Ok(PathLe
+00012f20: 6e67 7468 4d61 7070 696e 6720 7b0a 2020  ngthMapping {.  
+00012f30: 2020 2020 2020 7061 7468 5f6c 656e 6774        path_lengt
+00012f40: 6873 3a20 7265 730a 2020 2020 2020 2020  hs: res.        
+00012f50: 2020 2020 2e69 7465 7228 290a 2020 2020      .iter().    
+00012f60: 2020 2020 2020 2020 2e66 696c 7465 725f          .filter_
+00012f70: 6d61 7028 7c28 6b2c 2076 297c 207b 0a20  map(|(k, v)| {. 
+00012f80: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00012f90: 6574 206b 5f69 6e74 203d 206b 2e69 6e64  et k_int = k.ind
+00012fa0: 6578 2829 3b0a 2020 2020 2020 2020 2020  ex();.          
+00012fb0: 2020 2020 2020 6966 206b 5f69 6e74 203d        if k_int =
+00012fc0: 3d20 6e6f 6465 207c 7c20 676f 616c 2e69  = node || goal.i
+00012fd0: 735f 736f 6d65 2829 2026 2620 676f 616c  s_some() && goal
+00012fe0: 2e75 6e77 7261 7028 2920 213d 206b 5f69  .unwrap() != k_i
+00012ff0: 6e74 207b 0a20 2020 2020 2020 2020 2020  nt {.           
+00013000: 2020 2020 2020 2020 204e 6f6e 650a 2020           None.  
+00013010: 2020 2020 2020 2020 2020 2020 2020 7d20                } 
+00013020: 656c 7365 207b 0a20 2020 2020 2020 2020  else {.         
+00013030: 2020 2020 2020 2020 2020 2053 6f6d 6528             Some(
+00013040: 286b 5f69 6e74 2c20 2a76 2929 0a20 2020  (k_int, *v)).   
+00013050: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00013060: 2020 2020 2020 2020 2020 207d 290a 2020             }).  
+00013070: 2020 2020 2020 2020 2020 2e63 6f6c 6c65            .colle
+00013080: 6374 2829 2c0a 2020 2020 7d29 0a7d 0a0a  ct(),.    }).}..
+00013090: 666e 205f 616c 6c5f 7061 6972 735f 6469  fn _all_pairs_di
+000130a0: 6a6b 7374 7261 5f70 6174 685f 6c65 6e67  jkstra_path_leng
+000130b0: 7468 733c 5479 3a20 4564 6765 5479 7065  ths<Ty: EdgeType
+000130c0: 202b 2053 796e 633e 280a 2020 2020 7079   + Sync>(.    py
+000130d0: 3a20 5079 7468 6f6e 2c0a 2020 2020 6772  : Python,.    gr
+000130e0: 6170 683a 2026 5374 6162 6c65 4772 6170  aph: &StableGrap
+000130f0: 683c 5079 4f62 6a65 6374 2c20 5079 4f62  h<PyObject, PyOb
+00013100: 6a65 6374 2c20 5479 3e2c 0a20 2020 2065  ject, Ty>,.    e
+00013110: 6467 655f 636f 7374 5f66 6e3a 2050 794f  dge_cost_fn: PyO
+00013120: 626a 6563 742c 0a29 202d 3e20 5079 5265  bject,.) -> PyRe
+00013130: 7375 6c74 3c41 6c6c 5061 6972 7350 6174  sult<AllPairsPat
+00013140: 684c 656e 6774 684d 6170 7069 6e67 3e20  hLengthMapping> 
+00013150: 7b0a 2020 2020 6966 2067 7261 7068 2e6e  {.    if graph.n
+00013160: 6f64 655f 636f 756e 7428 2920 3d3d 2030  ode_count() == 0
+00013170: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
+00013180: 6e20 4f6b 2841 6c6c 5061 6972 7350 6174  n Ok(AllPairsPat
+00013190: 684c 656e 6774 684d 6170 7069 6e67 207b  hLengthMapping {
+000131a0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+000131b0: 685f 6c65 6e67 7468 733a 2048 6173 684d  h_lengths: HashM
+000131c0: 6170 3a3a 6e65 7728 292c 0a20 2020 2020  ap::new(),.     
+000131d0: 2020 207d 293b 0a20 2020 207d 2065 6c73     });.    } els
+000131e0: 6520 6966 2067 7261 7068 2e65 6467 655f  e if graph.edge_
+000131f0: 636f 756e 7428 2920 3d3d 2030 207b 0a20  count() == 0 {. 
+00013200: 2020 2020 2020 2072 6574 7572 6e20 4f6b         return Ok
+00013210: 2841 6c6c 5061 6972 7350 6174 684c 656e  (AllPairsPathLen
+00013220: 6774 684d 6170 7069 6e67 207b 0a20 2020  gthMapping {.   
+00013230: 2020 2020 2020 2020 2070 6174 685f 6c65           path_le
+00013240: 6e67 7468 733a 2067 7261 7068 0a20 2020  ngths: graph.   
+00013250: 2020 2020 2020 2020 2020 2020 202e 6e6f               .no
+00013260: 6465 5f69 6e64 6963 6573 2829 0a20 2020  de_indices().   
+00013270: 2020 2020 2020 2020 2020 2020 202e 6d61               .ma
+00013280: 7028 7c69 7c20 7b0a 2020 2020 2020 2020  p(|i| {.        
+00013290: 2020 2020 2020 2020 2020 2020 280a 2020              (.  
+000132a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132b0: 2020 2020 2020 692e 696e 6465 7828 292c        i.index(),
+000132c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000132d0: 2020 2020 2020 2020 2050 6174 684c 656e           PathLen
+000132e0: 6774 684d 6170 7069 6e67 207b 0a20 2020  gthMapping {.   
+000132f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013300: 2020 2020 2020 2020 2070 6174 685f 6c65           path_le
+00013310: 6e67 7468 733a 2048 6173 684d 6170 3a3a  ngths: HashMap::
+00013320: 6e65 7728 292c 0a20 2020 2020 2020 2020  new(),.         
+00013330: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00013340: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013350: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00013360: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+00013370: 2020 2020 2020 2020 2020 202e 636f 6c6c             .coll
+00013380: 6563 7428 292c 0a20 2020 2020 2020 207d  ect(),.        }
+00013390: 293b 0a20 2020 207d 0a20 2020 206c 6574  );.    }.    let
+000133a0: 2065 6467 655f 636f 7374 5f63 616c 6c61   edge_cost_calla
+000133b0: 626c 6520 3d20 7c61 3a20 2650 794f 626a  ble = |a: &PyObj
+000133c0: 6563 747c 202d 3e20 5079 5265 7375 6c74  ect| -> PyResult
+000133d0: 3c66 3634 3e20 7b0a 2020 2020 2020 2020  <f64> {.        
+000133e0: 6c65 7420 7265 7320 3d20 6564 6765 5f63  let res = edge_c
+000133f0: 6f73 745f 666e 2e63 616c 6c31 2870 792c  ost_fn.call1(py,
+00013400: 2028 612c 2929 3f3b 0a20 2020 2020 2020   (a,))?;.       
+00013410: 206c 6574 2072 6177 203d 2072 6573 2e74   let raw = res.t
+00013420: 6f5f 6f62 6a65 6374 2870 7929 3b0a 2020  o_object(py);.  
+00013430: 2020 2020 2020 7261 772e 6578 7472 6163        raw.extrac
+00013440: 7428 7079 290a 2020 2020 7d3b 0a20 2020  t(py).    };.   
+00013450: 206c 6574 2065 6467 655f 626f 756e 643a   let edge_bound:
+00013460: 2075 7369 7a65 203d 0a20 2020 2020 2020   usize =.       
+00013470: 2067 7261 7068 2e65 6467 655f 696e 6469   graph.edge_indi
+00013480: 6365 7328 292e 6d61 7028 7c78 7c20 782e  ces().map(|x| x.
+00013490: 696e 6465 7828 2929 2e6d 6178 2829 2e75  index()).max().u
+000134a0: 6e77 7261 7028 293b 0a20 2020 206c 6574  nwrap();.    let
+000134b0: 206d 7574 2065 6467 655f 7765 6967 6874   mut edge_weight
+000134c0: 733a 2056 6563 3c4f 7074 696f 6e3c 6636  s: Vec<Option<f6
+000134d0: 343e 3e20 3d20 5665 633a 3a77 6974 685f  4>> = Vec::with_
+000134e0: 6361 7061 6369 7479 2865 6467 655f 626f  capacity(edge_bo
+000134f0: 756e 6429 3b0a 2020 2020 666f 7220 696e  und);.    for in
+00013500: 6465 7820 696e 2030 2e2e 3d65 6467 655f  dex in 0..=edge_
+00013510: 626f 756e 6420 7b0a 2020 2020 2020 2020  bound {.        
+00013520: 6c65 7420 7261 775f 7765 6967 6874 203d  let raw_weight =
+00013530: 2067 7261 7068 2e65 6467 655f 7765 6967   graph.edge_weig
+00013540: 6874 2845 6467 6549 6e64 6578 3a3a 6e65  ht(EdgeIndex::ne
+00013550: 7728 696e 6465 7829 293b 0a20 2020 2020  w(index));.     
+00013560: 2020 206d 6174 6368 2072 6177 5f77 6569     match raw_wei
+00013570: 6768 7420 7b0a 2020 2020 2020 2020 2020  ght {.          
+00013580: 2020 536f 6d65 2877 6569 6768 7429 203d    Some(weight) =
+00013590: 3e20 7b0a 2020 2020 2020 2020 2020 2020  > {.            
+000135a0: 2020 2020 6564 6765 5f77 6569 6768 7473      edge_weights
+000135b0: 2e70 7573 6828 536f 6d65 2865 6467 655f  .push(Some(edge_
+000135c0: 636f 7374 5f63 616c 6c61 626c 6528 7765  cost_callable(we
+000135d0: 6967 6874 293f 2929 0a20 2020 2020 2020  ight)?)).       
+000135e0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+000135f0: 2020 204e 6f6e 6520 3d3e 2065 6467 655f     None => edge_
+00013600: 7765 6967 6874 732e 7075 7368 284e 6f6e  weights.push(Non
+00013610: 6529 2c0a 2020 2020 2020 2020 7d3b 0a20  e),.        };. 
+00013620: 2020 207d 0a20 2020 206c 6574 2065 6467     }.    let edg
+00013630: 655f 636f 7374 203d 207c 653a 2045 6467  e_cost = |e: Edg
+00013640: 6549 6e64 6578 7c20 2d3e 2050 7952 6573  eIndex| -> PyRes
+00013650: 756c 743c 6636 343e 207b 0a20 2020 2020  ult<f64> {.     
+00013660: 2020 206d 6174 6368 2065 6467 655f 7765     match edge_we
+00013670: 6967 6874 735b 652e 696e 6465 7828 295d  ights[e.index()]
+00013680: 207b 0a20 2020 2020 2020 2020 2020 2053   {.            S
+00013690: 6f6d 6528 7765 6967 6874 2920 3d3e 204f  ome(weight) => O
+000136a0: 6b28 7765 6967 6874 292c 0a20 2020 2020  k(weight),.     
+000136b0: 2020 2020 2020 204e 6f6e 6520 3d3e 2045         None => E
+000136c0: 7272 2850 7949 6e64 6578 4572 726f 723a  rr(PyIndexError:
+000136d0: 3a6e 6577 5f65 7272 2822 4e6f 2065 6467  :new_err("No edg
+000136e0: 6520 666f 756e 6420 666f 7220 696e 6465  e found for inde
+000136f0: 7822 2929 2c0a 2020 2020 2020 2020 7d0a  x")),.        }.
+00013700: 2020 2020 7d3b 0a20 2020 206c 6574 206e      };.    let n
+00013710: 6f64 655f 696e 6469 6365 733a 2056 6563  ode_indices: Vec
+00013720: 3c4e 6f64 6549 6e64 6578 3e20 3d20 6772  <NodeIndex> = gr
+00013730: 6170 682e 6e6f 6465 5f69 6e64 6963 6573  aph.node_indices
+00013740: 2829 2e63 6f6c 6c65 6374 2829 3b0a 2020  ().collect();.  
+00013750: 2020 6c65 7420 6f75 745f 6d61 703a 2048    let out_map: H
+00013760: 6173 684d 6170 3c75 7369 7a65 2c20 5061  ashMap<usize, Pa
+00013770: 7468 4c65 6e67 7468 4d61 7070 696e 673e  thLengthMapping>
+00013780: 203d 206e 6f64 655f 696e 6469 6365 730a   = node_indices.
+00013790: 2020 2020 2020 2020 2e69 6e74 6f5f 7061          .into_pa
+000137a0: 725f 6974 6572 2829 0a20 2020 2020 2020  r_iter().       
+000137b0: 202e 6d61 7028 7c78 7c20 7b0a 2020 2020   .map(|x| {.    
+000137c0: 2020 2020 2020 2020 6c65 7420 6f75 745f          let out_
+000137d0: 6d61 7020 3d20 5061 7468 4c65 6e67 7468  map = PathLength
+000137e0: 4d61 7070 696e 6720 7b0a 2020 2020 2020  Mapping {.      
+000137f0: 2020 2020 2020 2020 2020 7061 7468 5f6c            path_l
+00013800: 656e 6774 6873 3a20 6469 6a6b 7374 7261  engths: dijkstra
+00013810: 3a3a 6469 6a6b 7374 7261 280a 2020 2020  ::dijkstra(.    
+00013820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013830: 6772 6170 682c 0a20 2020 2020 2020 2020  graph,.         
+00013840: 2020 2020 2020 2020 2020 2078 2c0a 2020             x,.  
+00013850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013860: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
+00013870: 2020 2020 2020 2020 2020 2020 7c65 7c20              |e| 
+00013880: 6564 6765 5f63 6f73 7428 652e 6964 2829  edge_cost(e.id()
+00013890: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000138a0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
+000138b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000138c0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+000138d0: 756e 7772 6170 2829 0a20 2020 2020 2020  unwrap().       
+000138e0: 2020 2020 2020 2020 202e 6974 6572 2829           .iter()
+000138f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013900: 202e 6669 6c74 6572 5f6d 6170 287c 2869   .filter_map(|(i
+00013910: 6e64 6578 2c20 636f 7374 297c 207b 0a20  ndex, cost)| {. 
+00013920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013930: 2020 2069 6620 2a69 6e64 6578 203d 3d20     if *index == 
+00013940: 7820 7b0a 2020 2020 2020 2020 2020 2020  x {.            
+00013950: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00013960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013970: 2020 2020 207d 2065 6c73 6520 7b0a 2020       } else {.  
+00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013990: 2020 2020 2020 536f 6d65 2828 696e 6465        Some((inde
+000139a0: 782e 696e 6465 7828 292c 202a 636f 7374  x.index(), *cost
+000139b0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+000139c0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+000139d0: 2020 2020 2020 2020 207d 290a 2020 2020           }).    
+000139e0: 2020 2020 2020 2020 2020 2020 2e63 6f6c              .col
+000139f0: 6c65 6374 2829 2c0a 2020 2020 2020 2020  lect(),.        
+00013a00: 2020 2020 7d3b 0a20 2020 2020 2020 2020      };.         
+00013a10: 2020 2028 782e 696e 6465 7828 292c 206f     (x.index(), o
+00013a20: 7574 5f6d 6170 290a 2020 2020 2020 2020  ut_map).        
+00013a30: 7d29 0a20 2020 2020 2020 202e 636f 6c6c  }).        .coll
+00013a40: 6563 7428 293b 0a20 2020 204f 6b28 416c  ect();.    Ok(Al
+00013a50: 6c50 6169 7273 5061 7468 4c65 6e67 7468  lPairsPathLength
+00013a60: 4d61 7070 696e 6720 7b0a 2020 2020 2020  Mapping {.      
+00013a70: 2020 7061 7468 5f6c 656e 6774 6873 3a20    path_lengths: 
+00013a80: 6f75 745f 6d61 702c 0a20 2020 207d 290a  out_map,.    }).
+00013a90: 7d0a 0a66 6e20 5f61 6c6c 5f70 6169 7273  }..fn _all_pairs
+00013aa0: 5f64 696a 6b73 7472 615f 7368 6f72 7465  _dijkstra_shorte
+00013ab0: 7374 5f70 6174 6873 3c54 793a 2045 6467  st_paths<Ty: Edg
+00013ac0: 6554 7970 6520 2b20 5379 6e63 3e28 0a20  eType + Sync>(. 
+00013ad0: 2020 2070 793a 2050 7974 686f 6e2c 0a20     py: Python,. 
+00013ae0: 2020 2067 7261 7068 3a20 2653 7461 626c     graph: &Stabl
+00013af0: 6547 7261 7068 3c50 794f 626a 6563 742c  eGraph<PyObject,
+00013b00: 2050 794f 626a 6563 742c 2054 793e 2c0a   PyObject, Ty>,.
+00013b10: 2020 2020 6564 6765 5f63 6f73 745f 666e      edge_cost_fn
+00013b20: 3a20 5079 4f62 6a65 6374 2c0a 2920 2d3e  : PyObject,.) ->
+00013b30: 2050 7952 6573 756c 743c 416c 6c50 6169   PyResult<AllPai
+00013b40: 7273 5061 7468 4d61 7070 696e 673e 207b  rsPathMapping> {
+00013b50: 0a20 2020 2069 6620 6772 6170 682e 6e6f  .    if graph.no
+00013b60: 6465 5f63 6f75 6e74 2829 203d 3d20 3020  de_count() == 0 
+00013b70: 7b0a 2020 2020 2020 2020 7265 7475 726e  {.        return
+00013b80: 204f 6b28 416c 6c50 6169 7273 5061 7468   Ok(AllPairsPath
+00013b90: 4d61 7070 696e 6720 7b0a 2020 2020 2020  Mapping {.      
+00013ba0: 2020 2020 2020 7061 7468 733a 2048 6173        paths: Has
+00013bb0: 684d 6170 3a3a 6e65 7728 292c 0a20 2020  hMap::new(),.   
+00013bc0: 2020 2020 207d 293b 0a20 2020 207d 2065       });.    } e
+00013bd0: 6c73 6520 6966 2067 7261 7068 2e65 6467  lse if graph.edg
+00013be0: 655f 636f 756e 7428 2920 3d3d 2030 207b  e_count() == 0 {
+00013bf0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013c00: 4f6b 2841 6c6c 5061 6972 7350 6174 684d  Ok(AllPairsPathM
+00013c10: 6170 7069 6e67 207b 0a20 2020 2020 2020  apping {.       
+00013c20: 2020 2020 2070 6174 6873 3a20 6772 6170       paths: grap
+00013c30: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+00013c40: 2020 2e6e 6f64 655f 696e 6469 6365 7328    .node_indices(
+00013c50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00013c60: 2020 2e6d 6170 287c 697c 207b 0a20 2020    .map(|i| {.   
+00013c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c80: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00013c90: 2020 2020 2020 2020 2020 2069 2e69 6e64             i.ind
+00013ca0: 6578 2829 2c0a 2020 2020 2020 2020 2020  ex(),.          
+00013cb0: 2020 2020 2020 2020 2020 2020 2020 5061                Pa
+00013cc0: 7468 4d61 7070 696e 6720 7b0a 2020 2020  thMapping {.    
+00013cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ce0: 2020 2020 2020 2020 7061 7468 733a 2048          paths: H
+00013cf0: 6173 684d 6170 3a3a 6e65 7728 292c 0a20  ashMap::new(),. 
+00013d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d10: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00013d20: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00013d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d40: 7d29 0a20 2020 2020 2020 2020 2020 2020  }).             
+00013d50: 2020 202e 636f 6c6c 6563 7428 292c 0a20     .collect(),. 
+00013d60: 2020 2020 2020 207d 293b 0a20 2020 207d         });.    }
+00013d70: 0a20 2020 206c 6574 2065 6467 655f 636f  .    let edge_co
+00013d80: 7374 5f63 616c 6c61 626c 6520 3d20 7c61  st_callable = |a
+00013d90: 3a20 2650 794f 626a 6563 747c 202d 3e20  : &PyObject| -> 
+00013da0: 5079 5265 7375 6c74 3c66 3634 3e20 7b0a  PyResult<f64> {.
+00013db0: 2020 2020 2020 2020 6c65 7420 7265 7320          let res 
+00013dc0: 3d20 6564 6765 5f63 6f73 745f 666e 2e63  = edge_cost_fn.c
+00013dd0: 616c 6c31 2870 792c 2028 612c 2929 3f3b  all1(py, (a,))?;
+00013de0: 0a20 2020 2020 2020 206c 6574 2072 6177  .        let raw
+00013df0: 203d 2072 6573 2e74 6f5f 6f62 6a65 6374   = res.to_object
+00013e00: 2870 7929 3b0a 2020 2020 2020 2020 7261  (py);.        ra
+00013e10: 772e 6578 7472 6163 7428 7079 290a 2020  w.extract(py).  
+00013e20: 2020 7d3b 0a20 2020 206c 6574 2065 6467    };.    let edg
+00013e30: 655f 626f 756e 643a 2075 7369 7a65 203d  e_bound: usize =
+00013e40: 0a20 2020 2020 2020 2067 7261 7068 2e65  .        graph.e
+00013e50: 6467 655f 696e 6469 6365 7328 292e 6d61  dge_indices().ma
+00013e60: 7028 7c78 7c20 782e 696e 6465 7828 2929  p(|x| x.index())
+00013e70: 2e6d 6178 2829 2e75 6e77 7261 7028 293b  .max().unwrap();
+00013e80: 0a20 2020 206c 6574 206d 7574 2065 6467  .    let mut edg
+00013e90: 655f 7765 6967 6874 733a 2056 6563 3c4f  e_weights: Vec<O
+00013ea0: 7074 696f 6e3c 6636 343e 3e20 3d20 5665  ption<f64>> = Ve
+00013eb0: 633a 3a77 6974 685f 6361 7061 6369 7479  c::with_capacity
+00013ec0: 2865 6467 655f 626f 756e 6429 3b0a 2020  (edge_bound);.  
+00013ed0: 2020 666f 7220 696e 6465 7820 696e 2030    for index in 0
+00013ee0: 2e2e 3d65 6467 655f 626f 756e 6420 7b0a  ..=edge_bound {.
+00013ef0: 2020 2020 2020 2020 6c65 7420 7261 775f          let raw_
+00013f00: 7765 6967 6874 203d 2067 7261 7068 2e65  weight = graph.e
+00013f10: 6467 655f 7765 6967 6874 2845 6467 6549  dge_weight(EdgeI
+00013f20: 6e64 6578 3a3a 6e65 7728 696e 6465 7829  ndex::new(index)
+00013f30: 293b 0a20 2020 2020 2020 206d 6174 6368  );.        match
+00013f40: 2072 6177 5f77 6569 6768 7420 7b0a 2020   raw_weight {.  
+00013f50: 2020 2020 2020 2020 2020 536f 6d65 2877            Some(w
+00013f60: 6569 6768 7429 203d 3e20 7b0a 2020 2020  eight) => {.    
+00013f70: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+00013f80: 5f77 6569 6768 7473 2e70 7573 6828 536f  _weights.push(So
+00013f90: 6d65 2865 6467 655f 636f 7374 5f63 616c  me(edge_cost_cal
+00013fa0: 6c61 626c 6528 7765 6967 6874 293f 2929  lable(weight)?))
+00013fb0: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+00013fc0: 2020 2020 2020 2020 2020 204e 6f6e 6520             None 
+00013fd0: 3d3e 2065 6467 655f 7765 6967 6874 732e  => edge_weights.
+00013fe0: 7075 7368 284e 6f6e 6529 2c0a 2020 2020  push(None),.    
+00013ff0: 2020 2020 7d3b 0a20 2020 207d 0a20 2020      };.    }.   
+00014000: 206c 6574 2065 6467 655f 636f 7374 203d   let edge_cost =
+00014010: 207c 653a 2045 6467 6549 6e64 6578 7c20   |e: EdgeIndex| 
+00014020: 2d3e 2050 7952 6573 756c 743c 6636 343e  -> PyResult<f64>
+00014030: 207b 0a20 2020 2020 2020 206d 6174 6368   {.        match
+00014040: 2065 6467 655f 7765 6967 6874 735b 652e   edge_weights[e.
+00014050: 696e 6465 7828 295d 207b 0a20 2020 2020  index()] {.     
+00014060: 2020 2020 2020 2053 6f6d 6528 7765 6967         Some(weig
+00014070: 6874 2920 3d3e 204f 6b28 7765 6967 6874  ht) => Ok(weight
+00014080: 292c 0a20 2020 2020 2020 2020 2020 204e  ),.            N
+00014090: 6f6e 6520 3d3e 2045 7272 2850 7949 6e64  one => Err(PyInd
+000140a0: 6578 4572 726f 723a 3a6e 6577 5f65 7272  exError::new_err
+000140b0: 2822 4e6f 2065 6467 6520 666f 756e 6420  ("No edge found 
+000140c0: 666f 7220 696e 6465 7822 2929 2c0a 2020  for index")),.  
+000140d0: 2020 2020 2020 7d0a 2020 2020 7d3b 0a20        }.    };. 
+000140e0: 2020 206c 6574 206e 6f64 655f 696e 6469     let node_indi
+000140f0: 6365 733a 2056 6563 3c4e 6f64 6549 6e64  ces: Vec<NodeInd
+00014100: 6578 3e20 3d20 6772 6170 682e 6e6f 6465  ex> = graph.node
+00014110: 5f69 6e64 6963 6573 2829 2e63 6f6c 6c65  _indices().colle
+00014120: 6374 2829 3b0a 2020 2020 4f6b 2841 6c6c  ct();.    Ok(All
+00014130: 5061 6972 7350 6174 684d 6170 7069 6e67  PairsPathMapping
+00014140: 207b 0a20 2020 2020 2020 2070 6174 6873   {.        paths
+00014150: 3a20 6e6f 6465 5f69 6e64 6963 6573 0a20  : node_indices. 
+00014160: 2020 2020 2020 2020 2020 202e 696e 746f             .into
+00014170: 5f70 6172 5f69 7465 7228 290a 2020 2020  _par_iter().    
+00014180: 2020 2020 2020 2020 2e6d 6170 287c 787c          .map(|x|
+00014190: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000141a0: 2020 206c 6574 206d 7574 2070 6174 6873     let mut paths
+000141b0: 3a20 4861 7368 4d61 703c 4e6f 6465 496e  : HashMap<NodeIn
+000141c0: 6465 782c 2056 6563 3c4e 6f64 6549 6e64  dex, Vec<NodeInd
+000141d0: 6578 3e3e 203d 0a20 2020 2020 2020 2020  ex>> =.         
+000141e0: 2020 2020 2020 2020 2020 2048 6173 684d             HashM
+000141f0: 6170 3a3a 7769 7468 5f63 6170 6163 6974  ap::with_capacit
+00014200: 7928 6772 6170 682e 6e6f 6465 5f63 6f75  y(graph.node_cou
+00014210: 6e74 2829 293b 0a20 2020 2020 2020 2020  nt());.         
+00014220: 2020 2020 2020 2064 696a 6b73 7472 613a         dijkstra:
+00014230: 3a64 696a 6b73 7472 6128 0a20 2020 2020  :dijkstra(.     
+00014240: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00014250: 7261 7068 2c0a 2020 2020 2020 2020 2020  raph,.          
+00014260: 2020 2020 2020 2020 2020 782c 0a20 2020            x,.   
+00014270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014280: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00014290: 2020 2020 2020 2020 2020 207c 657c 2065             |e| e
+000142a0: 6467 655f 636f 7374 2865 2e69 6428 2929  dge_cost(e.id())
+000142b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000142c0: 2020 2020 2020 536f 6d65 2826 6d75 7420        Some(&mut 
+000142d0: 7061 7468 7329 2c0a 2020 2020 2020 2020  paths),.        
+000142e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000142f0: 2020 2020 2020 2020 2020 2e75 6e77 7261            .unwra
+00014300: 7028 293b 0a20 2020 2020 2020 2020 2020  p();.           
+00014310: 2020 2020 206c 6574 2069 6e64 6578 203d       let index =
+00014320: 2078 2e69 6e64 6578 2829 3b0a 2020 2020   x.index();.    
+00014330: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+00014340: 6f75 745f 7061 7468 7320 3d20 5061 7468  out_paths = Path
+00014350: 4d61 7070 696e 6720 7b0a 2020 2020 2020  Mapping {.      
+00014360: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00014370: 7468 733a 2070 6174 6873 0a20 2020 2020  ths: paths.     
+00014380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014390: 2020 202e 6974 6572 2829 0a20 2020 2020     .iter().     
+000143a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143b0: 2020 202e 6669 6c74 6572 5f6d 6170 287c     .filter_map(|
+000143c0: 7061 7468 5f6d 6170 7069 6e67 7c20 7b0a  path_mapping| {.
+000143d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143e0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+000143f0: 7061 7468 5f69 6e64 6578 203d 2070 6174  path_index = pat
+00014400: 685f 6d61 7070 696e 672e 302e 696e 6465  h_mapping.0.inde
+00014410: 7828 293b 0a20 2020 2020 2020 2020 2020  x();.           
+00014420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014430: 2069 6620 696e 6465 7820 213d 2070 6174   if index != pat
+00014440: 685f 696e 6465 7820 7b0a 2020 2020 2020  h_index {.      
+00014450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014460: 2020 2020 2020 2020 2020 536f 6d65 2828            Some((
+00014470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014490: 2020 2020 2070 6174 685f 696e 6465 782c       path_index,
+000144a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000144b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144c0: 2020 2020 2070 6174 685f 6d61 7070 696e       path_mappin
+000144d0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144f0: 2020 2020 2020 2020 2020 2e31 0a20 2020            .1.   
+00014500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014520: 2020 2020 202e 6974 6572 2829 0a20 2020       .iter().   
+00014530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014550: 2020 2020 202e 6d61 7028 7c78 7c20 782e       .map(|x| x.
+00014560: 696e 6465 7828 2929 0a20 2020 2020 2020  index()).       
+00014570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014590: 202e 636f 6c6c 6563 7428 292c 0a20 2020   .collect(),.   
+000145a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145b0: 2020 2020 2020 2020 2020 2020 2029 290a               )).
+000145c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145d0: 2020 2020 2020 2020 2020 2020 7d20 656c              } el
+000145e0: 7365 207b 0a20 2020 2020 2020 2020 2020  se {.           
+000145f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014600: 2020 2020 204e 6f6e 650a 2020 2020 2020       None.      
+00014610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014620: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014640: 7d29 0a20 2020 2020 2020 2020 2020 2020  }).             
+00014650: 2020 2020 2020 2020 2020 202e 636f 6c6c             .coll
+00014660: 6563 7428 292c 0a20 2020 2020 2020 2020  ect(),.         
+00014670: 2020 2020 2020 207d 3b0a 2020 2020 2020         };.      
+00014680: 2020 2020 2020 2020 2020 2869 6e64 6578            (index
+00014690: 2c20 6f75 745f 7061 7468 7329 0a20 2020  , out_paths).   
+000146a0: 2020 2020 2020 2020 207d 290a 2020 2020           }).    
+000146b0: 2020 2020 2020 2020 2e63 6f6c 6c65 6374          .collect
+000146c0: 2829 2c0a 2020 2020 7d29 0a7d 0a0a 2f2f  (),.    }).}..//
+000146d0: 2f20 4361 6c63 756c 6174 6520 7468 6520  / Calculate the 
+000146e0: 7468 6520 7368 6f72 7465 7374 206c 656e  the shortest len
+000146f0: 6774 6820 6672 6f6d 2061 6c6c 206e 6f64  gth from all nod
+00014700: 6573 2069 6e20 610a 2f2f 2f20 3a63 6c61  es in a./// :cla
+00014710: 7373 3a60 7e72 6574 776f 726b 782e 5079  ss:`~retworkx.Py
+00014720: 4469 4772 6170 6860 206f 626a 6563 740a  DiGraph` object.
+00014730: 2f2f 2f0a 2f2f 2f20 5468 6973 2066 756e  ///./// This fun
+00014740: 6374 696f 6e20 7769 6c6c 2067 656e 6572  ction will gener
+00014750: 6174 6520 7468 6520 7368 6f72 7465 7374  ate the shortest
+00014760: 2070 6174 6820 6672 6f6d 2061 2073 6f75   path from a sou
+00014770: 7263 6520 6e6f 6465 2075 7369 6e67 0a2f  rce node using./
+00014780: 2f2f 2044 696a 6b73 7472 6127 7320 616c  // Dijkstra's al
+00014790: 676f 7269 7468 6d2e 2054 6869 7320 6675  gorithm. This fu
+000147a0: 6e63 7469 6f6e 2069 7320 6d75 6c74 6974  nction is multit
+000147b0: 6872 6561 6465 6420 616e 6420 7769 6c6c  hreaded and will
+000147c0: 2072 756e 0a2f 2f2f 206c 6175 6e63 6820   run./// launch 
+000147d0: 6120 7468 7265 6164 2070 6f6f 6c20 7769  a thread pool wi
+000147e0: 7468 2074 6872 6561 6473 2065 7175 616c  th threads equal
+000147f0: 2074 6f20 7468 6520 6e75 6d62 6572 206f   to the number o
+00014800: 6620 4350 5573 2062 7920 6465 6661 756c  f CPUs by defaul
+00014810: 742e 0a2f 2f2f 2059 6f75 2063 616e 2074  t../// You can t
+00014820: 756e 6520 7468 6520 6e75 6d62 6572 206f  une the number o
+00014830: 6620 7468 7265 6164 7320 7769 7468 2074  f threads with t
+00014840: 6865 2060 6052 4159 4f4e 5f4e 554d 5f54  he ``RAYON_NUM_T
+00014850: 4852 4541 4453 6060 0a2f 2f2f 2065 6e76  HREADS``./// env
+00014860: 6972 6f6e 6d65 6e74 2076 6172 6961 626c  ironment variabl
+00014870: 652e 2046 6f72 2065 7861 6d70 6c65 2c20  e. For example, 
+00014880: 7365 7474 696e 6720 6060 5241 594f 4e5f  setting ``RAYON_
+00014890: 4e55 4d5f 5448 5245 4144 533d 3460 6020  NUM_THREADS=4`` 
+000148a0: 776f 756c 640a 2f2f 2f20 6c69 6d69 7420  would./// limit 
+000148b0: 7468 6520 7468 7265 6164 2070 6f6f 6c20  the thread pool 
+000148c0: 746f 2034 2074 6872 6561 6473 2e0a 2f2f  to 4 threads..//
+000148d0: 2f0a 2f2f 2f20 3a70 6172 616d 2067 7261  /./// :param gra
+000148e0: 7068 3a20 5468 6520 696e 7075 7420 3a63  ph: The input :c
+000148f0: 6c61 7373 3a60 7e72 6574 776f 726b 782e  lass:`~retworkx.
+00014900: 5079 4469 4772 6170 6860 2074 6f20 7573  PyDiGraph` to us
+00014910: 650a 2f2f 2f20 3a70 6172 616d 2065 6467  e./// :param edg
+00014920: 655f 636f 7374 5f66 6e3a 2041 2063 616c  e_cost_fn: A cal
+00014930: 6c61 626c 6520 6f62 6a65 6374 2074 6861  lable object tha
+00014940: 7420 6163 7473 2061 7320 6120 7765 6967  t acts as a weig
+00014950: 6874 2066 756e 6374 696f 6e20 666f 720a  ht function for.
+00014960: 2f2f 2f20 2020 2020 616e 2065 6467 652e  ///     an edge.
+00014970: 2049 7420 7769 6c6c 2061 6363 6570 7420   It will accept 
+00014980: 6120 7369 6e67 6c65 2070 6f73 6974 696f  a single positio
+00014990: 6e61 6c20 6172 6775 6d65 6e74 2c20 7468  nal argument, th
+000149a0: 6520 6564 6765 2773 2077 6569 6768 740a  e edge's weight.
+000149b0: 2f2f 2f20 2020 2020 6f62 6a65 6374 2061  ///     object a
+000149c0: 6e64 2077 696c 6c20 7265 7475 726e 2061  nd will return a
+000149d0: 2066 6c6f 6174 2077 6869 6368 2077 696c   float which wil
+000149e0: 6c20 6265 2075 7365 6420 746f 2072 6570  l be used to rep
+000149f0: 7265 7365 6e74 2074 6865 0a2f 2f2f 2020  resent the.///  
+00014a00: 2020 2077 6569 6768 742f 636f 7374 206f     weight/cost o
+00014a10: 6620 7468 6520 6564 6765 0a2f 2f2f 0a2f  f the edge.///./
+00014a20: 2f2f 203a 7265 7475 726e 3a20 4120 7265  // :return: A re
+00014a30: 6164 2d6f 6e6c 7920 6469 6374 696f 6e61  ad-only dictiona
+00014a40: 7279 206f 6620 7061 7468 206c 656e 6774  ry of path lengt
+00014a50: 6873 2e20 5468 6520 6b65 7973 2061 7265  hs. The keys are
+00014a60: 2073 6f75 7263 650a 2f2f 2f20 2020 2020   source.///     
+00014a70: 6e6f 6465 2069 6e64 6963 6573 2061 6e64  node indices and
+00014a80: 2074 6865 2076 616c 7565 7320 6172 6520   the values are 
+00014a90: 6469 6374 7320 6f66 2074 6865 2074 6172  dicts of the tar
+00014aa0: 6765 7420 6e6f 6465 2061 6e64 2074 6865  get node and the
+00014ab0: 206c 656e 6774 680a 2f2f 2f20 2020 2020   length.///     
+00014ac0: 6f66 2074 6865 2073 686f 7274 6573 7420  of the shortest 
+00014ad0: 7061 7468 2074 6f20 7468 6174 206e 6f64  path to that nod
+00014ae0: 652e 2046 6f72 2065 7861 6d70 6c65 3a3a  e. For example::
+00014af0: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+00014b00: 207b 0a2f 2f2f 2020 2020 2020 2020 2020   {.///          
+00014b10: 2020 2030 3a20 7b31 3a20 322e 302c 2032     0: {1: 2.0, 2
+00014b20: 3a20 322e 307d 2c0a 2f2f 2f20 2020 2020  : 2.0},.///     
+00014b30: 2020 2020 2020 2020 313a 207b 323a 2031          1: {2: 1
+00014b40: 2e30 7d2c 0a2f 2f2f 2020 2020 2020 2020  .0},.///        
+00014b50: 2020 2020 2032 3a20 7b30 3a20 312e 307d       2: {0: 1.0}
+00014b60: 2c0a 2f2f 2f20 2020 2020 2020 2020 7d0a  ,.///         }.
+00014b70: 2f2f 2f0a 2f2f 2f20 3a72 7479 7065 3a20  ///./// :rtype: 
+00014b80: 416c 6c50 6169 7273 5061 7468 4c65 6e67  AllPairsPathLeng
+00014b90: 7468 4d61 7070 696e 670a 235b 7079 6675  thMapping.#[pyfu
+00014ba0: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
+00014bb0: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+00014bc0: 7068 2c20 6564 6765 5f63 6f73 745f 666e  ph, edge_cost_fn
+00014bd0: 2c20 2f29 225d 0a70 7562 2066 6e20 6469  , /)"].pub fn di
+00014be0: 6772 6170 685f 616c 6c5f 7061 6972 735f  graph_all_pairs_
+00014bf0: 6469 6a6b 7374 7261 5f70 6174 685f 6c65  dijkstra_path_le
+00014c00: 6e67 7468 7328 0a20 2020 2070 793a 2050  ngths(.    py: P
+00014c10: 7974 686f 6e2c 0a20 2020 2067 7261 7068  ython,.    graph
+00014c20: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+00014c30: 4772 6170 682c 0a20 2020 2065 6467 655f  Graph,.    edge_
+00014c40: 636f 7374 5f66 6e3a 2050 794f 626a 6563  cost_fn: PyObjec
+00014c50: 742c 0a29 202d 3e20 5079 5265 7375 6c74  t,.) -> PyResult
+00014c60: 3c41 6c6c 5061 6972 7350 6174 684c 656e  <AllPairsPathLen
+00014c70: 6774 684d 6170 7069 6e67 3e20 7b0a 2020  gthMapping> {.  
+00014c80: 2020 5f61 6c6c 5f70 6169 7273 5f64 696a    _all_pairs_dij
+00014c90: 6b73 7472 615f 7061 7468 5f6c 656e 6774  kstra_path_lengt
+00014ca0: 6873 2870 792c 2026 6772 6170 682e 6772  hs(py, &graph.gr
+00014cb0: 6170 682c 2065 6467 655f 636f 7374 5f66  aph, edge_cost_f
+00014cc0: 6e29 0a7d 0a0a 2f2f 2f20 4669 6e64 2074  n).}../// Find t
+00014cd0: 6865 2073 686f 7274 6573 7420 7061 7468  he shortest path
+00014ce0: 2066 726f 6d20 616c 6c20 6e6f 6465 7320   from all nodes 
+00014cf0: 696e 2061 203a 636c 6173 733a 607e 7265  in a :class:`~re
+00014d00: 7477 6f72 6b78 2e50 7944 6947 7261 7068  tworkx.PyDiGraph
+00014d10: 600a 2f2f 2f20 6f62 6a65 6374 0a2f 2f2f  `./// object.///
+00014d20: 0a2f 2f2f 2054 6869 7320 6675 6e63 7469  ./// This functi
+00014d30: 6f6e 2077 696c 6c20 6765 6e65 7261 7465  on will generate
+00014d40: 2074 6865 2073 686f 7274 6573 7420 7061   the shortest pa
+00014d50: 7468 2066 726f 6d20 6120 736f 7572 6365  th from a source
+00014d60: 206e 6f64 6520 7573 696e 670a 2f2f 2f20   node using./// 
+00014d70: 4469 6a6b 7374 7261 2773 2061 6c67 6f72  Dijkstra's algor
+00014d80: 6974 686d 2e20 5468 6973 2066 756e 6374  ithm. This funct
+00014d90: 696f 6e20 6973 206d 756c 7469 7468 7265  ion is multithre
+00014da0: 6164 6564 2061 6e64 2077 696c 6c20 7275  aded and will ru
+00014db0: 6e0a 2f2f 2f20 6c61 756e 6368 2061 2074  n./// launch a t
+00014dc0: 6872 6561 6420 706f 6f6c 2077 6974 6820  hread pool with 
+00014dd0: 7468 7265 6164 7320 6571 7561 6c20 746f  threads equal to
+00014de0: 2074 6865 206e 756d 6265 7220 6f66 2043   the number of C
+00014df0: 5055 7320 6279 2064 6566 6175 6c74 2e0a  PUs by default..
+00014e00: 2f2f 2f20 596f 7520 6361 6e20 7475 6e65  /// You can tune
+00014e10: 2074 6865 206e 756d 6265 7220 6f66 2074   the number of t
+00014e20: 6872 6561 6473 2077 6974 6820 7468 6520  hreads with the 
+00014e30: 6060 5241 594f 4e5f 4e55 4d5f 5448 5245  ``RAYON_NUM_THRE
+00014e40: 4144 5360 600a 2f2f 2f20 656e 7669 726f  ADS``./// enviro
+00014e50: 6e6d 656e 7420 7661 7269 6162 6c65 2e20  nment variable. 
+00014e60: 466f 7220 6578 616d 706c 652c 2073 6574  For example, set
+00014e70: 7469 6e67 2060 6052 4159 4f4e 5f4e 554d  ting ``RAYON_NUM
+00014e80: 5f54 4852 4541 4453 3d34 6060 2077 6f75  _THREADS=4`` wou
+00014e90: 6c64 0a2f 2f2f 206c 696d 6974 2074 6865  ld./// limit the
+00014ea0: 2074 6872 6561 6420 706f 6f6c 2074 6f20   thread pool to 
+00014eb0: 3420 7468 7265 6164 732e 0a2f 2f2f 0a2f  4 threads..///./
+00014ec0: 2f2f 203a 7061 7261 6d20 6772 6170 683a  // :param graph:
+00014ed0: 2054 6865 2069 6e70 7574 203a 636c 6173   The input :clas
+00014ee0: 733a 607e 7265 7477 6f72 6b78 2e50 7944  s:`~retworkx.PyD
+00014ef0: 6947 7261 7068 6020 6f62 6a65 6374 2074  iGraph` object t
+00014f00: 6f20 7573 650a 2f2f 2f20 3a70 6172 616d  o use./// :param
+00014f10: 2065 6467 655f 636f 7374 5f66 6e3a 2041   edge_cost_fn: A
+00014f20: 2063 616c 6c61 626c 6520 6f62 6a65 6374   callable object
+00014f30: 2074 6861 7420 6163 7473 2061 7320 6120   that acts as a 
+00014f40: 7765 6967 6874 2066 756e 6374 696f 6e20  weight function 
+00014f50: 666f 720a 2f2f 2f20 2020 2020 616e 2065  for.///     an e
+00014f60: 6467 652e 2049 7420 7769 6c6c 2061 6363  dge. It will acc
+00014f70: 6570 7420 6120 7369 6e67 6c65 2070 6f73  ept a single pos
+00014f80: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00014f90: 2c20 7468 6520 6564 6765 2773 2077 6569  , the edge's wei
+00014fa0: 6768 740a 2f2f 2f20 2020 2020 6f62 6a65  ght.///     obje
+00014fb0: 6374 2061 6e64 2077 696c 6c20 7265 7475  ct and will retu
+00014fc0: 726e 2061 2066 6c6f 6174 2077 6869 6368  rn a float which
+00014fd0: 2077 696c 6c20 6265 2075 7365 6420 746f   will be used to
+00014fe0: 2072 6570 7265 7365 6e74 2074 6865 0a2f   represent the./
+00014ff0: 2f2f 2020 2020 2077 6569 6768 742f 636f  //     weight/co
+00015000: 7374 206f 6620 7468 6520 6564 6765 0a2f  st of the edge./
+00015010: 2f2f 0a2f 2f2f 203a 7265 7475 726e 3a20  //./// :return: 
+00015020: 4120 7265 6164 2d6f 6e6c 7920 6469 6374  A read-only dict
+00015030: 696f 6e61 7279 206f 6620 7061 7468 732e  ionary of paths.
+00015040: 2054 6865 206b 6579 7320 6172 6520 736f   The keys are so
+00015050: 7572 6365 206e 6f64 6520 696e 6469 6365  urce node indice
+00015060: 730a 2f2f 2f20 2020 2020 616e 6420 7468  s.///     and th
+00015070: 6520 7661 6c75 6573 2061 7265 2064 6963  e values are dic
+00015080: 7473 206f 6620 7468 6520 7461 7267 6574  ts of the target
+00015090: 206e 6f64 6520 616e 6420 7468 6520 6c69   node and the li
+000150a0: 7374 206f 6620 7468 650a 2f2f 2f20 2020  st of the.///   
+000150b0: 2020 6e6f 6465 2069 6e64 6963 6573 206d    node indices m
+000150c0: 616b 696e 6720 7570 2074 6865 2073 686f  aking up the sho
+000150d0: 7274 6573 7420 7061 7468 2074 6f20 7468  rtest path to th
+000150e0: 6174 206e 6f64 652e 2046 6f72 2065 7861  at node. For exa
+000150f0: 6d70 6c65 3a3a 0a2f 2f2f 0a2f 2f2f 2020  mple::.///.///  
+00015100: 2020 2020 2020 207b 0a2f 2f2f 2020 2020         {.///    
+00015110: 2020 2020 2020 2020 2030 3a20 7b31 3a20           0: {1: 
+00015120: 5b30 2c20 315d 2c20 2032 3a20 5b30 2c20  [0, 1],  2: [0, 
+00015130: 312c 2032 5d7d 2c0a 2f2f 2f20 2020 2020  1, 2]},.///     
+00015140: 2020 2020 2020 2020 313a 207b 323a 205b          1: {2: [
+00015150: 312c 2032 5d7d 2c0a 2f2f 2f20 2020 2020  1, 2]},.///     
+00015160: 2020 2020 2020 2020 323a 207b 303a 205b          2: {0: [
+00015170: 322c 2030 5d7d 2c0a 2f2f 2f20 2020 2020  2, 0]},.///     
+00015180: 2020 2020 7d0a 2f2f 2f0a 2f2f 2f20 3a72      }.///./// :r
+00015190: 7479 7065 3a20 416c 6c50 6169 7273 5061  type: AllPairsPa
+000151a0: 7468 4d61 7070 696e 670a 235b 7079 6675  thMapping.#[pyfu
+000151b0: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
+000151c0: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+000151d0: 7068 2c20 6564 6765 5f63 6f73 745f 666e  ph, edge_cost_fn
+000151e0: 2c20 2f29 225d 0a70 7562 2066 6e20 6469  , /)"].pub fn di
+000151f0: 6772 6170 685f 616c 6c5f 7061 6972 735f  graph_all_pairs_
+00015200: 6469 6a6b 7374 7261 5f73 686f 7274 6573  dijkstra_shortes
+00015210: 745f 7061 7468 7328 0a20 2020 2070 793a  t_paths(.    py:
+00015220: 2050 7974 686f 6e2c 0a20 2020 2067 7261   Python,.    gra
+00015230: 7068 3a20 2664 6967 7261 7068 3a3a 5079  ph: &digraph::Py
+00015240: 4469 4772 6170 682c 0a20 2020 2065 6467  DiGraph,.    edg
+00015250: 655f 636f 7374 5f66 6e3a 2050 794f 626a  e_cost_fn: PyObj
+00015260: 6563 742c 0a29 202d 3e20 5079 5265 7375  ect,.) -> PyResu
+00015270: 6c74 3c41 6c6c 5061 6972 7350 6174 684d  lt<AllPairsPathM
+00015280: 6170 7069 6e67 3e20 7b0a 2020 2020 5f61  apping> {.    _a
+00015290: 6c6c 5f70 6169 7273 5f64 696a 6b73 7472  ll_pairs_dijkstr
+000152a0: 615f 7368 6f72 7465 7374 5f70 6174 6873  a_shortest_paths
+000152b0: 2870 792c 2026 6772 6170 682e 6772 6170  (py, &graph.grap
+000152c0: 682c 2065 6467 655f 636f 7374 5f66 6e29  h, edge_cost_fn)
+000152d0: 0a7d 0a0a 2f2f 2f20 4361 6c63 756c 6174  .}../// Calculat
+000152e0: 6520 7468 6520 7468 6520 7368 6f72 7465  e the the shorte
+000152f0: 7374 206c 656e 6774 6820 6672 6f6d 2061  st length from a
+00015300: 6c6c 206e 6f64 6573 2069 6e20 610a 2f2f  ll nodes in a.//
+00015310: 2f20 3a63 6c61 7373 3a60 7e72 6574 776f  / :class:`~retwo
+00015320: 726b 782e 5079 4772 6170 6860 206f 626a  rkx.PyGraph` obj
+00015330: 6563 740a 2f2f 2f0a 2f2f 2f20 5468 6973  ect.///./// This
+00015340: 2066 756e 6374 696f 6e20 7769 6c6c 2067   function will g
+00015350: 656e 6572 6174 6520 7468 6520 7368 6f72  enerate the shor
+00015360: 7465 7374 2070 6174 6820 6672 6f6d 2061  test path from a
+00015370: 2073 6f75 7263 6520 6e6f 6465 2075 7369   source node usi
+00015380: 6e67 0a2f 2f2f 2044 696a 6b73 7472 6127  ng./// Dijkstra'
+00015390: 7320 616c 676f 7269 7468 6d2e 0a2f 2f2f  s algorithm..///
+000153a0: 0a2f 2f2f 203a 7061 7261 6d20 6772 6170  ./// :param grap
+000153b0: 683a 2054 6865 2069 6e70 7574 203a 636c  h: The input :cl
+000153c0: 6173 733a 607e 7265 7477 6f72 6b78 2e50  ass:`~retworkx.P
+000153d0: 7947 7261 7068 6020 746f 2075 7365 0a2f  yGraph` to use./
+000153e0: 2f2f 203a 7061 7261 6d20 6564 6765 5f63  // :param edge_c
+000153f0: 6f73 745f 666e 3a20 4120 6361 6c6c 6162  ost_fn: A callab
+00015400: 6c65 206f 626a 6563 7420 7468 6174 2061  le object that a
+00015410: 6374 7320 6173 2061 2077 6569 6768 7420  cts as a weight 
+00015420: 6675 6e63 7469 6f6e 2066 6f72 0a2f 2f2f  function for.///
+00015430: 2020 2020 2061 6e20 6564 6765 2e20 4974       an edge. It
+00015440: 2077 696c 6c20 6163 6365 7074 2061 2073   will accept a s
+00015450: 696e 676c 6520 706f 7369 7469 6f6e 616c  ingle positional
+00015460: 2061 7267 756d 656e 742c 2074 6865 2065   argument, the e
+00015470: 6467 6527 7320 7765 6967 6874 0a2f 2f2f  dge's weight.///
+00015480: 2020 2020 206f 626a 6563 7420 616e 6420       object and 
+00015490: 7769 6c6c 2072 6574 7572 6e20 6120 666c  will return a fl
+000154a0: 6f61 7420 7768 6963 6820 7769 6c6c 2062  oat which will b
+000154b0: 6520 7573 6564 2074 6f20 7265 7072 6573  e used to repres
+000154c0: 656e 7420 7468 650a 2f2f 2f20 2020 2020  ent the.///     
+000154d0: 7765 6967 6874 2f63 6f73 7420 6f66 2074  weight/cost of t
+000154e0: 6865 2065 6467 650a 2f2f 2f0a 2f2f 2f20  he edge.///./// 
+000154f0: 3a72 6574 7572 6e3a 2041 2072 6561 642d  :return: A read-
+00015500: 6f6e 6c79 2064 6963 7469 6f6e 6172 7920  only dictionary 
+00015510: 6f66 2070 6174 6820 6c65 6e67 7468 732e  of path lengths.
+00015520: 2054 6865 206b 6579 7320 6172 6520 736f   The keys are so
+00015530: 7572 6365 0a2f 2f2f 2020 2020 206e 6f64  urce.///     nod
+00015540: 6520 696e 6469 6365 7320 616e 6420 7468  e indices and th
+00015550: 6520 7661 6c75 6573 2061 7265 2064 6963  e values are dic
+00015560: 7473 206f 6620 7468 6520 7461 7267 6574  ts of the target
+00015570: 206e 6f64 6520 616e 6420 7468 6520 6c65   node and the le
+00015580: 6e67 7468 0a2f 2f2f 2020 2020 206f 6620  ngth.///     of 
+00015590: 7468 6520 7368 6f72 7465 7374 2070 6174  the shortest pat
+000155a0: 6820 746f 2074 6861 7420 6e6f 6465 2e20  h to that node. 
+000155b0: 466f 7220 6578 616d 706c 653a 3a0a 2f2f  For example::.//
+000155c0: 2f0a 2f2f 2f20 2020 2020 2020 2020 7b0a  /.///         {.
+000155d0: 2f2f 2f20 2020 2020 2020 2020 2020 2020  ///             
+000155e0: 303a 207b 313a 2032 2e30 2c20 323a 2032  0: {1: 2.0, 2: 2
+000155f0: 2e30 7d2c 0a2f 2f2f 2020 2020 2020 2020  .0},.///        
+00015600: 2020 2020 2031 3a20 7b32 3a20 312e 307d       1: {2: 1.0}
+00015610: 2c0a 2f2f 2f20 2020 2020 2020 2020 2020  ,.///           
+00015620: 2020 323a 207b 303a 2031 2e30 7d2c 0a2f    2: {0: 1.0},./
+00015630: 2f2f 2020 2020 2020 2020 207d 0a2f 2f2f  //         }.///
+00015640: 0a2f 2f2f 203a 7274 7970 653a 2041 6c6c  ./// :rtype: All
+00015650: 5061 6972 7350 6174 684c 656e 6774 684d  PairsPathLengthM
+00015660: 6170 7069 6e67 0a23 5b70 7966 756e 6374  apping.#[pyfunct
+00015670: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
+00015680: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+00015690: 2065 6467 655f 636f 7374 5f66 6e2c 202f   edge_cost_fn, /
+000156a0: 2922 5d0a 7075 6220 666e 2067 7261 7068  )"].pub fn graph
+000156b0: 5f61 6c6c 5f70 6169 7273 5f64 696a 6b73  _all_pairs_dijks
+000156c0: 7472 615f 7061 7468 5f6c 656e 6774 6873  tra_path_lengths
+000156d0: 280a 2020 2020 7079 3a20 5079 7468 6f6e  (.    py: Python
+000156e0: 2c0a 2020 2020 6772 6170 683a 2026 6772  ,.    graph: &gr
+000156f0: 6170 683a 3a50 7947 7261 7068 2c0a 2020  aph::PyGraph,.  
+00015700: 2020 6564 6765 5f63 6f73 745f 666e 3a20    edge_cost_fn: 
+00015710: 5079 4f62 6a65 6374 2c0a 2920 2d3e 2050  PyObject,.) -> P
+00015720: 7952 6573 756c 743c 416c 6c50 6169 7273  yResult<AllPairs
+00015730: 5061 7468 4c65 6e67 7468 4d61 7070 696e  PathLengthMappin
+00015740: 673e 207b 0a20 2020 205f 616c 6c5f 7061  g> {.    _all_pa
+00015750: 6972 735f 6469 6a6b 7374 7261 5f70 6174  irs_dijkstra_pat
+00015760: 685f 6c65 6e67 7468 7328 7079 2c20 2667  h_lengths(py, &g
+00015770: 7261 7068 2e67 7261 7068 2c20 6564 6765  raph.graph, edge
+00015780: 5f63 6f73 745f 666e 290a 7d0a 0a2f 2f2f  _cost_fn).}..///
+00015790: 2046 696e 6420 7468 6520 7368 6f72 7465   Find the shorte
+000157a0: 7374 2070 6174 6820 6672 6f6d 2061 6c6c  st path from all
+000157b0: 206e 6f64 6573 2069 6e20 6120 3a63 6c61   nodes in a :cla
+000157c0: 7373 3a60 7e72 6574 776f 726b 782e 5079  ss:`~retworkx.Py
+000157d0: 4772 6170 6860 0a2f 2f2f 206f 626a 6563  Graph`./// objec
+000157e0: 740a 2f2f 2f0a 2f2f 2f20 5468 6973 2066  t.///./// This f
+000157f0: 756e 6374 696f 6e20 7769 6c6c 2067 656e  unction will gen
+00015800: 6572 6174 6520 7468 6520 7368 6f72 7465  erate the shorte
+00015810: 7374 2070 6174 6820 6672 6f6d 2061 2073  st path from a s
+00015820: 6f75 7263 6520 6e6f 6465 2075 7369 6e67  ource node using
+00015830: 0a2f 2f2f 2044 696a 6b73 7472 6127 7320  ./// Dijkstra's 
+00015840: 616c 676f 7269 7468 6d2e 0a2f 2f2f 0a2f  algorithm..///./
+00015850: 2f2f 203a 7061 7261 6d20 6772 6170 683a  // :param graph:
+00015860: 2054 6865 2069 6e70 7574 203a 636c 6173   The input :clas
+00015870: 733a 607e 7265 7477 6f72 6b78 2e50 7947  s:`~retworkx.PyG
+00015880: 7261 7068 6020 6f62 6a65 6374 2074 6f20  raph` object to 
+00015890: 7573 650a 2f2f 2f20 3a70 6172 616d 2065  use./// :param e
+000158a0: 6467 655f 636f 7374 5f66 6e3a 2041 2063  dge_cost_fn: A c
+000158b0: 616c 6c61 626c 6520 6f62 6a65 6374 2074  allable object t
+000158c0: 6861 7420 6163 7473 2061 7320 6120 7765  hat acts as a we
+000158d0: 6967 6874 2066 756e 6374 696f 6e20 666f  ight function fo
+000158e0: 720a 2f2f 2f20 2020 2020 616e 2065 6467  r.///     an edg
+000158f0: 652e 2049 7420 7769 6c6c 2061 6363 6570  e. It will accep
+00015900: 7420 6120 7369 6e67 6c65 2070 6f73 6974  t a single posit
+00015910: 696f 6e61 6c20 6172 6775 6d65 6e74 2c20  ional argument, 
+00015920: 7468 6520 6564 6765 2773 2077 6569 6768  the edge's weigh
+00015930: 740a 2f2f 2f20 2020 2020 6f62 6a65 6374  t.///     object
+00015940: 2061 6e64 2077 696c 6c20 7265 7475 726e   and will return
+00015950: 2061 2066 6c6f 6174 2077 6869 6368 2077   a float which w
+00015960: 696c 6c20 6265 2075 7365 6420 746f 2072  ill be used to r
+00015970: 6570 7265 7365 6e74 2074 6865 0a2f 2f2f  epresent the.///
+00015980: 2020 2020 2077 6569 6768 742f 636f 7374       weight/cost
+00015990: 206f 6620 7468 6520 6564 6765 0a2f 2f2f   of the edge.///
+000159a0: 0a2f 2f2f 203a 7265 7475 726e 3a20 4120  ./// :return: A 
+000159b0: 7265 6164 2d6f 6e6c 7920 6469 6374 696f  read-only dictio
+000159c0: 6e61 7279 206f 6620 7061 7468 732e 2054  nary of paths. T
+000159d0: 6865 206b 6579 7320 6172 6520 6465 7374  he keys are dest
+000159e0: 696e 6174 696f 6e20 6e6f 6465 0a2f 2f2f  ination node.///
+000159f0: 2020 2020 2069 6e64 6963 6573 2061 6e64       indices and
+00015a00: 2074 6865 2076 616c 7565 7320 6172 6520   the values are 
+00015a10: 6469 6374 7320 6f66 2074 6865 2074 6172  dicts of the tar
+00015a20: 6765 7420 6e6f 6465 2061 6e64 2074 6865  get node and the
+00015a30: 206c 6973 7420 6f66 2074 6865 0a2f 2f2f   list of the.///
+00015a40: 2020 2020 206e 6f64 6520 696e 6469 6365       node indice
+00015a50: 7320 6d61 6b69 6e67 2075 7020 7468 6520  s making up the 
+00015a60: 7368 6f72 7465 7374 2070 6174 6820 746f  shortest path to
+00015a70: 2074 6861 7420 6e6f 6465 2e20 466f 7220   that node. For 
+00015a80: 6578 616d 706c 653a 3a0a 2f2f 2f0a 2f2f  example::.///.//
+00015a90: 2f20 2020 2020 2020 2020 7b0a 2f2f 2f20  /         {./// 
+00015aa0: 2020 2020 2020 2020 2020 2020 303a 207b              0: {
+00015ab0: 313a 205b 302c 2031 5d2c 2020 323a 205b  1: [0, 1],  2: [
+00015ac0: 302c 2031 2c20 325d 7d2c 0a2f 2f2f 2020  0, 1, 2]},.///  
+00015ad0: 2020 2020 2020 2020 2020 2031 3a20 7b32             1: {2
+00015ae0: 3a20 5b31 2c20 325d 7d2c 0a2f 2f2f 2020  : [1, 2]},.///  
+00015af0: 2020 2020 2020 2020 2020 2032 3a20 7b30             2: {0
+00015b00: 3a20 5b32 2c20 305d 7d2c 0a2f 2f2f 2020  : [2, 0]},.///  
+00015b10: 2020 2020 2020 207d 0a2f 2f2f 0a2f 2f2f         }.///.///
+00015b20: 203a 7274 7970 653a 2041 6c6c 5061 6972   :rtype: AllPair
+00015b30: 7350 6174 684d 6170 7069 6e67 0a23 5b70  sPathMapping.#[p
+00015b40: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
+00015b50: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+00015b60: 6772 6170 682c 2065 6467 655f 636f 7374  graph, edge_cost
+00015b70: 5f66 6e2c 202f 2922 5d0a 7075 6220 666e  _fn, /)"].pub fn
+00015b80: 2067 7261 7068 5f61 6c6c 5f70 6169 7273   graph_all_pairs
+00015b90: 5f64 696a 6b73 7472 615f 7368 6f72 7465  _dijkstra_shorte
+00015ba0: 7374 5f70 6174 6873 280a 2020 2020 7079  st_paths(.    py
+00015bb0: 3a20 5079 7468 6f6e 2c0a 2020 2020 6772  : Python,.    gr
+00015bc0: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
+00015bd0: 7261 7068 2c0a 2020 2020 6564 6765 5f63  raph,.    edge_c
+00015be0: 6f73 745f 666e 3a20 5079 4f62 6a65 6374  ost_fn: PyObject
+00015bf0: 2c0a 2920 2d3e 2050 7952 6573 756c 743c  ,.) -> PyResult<
+00015c00: 416c 6c50 6169 7273 5061 7468 4d61 7070  AllPairsPathMapp
+00015c10: 696e 673e 207b 0a20 2020 205f 616c 6c5f  ing> {.    _all_
+00015c20: 7061 6972 735f 6469 6a6b 7374 7261 5f73  pairs_dijkstra_s
+00015c30: 686f 7274 6573 745f 7061 7468 7328 7079  hortest_paths(py
+00015c40: 2c20 2667 7261 7068 2e67 7261 7068 2c20  , &graph.graph, 
+00015c50: 6564 6765 5f63 6f73 745f 666e 290a 7d0a  edge_cost_fn).}.
+00015c60: 0a2f 2f2f 2043 6f6d 7075 7465 2074 6865  ./// Compute the
+00015c70: 2041 2a20 7368 6f72 7465 7374 2070 6174   A* shortest pat
+00015c80: 6820 666f 7220 6120 5079 4772 6170 680a  h for a PyGraph.
+00015c90: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+00015ca0: 7947 7261 7068 2067 7261 7068 3a20 5468  yGraph graph: Th
+00015cb0: 6520 696e 7075 7420 6772 6170 6820 746f  e input graph to
+00015cc0: 2075 7365 0a2f 2f2f 203a 7061 7261 6d20   use./// :param 
+00015cd0: 696e 7420 6e6f 6465 3a20 5468 6520 6e6f  int node: The no
+00015ce0: 6465 2069 6e64 6578 2074 6f20 636f 6d70  de index to comp
+00015cf0: 7574 6520 7468 6520 7061 7468 2066 726f  ute the path fro
+00015d00: 6d0a 2f2f 2f20 3a70 6172 616d 2067 6f61  m./// :param goa
+00015d10: 6c5f 666e 3a20 4120 7079 7468 6f6e 2063  l_fn: A python c
+00015d20: 616c 6c61 626c 6520 7468 6174 2077 696c  allable that wil
+00015d30: 6c20 7461 6b65 2069 6e20 3120 7061 7261  l take in 1 para
+00015d40: 6d65 7465 722c 2061 206e 6f64 6527 7320  meter, a node's 
+00015d50: 6461 7461 0a2f 2f2f 2020 2020 206f 626a  data.///     obj
+00015d60: 6563 7420 616e 6420 7769 6c6c 2072 6574  ect and will ret
+00015d70: 7572 6e20 6120 626f 6f6c 6561 6e20 7768  urn a boolean wh
+00015d80: 6963 6820 7769 6c6c 2062 6520 5472 7565  ich will be True
+00015d90: 2069 6620 6974 2069 7320 7468 6520 6669   if it is the fi
+00015da0: 6e69 7368 0a2f 2f2f 2020 2020 206e 6f64  nish.///     nod
+00015db0: 652e 0a2f 2f2f 203a 7061 7261 6d20 6564  e../// :param ed
+00015dc0: 6765 5f63 6f73 745f 666e 3a20 4120 7079  ge_cost_fn: A py
+00015dd0: 7468 6f6e 2063 616c 6c61 626c 6520 7468  thon callable th
+00015de0: 6174 2077 696c 6c20 7461 6b65 2069 6e20  at will take in 
+00015df0: 3120 7061 7261 6d65 7465 722c 2061 6e20  1 parameter, an 
+00015e00: 6564 6765 2773 0a2f 2f2f 2020 2020 2064  edge's.///     d
+00015e10: 6174 6120 6f62 6a65 6374 2061 6e64 2077  ata object and w
+00015e20: 696c 6c20 7265 7475 726e 2061 2066 6c6f  ill return a flo
+00015e30: 6174 2074 6861 7420 7265 7072 6573 656e  at that represen
+00015e40: 7473 2074 6865 2063 6f73 7420 6f66 2074  ts the cost of t
+00015e50: 6861 740a 2f2f 2f20 2020 2020 6564 6765  hat.///     edge
+00015e60: 2e20 4974 206d 7573 7420 6265 206e 6f6e  . It must be non
+00015e70: 2d6e 6567 6174 6976 652e 0a2f 2f2f 203a  -negative../// :
+00015e80: 7061 7261 6d20 6573 7469 6d61 7465 5f63  param estimate_c
+00015e90: 6f73 745f 666e 3a20 4120 7079 7468 6f6e  ost_fn: A python
+00015ea0: 2063 616c 6c61 626c 6520 7468 6174 2077   callable that w
+00015eb0: 696c 6c20 7461 6b65 2069 6e20 3120 7061  ill take in 1 pa
+00015ec0: 7261 6d65 7465 722c 2061 0a2f 2f2f 2020  rameter, a.///  
+00015ed0: 2020 206e 6f64 6527 7320 6461 7461 206f     node's data o
+00015ee0: 626a 6563 7420 616e 6420 7769 6c6c 2072  bject and will r
+00015ef0: 6574 7572 6e20 6120 666c 6f61 7420 7768  eturn a float wh
+00015f00: 6963 6820 7265 7072 6573 656e 7473 2074  ich represents t
+00015f10: 6865 2065 7374 696d 6174 6564 0a2f 2f2f  he estimated.///
+00015f20: 2020 2020 2063 6f73 7420 666f 7220 7468       cost for th
+00015f30: 6520 6e65 7874 206e 6f64 652e 2054 6865  e next node. The
+00015f40: 2072 6574 7572 6e20 6d75 7374 2062 6520   return must be 
+00015f50: 6e6f 6e2d 6e65 6761 7469 7665 2e20 466f  non-negative. Fo
+00015f60: 7220 7468 650a 2f2f 2f20 2020 2020 616c  r the.///     al
+00015f70: 676f 7269 7468 6d20 746f 2066 696e 6420  gorithm to find 
+00015f80: 7468 6520 6163 7475 616c 2073 686f 7274  the actual short
+00015f90: 6573 7420 7061 7468 2c20 6974 2073 686f  est path, it sho
+00015fa0: 756c 6420 6265 2061 646d 6973 7369 626c  uld be admissibl
+00015fb0: 652c 0a2f 2f2f 2020 2020 206d 6561 6e69  e,.///     meani
+00015fc0: 6e67 2074 6861 7420 6974 2073 686f 756c  ng that it shoul
+00015fd0: 6420 6e65 7665 7220 6f76 6572 6573 7469  d never overesti
+00015fe0: 6d61 7465 2074 6865 2061 6374 7561 6c20  mate the actual 
+00015ff0: 636f 7374 2074 6f20 6765 7420 746f 2074  cost to get to t
+00016000: 6865 0a2f 2f2f 2020 2020 206e 6561 7265  he.///     neare
+00016010: 7374 2067 6f61 6c20 6e6f 6465 2e0a 2f2f  st goal node..//
+00016020: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+00016030: 5468 6520 636f 6d70 7574 6564 2073 686f  The computed sho
+00016040: 7274 6573 7420 7061 7468 2062 6574 7765  rtest path betwe
+00016050: 656e 206e 6f64 6520 616e 6420 6669 6e69  en node and fini
+00016060: 7368 2061 7320 6120 6c69 7374 0a2f 2f2f  sh as a list.///
+00016070: 2020 2020 206f 6620 6e6f 6465 2069 6e64       of node ind
+00016080: 6963 6573 2e0a 2f2f 2f20 3a72 7479 7065  ices../// :rtype
+00016090: 3a20 4e6f 6465 496e 6469 6365 730a 235b  : NodeIndices.#[
+000160a0: 7079 6675 6e63 7469 6f6e 5d0a 235b 7465  pyfunction].#[te
+000160b0: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
+000160c0: 2867 7261 7068 2c20 6e6f 6465 2c20 676f  (graph, node, go
+000160d0: 616c 5f66 6e2c 2065 6467 655f 636f 7374  al_fn, edge_cost
+000160e0: 2c20 6573 7469 6d61 7465 5f63 6f73 742c  , estimate_cost,
+000160f0: 202f 2922 5d0a 666e 2067 7261 7068 5f61   /)"].fn graph_a
+00016100: 7374 6172 5f73 686f 7274 6573 745f 7061  star_shortest_pa
+00016110: 7468 280a 2020 2020 7079 3a20 5079 7468  th(.    py: Pyth
+00016120: 6f6e 2c0a 2020 2020 6772 6170 683a 2026  on,.    graph: &
+00016130: 6772 6170 683a 3a50 7947 7261 7068 2c0a  graph::PyGraph,.
+00016140: 2020 2020 6e6f 6465 3a20 7573 697a 652c      node: usize,
+00016150: 0a20 2020 2067 6f61 6c5f 666e 3a20 5079  .    goal_fn: Py
+00016160: 4f62 6a65 6374 2c0a 2020 2020 6564 6765  Object,.    edge
+00016170: 5f63 6f73 745f 666e 3a20 5079 4f62 6a65  _cost_fn: PyObje
+00016180: 6374 2c0a 2020 2020 6573 7469 6d61 7465  ct,.    estimate
+00016190: 5f63 6f73 745f 666e 3a20 5079 4f62 6a65  _cost_fn: PyObje
+000161a0: 6374 2c0a 2920 2d3e 2050 7952 6573 756c  ct,.) -> PyResul
+000161b0: 743c 4e6f 6465 496e 6469 6365 733e 207b  t<NodeIndices> {
+000161c0: 0a20 2020 206c 6574 2067 6f61 6c5f 666e  .    let goal_fn
+000161d0: 5f63 616c 6c61 626c 6520 3d20 7c61 3a20  _callable = |a: 
+000161e0: 2650 794f 626a 6563 747c 202d 3e20 5079  &PyObject| -> Py
+000161f0: 5265 7375 6c74 3c62 6f6f 6c3e 207b 0a20  Result<bool> {. 
+00016200: 2020 2020 2020 206c 6574 2072 6573 203d         let res =
+00016210: 2067 6f61 6c5f 666e 2e63 616c 6c31 2870   goal_fn.call1(p
+00016220: 792c 2028 612c 2929 3f3b 0a20 2020 2020  y, (a,))?;.     
+00016230: 2020 206c 6574 2072 6177 203d 2072 6573     let raw = res
+00016240: 2e74 6f5f 6f62 6a65 6374 2870 7929 3b0a  .to_object(py);.
+00016250: 2020 2020 2020 2020 6c65 7420 6f75 7470          let outp
+00016260: 7574 3a20 626f 6f6c 203d 2072 6177 2e65  ut: bool = raw.e
+00016270: 7874 7261 6374 2870 7929 3f3b 0a20 2020  xtract(py)?;.   
+00016280: 2020 2020 204f 6b28 6f75 7470 7574 290a       Ok(output).
+00016290: 2020 2020 7d3b 0a0a 2020 2020 6c65 7420      };..    let 
+000162a0: 6564 6765 5f63 6f73 745f 6361 6c6c 6162  edge_cost_callab
+000162b0: 6c65 203d 207c 613a 2026 5079 4f62 6a65  le = |a: &PyObje
+000162c0: 6374 7c20 2d3e 2050 7952 6573 756c 743c  ct| -> PyResult<
+000162d0: 6636 343e 207b 0a20 2020 2020 2020 206c  f64> {.        l
+000162e0: 6574 2072 6573 203d 2065 6467 655f 636f  et res = edge_co
+000162f0: 7374 5f66 6e2e 6361 6c6c 3128 7079 2c20  st_fn.call1(py, 
+00016300: 2861 2c29 293f 3b0a 2020 2020 2020 2020  (a,))?;.        
+00016310: 6c65 7420 7261 7720 3d20 7265 732e 746f  let raw = res.to
+00016320: 5f6f 626a 6563 7428 7079 293b 0a20 2020  _object(py);.   
+00016330: 2020 2020 206c 6574 206f 7574 7075 743a       let output:
+00016340: 2066 3634 203d 2072 6177 2e65 7874 7261   f64 = raw.extra
+00016350: 6374 2870 7929 3f3b 0a20 2020 2020 2020  ct(py)?;.       
+00016360: 204f 6b28 6f75 7470 7574 290a 2020 2020   Ok(output).    
+00016370: 7d3b 0a0a 2020 2020 6c65 7420 6573 7469  };..    let esti
+00016380: 6d61 7465 5f63 6f73 745f 6361 6c6c 6162  mate_cost_callab
+00016390: 6c65 203d 207c 613a 2026 5079 4f62 6a65  le = |a: &PyObje
+000163a0: 6374 7c20 2d3e 2050 7952 6573 756c 743c  ct| -> PyResult<
+000163b0: 6636 343e 207b 0a20 2020 2020 2020 206c  f64> {.        l
+000163c0: 6574 2072 6573 203d 2065 7374 696d 6174  et res = estimat
+000163d0: 655f 636f 7374 5f66 6e2e 6361 6c6c 3128  e_cost_fn.call1(
+000163e0: 7079 2c20 2861 2c29 293f 3b0a 2020 2020  py, (a,))?;.    
+000163f0: 2020 2020 6c65 7420 7261 7720 3d20 7265      let raw = re
+00016400: 732e 746f 5f6f 626a 6563 7428 7079 293b  s.to_object(py);
+00016410: 0a20 2020 2020 2020 206c 6574 206f 7574  .        let out
+00016420: 7075 743a 2066 3634 203d 2072 6177 2e65  put: f64 = raw.e
+00016430: 7874 7261 6374 2870 7929 3f3b 0a20 2020  xtract(py)?;.   
+00016440: 2020 2020 204f 6b28 6f75 7470 7574 290a       Ok(output).
+00016450: 2020 2020 7d3b 0a20 2020 206c 6574 2073      };.    let s
+00016460: 7461 7274 203d 204e 6f64 6549 6e64 6578  tart = NodeIndex
+00016470: 3a3a 6e65 7728 6e6f 6465 293b 0a0a 2020  ::new(node);..  
+00016480: 2020 6c65 7420 6173 7461 725f 7265 7320    let astar_res 
+00016490: 3d20 6173 7461 723a 3a61 7374 6172 280a  = astar::astar(.
+000164a0: 2020 2020 2020 2020 6772 6170 682c 0a20          graph,. 
+000164b0: 2020 2020 2020 2073 7461 7274 2c0a 2020         start,.  
+000164c0: 2020 2020 2020 7c66 7c20 676f 616c 5f66        |f| goal_f
+000164d0: 6e5f 6361 6c6c 6162 6c65 2867 7261 7068  n_callable(graph
+000164e0: 2e67 7261 7068 2e6e 6f64 655f 7765 6967  .graph.node_weig
+000164f0: 6874 2866 292e 756e 7772 6170 2829 292c  ht(f).unwrap()),
+00016500: 0a20 2020 2020 2020 207c 657c 2065 6467  .        |e| edg
+00016510: 655f 636f 7374 5f63 616c 6c61 626c 6528  e_cost_callable(
+00016520: 652e 7765 6967 6874 2829 292c 0a20 2020  e.weight()),.   
+00016530: 2020 2020 207c 6573 7469 6d61 7465 7c20       |estimate| 
+00016540: 7b0a 2020 2020 2020 2020 2020 2020 6573  {.            es
+00016550: 7469 6d61 7465 5f63 6f73 745f 6361 6c6c  timate_cost_call
+00016560: 6162 6c65 2867 7261 7068 2e67 7261 7068  able(graph.graph
+00016570: 2e6e 6f64 655f 7765 6967 6874 2865 7374  .node_weight(est
+00016580: 696d 6174 6529 2e75 6e77 7261 7028 2929  imate).unwrap())
+00016590: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
+000165a0: 293f 3b0a 2020 2020 6c65 7420 7061 7468  )?;.    let path
+000165b0: 203d 206d 6174 6368 2061 7374 6172 5f72   = match astar_r
+000165c0: 6573 207b 0a20 2020 2020 2020 2053 6f6d  es {.        Som
+000165d0: 6528 7061 7468 2920 3d3e 2070 6174 682c  e(path) => path,
+000165e0: 0a20 2020 2020 2020 204e 6f6e 6520 3d3e  .        None =>
+000165f0: 207b 0a20 2020 2020 2020 2020 2020 2072   {.            r
+00016600: 6574 7572 6e20 4572 7228 4e6f 5061 7468  eturn Err(NoPath
+00016610: 466f 756e 643a 3a6e 6577 5f65 7272 280a  Found::new_err(.
+00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016630: 224e 6f20 7061 7468 2066 6f75 6e64 2074  "No path found t
+00016640: 6861 7420 7361 7469 7366 6965 7320 676f  hat satisfies go
+00016650: 616c 5f66 6e22 2c0a 2020 2020 2020 2020  al_fn",.        
+00016660: 2020 2020 2929 0a20 2020 2020 2020 207d      )).        }
+00016670: 0a20 2020 207d 3b0a 2020 2020 4f6b 284e  .    };.    Ok(N
+00016680: 6f64 6549 6e64 6963 6573 207b 0a20 2020  odeIndices {.   
+00016690: 2020 2020 206e 6f64 6573 3a20 7061 7468       nodes: path
+000166a0: 2e31 2e69 6e74 6f5f 6974 6572 2829 2e6d  .1.into_iter().m
+000166b0: 6170 287c 787c 2078 2e69 6e64 6578 2829  ap(|x| x.index()
+000166c0: 292e 636f 6c6c 6563 7428 292c 0a20 2020  ).collect(),.   
+000166d0: 207d 290a 7d0a 0a2f 2f2f 2043 6f6d 7075   }).}../// Compu
+000166e0: 7465 2074 6865 2041 2a20 7368 6f72 7465  te the A* shorte
+000166f0: 7374 2070 6174 6820 666f 7220 6120 5079  st path for a Py
+00016700: 4469 4772 6170 680a 2f2f 2f0a 2f2f 2f20  DiGraph.///./// 
+00016710: 3a70 6172 616d 2050 7944 6947 7261 7068  :param PyDiGraph
+00016720: 2067 7261 7068 3a20 5468 6520 696e 7075   graph: The inpu
+00016730: 7420 6772 6170 6820 746f 2075 7365 0a2f  t graph to use./
+00016740: 2f2f 203a 7061 7261 6d20 696e 7420 6e6f  // :param int no
+00016750: 6465 3a20 5468 6520 6e6f 6465 2069 6e64  de: The node ind
+00016760: 6578 2074 6f20 636f 6d70 7574 6520 7468  ex to compute th
+00016770: 6520 7061 7468 2066 726f 6d0a 2f2f 2f20  e path from./// 
+00016780: 3a70 6172 616d 2067 6f61 6c5f 666e 3a20  :param goal_fn: 
+00016790: 4120 7079 7468 6f6e 2063 616c 6c61 626c  A python callabl
+000167a0: 6520 7468 6174 2077 696c 6c20 7461 6b65  e that will take
+000167b0: 2069 6e20 3120 7061 7261 6d65 7465 722c   in 1 parameter,
+000167c0: 2061 206e 6f64 6527 730a 2f2f 2f20 2020   a node's.///   
+000167d0: 2020 6461 7461 206f 626a 6563 7420 616e    data object an
+000167e0: 6420 7769 6c6c 2072 6574 7572 6e20 6120  d will return a 
+000167f0: 626f 6f6c 6561 6e20 7768 6963 6820 7769  boolean which wi
+00016800: 6c6c 2062 6520 5472 7565 2069 6620 6974  ll be True if it
+00016810: 2069 7320 7468 650a 2f2f 2f20 2020 2020   is the.///     
+00016820: 6669 6e69 7368 206e 6f64 652e 0a2f 2f2f  finish node..///
+00016830: 203a 7061 7261 6d20 6564 6765 5f63 6f73   :param edge_cos
+00016840: 745f 666e 3a20 4120 7079 7468 6f6e 2063  t_fn: A python c
+00016850: 616c 6c61 626c 6520 7468 6174 2077 696c  allable that wil
+00016860: 6c20 7461 6b65 2069 6e20 3120 7061 7261  l take in 1 para
+00016870: 6d65 7465 722c 2061 6e0a 2f2f 2f20 2020  meter, an.///   
+00016880: 2020 6564 6765 2773 2064 6174 6120 6f62    edge's data ob
+00016890: 6a65 6374 2061 6e64 2077 696c 6c20 7265  ject and will re
+000168a0: 7475 726e 2061 2066 6c6f 6174 2074 6861  turn a float tha
+000168b0: 7420 7265 7072 6573 656e 7473 2074 6865  t represents the
+000168c0: 2063 6f73 7420 6f66 0a2f 2f2f 2020 2020   cost of.///    
+000168d0: 2074 6861 7420 6564 6765 2e20 4974 206d   that edge. It m
+000168e0: 7573 7420 6265 206e 6f6e 2d6e 6567 6174  ust be non-negat
+000168f0: 6976 652e 0a2f 2f2f 203a 7061 7261 6d20  ive../// :param 
+00016900: 6573 7469 6d61 7465 5f63 6f73 745f 666e  estimate_cost_fn
+00016910: 3a20 4120 7079 7468 6f6e 2063 616c 6c61  : A python calla
+00016920: 626c 6520 7468 6174 2077 696c 6c20 7461  ble that will ta
+00016930: 6b65 2069 6e20 3120 7061 7261 6d65 7465  ke in 1 paramete
+00016940: 722c 2061 0a2f 2f2f 2020 2020 206e 6f64  r, a.///     nod
+00016950: 6527 7320 6461 7461 206f 626a 6563 7420  e's data object 
+00016960: 616e 6420 7769 6c6c 2072 6574 7572 6e20  and will return 
+00016970: 6120 666c 6f61 7420 7768 6963 6820 7265  a float which re
+00016980: 7072 6573 656e 7473 2074 6865 0a2f 2f2f  presents the.///
+00016990: 2020 2020 2065 7374 696d 6174 6564 2063       estimated c
+000169a0: 6f73 7420 666f 7220 7468 6520 6e65 7874  ost for the next
+000169b0: 206e 6f64 652e 2054 6865 2072 6574 7572   node. The retur
+000169c0: 6e20 6d75 7374 2062 6520 6e6f 6e2d 6e65  n must be non-ne
+000169d0: 6761 7469 7665 2e20 466f 720a 2f2f 2f20  gative. For./// 
+000169e0: 2020 2020 7468 6520 616c 676f 7269 7468      the algorith
+000169f0: 6d20 746f 2066 696e 6420 7468 6520 6163  m to find the ac
+00016a00: 7475 616c 2073 686f 7274 6573 7420 7061  tual shortest pa
+00016a10: 7468 2c20 6974 2073 686f 756c 6420 6265  th, it should be
+00016a20: 0a2f 2f2f 2020 2020 2061 646d 6973 7369  .///     admissi
+00016a30: 626c 652c 206d 6561 6e69 6e67 2074 6861  ble, meaning tha
+00016a40: 7420 6974 2073 686f 756c 6420 6e65 7665  t it should neve
+00016a50: 7220 6f76 6572 6573 7469 6d61 7465 2074  r overestimate t
+00016a60: 6865 2061 6374 7561 6c20 636f 7374 0a2f  he actual cost./
+00016a70: 2f2f 2020 2020 2074 6f20 6765 7420 746f  //     to get to
+00016a80: 2074 6865 206e 6561 7265 7374 2067 6f61   the nearest goa
+00016a90: 6c20 6e6f 6465 2e0a 2f2f 2f0a 2f2f 2f20  l node..///./// 
+00016aa0: 3a72 6574 7572 6e3a 2054 6865 2063 6f6d  :return: The com
+00016ab0: 7075 7465 6420 7368 6f72 7465 7374 2070  puted shortest p
+00016ac0: 6174 6820 6265 7477 6565 6e20 6e6f 6465  ath between node
+00016ad0: 2061 6e64 2066 696e 6973 6820 6173 2061   and finish as a
+00016ae0: 206c 6973 740a 2f2f 2f20 2020 2020 6f66   list.///     of
+00016af0: 206e 6f64 6520 696e 6469 6365 732e 0a2f   node indices../
+00016b00: 2f2f 203a 7274 7970 653a 204e 6f64 6549  // :rtype: NodeI
+00016b10: 6e64 6963 6573 0a23 5b70 7966 756e 6374  ndices.#[pyfunct
+00016b20: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
+00016b30: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+00016b40: 206e 6f64 652c 2067 6f61 6c5f 666e 2c20   node, goal_fn, 
+00016b50: 6564 6765 5f63 6f73 742c 2065 7374 696d  edge_cost, estim
+00016b60: 6174 655f 636f 7374 2c20 2f29 225d 0a66  ate_cost, /)"].f
+00016b70: 6e20 6469 6772 6170 685f 6173 7461 725f  n digraph_astar_
+00016b80: 7368 6f72 7465 7374 5f70 6174 6828 0a20  shortest_path(. 
+00016b90: 2020 2070 793a 2050 7974 686f 6e2c 0a20     py: Python,. 
+00016ba0: 2020 2067 7261 7068 3a20 2664 6967 7261     graph: &digra
+00016bb0: 7068 3a3a 5079 4469 4772 6170 682c 0a20  ph::PyDiGraph,. 
+00016bc0: 2020 206e 6f64 653a 2075 7369 7a65 2c0a     node: usize,.
+00016bd0: 2020 2020 676f 616c 5f66 6e3a 2050 794f      goal_fn: PyO
+00016be0: 626a 6563 742c 0a20 2020 2065 6467 655f  bject,.    edge_
+00016bf0: 636f 7374 5f66 6e3a 2050 794f 626a 6563  cost_fn: PyObjec
+00016c00: 742c 0a20 2020 2065 7374 696d 6174 655f  t,.    estimate_
+00016c10: 636f 7374 5f66 6e3a 2050 794f 626a 6563  cost_fn: PyObjec
+00016c20: 742c 0a29 202d 3e20 5079 5265 7375 6c74  t,.) -> PyResult
+00016c30: 3c4e 6f64 6549 6e64 6963 6573 3e20 7b0a  <NodeIndices> {.
+00016c40: 2020 2020 6c65 7420 676f 616c 5f66 6e5f      let goal_fn_
+00016c50: 6361 6c6c 6162 6c65 203d 207c 613a 2026  callable = |a: &
+00016c60: 5079 4f62 6a65 6374 7c20 2d3e 2050 7952  PyObject| -> PyR
+00016c70: 6573 756c 743c 626f 6f6c 3e20 7b0a 2020  esult<bool> {.  
+00016c80: 2020 2020 2020 6c65 7420 7265 7320 3d20        let res = 
+00016c90: 676f 616c 5f66 6e2e 6361 6c6c 3128 7079  goal_fn.call1(py
+00016ca0: 2c20 2861 2c29 293f 3b0a 2020 2020 2020  , (a,))?;.      
+00016cb0: 2020 6c65 7420 7261 7720 3d20 7265 732e    let raw = res.
+00016cc0: 746f 5f6f 626a 6563 7428 7079 293b 0a20  to_object(py);. 
+00016cd0: 2020 2020 2020 206c 6574 206f 7574 7075         let outpu
+00016ce0: 743a 2062 6f6f 6c20 3d20 7261 772e 6578  t: bool = raw.ex
+00016cf0: 7472 6163 7428 7079 293f 3b0a 2020 2020  tract(py)?;.    
+00016d00: 2020 2020 4f6b 286f 7574 7075 7429 0a20      Ok(output). 
+00016d10: 2020 207d 3b0a 0a20 2020 206c 6574 2065     };..    let e
+00016d20: 6467 655f 636f 7374 5f63 616c 6c61 626c  dge_cost_callabl
+00016d30: 6520 3d20 7c61 3a20 2650 794f 626a 6563  e = |a: &PyObjec
+00016d40: 747c 202d 3e20 5079 5265 7375 6c74 3c66  t| -> PyResult<f
+00016d50: 3634 3e20 7b0a 2020 2020 2020 2020 6c65  64> {.        le
+00016d60: 7420 7265 7320 3d20 6564 6765 5f63 6f73  t res = edge_cos
+00016d70: 745f 666e 2e63 616c 6c31 2870 792c 2028  t_fn.call1(py, (
+00016d80: 612c 2929 3f3b 0a20 2020 2020 2020 206c  a,))?;.        l
+00016d90: 6574 2072 6177 203d 2072 6573 2e74 6f5f  et raw = res.to_
+00016da0: 6f62 6a65 6374 2870 7929 3b0a 2020 2020  object(py);.    
+00016db0: 2020 2020 6c65 7420 6f75 7470 7574 3a20      let output: 
+00016dc0: 6636 3420 3d20 7261 772e 6578 7472 6163  f64 = raw.extrac
+00016dd0: 7428 7079 293f 3b0a 2020 2020 2020 2020  t(py)?;.        
+00016de0: 4f6b 286f 7574 7075 7429 0a20 2020 207d  Ok(output).    }
+00016df0: 3b0a 0a20 2020 206c 6574 2065 7374 696d  ;..    let estim
+00016e00: 6174 655f 636f 7374 5f63 616c 6c61 626c  ate_cost_callabl
+00016e10: 6520 3d20 7c61 3a20 2650 794f 626a 6563  e = |a: &PyObjec
+00016e20: 747c 202d 3e20 5079 5265 7375 6c74 3c66  t| -> PyResult<f
+00016e30: 3634 3e20 7b0a 2020 2020 2020 2020 6c65  64> {.        le
+00016e40: 7420 7265 7320 3d20 6573 7469 6d61 7465  t res = estimate
+00016e50: 5f63 6f73 745f 666e 2e63 616c 6c31 2870  _cost_fn.call1(p
+00016e60: 792c 2028 612c 2929 3f3b 0a20 2020 2020  y, (a,))?;.     
+00016e70: 2020 206c 6574 2072 6177 203d 2072 6573     let raw = res
+00016e80: 2e74 6f5f 6f62 6a65 6374 2870 7929 3b0a  .to_object(py);.
+00016e90: 2020 2020 2020 2020 6c65 7420 6f75 7470          let outp
+00016ea0: 7574 3a20 6636 3420 3d20 7261 772e 6578  ut: f64 = raw.ex
+00016eb0: 7472 6163 7428 7079 293f 3b0a 2020 2020  tract(py)?;.    
+00016ec0: 2020 2020 4f6b 286f 7574 7075 7429 0a20      Ok(output). 
+00016ed0: 2020 207d 3b0a 2020 2020 6c65 7420 7374     };.    let st
+00016ee0: 6172 7420 3d20 4e6f 6465 496e 6465 783a  art = NodeIndex:
+00016ef0: 3a6e 6577 286e 6f64 6529 3b0a 0a20 2020  :new(node);..   
+00016f00: 206c 6574 2061 7374 6172 5f72 6573 203d   let astar_res =
+00016f10: 2061 7374 6172 3a3a 6173 7461 7228 0a20   astar::astar(. 
+00016f20: 2020 2020 2020 2067 7261 7068 2c0a 2020         graph,.  
+00016f30: 2020 2020 2020 7374 6172 742c 0a20 2020        start,.   
+00016f40: 2020 2020 207c 667c 2067 6f61 6c5f 666e       |f| goal_fn
+00016f50: 5f63 616c 6c61 626c 6528 6772 6170 682e  _callable(graph.
+00016f60: 6772 6170 682e 6e6f 6465 5f77 6569 6768  graph.node_weigh
+00016f70: 7428 6629 2e75 6e77 7261 7028 2929 2c0a  t(f).unwrap()),.
+00016f80: 2020 2020 2020 2020 7c65 7c20 6564 6765          |e| edge
+00016f90: 5f63 6f73 745f 6361 6c6c 6162 6c65 2865  _cost_callable(e
+00016fa0: 2e77 6569 6768 7428 2929 2c0a 2020 2020  .weight()),.    
+00016fb0: 2020 2020 7c65 7374 696d 6174 657c 207b      |estimate| {
+00016fc0: 0a20 2020 2020 2020 2020 2020 2065 7374  .            est
+00016fd0: 696d 6174 655f 636f 7374 5f63 616c 6c61  imate_cost_calla
+00016fe0: 626c 6528 6772 6170 682e 6772 6170 682e  ble(graph.graph.
+00016ff0: 6e6f 6465 5f77 6569 6768 7428 6573 7469  node_weight(esti
+00017000: 6d61 7465 292e 756e 7772 6170 2829 290a  mate).unwrap()).
+00017010: 2020 2020 2020 2020 7d2c 0a20 2020 2029          },.    )
+00017020: 3f3b 0a20 2020 206c 6574 2070 6174 6820  ?;.    let path 
+00017030: 3d20 6d61 7463 6820 6173 7461 725f 7265  = match astar_re
+00017040: 7320 7b0a 2020 2020 2020 2020 536f 6d65  s {.        Some
+00017050: 2870 6174 6829 203d 3e20 7061 7468 2c0a  (path) => path,.
+00017060: 2020 2020 2020 2020 4e6f 6e65 203d 3e20          None => 
+00017070: 7b0a 2020 2020 2020 2020 2020 2020 7265  {.            re
+00017080: 7475 726e 2045 7272 284e 6f50 6174 6846  turn Err(NoPathF
+00017090: 6f75 6e64 3a3a 6e65 775f 6572 7228 0a20  ound::new_err(. 
+000170a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000170b0: 4e6f 2070 6174 6820 666f 756e 6420 7468  No path found th
+000170c0: 6174 2073 6174 6973 6669 6573 2067 6f61  at satisfies goa
+000170d0: 6c5f 666e 222c 0a20 2020 2020 2020 2020  l_fn",.         
+000170e0: 2020 2029 290a 2020 2020 2020 2020 7d0a     )).        }.
+000170f0: 2020 2020 7d3b 0a20 2020 204f 6b28 4e6f      };.    Ok(No
+00017100: 6465 496e 6469 6365 7320 7b0a 2020 2020  deIndices {.    
+00017110: 2020 2020 6e6f 6465 733a 2070 6174 682e      nodes: path.
+00017120: 312e 696e 746f 5f69 7465 7228 292e 6d61  1.into_iter().ma
+00017130: 7028 7c78 7c20 782e 696e 6465 7828 2929  p(|x| x.index())
+00017140: 2e63 6f6c 6c65 6374 2829 2c0a 2020 2020  .collect(),.    
+00017150: 7d29 0a7d 0a0a 2f2f 2f20 5265 7475 726e  }).}../// Return
+00017160: 2061 203a 6d61 7468 3a60 475f 7b6e 707d   a :math:`G_{np}
+00017170: 6020 6469 7265 6374 6564 2072 616e 646f  ` directed rando
+00017180: 6d20 6772 6170 682c 2061 6c73 6f20 6b6e  m graph, also kn
+00017190: 6f77 6e20 6173 2061 6e0a 2f2f 2f20 4572  own as an./// Er
+000171a0: 64c5 9173 2d52 c3a9 6e79 6920 6772 6170  d..s-R..nyi grap
+000171b0: 6820 6f72 2061 2062 696e 6f6d 6961 6c20  h or a binomial 
+000171c0: 6772 6170 682e 0a2f 2f2f 0a2f 2f2f 2046  graph..///./// F
+000171d0: 6f72 206e 756d 6265 7220 6f66 206e 6f64  or number of nod
+000171e0: 6573 203a 6d61 7468 3a60 6e60 2061 6e64  es :math:`n` and
+000171f0: 2070 726f 6261 6269 6c69 7479 203a 6d61   probability :ma
+00017200: 7468 3a60 7060 2c20 7468 6520 3a6d 6174  th:`p`, the :mat
+00017210: 683a 6047 5f7b 6e2c 707d 600a 2f2f 2f20  h:`G_{n,p}`./// 
+00017220: 6772 6170 6820 616c 676f 7269 7468 6d20  graph algorithm 
+00017230: 6372 6561 7465 7320 3a6d 6174 683a 606e  creates :math:`n
+00017240: 6020 6e6f 6465 732c 2061 6e64 2066 6f72  ` nodes, and for
+00017250: 2061 6c6c 2074 6865 203a 6d61 7468 3a60   all the :math:`
+00017260: 6e20 286e 202d 2031 2960 2070 6f73 7369  n (n - 1)` possi
+00017270: 626c 6520 6564 6765 732c 0a2f 2f2f 2065  ble edges,./// e
+00017280: 6163 6820 6564 6765 2069 7320 6372 6561  ach edge is crea
+00017290: 7465 6420 696e 6465 7065 6e64 656e 746c  ted independentl
+000172a0: 7920 7769 7468 2070 726f 6261 6269 6c69  y with probabili
+000172b0: 7479 203a 6d61 7468 3a60 7060 2e0a 2f2f  ty :math:`p`..//
+000172c0: 2f20 496e 2067 656e 6572 616c 2c20 666f  / In general, fo
+000172d0: 7220 616e 7920 7072 6f62 6162 696c 6974  r any probabilit
+000172e0: 7920 3a6d 6174 683a 6070 602c 2074 6865  y :math:`p`, the
+000172f0: 2065 7870 6563 7465 6420 6e75 6d62 6572   expected number
+00017300: 206f 6620 6564 6765 7320 7265 7475 726e   of edges return
+00017310: 6564 0a2f 2f2f 2069 7320 3a6d 6174 683a  ed./// is :math:
+00017320: 606d 203d 2070 206e 2028 6e20 2d20 3129  `m = p n (n - 1)
+00017330: 602e 2049 6620 3a6d 6174 683a 6070 203d  `. If :math:`p =
+00017340: 2030 6020 6f72 203a 6d61 7468 3a60 7020   0` or :math:`p 
+00017350: 3d20 3160 2c20 7468 6520 7265 7475 726e  = 1`, the return
+00017360: 6564 0a2f 2f2f 2067 7261 7068 2069 7320  ed./// graph is 
+00017370: 6e6f 7420 7261 6e64 6f6d 2061 6e64 2077  not random and w
+00017380: 696c 6c20 616c 7761 7973 2062 6520 616e  ill always be an
+00017390: 2065 6d70 7479 206f 7220 6120 636f 6d70   empty or a comp
+000173a0: 6c65 7465 2067 7261 7068 2072 6573 7065  lete graph respe
+000173b0: 6374 6976 656c 792e 0a2f 2f2f 2041 6e20  ctively../// An 
+000173c0: 656d 7074 7920 6772 6170 6820 6861 7320  empty graph has 
+000173d0: 7a65 726f 2065 6467 6573 2061 6e64 2061  zero edges and a
+000173e0: 2063 6f6d 706c 6574 6520 6469 7265 6374   complete direct
+000173f0: 6564 2067 7261 7068 2068 6173 203a 6d61  ed graph has :ma
+00017400: 7468 3a60 6e20 286e 202d 2031 2960 2065  th:`n (n - 1)` e
+00017410: 6467 6573 2e0a 2f2f 2f20 5468 6520 7275  dges../// The ru
+00017420: 6e20 7469 6d65 2069 7320 3a6d 6174 683a  n time is :math:
+00017430: 604f 286e 202b 206d 2960 2077 6865 7265  `O(n + m)` where
+00017440: 203a 6d61 7468 3a60 6d60 2069 7320 7468   :math:`m` is th
+00017450: 6520 6578 7065 6374 6564 206e 756d 6265  e expected numbe
+00017460: 7220 6f66 2065 6467 6573 206d 656e 7469  r of edges menti
+00017470: 6f6e 6564 2061 626f 7665 2e0a 2f2f 2f20  oned above../// 
+00017480: 5768 656e 203a 6d61 7468 3a60 7020 3d20  When :math:`p = 
+00017490: 3060 2c20 7275 6e20 7469 6d65 2061 6c77  0`, run time alw
+000174a0: 6179 7320 7265 6475 6365 7320 746f 203a  ays reduces to :
+000174b0: 6d61 7468 3a60 4f28 6e29 602c 2061 7320  math:`O(n)`, as 
+000174c0: 7468 6520 6c6f 7765 7220 626f 756e 642e  the lower bound.
+000174d0: 0a2f 2f2f 2057 6865 6e20 3a6d 6174 683a  ./// When :math:
+000174e0: 6070 203d 2031 602c 2072 756e 2074 696d  `p = 1`, run tim
+000174f0: 6520 616c 7761 7973 2067 6f65 7320 746f  e always goes to
+00017500: 203a 6d61 7468 3a60 4f28 6e20 2b20 6e20   :math:`O(n + n 
+00017510: 286e 202d 2031 2929 602c 2061 7320 7468  (n - 1))`, as th
+00017520: 6520 7570 7065 7220 626f 756e 642e 0a2f  e upper bound../
+00017530: 2f2f 2046 6f72 206f 7468 6572 2070 726f  // For other pro
+00017540: 6261 6269 6c69 7469 6573 2c20 7468 6973  babilities, this
+00017550: 2061 6c67 6f72 6974 686d 205b 315d 5f20   algorithm [1]_ 
+00017560: 7275 6e73 2069 6e20 3a6d 6174 683a 604f  runs in :math:`O
+00017570: 286e 202b 206d 2960 2074 696d 652e 0a2f  (n + m)` time../
+00017580: 2f2f 0a2f 2f2f 2046 6f72 203a 6d61 7468  //./// For :math
+00017590: 3a60 3020 3c20 7020 3c20 3160 2c20 7468  :`0 < p < 1`, th
+000175a0: 6520 616c 676f 7269 7468 6d20 6973 2062  e algorithm is b
+000175b0: 6173 6564 206f 6e20 7468 6520 696d 706c  ased on the impl
+000175c0: 656d 656e 7461 7469 6f6e 206f 6620 7468  ementation of th
+000175d0: 6520 6e65 7477 6f72 6b78 2066 756e 6374  e networkx funct
+000175e0: 696f 6e0a 2f2f 2f20 6060 6661 7374 5f67  ion./// ``fast_g
+000175f0: 6e70 5f72 616e 646f 6d5f 6772 6170 6860  np_random_graph`
+00017600: 6020 5b32 5d5f 0a2f 2f2f 0a2f 2f2f 203a  ` [2]_.///./// :
+00017610: 7061 7261 6d20 696e 7420 6e75 6d5f 6e6f  param int num_no
+00017620: 6465 733a 2054 6865 206e 756d 6265 7220  des: The number 
+00017630: 6f66 206e 6f64 6573 2074 6f20 6372 6561  of nodes to crea
+00017640: 7465 2069 6e20 7468 6520 6772 6170 680a  te in the graph.
+00017650: 2f2f 2f20 3a70 6172 616d 2066 6c6f 6174  /// :param float
+00017660: 2070 726f 6261 6269 6c69 7479 3a20 5468   probability: Th
+00017670: 6520 7072 6f62 6162 696c 6974 7920 6f66  e probability of
+00017680: 2063 7265 6174 696e 6720 616e 2065 6467   creating an edg
+00017690: 6520 6265 7477 6565 6e20 7477 6f20 6e6f  e between two no
+000176a0: 6465 730a 2f2f 2f20 3a70 6172 616d 2069  des./// :param i
+000176b0: 6e74 2073 6565 643a 2041 6e20 6f70 7469  nt seed: An opti
+000176c0: 6f6e 616c 2073 6565 6420 746f 2075 7365  onal seed to use
+000176d0: 2066 6f72 2074 6865 2072 616e 646f 6d20   for the random 
+000176e0: 6e75 6d62 6572 2067 656e 6572 6174 6f72  number generator
+000176f0: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
+00017700: 3a20 4120 5079 4469 4772 6170 6820 6f62  : A PyDiGraph ob
+00017710: 6a65 6374 0a2f 2f2f 203a 7274 7970 653a  ject./// :rtype:
+00017720: 2050 7944 6947 7261 7068 0a2f 2f2f 0a2f   PyDiGraph.///./
+00017730: 2f2f 202e 2e20 5b31 5d20 566c 6164 696d  // .. [1] Vladim
+00017740: 6972 2042 6174 6167 656c 6a20 616e 6420  ir Batagelj and 
+00017750: 556c 7269 6b20 4272 616e 6465 732c 0a2f  Ulrik Brandes,./
+00017760: 2f2f 2020 2020 2245 6666 6963 6965 6e74  //    "Efficient
+00017770: 2067 656e 6572 6174 696f 6e20 6f66 206c   generation of l
+00017780: 6172 6765 2072 616e 646f 6d20 6e65 7477  arge random netw
+00017790: 6f72 6b73 222c 0a2f 2f2f 2020 2020 5068  orks",.///    Ph
+000177a0: 7973 2e20 5265 762e 2045 2c20 3731 2c20  ys. Rev. E, 71, 
+000177b0: 3033 3631 3133 2c20 3230 3035 2e0a 2f2f  036113, 2005..//
+000177c0: 2f20 2e2e 205b 325d 2068 7474 7073 3a2f  / .. [2] https:/
+000177d0: 2f67 6974 6875 622e 636f 6d2f 6e65 7477  /github.com/netw
+000177e0: 6f72 6b78 2f6e 6574 776f 726b 782f 626c  orkx/networkx/bl
+000177f0: 6f62 2f6e 6574 776f 726b 782d 322e 342f  ob/networkx-2.4/
+00017800: 6e65 7477 6f72 6b78 2f67 656e 6572 6174  networkx/generat
+00017810: 6f72 732f 7261 6e64 6f6d 5f67 7261 7068  ors/random_graph
+00017820: 732e 7079 234c 3439 2d4c 3132 300a 235b  s.py#L49-L120.#[
+00017830: 7079 6675 6e63 7469 6f6e 5d0a 235b 7465  pyfunction].#[te
+00017840: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
+00017850: 286e 756d 5f6e 6f64 6573 2c20 7072 6f62  (num_nodes, prob
+00017860: 6162 696c 6974 792c 2073 6565 643d 4e6f  ability, seed=No
+00017870: 6e65 2c20 2f29 225d 0a70 7562 2066 6e20  ne, /)"].pub fn 
+00017880: 6469 7265 6374 6564 5f67 6e70 5f72 616e  directed_gnp_ran
+00017890: 646f 6d5f 6772 6170 6828 0a20 2020 2070  dom_graph(.    p
+000178a0: 793a 2050 7974 686f 6e2c 0a20 2020 206e  y: Python,.    n
+000178b0: 756d 5f6e 6f64 6573 3a20 6973 697a 652c  um_nodes: isize,
+000178c0: 0a20 2020 2070 726f 6261 6269 6c69 7479  .    probability
+000178d0: 3a20 6636 342c 0a20 2020 2073 6565 643a  : f64,.    seed:
+000178e0: 204f 7074 696f 6e3c 7536 343e 2c0a 2920   Option<u64>,.) 
+000178f0: 2d3e 2050 7952 6573 756c 743c 6469 6772  -> PyResult<digr
+00017900: 6170 683a 3a50 7944 6947 7261 7068 3e20  aph::PyDiGraph> 
+00017910: 7b0a 2020 2020 6966 206e 756d 5f6e 6f64  {.    if num_nod
+00017920: 6573 203c 3d20 3020 7b0a 2020 2020 2020  es <= 0 {.      
+00017930: 2020 7265 7475 726e 2045 7272 2850 7956    return Err(PyV
+00017940: 616c 7565 4572 726f 723a 3a6e 6577 5f65  alueError::new_e
+00017950: 7272 2822 6e75 6d5f 6e6f 6465 7320 6d75  rr("num_nodes mu
+00017960: 7374 2062 6520 3e20 3022 2929 3b0a 2020  st be > 0"));.  
+00017970: 2020 7d0a 2020 2020 6c65 7420 6d75 7420    }.    let mut 
+00017980: 726e 673a 2050 6367 3634 203d 206d 6174  rng: Pcg64 = mat
+00017990: 6368 2073 6565 6420 7b0a 2020 2020 2020  ch seed {.      
+000179a0: 2020 536f 6d65 2873 6565 6429 203d 3e20    Some(seed) => 
+000179b0: 5063 6736 343a 3a73 6565 645f 6672 6f6d  Pcg64::seed_from
+000179c0: 5f75 3634 2873 6565 6429 2c0a 2020 2020  _u64(seed),.    
+000179d0: 2020 2020 4e6f 6e65 203d 3e20 5063 6736      None => Pcg6
+000179e0: 343a 3a66 726f 6d5f 656e 7472 6f70 7928  4::from_entropy(
+000179f0: 292c 0a20 2020 207d 3b0a 2020 2020 6c65  ),.    };.    le
+00017a00: 7420 6d75 7420 696e 6e65 725f 6772 6170  t mut inner_grap
+00017a10: 6820 3d20 5374 6162 6c65 4469 4772 6170  h = StableDiGrap
+00017a20: 683a 3a3c 5079 4f62 6a65 6374 2c20 5079  h::<PyObject, Py
+00017a30: 4f62 6a65 6374 3e3a 3a6e 6577 2829 3b0a  Object>::new();.
+00017a40: 2020 2020 666f 7220 7820 696e 2030 2e2e      for x in 0..
+00017a50: 6e75 6d5f 6e6f 6465 7320 7b0a 2020 2020  num_nodes {.    
+00017a60: 2020 2020 696e 6e65 725f 6772 6170 682e      inner_graph.
+00017a70: 6164 645f 6e6f 6465 2878 2e74 6f5f 6f62  add_node(x.to_ob
+00017a80: 6a65 6374 2870 7929 293b 0a20 2020 207d  ject(py));.    }
+00017a90: 0a20 2020 2069 6620 2128 302e 302e 2e3d  .    if !(0.0..=
+00017aa0: 312e 3029 2e63 6f6e 7461 696e 7328 2670  1.0).contains(&p
+00017ab0: 726f 6261 6269 6c69 7479 2920 7b0a 2020  robability) {.  
+00017ac0: 2020 2020 2020 7265 7475 726e 2045 7272        return Err
+00017ad0: 2850 7956 616c 7565 4572 726f 723a 3a6e  (PyValueError::n
+00017ae0: 6577 5f65 7272 280a 2020 2020 2020 2020  ew_err(.        
+00017af0: 2020 2020 2250 726f 6261 6269 6c69 7479      "Probability
+00017b00: 206f 7574 206f 6620 7261 6e67 652c 206d   out of range, m
+00017b10: 7573 7420 6265 2030 203c 3d20 7020 3c3d  ust be 0 <= p <=
+00017b20: 2031 222c 0a20 2020 2020 2020 2029 293b   1",.        ));
+00017b30: 0a20 2020 207d 0a20 2020 2069 6620 7072  .    }.    if pr
+00017b40: 6f62 6162 696c 6974 7920 3e20 302e 3020  obability > 0.0 
+00017b50: 7b0a 2020 2020 2020 2020 6966 2028 7072  {.        if (pr
+00017b60: 6f62 6162 696c 6974 7920 2d20 312e 3029  obability - 1.0)
+00017b70: 2e61 6273 2829 203c 2073 7464 3a3a 6636  .abs() < std::f6
+00017b80: 343a 3a45 5053 494c 4f4e 207b 0a20 2020  4::EPSILON {.   
+00017b90: 2020 2020 2020 2020 2066 6f72 2075 2069           for u i
+00017ba0: 6e20 302e 2e6e 756d 5f6e 6f64 6573 207b  n 0..num_nodes {
+00017bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bc0: 2066 6f72 2076 2069 6e20 302e 2e6e 756d   for v in 0..num
+00017bd0: 5f6e 6f64 6573 207b 0a20 2020 2020 2020  _nodes {.       
+00017be0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00017bf0: 7520 213d 2076 207b 0a20 2020 2020 2020  u != v {.       
+00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c10: 202f 2f20 6578 636c 7564 6520 7365 6c66   // exclude self
+00017c20: 2d6c 6f6f 7073 0a20 2020 2020 2020 2020  -loops.         
+00017c30: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00017c40: 6574 2075 5f69 6e64 6578 203d 204e 6f64  et u_index = Nod
+00017c50: 6549 6e64 6578 3a3a 6e65 7728 7520 6173  eIndex::new(u as
+00017c60: 2075 7369 7a65 293b 0a20 2020 2020 2020   usize);.       
+00017c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c80: 206c 6574 2076 5f69 6e64 6578 203d 204e   let v_index = N
+00017c90: 6f64 6549 6e64 6578 3a3a 6e65 7728 7620  odeIndex::new(v 
+00017ca0: 6173 2075 7369 7a65 293b 0a20 2020 2020  as usize);.     
+00017cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017cc0: 2020 2069 6e6e 6572 5f67 7261 7068 2e61     inner_graph.a
+00017cd0: 6464 5f65 6467 6528 755f 696e 6465 782c  dd_edge(u_index,
+00017ce0: 2076 5f69 6e64 6578 2c20 7079 2e4e 6f6e   v_index, py.Non
+00017cf0: 6528 2929 3b0a 2020 2020 2020 2020 2020  e());.          
+00017d00: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00017d10: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00017d20: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00017d30: 2020 2020 7d20 656c 7365 207b 0a20 2020      } else {.   
+00017d40: 2020 2020 2020 2020 206c 6574 206d 7574           let mut
+00017d50: 2076 3a20 6973 697a 6520 3d20 303b 0a20   v: isize = 0;. 
+00017d60: 2020 2020 2020 2020 2020 206c 6574 206d             let m
+00017d70: 7574 2077 3a20 6973 697a 6520 3d20 2d31  ut w: isize = -1
+00017d80: 3b0a 2020 2020 2020 2020 2020 2020 6c65  ;.            le
+00017d90: 7420 6c70 3a20 6636 3420 3d20 2831 2e30  t lp: f64 = (1.0
+00017da0: 202d 2070 726f 6261 6269 6c69 7479 292e   - probability).
+00017db0: 6c6e 2829 3b0a 0a20 2020 2020 2020 2020  ln();..         
+00017dc0: 2020 206c 6574 2062 6574 7765 656e 203d     let between =
+00017dd0: 2055 6e69 666f 726d 3a3a 6e65 7728 302e   Uniform::new(0.
+00017de0: 302c 2031 2e30 293b 0a20 2020 2020 2020  0, 1.0);.       
+00017df0: 2020 2020 2077 6869 6c65 2076 203c 206e       while v < n
+00017e00: 756d 5f6e 6f64 6573 207b 0a20 2020 2020  um_nodes {.     
+00017e10: 2020 2020 2020 2020 2020 206c 6574 2072             let r
+00017e20: 616e 646f 6d3a 2066 3634 203d 2062 6574  andom: f64 = bet
+00017e30: 7765 656e 2e73 616d 706c 6528 266d 7574  ween.sample(&mut
+00017e40: 2072 6e67 293b 0a20 2020 2020 2020 2020   rng);.         
+00017e50: 2020 2020 2020 206c 6574 206c 723a 2066         let lr: f
+00017e60: 3634 203d 2028 312e 3020 2d20 7261 6e64  64 = (1.0 - rand
+00017e70: 6f6d 292e 6c6e 2829 3b0a 2020 2020 2020  om).ln();.      
+00017e80: 2020 2020 2020 2020 2020 6c65 7420 7261            let ra
+00017e90: 7469 6f3a 2069 7369 7a65 203d 2028 6c72  tio: isize = (lr
+00017ea0: 202f 206c 7029 2061 7320 6973 697a 653b   / lp) as isize;
+00017eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017ec0: 2077 203d 2077 202b 2031 202b 2072 6174   w = w + 1 + rat
+00017ed0: 696f 3b0a 2020 2020 2020 2020 2020 2020  io;.            
+00017ee0: 2020 2020 2f2f 2061 766f 6964 2073 656c      // avoid sel
+00017ef0: 6620 6c6f 6f70 730a 2020 2020 2020 2020  f loops.        
+00017f00: 2020 2020 2020 2020 6966 2076 203d 3d20          if v == 
+00017f10: 7720 7b0a 2020 2020 2020 2020 2020 2020  w {.            
+00017f20: 2020 2020 2020 2020 7720 2b3d 2031 3b0a          w += 1;.
+00017f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f40: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00017f50: 2020 7768 696c 6520 7620 3c20 6e75 6d5f    while v < num_
+00017f60: 6e6f 6465 7320 2626 206e 756d 5f6e 6f64  nodes && num_nod
+00017f70: 6573 203c 3d20 7720 7b0a 2020 2020 2020  es <= w {.      
+00017f80: 2020 2020 2020 2020 2020 2020 2020 7720                w 
+00017f90: 2d3d 2076 3b0a 2020 2020 2020 2020 2020  -= v;.          
+00017fa0: 2020 2020 2020 2020 2020 7620 2b3d 2031            v += 1
+00017fb0: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00017fc0: 2020 2020 2020 2f2f 2061 766f 6964 2073        // avoid s
+00017fd0: 656c 6620 6c6f 6f70 730a 2020 2020 2020  elf loops.      
+00017fe0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00017ff0: 2076 203d 3d20 7720 7b0a 2020 2020 2020   v == w {.      
+00018000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018010: 2020 7720 2d3d 2076 3b0a 2020 2020 2020    w -= v;.      
+00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018030: 2020 7620 2b3d 2031 3b0a 2020 2020 2020    v += 1;.      
+00018040: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018060: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00018070: 2020 6966 2076 203c 206e 756d 5f6e 6f64    if v < num_nod
+00018080: 6573 207b 0a20 2020 2020 2020 2020 2020  es {.           
+00018090: 2020 2020 2020 2020 206c 6574 2076 5f69           let v_i
+000180a0: 6e64 6578 203d 204e 6f64 6549 6e64 6578  ndex = NodeIndex
+000180b0: 3a3a 6e65 7728 7620 6173 2075 7369 7a65  ::new(v as usize
+000180c0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
+000180d0: 2020 2020 2020 206c 6574 2077 5f69 6e64         let w_ind
+000180e0: 6578 203d 204e 6f64 6549 6e64 6578 3a3a  ex = NodeIndex::
+000180f0: 6e65 7728 7720 6173 2075 7369 7a65 293b  new(w as usize);
+00018100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018110: 2020 2020 2069 6e6e 6572 5f67 7261 7068       inner_graph
+00018120: 2e61 6464 5f65 6467 6528 765f 696e 6465  .add_edge(v_inde
+00018130: 782c 2077 5f69 6e64 6578 2c20 7079 2e4e  x, w_index, py.N
+00018140: 6f6e 6528 2929 3b0a 2020 2020 2020 2020  one());.        
+00018150: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00018160: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00018170: 7d0a 2020 2020 7d0a 0a20 2020 206c 6574  }.    }..    let
+00018180: 2067 7261 7068 203d 2064 6967 7261 7068   graph = digraph
+00018190: 3a3a 5079 4469 4772 6170 6820 7b0a 2020  ::PyDiGraph {.  
+000181a0: 2020 2020 2020 6772 6170 683a 2069 6e6e        graph: inn
+000181b0: 6572 5f67 7261 7068 2c0a 2020 2020 2020  er_graph,.      
+000181c0: 2020 6379 636c 655f 7374 6174 653a 2061    cycle_state: a
+000181d0: 6c67 6f3a 3a44 6673 5370 6163 653a 3a64  lgo::DfsSpace::d
+000181e0: 6566 6175 6c74 2829 2c0a 2020 2020 2020  efault(),.      
+000181f0: 2020 6368 6563 6b5f 6379 636c 653a 2066    check_cycle: f
+00018200: 616c 7365 2c0a 2020 2020 2020 2020 6e6f  alse,.        no
+00018210: 6465 5f72 656d 6f76 6564 3a20 6661 6c73  de_removed: fals
+00018220: 652c 0a20 2020 2020 2020 206d 756c 7469  e,.        multi
+00018230: 6772 6170 683a 2074 7275 652c 0a20 2020  graph: true,.   
+00018240: 207d 3b0a 2020 2020 4f6b 2867 7261 7068   };.    Ok(graph
+00018250: 290a 7d0a 0a2f 2f2f 2052 6574 7572 6e20  ).}../// Return 
+00018260: 6120 3a6d 6174 683a 6047 5f7b 6e70 7d60  a :math:`G_{np}`
+00018270: 2072 616e 646f 6d20 756e 6469 7265 6374   random undirect
+00018280: 6564 2067 7261 7068 2c20 616c 736f 206b  ed graph, also k
+00018290: 6e6f 776e 2061 7320 616e 0a2f 2f2f 2045  nown as an./// E
+000182a0: 7264 c591 732d 52c3 a96e 7969 2067 7261  rd..s-R..nyi gra
+000182b0: 7068 206f 7220 6120 6269 6e6f 6d69 616c  ph or a binomial
+000182c0: 2067 7261 7068 2e0a 2f2f 2f0a 2f2f 2f20   graph..///./// 
+000182d0: 466f 7220 6e75 6d62 6572 206f 6620 6e6f  For number of no
+000182e0: 6465 7320 3a6d 6174 683a 606e 6020 616e  des :math:`n` an
+000182f0: 6420 7072 6f62 6162 696c 6974 7920 3a6d  d probability :m
+00018300: 6174 683a 6070 602c 2074 6865 203a 6d61  ath:`p`, the :ma
+00018310: 7468 3a60 475f 7b6e 2c70 7d60 0a2f 2f2f  th:`G_{n,p}`.///
+00018320: 2067 7261 7068 2061 6c67 6f72 6974 686d   graph algorithm
+00018330: 2063 7265 6174 6573 203a 6d61 7468 3a60   creates :math:`
+00018340: 6e60 206e 6f64 6573 2c20 616e 6420 666f  n` nodes, and fo
+00018350: 7220 616c 6c20 7468 6520 3a6d 6174 683a  r all the :math:
+00018360: 606e 2028 6e20 2d20 3129 2f32 6020 706f  `n (n - 1)/2` po
+00018370: 7373 6962 6c65 2065 6467 6573 2c0a 2f2f  ssible edges,.//
+00018380: 2f20 6561 6368 2065 6467 6520 6973 2063  / each edge is c
+00018390: 7265 6174 6564 2069 6e64 6570 656e 6465  reated independe
+000183a0: 6e74 6c79 2077 6974 6820 7072 6f62 6162  ntly with probab
+000183b0: 696c 6974 7920 3a6d 6174 683a 6070 602e  ility :math:`p`.
+000183c0: 0a2f 2f2f 2049 6e20 6765 6e65 7261 6c2c  ./// In general,
+000183d0: 2066 6f72 2061 6e79 2070 726f 6261 6269   for any probabi
+000183e0: 6c69 7479 203a 6d61 7468 3a60 7060 2c20  lity :math:`p`, 
+000183f0: 7468 6520 6578 7065 6374 6564 206e 756d  the expected num
+00018400: 6265 7220 6f66 2065 6467 6573 2072 6574  ber of edges ret
+00018410: 7572 6e65 640a 2f2f 2f20 6973 203a 6d61  urned./// is :ma
+00018420: 7468 3a60 6d20 3d20 7020 6e20 286e 202d  th:`m = p n (n -
+00018430: 2031 292f 3260 2e20 4966 203a 6d61 7468   1)/2`. If :math
+00018440: 3a60 7020 3d20 3060 206f 7220 3a6d 6174  :`p = 0` or :mat
+00018450: 683a 6070 203d 2031 602c 2074 6865 2072  h:`p = 1`, the r
+00018460: 6574 7572 6e65 640a 2f2f 2f20 6772 6170  eturned./// grap
+00018470: 6820 6973 206e 6f74 2072 616e 646f 6d20  h is not random 
+00018480: 616e 6420 7769 6c6c 2061 6c77 6179 7320  and will always 
+00018490: 6265 2061 6e20 656d 7074 7920 6f72 2061  be an empty or a
+000184a0: 2063 6f6d 706c 6574 6520 6772 6170 6820   complete graph 
+000184b0: 7265 7370 6563 7469 7665 6c79 2e0a 2f2f  respectively..//
+000184c0: 2f20 416e 2065 6d70 7479 2067 7261 7068  / An empty graph
+000184d0: 2068 6173 207a 6572 6f20 6564 6765 7320   has zero edges 
+000184e0: 616e 6420 6120 636f 6d70 6c65 7465 2075  and a complete u
+000184f0: 6e64 6972 6563 7465 6420 6772 6170 6820  ndirected graph 
+00018500: 6861 7320 3a6d 6174 683a 606e 2028 6e20  has :math:`n (n 
+00018510: 2d20 3129 2f32 6020 6564 6765 732e 0a2f  - 1)/2` edges../
+00018520: 2f2f 2054 6865 2072 756e 2074 696d 6520  // The run time 
+00018530: 6973 203a 6d61 7468 3a60 4f28 6e20 2b20  is :math:`O(n + 
+00018540: 6d29 6020 7768 6572 6520 3a6d 6174 683a  m)` where :math:
+00018550: 606d 6020 6973 2074 6865 2065 7870 6563  `m` is the expec
+00018560: 7465 6420 6e75 6d62 6572 206f 6620 6564  ted number of ed
+00018570: 6765 7320 6d65 6e74 696f 6e65 6420 6162  ges mentioned ab
+00018580: 6f76 652e 0a2f 2f2f 2057 6865 6e20 3a6d  ove../// When :m
+00018590: 6174 683a 6070 203d 2030 602c 2072 756e  ath:`p = 0`, run
+000185a0: 2074 696d 6520 616c 7761 7973 2072 6564   time always red
+000185b0: 7563 6573 2074 6f20 3a6d 6174 683a 604f  uces to :math:`O
+000185c0: 286e 2960 2c20 6173 2074 6865 206c 6f77  (n)`, as the low
+000185d0: 6572 2062 6f75 6e64 2e0a 2f2f 2f20 5768  er bound../// Wh
+000185e0: 656e 203a 6d61 7468 3a60 7020 3d20 3160  en :math:`p = 1`
+000185f0: 2c20 7275 6e20 7469 6d65 2061 6c77 6179  , run time alway
+00018600: 7320 676f 6573 2074 6f20 3a6d 6174 683a  s goes to :math:
+00018610: 604f 286e 202b 206e 2028 6e20 2d20 3129  `O(n + n (n - 1)
+00018620: 2f32 2960 2c20 6173 2074 6865 2075 7070  /2)`, as the upp
+00018630: 6572 2062 6f75 6e64 2e0a 2f2f 2f20 466f  er bound../// Fo
+00018640: 7220 6f74 6865 7220 7072 6f62 6162 696c  r other probabil
+00018650: 6974 6965 732c 2074 6869 7320 616c 676f  ities, this algo
+00018660: 7269 7468 6d20 5b31 5d5f 2072 756e 7320  rithm [1]_ runs 
+00018670: 696e 203a 6d61 7468 3a60 4f28 6e20 2b20  in :math:`O(n + 
+00018680: 6d29 6020 7469 6d65 2e0a 2f2f 2f0a 2f2f  m)` time..///.//
+00018690: 2f20 466f 7220 3a6d 6174 683a 6030 203c  / For :math:`0 <
+000186a0: 2070 203c 2031 602c 2074 6865 2061 6c67   p < 1`, the alg
+000186b0: 6f72 6974 686d 2069 7320 6261 7365 6420  orithm is based 
+000186c0: 6f6e 2074 6865 2069 6d70 6c65 6d65 6e74  on the implement
+000186d0: 6174 696f 6e20 6f66 2074 6865 206e 6574  ation of the net
+000186e0: 776f 726b 7820 6675 6e63 7469 6f6e 0a2f  workx function./
+000186f0: 2f2f 2060 6066 6173 745f 676e 705f 7261  // ``fast_gnp_ra
+00018700: 6e64 6f6d 5f67 7261 7068 6060 205b 325d  ndom_graph`` [2]
+00018710: 5f0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  _.///./// :param
+00018720: 2069 6e74 206e 756d 5f6e 6f64 6573 3a20   int num_nodes: 
+00018730: 5468 6520 6e75 6d62 6572 206f 6620 6e6f  The number of no
+00018740: 6465 7320 746f 2063 7265 6174 6520 696e  des to create in
+00018750: 2074 6865 2067 7261 7068 0a2f 2f2f 203a   the graph./// :
+00018760: 7061 7261 6d20 666c 6f61 7420 7072 6f62  param float prob
+00018770: 6162 696c 6974 793a 2054 6865 2070 726f  ability: The pro
+00018780: 6261 6269 6c69 7479 206f 6620 6372 6561  bability of crea
+00018790: 7469 6e67 2061 6e20 6564 6765 2062 6574  ting an edge bet
+000187a0: 7765 656e 2074 776f 206e 6f64 6573 0a2f  ween two nodes./
+000187b0: 2f2f 203a 7061 7261 6d20 696e 7420 7365  // :param int se
+000187c0: 6564 3a20 416e 206f 7074 696f 6e61 6c20  ed: An optional 
+000187d0: 7365 6564 2074 6f20 7573 6520 666f 7220  seed to use for 
+000187e0: 7468 6520 7261 6e64 6f6d 206e 756d 6265  the random numbe
+000187f0: 7220 6765 6e65 7261 746f 720a 2f2f 2f0a  r generator.///.
+00018800: 2f2f 2f20 3a72 6574 7572 6e3a 2041 2050  /// :return: A P
+00018810: 7947 7261 7068 206f 626a 6563 740a 2f2f  yGraph object.//
+00018820: 2f20 3a72 7479 7065 3a20 5079 4772 6170  / :rtype: PyGrap
+00018830: 680a 2f2f 2f0a 2f2f 2f20 2e2e 205b 315d  h.///./// .. [1]
+00018840: 2056 6c61 6469 6d69 7220 4261 7461 6765   Vladimir Batage
+00018850: 6c6a 2061 6e64 2055 6c72 696b 2042 7261  lj and Ulrik Bra
+00018860: 6e64 6573 2c0a 2f2f 2f20 2020 2022 4566  ndes,.///    "Ef
+00018870: 6669 6369 656e 7420 6765 6e65 7261 7469  ficient generati
+00018880: 6f6e 206f 6620 6c61 7267 6520 7261 6e64  on of large rand
+00018890: 6f6d 206e 6574 776f 726b 7322 2c0a 2f2f  om networks",.//
+000188a0: 2f20 2020 2050 6879 732e 2052 6576 2e20  /    Phys. Rev. 
+000188b0: 452c 2037 312c 2030 3336 3131 332c 2032  E, 71, 036113, 2
+000188c0: 3030 352e 0a2f 2f2f 202e 2e20 5b32 5d20  005../// .. [2] 
+000188d0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000188e0: 6f6d 2f6e 6574 776f 726b 782f 6e65 7477  om/networkx/netw
+000188f0: 6f72 6b78 2f62 6c6f 622f 6e65 7477 6f72  orkx/blob/networ
+00018900: 6b78 2d32 2e34 2f6e 6574 776f 726b 782f  kx-2.4/networkx/
+00018910: 6765 6e65 7261 746f 7273 2f72 616e 646f  generators/rando
+00018920: 6d5f 6772 6170 6873 2e70 7923 4c34 392d  m_graphs.py#L49-
+00018930: 4c31 3230 0a23 5b70 7966 756e 6374 696f  L120.#[pyfunctio
+00018940: 6e5d 0a23 5b74 6578 745f 7369 676e 6174  n].#[text_signat
+00018950: 7572 6520 3d20 2228 6e75 6d5f 6e6f 6465  ure = "(num_node
+00018960: 732c 2070 726f 6261 6269 6c69 7479 2c20  s, probability, 
+00018970: 7365 6564 3d4e 6f6e 652c 202f 2922 5d0a  seed=None, /)"].
+00018980: 7075 6220 666e 2075 6e64 6972 6563 7465  pub fn undirecte
+00018990: 645f 676e 705f 7261 6e64 6f6d 5f67 7261  d_gnp_random_gra
+000189a0: 7068 280a 2020 2020 7079 3a20 5079 7468  ph(.    py: Pyth
+000189b0: 6f6e 2c0a 2020 2020 6e75 6d5f 6e6f 6465  on,.    num_node
+000189c0: 733a 2069 7369 7a65 2c0a 2020 2020 7072  s: isize,.    pr
+000189d0: 6f62 6162 696c 6974 793a 2066 3634 2c0a  obability: f64,.
+000189e0: 2020 2020 7365 6564 3a20 4f70 7469 6f6e      seed: Option
+000189f0: 3c75 3634 3e2c 0a29 202d 3e20 5079 5265  <u64>,.) -> PyRe
+00018a00: 7375 6c74 3c67 7261 7068 3a3a 5079 4772  sult<graph::PyGr
+00018a10: 6170 683e 207b 0a20 2020 2069 6620 6e75  aph> {.    if nu
+00018a20: 6d5f 6e6f 6465 7320 3c3d 2030 207b 0a20  m_nodes <= 0 {. 
+00018a30: 2020 2020 2020 2072 6574 7572 6e20 4572         return Er
+00018a40: 7228 5079 5661 6c75 6545 7272 6f72 3a3a  r(PyValueError::
+00018a50: 6e65 775f 6572 7228 226e 756d 5f6e 6f64  new_err("num_nod
+00018a60: 6573 206d 7573 7420 6265 203e 2030 2229  es must be > 0")
+00018a70: 293b 0a20 2020 207d 0a20 2020 206c 6574  );.    }.    let
+00018a80: 206d 7574 2072 6e67 3a20 5063 6736 3420   mut rng: Pcg64 
+00018a90: 3d20 6d61 7463 6820 7365 6564 207b 0a20  = match seed {. 
+00018aa0: 2020 2020 2020 2053 6f6d 6528 7365 6564         Some(seed
+00018ab0: 2920 3d3e 2050 6367 3634 3a3a 7365 6564  ) => Pcg64::seed
+00018ac0: 5f66 726f 6d5f 7536 3428 7365 6564 292c  _from_u64(seed),
+00018ad0: 0a20 2020 2020 2020 204e 6f6e 6520 3d3e  .        None =>
+00018ae0: 2050 6367 3634 3a3a 6672 6f6d 5f65 6e74   Pcg64::from_ent
+00018af0: 726f 7079 2829 2c0a 2020 2020 7d3b 0a20  ropy(),.    };. 
+00018b00: 2020 206c 6574 206d 7574 2069 6e6e 6572     let mut inner
+00018b10: 5f67 7261 7068 203d 2053 7461 626c 6555  _graph = StableU
+00018b20: 6e47 7261 7068 3a3a 3c50 794f 626a 6563  nGraph::<PyObjec
+00018b30: 742c 2050 794f 626a 6563 743e 3a3a 6465  t, PyObject>::de
+00018b40: 6661 756c 7428 293b 0a20 2020 2066 6f72  fault();.    for
+00018b50: 2078 2069 6e20 302e 2e6e 756d 5f6e 6f64   x in 0..num_nod
+00018b60: 6573 207b 0a20 2020 2020 2020 2069 6e6e  es {.        inn
+00018b70: 6572 5f67 7261 7068 2e61 6464 5f6e 6f64  er_graph.add_nod
+00018b80: 6528 782e 746f 5f6f 626a 6563 7428 7079  e(x.to_object(py
+00018b90: 2929 3b0a 2020 2020 7d0a 2020 2020 6966  ));.    }.    if
+00018ba0: 2021 2830 2e30 2e2e 3d31 2e30 292e 636f   !(0.0..=1.0).co
+00018bb0: 6e74 6169 6e73 2826 7072 6f62 6162 696c  ntains(&probabil
+00018bc0: 6974 7929 207b 0a20 2020 2020 2020 2072  ity) {.        r
+00018bd0: 6574 7572 6e20 4572 7228 5079 5661 6c75  eturn Err(PyValu
+00018be0: 6545 7272 6f72 3a3a 6e65 775f 6572 7228  eError::new_err(
+00018bf0: 0a20 2020 2020 2020 2020 2020 2022 5072  .            "Pr
+00018c00: 6f62 6162 696c 6974 7920 6f75 7420 6f66  obability out of
+00018c10: 2072 616e 6765 2c20 6d75 7374 2062 6520   range, must be 
+00018c20: 3020 3c3d 2070 203c 3d20 3122 2c0a 2020  0 <= p <= 1",.  
+00018c30: 2020 2020 2020 2929 3b0a 2020 2020 7d0a        ));.    }.
+00018c40: 2020 2020 6966 2070 726f 6261 6269 6c69      if probabili
+00018c50: 7479 203e 2030 2e30 207b 0a20 2020 2020  ty > 0.0 {.     
+00018c60: 2020 2069 6620 2870 726f 6261 6269 6c69     if (probabili
+00018c70: 7479 202d 2031 2e30 292e 6162 7328 2920  ty - 1.0).abs() 
+00018c80: 3c20 7374 643a 3a66 3634 3a3a 4550 5349  < std::f64::EPSI
+00018c90: 4c4f 4e20 7b0a 2020 2020 2020 2020 2020  LON {.          
+00018ca0: 2020 666f 7220 7520 696e 2030 2e2e 6e75    for u in 0..nu
+00018cb0: 6d5f 6e6f 6465 7320 7b0a 2020 2020 2020  m_nodes {.      
+00018cc0: 2020 2020 2020 2020 2020 666f 7220 7620            for v 
+00018cd0: 696e 2075 202b 2031 2e2e 6e75 6d5f 6e6f  in u + 1..num_no
+00018ce0: 6465 7320 7b0a 2020 2020 2020 2020 2020  des {.          
+00018cf0: 2020 2020 2020 2020 2020 6c65 7420 755f            let u_
+00018d00: 696e 6465 7820 3d20 4e6f 6465 496e 6465  index = NodeInde
+00018d10: 783a 3a6e 6577 2875 2061 7320 7573 697a  x::new(u as usiz
+00018d20: 6529 3b0a 2020 2020 2020 2020 2020 2020  e);.            
+00018d30: 2020 2020 2020 2020 6c65 7420 765f 696e          let v_in
+00018d40: 6465 7820 3d20 4e6f 6465 496e 6465 783a  dex = NodeIndex:
+00018d50: 3a6e 6577 2876 2061 7320 7573 697a 6529  :new(v as usize)
+00018d60: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00018d70: 2020 2020 2020 696e 6e65 725f 6772 6170        inner_grap
+00018d80: 682e 6164 645f 6564 6765 2875 5f69 6e64  h.add_edge(u_ind
+00018d90: 6578 2c20 765f 696e 6465 782c 2070 792e  ex, v_index, py.
+00018da0: 4e6f 6e65 2829 293b 0a20 2020 2020 2020  None());.       
+00018db0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00018dc0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00018dd0: 207d 2065 6c73 6520 7b0a 2020 2020 2020   } else {.      
+00018de0: 2020 2020 2020 6c65 7420 6d75 7420 763a        let mut v:
+00018df0: 2069 7369 7a65 203d 2031 3b0a 2020 2020   isize = 1;.    
+00018e00: 2020 2020 2020 2020 6c65 7420 6d75 7420          let mut 
+00018e10: 773a 2069 7369 7a65 203d 202d 313b 0a20  w: isize = -1;. 
+00018e20: 2020 2020 2020 2020 2020 206c 6574 206c             let l
+00018e30: 703a 2066 3634 203d 2028 312e 3020 2d20  p: f64 = (1.0 - 
+00018e40: 7072 6f62 6162 696c 6974 7929 2e6c 6e28  probability).ln(
+00018e50: 293b 0a0a 2020 2020 2020 2020 2020 2020  );..            
+00018e60: 6c65 7420 6265 7477 6565 6e20 3d20 556e  let between = Un
+00018e70: 6966 6f72 6d3a 3a6e 6577 2830 2e30 2c20  iform::new(0.0, 
+00018e80: 312e 3029 3b0a 2020 2020 2020 2020 2020  1.0);.          
+00018e90: 2020 7768 696c 6520 7620 3c20 6e75 6d5f    while v < num_
+00018ea0: 6e6f 6465 7320 7b0a 2020 2020 2020 2020  nodes {.        
+00018eb0: 2020 2020 2020 2020 6c65 7420 7261 6e64          let rand
+00018ec0: 6f6d 3a20 6636 3420 3d20 6265 7477 6565  om: f64 = betwee
+00018ed0: 6e2e 7361 6d70 6c65 2826 6d75 7420 726e  n.sample(&mut rn
+00018ee0: 6729 3b0a 2020 2020 2020 2020 2020 2020  g);.            
+00018ef0: 2020 2020 6c65 7420 6c72 203d 2028 312e      let lr = (1.
+00018f00: 3020 2d20 7261 6e64 6f6d 292e 6c6e 2829  0 - random).ln()
+00018f10: 3b0a 2020 2020 2020 2020 2020 2020 2020  ;.              
+00018f20: 2020 6c65 7420 7261 7469 6f3a 2069 7369    let ratio: isi
+00018f30: 7a65 203d 2028 6c72 202f 206c 7029 2061  ze = (lr / lp) a
+00018f40: 7320 6973 697a 653b 0a20 2020 2020 2020  s isize;.       
+00018f50: 2020 2020 2020 2020 2077 203d 2077 202b           w = w +
+00018f60: 2031 202b 2072 6174 696f 3b0a 2020 2020   1 + ratio;.    
+00018f70: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+00018f80: 6520 7720 3e3d 2076 2026 2620 7620 3c20  e w >= v && v < 
+00018f90: 6e75 6d5f 6e6f 6465 7320 7b0a 2020 2020  num_nodes {.    
+00018fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fb0: 7720 2d3d 2076 3b0a 2020 2020 2020 2020  w -= v;.        
+00018fc0: 2020 2020 2020 2020 2020 2020 7620 2b3d              v +=
+00018fd0: 2031 3b0a 2020 2020 2020 2020 2020 2020   1;.            
+00018fe0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00018ff0: 2020 2020 2020 6966 2076 203c 206e 756d        if v < num
+00019000: 5f6e 6f64 6573 207b 0a20 2020 2020 2020  _nodes {.       
+00019010: 2020 2020 2020 2020 2020 2020 206c 6574               let
+00019020: 2076 5f69 6e64 6578 203d 204e 6f64 6549   v_index = NodeI
+00019030: 6e64 6578 3a3a 6e65 7728 7620 6173 2075  ndex::new(v as u
+00019040: 7369 7a65 293b 0a20 2020 2020 2020 2020  size);.         
+00019050: 2020 2020 2020 2020 2020 206c 6574 2077             let w
+00019060: 5f69 6e64 6578 203d 204e 6f64 6549 6e64  _index = NodeInd
+00019070: 6578 3a3a 6e65 7728 7720 6173 2075 7369  ex::new(w as usi
+00019080: 7a65 293b 0a20 2020 2020 2020 2020 2020  ze);.           
+00019090: 2020 2020 2020 2020 2069 6e6e 6572 5f67           inner_g
+000190a0: 7261 7068 2e61 6464 5f65 6467 6528 765f  raph.add_edge(v_
+000190b0: 696e 6465 782c 2077 5f69 6e64 6578 2c20  index, w_index, 
+000190c0: 7079 2e4e 6f6e 6528 2929 3b0a 2020 2020  py.None());.    
+000190d0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+000190e0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+000190f0: 2020 2020 7d0a 2020 2020 7d0a 0a20 2020      }.    }..   
+00019100: 206c 6574 2067 7261 7068 203d 2067 7261   let graph = gra
+00019110: 7068 3a3a 5079 4772 6170 6820 7b0a 2020  ph::PyGraph {.  
+00019120: 2020 2020 2020 6772 6170 683a 2069 6e6e        graph: inn
+00019130: 6572 5f67 7261 7068 2c0a 2020 2020 2020  er_graph,.      
+00019140: 2020 6e6f 6465 5f72 656d 6f76 6564 3a20    node_removed: 
+00019150: 6661 6c73 652c 0a20 2020 2020 2020 206d  false,.        m
+00019160: 756c 7469 6772 6170 683a 2074 7275 652c  ultigraph: true,
+00019170: 0a20 2020 207d 3b0a 2020 2020 4f6b 2867  .    };.    Ok(g
+00019180: 7261 7068 290a 7d0a 0a2f 2f2f 2052 6574  raph).}../// Ret
+00019190: 7572 6e20 6120 3a6d 6174 683a 6047 5f7b  urn a :math:`G_{
+000191a0: 6e6d 7d60 206f 6620 6120 6469 7265 6374  nm}` of a direct
+000191b0: 6564 2067 7261 7068 0a2f 2f2f 0a2f 2f2f  ed graph.///.///
+000191c0: 2047 656e 6572 6174 6573 2061 2072 616e   Generates a ran
+000191d0: 646f 6d20 6469 7265 6374 6564 2067 7261  dom directed gra
+000191e0: 7068 206f 7574 206f 6620 616c 6c20 7468  ph out of all th
+000191f0: 6520 706f 7373 6962 6c65 2067 7261 7068  e possible graph
+00019200: 7320 7769 7468 203a 6d61 7468 3a60 6e60  s with :math:`n`
+00019210: 206e 6f64 6573 2061 6e64 0a2f 2f2f 203a   nodes and./// :
+00019220: 6d61 7468 3a60 6d60 2065 6467 6573 2e20  math:`m` edges. 
+00019230: 5468 6520 6765 6e65 7261 7465 6420 6772  The generated gr
+00019240: 6170 6820 7769 6c6c 206e 6f74 2062 6520  aph will not be 
+00019250: 6120 6d75 6c74 6967 7261 7068 2061 6e64  a multigraph and
+00019260: 2077 696c 6c20 6e6f 7420 6861 7665 2073   will not have s
+00019270: 656c 6620 6c6f 6f70 732e 0a2f 2f2f 0a2f  elf loops..///./
+00019280: 2f2f 2046 6f72 203a 6d61 7468 3a60 6e60  // For :math:`n`
+00019290: 206e 6f64 6573 2c20 7468 6520 6d61 7869   nodes, the maxi
+000192a0: 6d75 6d20 6564 6765 7320 7468 6174 2063  mum edges that c
+000192b0: 616e 2062 6520 7265 7475 726e 6564 2069  an be returned i
+000192c0: 7320 3a6d 6174 683a 606e 2028 6e20 2d20  s :math:`n (n - 
+000192d0: 3129 602e 0a2f 2f2f 2050 6173 7369 6e67  1)`../// Passing
+000192e0: 203a 6d61 7468 3a60 6d60 2068 6967 6865   :math:`m` highe
+000192f0: 7220 7468 616e 2074 6861 7420 7769 6c6c  r than that will
+00019300: 2073 7469 6c6c 2072 6574 7572 6e20 7468   still return th
+00019310: 6520 6d61 7869 6d75 6d20 6e75 6d62 6572  e maximum number
+00019320: 206f 6620 6564 6765 732e 0a2f 2f2f 2049   of edges../// I
+00019330: 6620 3a6d 6174 683a 606d 203d 2030 602c  f :math:`m = 0`,
+00019340: 2074 6865 2072 6574 7572 6e65 6420 6772   the returned gr
+00019350: 6170 6820 7769 6c6c 2061 6c77 6179 7320  aph will always 
+00019360: 6265 2065 6d70 7479 2028 6e6f 2065 6467  be empty (no edg
+00019370: 6573 292e 0a2f 2f2f 2057 6865 6e20 6120  es)../// When a 
+00019380: 7365 6564 2069 7320 7072 6f76 6964 6564  seed is provided
+00019390: 2c20 7468 6520 7265 7375 6c74 7320 6172  , the results ar
+000193a0: 6520 7265 7072 6f64 7563 6962 6c65 2e20  e reproducible. 
+000193b0: 5061 7373 696e 6720 6120 7365 6564 2077  Passing a seed w
+000193c0: 6865 6e20 3a6d 6174 683a 606d 203d 2030  hen :math:`m = 0
+000193d0: 600a 2f2f 2f20 6f72 203a 6d61 7468 3a60  `./// or :math:`
+000193e0: 6d20 3e3d 206e 2028 6e20 2d20 3129 6020  m >= n (n - 1)` 
+000193f0: 6861 7320 6e6f 2065 6666 6563 742c 2061  has no effect, a
+00019400: 7320 7468 6520 7265 7375 6c74 2077 696c  s the result wil
+00019410: 6c20 616c 7761 7973 2062 6520 616e 2065  l always be an e
+00019420: 6d70 7479 206f 7220 6120 636f 6d70 6c65  mpty or a comple
+00019430: 7465 2067 7261 7068 2072 6573 7065 6374  te graph respect
+00019440: 6976 656c 792e 0a2f 2f2f 0a2f 2f2f 2054  ively..///./// T
+00019450: 6869 7320 616c 676f 7269 7468 6d20 6861  his algorithm ha
+00019460: 7320 6120 7469 6d65 2063 6f6d 706c 6578  s a time complex
+00019470: 6974 7920 6f66 203a 6d61 7468 3a60 4f28  ity of :math:`O(
+00019480: 6e20 2b20 6d29 600a 2f2f 2f0a 2f2f 2f20  n + m)`.///./// 
+00019490: 3a70 6172 616d 2069 6e74 206e 756d 5f6e  :param int num_n
+000194a0: 6f64 6573 3a20 5468 6520 6e75 6d62 6572  odes: The number
+000194b0: 206f 6620 6e6f 6465 7320 746f 2063 7265   of nodes to cre
+000194c0: 6174 6520 696e 2074 6865 2067 7261 7068  ate in the graph
+000194d0: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
+000194e0: 6e75 6d5f 6564 6765 733a 2054 6865 206e  num_edges: The n
+000194f0: 756d 6265 7220 6f66 2065 6467 6573 2074  umber of edges t
+00019500: 6f20 6372 6561 7465 2069 6e20 7468 6520  o create in the 
+00019510: 6772 6170 680a 2f2f 2f20 3a70 6172 616d  graph./// :param
+00019520: 2069 6e74 2073 6565 643a 2041 6e20 6f70   int seed: An op
+00019530: 7469 6f6e 616c 2073 6565 6420 746f 2075  tional seed to u
+00019540: 7365 2066 6f72 2074 6865 2072 616e 646f  se for the rando
+00019550: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+00019560: 6f72 0a2f 2f2f 0a2f 2f2f 203a 7265 7475  or.///./// :retu
+00019570: 726e 3a20 4120 5079 4469 4772 6170 6820  rn: A PyDiGraph 
+00019580: 6f62 6a65 6374 0a2f 2f2f 203a 7274 7970  object./// :rtyp
+00019590: 653a 2050 7944 6947 7261 7068 0a2f 2f2f  e: PyDiGraph.///
+000195a0: 0a23 5b70 7966 756e 6374 696f 6e5d 0a23  .#[pyfunction].#
+000195b0: 5b74 6578 745f 7369 676e 6174 7572 6520  [text_signature 
+000195c0: 3d20 2228 6e75 6d5f 6e6f 6465 732c 206e  = "(num_nodes, n
+000195d0: 756d 5f65 6467 6573 2c20 7365 6564 3d4e  um_edges, seed=N
+000195e0: 6f6e 652c 202f 2922 5d0a 7075 6220 666e  one, /)"].pub fn
+000195f0: 2064 6972 6563 7465 645f 676e 6d5f 7261   directed_gnm_ra
+00019600: 6e64 6f6d 5f67 7261 7068 280a 2020 2020  ndom_graph(.    
+00019610: 7079 3a20 5079 7468 6f6e 2c0a 2020 2020  py: Python,.    
+00019620: 6e75 6d5f 6e6f 6465 733a 2069 7369 7a65  num_nodes: isize
+00019630: 2c0a 2020 2020 6e75 6d5f 6564 6765 733a  ,.    num_edges:
+00019640: 2069 7369 7a65 2c0a 2020 2020 7365 6564   isize,.    seed
+00019650: 3a20 4f70 7469 6f6e 3c75 3634 3e2c 0a29  : Option<u64>,.)
+00019660: 202d 3e20 5079 5265 7375 6c74 3c64 6967   -> PyResult<dig
+00019670: 7261 7068 3a3a 5079 4469 4772 6170 683e  raph::PyDiGraph>
+00019680: 207b 0a20 2020 2069 6620 6e75 6d5f 6e6f   {.    if num_no
+00019690: 6465 7320 3c3d 2030 207b 0a20 2020 2020  des <= 0 {.     
+000196a0: 2020 2072 6574 7572 6e20 4572 7228 5079     return Err(Py
+000196b0: 5661 6c75 6545 7272 6f72 3a3a 6e65 775f  ValueError::new_
+000196c0: 6572 7228 226e 756d 5f6e 6f64 6573 206d  err("num_nodes m
+000196d0: 7573 7420 6265 203e 2030 2229 293b 0a20  ust be > 0"));. 
+000196e0: 2020 207d 0a20 2020 2069 6620 6e75 6d5f     }.    if num_
+000196f0: 6564 6765 7320 3c20 3020 7b0a 2020 2020  edges < 0 {.    
+00019700: 2020 2020 7265 7475 726e 2045 7272 2850      return Err(P
+00019710: 7956 616c 7565 4572 726f 723a 3a6e 6577  yValueError::new
+00019720: 5f65 7272 2822 6e75 6d5f 6564 6765 7320  _err("num_edges 
+00019730: 6d75 7374 2062 6520 3e3d 2030 2229 293b  must be >= 0"));
+00019740: 0a20 2020 207d 0a20 2020 206c 6574 206d  .    }.    let m
+00019750: 7574 2072 6e67 3a20 5063 6736 3420 3d20  ut rng: Pcg64 = 
+00019760: 6d61 7463 6820 7365 6564 207b 0a20 2020  match seed {.   
+00019770: 2020 2020 2053 6f6d 6528 7365 6564 2920       Some(seed) 
+00019780: 3d3e 2050 6367 3634 3a3a 7365 6564 5f66  => Pcg64::seed_f
+00019790: 726f 6d5f 7536 3428 7365 6564 292c 0a20  rom_u64(seed),. 
+000197a0: 2020 2020 2020 204e 6f6e 6520 3d3e 2050         None => P
+000197b0: 6367 3634 3a3a 6672 6f6d 5f65 6e74 726f  cg64::from_entro
+000197c0: 7079 2829 2c0a 2020 2020 7d3b 0a20 2020  py(),.    };.   
+000197d0: 206c 6574 206d 7574 2069 6e6e 6572 5f67   let mut inner_g
+000197e0: 7261 7068 203d 2053 7461 626c 6544 6947  raph = StableDiG
+000197f0: 7261 7068 3a3a 3c50 794f 626a 6563 742c  raph::<PyObject,
+00019800: 2050 794f 626a 6563 743e 3a3a 6e65 7728   PyObject>::new(
+00019810: 293b 0a20 2020 2066 6f72 2078 2069 6e20  );.    for x in 
+00019820: 302e 2e6e 756d 5f6e 6f64 6573 207b 0a20  0..num_nodes {. 
+00019830: 2020 2020 2020 2069 6e6e 6572 5f67 7261         inner_gra
+00019840: 7068 2e61 6464 5f6e 6f64 6528 782e 746f  ph.add_node(x.to
+00019850: 5f6f 626a 6563 7428 7079 2929 3b0a 2020  _object(py));.  
+00019860: 2020 7d0a 2020 2020 2f2f 2069 6620 6e75    }.    // if nu
+00019870: 6d62 6572 206f 6620 6564 6765 7320 746f  mber of edges to
+00019880: 2062 6520 6372 6561 7465 6420 6973 203e   be created is >
+00019890: 3d20 6d61 782c 0a20 2020 202f 2f20 6176  = max,.    // av
+000198a0: 6f69 6420 7261 6e64 6f6d 6c79 206d 6973  oid randomly mis
+000198b0: 7365 6420 7472 6961 6c73 2061 6e64 2064  sed trials and d
+000198c0: 6972 6563 746c 7920 6164 6420 6564 6765  irectly add edge
+000198d0: 7320 6265 7477 6565 6e20 6576 6572 7920  s between every 
+000198e0: 6e6f 6465 0a20 2020 2069 6620 6e75 6d5f  node.    if num_
+000198f0: 6564 6765 7320 3e3d 206e 756d 5f6e 6f64  edges >= num_nod
+00019900: 6573 202a 2028 6e75 6d5f 6e6f 6465 7320  es * (num_nodes 
+00019910: 2d20 3129 207b 0a20 2020 2020 2020 2066  - 1) {.        f
+00019920: 6f72 2075 2069 6e20 302e 2e6e 756d 5f6e  or u in 0..num_n
+00019930: 6f64 6573 207b 0a20 2020 2020 2020 2020  odes {.         
+00019940: 2020 2066 6f72 2076 2069 6e20 302e 2e6e     for v in 0..n
+00019950: 756d 5f6e 6f64 6573 207b 0a20 2020 2020  um_nodes {.     
+00019960: 2020 2020 2020 2020 2020 202f 2f20 6176             // av
+00019970: 6f69 6420 7365 6c66 2d6c 6f6f 7073 0a20  oid self-loops. 
+00019980: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00019990: 6620 7520 213d 2076 207b 0a20 2020 2020  f u != v {.     
+000199a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000199b0: 6574 2075 5f69 6e64 6578 203d 204e 6f64  et u_index = Nod
+000199c0: 6549 6e64 6578 3a3a 6e65 7728 7520 6173  eIndex::new(u as
+000199d0: 2075 7369 7a65 293b 0a20 2020 2020 2020   usize);.       
+000199e0: 2020 2020 2020 2020 2020 2020 206c 6574               let
+000199f0: 2076 5f69 6e64 6578 203d 204e 6f64 6549   v_index = NodeI
+00019a00: 6e64 6578 3a3a 6e65 7728 7620 6173 2075  ndex::new(v as u
+00019a10: 7369 7a65 293b 0a20 2020 2020 2020 2020  size);.         
+00019a20: 2020 2020 2020 2020 2020 2069 6e6e 6572             inner
+00019a30: 5f67 7261 7068 2e61 6464 5f65 6467 6528  _graph.add_edge(
+00019a40: 755f 696e 6465 782c 2076 5f69 6e64 6578  u_index, v_index
+00019a50: 2c20 7079 2e4e 6f6e 6528 2929 3b0a 2020  , py.None());.  
+00019a60: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00019a70: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00019a80: 2020 2020 2020 7d0a 2020 2020 7d20 656c        }.    } el
+00019a90: 7365 207b 0a20 2020 2020 2020 206c 6574  se {.        let
+00019aa0: 206d 7574 2063 7265 6174 6564 5f65 6467   mut created_edg
+00019ab0: 6573 3a20 6973 697a 6520 3d20 303b 0a20  es: isize = 0;. 
+00019ac0: 2020 2020 2020 206c 6574 2062 6574 7765         let betwe
+00019ad0: 656e 203d 2055 6e69 666f 726d 3a3a 6e65  en = Uniform::ne
+00019ae0: 7728 302c 206e 756d 5f6e 6f64 6573 293b  w(0, num_nodes);
+00019af0: 0a20 2020 2020 2020 2077 6869 6c65 2063  .        while c
+00019b00: 7265 6174 6564 5f65 6467 6573 203c 206e  reated_edges < n
+00019b10: 756d 5f65 6467 6573 207b 0a20 2020 2020  um_edges {.     
+00019b20: 2020 2020 2020 206c 6574 2075 203d 2062         let u = b
+00019b30: 6574 7765 656e 2e73 616d 706c 6528 266d  etween.sample(&m
+00019b40: 7574 2072 6e67 293b 0a20 2020 2020 2020  ut rng);.       
+00019b50: 2020 2020 206c 6574 2076 203d 2062 6574       let v = bet
+00019b60: 7765 656e 2e73 616d 706c 6528 266d 7574  ween.sample(&mut
+00019b70: 2072 6e67 293b 0a20 2020 2020 2020 2020   rng);.         
+00019b80: 2020 206c 6574 2075 5f69 6e64 6578 203d     let u_index =
+00019b90: 204e 6f64 6549 6e64 6578 3a3a 6e65 7728   NodeIndex::new(
+00019ba0: 7520 6173 2075 7369 7a65 293b 0a20 2020  u as usize);.   
+00019bb0: 2020 2020 2020 2020 206c 6574 2076 5f69           let v_i
+00019bc0: 6e64 6578 203d 204e 6f64 6549 6e64 6578  ndex = NodeIndex
+00019bd0: 3a3a 6e65 7728 7620 6173 2075 7369 7a65  ::new(v as usize
+00019be0: 293b 0a20 2020 2020 2020 2020 2020 202f  );.            /
+00019bf0: 2f20 6176 6f69 6420 7365 6c66 2d6c 6f6f  / avoid self-loo
+00019c00: 7073 2061 6e64 206d 756c 7469 2d67 7261  ps and multi-gra
+00019c10: 7068 730a 2020 2020 2020 2020 2020 2020  phs.            
+00019c20: 6966 2075 2021 3d20 7620 2626 2069 6e6e  if u != v && inn
+00019c30: 6572 5f67 7261 7068 2e66 696e 645f 6564  er_graph.find_ed
+00019c40: 6765 2875 5f69 6e64 6578 2c20 765f 696e  ge(u_index, v_in
+00019c50: 6465 7829 2e69 735f 6e6f 6e65 2829 207b  dex).is_none() {
+00019c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019c70: 2069 6e6e 6572 5f67 7261 7068 2e61 6464   inner_graph.add
+00019c80: 5f65 6467 6528 755f 696e 6465 782c 2076  _edge(u_index, v
+00019c90: 5f69 6e64 6578 2c20 7079 2e4e 6f6e 6528  _index, py.None(
+00019ca0: 2929 3b0a 2020 2020 2020 2020 2020 2020  ));.            
+00019cb0: 2020 2020 6372 6561 7465 645f 6564 6765      created_edge
+00019cc0: 7320 2b3d 2031 3b0a 2020 2020 2020 2020  s += 1;.        
+00019cd0: 2020 2020 7d0a 2020 2020 2020 2020 7d0a      }.        }.
+00019ce0: 2020 2020 7d0a 2020 2020 6c65 7420 6772      }.    let gr
+00019cf0: 6170 6820 3d20 6469 6772 6170 683a 3a50  aph = digraph::P
+00019d00: 7944 6947 7261 7068 207b 0a20 2020 2020  yDiGraph {.     
+00019d10: 2020 2067 7261 7068 3a20 696e 6e65 725f     graph: inner_
+00019d20: 6772 6170 682c 0a20 2020 2020 2020 2063  graph,.        c
+00019d30: 7963 6c65 5f73 7461 7465 3a20 616c 676f  ycle_state: algo
+00019d40: 3a3a 4466 7353 7061 6365 3a3a 6465 6661  ::DfsSpace::defa
+00019d50: 756c 7428 292c 0a20 2020 2020 2020 2063  ult(),.        c
+00019d60: 6865 636b 5f63 7963 6c65 3a20 6661 6c73  heck_cycle: fals
+00019d70: 652c 0a20 2020 2020 2020 206e 6f64 655f  e,.        node_
+00019d80: 7265 6d6f 7665 643a 2066 616c 7365 2c0a  removed: false,.
+00019d90: 2020 2020 2020 2020 6d75 6c74 6967 7261          multigra
+00019da0: 7068 3a20 7472 7565 2c0a 2020 2020 7d3b  ph: true,.    };
+00019db0: 0a20 2020 204f 6b28 6772 6170 6829 0a7d  .    Ok(graph).}
+00019dc0: 0a0a 2f2f 2f20 5265 7475 726e 2061 203a  ../// Return a :
+00019dd0: 6d61 7468 3a60 475f 7b6e 6d7d 6020 6f66  math:`G_{nm}` of
+00019de0: 2061 6e20 756e 6469 7265 6374 6564 2067   an undirected g
+00019df0: 7261 7068 0a2f 2f2f 0a2f 2f2f 2047 656e  raph.///./// Gen
+00019e00: 6572 6174 6573 2061 2072 616e 646f 6d20  erates a random 
+00019e10: 756e 6469 7265 6374 6564 2067 7261 7068  undirected graph
+00019e20: 206f 7574 206f 6620 616c 6c20 7468 6520   out of all the 
+00019e30: 706f 7373 6962 6c65 2067 7261 7068 7320  possible graphs 
+00019e40: 7769 7468 203a 6d61 7468 3a60 6e60 206e  with :math:`n` n
+00019e50: 6f64 6573 2061 6e64 0a2f 2f2f 203a 6d61  odes and./// :ma
+00019e60: 7468 3a60 6d60 2065 6467 6573 2e20 5468  th:`m` edges. Th
+00019e70: 6520 6765 6e65 7261 7465 6420 6772 6170  e generated grap
+00019e80: 6820 7769 6c6c 206e 6f74 2062 6520 6120  h will not be a 
+00019e90: 6d75 6c74 6967 7261 7068 2061 6e64 2077  multigraph and w
+00019ea0: 696c 6c20 6e6f 7420 6861 7665 2073 656c  ill not have sel
+00019eb0: 6620 6c6f 6f70 732e 0a2f 2f2f 0a2f 2f2f  f loops..///.///
+00019ec0: 2046 6f72 203a 6d61 7468 3a60 6e60 206e   For :math:`n` n
+00019ed0: 6f64 6573 2c20 7468 6520 6d61 7869 6d75  odes, the maximu
+00019ee0: 6d20 6564 6765 7320 7468 6174 2063 616e  m edges that can
+00019ef0: 2062 6520 7265 7475 726e 6564 2069 7320   be returned is 
+00019f00: 3a6d 6174 683a 606e 2028 6e20 2d20 3129  :math:`n (n - 1)
+00019f10: 2f32 602e 0a2f 2f2f 2050 6173 7369 6e67  /2`../// Passing
+00019f20: 203a 6d61 7468 3a60 6d60 2068 6967 6865   :math:`m` highe
+00019f30: 7220 7468 616e 2074 6861 7420 7769 6c6c  r than that will
+00019f40: 2073 7469 6c6c 2072 6574 7572 6e20 7468   still return th
+00019f50: 6520 6d61 7869 6d75 6d20 6e75 6d62 6572  e maximum number
+00019f60: 206f 6620 6564 6765 732e 0a2f 2f2f 2049   of edges../// I
+00019f70: 6620 3a6d 6174 683a 606d 203d 2030 602c  f :math:`m = 0`,
+00019f80: 2074 6865 2072 6574 7572 6e65 6420 6772   the returned gr
+00019f90: 6170 6820 7769 6c6c 2061 6c77 6179 7320  aph will always 
+00019fa0: 6265 2065 6d70 7479 2028 6e6f 2065 6467  be empty (no edg
+00019fb0: 6573 292e 0a2f 2f2f 2057 6865 6e20 6120  es)../// When a 
+00019fc0: 7365 6564 2069 7320 7072 6f76 6964 6564  seed is provided
+00019fd0: 2c20 7468 6520 7265 7375 6c74 7320 6172  , the results ar
+00019fe0: 6520 7265 7072 6f64 7563 6962 6c65 2e20  e reproducible. 
+00019ff0: 5061 7373 696e 6720 6120 7365 6564 2077  Passing a seed w
+0001a000: 6865 6e20 3a6d 6174 683a 606d 203d 2030  hen :math:`m = 0
+0001a010: 600a 2f2f 2f20 6f72 203a 6d61 7468 3a60  `./// or :math:`
+0001a020: 6d20 3e3d 206e 2028 6e20 2d20 3129 2f32  m >= n (n - 1)/2
+0001a030: 6020 6861 7320 6e6f 2065 6666 6563 742c  ` has no effect,
+0001a040: 2061 7320 7468 6520 7265 7375 6c74 2077   as the result w
+0001a050: 696c 6c20 616c 7761 7973 2062 6520 616e  ill always be an
+0001a060: 2065 6d70 7479 206f 7220 6120 636f 6d70   empty or a comp
+0001a070: 6c65 7465 2067 7261 7068 2072 6573 7065  lete graph respe
+0001a080: 6374 6976 656c 792e 0a2f 2f2f 0a2f 2f2f  ctively..///.///
+0001a090: 2054 6869 7320 616c 676f 7269 7468 6d20   This algorithm 
+0001a0a0: 6861 7320 6120 7469 6d65 2063 6f6d 706c  has a time compl
+0001a0b0: 6578 6974 7920 6f66 203a 6d61 7468 3a60  exity of :math:`
+0001a0c0: 4f28 6e20 2b20 6d29 600a 2f2f 2f0a 2f2f  O(n + m)`.///.//
+0001a0d0: 2f20 3a70 6172 616d 2069 6e74 206e 756d  / :param int num
+0001a0e0: 5f6e 6f64 6573 3a20 5468 6520 6e75 6d62  _nodes: The numb
+0001a0f0: 6572 206f 6620 6e6f 6465 7320 746f 2063  er of nodes to c
+0001a100: 7265 6174 6520 696e 2074 6865 2067 7261  reate in the gra
+0001a110: 7068 0a2f 2f2f 203a 7061 7261 6d20 696e  ph./// :param in
+0001a120: 7420 6e75 6d5f 6564 6765 733a 2054 6865  t num_edges: The
+0001a130: 206e 756d 6265 7220 6f66 2065 6467 6573   number of edges
+0001a140: 2074 6f20 6372 6561 7465 2069 6e20 7468   to create in th
+0001a150: 6520 6772 6170 680a 2f2f 2f20 3a70 6172  e graph./// :par
+0001a160: 616d 2069 6e74 2073 6565 643a 2041 6e20  am int seed: An 
+0001a170: 6f70 7469 6f6e 616c 2073 6565 6420 746f  optional seed to
+0001a180: 2075 7365 2066 6f72 2074 6865 2072 616e   use for the ran
+0001a190: 646f 6d20 6e75 6d62 6572 2067 656e 6572  dom number gener
+0001a1a0: 6174 6f72 0a2f 2f2f 0a2f 2f2f 203a 7265  ator.///./// :re
+0001a1b0: 7475 726e 3a20 4120 5079 4772 6170 6820  turn: A PyGraph 
+0001a1c0: 6f62 6a65 6374 0a2f 2f2f 203a 7274 7970  object./// :rtyp
+0001a1d0: 653a 2050 7947 7261 7068 0a0a 235b 7079  e: PyGraph..#[py
+0001a1e0: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+0001a1f0: 5f73 6967 6e61 7475 7265 203d 2022 286e  _signature = "(n
+0001a200: 756d 5f6e 6f64 6573 2c20 7072 6f62 6162  um_nodes, probab
+0001a210: 696c 6974 792c 2073 6565 643d 4e6f 6e65  ility, seed=None
+0001a220: 2c20 2f29 225d 0a70 7562 2066 6e20 756e  , /)"].pub fn un
+0001a230: 6469 7265 6374 6564 5f67 6e6d 5f72 616e  directed_gnm_ran
+0001a240: 646f 6d5f 6772 6170 6828 0a20 2020 2070  dom_graph(.    p
+0001a250: 793a 2050 7974 686f 6e2c 0a20 2020 206e  y: Python,.    n
+0001a260: 756d 5f6e 6f64 6573 3a20 6973 697a 652c  um_nodes: isize,
+0001a270: 0a20 2020 206e 756d 5f65 6467 6573 3a20  .    num_edges: 
+0001a280: 6973 697a 652c 0a20 2020 2073 6565 643a  isize,.    seed:
+0001a290: 204f 7074 696f 6e3c 7536 343e 2c0a 2920   Option<u64>,.) 
+0001a2a0: 2d3e 2050 7952 6573 756c 743c 6772 6170  -> PyResult<grap
+0001a2b0: 683a 3a50 7947 7261 7068 3e20 7b0a 2020  h::PyGraph> {.  
+0001a2c0: 2020 6966 206e 756d 5f6e 6f64 6573 203c    if num_nodes <
+0001a2d0: 3d20 3020 7b0a 2020 2020 2020 2020 7265  = 0 {.        re
+0001a2e0: 7475 726e 2045 7272 2850 7956 616c 7565  turn Err(PyValue
+0001a2f0: 4572 726f 723a 3a6e 6577 5f65 7272 2822  Error::new_err("
+0001a300: 6e75 6d5f 6e6f 6465 7320 6d75 7374 2062  num_nodes must b
+0001a310: 6520 3e20 3022 2929 3b0a 2020 2020 7d0a  e > 0"));.    }.
+0001a320: 2020 2020 6966 206e 756d 5f65 6467 6573      if num_edges
+0001a330: 203c 2030 207b 0a20 2020 2020 2020 2072   < 0 {.        r
+0001a340: 6574 7572 6e20 4572 7228 5079 5661 6c75  eturn Err(PyValu
+0001a350: 6545 7272 6f72 3a3a 6e65 775f 6572 7228  eError::new_err(
+0001a360: 226e 756d 5f65 6467 6573 206d 7573 7420  "num_edges must 
+0001a370: 6265 203e 3d20 3022 2929 3b0a 2020 2020  be >= 0"));.    
+0001a380: 7d0a 2020 2020 6c65 7420 6d75 7420 726e  }.    let mut rn
+0001a390: 673a 2050 6367 3634 203d 206d 6174 6368  g: Pcg64 = match
+0001a3a0: 2073 6565 6420 7b0a 2020 2020 2020 2020   seed {.        
+0001a3b0: 536f 6d65 2873 6565 6429 203d 3e20 5063  Some(seed) => Pc
+0001a3c0: 6736 343a 3a73 6565 645f 6672 6f6d 5f75  g64::seed_from_u
+0001a3d0: 3634 2873 6565 6429 2c0a 2020 2020 2020  64(seed),.      
+0001a3e0: 2020 4e6f 6e65 203d 3e20 5063 6736 343a    None => Pcg64:
+0001a3f0: 3a66 726f 6d5f 656e 7472 6f70 7928 292c  :from_entropy(),
+0001a400: 0a20 2020 207d 3b0a 2020 2020 6c65 7420  .    };.    let 
+0001a410: 6d75 7420 696e 6e65 725f 6772 6170 6820  mut inner_graph 
+0001a420: 3d20 5374 6162 6c65 556e 4772 6170 683a  = StableUnGraph:
+0001a430: 3a3c 5079 4f62 6a65 6374 2c20 5079 4f62  :<PyObject, PyOb
+0001a440: 6a65 6374 3e3a 3a64 6566 6175 6c74 2829  ject>::default()
+0001a450: 3b0a 2020 2020 666f 7220 7820 696e 2030  ;.    for x in 0
+0001a460: 2e2e 6e75 6d5f 6e6f 6465 7320 7b0a 2020  ..num_nodes {.  
+0001a470: 2020 2020 2020 696e 6e65 725f 6772 6170        inner_grap
+0001a480: 682e 6164 645f 6e6f 6465 2878 2e74 6f5f  h.add_node(x.to_
+0001a490: 6f62 6a65 6374 2870 7929 293b 0a20 2020  object(py));.   
+0001a4a0: 207d 0a20 2020 202f 2f20 6966 206e 756d   }.    // if num
+0001a4b0: 6265 7220 6f66 2065 6467 6573 2074 6f20  ber of edges to 
+0001a4c0: 6265 2063 7265 6174 6564 2069 7320 3e3d  be created is >=
+0001a4d0: 206d 6178 2c0a 2020 2020 2f2f 2061 766f   max,.    // avo
+0001a4e0: 6964 2072 616e 646f 6d6c 7920 6d69 7373  id randomly miss
+0001a4f0: 6564 2074 7269 616c 7320 616e 6420 6469  ed trials and di
+0001a500: 7265 6374 6c79 2061 6464 2065 6467 6573  rectly add edges
+0001a510: 2062 6574 7765 656e 2065 7665 7279 206e   between every n
+0001a520: 6f64 650a 2020 2020 6966 206e 756d 5f65  ode.    if num_e
+0001a530: 6467 6573 203e 3d20 6e75 6d5f 6e6f 6465  dges >= num_node
+0001a540: 7320 2a20 286e 756d 5f6e 6f64 6573 202d  s * (num_nodes -
+0001a550: 2031 2920 2f20 3220 7b0a 2020 2020 2020   1) / 2 {.      
+0001a560: 2020 666f 7220 7520 696e 2030 2e2e 6e75    for u in 0..nu
+0001a570: 6d5f 6e6f 6465 7320 7b0a 2020 2020 2020  m_nodes {.      
+0001a580: 2020 2020 2020 666f 7220 7620 696e 2075        for v in u
+0001a590: 202b 2031 2e2e 6e75 6d5f 6e6f 6465 7320   + 1..num_nodes 
+0001a5a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0001a5b0: 2020 6c65 7420 755f 696e 6465 7820 3d20    let u_index = 
+0001a5c0: 4e6f 6465 496e 6465 783a 3a6e 6577 2875  NodeIndex::new(u
+0001a5d0: 2061 7320 7573 697a 6529 3b0a 2020 2020   as usize);.    
+0001a5e0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+0001a5f0: 765f 696e 6465 7820 3d20 4e6f 6465 496e  v_index = NodeIn
+0001a600: 6465 783a 3a6e 6577 2876 2061 7320 7573  dex::new(v as us
+0001a610: 697a 6529 3b0a 2020 2020 2020 2020 2020  ize);.          
+0001a620: 2020 2020 2020 696e 6e65 725f 6772 6170        inner_grap
+0001a630: 682e 6164 645f 6564 6765 2875 5f69 6e64  h.add_edge(u_ind
+0001a640: 6578 2c20 765f 696e 6465 782c 2070 792e  ex, v_index, py.
+0001a650: 4e6f 6e65 2829 293b 0a20 2020 2020 2020  None());.       
+0001a660: 2020 2020 207d 0a20 2020 2020 2020 207d       }.        }
+0001a670: 0a20 2020 207d 2065 6c73 6520 7b0a 2020  .    } else {.  
+0001a680: 2020 2020 2020 6c65 7420 6d75 7420 6372        let mut cr
+0001a690: 6561 7465 645f 6564 6765 733a 2069 7369  eated_edges: isi
+0001a6a0: 7a65 203d 2030 3b0a 2020 2020 2020 2020  ze = 0;.        
+0001a6b0: 6c65 7420 6265 7477 6565 6e20 3d20 556e  let between = Un
+0001a6c0: 6966 6f72 6d3a 3a6e 6577 2830 2c20 6e75  iform::new(0, nu
+0001a6d0: 6d5f 6e6f 6465 7329 3b0a 2020 2020 2020  m_nodes);.      
+0001a6e0: 2020 7768 696c 6520 6372 6561 7465 645f    while created_
+0001a6f0: 6564 6765 7320 3c20 6e75 6d5f 6564 6765  edges < num_edge
+0001a700: 7320 7b0a 2020 2020 2020 2020 2020 2020  s {.            
+0001a710: 6c65 7420 7520 3d20 6265 7477 6565 6e2e  let u = between.
+0001a720: 7361 6d70 6c65 2826 6d75 7420 726e 6729  sample(&mut rng)
+0001a730: 3b0a 2020 2020 2020 2020 2020 2020 6c65  ;.            le
+0001a740: 7420 7620 3d20 6265 7477 6565 6e2e 7361  t v = between.sa
+0001a750: 6d70 6c65 2826 6d75 7420 726e 6729 3b0a  mple(&mut rng);.
+0001a760: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+0001a770: 755f 696e 6465 7820 3d20 4e6f 6465 496e  u_index = NodeIn
+0001a780: 6465 783a 3a6e 6577 2875 2061 7320 7573  dex::new(u as us
+0001a790: 697a 6529 3b0a 2020 2020 2020 2020 2020  ize);.          
+0001a7a0: 2020 6c65 7420 765f 696e 6465 7820 3d20    let v_index = 
+0001a7b0: 4e6f 6465 496e 6465 783a 3a6e 6577 2876  NodeIndex::new(v
+0001a7c0: 2061 7320 7573 697a 6529 3b0a 2020 2020   as usize);.    
+0001a7d0: 2020 2020 2020 2020 2f2f 2061 766f 6964          // avoid
+0001a7e0: 2073 656c 662d 6c6f 6f70 7320 616e 6420   self-loops and 
+0001a7f0: 6d75 6c74 692d 6772 6170 6873 0a20 2020  multi-graphs.   
+0001a800: 2020 2020 2020 2020 2069 6620 7520 213d           if u !=
+0001a810: 2076 2026 2620 696e 6e65 725f 6772 6170   v && inner_grap
+0001a820: 682e 6669 6e64 5f65 6467 6528 755f 696e  h.find_edge(u_in
+0001a830: 6465 782c 2076 5f69 6e64 6578 292e 6973  dex, v_index).is
+0001a840: 5f6e 6f6e 6528 2920 7b0a 2020 2020 2020  _none() {.      
+0001a850: 2020 2020 2020 2020 2020 696e 6e65 725f            inner_
+0001a860: 6772 6170 682e 6164 645f 6564 6765 2875  graph.add_edge(u
+0001a870: 5f69 6e64 6578 2c20 765f 696e 6465 782c  _index, v_index,
+0001a880: 2070 792e 4e6f 6e65 2829 293b 0a20 2020   py.None());.   
+0001a890: 2020 2020 2020 2020 2020 2020 2063 7265               cre
+0001a8a0: 6174 6564 5f65 6467 6573 202b 3d20 313b  ated_edges += 1;
+0001a8b0: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0001a8c0: 2020 2020 2020 207d 0a20 2020 207d 0a20         }.    }. 
+0001a8d0: 2020 206c 6574 2067 7261 7068 203d 2067     let graph = g
+0001a8e0: 7261 7068 3a3a 5079 4772 6170 6820 7b0a  raph::PyGraph {.
+0001a8f0: 2020 2020 2020 2020 6772 6170 683a 2069          graph: i
+0001a900: 6e6e 6572 5f67 7261 7068 2c0a 2020 2020  nner_graph,.    
+0001a910: 2020 2020 6e6f 6465 5f72 656d 6f76 6564      node_removed
+0001a920: 3a20 6661 6c73 652c 0a20 2020 2020 2020  : false,.       
+0001a930: 206d 756c 7469 6772 6170 683a 2074 7275   multigraph: tru
+0001a940: 652c 0a20 2020 207d 3b0a 2020 2020 4f6b  e,.    };.    Ok
+0001a950: 2867 7261 7068 290a 7d0a 0a23 5b69 6e6c  (graph).}..#[inl
+0001a960: 696e 655d 0a66 6e20 706e 6f72 6d28 783a  ine].fn pnorm(x:
+0001a970: 2066 3634 2c20 703a 2066 3634 2920 2d3e   f64, p: f64) ->
+0001a980: 2066 3634 207b 0a20 2020 2069 6620 7020   f64 {.    if p 
+0001a990: 3d3d 2031 2e30 207c 7c20 7020 3d3d 2073  == 1.0 || p == s
+0001a9a0: 7464 3a3a 6636 343a 3a49 4e46 494e 4954  td::f64::INFINIT
+0001a9b0: 5920 7b0a 2020 2020 2020 2020 782e 6162  Y {.        x.ab
+0001a9c0: 7328 290a 2020 2020 7d20 656c 7365 2069  s().    } else i
+0001a9d0: 6620 7020 3d3d 2032 2e30 207b 0a20 2020  f p == 2.0 {.   
+0001a9e0: 2020 2020 2078 202a 2078 0a20 2020 207d       x * x.    }
+0001a9f0: 2065 6c73 6520 7b0a 2020 2020 2020 2020   else {.        
+0001aa00: 782e 6162 7328 292e 706f 7766 2870 290a  x.abs().powf(p).
+0001aa10: 2020 2020 7d0a 7d0a 0a66 6e20 6469 7374      }.}..fn dist
+0001aa20: 616e 6365 2878 3a20 265b 6636 345d 2c20  ance(x: &[f64], 
+0001aa30: 793a 2026 5b66 3634 5d2c 2070 3a20 6636  y: &[f64], p: f6
+0001aa40: 3429 202d 3e20 6636 3420 7b0a 2020 2020  4) -> f64 {.    
+0001aa50: 6c65 7420 6974 203d 2078 2e69 7465 7228  let it = x.iter(
+0001aa60: 292e 7a69 7028 792e 6974 6572 2829 292e  ).zip(y.iter()).
+0001aa70: 6d61 7028 7c28 7869 2c20 7969 297c 2070  map(|(xi, yi)| p
+0001aa80: 6e6f 726d 2878 6920 2d20 7969 2c20 7029  norm(xi - yi, p)
+0001aa90: 293b 0a0a 2020 2020 6966 2070 203d 3d20  );..    if p == 
+0001aaa0: 7374 643a 3a66 3634 3a3a 494e 4649 4e49  std::f64::INFINI
+0001aab0: 5459 207b 0a20 2020 2020 2020 2069 742e  TY {.        it.
+0001aac0: 666f 6c64 282d 312e 302c 207c 6d61 782c  fold(-1.0, |max,
+0001aad0: 2078 7c20 6966 2078 203e 206d 6178 207b   x| if x > max {
+0001aae0: 2078 207d 2065 6c73 6520 7b20 6d61 7820   x } else { max 
+0001aaf0: 7d29 0a20 2020 207d 2065 6c73 6520 7b0a  }).    } else {.
+0001ab00: 2020 2020 2020 2020 6974 2e73 756d 2829          it.sum()
+0001ab10: 0a20 2020 207d 0a7d 0a0a 2f2f 2f20 5265  .    }.}../// Re
+0001ab20: 7475 726e 7320 6120 7261 6e64 6f6d 2067  turns a random g
+0001ab30: 656f 6d65 7472 6963 2067 7261 7068 2069  eometric graph i
+0001ab40: 6e20 7468 6520 756e 6974 2063 7562 6520  n the unit cube 
+0001ab50: 6f66 2064 696d 656e 7369 6f6e 7320 6064  of dimensions `d
+0001ab60: 696d 602e 0a2f 2f2f 0a2f 2f2f 2054 6865  im`..///./// The
+0001ab70: 2072 616e 646f 6d20 6765 6f6d 6574 7269   random geometri
+0001ab80: 6320 6772 6170 6820 6d6f 6465 6c20 706c  c graph model pl
+0001ab90: 6163 6573 2060 6e75 6d5f 6e6f 6465 7360  aces `num_nodes`
+0001aba0: 206e 6f64 6573 2075 6e69 666f 726d 6c79   nodes uniformly
+0001abb0: 2061 740a 2f2f 2f20 7261 6e64 6f6d 2069   at./// random i
+0001abc0: 6e20 7468 6520 756e 6974 2063 7562 652e  n the unit cube.
+0001abd0: 2054 776f 206e 6f64 6573 2061 7265 206a   Two nodes are j
+0001abe0: 6f69 6e65 6420 6279 2061 6e20 6564 6765  oined by an edge
+0001abf0: 2069 6620 7468 650a 2f2f 2f20 6469 7374   if the./// dist
+0001ac00: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
+0001ac10: 206e 6f64 6573 2069 7320 6174 206d 6f73   nodes is at mos
+0001ac20: 7420 6072 6164 6975 7360 2e0a 2f2f 2f0a  t `radius`..///.
+0001ac30: 2f2f 2f20 4561 6368 206e 6f64 6520 6861  /// Each node ha
+0001ac40: 7320 6120 6e6f 6465 2061 7474 7269 6275  s a node attribu
+0001ac50: 7465 2060 6027 706f 7327 6060 2074 6861  te ``'pos'`` tha
+0001ac60: 7420 7374 6f72 6573 2074 6865 0a2f 2f2f  t stores the.///
+0001ac70: 2070 6f73 6974 696f 6e20 6f66 2074 6861   position of tha
+0001ac80: 7420 6e6f 6465 2069 6e20 4575 636c 6964  t node in Euclid
+0001ac90: 6561 6e20 7370 6163 6520 6173 2070 726f  ean space as pro
+0001aca0: 7669 6465 6420 6279 2074 6865 0a2f 2f2f  vided by the.///
+0001acb0: 2060 6070 6f73 6060 206b 6579 776f 7264   ``pos`` keyword
+0001acc0: 2061 7267 756d 656e 7420 6f72 2c20 6966   argument or, if
+0001acd0: 2060 6070 6f73 6060 2077 6173 206e 6f74   ``pos`` was not
+0001ace0: 2070 726f 7669 6465 642c 2061 730a 2f2f   provided, as.//
+0001acf0: 2f20 6765 6e65 7261 7465 6420 6279 2074  / generated by t
+0001ad00: 6869 7320 6675 6e63 7469 6f6e 2e0a 2f2f  his function..//
+0001ad10: 2f0a 2f2f 2f20 3a70 6172 616d 2069 6e74  /./// :param int
+0001ad20: 206e 756d 5f6e 6f64 6573 3a20 5468 6520   num_nodes: The 
+0001ad30: 6e75 6d62 6572 206f 6620 6e6f 6465 7320  number of nodes 
+0001ad40: 746f 2063 7265 6174 6520 696e 2074 6865  to create in the
+0001ad50: 2067 7261 7068 0a2f 2f2f 203a 7061 7261   graph./// :para
+0001ad60: 6d20 666c 6f61 7420 7261 6469 7573 3a20  m float radius: 
+0001ad70: 4469 7374 616e 6365 2074 6872 6573 686f  Distance thresho
+0001ad80: 6c64 2076 616c 7565 0a2f 2f2f 203a 7061  ld value./// :pa
+0001ad90: 7261 6d20 696e 7420 6469 6d3a 2044 696d  ram int dim: Dim
+0001ada0: 656e 7369 6f6e 206f 6620 6e6f 6465 2070  ension of node p
+0001adb0: 6f73 6974 696f 6e73 2e20 4465 6661 756c  ositions. Defaul
+0001adc0: 743a 2032 0a2f 2f2f 203a 7061 7261 6d20  t: 2./// :param 
+0001add0: 6c69 7374 2070 6f73 3a20 4f70 7469 6f6e  list pos: Option
+0001ade0: 616c 206c 6973 7420 7769 7468 206e 6f64  al list with nod
+0001adf0: 6520 706f 7369 7469 6f6e 7320 6173 2076  e positions as v
+0001ae00: 616c 7565 730a 2f2f 2f20 3a70 6172 616d  alues./// :param
+0001ae10: 2066 6c6f 6174 2070 3a20 5768 6963 6820   float p: Which 
+0001ae20: 4d69 6e6b 6f77 736b 6920 6469 7374 616e  Minkowski distan
+0001ae30: 6365 206d 6574 7269 6320 746f 2075 7365  ce metric to use
+0001ae40: 2e20 2060 7060 2068 6173 2074 6f20 6d65  .  `p` has to me
+0001ae50: 6574 2074 6865 2063 6f6e 6469 7469 6f6e  et the condition
+0001ae60: 0a2f 2f2f 2020 2020 2060 6031 203c 3d20  .///     ``1 <= 
+0001ae70: 7020 3c3d 2069 6e66 696e 6974 7960 602e  p <= infinity``.
+0001ae80: 0a2f 2f2f 2020 2020 2049 6620 7468 6973  .///     If this
+0001ae90: 2061 7267 756d 656e 7420 6973 206e 6f74   argument is not
+0001aea0: 2073 7065 6369 6669 6564 2c20 7468 6520   specified, the 
+0001aeb0: 3a6d 6174 683a 604c 5e32 6020 6d65 7472  :math:`L^2` metr
+0001aec0: 6963 0a2f 2f2f 2020 2020 2028 7468 6520  ic.///     (the 
+0001aed0: 4575 636c 6964 6561 6e20 6469 7374 616e  Euclidean distan
+0001aee0: 6365 206d 6574 7269 6329 2c20 7020 3d20  ce metric), p = 
+0001aef0: 3220 6973 2075 7365 642e 0a2f 2f2f 203a  2 is used../// :
+0001af00: 7061 7261 6d20 696e 7420 7365 6564 3a20  param int seed: 
+0001af10: 416e 206f 7074 696f 6e61 6c20 7365 6564  An optional seed
+0001af20: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
+0001af30: 7261 6e64 6f6d 206e 756d 6265 7220 6765  random number ge
+0001af40: 6e65 7261 746f 720a 2f2f 2f0a 2f2f 2f20  nerator.///./// 
+0001af50: 3a72 6574 7572 6e3a 2041 2050 7947 7261  :return: A PyGra
+0001af60: 7068 206f 626a 6563 740a 2f2f 2f20 3a72  ph object./// :r
+0001af70: 7479 7065 3a20 5079 4772 6170 680a 235b  type: PyGraph.#[
+0001af80: 7079 6675 6e63 7469 6f6e 2864 696d 203d  pyfunction(dim =
+0001af90: 2022 3222 2c20 7020 3d20 2232 2e30 2229   "2", p = "2.0")
+0001afa0: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+0001afb0: 7265 203d 2022 286e 756d 5f6e 6f64 6573  re = "(num_nodes
+0001afc0: 2c20 7261 6469 7573 2c20 2f2c 2064 696d  , radius, /, dim
+0001afd0: 3d32 2c20 706f 733d 4e6f 6e65 2c20 703d  =2, pos=None, p=
+0001afe0: 322e 302c 2073 6565 643d 4e6f 6e65 2922  2.0, seed=None)"
+0001aff0: 5d0a 7075 6220 666e 2072 616e 646f 6d5f  ].pub fn random_
+0001b000: 6765 6f6d 6574 7269 635f 6772 6170 6828  geometric_graph(
+0001b010: 0a20 2020 2070 793a 2050 7974 686f 6e2c  .    py: Python,
+0001b020: 0a20 2020 206e 756d 5f6e 6f64 6573 3a20  .    num_nodes: 
+0001b030: 7573 697a 652c 0a20 2020 2072 6164 6975  usize,.    radiu
+0001b040: 733a 2066 3634 2c0a 2020 2020 6469 6d3a  s: f64,.    dim:
+0001b050: 2075 7369 7a65 2c0a 2020 2020 706f 733a   usize,.    pos:
+0001b060: 204f 7074 696f 6e3c 5665 633c 5665 633c   Option<Vec<Vec<
+0001b070: 6636 343e 3e3e 2c0a 2020 2020 703a 2066  f64>>>,.    p: f
+0001b080: 3634 2c0a 2020 2020 7365 6564 3a20 4f70  64,.    seed: Op
+0001b090: 7469 6f6e 3c75 3634 3e2c 0a29 202d 3e20  tion<u64>,.) -> 
+0001b0a0: 5079 5265 7375 6c74 3c67 7261 7068 3a3a  PyResult<graph::
+0001b0b0: 5079 4772 6170 683e 207b 0a20 2020 2069  PyGraph> {.    i
+0001b0c0: 6620 6e75 6d5f 6e6f 6465 7320 3d3d 2030  f num_nodes == 0
+0001b0d0: 207b 0a20 2020 2020 2020 2072 6574 7572   {.        retur
+0001b0e0: 6e20 4572 7228 5079 5661 6c75 6545 7272  n Err(PyValueErr
+0001b0f0: 6f72 3a3a 6e65 775f 6572 7228 226e 756d  or::new_err("num
+0001b100: 5f6e 6f64 6573 206d 7573 7420 6265 203e  _nodes must be >
+0001b110: 2030 2229 293b 0a20 2020 207d 0a0a 2020   0"));.    }..  
+0001b120: 2020 6c65 7420 6d75 7420 696e 6e65 725f    let mut inner_
+0001b130: 6772 6170 6820 3d20 5374 6162 6c65 556e  graph = StableUn
+0001b140: 4772 6170 683a 3a3c 5079 4f62 6a65 6374  Graph::<PyObject
+0001b150: 2c20 5079 4f62 6a65 6374 3e3a 3a64 6566  , PyObject>::def
+0001b160: 6175 6c74 2829 3b0a 0a20 2020 206c 6574  ault();..    let
+0001b170: 2072 6164 6975 735f 7020 3d20 706e 6f72   radius_p = pnor
+0001b180: 6d28 7261 6469 7573 2c20 7029 3b0a 2020  m(radius, p);.  
+0001b190: 2020 6c65 7420 6d75 7420 726e 673a 2050    let mut rng: P
+0001b1a0: 6367 3634 203d 206d 6174 6368 2073 6565  cg64 = match see
+0001b1b0: 6420 7b0a 2020 2020 2020 2020 536f 6d65  d {.        Some
+0001b1c0: 2873 6565 6429 203d 3e20 5063 6736 343a  (seed) => Pcg64:
+0001b1d0: 3a73 6565 645f 6672 6f6d 5f75 3634 2873  :seed_from_u64(s
+0001b1e0: 6565 6429 2c0a 2020 2020 2020 2020 4e6f  eed),.        No
+0001b1f0: 6e65 203d 3e20 5063 6736 343a 3a66 726f  ne => Pcg64::fro
+0001b200: 6d5f 656e 7472 6f70 7928 292c 0a20 2020  m_entropy(),.   
+0001b210: 207d 3b0a 0a20 2020 206c 6574 2064 6973   };..    let dis
+0001b220: 7420 3d20 556e 6966 6f72 6d3a 3a6e 6577  t = Uniform::new
+0001b230: 2830 2e30 2c20 312e 3029 3b0a 2020 2020  (0.0, 1.0);.    
+0001b240: 6c65 7420 706f 7320 3d20 706f 732e 756e  let pos = pos.un
+0001b250: 7772 6170 5f6f 725f 656c 7365 287c 7c20  wrap_or_else(|| 
+0001b260: 7b0a 2020 2020 2020 2020 2830 2e2e 6e75  {.        (0..nu
+0001b270: 6d5f 6e6f 6465 7329 0a20 2020 2020 2020  m_nodes).       
+0001b280: 2020 2020 202e 6d61 7028 7c5f 7c20 2830       .map(|_| (0
+0001b290: 2e2e 6469 6d29 2e6d 6170 287c 5f7c 2064  ..dim).map(|_| d
+0001b2a0: 6973 742e 7361 6d70 6c65 2826 6d75 7420  ist.sample(&mut 
+0001b2b0: 726e 6729 292e 636f 6c6c 6563 7428 2929  rng)).collect())
+0001b2c0: 0a20 2020 2020 2020 2020 2020 202e 636f  .            .co
+0001b2d0: 6c6c 6563 7428 290a 2020 2020 7d29 3b0a  llect().    });.
+0001b2e0: 0a20 2020 2069 6620 6e75 6d5f 6e6f 6465  .    if num_node
+0001b2f0: 7320 213d 2070 6f73 2e6c 656e 2829 207b  s != pos.len() {
+0001b300: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b310: 4572 7228 5079 5661 6c75 6545 7272 6f72  Err(PyValueError
+0001b320: 3a3a 6e65 775f 6572 7228 0a20 2020 2020  ::new_err(.     
+0001b330: 2020 2020 2020 2022 6e75 6d62 6572 206f         "number o
+0001b340: 6620 656c 656d 656e 7473 2069 6e20 706f  f elements in po
+0001b350: 7320 616e 6420 6e75 6d5f 6e6f 6465 7320  s and num_nodes 
+0001b360: 6d75 7374 2062 6520 6571 7561 6c22 2c0a  must be equal",.
+0001b370: 2020 2020 2020 2020 2929 3b0a 2020 2020          ));.    
+0001b380: 7d0a 0a20 2020 2066 6f72 2070 7661 6c20  }..    for pval 
+0001b390: 696e 2070 6f73 2e69 7465 7228 2920 7b0a  in pos.iter() {.
+0001b3a0: 2020 2020 2020 2020 6c65 7420 706f 735f          let pos_
+0001b3b0: 6469 6374 203d 2050 7944 6963 743a 3a6e  dict = PyDict::n
+0001b3c0: 6577 2870 7929 3b0a 2020 2020 2020 2020  ew(py);.        
+0001b3d0: 706f 735f 6469 6374 2e73 6574 5f69 7465  pos_dict.set_ite
+0001b3e0: 6d28 2270 6f73 222c 2070 7661 6c2e 746f  m("pos", pval.to
+0001b3f0: 5f6f 626a 6563 7428 7079 2929 3f3b 0a0a  _object(py))?;..
+0001b400: 2020 2020 2020 2020 696e 6e65 725f 6772          inner_gr
+0001b410: 6170 682e 6164 645f 6e6f 6465 2870 6f73  aph.add_node(pos
+0001b420: 5f64 6963 742e 696e 746f 2829 293b 0a20  _dict.into());. 
+0001b430: 2020 207d 0a0a 2020 2020 666f 7220 7520     }..    for u 
+0001b440: 696e 2030 2e2e 286e 756d 5f6e 6f64 6573  in 0..(num_nodes
+0001b450: 202d 2031 2920 7b0a 2020 2020 2020 2020   - 1) {.        
+0001b460: 666f 7220 7620 696e 2028 7520 2b20 3129  for v in (u + 1)
+0001b470: 2e2e 6e75 6d5f 6e6f 6465 7320 7b0a 2020  ..num_nodes {.  
+0001b480: 2020 2020 2020 2020 2020 6966 2064 6973            if dis
+0001b490: 7461 6e63 6528 2670 6f73 5b75 5d2c 2026  tance(&pos[u], &
+0001b4a0: 706f 735b 765d 2c20 7029 203c 2072 6164  pos[v], p) < rad
+0001b4b0: 6975 735f 7020 7b0a 2020 2020 2020 2020  ius_p {.        
+0001b4c0: 2020 2020 2020 2020 696e 6e65 725f 6772          inner_gr
+0001b4d0: 6170 682e 6164 645f 6564 6765 280a 2020  aph.add_edge(.  
+0001b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4f0: 2020 4e6f 6465 496e 6465 783a 3a6e 6577    NodeIndex::new
+0001b500: 2875 292c 0a20 2020 2020 2020 2020 2020  (u),.           
+0001b510: 2020 2020 2020 2020 204e 6f64 6549 6e64           NodeInd
+0001b520: 6578 3a3a 6e65 7728 7629 2c0a 2020 2020  ex::new(v),.    
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b540: 7079 2e4e 6f6e 6528 292c 0a20 2020 2020  py.None(),.     
+0001b550: 2020 2020 2020 2020 2020 2029 3b0a 2020             );.  
+0001b560: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0001b570: 2020 2020 7d0a 2020 2020 7d0a 0a20 2020      }.    }..   
+0001b580: 206c 6574 2067 7261 7068 203d 2067 7261   let graph = gra
+0001b590: 7068 3a3a 5079 4772 6170 6820 7b0a 2020  ph::PyGraph {.  
+0001b5a0: 2020 2020 2020 6772 6170 683a 2069 6e6e        graph: inn
+0001b5b0: 6572 5f67 7261 7068 2c0a 2020 2020 2020  er_graph,.      
+0001b5c0: 2020 6e6f 6465 5f72 656d 6f76 6564 3a20    node_removed: 
+0001b5d0: 6661 6c73 652c 0a20 2020 2020 2020 206d  false,.        m
+0001b5e0: 756c 7469 6772 6170 683a 2074 7275 652c  ultigraph: true,
+0001b5f0: 0a20 2020 207d 3b0a 2020 2020 4f6b 2867  .    };.    Ok(g
+0001b600: 7261 7068 290a 7d0a 0a2f 2f2f 2052 6574  raph).}../// Ret
+0001b610: 7572 6e20 6120 6c69 7374 206f 6620 6379  urn a list of cy
+0001b620: 636c 6573 2077 6869 6368 2066 6f72 6d20  cles which form 
+0001b630: 6120 6261 7369 7320 666f 7220 6379 636c  a basis for cycl
+0001b640: 6573 206f 6620 6120 6769 7665 6e20 5079  es of a given Py
+0001b650: 4772 6170 680a 2f2f 2f0a 2f2f 2f20 4120  Graph.///./// A 
+0001b660: 6261 7369 7320 666f 7220 6379 636c 6573  basis for cycles
+0001b670: 206f 6620 6120 6772 6170 6820 6973 2061   of a graph is a
+0001b680: 206d 696e 696d 616c 2063 6f6c 6c65 6374   minimal collect
+0001b690: 696f 6e20 6f66 0a2f 2f2f 2063 7963 6c65  ion of./// cycle
+0001b6a0: 7320 7375 6368 2074 6861 7420 616e 7920  s such that any 
+0001b6b0: 6379 636c 6520 696e 2074 6865 2067 7261  cycle in the gra
+0001b6c0: 7068 2063 616e 2062 6520 7772 6974 7465  ph can be writte
+0001b6d0: 6e0a 2f2f 2f20 6173 2061 2073 756d 206f  n./// as a sum o
+0001b6e0: 6620 6379 636c 6573 2069 6e20 7468 6520  f cycles in the 
+0001b6f0: 6261 7369 732e 2020 4865 7265 2073 756d  basis.  Here sum
+0001b700: 6d61 7469 6f6e 206f 6620 6379 636c 6573  mation of cycles
+0001b710: 0a2f 2f2f 2069 7320 6465 6669 6e65 6420  ./// is defined 
+0001b720: 6173 2074 6865 2065 7863 6c75 7369 7665  as the exclusive
+0001b730: 206f 7220 6f66 2074 6865 2065 6467 6573   or of the edges
+0001b740: 2e0a 2f2f 2f0a 2f2f 2f20 5468 6973 2069  ..///./// This i
+0001b750: 7320 6164 6170 7465 6420 6672 6f6d 2061  s adapted from a
+0001b760: 6c67 6f72 6974 686d 2043 4143 4d20 3439  lgorithm CACM 49
+0001b770: 3120 5b31 5d5f 2e0a 2f2f 2f0a 2f2f 2f20  1 [1]_..///./// 
+0001b780: 3a70 6172 616d 2050 7947 7261 7068 2067  :param PyGraph g
+0001b790: 7261 7068 3a20 5468 6520 6772 6170 6820  raph: The graph 
+0001b7a0: 746f 2066 696e 6420 7468 6520 6379 636c  to find the cycl
+0001b7b0: 6520 6261 7369 7320 696e 0a2f 2f2f 203a  e basis in./// :
+0001b7c0: 7061 7261 6d20 696e 7420 726f 6f74 3a20  param int root: 
+0001b7d0: 4f70 7469 6f6e 616c 2069 6e64 6578 2066  Optional index f
+0001b7e0: 6f72 2073 7461 7274 696e 6720 6e6f 6465  or starting node
+0001b7f0: 2066 6f72 2062 6173 6973 0a2f 2f2f 0a2f   for basis.///./
+0001b800: 2f2f 203a 7265 7475 726e 733a 2041 206c  // :returns: A l
+0001b810: 6973 7420 6f66 2063 7963 6c65 206c 6973  ist of cycle lis
+0001b820: 7473 2e20 4561 6368 206c 6973 7420 6973  ts. Each list is
+0001b830: 2061 206c 6973 7420 6f66 206e 6f64 6520   a list of node 
+0001b840: 6964 7320 7768 6963 680a 2f2f 2f20 2020  ids which.///   
+0001b850: 2020 666f 726d 7320 6120 6379 636c 6520    forms a cycle 
+0001b860: 286c 6f6f 7029 2069 6e20 7468 6520 696e  (loop) in the in
+0001b870: 7075 7420 6772 6170 680a 2f2f 2f20 3a72  put graph./// :r
+0001b880: 7479 7065 3a20 6c69 7374 0a2f 2f2f 0a2f  type: list.///./
+0001b890: 2f2f 202e 2e20 5b31 5d20 5061 746f 6e2c  // .. [1] Paton,
+0001b8a0: 204b 2e20 416e 2061 6c67 6f72 6974 686d   K. An algorithm
+0001b8b0: 2066 6f72 2066 696e 6469 6e67 2061 2066   for finding a f
+0001b8c0: 756e 6461 6d65 6e74 616c 2073 6574 206f  undamental set o
+0001b8d0: 660a 2f2f 2f20 2020 2063 7963 6c65 7320  f.///    cycles 
+0001b8e0: 6f66 2061 2067 7261 7068 2e20 436f 6d6d  of a graph. Comm
+0001b8f0: 2e20 4143 4d20 3132 2c20 3920 2853 6570  . ACM 12, 9 (Sep
+0001b900: 7420 3139 3639 292c 2035 3134 2d35 3138  t 1969), 514-518
+0001b910: 2e0a 235b 7079 6675 6e63 7469 6f6e 5d0a  ..#[pyfunction].
+0001b920: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
+0001b930: 203d 2022 2867 7261 7068 2c20 2f2c 2072   = "(graph, /, r
+0001b940: 6f6f 743d 4e6f 6e65 2922 5d0a 7075 6220  oot=None)"].pub 
+0001b950: 666e 2063 7963 6c65 5f62 6173 6973 280a  fn cycle_basis(.
+0001b960: 2020 2020 6772 6170 683a 2026 6772 6170      graph: &grap
+0001b970: 683a 3a50 7947 7261 7068 2c0a 2020 2020  h::PyGraph,.    
+0001b980: 726f 6f74 3a20 4f70 7469 6f6e 3c75 7369  root: Option<usi
+0001b990: 7a65 3e2c 0a29 202d 3e20 5665 633c 5665  ze>,.) -> Vec<Ve
+0001b9a0: 633c 7573 697a 653e 3e20 7b0a 2020 2020  c<usize>> {.    
+0001b9b0: 6c65 7420 6d75 7420 726f 6f74 5f6e 6f64  let mut root_nod
+0001b9c0: 6520 3d20 726f 6f74 3b0a 2020 2020 6c65  e = root;.    le
+0001b9d0: 7420 6d75 7420 6772 6170 685f 6e6f 6465  t mut graph_node
+0001b9e0: 733a 2048 6173 6853 6574 3c4e 6f64 6549  s: HashSet<NodeI
+0001b9f0: 6e64 6578 3e20 3d0a 2020 2020 2020 2020  ndex> =.        
+0001ba00: 6772 6170 682e 6772 6170 682e 6e6f 6465  graph.graph.node
+0001ba10: 5f69 6e64 6963 6573 2829 2e63 6f6c 6c65  _indices().colle
+0001ba20: 6374 2829 3b0a 2020 2020 6c65 7420 6d75  ct();.    let mu
+0001ba30: 7420 6379 636c 6573 3a20 5665 633c 5665  t cycles: Vec<Ve
+0001ba40: 633c 7573 697a 653e 3e20 3d20 5665 633a  c<usize>> = Vec:
+0001ba50: 3a6e 6577 2829 3b0a 2020 2020 7768 696c  :new();.    whil
+0001ba60: 6520 2167 7261 7068 5f6e 6f64 6573 2e69  e !graph_nodes.i
+0001ba70: 735f 656d 7074 7928 2920 7b0a 2020 2020  s_empty() {.    
+0001ba80: 2020 2020 6c65 7420 7465 6d70 5f76 616c      let temp_val
+0001ba90: 7565 3a20 4e6f 6465 496e 6465 783b 0a20  ue: NodeIndex;. 
+0001baa0: 2020 2020 2020 202f 2f20 4966 2072 6f6f         // If roo
+0001bab0: 745f 6e6f 6465 2069 7320 6e6f 7420 7365  t_node is not se
+0001bac0: 7420 6765 7420 616e 2061 7262 6974 7261  t get an arbitra
+0001bad0: 7279 206e 6f64 6520 6672 6f6d 2074 6865  ry node from the
+0001bae0: 2073 6574 206f 6620 6772 6170 680a 2020   set of graph.  
+0001baf0: 2020 2020 2020 2f2f 206e 6f64 6573 2077        // nodes w
+0001bb00: 6527 7665 206e 6f74 2022 6578 616d 696e  e've not "examin
+0001bb10: 6564 220a 2020 2020 2020 2020 6c65 7420  ed".        let 
+0001bb20: 726f 6f74 5f69 6e64 6578 203d 206d 6174  root_index = mat
+0001bb30: 6368 2072 6f6f 745f 6e6f 6465 207b 0a20  ch root_node {. 
+0001bb40: 2020 2020 2020 2020 2020 2053 6f6d 6528             Some(
+0001bb50: 726f 6f74 5f76 616c 7565 2920 3d3e 204e  root_value) => N
+0001bb60: 6f64 6549 6e64 6578 3a3a 6e65 7728 726f  odeIndex::new(ro
+0001bb70: 6f74 5f76 616c 7565 292c 0a20 2020 2020  ot_value),.     
+0001bb80: 2020 2020 2020 204e 6f6e 6520 3d3e 207b         None => {
+0001bb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bba0: 2074 656d 705f 7661 6c75 6520 3d20 2a67   temp_value = *g
+0001bbb0: 7261 7068 5f6e 6f64 6573 2e69 7465 7228  raph_nodes.iter(
+0001bbc0: 292e 6e65 7874 2829 2e75 6e77 7261 7028  ).next().unwrap(
+0001bbd0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
+0001bbe0: 2020 2067 7261 7068 5f6e 6f64 6573 2e72     graph_nodes.r
+0001bbf0: 656d 6f76 6528 2674 656d 705f 7661 6c75  emove(&temp_valu
+0001bc00: 6529 3b0a 2020 2020 2020 2020 2020 2020  e);.            
+0001bc10: 2020 2020 7465 6d70 5f76 616c 7565 0a20      temp_value. 
+0001bc20: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001bc30: 2020 2020 207d 3b0a 2020 2020 2020 2020       };.        
+0001bc40: 2f2f 2053 7461 636b 2028 6965 2022 7075  // Stack (ie "pu
+0001bc50: 7368 646f 776e 206c 6973 7422 2920 6f66  shdown list") of
+0001bc60: 2076 6572 7469 6365 7320 616c 7265 6164   vertices alread
+0001bc70: 7920 696e 2074 6865 2073 7061 6e6e 696e  y in the spannin
+0001bc80: 6720 7472 6565 0a20 2020 2020 2020 206c  g tree.        l
+0001bc90: 6574 206d 7574 2073 7461 636b 3a20 5665  et mut stack: Ve
+0001bca0: 633c 4e6f 6465 496e 6465 783e 203d 2076  c<NodeIndex> = v
+0001bcb0: 6563 215b 726f 6f74 5f69 6e64 6578 5d3b  ec![root_index];
+0001bcc0: 0a20 2020 2020 2020 202f 2f20 4d61 7020  .        // Map 
+0001bcd0: 6f66 206e 6f64 6520 696e 6465 7820 746f  of node index to
+0001bce0: 2070 7265 6465 6365 7373 6f72 206e 6f64   predecessor nod
+0001bcf0: 6520 696e 6465 780a 2020 2020 2020 2020  e index.        
+0001bd00: 6c65 7420 6d75 7420 7072 6564 3a20 4861  let mut pred: Ha
+0001bd10: 7368 4d61 703c 4e6f 6465 496e 6465 782c  shMap<NodeIndex,
+0001bd20: 204e 6f64 6549 6e64 6578 3e20 3d20 4861   NodeIndex> = Ha
+0001bd30: 7368 4d61 703a 3a6e 6577 2829 3b0a 2020  shMap::new();.  
+0001bd40: 2020 2020 2020 7072 6564 2e69 6e73 6572        pred.inser
+0001bd50: 7428 726f 6f74 5f69 6e64 6578 2c20 726f  t(root_index, ro
+0001bd60: 6f74 5f69 6e64 6578 293b 0a20 2020 2020  ot_index);.     
+0001bd70: 2020 202f 2f20 5365 7420 6f66 2065 7861     // Set of exa
+0001bd80: 6d69 6e65 6420 6e6f 6465 7320 6475 7269  mined nodes duri
+0001bd90: 6e67 2074 6869 7320 6974 6572 6174 696f  ng this iteratio
+0001bda0: 6e0a 2020 2020 2020 2020 6c65 7420 6d75  n.        let mu
+0001bdb0: 7420 7573 6564 3a20 4861 7368 4d61 703c  t used: HashMap<
+0001bdc0: 4e6f 6465 496e 6465 782c 2048 6173 6853  NodeIndex, HashS
+0001bdd0: 6574 3c4e 6f64 6549 6e64 6578 3e3e 203d  et<NodeIndex>> =
+0001bde0: 2048 6173 684d 6170 3a3a 6e65 7728 293b   HashMap::new();
+0001bdf0: 0a20 2020 2020 2020 2075 7365 642e 696e  .        used.in
+0001be00: 7365 7274 2872 6f6f 745f 696e 6465 782c  sert(root_index,
+0001be10: 2048 6173 6853 6574 3a3a 6e65 7728 2929   HashSet::new())
+0001be20: 3b0a 2020 2020 2020 2020 2f2f 2057 616c  ;.        // Wal
+0001be30: 6b20 7468 6520 7370 616e 6e69 6e67 2074  k the spanning t
+0001be40: 7265 650a 2020 2020 2020 2020 7768 696c  ree.        whil
+0001be50: 6520 2173 7461 636b 2e69 735f 656d 7074  e !stack.is_empt
+0001be60: 7928 2920 7b0a 2020 2020 2020 2020 2020  y() {.          
+0001be70: 2020 2f2f 2055 7365 2074 6865 206c 6173    // Use the las
+0001be80: 7420 656c 656d 656e 7420 6164 6465 6420  t element added 
+0001be90: 736f 2074 6861 7420 6379 636c 6573 2061  so that cycles a
+0001bea0: 7265 2065 6173 6965 7220 746f 2066 696e  re easier to fin
+0001beb0: 640a 2020 2020 2020 2020 2020 2020 6c65  d.            le
+0001bec0: 7420 7a20 3d20 7374 6163 6b2e 706f 7028  t z = stack.pop(
+0001bed0: 292e 756e 7772 6170 2829 3b0a 2020 2020  ).unwrap();.    
+0001bee0: 2020 2020 2020 2020 666f 7220 6e65 6967          for neig
+0001bef0: 6862 6f72 2069 6e20 6772 6170 682e 6772  hbor in graph.gr
+0001bf00: 6170 682e 6e65 6967 6862 6f72 7328 7a29  aph.neighbors(z)
+0001bf10: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001bf20: 2020 202f 2f20 4120 6e65 7720 6e6f 6465     // A new node
+0001bf30: 2077 6173 2065 6e63 6f75 6e74 6572 6564   was encountered
+0001bf40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001bf50: 2020 6966 2021 7573 6564 2e63 6f6e 7461    if !used.conta
+0001bf60: 696e 735f 6b65 7928 266e 6569 6768 626f  ins_key(&neighbo
+0001bf70: 7229 207b 0a20 2020 2020 2020 2020 2020  r) {.           
+0001bf80: 2020 2020 2020 2020 2070 7265 642e 696e           pred.in
+0001bf90: 7365 7274 286e 6569 6768 626f 722c 207a  sert(neighbor, z
+0001bfa0: 293b 0a20 2020 2020 2020 2020 2020 2020  );.             
+0001bfb0: 2020 2020 2020 2073 7461 636b 2e70 7573         stack.pus
+0001bfc0: 6828 6e65 6967 6862 6f72 293b 0a20 2020  h(neighbor);.   
+0001bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfe0: 206c 6574 206d 7574 2074 656d 705f 7365   let mut temp_se
+0001bff0: 743a 2048 6173 6853 6574 3c4e 6f64 6549  t: HashSet<NodeI
+0001c000: 6e64 6578 3e20 3d20 4861 7368 5365 743a  ndex> = HashSet:
+0001c010: 3a6e 6577 2829 3b0a 2020 2020 2020 2020  :new();.        
+0001c020: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+0001c030: 5f73 6574 2e69 6e73 6572 7428 7a29 3b0a  _set.insert(z);.
+0001c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c050: 2020 2020 7573 6564 2e69 6e73 6572 7428      used.insert(
+0001c060: 6e65 6967 6862 6f72 2c20 7465 6d70 5f73  neighbor, temp_s
+0001c070: 6574 293b 0a20 2020 2020 2020 2020 2020  et);.           
+0001c080: 2020 2020 202f 2f20 4120 7365 6c66 206c       // A self l
+0001c090: 6f6f 703a 0a20 2020 2020 2020 2020 2020  oop:.           
+0001c0a0: 2020 2020 207d 2065 6c73 6520 6966 207a       } else if z
+0001c0b0: 203d 3d20 6e65 6967 6862 6f72 207b 0a20   == neighbor {. 
+0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0d0: 2020 206c 6574 2063 7963 6c65 3a20 5665     let cycle: Ve
+0001c0e0: 633c 7573 697a 653e 203d 2076 6563 215b  c<usize> = vec![
+0001c0f0: 7a2e 696e 6465 7828 295d 3b0a 2020 2020  z.index()];.    
+0001c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c110: 6379 636c 6573 2e70 7573 6828 6379 636c  cycles.push(cycl
+0001c120: 6529 3b0a 2020 2020 2020 2020 2020 2020  e);.            
+0001c130: 2020 2020 2f2f 2041 2063 7963 6c65 2077      // A cycle w
+0001c140: 6173 2066 6f75 6e64 3a0a 2020 2020 2020  as found:.      
+0001c150: 2020 2020 2020 2020 2020 7d20 656c 7365            } else
+0001c160: 2069 6620 2175 7365 642e 6765 7428 267a   if !used.get(&z
+0001c170: 292e 756e 7772 6170 2829 2e63 6f6e 7461  ).unwrap().conta
+0001c180: 696e 7328 266e 6569 6768 626f 7229 207b  ins(&neighbor) {
+0001c190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c1a0: 2020 2020 206c 6574 2070 6e20 3d20 7573       let pn = us
+0001c1b0: 6564 2e67 6574 2826 6e65 6967 6862 6f72  ed.get(&neighbor
+0001c1c0: 292e 756e 7772 6170 2829 3b0a 2020 2020  ).unwrap();.    
+0001c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1e0: 6c65 7420 6d75 7420 6379 636c 653a 2056  let mut cycle: V
+0001c1f0: 6563 3c4e 6f64 6549 6e64 6578 3e20 3d20  ec<NodeIndex> = 
+0001c200: 7665 6321 5b6e 6569 6768 626f 722c 207a  vec![neighbor, z
+0001c210: 5d3b 0a20 2020 2020 2020 2020 2020 2020  ];.             
+0001c220: 2020 2020 2020 206c 6574 206d 7574 2070         let mut p
+0001c230: 203d 2070 7265 642e 6765 7428 267a 292e   = pred.get(&z).
+0001c240: 756e 7772 6170 2829 3b0a 2020 2020 2020  unwrap();.      
+0001c250: 2020 2020 2020 2020 2020 2020 2020 7768                wh
+0001c260: 696c 6520 2170 6e2e 636f 6e74 6169 6e73  ile !pn.contains
+0001c270: 2870 2920 7b0a 2020 2020 2020 2020 2020  (p) {.          
+0001c280: 2020 2020 2020 2020 2020 2020 2020 6379                cy
+0001c290: 636c 652e 7075 7368 282a 7029 3b0a 2020  cle.push(*p);.  
+0001c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2b0: 2020 2020 2020 7020 3d20 7072 6564 2e67        p = pred.g
+0001c2c0: 6574 2870 292e 756e 7772 6170 2829 3b0a  et(p).unwrap();.
+0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2e0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0001c2f0: 2020 2020 2020 2020 2020 6379 636c 652e            cycle.
+0001c300: 7075 7368 282a 7029 3b0a 2020 2020 2020  push(*p);.      
+0001c310: 2020 2020 2020 2020 2020 2020 2020 6379                cy
+0001c320: 636c 6573 2e70 7573 6828 6379 636c 652e  cles.push(cycle.
+0001c330: 6974 6572 2829 2e6d 6170 287c 787c 2078  iter().map(|x| x
+0001c340: 2e69 6e64 6578 2829 292e 636f 6c6c 6563  .index()).collec
+0001c350: 7428 2929 3b0a 2020 2020 2020 2020 2020  t());.          
+0001c360: 2020 2020 2020 2020 2020 6c65 7420 6e65            let ne
+0001c370: 6967 6862 6f72 5f73 6574 203d 2075 7365  ighbor_set = use
+0001c380: 642e 6765 745f 6d75 7428 266e 6569 6768  d.get_mut(&neigh
+0001c390: 626f 7229 2e75 6e77 7261 7028 293b 0a20  bor).unwrap();. 
+0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3b0: 2020 206e 6569 6768 626f 725f 7365 742e     neighbor_set.
+0001c3c0: 696e 7365 7274 287a 293b 0a20 2020 2020  insert(z);.     
+0001c3d0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001c3e0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0001c3f0: 2020 207d 0a20 2020 2020 2020 206c 6574     }.        let
+0001c400: 206d 7574 2074 656d 705f 6861 7368 7365   mut temp_hashse
+0001c410: 743a 2048 6173 6853 6574 3c4e 6f64 6549  t: HashSet<NodeI
+0001c420: 6e64 6578 3e20 3d20 4861 7368 5365 743a  ndex> = HashSet:
+0001c430: 3a6e 6577 2829 3b0a 2020 2020 2020 2020  :new();.        
+0001c440: 666f 7220 6b65 7920 696e 2070 7265 642e  for key in pred.
+0001c450: 6b65 7973 2829 207b 0a20 2020 2020 2020  keys() {.       
+0001c460: 2020 2020 2074 656d 705f 6861 7368 7365       temp_hashse
+0001c470: 742e 696e 7365 7274 282a 6b65 7929 3b0a  t.insert(*key);.
+0001c480: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0001c490: 2020 6772 6170 685f 6e6f 6465 7320 3d20    graph_nodes = 
+0001c4a0: 6772 6170 685f 6e6f 6465 732e 6469 6666  graph_nodes.diff
+0001c4b0: 6572 656e 6365 2826 7465 6d70 5f68 6173  erence(&temp_has
+0001c4c0: 6873 6574 292e 636f 7069 6564 2829 2e63  hset).copied().c
+0001c4d0: 6f6c 6c65 6374 2829 3b0a 2020 2020 2020  ollect();.      
+0001c4e0: 2020 726f 6f74 5f6e 6f64 6520 3d20 4e6f    root_node = No
+0001c4f0: 6e65 3b0a 2020 2020 7d0a 2020 2020 6379  ne;.    }.    cy
+0001c500: 636c 6573 0a7d 0a0a 2f2f 2f20 436f 6d70  cles.}../// Comp
+0001c510: 7574 6520 6120 6d61 7869 6d75 6d2d 7765  ute a maximum-we
+0001c520: 6967 6874 6564 206d 6174 6368 696e 6720  ighted matching 
+0001c530: 666f 7220 6120 3a63 6c61 7373 3a60 7e72  for a :class:`~r
+0001c540: 6574 776f 726b 782e 5079 4772 6170 6860  etworkx.PyGraph`
+0001c550: 0a2f 2f2f 0a2f 2f2f 2041 206d 6174 6368  .///./// A match
+0001c560: 696e 6720 6973 2061 2073 7562 7365 7420  ing is a subset 
+0001c570: 6f66 2065 6467 6573 2069 6e20 7768 6963  of edges in whic
+0001c580: 6820 6e6f 206e 6f64 6520 6f63 6375 7273  h no node occurs
+0001c590: 206d 6f72 6520 7468 616e 206f 6e63 652e   more than once.
+0001c5a0: 0a2f 2f2f 2054 6865 2077 6569 6768 7420  ./// The weight 
+0001c5b0: 6f66 2061 206d 6174 6368 696e 6720 6973  of a matching is
+0001c5c0: 2074 6865 2073 756d 206f 6620 7468 6520   the sum of the 
+0001c5d0: 7765 6967 6874 7320 6f66 2069 7473 2065  weights of its e
+0001c5e0: 6467 6573 2e0a 2f2f 2f20 4120 6d61 7869  dges../// A maxi
+0001c5f0: 6d61 6c20 6d61 7463 6869 6e67 2063 616e  mal matching can
+0001c600: 6e6f 7420 6164 6420 6d6f 7265 2065 6467  not add more edg
+0001c610: 6573 2061 6e64 2073 7469 6c6c 2062 6520  es and still be 
+0001c620: 6120 6d61 7463 6869 6e67 2e0a 2f2f 2f20  a matching../// 
+0001c630: 5468 6520 6361 7264 696e 616c 6974 7920  The cardinality 
+0001c640: 6f66 2061 206d 6174 6368 696e 6720 6973  of a matching is
+0001c650: 2074 6865 206e 756d 6265 7220 6f66 206d   the number of m
+0001c660: 6174 6368 6564 2065 6467 6573 2e0a 2f2f  atched edges..//
+0001c670: 2f0a 2f2f 2f20 5468 6973 2066 756e 6374  /./// This funct
+0001c680: 696f 6e20 7461 6b65 7320 7469 6d65 203a  ion takes time :
+0001c690: 6d61 7468 3a60 4f28 6e5e 3329 6020 7768  math:`O(n^3)` wh
+0001c6a0: 6572 6520 6060 6e60 6020 6973 2074 6865  ere ``n`` is the
+0001c6b0: 206e 756d 6265 7220 6f66 206e 6f64 6573   number of nodes
+0001c6c0: 0a2f 2f2f 2069 6e20 7468 6520 6772 6170  ./// in the grap
+0001c6d0: 682e 0a2f 2f2f 0a2f 2f2f 2054 6869 7320  h..///./// This 
+0001c6e0: 6d65 7468 6f64 2069 7320 6261 7365 6420  method is based 
+0001c6f0: 6f6e 2074 6865 2022 626c 6f73 736f 6d22  on the "blossom"
+0001c700: 206d 6574 686f 6420 666f 7220 6669 6e64   method for find
+0001c710: 696e 6720 6175 676d 656e 7469 6e67 0a2f  ing augmenting./
+0001c720: 2f2f 2070 6174 6873 2061 6e64 2074 6865  // paths and the
+0001c730: 2022 7072 696d 616c 2d64 7561 6c22 206d   "primal-dual" m
+0001c740: 6574 686f 6420 666f 7220 6669 6e64 696e  ethod for findin
+0001c750: 6720 6120 6d61 7463 6869 6e67 206f 6620  g a matching of 
+0001c760: 6d61 7869 6d75 6d0a 2f2f 2f20 7765 6967  maximum./// weig
+0001c770: 6874 2c20 626f 7468 206d 6574 686f 6473  ht, both methods
+0001c780: 2069 6e76 656e 7465 6420 6279 204a 6163   invented by Jac
+0001c790: 6b20 4564 6d6f 6e64 7320 5b31 5d5f 2e0a  k Edmonds [1]_..
+0001c7a0: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+0001c7b0: 7947 7261 7068 2067 7261 7068 3a20 5468  yGraph graph: Th
+0001c7c0: 6520 756e 6469 7265 6374 6564 2067 7261  e undirected gra
+0001c7d0: 7068 2074 6f20 636f 6d70 7574 6520 7468  ph to compute th
+0001c7e0: 6520 6d61 7820 7765 6967 6874 0a2f 2f2f  e max weight.///
+0001c7f0: 2020 2020 206d 6174 6368 696e 6720 666f       matching fo
+0001c800: 722e 2045 7870 6563 7473 2074 6f20 6861  r. Expects to ha
+0001c810: 7665 206e 6f20 7061 7261 6c6c 656c 2065  ve no parallel e
+0001c820: 6467 6573 2028 6d75 6c74 6967 7261 7068  dges (multigraph
+0001c830: 7320 6172 650a 2f2f 2f20 2020 2020 756e  s are.///     un
+0001c840: 7465 7374 6564 2063 7572 7265 6e74 6c79  tested currently
+0001c850: 292e 0a2f 2f2f 203a 7061 7261 6d20 626f  )../// :param bo
+0001c860: 6f6c 206d 6178 5f63 6172 6469 6e61 6c69  ol max_cardinali
+0001c870: 7479 3a20 4966 2054 7275 652c 2063 6f6d  ty: If True, com
+0001c880: 7075 7465 2074 6865 206d 6178 696d 756d  pute the maximum
+0001c890: 2d63 6172 6469 6e61 6c69 7479 0a2f 2f2f  -cardinality.///
+0001c8a0: 2020 2020 206d 6174 6368 696e 6720 7769       matching wi
+0001c8b0: 7468 206d 6178 696d 756d 2077 6569 6768  th maximum weigh
+0001c8c0: 7420 616d 6f6e 6720 616c 6c20 6d61 7869  t among all maxi
+0001c8d0: 6d75 6d2d 6361 7264 696e 616c 6974 7920  mum-cardinality 
+0001c8e0: 6d61 7463 6869 6e67 732e 0a2f 2f2f 2020  matchings..///  
+0001c8f0: 2020 2044 6566 6175 6c74 7320 4661 6c73     Defaults Fals
+0001c900: 652e 0a2f 2f2f 203a 7061 7261 6d20 6361  e../// :param ca
+0001c910: 6c6c 6162 6c65 2077 6569 6768 745f 666e  llable weight_fn
+0001c920: 3a20 416e 206f 7074 696f 6e61 6c20 6361  : An optional ca
+0001c930: 6c6c 6162 6c65 2074 6861 7420 7769 6c6c  llable that will
+0001c940: 2062 6520 7061 7373 6564 2061 0a2f 2f2f   be passed a.///
+0001c950: 2020 2020 2073 696e 676c 6520 6172 6775       single argu
+0001c960: 6d65 6e74 2074 6865 2065 6467 6520 6f62  ment the edge ob
+0001c970: 6a65 6374 2066 6f72 2065 6163 6820 6564  ject for each ed
+0001c980: 6765 2069 6e20 7468 6520 6772 6170 682e  ge in the graph.
+0001c990: 2049 7420 6973 0a2f 2f2f 2020 2020 2065   It is.///     e
+0001c9a0: 7870 6563 7465 6420 746f 2072 6574 7572  xpected to retur
+0001c9b0: 6e20 616e 2060 6069 6e74 6060 2077 6569  n an ``int`` wei
+0001c9c0: 6768 7420 666f 7220 7468 6174 2065 6467  ght for that edg
+0001c9d0: 652e 2046 6f72 2065 7861 6d70 6c65 2c0a  e. For example,.
+0001c9e0: 2f2f 2f20 2020 2020 6966 2074 6865 2077  ///     if the w
+0001c9f0: 6569 6768 7473 2061 7265 2061 6c6c 2069  eights are all i
+0001ca00: 6e74 6567 6572 7320 796f 7520 6361 6e20  ntegers you can 
+0001ca10: 7573 653a 2060 606c 616d 6264 6120 783a  use: ``lambda x:
+0001ca20: 2078 6060 2e20 4966 206e 6f74 0a2f 2f2f   x``. If not.///
+0001ca30: 2020 2020 2073 7065 6369 6669 6564 2074       specified t
+0001ca40: 6865 2076 616c 7565 2066 6f72 2060 6064  he value for ``d
+0001ca50: 6566 6175 6c74 5f77 6569 6768 7460 6020  efault_weight`` 
+0001ca60: 7769 6c6c 2062 6520 7573 6564 2066 6f72  will be used for
+0001ca70: 2061 6c6c 0a2f 2f2f 2020 2020 2065 6467   all.///     edg
+0001ca80: 6520 7765 6967 6874 732e 0a2f 2f2f 203a  e weights../// :
+0001ca90: 7061 7261 6d20 696e 7420 6465 6661 756c  param int defaul
+0001caa0: 745f 7765 6967 6874 3a20 5468 6520 6060  t_weight: The ``
+0001cab0: 696e 7460 6020 7661 6c75 6520 746f 2075  int`` value to u
+0001cac0: 7365 2066 6f72 2061 6c6c 2065 6467 6520  se for all edge 
+0001cad0: 7765 6967 6874 730a 2f2f 2f20 2020 2020  weights.///     
+0001cae0: 696e 2074 6865 2067 7261 7068 2069 6620  in the graph if 
+0001caf0: 6060 7765 6967 6874 5f66 6e60 6020 6973  ``weight_fn`` is
+0001cb00: 206e 6f74 2073 7065 6369 6669 6564 2e20   not specified. 
+0001cb10: 4465 6661 756c 7473 2074 6f20 6060 3160  Defaults to ``1`
+0001cb20: 602e 0a2f 2f2f 203a 7061 7261 6d20 626f  `../// :param bo
+0001cb30: 6f6c 2076 6572 6966 795f 6f70 7469 6d75  ol verify_optimu
+0001cb40: 6d3a 2041 2062 6f6f 6c65 616e 2066 6c61  m: A boolean fla
+0001cb50: 6720 746f 2072 756e 2061 2063 6865 636b  g to run a check
+0001cb60: 2074 6861 7420 7468 6520 666f 756e 640a   that the found.
+0001cb70: 2f2f 2f20 2020 2020 736f 6c75 7469 6f6e  ///     solution
+0001cb80: 2069 7320 6f70 7469 6d75 6d2e 2049 6620   is optimum. If 
+0001cb90: 7365 7420 746f 2074 7275 6520 616e 2065  set to true an e
+0001cba0: 7863 6570 7469 6f6e 2077 696c 6c20 6265  xception will be
+0001cbb0: 2072 6169 7365 6420 6966 0a2f 2f2f 2020   raised if.///  
+0001cbc0: 2020 2074 6865 2066 6f75 6e64 2073 6f6c     the found sol
+0001cbd0: 7574 696f 6e20 6973 206e 6f74 206f 7074  ution is not opt
+0001cbe0: 696d 756d 2e20 5468 6973 2069 7320 6d6f  imum. This is mo
+0001cbf0: 7374 6c79 2075 7365 6675 6c20 666f 7220  stly useful for 
+0001cc00: 7465 7374 696e 672e 0a2f 2f2f 0a2f 2f2f  testing..///.///
+0001cc10: 203a 7265 7475 726e 733a 2041 2073 6574   :returns: A set
+0001cc20: 206f 6620 7475 706c 6573 206f 6674 6865   of tuples ofthe
+0001cc30: 206d 6174 6368 696e 672c 204e 6f74 6520   matching, Note 
+0001cc40: 7468 6174 206f 6e6c 7920 6120 7369 6e67  that only a sing
+0001cc50: 6c65 0a2f 2f2f 2020 2020 2064 6972 6563  le.///     direc
+0001cc60: 7469 6f6e 2077 696c 6c20 6265 206c 6973  tion will be lis
+0001cc70: 7465 6420 696e 2074 6865 206f 7574 7075  ted in the outpu
+0001cc80: 742c 2066 6f72 2065 7861 6d70 6c65 3a0a  t, for example:.
+0001cc90: 2f2f 2f20 2020 2020 6060 7b28 302c 2031  ///     ``{(0, 1
+0001cca0: 292c 7d60 602e 0a2f 2f2f 203a 7274 7970  ),}``../// :rtyp
+0001ccb0: 653a 2073 6574 0a2f 2f2f 0a2f 2f2f 202e  e: set.///./// .
+0001ccc0: 2e20 5b31 5d20 2245 6666 6963 6965 6e74  . [1] "Efficient
+0001ccd0: 2041 6c67 6f72 6974 686d 7320 666f 7220   Algorithms for 
+0001cce0: 4669 6e64 696e 6720 4d61 7869 6d75 6d20  Finding Maximum 
+0001ccf0: 4d61 7463 6869 6e67 2069 6e20 4772 6170  Matching in Grap
+0001cd00: 6873 222c 0a2f 2f2f 2020 2020 205a 7669  hs",.///     Zvi
+0001cd10: 2047 616c 696c 2c20 4143 4d20 436f 6d70   Galil, ACM Comp
+0001cd20: 7574 696e 6720 5375 7276 6579 732c 2031  uting Surveys, 1
+0001cd30: 3938 362e 0a2f 2f2f 0a23 5b70 7966 756e  986..///.#[pyfun
+0001cd40: 6374 696f 6e28 0a20 2020 206d 6178 5f63  ction(.    max_c
+0001cd50: 6172 6469 6e61 6c69 7479 203d 2022 6661  ardinality = "fa
+0001cd60: 6c73 6522 2c0a 2020 2020 6465 6661 756c  lse",.    defaul
+0001cd70: 745f 7765 6967 6874 203d 2031 2c0a 2020  t_weight = 1,.  
+0001cd80: 2020 7665 7269 6679 5f6f 7074 696d 756d    verify_optimum
+0001cd90: 203d 2022 6661 6c73 6522 0a29 5d0a 235b   = "false".)].#[
+0001cda0: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+0001cdb0: 2022 2867 7261 7068 2c20 2f2c 206d 6178   "(graph, /, max
+0001cdc0: 5f63 6172 6469 6e61 6c69 7479 3d46 616c  _cardinality=Fal
+0001cdd0: 7365 2c20 7765 6967 6874 5f66 6e3d 4e6f  se, weight_fn=No
+0001cde0: 6e65 2c20 6465 6661 756c 745f 7765 6967  ne, default_weig
+0001cdf0: 6874 3d31 2c20 7665 7269 6679 5f6f 7074  ht=1, verify_opt
+0001ce00: 696d 756d 3d46 616c 7365 2922 5d0a 7075  imum=False)"].pu
+0001ce10: 6220 666e 206d 6178 5f77 6569 6768 745f  b fn max_weight_
+0001ce20: 6d61 7463 6869 6e67 280a 2020 2020 7079  matching(.    py
+0001ce30: 3a20 5079 7468 6f6e 2c0a 2020 2020 6772  : Python,.    gr
+0001ce40: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
+0001ce50: 7261 7068 2c0a 2020 2020 6d61 785f 6361  raph,.    max_ca
+0001ce60: 7264 696e 616c 6974 793a 2062 6f6f 6c2c  rdinality: bool,
+0001ce70: 0a20 2020 2077 6569 6768 745f 666e 3a20  .    weight_fn: 
+0001ce80: 4f70 7469 6f6e 3c50 794f 626a 6563 743e  Option<PyObject>
+0001ce90: 2c0a 2020 2020 6465 6661 756c 745f 7765  ,.    default_we
+0001cea0: 6967 6874 3a20 6931 3238 2c0a 2020 2020  ight: i128,.    
+0001ceb0: 7665 7269 6679 5f6f 7074 696d 756d 3a20  verify_optimum: 
+0001cec0: 626f 6f6c 2c0a 2920 2d3e 2050 7952 6573  bool,.) -> PyRes
+0001ced0: 756c 743c 4861 7368 5365 743c 2875 7369  ult<HashSet<(usi
+0001cee0: 7a65 2c20 7573 697a 6529 3e3e 207b 0a20  ze, usize)>> {. 
+0001cef0: 2020 206d 6178 5f77 6569 6768 745f 6d61     max_weight_ma
+0001cf00: 7463 6869 6e67 3a3a 6d61 785f 7765 6967  tching::max_weig
+0001cf10: 6874 5f6d 6174 6368 696e 6728 0a20 2020  ht_matching(.   
+0001cf20: 2020 2020 2070 792c 0a20 2020 2020 2020       py,.       
+0001cf30: 2067 7261 7068 2c0a 2020 2020 2020 2020   graph,.        
+0001cf40: 6d61 785f 6361 7264 696e 616c 6974 792c  max_cardinality,
+0001cf50: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
+0001cf60: 666e 2c0a 2020 2020 2020 2020 6465 6661  fn,.        defa
+0001cf70: 756c 745f 7765 6967 6874 2c0a 2020 2020  ult_weight,.    
+0001cf80: 2020 2020 7665 7269 6679 5f6f 7074 696d      verify_optim
+0001cf90: 756d 2c0a 2020 2020 290a 7d0a 0a2f 2f2f  um,.    ).}..///
+0001cfa0: 2043 6f6d 7075 7465 2074 6865 2073 7472   Compute the str
+0001cfb0: 6f6e 676c 7920 636f 6e6e 6563 7465 6420  ongly connected 
+0001cfc0: 636f 6d70 6f6e 656e 7473 2066 6f72 2061  components for a
+0001cfd0: 2064 6972 6563 7465 6420 6772 6170 680a   directed graph.
+0001cfe0: 2f2f 2f0a 2f2f 2f20 5468 6973 2066 756e  ///./// This fun
+0001cff0: 6374 696f 6e20 6973 2069 6d70 6c65 6d65  ction is impleme
+0001d000: 6e74 6564 2075 7369 6e67 204b 6f73 6172  nted using Kosar
+0001d010: 616a 7527 7320 616c 676f 7269 7468 6d0a  aju's algorithm.
+0001d020: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+0001d030: 7944 6947 7261 7068 2067 7261 7068 3a20  yDiGraph graph: 
+0001d040: 5468 6520 696e 7075 7420 6772 6170 6820  The input graph 
+0001d050: 746f 2066 696e 6420 7468 6520 7374 726f  to find the stro
+0001d060: 6e67 6c79 2063 6f6e 6e65 6374 6564 0a2f  ngly connected./
+0001d070: 2f2f 2020 2020 2063 6f6d 706f 6e65 6e74  //     component
+0001d080: 7320 666f 722e 0a2f 2f2f 0a2f 2f2f 203a  s for..///./// :
+0001d090: 7265 7475 726e 3a20 4120 6c69 7374 206f  return: A list o
+0001d0a0: 6620 6c69 7374 206f 6620 6e6f 6465 2069  f list of node i
+0001d0b0: 6473 2066 6f72 2073 7472 6f6e 676c 7920  ds for strongly 
+0001d0c0: 636f 6e6e 6563 7465 6420 636f 6d70 6f6e  connected compon
+0001d0d0: 656e 7473 0a2f 2f2f 203a 7274 7970 653a  ents./// :rtype:
+0001d0e0: 206c 6973 740a 235b 7079 6675 6e63 7469   list.#[pyfuncti
+0001d0f0: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
+0001d100: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
+0001d110: 2f29 225d 0a70 7562 2066 6e20 7374 726f  /)"].pub fn stro
+0001d120: 6e67 6c79 5f63 6f6e 6e65 6374 6564 5f63  ngly_connected_c
+0001d130: 6f6d 706f 6e65 6e74 7328 0a20 2020 2067  omponents(.    g
+0001d140: 7261 7068 3a20 2664 6967 7261 7068 3a3a  raph: &digraph::
+0001d150: 5079 4469 4772 6170 682c 0a29 202d 3e20  PyDiGraph,.) -> 
+0001d160: 5665 633c 5665 633c 7573 697a 653e 3e20  Vec<Vec<usize>> 
+0001d170: 7b0a 2020 2020 616c 676f 3a3a 6b6f 7361  {.    algo::kosa
+0001d180: 7261 6a75 5f73 6363 2867 7261 7068 290a  raju_scc(graph).
+0001d190: 2020 2020 2020 2020 2e69 7465 7228 290a          .iter().
+0001d1a0: 2020 2020 2020 2020 2e6d 6170 287c 787c          .map(|x|
+0001d1b0: 2078 2e69 7465 7228 292e 6d61 7028 7c69   x.iter().map(|i
+0001d1c0: 647c 2069 642e 696e 6465 7828 2929 2e63  d| id.index()).c
+0001d1d0: 6f6c 6c65 6374 2829 290a 2020 2020 2020  ollect()).      
+0001d1e0: 2020 2e63 6f6c 6c65 6374 2829 0a7d 0a0a    .collect().}..
+0001d1f0: 2f2f 2f20 5265 7475 726e 2074 6865 2066  /// Return the f
+0001d200: 6972 7374 2063 7963 6c65 2065 6e63 6f75  irst cycle encou
+0001d210: 6e74 6572 6564 2064 7572 696e 6720 4446  ntered during DF
+0001d220: 5320 6f66 2061 2067 6976 656e 2050 7944  S of a given PyD
+0001d230: 6947 7261 7068 2c0a 2f2f 2f20 656d 7074  iGraph,./// empt
+0001d240: 7920 6c69 7374 2069 7320 7265 7475 726e  y list is return
+0001d250: 6564 2069 6620 6e6f 2063 7963 6c65 2069  ed if no cycle i
+0001d260: 7320 666f 756e 640a 2f2f 2f0a 2f2f 2f20  s found.///./// 
+0001d270: 3a70 6172 616d 2050 7944 6947 7261 7068  :param PyDiGraph
+0001d280: 2067 7261 7068 3a20 5468 6520 6772 6170   graph: The grap
+0001d290: 6820 746f 2066 696e 6420 7468 6520 6379  h to find the cy
+0001d2a0: 636c 6520 696e 0a2f 2f2f 203a 7061 7261  cle in./// :para
+0001d2b0: 6d20 696e 7420 736f 7572 6365 3a20 4f70  m int source: Op
+0001d2c0: 7469 6f6e 616c 2069 6e64 6578 2074 6f20  tional index to 
+0001d2d0: 6669 6e64 2061 2063 7963 6c65 2066 6f72  find a cycle for
+0001d2e0: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
+0001d2f0: 6564 2061 6e0a 2f2f 2f20 2020 2020 6172  ed an.///     ar
+0001d300: 6269 7472 6172 7920 6e6f 6465 2077 696c  bitrary node wil
+0001d310: 6c20 6265 2073 656c 6563 7465 6420 6672  l be selected fr
+0001d320: 6f6d 2074 6865 2067 7261 7068 2e0a 2f2f  om the graph..//
+0001d330: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+0001d340: 4120 6c69 7374 2064 6573 6372 6962 696e  A list describin
+0001d350: 6720 7468 6520 6379 636c 652e 2054 6865  g the cycle. The
+0001d360: 2069 6e64 6578 206f 6620 6e6f 6465 2069   index of node i
+0001d370: 6473 2077 6869 6368 0a2f 2f2f 2020 2020  ds which.///    
+0001d380: 2066 6f72 6d73 2061 2063 7963 6c65 2028   forms a cycle (
+0001d390: 6c6f 6f70 2920 696e 2074 6865 2069 6e70  loop) in the inp
+0001d3a0: 7574 2067 7261 7068 0a2f 2f2f 203a 7274  ut graph./// :rt
+0001d3b0: 7970 653a 2045 6467 654c 6973 740a 235b  ype: EdgeList.#[
+0001d3c0: 7079 6675 6e63 7469 6f6e 5d0a 235b 7465  pyfunction].#[te
+0001d3d0: 7874 5f73 6967 6e61 7475 7265 203d 2022  xt_signature = "
+0001d3e0: 2867 7261 7068 2c20 2f2c 2073 6f75 7263  (graph, /, sourc
+0001d3f0: 653d 4e6f 6e65 2922 5d0a 7075 6220 666e  e=None)"].pub fn
+0001d400: 2064 6967 7261 7068 5f66 696e 645f 6379   digraph_find_cy
+0001d410: 636c 6528 0a20 2020 2067 7261 7068 3a20  cle(.    graph: 
+0001d420: 2664 6967 7261 7068 3a3a 5079 4469 4772  &digraph::PyDiGr
+0001d430: 6170 682c 0a20 2020 2073 6f75 7263 653a  aph,.    source:
+0001d440: 204f 7074 696f 6e3c 7573 697a 653e 2c0a   Option<usize>,.
+0001d450: 2920 2d3e 2045 6467 654c 6973 7420 7b0a  ) -> EdgeList {.
+0001d460: 2020 2020 6c65 7420 6d75 7420 6772 6170      let mut grap
+0001d470: 685f 6e6f 6465 733a 2048 6173 6853 6574  h_nodes: HashSet
+0001d480: 3c4e 6f64 6549 6e64 6578 3e20 3d0a 2020  <NodeIndex> =.  
+0001d490: 2020 2020 2020 6772 6170 682e 6772 6170        graph.grap
+0001d4a0: 682e 6e6f 6465 5f69 6e64 6963 6573 2829  h.node_indices()
+0001d4b0: 2e63 6f6c 6c65 6374 2829 3b0a 2020 2020  .collect();.    
+0001d4c0: 6c65 7420 6d75 7420 6379 636c 653a 2056  let mut cycle: V
+0001d4d0: 6563 3c28 7573 697a 652c 2075 7369 7a65  ec<(usize, usize
+0001d4e0: 293e 203d 0a20 2020 2020 2020 2056 6563  )> =.        Vec
+0001d4f0: 3a3a 7769 7468 5f63 6170 6163 6974 7928  ::with_capacity(
+0001d500: 6772 6170 682e 6772 6170 682e 6564 6765  graph.graph.edge
+0001d510: 5f63 6f75 6e74 2829 293b 0a20 2020 206c  _count());.    l
+0001d520: 6574 2074 656d 705f 7661 6c75 653a 204e  et temp_value: N
+0001d530: 6f64 6549 6e64 6578 3b0a 2020 2020 2f2f  odeIndex;.    //
+0001d540: 2049 6620 736f 7572 6365 2069 7320 6e6f   If source is no
+0001d550: 7420 7365 7420 6765 7420 616e 2061 7262  t set get an arb
+0001d560: 6974 7261 7279 206e 6f64 6520 6672 6f6d  itrary node from
+0001d570: 2074 6865 2073 6574 206f 6620 6772 6170   the set of grap
+0001d580: 680a 2020 2020 2f2f 206e 6f64 6573 2077  h.    // nodes w
+0001d590: 6527 7665 206e 6f74 2022 6578 616d 696e  e've not "examin
+0001d5a0: 6564 220a 2020 2020 6c65 7420 736f 7572  ed".    let sour
+0001d5b0: 6365 5f69 6e64 6578 203d 206d 6174 6368  ce_index = match
+0001d5c0: 2073 6f75 7263 6520 7b0a 2020 2020 2020   source {.      
+0001d5d0: 2020 536f 6d65 2873 6f75 7263 655f 7661    Some(source_va
+0001d5e0: 6c75 6529 203d 3e20 4e6f 6465 496e 6465  lue) => NodeInde
+0001d5f0: 783a 3a6e 6577 2873 6f75 7263 655f 7661  x::new(source_va
+0001d600: 6c75 6529 2c0a 2020 2020 2020 2020 4e6f  lue),.        No
+0001d610: 6e65 203d 3e20 7b0a 2020 2020 2020 2020  ne => {.        
+0001d620: 2020 2020 7465 6d70 5f76 616c 7565 203d      temp_value =
+0001d630: 202a 6772 6170 685f 6e6f 6465 732e 6974   *graph_nodes.it
+0001d640: 6572 2829 2e6e 6578 7428 292e 756e 7772  er().next().unwr
+0001d650: 6170 2829 3b0a 2020 2020 2020 2020 2020  ap();.          
+0001d660: 2020 6772 6170 685f 6e6f 6465 732e 7265    graph_nodes.re
+0001d670: 6d6f 7665 2826 7465 6d70 5f76 616c 7565  move(&temp_value
+0001d680: 293b 0a20 2020 2020 2020 2020 2020 2074  );.            t
+0001d690: 656d 705f 7661 6c75 650a 2020 2020 2020  emp_value.      
+0001d6a0: 2020 7d0a 2020 2020 7d3b 0a0a 2020 2020    }.    };..    
+0001d6b0: 2f2f 2053 7461 636b 2028 6965 2022 7075  // Stack (ie "pu
+0001d6c0: 7368 646f 776e 206c 6973 7422 2920 6f66  shdown list") of
+0001d6d0: 2076 6572 7469 6365 7320 616c 7265 6164   vertices alread
+0001d6e0: 7920 696e 2074 6865 2073 7061 6e6e 696e  y in the spannin
+0001d6f0: 6720 7472 6565 0a20 2020 206c 6574 206d  g tree.    let m
+0001d700: 7574 2073 7461 636b 3a20 5665 633c 4e6f  ut stack: Vec<No
+0001d710: 6465 496e 6465 783e 203d 2076 6563 215b  deIndex> = vec![
+0001d720: 736f 7572 6365 5f69 6e64 6578 5d3b 0a20  source_index];. 
+0001d730: 2020 202f 2f20 6d61 7020 746f 2073 746f     // map to sto
+0001d740: 7265 2070 6172 656e 7420 6f66 2061 206e  re parent of a n
+0001d750: 6f64 650a 2020 2020 6c65 7420 6d75 7420  ode.    let mut 
+0001d760: 7072 6564 3a20 4861 7368 4d61 703c 4e6f  pred: HashMap<No
+0001d770: 6465 496e 6465 782c 204e 6f64 6549 6e64  deIndex, NodeInd
+0001d780: 6578 3e20 3d20 4861 7368 4d61 703a 3a6e  ex> = HashMap::n
+0001d790: 6577 2829 3b0a 2020 2020 2f2f 2061 206e  ew();.    // a n
+0001d7a0: 6f64 6520 6973 2069 6e20 7468 6520 7669  ode is in the vi
+0001d7b0: 7369 7469 6e67 2073 6574 2069 6620 6174  siting set if at
+0001d7c0: 206c 6561 7374 206f 6e65 206f 6620 6974   least one of it
+0001d7d0: 7320 6368 696c 6420 6973 2075 6e65 7861  s child is unexa
+0001d7e0: 6d69 6e65 640a 2020 2020 6c65 7420 6d75  mined.    let mu
+0001d7f0: 7420 7669 7369 7469 6e67 203d 2048 6173  t visiting = Has
+0001d800: 6853 6574 3a3a 6e65 7728 293b 0a20 2020  hSet::new();.   
+0001d810: 202f 2f20 6120 6e6f 6465 2069 7320 696e   // a node is in
+0001d820: 2076 6973 6974 6564 2073 6574 2069 6620   visited set if 
+0001d830: 616c 6c20 6f66 2069 7473 2063 6869 6c64  all of its child
+0001d840: 7265 6e20 6861 7665 2062 6565 6e20 6578  ren have been ex
+0001d850: 616d 696e 6564 0a20 2020 206c 6574 206d  amined.    let m
+0001d860: 7574 2076 6973 6974 6564 203d 2048 6173  ut visited = Has
+0001d870: 6853 6574 3a3a 6e65 7728 293b 0a20 2020  hSet::new();.   
+0001d880: 2077 6869 6c65 2021 7374 6163 6b2e 6973   while !stack.is
+0001d890: 5f65 6d70 7479 2829 207b 0a20 2020 2020  _empty() {.     
+0001d8a0: 2020 206c 6574 206d 7574 207a 203d 202a     let mut z = *
+0001d8b0: 7374 6163 6b2e 6c61 7374 2829 2e75 6e77  stack.last().unw
+0001d8c0: 7261 7028 293b 0a20 2020 2020 2020 2076  rap();.        v
+0001d8d0: 6973 6974 696e 672e 696e 7365 7274 287a  isiting.insert(z
+0001d8e0: 293b 0a0a 2020 2020 2020 2020 6c65 7420  );..        let 
+0001d8f0: 6368 696c 6472 656e 203d 2067 7261 7068  children = graph
+0001d900: 0a20 2020 2020 2020 2020 2020 202e 6772  .            .gr
+0001d910: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
+0001d920: 2e6e 6569 6768 626f 7273 5f64 6972 6563  .neighbors_direc
+0001d930: 7465 6428 7a2c 2070 6574 6772 6170 683a  ted(z, petgraph:
+0001d940: 3a44 6972 6563 7469 6f6e 3a3a 4f75 7467  :Direction::Outg
+0001d950: 6f69 6e67 293b 0a0a 2020 2020 2020 2020  oing);..        
+0001d960: 666f 7220 6368 696c 6420 696e 2063 6869  for child in chi
+0001d970: 6c64 7265 6e20 7b0a 2020 2020 2020 2020  ldren {.        
+0001d980: 2020 2020 2f2f 6379 636c 6520 6973 2066      //cycle is f
+0001d990: 6f75 6e64 0a20 2020 2020 2020 2020 2020  ound.           
+0001d9a0: 2069 6620 7669 7369 7469 6e67 2e63 6f6e   if visiting.con
+0001d9b0: 7461 696e 7328 2663 6869 6c64 2920 7b0a  tains(&child) {.
+0001d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d9d0: 6379 636c 652e 7075 7368 2828 7a2e 696e  cycle.push((z.in
+0001d9e0: 6465 7828 292c 2063 6869 6c64 2e69 6e64  dex(), child.ind
+0001d9f0: 6578 2829 2929 3b0a 2020 2020 2020 2020  ex()));.        
+0001da00: 2020 2020 2020 2020 2f2f 6261 636b 7472          //backtr
+0001da10: 6163 6b0a 2020 2020 2020 2020 2020 2020  ack.            
+0001da20: 2020 2020 6c6f 6f70 207b 0a20 2020 2020      loop {.     
+0001da30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001da40: 6620 7a20 3d3d 2063 6869 6c64 207b 0a20  f z == child {. 
+0001da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001da60: 2020 2020 2020 2063 7963 6c65 2e72 6576         cycle.rev
+0001da70: 6572 7365 2829 3b0a 2020 2020 2020 2020  erse();.        
+0001da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001da90: 6272 6561 6b3b 0a20 2020 2020 2020 2020  break;.         
+0001daa0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dac0: 2063 7963 6c65 2e70 7573 6828 2870 7265   cycle.push((pre
+0001dad0: 645b 267a 5d2e 696e 6465 7828 292c 207a  d[&z].index(), z
+0001dae0: 2e69 6e64 6578 2829 2929 3b0a 2020 2020  .index()));.    
+0001daf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db00: 7a20 3d20 7072 6564 5b26 7a5d 3b0a 2020  z = pred[&z];.  
+0001db10: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+0001db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db30: 7265 7475 726e 2045 6467 654c 6973 7420  return EdgeList 
+0001db40: 7b20 6564 6765 733a 2063 7963 6c65 207d  { edges: cycle }
+0001db50: 3b0a 2020 2020 2020 2020 2020 2020 7d0a  ;.            }.
+0001db60: 2020 2020 2020 2020 2020 2020 2f2f 6966              //if
+0001db70: 2061 6e20 756e 6578 706c 6f72 6564 206e   an unexplored n
+0001db80: 6f64 6520 6973 2065 6e63 6f75 6e74 6572  ode is encounter
+0001db90: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+0001dba0: 6620 2176 6973 6974 6564 2e63 6f6e 7461  f !visited.conta
+0001dbb0: 696e 7328 2663 6869 6c64 2920 7b0a 2020  ins(&child) {.  
+0001dbc0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001dbd0: 6163 6b2e 7075 7368 2863 6869 6c64 293b  ack.push(child);
+0001dbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001dbf0: 2070 7265 642e 696e 7365 7274 2863 6869   pred.insert(chi
+0001dc00: 6c64 2c20 7a29 3b0a 2020 2020 2020 2020  ld, z);.        
+0001dc10: 2020 2020 7d0a 2020 2020 2020 2020 7d0a      }.        }.
+0001dc20: 0a20 2020 2020 2020 206c 6574 2074 6f70  .        let top
+0001dc30: 203d 202a 7374 6163 6b2e 6c61 7374 2829   = *stack.last()
+0001dc40: 2e75 6e77 7261 7028 293b 0a20 2020 2020  .unwrap();.     
+0001dc50: 2020 202f 2f69 6620 6e6f 2066 7572 7468     //if no furth
+0001dc60: 6572 2063 6869 6c64 7265 6e20 616e 6420  er children and 
+0001dc70: 6578 706c 6f72 6564 2c20 6d6f 7665 2074  explored, move t
+0001dc80: 6f20 7669 7369 7465 640a 2020 2020 2020  o visited.      
+0001dc90: 2020 6966 2074 6f70 2e69 6e64 6578 2829    if top.index()
+0001dca0: 203d 3d20 7a2e 696e 6465 7828 2920 7b0a   == z.index() {.
+0001dcb0: 2020 2020 2020 2020 2020 2020 7374 6163              stac
+0001dcc0: 6b2e 706f 7028 293b 0a20 2020 2020 2020  k.pop();.       
+0001dcd0: 2020 2020 2076 6973 6974 696e 672e 7265       visiting.re
+0001dce0: 6d6f 7665 2826 7a29 3b0a 2020 2020 2020  move(&z);.      
+0001dcf0: 2020 2020 2020 7669 7369 7465 642e 696e        visited.in
+0001dd00: 7365 7274 287a 293b 0a20 2020 2020 2020  sert(z);.       
+0001dd10: 207d 0a20 2020 207d 0a20 2020 2045 6467   }.    }.    Edg
+0001dd20: 654c 6973 7420 7b20 6564 6765 733a 2063  eList { edges: c
+0001dd30: 7963 6c65 207d 0a7d 0a0a 666e 205f 696e  ycle }.}..fn _in
+0001dd40: 6e65 725f 6973 5f6d 6174 6368 696e 6728  ner_is_matching(
+0001dd50: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
+0001dd60: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
+0001dd70: 206d 6174 6368 696e 673a 2026 4861 7368   matching: &Hash
+0001dd80: 5365 743c 2875 7369 7a65 2c20 7573 697a  Set<(usize, usiz
+0001dd90: 6529 3e2c 0a29 202d 3e20 626f 6f6c 207b  e)>,.) -> bool {
+0001dda0: 0a20 2020 206c 6574 2068 6173 5f65 6467  .    let has_edg
+0001ddb0: 6520 3d20 7c65 3a20 2628 7573 697a 652c  e = |e: &(usize,
+0001ddc0: 2075 7369 7a65 297c 202d 3e20 626f 6f6c   usize)| -> bool
+0001ddd0: 207b 0a20 2020 2020 2020 2067 7261 7068   {.        graph
+0001dde0: 0a20 2020 2020 2020 2020 2020 202e 6772  .            .gr
+0001ddf0: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
+0001de00: 2e63 6f6e 7461 696e 735f 6564 6765 284e  .contains_edge(N
+0001de10: 6f64 6549 6e64 6578 3a3a 6e65 7728 652e  odeIndex::new(e.
+0001de20: 3029 2c20 4e6f 6465 496e 6465 783a 3a6e  0), NodeIndex::n
+0001de30: 6577 2865 2e31 2929 0a20 2020 207d 3b0a  ew(e.1)).    };.
+0001de40: 0a20 2020 2069 6620 216d 6174 6368 696e  .    if !matchin
+0001de50: 672e 6974 6572 2829 2e61 6c6c 287c 657c  g.iter().all(|e|
+0001de60: 2068 6173 5f65 6467 6528 6529 2920 7b0a   has_edge(e)) {.
+0001de70: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0001de80: 616c 7365 3b0a 2020 2020 7d0a 2020 2020  alse;.    }.    
+0001de90: 6c65 7420 6d75 7420 666f 756e 643a 2048  let mut found: H
+0001dea0: 6173 6853 6574 3c75 7369 7a65 3e20 3d20  ashSet<usize> = 
+0001deb0: 4861 7368 5365 743a 3a77 6974 685f 6361  HashSet::with_ca
+0001dec0: 7061 6369 7479 2832 202a 206d 6174 6368  pacity(2 * match
+0001ded0: 696e 672e 6c65 6e28 2929 3b0a 2020 2020  ing.len());.    
+0001dee0: 666f 7220 2876 312c 2076 3229 2069 6e20  for (v1, v2) in 
+0001def0: 6d61 7463 6869 6e67 207b 0a20 2020 2020  matching {.     
+0001df00: 2020 2069 6620 666f 756e 642e 636f 6e74     if found.cont
+0001df10: 6169 6e73 2876 3129 207c 7c20 666f 756e  ains(v1) || foun
+0001df20: 642e 636f 6e74 6169 6e73 2876 3229 207b  d.contains(v2) {
+0001df30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001df40: 7572 6e20 6661 6c73 653b 0a20 2020 2020  urn false;.     
+0001df50: 2020 207d 0a20 2020 2020 2020 2066 6f75     }.        fou
+0001df60: 6e64 2e69 6e73 6572 7428 2a76 3129 3b0a  nd.insert(*v1);.
+0001df70: 2020 2020 2020 2020 666f 756e 642e 696e          found.in
+0001df80: 7365 7274 282a 7632 293b 0a20 2020 207d  sert(*v2);.    }
+0001df90: 0a20 2020 2074 7275 650a 7d0a 0a2f 2f2f  .    true.}..///
+0001dfa0: 2043 6865 636b 2069 6620 6d61 7463 6869   Check if matchi
+0001dfb0: 6e67 2069 7320 7661 6c69 6420 666f 7220  ng is valid for 
+0001dfc0: 6772 6170 680a 2f2f 2f0a 2f2f 2f20 4120  graph.///./// A 
+0001dfd0: 2a6d 6174 6368 696e 672a 2069 6e20 6120  *matching* in a 
+0001dfe0: 6772 6170 6820 6973 2061 2073 6574 206f  graph is a set o
+0001dff0: 6620 6564 6765 7320 696e 2077 6869 6368  f edges in which
+0001e000: 206e 6f20 7477 6f20 6469 7374 696e 6374   no two distinct
+0001e010: 0a2f 2f2f 2065 6467 6573 2073 6861 7265  ./// edges share
+0001e020: 2061 2063 6f6d 6d6f 6e20 656e 6470 6f69   a common endpoi
+0001e030: 6e74 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  nt..///./// :par
+0001e040: 616d 2050 7944 6947 7261 7068 2067 7261  am PyDiGraph gra
+0001e050: 7068 3a20 5468 6520 6772 6170 6820 746f  ph: The graph to
+0001e060: 2063 6865 636b 2069 6620 7468 6520 6d61   check if the ma
+0001e070: 7463 6869 6e67 2069 7320 7661 6c69 6420  tching is valid 
+0001e080: 666f 720a 2f2f 2f20 3a70 6172 616d 2073  for./// :param s
+0001e090: 6574 206d 6174 6368 696e 673a 2041 2073  et matching: A s
+0001e0a0: 6574 206f 6620 6e6f 6465 2069 6e64 6578  et of node index
+0001e0b0: 2074 7570 6c65 7320 666f 7220 6561 6368   tuples for each
+0001e0c0: 2065 6467 6520 696e 2074 6865 0a2f 2f2f   edge in the.///
+0001e0d0: 2020 2020 206d 6174 6368 696e 672e 0a2f       matching../
+0001e0e0: 2f2f 0a2f 2f2f 203a 7265 7475 726e 733a  //./// :returns:
+0001e0f0: 2057 6865 7468 6572 2074 6865 2070 726f   Whether the pro
+0001e100: 7669 6465 6420 6d61 7463 6869 6e67 2069  vided matching i
+0001e110: 7320 6120 7661 6c69 6420 6d61 7463 6869  s a valid matchi
+0001e120: 6e67 2066 6f72 2074 6865 2067 7261 7068  ng for the graph
+0001e130: 0a2f 2f2f 203a 7274 7970 653a 2062 6f6f  ./// :rtype: boo
+0001e140: 6c0a 235b 7079 6675 6e63 7469 6f6e 5d0a  l.#[pyfunction].
+0001e150: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
+0001e160: 203d 2022 2867 7261 7068 2c20 6d61 7463   = "(graph, matc
+0001e170: 6869 6e67 2c20 2f29 225d 0a70 7562 2066  hing, /)"].pub f
+0001e180: 6e20 6973 5f6d 6174 6368 696e 6728 0a20  n is_matching(. 
+0001e190: 2020 2067 7261 7068 3a20 2667 7261 7068     graph: &graph
+0001e1a0: 3a3a 5079 4772 6170 682c 0a20 2020 206d  ::PyGraph,.    m
+0001e1b0: 6174 6368 696e 673a 2048 6173 6853 6574  atching: HashSet
+0001e1c0: 3c28 7573 697a 652c 2075 7369 7a65 293e  <(usize, usize)>
+0001e1d0: 2c0a 2920 2d3e 2062 6f6f 6c20 7b0a 2020  ,.) -> bool {.  
+0001e1e0: 2020 5f69 6e6e 6572 5f69 735f 6d61 7463    _inner_is_matc
+0001e1f0: 6869 6e67 2867 7261 7068 2c20 266d 6174  hing(graph, &mat
+0001e200: 6368 696e 6729 0a7d 0a0a 2f2f 2f20 4368  ching).}../// Ch
+0001e210: 6563 6b20 6966 2061 206d 6174 6368 696e  eck if a matchin
+0001e220: 6720 6973 2061 206d 6178 696d 616c 2028  g is a maximal (
+0001e230: 2a2a 6e6f 742a 2a20 6d61 7869 6d75 6d29  **not** maximum)
+0001e240: 206d 6174 6368 696e 6720 666f 7220 6120   matching for a 
+0001e250: 6772 6170 680a 2f2f 2f0a 2f2f 2f20 4120  graph.///./// A 
+0001e260: 2a6d 6178 696d 616c 206d 6174 6368 696e  *maximal matchin
+0001e270: 672a 2069 6e20 6120 6772 6170 6820 6973  g* in a graph is
+0001e280: 2061 206d 6174 6368 696e 6720 696e 2077   a matching in w
+0001e290: 6869 6368 2061 6464 696e 6720 616e 790a  hich adding any.
+0001e2a0: 2f2f 2f20 6564 6765 2077 6f75 6c64 2063  /// edge would c
+0001e2b0: 6175 7365 2074 6865 2073 6574 2074 6f20  ause the set to 
+0001e2c0: 6e6f 206c 6f6e 6765 7220 6265 2061 2076  no longer be a v
+0001e2d0: 616c 6964 206d 6174 6368 696e 672e 0a2f  alid matching../
+0001e2e0: 2f2f 0a2f 2f2f 202e 2e20 6e6f 7465 3a3a  //./// .. note::
+0001e2f0: 0a2f 2f2f 0a2f 2f2f 2020 2054 6869 7320  .///.///   This 
+0001e300: 6973 206e 6f74 2063 6865 636b 696e 6720  is not checking 
+0001e310: 666f 7220 6120 2a6d 6178 696d 756d 2a20  for a *maximum* 
+0001e320: 2867 6c6f 6261 6c6c 7920 6f70 7469 6d61  (globally optima
+0001e330: 6c29 206d 6174 6368 696e 672c 2062 7574  l) matching, but
+0001e340: 0a2f 2f2f 2020 2061 202a 6d61 7869 6d61  .///   a *maxima
+0001e350: 6c2a 2028 6c6f 6361 6c6c 7920 6f70 7469  l* (locally opti
+0001e360: 6d61 6c29 206d 6174 6368 696e 672e 0a2f  mal) matching../
+0001e370: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
+0001e380: 4469 4772 6170 6820 6772 6170 683a 2054  DiGraph graph: T
+0001e390: 6865 2067 7261 7068 2074 6f20 6368 6563  he graph to chec
+0001e3a0: 6b20 6966 2074 6865 206d 6174 6368 696e  k if the matchin
+0001e3b0: 6720 6973 206d 6178 696d 616c 2066 6f72  g is maximal for
+0001e3c0: 2e0a 2f2f 2f20 3a70 6172 616d 2073 6574  ../// :param set
+0001e3d0: 206d 6174 6368 696e 673a 2041 2073 6574   matching: A set
+0001e3e0: 206f 6620 6e6f 6465 2069 6e64 6578 2074   of node index t
+0001e3f0: 7570 6c65 7320 666f 7220 6561 6368 2065  uples for each e
+0001e400: 6467 6520 696e 2074 6865 0a2f 2f2f 2020  dge in the.///  
+0001e410: 2020 206d 6174 6368 696e 672e 0a2f 2f2f     matching..///
+0001e420: 0a2f 2f2f 203a 7265 7475 726e 733a 2057  ./// :returns: W
+0001e430: 6865 7468 6572 2074 6865 2070 726f 7669  hether the provi
+0001e440: 6465 6420 6d61 7463 6869 6e67 2069 7320  ded matching is 
+0001e450: 6120 7661 6c69 6420 6d61 7463 6869 6e67  a valid matching
+0001e460: 2061 6e64 2077 6865 7468 6572 2069 740a   and whether it.
+0001e470: 2f2f 2f20 2020 2020 6973 206d 6178 696d  ///     is maxim
+0001e480: 616c 206f 7220 6e6f 742e 0a2f 2f2f 203a  al or not../// :
+0001e490: 7274 7970 653a 2062 6f6f 6c0a 235b 7079  rtype: bool.#[py
+0001e4a0: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+0001e4b0: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+0001e4c0: 7261 7068 2c20 6d61 7463 6869 6e67 2c20  raph, matching, 
+0001e4d0: 2f29 225d 0a70 7562 2066 6e20 6973 5f6d  /)"].pub fn is_m
+0001e4e0: 6178 696d 616c 5f6d 6174 6368 696e 6728  aximal_matching(
+0001e4f0: 0a20 2020 2067 7261 7068 3a20 2667 7261  .    graph: &gra
+0001e500: 7068 3a3a 5079 4772 6170 682c 0a20 2020  ph::PyGraph,.   
+0001e510: 206d 6174 6368 696e 673a 2048 6173 6853   matching: HashS
+0001e520: 6574 3c28 7573 697a 652c 2075 7369 7a65  et<(usize, usize
+0001e530: 293e 2c0a 2920 2d3e 2062 6f6f 6c20 7b0a  )>,.) -> bool {.
+0001e540: 2020 2020 6966 2021 5f69 6e6e 6572 5f69      if !_inner_i
+0001e550: 735f 6d61 7463 6869 6e67 2867 7261 7068  s_matching(graph
+0001e560: 2c20 266d 6174 6368 696e 6729 207b 0a20  , &matching) {. 
+0001e570: 2020 2020 2020 2072 6574 7572 6e20 6661         return fa
+0001e580: 6c73 653b 0a20 2020 207d 0a20 2020 206c  lse;.    }.    l
+0001e590: 6574 2065 6467 655f 6c69 7374 3a20 4861  et edge_list: Ha
+0001e5a0: 7368 5365 743c 5b75 7369 7a65 3b20 325d  shSet<[usize; 2]
+0001e5b0: 3e20 3d20 6772 6170 680a 2020 2020 2020  > = graph.      
+0001e5c0: 2020 2e65 6467 655f 7265 6665 7265 6e63    .edge_referenc
+0001e5d0: 6573 2829 0a20 2020 2020 2020 202e 6d61  es().        .ma
+0001e5e0: 7028 7c65 6467 657c 207b 0a20 2020 2020  p(|edge| {.     
+0001e5f0: 2020 2020 2020 206c 6574 206d 7574 2074         let mut t
+0001e600: 6d70 5f61 7272 6179 203d 205b 6564 6765  mp_array = [edge
+0001e610: 2e73 6f75 7263 6528 292e 696e 6465 7828  .source().index(
+0001e620: 292c 2065 6467 652e 7461 7267 6574 2829  ), edge.target()
+0001e630: 2e69 6e64 6578 2829 5d3b 0a20 2020 2020  .index()];.     
+0001e640: 2020 2020 2020 2074 6d70 5f61 7272 6179         tmp_array
+0001e650: 2e73 6f72 745f 756e 7374 6162 6c65 2829  .sort_unstable()
+0001e660: 3b0a 2020 2020 2020 2020 2020 2020 746d  ;.            tm
+0001e670: 705f 6172 7261 790a 2020 2020 2020 2020  p_array.        
+0001e680: 7d29 0a20 2020 2020 2020 202e 636f 6c6c  }).        .coll
+0001e690: 6563 7428 293b 0a20 2020 206c 6574 206d  ect();.    let m
+0001e6a0: 6174 6368 6564 5f65 6467 6573 3a20 4861  atched_edges: Ha
+0001e6b0: 7368 5365 743c 5b75 7369 7a65 3b20 325d  shSet<[usize; 2]
+0001e6c0: 3e20 3d20 6d61 7463 6869 6e67 0a20 2020  > = matching.   
+0001e6d0: 2020 2020 202e 6974 6572 2829 0a20 2020       .iter().   
+0001e6e0: 2020 2020 202e 6d61 7028 7c65 6467 657c       .map(|edge|
+0001e6f0: 207b 0a20 2020 2020 2020 2020 2020 206c   {.            l
+0001e700: 6574 206d 7574 2074 6d70 5f61 7272 6179  et mut tmp_array
+0001e710: 203d 205b 6564 6765 2e30 2c20 6564 6765   = [edge.0, edge
+0001e720: 2e31 5d3b 0a20 2020 2020 2020 2020 2020  .1];.           
+0001e730: 2074 6d70 5f61 7272 6179 2e73 6f72 745f   tmp_array.sort_
+0001e740: 756e 7374 6162 6c65 2829 3b0a 2020 2020  unstable();.    
+0001e750: 2020 2020 2020 2020 746d 705f 6172 7261          tmp_arra
+0001e760: 790a 2020 2020 2020 2020 7d29 0a20 2020  y.        }).   
+0001e770: 2020 2020 202e 636f 6c6c 6563 7428 293b       .collect();
+0001e780: 0a20 2020 206c 6574 206d 7574 2075 6e6d  .    let mut unm
+0001e790: 6174 6368 6564 5f65 6467 6573 203d 2065  atched_edges = e
+0001e7a0: 6467 655f 6c69 7374 2e64 6966 6665 7265  dge_list.differe
+0001e7b0: 6e63 6528 266d 6174 6368 6564 5f65 6467  nce(&matched_edg
+0001e7c0: 6573 293b 0a20 2020 2075 6e6d 6174 6368  es);.    unmatch
+0001e7d0: 6564 5f65 6467 6573 2e61 6c6c 287c 657c  ed_edges.all(|e|
+0001e7e0: 207b 0a20 2020 2020 2020 206c 6574 206d   {.        let m
+0001e7f0: 7574 2074 6d70 5f73 6574 203d 206d 6174  ut tmp_set = mat
+0001e800: 6368 696e 672e 636c 6f6e 6528 293b 0a20  ching.clone();. 
+0001e810: 2020 2020 2020 2074 6d70 5f73 6574 2e69         tmp_set.i
+0001e820: 6e73 6572 7428 2865 5b30 5d2c 2065 5b31  nsert((e[0], e[1
+0001e830: 5d29 293b 0a20 2020 2020 2020 2021 5f69  ]));.        !_i
+0001e840: 6e6e 6572 5f69 735f 6d61 7463 6869 6e67  nner_is_matching
+0001e850: 2867 7261 7068 2c20 2674 6d70 5f73 6574  (graph, &tmp_set
+0001e860: 290a 2020 2020 7d29 0a7d 0a0a 666e 205f  ).    }).}..fn _
+0001e870: 6772 6170 685f 7472 6961 6e67 6c65 7328  graph_triangles(
+0001e880: 6772 6170 683a 2026 6772 6170 683a 3a50  graph: &graph::P
+0001e890: 7947 7261 7068 2c20 6e6f 6465 3a20 7573  yGraph, node: us
+0001e8a0: 697a 6529 202d 3e20 2875 7369 7a65 2c20  ize) -> (usize, 
+0001e8b0: 7573 697a 6529 207b 0a20 2020 206c 6574  usize) {.    let
+0001e8c0: 206d 7574 2074 7269 616e 676c 6573 3a20   mut triangles: 
+0001e8d0: 7573 697a 6520 3d20 303b 0a0a 2020 2020  usize = 0;..    
+0001e8e0: 6c65 7420 696e 6465 7820 3d20 4e6f 6465  let index = Node
+0001e8f0: 496e 6465 783a 3a6e 6577 286e 6f64 6529  Index::new(node)
+0001e900: 3b0a 2020 2020 6c65 7420 6d75 7420 6e65  ;.    let mut ne
+0001e910: 6967 6862 6f72 733a 2048 6173 6853 6574  ighbors: HashSet
+0001e920: 3c4e 6f64 6549 6e64 6578 3e20 3d0a 2020  <NodeIndex> =.  
+0001e930: 2020 2020 2020 6772 6170 682e 6772 6170        graph.grap
+0001e940: 682e 6e65 6967 6862 6f72 7328 696e 6465  h.neighbors(inde
+0001e950: 7829 2e63 6f6c 6c65 6374 2829 3b0a 2020  x).collect();.  
+0001e960: 2020 6e65 6967 6862 6f72 732e 7265 6d6f    neighbors.remo
+0001e970: 7665 2826 696e 6465 7829 3b0a 0a20 2020  ve(&index);..   
+0001e980: 2066 6f72 206e 6f64 6576 2069 6e20 266e   for nodev in &n
+0001e990: 6569 6768 626f 7273 207b 0a20 2020 2020  eighbors {.     
+0001e9a0: 2020 2074 7269 616e 676c 6573 202b 3d20     triangles += 
+0001e9b0: 6772 6170 680a 2020 2020 2020 2020 2020  graph.          
+0001e9c0: 2020 2e67 7261 7068 0a20 2020 2020 2020    .graph.       
+0001e9d0: 2020 2020 202e 6e65 6967 6862 6f72 7328       .neighbors(
+0001e9e0: 2a6e 6f64 6576 290a 2020 2020 2020 2020  *nodev).        
+0001e9f0: 2020 2020 2e66 696c 7465 7228 7c26 787c      .filter(|&x|
+0001ea00: 2028 7820 213d 202a 6e6f 6465 7629 2026   (x != *nodev) &
+0001ea10: 2620 6e65 6967 6862 6f72 732e 636f 6e74  & neighbors.cont
+0001ea20: 6169 6e73 2826 7829 290a 2020 2020 2020  ains(&x)).      
+0001ea30: 2020 2020 2020 2e63 6f75 6e74 2829 3b0a        .count();.
+0001ea40: 2020 2020 7d0a 0a20 2020 206c 6574 2064      }..    let d
+0001ea50: 3a20 7573 697a 6520 3d20 6e65 6967 6862  : usize = neighb
+0001ea60: 6f72 732e 6c65 6e28 293b 0a20 2020 206c  ors.len();.    l
+0001ea70: 6574 2074 7269 706c 6573 3a20 7573 697a  et triples: usiz
+0001ea80: 6520 3d20 6d61 7463 6820 6420 7b0a 2020  e = match d {.  
+0001ea90: 2020 2020 2020 3020 3d3e 2030 2c0a 2020        0 => 0,.  
+0001eaa0: 2020 2020 2020 5f20 3d3e 2028 6420 2a20        _ => (d * 
+0001eab0: 2864 202d 2031 2929 202f 2032 2c0a 2020  (d - 1)) / 2,.  
+0001eac0: 2020 7d3b 0a0a 2020 2020 2874 7269 616e    };..    (trian
+0001ead0: 676c 6573 202f 2032 2c20 7472 6970 6c65  gles / 2, triple
+0001eae0: 7329 0a7d 0a0a 2f2f 2f20 436f 6d70 7574  s).}../// Comput
+0001eaf0: 6520 7468 6520 7472 616e 7369 7469 7669  e the transitivi
+0001eb00: 7479 206f 6620 616e 2075 6e64 6972 6563  ty of an undirec
+0001eb10: 7465 6420 6772 6170 682e 0a2f 2f2f 0a2f  ted graph..///./
+0001eb20: 2f2f 2054 6865 2074 7261 6e73 6974 6976  // The transitiv
+0001eb30: 6974 7920 6f66 2061 2067 7261 7068 2069  ity of a graph i
+0001eb40: 7320 6465 6669 6e65 6420 6173 3a0a 2f2f  s defined as:.//
+0001eb50: 2f0a 2f2f 2f20 2e2e 206d 6174 683a 3a0a  /./// .. math::.
+0001eb60: 2f2f 2f20 2020 2020 6063 3d33 205c 7469  ///     `c=3 \ti
+0001eb70: 6d65 7320 5c66 7261 637b 5c74 6578 747b  mes \frac{\text{
+0001eb80: 6e75 6d62 6572 206f 6620 7472 6961 6e67  number of triang
+0001eb90: 6c65 737d 7d7b 5c74 6578 747b 6e75 6d62  les}}{\text{numb
+0001eba0: 6572 206f 6620 636f 6e6e 6563 7465 6420  er of connected 
+0001ebb0: 7472 6970 6c65 737d 7d60 0a2f 2f2f 0a2f  triples}}`.///./
+0001ebc0: 2f2f 2041 20e2 809c 636f 6e6e 6563 7465  // A ...connecte
+0001ebd0: 6420 7472 6970 6c65 e280 9d20 6d65 616e  d triple... mean
+0001ebe0: 7320 6120 7369 6e67 6c65 2076 6572 7465  s a single verte
+0001ebf0: 7820 7769 7468 0a2f 2f2f 2065 6467 6573  x with./// edges
+0001ec00: 2072 756e 6e69 6e67 2074 6f20 616e 2075   running to an u
+0001ec10: 6e6f 7264 6572 6564 2070 6169 7220 6f66  nordered pair of
+0001ec20: 206f 7468 6572 732e 0a2f 2f2f 0a2f 2f2f   others..///.///
+0001ec30: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
+0001ec40: 7320 6d75 6c74 6974 6872 6561 6465 6420  s multithreaded 
+0001ec50: 616e 6420 7769 6c6c 2072 756e 0a2f 2f2f  and will run.///
+0001ec60: 206c 6175 6e63 6820 6120 7468 7265 6164   launch a thread
+0001ec70: 2070 6f6f 6c20 7769 7468 2074 6872 6561   pool with threa
+0001ec80: 6473 2065 7175 616c 2074 6f20 7468 6520  ds equal to the 
+0001ec90: 6e75 6d62 6572 206f 6620 4350 5573 2062  number of CPUs b
+0001eca0: 7920 6465 6661 756c 742e 0a2f 2f2f 2059  y default../// Y
+0001ecb0: 6f75 2063 616e 2074 756e 6520 7468 6520  ou can tune the 
+0001ecc0: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
+0001ecd0: 7320 7769 7468 2074 6865 2060 6052 4159  s with the ``RAY
+0001ece0: 4f4e 5f4e 554d 5f54 4852 4541 4453 6060  ON_NUM_THREADS``
+0001ecf0: 0a2f 2f2f 2065 6e76 6972 6f6e 6d65 6e74  ./// environment
+0001ed00: 2076 6172 6961 626c 652e 2046 6f72 2065   variable. For e
+0001ed10: 7861 6d70 6c65 2c20 7365 7474 696e 6720  xample, setting 
+0001ed20: 6060 5241 594f 4e5f 4e55 4d5f 5448 5245  ``RAYON_NUM_THRE
+0001ed30: 4144 533d 3460 6020 776f 756c 640a 2f2f  ADS=4`` would.//
+0001ed40: 2f20 6c69 6d69 7420 7468 6520 7468 7265  / limit the thre
+0001ed50: 6164 2070 6f6f 6c20 746f 2034 2074 6872  ad pool to 4 thr
+0001ed60: 6561 6473 2e0a 2f2f 2f0a 2f2f 2f20 2e2e  eads..///./// ..
+0001ed70: 206e 6f74 653a 3a0a 2f2f 2f0a 2f2f 2f20   note::.///./// 
+0001ed80: 2020 2020 5468 6520 6675 6e63 7469 6f6e      The function
+0001ed90: 2069 6d70 6c69 6369 746c 7920 6173 7375   implicitly assu
+0001eda0: 6d65 7320 7468 6174 2074 6865 7265 2061  mes that there a
+0001edb0: 7265 206e 6f20 7061 7261 6c6c 656c 2065  re no parallel e
+0001edc0: 6467 6573 0a2f 2f2f 2020 2020 206f 7220  dges.///     or 
+0001edd0: 7365 6c66 206c 6f6f 7073 2e20 4974 206d  self loops. It m
+0001ede0: 6179 2070 726f 6475 6365 2069 6e63 6f72  ay produce incor
+0001edf0: 7265 6374 2f75 6e65 7870 6563 7465 6420  rect/unexpected 
+0001ee00: 7265 7375 6c74 7320 6966 2074 6865 0a2f  results if the./
+0001ee10: 2f2f 2020 2020 2069 6e70 7574 2067 7261  //     input gra
+0001ee20: 7068 2068 6173 2073 656c 6620 6c6f 6f70  ph has self loop
+0001ee30: 7320 6f72 2070 6172 616c 6c65 6c20 6564  s or parallel ed
+0001ee40: 6765 732e 0a2f 2f2f 0a2f 2f2f 203a 7061  ges..///./// :pa
+0001ee50: 7261 6d20 5079 4772 6170 6820 6772 6170  ram PyGraph grap
+0001ee60: 683a 2047 7261 7068 2074 6f20 6265 2075  h: Graph to be u
+0001ee70: 7365 642e 0a2f 2f2f 0a2f 2f2f 203a 7265  sed..///./// :re
+0001ee80: 7475 726e 733a 2054 7261 6e73 6974 6976  turns: Transitiv
+0001ee90: 6974 792e 0a2f 2f2f 203a 7274 7970 653a  ity../// :rtype:
+0001eea0: 2066 6c6f 6174 0a23 5b70 7966 756e 6374   float.#[pyfunct
+0001eeb0: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
+0001eec0: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+0001eed0: 202f 2922 5d0a 666e 2067 7261 7068 5f74   /)"].fn graph_t
+0001eee0: 7261 6e73 6974 6976 6974 7928 6772 6170  ransitivity(grap
+0001eef0: 683a 2026 6772 6170 683a 3a50 7947 7261  h: &graph::PyGra
+0001ef00: 7068 2920 2d3e 2066 3634 207b 0a20 2020  ph) -> f64 {.   
+0001ef10: 206c 6574 206e 6f64 655f 696e 6469 6365   let node_indice
+0001ef20: 733a 2056 6563 3c4e 6f64 6549 6e64 6578  s: Vec<NodeIndex
+0001ef30: 3e20 3d20 6772 6170 682e 6772 6170 682e  > = graph.graph.
+0001ef40: 6e6f 6465 5f69 6e64 6963 6573 2829 2e63  node_indices().c
+0001ef50: 6f6c 6c65 6374 2829 3b0a 2020 2020 6c65  ollect();.    le
+0001ef60: 7420 2874 7269 616e 676c 6573 2c20 7472  t (triangles, tr
+0001ef70: 6970 6c65 7329 203d 206e 6f64 655f 696e  iples) = node_in
+0001ef80: 6469 6365 730a 2020 2020 2020 2020 2e70  dices.        .p
+0001ef90: 6172 5f69 7465 7228 290a 2020 2020 2020  ar_iter().      
+0001efa0: 2020 2e6d 6170 287c 6e6f 6465 7c20 5f67    .map(|node| _g
+0001efb0: 7261 7068 5f74 7269 616e 676c 6573 2867  raph_triangles(g
+0001efc0: 7261 7068 2c20 6e6f 6465 2e69 6e64 6578  raph, node.index
+0001efd0: 2829 2929 0a20 2020 2020 2020 202e 7265  ())).        .re
+0001efe0: 6475 6365 280a 2020 2020 2020 2020 2020  duce(.          
+0001eff0: 2020 7c7c 2028 302c 2030 292c 0a20 2020    || (0, 0),.   
+0001f000: 2020 2020 2020 2020 207c 2873 756d 782c           |(sumx,
+0001f010: 2073 756d 7929 2c20 2872 6573 782c 2072   sumy), (resx, r
+0001f020: 6573 7929 7c20 2873 756d 7820 2b20 7265  esy)| (sumx + re
+0001f030: 7378 2c20 7375 6d79 202b 2072 6573 7929  sx, sumy + resy)
+0001f040: 2c0a 2020 2020 2020 2020 293b 0a0a 2020  ,.        );..  
+0001f050: 2020 6d61 7463 6820 7472 6961 6e67 6c65    match triangle
+0001f060: 7320 7b0a 2020 2020 2020 2020 3020 3d3e  s {.        0 =>
+0001f070: 2030 2e30 2c0a 2020 2020 2020 2020 5f20   0.0,.        _ 
+0001f080: 3d3e 2074 7269 616e 676c 6573 2061 7320  => triangles as 
+0001f090: 6636 3420 2f20 7472 6970 6c65 7320 6173  f64 / triples as
+0001f0a0: 2066 3634 2c0a 2020 2020 7d0a 7d0a 0a66   f64,.    }.}..f
+0001f0b0: 6e20 5f64 6967 7261 7068 5f74 7269 616e  n _digraph_trian
+0001f0c0: 676c 6573 280a 2020 2020 6772 6170 683a  gles(.    graph:
+0001f0d0: 2026 6469 6772 6170 683a 3a50 7944 6947   &digraph::PyDiG
+0001f0e0: 7261 7068 2c0a 2020 2020 6e6f 6465 3a20  raph,.    node: 
+0001f0f0: 7573 697a 652c 0a29 202d 3e20 2875 7369  usize,.) -> (usi
+0001f100: 7a65 2c20 7573 697a 6529 207b 0a20 2020  ze, usize) {.   
+0001f110: 206c 6574 206d 7574 2074 7269 616e 676c   let mut triangl
+0001f120: 6573 3a20 7573 697a 6520 3d20 303b 0a0a  es: usize = 0;..
+0001f130: 2020 2020 6c65 7420 696e 6465 7820 3d20      let index = 
+0001f140: 4e6f 6465 496e 6465 783a 3a6e 6577 286e  NodeIndex::new(n
+0001f150: 6f64 6529 3b0a 2020 2020 6c65 7420 6d75  ode);.    let mu
+0001f160: 7420 6f75 745f 6e65 6967 6862 6f72 733a  t out_neighbors:
+0001f170: 2048 6173 6853 6574 3c4e 6f64 6549 6e64   HashSet<NodeInd
+0001f180: 6578 3e20 3d20 6772 6170 680a 2020 2020  ex> = graph.    
+0001f190: 2020 2020 2e67 7261 7068 0a20 2020 2020      .graph.     
+0001f1a0: 2020 202e 6e65 6967 6862 6f72 735f 6469     .neighbors_di
+0001f1b0: 7265 6374 6564 2869 6e64 6578 2c20 7065  rected(index, pe
+0001f1c0: 7467 7261 7068 3a3a 4469 7265 6374 696f  tgraph::Directio
+0001f1d0: 6e3a 3a4f 7574 676f 696e 6729 0a20 2020  n::Outgoing).   
+0001f1e0: 2020 2020 202e 636f 6c6c 6563 7428 293b       .collect();
+0001f1f0: 0a20 2020 206f 7574 5f6e 6569 6768 626f  .    out_neighbo
+0001f200: 7273 2e72 656d 6f76 6528 2669 6e64 6578  rs.remove(&index
+0001f210: 293b 0a0a 2020 2020 6c65 7420 6d75 7420  );..    let mut 
+0001f220: 696e 5f6e 6569 6768 626f 7273 3a20 4861  in_neighbors: Ha
+0001f230: 7368 5365 743c 4e6f 6465 496e 6465 783e  shSet<NodeIndex>
+0001f240: 203d 2067 7261 7068 0a20 2020 2020 2020   = graph.       
+0001f250: 202e 6772 6170 680a 2020 2020 2020 2020   .graph.        
+0001f260: 2e6e 6569 6768 626f 7273 5f64 6972 6563  .neighbors_direc
+0001f270: 7465 6428 696e 6465 782c 2070 6574 6772  ted(index, petgr
+0001f280: 6170 683a 3a44 6972 6563 7469 6f6e 3a3a  aph::Direction::
+0001f290: 496e 636f 6d69 6e67 290a 2020 2020 2020  Incoming).      
+0001f2a0: 2020 2e63 6f6c 6c65 6374 2829 3b0a 2020    .collect();.  
+0001f2b0: 2020 696e 5f6e 6569 6768 626f 7273 2e72    in_neighbors.r
+0001f2c0: 656d 6f76 6528 2669 6e64 6578 293b 0a0a  emove(&index);..
+0001f2d0: 2020 2020 6c65 7420 6e65 6967 6862 6f72      let neighbor
+0001f2e0: 7320 3d20 6f75 745f 6e65 6967 6862 6f72  s = out_neighbor
+0001f2f0: 732e 6974 6572 2829 2e63 6861 696e 2869  s.iter().chain(i
+0001f300: 6e5f 6e65 6967 6862 6f72 732e 6974 6572  n_neighbors.iter
+0001f310: 2829 293b 0a0a 2020 2020 666f 7220 6e6f  ());..    for no
+0001f320: 6465 7620 696e 206e 6569 6768 626f 7273  dev in neighbors
+0001f330: 207b 0a20 2020 2020 2020 2074 7269 616e   {.        trian
+0001f340: 676c 6573 202b 3d20 6772 6170 680a 2020  gles += graph.  
+0001f350: 2020 2020 2020 2020 2020 2e67 7261 7068            .graph
+0001f360: 0a20 2020 2020 2020 2020 2020 202e 6e65  .            .ne
+0001f370: 6967 6862 6f72 735f 6469 7265 6374 6564  ighbors_directed
+0001f380: 282a 6e6f 6465 762c 2070 6574 6772 6170  (*nodev, petgrap
+0001f390: 683a 3a44 6972 6563 7469 6f6e 3a3a 4f75  h::Direction::Ou
+0001f3a0: 7467 6f69 6e67 290a 2020 2020 2020 2020  tgoing).        
+0001f3b0: 2020 2020 2e63 6861 696e 280a 2020 2020      .chain(.    
+0001f3c0: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+0001f3d0: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+0001f3e0: 2020 2020 2020 2e67 7261 7068 0a20 2020        .graph.   
+0001f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f400: 202e 6e65 6967 6862 6f72 735f 6469 7265   .neighbors_dire
+0001f410: 6374 6564 282a 6e6f 6465 762c 2070 6574  cted(*nodev, pet
+0001f420: 6772 6170 683a 3a44 6972 6563 7469 6f6e  graph::Direction
+0001f430: 3a3a 496e 636f 6d69 6e67 292c 0a20 2020  ::Incoming),.   
+0001f440: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001f450: 2020 2020 2020 202e 6d61 7028 7c78 7c20         .map(|x| 
+0001f460: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0001f470: 2020 6c65 7420 6d75 7420 7265 733a 2075    let mut res: u
+0001f480: 7369 7a65 203d 2030 3b0a 0a20 2020 2020  size = 0;..     
+0001f490: 2020 2020 2020 2020 2020 2069 6620 2878             if (x
+0001f4a0: 2021 3d20 2a6e 6f64 6576 2920 2626 206f   != *nodev) && o
+0001f4b0: 7574 5f6e 6569 6768 626f 7273 2e63 6f6e  ut_neighbors.con
+0001f4c0: 7461 696e 7328 2678 2920 7b0a 2020 2020  tains(&x) {.    
+0001f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4e0: 7265 7320 2b3d 2031 3b0a 2020 2020 2020  res += 1;.      
+0001f4f0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0001f500: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+0001f510: 7820 213d 202a 6e6f 6465 7629 2026 2620  x != *nodev) && 
+0001f520: 696e 5f6e 6569 6768 626f 7273 2e63 6f6e  in_neighbors.con
+0001f530: 7461 696e 7328 2678 2920 7b0a 2020 2020  tains(&x) {.    
+0001f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f550: 7265 7320 2b3d 2031 3b0a 2020 2020 2020  res += 1;.      
+0001f560: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0001f570: 2020 2020 2020 2020 2020 2020 7265 730a              res.
+0001f580: 2020 2020 2020 2020 2020 2020 7d29 0a20              }). 
+0001f590: 2020 2020 2020 2020 2020 202e 7375 6d3a             .sum:
+0001f5a0: 3a3c 7573 697a 653e 2829 3b0a 2020 2020  :<usize>();.    
+0001f5b0: 7d0a 0a20 2020 206c 6574 2064 696e 3a20  }..    let din: 
+0001f5c0: 7573 697a 6520 3d20 696e 5f6e 6569 6768  usize = in_neigh
+0001f5d0: 626f 7273 2e6c 656e 2829 3b0a 2020 2020  bors.len();.    
+0001f5e0: 6c65 7420 646f 7574 3a20 7573 697a 6520  let dout: usize 
+0001f5f0: 3d20 6f75 745f 6e65 6967 6862 6f72 732e  = out_neighbors.
+0001f600: 6c65 6e28 293b 0a0a 2020 2020 6c65 7420  len();..    let 
+0001f610: 6474 6f74 203d 2064 6f75 7420 2b20 6469  dtot = dout + di
+0001f620: 6e3b 0a20 2020 206c 6574 2064 6269 6c3a  n;.    let dbil:
+0001f630: 2075 7369 7a65 203d 206f 7574 5f6e 6569   usize = out_nei
+0001f640: 6768 626f 7273 2e69 6e74 6572 7365 6374  ghbors.intersect
+0001f650: 696f 6e28 2669 6e5f 6e65 6967 6862 6f72  ion(&in_neighbor
+0001f660: 7329 2e63 6f75 6e74 2829 3b0a 2020 2020  s).count();.    
+0001f670: 6c65 7420 7472 6970 6c65 733a 2075 7369  let triples: usi
+0001f680: 7a65 203d 206d 6174 6368 2064 746f 7420  ze = match dtot 
+0001f690: 7b0a 2020 2020 2020 2020 3020 3d3e 2030  {.        0 => 0
+0001f6a0: 2c0a 2020 2020 2020 2020 5f20 3d3e 2064  ,.        _ => d
+0001f6b0: 746f 7420 2a20 2864 746f 7420 2d20 3129  tot * (dtot - 1)
+0001f6c0: 202d 2032 202a 2064 6269 6c2c 0a20 2020   - 2 * dbil,.   
+0001f6d0: 207d 3b0a 0a20 2020 2028 7472 6961 6e67   };..    (triang
+0001f6e0: 6c65 7320 2f20 322c 2074 7269 706c 6573  les / 2, triples
+0001f6f0: 290a 7d0a 0a2f 2f2f 2043 6f6d 7075 7465  ).}../// Compute
+0001f700: 2074 6865 2074 7261 6e73 6974 6976 6974   the transitivit
+0001f710: 7920 6f66 2061 2064 6972 6563 7465 6420  y of a directed 
+0001f720: 6772 6170 682e 0a2f 2f2f 0a2f 2f2f 2054  graph..///./// T
+0001f730: 6865 2074 7261 6e73 6974 6976 6974 7920  he transitivity 
+0001f740: 6f66 2061 2064 6972 6563 7465 6420 6772  of a directed gr
+0001f750: 6170 6820 6973 2064 6566 696e 6564 2069  aph is defined i
+0001f760: 6e20 5b46 6167 5d5f 2c20 4571 2e38 3a0a  n [Fag]_, Eq.8:.
+0001f770: 2f2f 2f0a 2f2f 2f20 2e2e 206d 6174 683a  ///./// .. math:
+0001f780: 3a0a 2f2f 2f20 2020 2020 6063 3d33 205c  :.///     `c=3 \
+0001f790: 7469 6d65 7320 5c66 7261 637b 5c74 6578  times \frac{\tex
+0001f7a0: 747b 6e75 6d62 6572 206f 6620 7472 6961  t{number of tria
+0001f7b0: 6e67 6c65 737d 7d7b 5c74 6578 747b 6e75  ngles}}{\text{nu
+0001f7c0: 6d62 6572 206f 6620 616c 6c20 706f 7373  mber of all poss
+0001f7d0: 6962 6c65 2074 7269 616e 676c 6573 7d7d  ible triangles}}
+0001f7e0: 600a 2f2f 2f0a 2f2f 2f20 4120 7472 6961  `.///./// A tria
+0001f7f0: 6e67 6c65 2069 7320 6120 636f 6e6e 6563  ngle is a connec
+0001f800: 7465 6420 7472 6970 6c65 206f 6620 6e6f  ted triple of no
+0001f810: 6465 732e 0a2f 2f2f 2044 6966 6665 7265  des../// Differe
+0001f820: 6e74 2065 6467 6520 6f72 6965 6e74 6174  nt edge orientat
+0001f830: 696f 6e73 2063 6f75 6e74 7320 6173 2064  ions counts as d
+0001f840: 6966 6665 7265 6e74 2074 7269 616e 676c  ifferent triangl
+0001f850: 6573 2e0a 2f2f 2f0a 2f2f 2f20 5468 6973  es..///./// This
+0001f860: 2066 756e 6374 696f 6e20 6973 206d 756c   function is mul
+0001f870: 7469 7468 7265 6164 6564 2061 6e64 2077  tithreaded and w
+0001f880: 696c 6c20 7275 6e0a 2f2f 2f20 6c61 756e  ill run./// laun
+0001f890: 6368 2061 2074 6872 6561 6420 706f 6f6c  ch a thread pool
+0001f8a0: 2077 6974 6820 7468 7265 6164 7320 6571   with threads eq
+0001f8b0: 7561 6c20 746f 2074 6865 206e 756d 6265  ual to the numbe
+0001f8c0: 7220 6f66 2043 5055 7320 6279 2064 6566  r of CPUs by def
+0001f8d0: 6175 6c74 2e0a 2f2f 2f20 596f 7520 6361  ault../// You ca
+0001f8e0: 6e20 7475 6e65 2074 6865 206e 756d 6265  n tune the numbe
+0001f8f0: 7220 6f66 2074 6872 6561 6473 2077 6974  r of threads wit
+0001f900: 6820 7468 6520 6060 5241 594f 4e5f 4e55  h the ``RAYON_NU
+0001f910: 4d5f 5448 5245 4144 5360 600a 2f2f 2f20  M_THREADS``./// 
+0001f920: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
+0001f930: 6162 6c65 2e20 466f 7220 6578 616d 706c  able. For exampl
+0001f940: 652c 2073 6574 7469 6e67 2060 6052 4159  e, setting ``RAY
+0001f950: 4f4e 5f4e 554d 5f54 4852 4541 4453 3d34  ON_NUM_THREADS=4
+0001f960: 6060 2077 6f75 6c64 0a2f 2f2f 206c 696d  `` would./// lim
+0001f970: 6974 2074 6865 2074 6872 6561 6420 706f  it the thread po
+0001f980: 6f6c 2074 6f20 3420 7468 7265 6164 732e  ol to 4 threads.
+0001f990: 0a2f 2f2f 0a2f 2f2f 202e 2e20 6e6f 7465  .///./// .. note
+0001f9a0: 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020 2054  ::.///.///     T
+0001f9b0: 6865 2066 756e 6374 696f 6e20 696d 706c  he function impl
+0001f9c0: 6963 6974 6c79 2061 7373 756d 6573 2074  icitly assumes t
+0001f9d0: 6861 7420 7468 6572 6520 6172 6520 6e6f  hat there are no
+0001f9e0: 2070 6172 616c 6c65 6c20 6564 6765 730a   parallel edges.
+0001f9f0: 2f2f 2f20 2020 2020 6f72 2073 656c 6620  ///     or self 
+0001fa00: 6c6f 6f70 732e 2049 7420 6d61 7920 7072  loops. It may pr
+0001fa10: 6f64 7563 6520 696e 636f 7272 6563 742f  oduce incorrect/
+0001fa20: 756e 6578 7065 6374 6564 2072 6573 756c  unexpected resul
+0001fa30: 7473 2069 6620 7468 650a 2f2f 2f20 2020  ts if the.///   
+0001fa40: 2020 696e 7075 7420 6772 6170 6820 6861    input graph ha
+0001fa50: 7320 7365 6c66 206c 6f6f 7073 206f 7220  s self loops or 
+0001fa60: 7061 7261 6c6c 656c 2065 6467 6573 2e0a  parallel edges..
+0001fa70: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+0001fa80: 7944 6947 7261 7068 2067 7261 7068 3a20  yDiGraph graph: 
+0001fa90: 4469 7265 6374 6564 2067 7261 7068 2074  Directed graph t
+0001faa0: 6f20 6265 2075 7365 642e 0a2f 2f2f 0a2f  o be used..///./
+0001fab0: 2f2f 203a 7265 7475 726e 733a 2054 7261  // :returns: Tra
+0001fac0: 6e73 6974 6976 6974 792e 0a2f 2f2f 203a  nsitivity../// :
+0001fad0: 7274 7970 653a 2066 6c6f 6174 0a2f 2f2f  rtype: float.///
+0001fae0: 0a2f 2f2f 202e 2e20 5b46 6167 5d20 436c  ./// .. [Fag] Cl
+0001faf0: 7573 7465 7269 6e67 2069 6e20 636f 6d70  ustering in comp
+0001fb00: 6c65 7820 6469 7265 6374 6564 206e 6574  lex directed net
+0001fb10: 776f 726b 7320 6279 2047 2e20 4661 6769  works by G. Fagi
+0001fb20: 6f6c 6f2c 0a2f 2f2f 2020 2020 5068 7973  olo,.///    Phys
+0001fb30: 6963 616c 2052 6576 6965 7720 452c 2037  ical Review E, 7
+0001fb40: 3628 3229 2c20 3032 3631 3037 2028 3230  6(2), 026107 (20
+0001fb50: 3037 290a 235b 7079 6675 6e63 7469 6f6e  07).#[pyfunction
+0001fb60: 5d0a 235b 7465 7874 5f73 6967 6e61 7475  ].#[text_signatu
+0001fb70: 7265 203d 2022 2867 7261 7068 2c20 2f29  re = "(graph, /)
+0001fb80: 225d 0a66 6e20 6469 6772 6170 685f 7472  "].fn digraph_tr
+0001fb90: 616e 7369 7469 7669 7479 2867 7261 7068  ansitivity(graph
+0001fba0: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+0001fbb0: 4772 6170 6829 202d 3e20 6636 3420 7b0a  Graph) -> f64 {.
+0001fbc0: 2020 2020 6c65 7420 6e6f 6465 5f69 6e64      let node_ind
+0001fbd0: 6963 6573 3a20 5665 633c 4e6f 6465 496e  ices: Vec<NodeIn
+0001fbe0: 6465 783e 203d 2067 7261 7068 2e67 7261  dex> = graph.gra
+0001fbf0: 7068 2e6e 6f64 655f 696e 6469 6365 7328  ph.node_indices(
+0001fc00: 292e 636f 6c6c 6563 7428 293b 0a20 2020  ).collect();.   
+0001fc10: 206c 6574 2028 7472 6961 6e67 6c65 732c   let (triangles,
+0001fc20: 2074 7269 706c 6573 2920 3d20 6e6f 6465   triples) = node
+0001fc30: 5f69 6e64 6963 6573 0a20 2020 2020 2020  _indices.       
+0001fc40: 202e 7061 725f 6974 6572 2829 0a20 2020   .par_iter().   
+0001fc50: 2020 2020 202e 6d61 7028 7c6e 6f64 657c       .map(|node|
+0001fc60: 205f 6469 6772 6170 685f 7472 6961 6e67   _digraph_triang
+0001fc70: 6c65 7328 6772 6170 682c 206e 6f64 652e  les(graph, node.
+0001fc80: 696e 6465 7828 2929 290a 2020 2020 2020  index())).      
+0001fc90: 2020 2e72 6564 7563 6528 0a20 2020 2020    .reduce(.     
+0001fca0: 2020 2020 2020 207c 7c20 2830 2c20 3029         || (0, 0)
+0001fcb0: 2c0a 2020 2020 2020 2020 2020 2020 7c28  ,.            |(
+0001fcc0: 7375 6d78 2c20 7375 6d79 292c 2028 7265  sumx, sumy), (re
+0001fcd0: 7378 2c20 7265 7379 297c 2028 7375 6d78  sx, resy)| (sumx
+0001fce0: 202b 2072 6573 782c 2073 756d 7920 2b20   + resx, sumy + 
+0001fcf0: 7265 7379 292c 0a20 2020 2020 2020 2029  resy),.        )
+0001fd00: 3b0a 0a20 2020 206d 6174 6368 2074 7269  ;..    match tri
+0001fd10: 616e 676c 6573 207b 0a20 2020 2020 2020  angles {.       
+0001fd20: 2030 203d 3e20 302e 302c 0a20 2020 2020   0 => 0.0,.     
+0001fd30: 2020 205f 203d 3e20 7472 6961 6e67 6c65     _ => triangle
+0001fd40: 7320 6173 2066 3634 202f 2074 7269 706c  s as f64 / tripl
+0001fd50: 6573 2061 7320 6636 342c 0a20 2020 207d  es as f64,.    }
+0001fd60: 0a7d 0a0a 7075 6220 666e 205f 636f 7265  .}..pub fn _core
+0001fd70: 5f6e 756d 6265 723c 5479 3e28 0a20 2020  _number<Ty>(.   
+0001fd80: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
+0001fd90: 2067 7261 7068 3a20 2653 7461 626c 6547   graph: &StableG
+0001fda0: 7261 7068 3c50 794f 626a 6563 742c 2050  raph<PyObject, P
+0001fdb0: 794f 626a 6563 742c 2054 793e 2c0a 2920  yObject, Ty>,.) 
+0001fdc0: 2d3e 2050 7952 6573 756c 743c 5079 4f62  -> PyResult<PyOb
+0001fdd0: 6a65 6374 3e0a 7768 6572 650a 2020 2020  ject>.where.    
+0001fde0: 5479 3a20 4564 6765 5479 7065 2c0a 7b0a  Ty: EdgeType,.{.
+0001fdf0: 2020 2020 6c65 7420 6e6f 6465 5f6e 756d      let node_num
+0001fe00: 203d 2067 7261 7068 2e6e 6f64 655f 636f   = graph.node_co
+0001fe10: 756e 7428 293b 0a20 2020 2069 6620 6e6f  unt();.    if no
+0001fe20: 6465 5f6e 756d 203d 3d20 3020 7b0a 2020  de_num == 0 {.  
+0001fe30: 2020 2020 2020 7265 7475 726e 204f 6b28        return Ok(
+0001fe40: 5079 4469 6374 3a3a 6e65 7728 7079 292e  PyDict::new(py).
+0001fe50: 696e 746f 2829 293b 0a20 2020 207d 0a0a  into());.    }..
+0001fe60: 2020 2020 6c65 7420 6d75 7420 636f 7265      let mut core
+0001fe70: 733a 2048 6173 684d 6170 3c4e 6f64 6549  s: HashMap<NodeI
+0001fe80: 6e64 6578 2c20 7573 697a 653e 203d 2048  ndex, usize> = H
+0001fe90: 6173 684d 6170 3a3a 7769 7468 5f63 6170  ashMap::with_cap
+0001fea0: 6163 6974 7928 6e6f 6465 5f6e 756d 293b  acity(node_num);
+0001feb0: 0a20 2020 206c 6574 206d 7574 206e 6f64  .    let mut nod
+0001fec0: 655f 7665 633a 2056 6563 3c4e 6f64 6549  e_vec: Vec<NodeI
+0001fed0: 6e64 6578 3e20 3d20 6772 6170 682e 6e6f  ndex> = graph.no
+0001fee0: 6465 5f69 6e64 6963 6573 2829 2e63 6f6c  de_indices().col
+0001fef0: 6c65 6374 2829 3b0a 2020 2020 6c65 7420  lect();.    let 
+0001ff00: 6d75 7420 6465 6772 6565 5f6d 6170 3a20  mut degree_map: 
+0001ff10: 4861 7368 4d61 703c 4e6f 6465 496e 6465  HashMap<NodeInde
+0001ff20: 782c 2075 7369 7a65 3e20 3d0a 2020 2020  x, usize> =.    
+0001ff30: 2020 2020 4861 7368 4d61 703a 3a77 6974      HashMap::wit
+0001ff40: 685f 6361 7061 6369 7479 286e 6f64 655f  h_capacity(node_
+0001ff50: 6e75 6d29 3b0a 2020 2020 6c65 7420 6d75  num);.    let mu
+0001ff60: 7420 6e62 7273 3a20 4861 7368 4d61 703c  t nbrs: HashMap<
+0001ff70: 4e6f 6465 496e 6465 782c 2048 6173 6853  NodeIndex, HashS
+0001ff80: 6574 3c4e 6f64 6549 6e64 6578 3e3e 203d  et<NodeIndex>> =
+0001ff90: 0a20 2020 2020 2020 2048 6173 684d 6170  .        HashMap
+0001ffa0: 3a3a 7769 7468 5f63 6170 6163 6974 7928  ::with_capacity(
+0001ffb0: 6e6f 6465 5f6e 756d 293b 0a20 2020 206c  node_num);.    l
+0001ffc0: 6574 206d 7574 206e 6f64 655f 706f 733a  et mut node_pos:
+0001ffd0: 2048 6173 684d 6170 3c4e 6f64 6549 6e64   HashMap<NodeInd
+0001ffe0: 6578 2c20 7573 697a 653e 203d 0a20 2020  ex, usize> =.   
+0001fff0: 2020 2020 2048 6173 684d 6170 3a3a 7769       HashMap::wi
+00020000: 7468 5f63 6170 6163 6974 7928 6e6f 6465  th_capacity(node
+00020010: 5f6e 756d 293b 0a0a 2020 2020 666f 7220  _num);..    for 
+00020020: 6b20 696e 206e 6f64 655f 7665 632e 6974  k in node_vec.it
+00020030: 6572 2829 207b 0a20 2020 2020 2020 206c  er() {.        l
+00020040: 6574 206b 5f6e 6272 733a 2048 6173 6853  et k_nbrs: HashS
+00020050: 6574 3c4e 6f64 6549 6e64 6578 3e20 3d0a  et<NodeIndex> =.
+00020060: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+00020070: 682e 6e65 6967 6862 6f72 735f 756e 6469  h.neighbors_undi
+00020080: 7265 6374 6564 282a 6b29 2e63 6f6c 6c65  rected(*k).colle
+00020090: 6374 2829 3b0a 2020 2020 2020 2020 6c65  ct();.        le
+000200a0: 7420 6b5f 6465 6720 3d20 6b5f 6e62 7273  t k_deg = k_nbrs
+000200b0: 2e6c 656e 2829 3b0a 0a20 2020 2020 2020  .len();..       
+000200c0: 206e 6272 732e 696e 7365 7274 282a 6b2c   nbrs.insert(*k,
+000200d0: 206b 5f6e 6272 7329 3b0a 2020 2020 2020   k_nbrs);.      
+000200e0: 2020 636f 7265 732e 696e 7365 7274 282a    cores.insert(*
+000200f0: 6b2c 206b 5f64 6567 293b 0a20 2020 2020  k, k_deg);.     
+00020100: 2020 2064 6567 7265 655f 6d61 702e 696e     degree_map.in
+00020110: 7365 7274 282a 6b2c 206b 5f64 6567 293b  sert(*k, k_deg);
+00020120: 0a20 2020 207d 0a20 2020 206e 6f64 655f  .    }.    node_
+00020130: 7665 632e 7061 725f 736f 7274 5f62 795f  vec.par_sort_by_
+00020140: 6b65 7928 7c6b 7c20 6465 6772 6565 5f6d  key(|k| degree_m
+00020150: 6170 2e67 6574 286b 2929 3b0a 0a20 2020  ap.get(k));..   
+00020160: 206c 6574 206d 7574 2062 696e 5f62 6f75   let mut bin_bou
+00020170: 6e64 6172 6965 733a 2056 6563 3c75 7369  ndaries: Vec<usi
+00020180: 7a65 3e20 3d0a 2020 2020 2020 2020 5665  ze> =.        Ve
+00020190: 633a 3a77 6974 685f 6361 7061 6369 7479  c::with_capacity
+000201a0: 2864 6567 7265 655f 6d61 705b 266e 6f64  (degree_map[&nod
+000201b0: 655f 7665 635b 6e6f 6465 5f6e 756d 202d  e_vec[node_num -
+000201c0: 2031 5d5d 202b 2031 293b 0a20 2020 2062   1]] + 1);.    b
+000201d0: 696e 5f62 6f75 6e64 6172 6965 732e 7075  in_boundaries.pu
+000201e0: 7368 2830 293b 0a20 2020 206c 6574 206d  sh(0);.    let m
+000201f0: 7574 2063 7572 725f 6465 6772 6565 203d  ut curr_degree =
+00020200: 2030 3b0a 2020 2020 666f 7220 2869 2c20   0;.    for (i, 
+00020210: 7629 2069 6e20 6e6f 6465 5f76 6563 2e69  v) in node_vec.i
+00020220: 7465 7228 292e 656e 756d 6572 6174 6528  ter().enumerate(
+00020230: 2920 7b0a 2020 2020 2020 2020 6e6f 6465  ) {.        node
+00020240: 5f70 6f73 2e69 6e73 6572 7428 2a76 2c20  _pos.insert(*v, 
+00020250: 6929 3b0a 2020 2020 2020 2020 6c65 7420  i);.        let 
+00020260: 765f 6465 6772 6565 203d 2064 6567 7265  v_degree = degre
+00020270: 655f 6d61 705b 765d 3b0a 2020 2020 2020  e_map[v];.      
+00020280: 2020 6966 2076 5f64 6567 7265 6520 3e20    if v_degree > 
+00020290: 6375 7272 5f64 6567 7265 6520 7b0a 2020  curr_degree {.  
+000202a0: 2020 2020 2020 2020 2020 666f 7220 5f20            for _ 
+000202b0: 696e 2030 2e2e 765f 6465 6772 6565 202d  in 0..v_degree -
+000202c0: 2063 7572 725f 6465 6772 6565 207b 0a20   curr_degree {. 
+000202d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000202e0: 696e 5f62 6f75 6e64 6172 6965 732e 7075  in_boundaries.pu
+000202f0: 7368 2869 293b 0a20 2020 2020 2020 2020  sh(i);.         
+00020300: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00020310: 2063 7572 725f 6465 6772 6565 203d 2076   curr_degree = v
+00020320: 5f64 6567 7265 653b 0a20 2020 2020 2020  _degree;.       
+00020330: 207d 0a20 2020 207d 0a0a 2020 2020 666f   }.    }..    fo
+00020340: 7220 765f 696e 6420 696e 2030 2e2e 6e6f  r v_ind in 0..no
+00020350: 6465 5f76 6563 2e6c 656e 2829 207b 0a20  de_vec.len() {. 
+00020360: 2020 2020 2020 206c 6574 2076 203d 206e         let v = n
+00020370: 6f64 655f 7665 635b 765f 696e 645d 3b0a  ode_vec[v_ind];.
+00020380: 2020 2020 2020 2020 6c65 7420 765f 6e62          let v_nb
+00020390: 7273 203d 206e 6272 735b 2676 5d2e 636c  rs = nbrs[&v].cl
+000203a0: 6f6e 6528 293b 0a20 2020 2020 2020 2066  one();.        f
+000203b0: 6f72 2075 2069 6e20 765f 6e62 7273 207b  or u in v_nbrs {
+000203c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000203d0: 636f 7265 735b 2675 5d20 3e20 636f 7265  cores[&u] > core
+000203e0: 735b 2676 5d20 7b0a 2020 2020 2020 2020  s[&v] {.        
+000203f0: 2020 2020 2020 2020 6e62 7273 2e67 6574          nbrs.get
+00020400: 5f6d 7574 2826 7529 2e75 6e77 7261 7028  _mut(&u).unwrap(
+00020410: 292e 7265 6d6f 7665 2826 7629 3b0a 2020  ).remove(&v);.  
+00020420: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00020430: 7420 706f 7320 3d20 6e6f 6465 5f70 6f73  t pos = node_pos
+00020440: 5b26 755d 3b0a 2020 2020 2020 2020 2020  [&u];.          
+00020450: 2020 2020 2020 6c65 7420 6269 6e5f 7374        let bin_st
+00020460: 6172 7420 3d20 6269 6e5f 626f 756e 6461  art = bin_bounda
+00020470: 7269 6573 5b63 6f72 6573 5b26 755d 5d3b  ries[cores[&u]];
+00020480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020490: 202a 6e6f 6465 5f70 6f73 2e67 6574 5f6d   *node_pos.get_m
+000204a0: 7574 2826 7529 2e75 6e77 7261 7028 2920  ut(&u).unwrap() 
+000204b0: 3d20 6269 6e5f 7374 6172 743b 0a20 2020  = bin_start;.   
+000204c0: 2020 2020 2020 2020 2020 2020 202a 6e6f               *no
+000204d0: 6465 5f70 6f73 2e67 6574 5f6d 7574 2826  de_pos.get_mut(&
+000204e0: 6e6f 6465 5f76 6563 5b62 696e 5f73 7461  node_vec[bin_sta
+000204f0: 7274 5d29 2e75 6e77 7261 7028 2920 3d20  rt]).unwrap() = 
+00020500: 706f 733b 0a20 2020 2020 2020 2020 2020  pos;.           
+00020510: 2020 2020 206e 6f64 655f 7665 632e 7377       node_vec.sw
+00020520: 6170 2862 696e 5f73 7461 7274 2c20 706f  ap(bin_start, po
+00020530: 7329 3b0a 2020 2020 2020 2020 2020 2020  s);.            
+00020540: 2020 2020 6269 6e5f 626f 756e 6461 7269      bin_boundari
+00020550: 6573 5b63 6f72 6573 5b26 755d 5d20 2b3d  es[cores[&u]] +=
+00020560: 2031 3b0a 2020 2020 2020 2020 2020 2020   1;.            
+00020570: 2020 2020 2a63 6f72 6573 2e67 6574 5f6d      *cores.get_m
+00020580: 7574 2826 7529 2e75 6e77 7261 7028 2920  ut(&u).unwrap() 
+00020590: 2d3d 2031 3b0a 2020 2020 2020 2020 2020  -= 1;.          
+000205a0: 2020 7d0a 2020 2020 2020 2020 7d0a 2020    }.        }.  
+000205b0: 2020 7d0a 0a20 2020 206c 6574 206f 7574    }..    let out
+000205c0: 5f64 6963 7420 3d20 5079 4469 6374 3a3a  _dict = PyDict::
+000205d0: 6e65 7728 7079 293b 0a20 2020 2066 6f72  new(py);.    for
+000205e0: 2028 765f 696e 6465 782c 2063 6f72 6529   (v_index, core)
+000205f0: 2069 6e20 636f 7265 7320 7b0a 2020 2020   in cores {.    
+00020600: 2020 2020 6f75 745f 6469 6374 2e73 6574      out_dict.set
+00020610: 5f69 7465 6d28 765f 696e 6465 782e 696e  _item(v_index.in
+00020620: 6465 7828 292c 2063 6f72 6529 3f3b 0a20  dex(), core)?;. 
+00020630: 2020 207d 0a20 2020 204f 6b28 6f75 745f     }.    Ok(out_
+00020640: 6469 6374 2e69 6e74 6f28 2929 0a7d 0a0a  dict.into()).}..
+00020650: 2f2f 2f20 5265 7475 726e 2074 6865 2063  /// Return the c
+00020660: 6f72 6520 6e75 6d62 6572 2066 6f72 2065  ore number for e
+00020670: 6163 6820 6e6f 6465 2069 6e20 7468 6520  ach node in the 
+00020680: 6772 6170 682e 0a2f 2f2f 0a2f 2f2f 2041  graph..///./// A
+00020690: 206b 2d63 6f72 6520 6973 2061 206d 6178   k-core is a max
+000206a0: 696d 616c 2073 7562 6772 6170 6820 7468  imal subgraph th
+000206b0: 6174 2063 6f6e 7461 696e 7320 6e6f 6465  at contains node
+000206c0: 7320 6f66 2064 6567 7265 6520 6b20 6f72  s of degree k or
+000206d0: 206d 6f72 652e 0a2f 2f2f 0a2f 2f2f 202e   more..///./// .
+000206e0: 2e20 6e6f 7465 3a3a 0a2f 2f2f 0a2f 2f2f  . note::.///.///
+000206f0: 2020 2020 2054 6865 2066 756e 6374 696f       The functio
+00020700: 6e20 696d 706c 6963 6974 6c79 2061 7373  n implicitly ass
+00020710: 756d 6573 2074 6861 7420 7468 6572 6520  umes that there 
+00020720: 6172 6520 6e6f 2070 6172 616c 6c65 6c20  are no parallel 
+00020730: 6564 6765 730a 2f2f 2f20 2020 2020 6f72  edges.///     or
+00020740: 2073 656c 6620 6c6f 6f70 732e 2049 7420   self loops. It 
+00020750: 6d61 7920 7072 6f64 7563 6520 696e 636f  may produce inco
+00020760: 7272 6563 742f 756e 6578 7065 6374 6564  rrect/unexpected
+00020770: 2072 6573 756c 7473 2069 6620 7468 650a   results if the.
+00020780: 2f2f 2f20 2020 2020 696e 7075 7420 6772  ///     input gr
+00020790: 6170 6820 6861 7320 7365 6c66 206c 6f6f  aph has self loo
+000207a0: 7073 206f 7220 7061 7261 6c6c 656c 2065  ps or parallel e
+000207b0: 6467 6573 2e0a 2f2f 2f0a 2f2f 2f20 3a70  dges..///./// :p
+000207c0: 6172 616d 2050 7947 7261 7068 3a20 5468  aram PyGraph: Th
+000207d0: 6520 6772 6170 6820 746f 2067 6574 2063  e graph to get c
+000207e0: 6f72 6520 6e75 6d62 6572 730a 2f2f 2f0a  ore numbers.///.
+000207f0: 2f2f 2f20 3a72 6574 7572 6e73 3a20 4120  /// :returns: A 
+00020800: 6469 6374 696f 6e61 7279 206b 6579 6564  dictionary keyed
+00020810: 2062 7920 6e6f 6465 2069 6e64 6578 2074   by node index t
+00020820: 6f20 7468 6520 636f 7265 206e 756d 6265  o the core numbe
+00020830: 720a 2f2f 2f20 3a72 7479 7065 3a20 6469  r./// :rtype: di
+00020840: 6374 0a23 5b70 7966 756e 6374 696f 6e5d  ct.#[pyfunction]
+00020850: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
+00020860: 6520 3d20 2228 6772 6170 682c 202f 2922  e = "(graph, /)"
+00020870: 5d0a 7075 6220 666e 2067 7261 7068 5f63  ].pub fn graph_c
+00020880: 6f72 655f 6e75 6d62 6572 280a 2020 2020  ore_number(.    
+00020890: 7079 3a20 5079 7468 6f6e 2c0a 2020 2020  py: Python,.    
+000208a0: 6772 6170 683a 2026 6772 6170 683a 3a50  graph: &graph::P
+000208b0: 7947 7261 7068 2c0a 2920 2d3e 2050 7952  yGraph,.) -> PyR
+000208c0: 6573 756c 743c 5079 4f62 6a65 6374 3e20  esult<PyObject> 
+000208d0: 7b0a 2020 2020 5f63 6f72 655f 6e75 6d62  {.    _core_numb
+000208e0: 6572 2870 792c 2026 6772 6170 682e 6772  er(py, &graph.gr
+000208f0: 6170 6829 0a7d 0a0a 2f2f 2f20 5265 7475  aph).}../// Retu
+00020900: 726e 2074 6865 2063 6f72 6520 6e75 6d62  rn the core numb
+00020910: 6572 2066 6f72 2065 6163 6820 6e6f 6465  er for each node
+00020920: 2069 6e20 7468 6520 6469 7265 6374 6564   in the directed
+00020930: 2067 7261 7068 2e0a 2f2f 2f0a 2f2f 2f20   graph..///./// 
+00020940: 4120 6b2d 636f 7265 2069 7320 6120 6d61  A k-core is a ma
+00020950: 7869 6d61 6c20 7375 6267 7261 7068 2074  ximal subgraph t
+00020960: 6861 7420 636f 6e74 6169 6e73 206e 6f64  hat contains nod
+00020970: 6573 206f 6620 6465 6772 6565 206b 206f  es of degree k o
+00020980: 7220 6d6f 7265 2e0a 2f2f 2f20 466f 7220  r more../// For 
+00020990: 6469 7265 6374 6564 2067 7261 7068 732c  directed graphs,
+000209a0: 2074 6865 2064 6567 7265 6520 6973 2063   the degree is c
+000209b0: 616c 6375 6c61 7465 6420 6173 2069 6e5f  alculated as in_
+000209c0: 6465 6772 6565 202b 206f 7574 5f64 6567  degree + out_deg
+000209d0: 7265 652e 0a2f 2f2f 0a2f 2f2f 202e 2e20  ree..///./// .. 
+000209e0: 6e6f 7465 3a3a 0a2f 2f2f 0a2f 2f2f 2020  note::.///.///  
+000209f0: 2020 2054 6865 2066 756e 6374 696f 6e20     The function 
+00020a00: 696d 706c 6963 6974 6c79 2061 7373 756d  implicitly assum
+00020a10: 6573 2074 6861 7420 7468 6572 6520 6172  es that there ar
+00020a20: 6520 6e6f 2070 6172 616c 6c65 6c20 6564  e no parallel ed
+00020a30: 6765 730a 2f2f 2f20 2020 2020 6f72 2073  ges.///     or s
+00020a40: 656c 6620 6c6f 6f70 732e 2049 7420 6d61  elf loops. It ma
+00020a50: 7920 7072 6f64 7563 6520 696e 636f 7272  y produce incorr
+00020a60: 6563 742f 756e 6578 7065 6374 6564 2072  ect/unexpected r
+00020a70: 6573 756c 7473 2069 6620 7468 650a 2f2f  esults if the.//
+00020a80: 2f20 2020 2020 696e 7075 7420 6772 6170  /     input grap
+00020a90: 6820 6861 7320 7365 6c66 206c 6f6f 7073  h has self loops
+00020aa0: 206f 7220 7061 7261 6c6c 656c 2065 6467   or parallel edg
+00020ab0: 6573 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  es..///./// :par
+00020ac0: 616d 2050 7944 6947 7261 7068 3a20 5468  am PyDiGraph: Th
+00020ad0: 6520 6469 7265 6374 6564 2067 7261 7068  e directed graph
+00020ae0: 2074 6f20 6765 7420 636f 7265 206e 756d   to get core num
+00020af0: 6265 7273 0a2f 2f2f 0a2f 2f2f 203a 7265  bers.///./// :re
+00020b00: 7475 726e 733a 2041 2064 6963 7469 6f6e  turns: A diction
+00020b10: 6172 7920 6b65 7965 6420 6279 206e 6f64  ary keyed by nod
+00020b20: 6520 696e 6465 7820 746f 2074 6865 2063  e index to the c
+00020b30: 6f72 6520 6e75 6d62 6572 0a2f 2f2f 203a  ore number./// :
+00020b40: 7274 7970 653a 2064 6963 740a 235b 7079  rtype: dict.#[py
+00020b50: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+00020b60: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+00020b70: 7261 7068 2c20 2f29 225d 0a70 7562 2066  raph, /)"].pub f
+00020b80: 6e20 6469 6772 6170 685f 636f 7265 5f6e  n digraph_core_n
+00020b90: 756d 6265 7228 0a20 2020 2070 793a 2050  umber(.    py: P
+00020ba0: 7974 686f 6e2c 0a20 2020 2067 7261 7068  ython,.    graph
+00020bb0: 3a20 2664 6967 7261 7068 3a3a 5079 4469  : &digraph::PyDi
+00020bc0: 4772 6170 682c 0a29 202d 3e20 5079 5265  Graph,.) -> PyRe
+00020bd0: 7375 6c74 3c50 794f 626a 6563 743e 207b  sult<PyObject> {
+00020be0: 0a20 2020 205f 636f 7265 5f6e 756d 6265  .    _core_numbe
+00020bf0: 7228 7079 2c20 2667 7261 7068 2e67 7261  r(py, &graph.gra
+00020c00: 7068 290a 7d0a 0a2f 2f2f 2046 696e 6420  ph).}../// Find 
+00020c10: 7468 6520 6564 6765 7320 696e 2074 6865  the edges in the
+00020c20: 206d 696e 696d 756d 2073 7061 6e6e 696e   minimum spannin
+00020c30: 6720 7472 6565 206f 7220 666f 7265 7374  g tree or forest
+00020c40: 206f 6620 6120 6772 6170 680a 2f2f 2f20   of a graph./// 
+00020c50: 7573 696e 6720 4b72 7573 6b61 6c27 7320  using Kruskal's 
+00020c60: 616c 676f 7269 7468 6d2e 0a2f 2f2f 0a2f  algorithm..///./
+00020c70: 2f2f 203a 7061 7261 6d20 5079 4772 6170  // :param PyGrap
+00020c80: 6820 6772 6170 683a 2055 6e64 6972 6563  h graph: Undirec
+00020c90: 7465 6420 6772 6170 680a 2f2f 2f20 3a70  ted graph./// :p
+00020ca0: 6172 616d 2077 6569 6768 745f 666e 3a20  aram weight_fn: 
+00020cb0: 4120 6361 6c6c 6162 6c65 206f 626a 6563  A callable objec
+00020cc0: 7420 2866 756e 6374 696f 6e2c 206c 616d  t (function, lam
+00020cd0: 6264 612c 2065 7463 2920 7768 6963 680a  bda, etc) which.
+00020ce0: 2f2f 2f20 2020 2020 7769 6c6c 2062 6520  ///     will be 
+00020cf0: 7061 7373 6564 2074 6865 2065 6467 6520  passed the edge 
+00020d00: 6f62 6a65 6374 2061 6e64 2065 7870 6563  object and expec
+00020d10: 7465 6420 746f 2072 6574 7572 6e20 6120  ted to return a 
+00020d20: 6060 666c 6f61 7460 602e 2054 6869 730a  ``float``. This.
+00020d30: 2f2f 2f20 2020 2020 7465 6c6c 7320 7265  ///     tells re
+00020d40: 7477 6f72 6b78 2f72 7573 7420 686f 7720  tworkx/rust how 
+00020d50: 746f 2065 7874 7261 6374 2061 206e 756d  to extract a num
+00020d60: 6572 6963 616c 2077 6569 6768 7420 6173  erical weight as
+00020d70: 2061 2060 6066 6c6f 6174 6060 0a2f 2f2f   a ``float``.///
+00020d80: 2020 2020 2066 6f72 2065 6467 6520 6f62       for edge ob
+00020d90: 6a65 6374 2e20 536f 6d65 2073 696d 706c  ject. Some simpl
+00020da0: 6520 6578 616d 706c 6573 2061 7265 3a3a  e examples are::
+00020db0: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+00020dc0: 206d 696e 696d 756d 5f73 7061 6e6e 696e   minimum_spannin
+00020dd0: 675f 6564 6765 7328 6772 6170 682c 2077  g_edges(graph, w
+00020de0: 6569 6768 745f 666e 3a20 6c61 6d62 6461  eight_fn: lambda
+00020df0: 2078 3a20 3129 0a2f 2f2f 0a2f 2f2f 2020   x: 1).///.///  
+00020e00: 2020 2074 6f20 7265 7475 726e 2061 2077     to return a w
+00020e10: 6569 6768 7420 6f66 2031 2066 6f72 2061  eight of 1 for a
+00020e20: 6c6c 2065 6467 6573 2e20 416c 736f 3a3a  ll edges. Also::
+00020e30: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+00020e40: 206d 696e 696d 756d 5f73 7061 6e6e 696e   minimum_spannin
+00020e50: 675f 6564 6765 7328 6772 6170 682c 2077  g_edges(graph, w
+00020e60: 6569 6768 745f 666e 3a20 666c 6f61 7429  eight_fn: float)
+00020e70: 0a2f 2f2f 0a2f 2f2f 2020 2020 2074 6f20  .///.///     to 
+00020e80: 6361 7374 2074 6865 2065 6467 6520 6f62  cast the edge ob
+00020e90: 6a65 6374 2061 7320 6120 666c 6f61 7420  ject as a float 
+00020ea0: 6173 2074 6865 2077 6569 6768 742e 0a2f  as the weight../
+00020eb0: 2f2f 203a 7061 7261 6d20 666c 6f61 7420  // :param float 
+00020ec0: 6465 6661 756c 745f 7765 6967 6874 3a20  default_weight: 
+00020ed0: 4966 2060 6077 6569 6768 745f 666e 6060  If ``weight_fn``
+00020ee0: 2069 736e 2774 2073 7065 6369 6669 6564   isn't specified
+00020ef0: 2074 6869 7320 6f70 7469 6f6e 616c 0a2f   this optional./
+00020f00: 2f2f 2020 2020 2066 6c6f 6174 2076 616c  //     float val
+00020f10: 7565 2077 696c 6c20 6265 2075 7365 6420  ue will be used 
+00020f20: 666f 7220 7468 6520 7765 6967 6874 2f63  for the weight/c
+00020f30: 6f73 7420 6f66 2065 6163 6820 6564 6765  ost of each edge
+00020f40: 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  ..///./// :retur
+00020f50: 6e73 3a20 5468 6520 3a6d 6174 683a 604e  ns: The :math:`N
+00020f60: 202d 207c 637c 6020 6564 6765 7320 6f66   - |c|` edges of
+00020f70: 2074 6865 204d 696e 696d 756d 2053 7061   the Minimum Spa
+00020f80: 6e6e 696e 6720 5472 6565 2028 6f72 2046  nning Tree (or F
+00020f90: 6f72 6573 742c 2069 6620 3a6d 6174 683a  orest, if :math:
+00020fa0: 607c 637c 203e 2031 6029 0a2f 2f2f 2020  `|c| > 1`).///  
+00020fb0: 2020 2077 6865 7265 203a 6d61 7468 3a60     where :math:`
+00020fc0: 4e60 2069 7320 7468 6520 6e75 6d62 6572  N` is the number
+00020fd0: 206f 6620 6e6f 6465 7320 616e 6420 3a6d   of nodes and :m
+00020fe0: 6174 683a 607c 637c 6020 6973 2074 6865  ath:`|c|` is the
+00020ff0: 206e 756d 6265 7220 6f66 2063 6f6e 6e65   number of conne
+00021000: 6374 6564 2063 6f6d 706f 6e65 6e74 7320  cted components 
+00021010: 6f66 2074 6865 2067 7261 7068 0a2f 2f2f  of the graph.///
+00021020: 203a 7274 7970 653a 2057 6569 6768 7465   :rtype: Weighte
+00021030: 6445 6467 654c 6973 740a 235b 7079 6675  dEdgeList.#[pyfu
+00021040: 6e63 7469 6f6e 2877 6569 6768 745f 666e  nction(weight_fn
+00021050: 203d 2022 4e6f 6e65 222c 2064 6566 6175   = "None", defau
+00021060: 6c74 5f77 6569 6768 7420 3d20 2231 2e30  lt_weight = "1.0
+00021070: 2229 5d0a 235b 7465 7874 5f73 6967 6e61  ")].#[text_signa
+00021080: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
+00021090: 7765 6967 6874 5f66 6e3d 4e6f 6e65 2c20  weight_fn=None, 
+000210a0: 6465 6661 756c 745f 7765 6967 6874 3d31  default_weight=1
+000210b0: 2e30 2922 5d0a 7075 6220 666e 206d 696e  .0)"].pub fn min
+000210c0: 696d 756d 5f73 7061 6e6e 696e 675f 6564  imum_spanning_ed
+000210d0: 6765 7328 0a20 2020 2070 793a 2050 7974  ges(.    py: Pyt
+000210e0: 686f 6e2c 0a20 2020 2067 7261 7068 3a20  hon,.    graph: 
+000210f0: 2667 7261 7068 3a3a 5079 4772 6170 682c  &graph::PyGraph,
+00021100: 0a20 2020 2077 6569 6768 745f 666e 3a20  .    weight_fn: 
+00021110: 4f70 7469 6f6e 3c50 794f 626a 6563 743e  Option<PyObject>
+00021120: 2c0a 2020 2020 6465 6661 756c 745f 7765  ,.    default_we
+00021130: 6967 6874 3a20 6636 342c 0a29 202d 3e20  ight: f64,.) -> 
+00021140: 5079 5265 7375 6c74 3c57 6569 6768 7465  PyResult<Weighte
+00021150: 6445 6467 654c 6973 743e 207b 0a20 2020  dEdgeList> {.   
+00021160: 206c 6574 206d 7574 2073 7562 6772 6170   let mut subgrap
+00021170: 6873 203d 2055 6e69 6f6e 4669 6e64 3a3a  hs = UnionFind::
+00021180: 3c75 7369 7a65 3e3a 3a6e 6577 2867 7261  <usize>::new(gra
+00021190: 7068 2e67 7261 7068 2e6e 6f64 655f 626f  ph.graph.node_bo
+000211a0: 756e 6428 2929 3b0a 0a20 2020 206c 6574  und());..    let
+000211b0: 206d 7574 2065 6467 655f 6c69 7374 3a20   mut edge_list: 
+000211c0: 5665 633c 2866 3634 2c20 4564 6765 5265  Vec<(f64, EdgeRe
+000211d0: 6665 7265 6e63 653c 5079 4f62 6a65 6374  ference<PyObject
+000211e0: 3e29 3e20 3d0a 2020 2020 2020 2020 5665  >)> =.        Ve
+000211f0: 633a 3a77 6974 685f 6361 7061 6369 7479  c::with_capacity
+00021200: 2867 7261 7068 2e67 7261 7068 2e65 6467  (graph.graph.edg
+00021210: 655f 636f 756e 7428 2929 3b0a 2020 2020  e_count());.    
+00021220: 666f 7220 6564 6765 2069 6e20 6772 6170  for edge in grap
+00021230: 682e 6564 6765 5f72 6566 6572 656e 6365  h.edge_reference
+00021240: 7328 2920 7b0a 2020 2020 2020 2020 6c65  s() {.        le
+00021250: 7420 7765 6967 6874 203d 0a20 2020 2020  t weight =.     
+00021260: 2020 2020 2020 2077 6569 6768 745f 6361         weight_ca
+00021270: 6c6c 6162 6c65 2870 792c 2026 7765 6967  llable(py, &weig
+00021280: 6874 5f66 6e2c 2026 6564 6765 2e77 6569  ht_fn, &edge.wei
+00021290: 6768 7428 292c 2064 6566 6175 6c74 5f77  ght(), default_w
+000212a0: 6569 6768 7429 3f3b 0a20 2020 2020 2020  eight)?;.       
+000212b0: 2069 6620 7765 6967 6874 2e69 735f 6e61   if weight.is_na
+000212c0: 6e28 2920 7b0a 2020 2020 2020 2020 2020  n() {.          
+000212d0: 2020 7265 7475 726e 2045 7272 2850 7956    return Err(PyV
+000212e0: 616c 7565 4572 726f 723a 3a6e 6577 5f65  alueError::new_e
+000212f0: 7272 2822 4e61 4e20 666f 756e 6420 6173  rr("NaN found as
+00021300: 2061 6e20 6564 6765 2077 6569 6768 7422   an edge weight"
+00021310: 2929 3b0a 2020 2020 2020 2020 7d0a 2020  ));.        }.  
+00021320: 2020 2020 2020 6564 6765 5f6c 6973 742e        edge_list.
+00021330: 7075 7368 2828 7765 6967 6874 2c20 6564  push((weight, ed
+00021340: 6765 2929 3b0a 2020 2020 7d0a 0a20 2020  ge));.    }..   
+00021350: 2065 6467 655f 6c69 7374 2e70 6172 5f73   edge_list.par_s
+00021360: 6f72 745f 756e 7374 6162 6c65 5f62 7928  ort_unstable_by(
+00021370: 7c61 2c20 627c 207b 0a20 2020 2020 2020  |a, b| {.       
+00021380: 206c 6574 2077 6569 6768 745f 6120 3d20   let weight_a = 
+00021390: 612e 303b 0a20 2020 2020 2020 206c 6574  a.0;.        let
+000213a0: 2077 6569 6768 745f 6220 3d20 622e 303b   weight_b = b.0;
+000213b0: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
+000213c0: 612e 7061 7274 6961 6c5f 636d 7028 2677  a.partial_cmp(&w
+000213d0: 6569 6768 745f 6229 2e75 6e77 7261 705f  eight_b).unwrap_
+000213e0: 6f72 284f 7264 6572 696e 673a 3a4c 6573  or(Ordering::Les
+000213f0: 7329 0a20 2020 207d 293b 0a0a 2020 2020  s).    });..    
+00021400: 6c65 7420 6d75 7420 616e 7377 6572 3a20  let mut answer: 
+00021410: 5665 633c 2875 7369 7a65 2c20 7573 697a  Vec<(usize, usiz
+00021420: 652c 2050 794f 626a 6563 7429 3e20 3d20  e, PyObject)> = 
+00021430: 5665 633a 3a6e 6577 2829 3b0a 2020 2020  Vec::new();.    
+00021440: 666f 7220 666c 6f61 745f 6564 6765 5f70  for float_edge_p
+00021450: 6169 7220 696e 2065 6467 655f 6c69 7374  air in edge_list
+00021460: 2e69 7465 7228 2920 7b0a 2020 2020 2020  .iter() {.      
+00021470: 2020 6c65 7420 6564 6765 203d 2066 6c6f    let edge = flo
+00021480: 6174 5f65 6467 655f 7061 6972 2e31 3b0a  at_edge_pair.1;.
+00021490: 2020 2020 2020 2020 6c65 7420 7520 3d20          let u = 
+000214a0: 6564 6765 2e73 6f75 7263 6528 292e 696e  edge.source().in
+000214b0: 6465 7828 293b 0a20 2020 2020 2020 206c  dex();.        l
+000214c0: 6574 2076 203d 2065 6467 652e 7461 7267  et v = edge.targ
+000214d0: 6574 2829 2e69 6e64 6578 2829 3b0a 2020  et().index();.  
+000214e0: 2020 2020 2020 6966 2073 7562 6772 6170        if subgrap
+000214f0: 6873 2e75 6e69 6f6e 2875 2c20 7629 207b  hs.union(u, v) {
+00021500: 0a20 2020 2020 2020 2020 2020 206c 6574  .            let
+00021510: 2077 203d 2065 6467 652e 7765 6967 6874   w = edge.weight
+00021520: 2829 2e63 6c6f 6e65 5f72 6566 2870 7929  ().clone_ref(py)
+00021530: 3b0a 2020 2020 2020 2020 2020 2020 616e  ;.            an
+00021540: 7377 6572 2e70 7573 6828 2875 2c20 762c  swer.push((u, v,
+00021550: 2077 2929 3b0a 2020 2020 2020 2020 7d0a   w));.        }.
+00021560: 2020 2020 7d0a 0a20 2020 204f 6b28 5765      }..    Ok(We
+00021570: 6967 6874 6564 4564 6765 4c69 7374 207b  ightedEdgeList {
+00021580: 2065 6467 6573 3a20 616e 7377 6572 207d   edges: answer }
+00021590: 290a 7d0a 0a2f 2f2f 2046 696e 6420 7468  ).}../// Find th
+000215a0: 6520 6d69 6e69 6d75 6d20 7370 616e 6e69  e minimum spanni
+000215b0: 6e67 2074 7265 6520 6f72 2066 6f72 6573  ng tree or fores
+000215c0: 7420 6f66 2061 2067 7261 7068 0a2f 2f2f  t of a graph.///
+000215d0: 2075 7369 6e67 204b 7275 736b 616c 2773   using Kruskal's
+000215e0: 2061 6c67 6f72 6974 686d 2e0a 2f2f 2f0a   algorithm..///.
+000215f0: 2f2f 2f20 3a70 6172 616d 2050 7947 7261  /// :param PyGra
+00021600: 7068 2067 7261 7068 3a20 556e 6469 7265  ph graph: Undire
+00021610: 6374 6564 2067 7261 7068 0a2f 2f2f 203a  cted graph./// :
+00021620: 7061 7261 6d20 7765 6967 6874 5f66 6e3a  param weight_fn:
+00021630: 2041 2063 616c 6c61 626c 6520 6f62 6a65   A callable obje
+00021640: 6374 2028 6675 6e63 7469 6f6e 2c20 6c61  ct (function, la
+00021650: 6d62 6461 2c20 6574 6329 2077 6869 6368  mbda, etc) which
+00021660: 0a2f 2f2f 2020 2020 2077 696c 6c20 6265  .///     will be
+00021670: 2070 6173 7365 6420 7468 6520 6564 6765   passed the edge
+00021680: 206f 626a 6563 7420 616e 6420 6578 7065   object and expe
+00021690: 6374 6564 2074 6f20 7265 7475 726e 2061  cted to return a
+000216a0: 2060 6066 6c6f 6174 6060 2e20 5468 6973   ``float``. This
+000216b0: 0a2f 2f2f 2020 2020 2074 656c 6c73 2072  .///     tells r
+000216c0: 6574 776f 726b 782f 7275 7374 2068 6f77  etworkx/rust how
+000216d0: 2074 6f20 6578 7472 6163 7420 6120 6e75   to extract a nu
+000216e0: 6d65 7269 6361 6c20 7765 6967 6874 2061  merical weight a
+000216f0: 7320 6120 6060 666c 6f61 7460 600a 2f2f  s a ``float``.//
+00021700: 2f20 2020 2020 666f 7220 6564 6765 206f  /     for edge o
+00021710: 626a 6563 742e 2053 6f6d 6520 7369 6d70  bject. Some simp
+00021720: 6c65 2065 7861 6d70 6c65 7320 6172 653a  le examples are:
+00021730: 3a0a 2f2f 2f0a 2f2f 2f20 2020 2020 2020  :.///.///       
+00021740: 2020 6d69 6e69 6d75 6d5f 7370 616e 6e69    minimum_spanni
+00021750: 6e67 5f74 7265 6528 6772 6170 682c 2077  ng_tree(graph, w
+00021760: 6569 6768 745f 666e 3a20 6c61 6d62 6461  eight_fn: lambda
+00021770: 2078 3a20 3129 0a2f 2f2f 0a2f 2f2f 2020   x: 1).///.///  
+00021780: 2020 2074 6f20 7265 7475 726e 2061 2077     to return a w
+00021790: 6569 6768 7420 6f66 2031 2066 6f72 2061  eight of 1 for a
+000217a0: 6c6c 2065 6467 6573 2e20 416c 736f 3a3a  ll edges. Also::
+000217b0: 0a2f 2f2f 0a2f 2f2f 2020 2020 2020 2020  .///.///        
+000217c0: 206d 696e 696d 756d 5f73 7061 6e6e 696e   minimum_spannin
+000217d0: 675f 7472 6565 2867 7261 7068 2c20 7765  g_tree(graph, we
+000217e0: 6967 6874 5f66 6e3a 2066 6c6f 6174 290a  ight_fn: float).
+000217f0: 2f2f 2f0a 2f2f 2f20 2020 2020 746f 2063  ///.///     to c
+00021800: 6173 7420 7468 6520 6564 6765 206f 626a  ast the edge obj
+00021810: 6563 7420 6173 2061 2066 6c6f 6174 2061  ect as a float a
+00021820: 7320 7468 6520 7765 6967 6874 2e0a 2f2f  s the weight..//
+00021830: 2f20 3a70 6172 616d 2066 6c6f 6174 2064  / :param float d
+00021840: 6566 6175 6c74 5f77 6569 6768 743a 2049  efault_weight: I
+00021850: 6620 6060 7765 6967 6874 5f66 6e60 6020  f ``weight_fn`` 
+00021860: 6973 6e27 7420 7370 6563 6966 6965 6420  isn't specified 
+00021870: 7468 6973 206f 7074 696f 6e61 6c0a 2f2f  this optional.//
+00021880: 2f20 2020 2020 666c 6f61 7420 7661 6c75  /     float valu
+00021890: 6520 7769 6c6c 2062 6520 7573 6564 2066  e will be used f
+000218a0: 6f72 2074 6865 2077 6569 6768 742f 636f  or the weight/co
+000218b0: 7374 206f 6620 6561 6368 2065 6467 652e  st of each edge.
+000218c0: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
+000218d0: 733a 2041 204d 696e 696d 756d 2053 7061  s: A Minimum Spa
+000218e0: 6e6e 696e 6720 5472 6565 2028 6f72 2046  nning Tree (or F
+000218f0: 6f72 6573 742c 2069 6620 7468 6520 6772  orest, if the gr
+00021900: 6170 6820 6973 206e 6f74 2063 6f6e 6e65  aph is not conne
+00021910: 6374 6564 292e 0a2f 2f2f 0a2f 2f2f 203a  cted)..///./// :
+00021920: 7274 7970 653a 2050 7947 7261 7068 0a2f  rtype: PyGraph./
+00021930: 2f2f 0a2f 2f2f 202e 2e20 6e6f 7465 3a3a  //./// .. note::
+00021940: 0a2f 2f2f 0a2f 2f2f 2020 2020 2054 6865  .///.///     The
+00021950: 206e 6577 2067 7261 7068 2077 696c 6c20   new graph will 
+00021960: 6b65 6570 2074 6865 2073 616d 6520 6e6f  keep the same no
+00021970: 6465 2069 6e64 6578 6573 2c20 6275 7420  de indexes, but 
+00021980: 6564 6765 2069 6e64 6578 6573 206d 6967  edge indexes mig
+00021990: 6874 2064 6966 6665 722e 0a23 5b70 7966  ht differ..#[pyf
+000219a0: 756e 6374 696f 6e28 7765 6967 6874 5f66  unction(weight_f
+000219b0: 6e20 3d20 224e 6f6e 6522 2c20 6465 6661  n = "None", defa
+000219c0: 756c 745f 7765 6967 6874 203d 2022 312e  ult_weight = "1.
+000219d0: 3022 295d 0a23 5b74 6578 745f 7369 676e  0")].#[text_sign
+000219e0: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+000219f0: 2077 6569 6768 745f 666e 3d4e 6f6e 652c   weight_fn=None,
+00021a00: 2064 6566 6175 6c74 5f77 6569 6768 743d   default_weight=
+00021a10: 312e 3029 225d 0a70 7562 2066 6e20 6d69  1.0)"].pub fn mi
+00021a20: 6e69 6d75 6d5f 7370 616e 6e69 6e67 5f74  nimum_spanning_t
+00021a30: 7265 6528 0a20 2020 2070 793a 2050 7974  ree(.    py: Pyt
+00021a40: 686f 6e2c 0a20 2020 2067 7261 7068 3a20  hon,.    graph: 
+00021a50: 2667 7261 7068 3a3a 5079 4772 6170 682c  &graph::PyGraph,
+00021a60: 0a20 2020 2077 6569 6768 745f 666e 3a20  .    weight_fn: 
+00021a70: 4f70 7469 6f6e 3c50 794f 626a 6563 743e  Option<PyObject>
+00021a80: 2c0a 2020 2020 6465 6661 756c 745f 7765  ,.    default_we
+00021a90: 6967 6874 3a20 6636 342c 0a29 202d 3e20  ight: f64,.) -> 
+00021aa0: 5079 5265 7375 6c74 3c67 7261 7068 3a3a  PyResult<graph::
+00021ab0: 5079 4772 6170 683e 207b 0a20 2020 206c  PyGraph> {.    l
+00021ac0: 6574 206d 7574 2073 7061 6e6e 696e 675f  et mut spanning_
+00021ad0: 7472 6565 203d 2028 2a67 7261 7068 292e  tree = (*graph).
+00021ae0: 636c 6f6e 6528 293b 0a20 2020 2073 7061  clone();.    spa
+00021af0: 6e6e 696e 675f 7472 6565 2e67 7261 7068  nning_tree.graph
+00021b00: 2e63 6c65 6172 5f65 6467 6573 2829 3b0a  .clear_edges();.
+00021b10: 0a20 2020 2066 6f72 2065 6467 6520 696e  .    for edge in
+00021b20: 206d 696e 696d 756d 5f73 7061 6e6e 696e   minimum_spannin
+00021b30: 675f 6564 6765 7328 7079 2c20 6772 6170  g_edges(py, grap
+00021b40: 682c 2077 6569 6768 745f 666e 2c20 6465  h, weight_fn, de
+00021b50: 6661 756c 745f 7765 6967 6874 293f 0a20  fault_weight)?. 
+00021b60: 2020 2020 2020 202e 6564 6765 730a 2020         .edges.  
+00021b70: 2020 2020 2020 2e69 7465 7228 290a 2020        .iter().  
+00021b80: 2020 7b0a 2020 2020 2020 2020 7370 616e    {.        span
+00021b90: 6e69 6e67 5f74 7265 652e 6164 645f 6564  ning_tree.add_ed
+00021ba0: 6765 2865 6467 652e 302c 2065 6467 652e  ge(edge.0, edge.
+00021bb0: 312c 2065 6467 652e 322e 636c 6f6e 655f  1, edge.2.clone_
+00021bc0: 7265 6628 7079 2929 3f3b 0a20 2020 207d  ref(py))?;.    }
+00021bd0: 0a0a 2020 2020 4f6b 2873 7061 6e6e 696e  ..    Ok(spannin
+00021be0: 675f 7472 6565 290a 7d0a 0a2f 2f2f 2043  g_tree).}../// C
+00021bf0: 6f6d 7075 7465 2074 6865 2063 6f6d 706c  ompute the compl
+00021c00: 656d 656e 7420 6f66 2061 2067 7261 7068  ement of a graph
+00021c10: 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  ..///./// :param
+00021c20: 2050 7947 7261 7068 2067 7261 7068 3a20   PyGraph graph: 
+00021c30: 5468 6520 6772 6170 6820 746f 2062 6520  The graph to be 
+00021c40: 7573 6564 2e0a 2f2f 2f0a 2f2f 2f20 3a72  used..///./// :r
+00021c50: 6574 7572 6e73 3a20 5468 6520 636f 6d70  eturns: The comp
+00021c60: 6c65 6d65 6e74 206f 6620 7468 6520 6772  lement of the gr
+00021c70: 6170 682e 0a2f 2f2f 203a 7274 7970 653a  aph../// :rtype:
+00021c80: 2050 7947 7261 7068 0a2f 2f2f 0a2f 2f2f   PyGraph.///.///
+00021c90: 202e 2e20 6e6f 7465 3a3a 0a2f 2f2f 0a2f   .. note::.///./
+00021ca0: 2f2f 2020 2020 2050 6172 616c 6c65 6c20  //     Parallel 
+00021cb0: 6564 6765 7320 616e 6420 7365 6c66 2d6c  edges and self-l
+00021cc0: 6f6f 7073 2061 7265 206e 6576 6572 2063  oops are never c
+00021cd0: 7265 6174 6564 2c0a 2f2f 2f20 2020 2020  reated,.///     
+00021ce0: 6576 656e 2069 6620 7468 6520 3a61 7474  even if the :att
+00021cf0: 723a 607e 7265 7477 6f72 6b78 2e50 7947  r:`~retworkx.PyG
+00021d00: 7261 7068 2e6d 756c 7469 6772 6170 6860  raph.multigraph`
+00021d10: 0a2f 2f2f 2020 2020 2061 7474 7269 6275  .///     attribu
+00021d20: 7465 2069 7320 7365 7420 746f 2060 6054  te is set to ``T
+00021d30: 7275 6560 600a 235b 7079 6675 6e63 7469  rue``.#[pyfuncti
+00021d40: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
+00021d50: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
+00021d60: 2f29 225d 0a66 6e20 6772 6170 685f 636f  /)"].fn graph_co
+00021d70: 6d70 6c65 6d65 6e74 280a 2020 2020 7079  mplement(.    py
+00021d80: 3a20 5079 7468 6f6e 2c0a 2020 2020 6772  : Python,.    gr
+00021d90: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
+00021da0: 7261 7068 2c0a 2920 2d3e 2050 7952 6573  raph,.) -> PyRes
+00021db0: 756c 743c 6772 6170 683a 3a50 7947 7261  ult<graph::PyGra
+00021dc0: 7068 3e20 7b0a 2020 2020 6c65 7420 6d75  ph> {.    let mu
+00021dd0: 7420 636f 6d70 6c65 6d65 6e74 5f67 7261  t complement_gra
+00021de0: 7068 203d 2067 7261 7068 2e63 6c6f 6e65  ph = graph.clone
+00021df0: 2829 3b20 2f2f 206b 6565 7020 7361 6d65  (); // keep same
+00021e00: 206e 6f64 6520 696e 6465 7865 730a 2020   node indexes.  
+00021e10: 2020 636f 6d70 6c65 6d65 6e74 5f67 7261    complement_gra
+00021e20: 7068 2e67 7261 7068 2e63 6c65 6172 5f65  ph.graph.clear_e
+00021e30: 6467 6573 2829 3b0a 0a20 2020 2066 6f72  dges();..    for
+00021e40: 206e 6f64 655f 6120 696e 2067 7261 7068   node_a in graph
+00021e50: 2e67 7261 7068 2e6e 6f64 655f 696e 6469  .graph.node_indi
+00021e60: 6365 7328 2920 7b0a 2020 2020 2020 2020  ces() {.        
+00021e70: 6c65 7420 6f6c 645f 6e65 6967 6862 6f72  let old_neighbor
+00021e80: 733a 2048 6173 6853 6574 3c4e 6f64 6549  s: HashSet<NodeI
+00021e90: 6e64 6578 3e20 3d0a 2020 2020 2020 2020  ndex> =.        
+00021ea0: 2020 2020 6772 6170 682e 6772 6170 682e      graph.graph.
+00021eb0: 6e65 6967 6862 6f72 7328 6e6f 6465 5f61  neighbors(node_a
+00021ec0: 292e 636f 6c6c 6563 7428 293b 0a20 2020  ).collect();.   
+00021ed0: 2020 2020 2066 6f72 206e 6f64 655f 6220       for node_b 
+00021ee0: 696e 2067 7261 7068 2e67 7261 7068 2e6e  in graph.graph.n
+00021ef0: 6f64 655f 696e 6469 6365 7328 2920 7b0a  ode_indices() {.
+00021f00: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00021f10: 6f64 655f 6120 213d 206e 6f64 655f 620a  ode_a != node_b.
+00021f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f30: 2626 2021 6f6c 645f 6e65 6967 6862 6f72  && !old_neighbor
+00021f40: 732e 636f 6e74 6169 6e73 2826 6e6f 6465  s.contains(&node
+00021f50: 5f62 290a 2020 2020 2020 2020 2020 2020  _b).            
+00021f60: 2020 2020 2626 2028 2163 6f6d 706c 656d      && (!complem
+00021f70: 656e 745f 6772 6170 682e 6d75 6c74 6967  ent_graph.multig
+00021f80: 7261 7068 0a20 2020 2020 2020 2020 2020  raph.           
+00021f90: 2020 2020 2020 2020 207c 7c20 2163 6f6d           || !com
+00021fa0: 706c 656d 656e 745f 6772 6170 680a 2020  plement_graph.  
+00021fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fc0: 2020 2020 2020 2e68 6173 5f65 6467 6528        .has_edge(
+00021fd0: 6e6f 6465 5f61 2e69 6e64 6578 2829 2c20  node_a.index(), 
+00021fe0: 6e6f 6465 5f62 2e69 6e64 6578 2829 2929  node_b.index()))
+00021ff0: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+00022000: 2020 2020 2020 2020 2020 2020 2020 202f                 /
+00022010: 2f20 6176 6f69 6420 6372 6561 7469 6e67  / avoid creating
+00022020: 2070 6172 616c 6c65 6c20 6564 6765 7320   parallel edges 
+00022030: 696e 206d 756c 7469 6772 6170 680a 2020  in multigraph.  
+00022040: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00022050: 6d70 6c65 6d65 6e74 5f67 7261 7068 2e61  mplement_graph.a
+00022060: 6464 5f65 6467 6528 0a20 2020 2020 2020  dd_edge(.       
+00022070: 2020 2020 2020 2020 2020 2020 206e 6f64               nod
+00022080: 655f 612e 696e 6465 7828 292c 0a20 2020  e_a.index(),.   
+00022090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220a0: 206e 6f64 655f 622e 696e 6465 7828 292c   node_b.index(),
+000220b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000220c0: 2020 2020 2070 792e 4e6f 6e65 2829 2c0a       py.None(),.
+000220d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220e0: 293f 3b0a 2020 2020 2020 2020 2020 2020  )?;.            
+000220f0: 7d0a 2020 2020 2020 2020 7d0a 2020 2020  }.        }.    
+00022100: 7d0a 2020 2020 4f6b 2863 6f6d 706c 656d  }.    Ok(complem
+00022110: 656e 745f 6772 6170 6829 0a7d 0a0a 2f2f  ent_graph).}..//
+00022120: 2f20 436f 6d70 7574 6520 7468 6520 636f  / Compute the co
+00022130: 6d70 6c65 6d65 6e74 206f 6620 6120 6772  mplement of a gr
+00022140: 6170 682e 0a2f 2f2f 0a2f 2f2f 203a 7061  aph..///./// :pa
+00022150: 7261 6d20 5079 4469 4772 6170 6820 6772  ram PyDiGraph gr
+00022160: 6170 683a 2054 6865 2067 7261 7068 2074  aph: The graph t
+00022170: 6f20 6265 2075 7365 642e 0a2f 2f2f 0a2f  o be used..///./
+00022180: 2f2f 203a 7265 7475 726e 733a 2054 6865  // :returns: The
+00022190: 2063 6f6d 706c 656d 656e 7420 6f66 2074   complement of t
+000221a0: 6865 2067 7261 7068 2e0a 2f2f 2f20 3a72  he graph../// :r
+000221b0: 7479 7065 3a20 3a63 6c61 7373 3a60 7e72  type: :class:`~r
+000221c0: 6574 776f 726b 782e 5079 4469 4772 6170  etworkx.PyDiGrap
+000221d0: 6860 0a2f 2f2f 0a2f 2f2f 202e 2e20 6e6f  h`.///./// .. no
+000221e0: 7465 3a3a 0a2f 2f2f 0a2f 2f2f 2020 2020  te::.///.///    
+000221f0: 2050 6172 616c 6c65 6c20 6564 6765 7320   Parallel edges 
+00022200: 616e 6420 7365 6c66 2d6c 6f6f 7073 2061  and self-loops a
+00022210: 7265 206e 6576 6572 2063 7265 6174 6564  re never created
+00022220: 2c0a 2f2f 2f20 2020 2020 6576 656e 2069  ,.///     even i
+00022230: 6620 7468 6520 3a61 7474 723a 607e 7265  f the :attr:`~re
+00022240: 7477 6f72 6b78 2e50 7944 6947 7261 7068  tworkx.PyDiGraph
+00022250: 2e6d 756c 7469 6772 6170 6860 0a2f 2f2f  .multigraph`.///
+00022260: 2020 2020 2061 7474 7269 6275 7465 2069       attribute i
+00022270: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
+00022280: 600a 235b 7079 6675 6e63 7469 6f6e 5d0a  `.#[pyfunction].
+00022290: 235b 7465 7874 5f73 6967 6e61 7475 7265  #[text_signature
+000222a0: 203d 2022 2867 7261 7068 2c20 2f29 225d   = "(graph, /)"]
+000222b0: 0a66 6e20 6469 6772 6170 685f 636f 6d70  .fn digraph_comp
+000222c0: 6c65 6d65 6e74 280a 2020 2020 7079 3a20  lement(.    py: 
+000222d0: 5079 7468 6f6e 2c0a 2020 2020 6772 6170  Python,.    grap
+000222e0: 683a 2026 6469 6772 6170 683a 3a50 7944  h: &digraph::PyD
+000222f0: 6947 7261 7068 2c0a 2920 2d3e 2050 7952  iGraph,.) -> PyR
+00022300: 6573 756c 743c 6469 6772 6170 683a 3a50  esult<digraph::P
+00022310: 7944 6947 7261 7068 3e20 7b0a 2020 2020  yDiGraph> {.    
+00022320: 6c65 7420 6d75 7420 636f 6d70 6c65 6d65  let mut compleme
+00022330: 6e74 5f67 7261 7068 203d 2067 7261 7068  nt_graph = graph
+00022340: 2e63 6c6f 6e65 2829 3b20 2f2f 206b 6565  .clone(); // kee
+00022350: 7020 7361 6d65 206e 6f64 6520 696e 6465  p same node inde
+00022360: 7865 730a 2020 2020 636f 6d70 6c65 6d65  xes.    compleme
+00022370: 6e74 5f67 7261 7068 2e67 7261 7068 2e63  nt_graph.graph.c
+00022380: 6c65 6172 5f65 6467 6573 2829 3b0a 0a20  lear_edges();.. 
+00022390: 2020 2066 6f72 206e 6f64 655f 6120 696e     for node_a in
+000223a0: 2067 7261 7068 2e67 7261 7068 2e6e 6f64   graph.graph.nod
+000223b0: 655f 696e 6469 6365 7328 2920 7b0a 2020  e_indices() {.  
+000223c0: 2020 2020 2020 6c65 7420 6f6c 645f 6e65        let old_ne
+000223d0: 6967 6862 6f72 733a 2048 6173 6853 6574  ighbors: HashSet
+000223e0: 3c4e 6f64 6549 6e64 6578 3e20 3d20 6772  <NodeIndex> = gr
+000223f0: 6170 680a 2020 2020 2020 2020 2020 2020  aph.            
+00022400: 2e67 7261 7068 0a20 2020 2020 2020 2020  .graph.         
+00022410: 2020 202e 6e65 6967 6862 6f72 735f 6469     .neighbors_di
+00022420: 7265 6374 6564 286e 6f64 655f 612c 2070  rected(node_a, p
+00022430: 6574 6772 6170 683a 3a44 6972 6563 7469  etgraph::Directi
+00022440: 6f6e 3a3a 4f75 7467 6f69 6e67 290a 2020  on::Outgoing).  
+00022450: 2020 2020 2020 2020 2020 2e63 6f6c 6c65            .colle
+00022460: 6374 2829 3b0a 2020 2020 2020 2020 666f  ct();.        fo
+00022470: 7220 6e6f 6465 5f62 2069 6e20 6772 6170  r node_b in grap
+00022480: 682e 6772 6170 682e 6e6f 6465 5f69 6e64  h.graph.node_ind
+00022490: 6963 6573 2829 207b 0a20 2020 2020 2020  ices() {.       
+000224a0: 2020 2020 2069 6620 6e6f 6465 5f61 2021       if node_a !
+000224b0: 3d20 6e6f 6465 5f62 2026 2620 216f 6c64  = node_b && !old
+000224c0: 5f6e 6569 6768 626f 7273 2e63 6f6e 7461  _neighbors.conta
+000224d0: 696e 7328 266e 6f64 655f 6229 207b 0a20  ins(&node_b) {. 
+000224e0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000224f0: 6f6d 706c 656d 656e 745f 6772 6170 682e  omplement_graph.
+00022500: 6164 645f 6564 6765 280a 2020 2020 2020  add_edge(.      
+00022510: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00022520: 6465 5f61 2e69 6e64 6578 2829 2c0a 2020  de_a.index(),.  
+00022530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022540: 2020 6e6f 6465 5f62 2e69 6e64 6578 2829    node_b.index()
+00022550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022560: 2020 2020 2020 7079 2e4e 6f6e 6528 292c        py.None(),
+00022570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022580: 2029 3f3b 0a20 2020 2020 2020 2020 2020   )?;.           
+00022590: 207d 0a20 2020 2020 2020 207d 0a20 2020   }.        }.   
+000225a0: 207d 0a0a 2020 2020 4f6b 2863 6f6d 706c   }..    Ok(compl
+000225b0: 656d 656e 745f 6772 6170 6829 0a7d 0a0a  ement_graph).}..
+000225c0: 235b 616c 6c6f 7728 636c 6970 7079 3a3a  #[allow(clippy::
+000225d0: 746f 6f5f 6d61 6e79 5f61 7267 756d 656e  too_many_argumen
+000225e0: 7473 295d 0a66 6e20 5f73 7072 696e 675f  ts)].fn _spring_
+000225f0: 6c61 796f 7574 3c54 793e 280a 2020 2020  layout<Ty>(.    
+00022600: 7079 3a20 5079 7468 6f6e 2c0a 2020 2020  py: Python,.    
+00022610: 6772 6170 683a 2026 5374 6162 6c65 4772  graph: &StableGr
+00022620: 6170 683c 5079 4f62 6a65 6374 2c20 5079  aph<PyObject, Py
+00022630: 4f62 6a65 6374 2c20 5479 3e2c 0a20 2020  Object, Ty>,.   
+00022640: 2070 6f73 3a20 4f70 7469 6f6e 3c48 6173   pos: Option<Has
+00022650: 684d 6170 3c75 7369 7a65 2c20 6c61 796f  hMap<usize, layo
+00022660: 7574 3a3a 506f 696e 743e 3e2c 0a20 2020  ut::Point>>,.   
+00022670: 2066 6978 6564 3a20 4f70 7469 6f6e 3c48   fixed: Option<H
+00022680: 6173 6853 6574 3c75 7369 7a65 3e3e 2c0a  ashSet<usize>>,.
+00022690: 2020 2020 6b3a 204f 7074 696f 6e3c 6636      k: Option<f6
+000226a0: 343e 2c0a 2020 2020 7265 7075 6c73 6976  4>,.    repulsiv
+000226b0: 655f 6578 706f 6e65 6e74 3a20 4f70 7469  e_exponent: Opti
+000226c0: 6f6e 3c69 3332 3e2c 0a20 2020 2061 6461  on<i32>,.    ada
+000226d0: 7074 6976 655f 636f 6f6c 696e 673a 204f  ptive_cooling: O
+000226e0: 7074 696f 6e3c 626f 6f6c 3e2c 0a20 2020  ption<bool>,.   
+000226f0: 206e 756d 5f69 7465 723a 204f 7074 696f   num_iter: Optio
+00022700: 6e3c 7573 697a 653e 2c0a 2020 2020 746f  n<usize>,.    to
+00022710: 6c3a 204f 7074 696f 6e3c 6636 343e 2c0a  l: Option<f64>,.
+00022720: 2020 2020 7765 6967 6874 5f66 6e3a 204f      weight_fn: O
+00022730: 7074 696f 6e3c 5079 4f62 6a65 6374 3e2c  ption<PyObject>,
+00022740: 0a20 2020 2064 6566 6175 6c74 5f77 6569  .    default_wei
+00022750: 6768 743a 2066 3634 2c0a 2020 2020 7363  ght: f64,.    sc
+00022760: 616c 653a 204f 7074 696f 6e3c 6636 343e  ale: Option<f64>
+00022770: 2c0a 2020 2020 6365 6e74 6572 3a20 4f70  ,.    center: Op
+00022780: 7469 6f6e 3c6c 6179 6f75 743a 3a50 6f69  tion<layout::Poi
+00022790: 6e74 3e2c 0a20 2020 2073 6565 643a 204f  nt>,.    seed: O
+000227a0: 7074 696f 6e3c 7536 343e 2c0a 2920 2d3e  ption<u64>,.) ->
+000227b0: 2050 7952 6573 756c 743c 506f 7332 444d   PyResult<Pos2DM
+000227c0: 6170 7069 6e67 3e0a 7768 6572 650a 2020  apping>.where.  
+000227d0: 2020 5479 3a20 4564 6765 5479 7065 2c0a    Ty: EdgeType,.
+000227e0: 7b0a 2020 2020 6966 2066 6978 6564 2e69  {.    if fixed.i
+000227f0: 735f 736f 6d65 2829 2026 2620 706f 732e  s_some() && pos.
+00022800: 6973 5f6e 6f6e 6528 2920 7b0a 2020 2020  is_none() {.    
+00022810: 2020 2020 7265 7475 726e 2045 7272 2850      return Err(P
+00022820: 7956 616c 7565 4572 726f 723a 3a6e 6577  yValueError::new
+00022830: 5f65 7272 2822 6066 6978 6564 6020 7370  _err("`fixed` sp
+00022840: 6563 6966 6965 6420 6275 7420 6070 6f73  ecified but `pos
+00022850: 6020 6e6f 742e 2229 293b 0a20 2020 207d  ` not."));.    }
+00022860: 0a0a 2020 2020 6c65 7420 6d75 7420 726e  ..    let mut rn
+00022870: 673a 2050 6367 3634 203d 206d 6174 6368  g: Pcg64 = match
+00022880: 2073 6565 6420 7b0a 2020 2020 2020 2020   seed {.        
+00022890: 536f 6d65 2873 6565 6429 203d 3e20 5063  Some(seed) => Pc
+000228a0: 6736 343a 3a73 6565 645f 6672 6f6d 5f75  g64::seed_from_u
+000228b0: 3634 2873 6565 6429 2c0a 2020 2020 2020  64(seed),.      
+000228c0: 2020 4e6f 6e65 203d 3e20 5063 6736 343a    None => Pcg64:
+000228d0: 3a66 726f 6d5f 656e 7472 6f70 7928 292c  :from_entropy(),
+000228e0: 0a20 2020 207d 3b0a 0a20 2020 206c 6574  .    };..    let
+000228f0: 2064 6973 7420 3d20 556e 6966 6f72 6d3a   dist = Uniform:
+00022900: 3a6e 6577 2830 2e30 2c20 312e 3029 3b0a  :new(0.0, 1.0);.
+00022910: 0a20 2020 206c 6574 2070 6f73 203d 2070  .    let pos = p
+00022920: 6f73 2e75 6e77 7261 705f 6f72 5f64 6566  os.unwrap_or_def
+00022930: 6175 6c74 2829 3b0a 2020 2020 6c65 7420  ault();.    let 
+00022940: 6d75 7420 7670 6f73 3a20 5665 633c 6c61  mut vpos: Vec<la
+00022950: 796f 7574 3a3a 506f 696e 743e 203d 2028  yout::Point> = (
+00022960: 302e 2e67 7261 7068 2e6e 6f64 655f 626f  0..graph.node_bo
+00022970: 756e 6428 2929 0a20 2020 2020 2020 202e  und()).        .
+00022980: 6d61 7028 7c5f 7c20 5b64 6973 742e 7361  map(|_| [dist.sa
+00022990: 6d70 6c65 2826 6d75 7420 726e 6729 2c20  mple(&mut rng), 
+000229a0: 6469 7374 2e73 616d 706c 6528 266d 7574  dist.sample(&mut
+000229b0: 2072 6e67 295d 290a 2020 2020 2020 2020   rng)]).        
+000229c0: 2e63 6f6c 6c65 6374 2829 3b0a 2020 2020  .collect();.    
+000229d0: 666f 7220 286e 2c20 7029 2069 6e20 706f  for (n, p) in po
+000229e0: 732e 696e 746f 5f69 7465 7228 2920 7b0a  s.into_iter() {.
+000229f0: 2020 2020 2020 2020 7670 6f73 5b6e 5d20          vpos[n] 
+00022a00: 3d20 703b 0a20 2020 207d 0a0a 2020 2020  = p;.    }..    
+00022a10: 6c65 7420 6669 7865 6420 3d20 6669 7865  let fixed = fixe
+00022a20: 642e 756e 7772 6170 5f6f 725f 6465 6661  d.unwrap_or_defa
+00022a30: 756c 7428 293b 0a20 2020 206c 6574 206b  ult();.    let k
+00022a40: 203d 206b 2e75 6e77 7261 705f 6f72 2831   = k.unwrap_or(1
+00022a50: 2e30 202f 2028 6772 6170 682e 6e6f 6465  .0 / (graph.node
+00022a60: 5f63 6f75 6e74 2829 2061 7320 6636 3429  _count() as f64)
+00022a70: 2e73 7172 7428 2929 3b0a 2020 2020 6c65  .sqrt());.    le
+00022a80: 7420 665f 6120 3d20 6c61 796f 7574 3a3a  t f_a = layout::
+00022a90: 4174 7472 6163 7469 7665 466f 7263 653a  AttractiveForce:
+00022aa0: 3a6e 6577 286b 293b 0a20 2020 206c 6574  :new(k);.    let
+00022ab0: 2066 5f72 203d 206c 6179 6f75 743a 3a52   f_r = layout::R
+00022ac0: 6570 756c 7369 7665 466f 7263 653a 3a6e  epulsiveForce::n
+00022ad0: 6577 286b 2c20 7265 7075 6c73 6976 655f  ew(k, repulsive_
+00022ae0: 6578 706f 6e65 6e74 2e75 6e77 7261 705f  exponent.unwrap_
+00022af0: 6f72 2832 2929 3b0a 0a20 2020 206c 6574  or(2));..    let
+00022b00: 206e 756d 5f69 7465 7220 3d20 6e75 6d5f   num_iter = num_
+00022b10: 6974 6572 2e75 6e77 7261 705f 6f72 2835  iter.unwrap_or(5
+00022b20: 3029 3b0a 2020 2020 6c65 7420 746f 6c20  0);.    let tol 
+00022b30: 3d20 746f 6c2e 756e 7772 6170 5f6f 7228  = tol.unwrap_or(
+00022b40: 3165 2d36 293b 0a20 2020 206c 6574 2073  1e-6);.    let s
+00022b50: 7465 7020 3d20 302e 313b 0a0a 2020 2020  tep = 0.1;..    
+00022b60: 6c65 7420 6d75 7420 7765 6967 6874 733a  let mut weights:
+00022b70: 2048 6173 684d 6170 3c28 7573 697a 652c   HashMap<(usize,
+00022b80: 2075 7369 7a65 292c 2066 3634 3e20 3d0a   usize), f64> =.
+00022b90: 2020 2020 2020 2020 4861 7368 4d61 703a          HashMap:
+00022ba0: 3a77 6974 685f 6361 7061 6369 7479 2832  :with_capacity(2
+00022bb0: 202a 2067 7261 7068 2e65 6467 655f 636f   * graph.edge_co
+00022bc0: 756e 7428 2929 3b0a 2020 2020 666f 7220  unt());.    for 
+00022bd0: 6520 696e 2067 7261 7068 2e65 6467 655f  e in graph.edge_
+00022be0: 7265 6665 7265 6e63 6573 2829 207b 0a20  references() {. 
+00022bf0: 2020 2020 2020 206c 6574 2077 203d 2077         let w = w
+00022c00: 6569 6768 745f 6361 6c6c 6162 6c65 2870  eight_callable(p
+00022c10: 792c 2026 7765 6967 6874 5f66 6e2c 2026  y, &weight_fn, &
+00022c20: 652e 7765 6967 6874 2829 2c20 6465 6661  e.weight(), defa
+00022c30: 756c 745f 7765 6967 6874 293f 3b0a 2020  ult_weight)?;.  
+00022c40: 2020 2020 2020 6c65 7420 736f 7572 6365        let source
+00022c50: 203d 2065 2e73 6f75 7263 6528 292e 696e   = e.source().in
+00022c60: 6465 7828 293b 0a20 2020 2020 2020 206c  dex();.        l
+00022c70: 6574 2074 6172 6765 7420 3d20 652e 7461  et target = e.ta
+00022c80: 7267 6574 2829 2e69 6e64 6578 2829 3b0a  rget().index();.
+00022c90: 0a20 2020 2020 2020 2077 6569 6768 7473  .        weights
+00022ca0: 2e69 6e73 6572 7428 2873 6f75 7263 652c  .insert((source,
+00022cb0: 2074 6172 6765 7429 2c20 7729 3b0a 2020   target), w);.  
+00022cc0: 2020 2020 2020 7765 6967 6874 732e 696e        weights.in
+00022cd0: 7365 7274 2828 7461 7267 6574 2c20 736f  sert((target, so
+00022ce0: 7572 6365 292c 2077 293b 0a20 2020 207d  urce), w);.    }
+00022cf0: 0a0a 2020 2020 6c65 7420 706f 7320 3d20  ..    let pos = 
+00022d00: 6d61 7463 6820 6164 6170 7469 7665 5f63  match adaptive_c
+00022d10: 6f6f 6c69 6e67 207b 0a20 2020 2020 2020  ooling {.       
+00022d20: 2053 6f6d 6528 6661 6c73 6529 203d 3e20   Some(false) => 
+00022d30: 7b0a 2020 2020 2020 2020 2020 2020 6c65  {.            le
+00022d40: 7420 6373 203d 206c 6179 6f75 743a 3a4c  t cs = layout::L
+00022d50: 696e 6561 7243 6f6f 6c69 6e67 5363 6865  inearCoolingSche
+00022d60: 6d65 3a3a 6e65 7728 7374 6570 2c20 6e75  me::new(step, nu
+00022d70: 6d5f 6974 6572 293b 0a20 2020 2020 2020  m_iter);.       
+00022d80: 2020 2020 206c 6179 6f75 743a 3a65 766f       layout::evo
+00022d90: 6c76 6528 0a20 2020 2020 2020 2020 2020  lve(.           
+00022da0: 2020 2020 2067 7261 7068 2c20 7670 6f73       graph, vpos
+00022db0: 2c20 6669 7865 642c 2066 5f61 2c20 665f  , fixed, f_a, f_
+00022dc0: 722c 2063 732c 206e 756d 5f69 7465 722c  r, cs, num_iter,
+00022dd0: 2074 6f6c 2c20 7765 6967 6874 732c 0a20   tol, weights,. 
+00022de0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00022df0: 6361 6c65 2c20 6365 6e74 6572 2c0a 2020  cale, center,.  
+00022e00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022e10: 2020 2020 7d0a 2020 2020 2020 2020 5f20      }.        _ 
+00022e20: 3d3e 207b 0a20 2020 2020 2020 2020 2020  => {.           
+00022e30: 206c 6574 2063 7320 3d20 6c61 796f 7574   let cs = layout
+00022e40: 3a3a 4164 6170 7469 7665 436f 6f6c 696e  ::AdaptiveCoolin
+00022e50: 6753 6368 656d 653a 3a6e 6577 2873 7465  gScheme::new(ste
+00022e60: 7029 3b0a 2020 2020 2020 2020 2020 2020  p);.            
+00022e70: 6c61 796f 7574 3a3a 6576 6f6c 7665 280a  layout::evolve(.
+00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e90: 6772 6170 682c 2076 706f 732c 2066 6978  graph, vpos, fix
+00022ea0: 6564 2c20 665f 612c 2066 5f72 2c20 6373  ed, f_a, f_r, cs
+00022eb0: 2c20 6e75 6d5f 6974 6572 2c20 746f 6c2c  , num_iter, tol,
+00022ec0: 2077 6569 6768 7473 2c0a 2020 2020 2020   weights,.      
+00022ed0: 2020 2020 2020 2020 2020 7363 616c 652c            scale,
+00022ee0: 2063 656e 7465 722c 0a20 2020 2020 2020   center,.       
+00022ef0: 2020 2020 2029 0a20 2020 2020 2020 207d       ).        }
+00022f00: 0a20 2020 207d 3b0a 0a20 2020 204f 6b28  .    };..    Ok(
+00022f10: 506f 7332 444d 6170 7069 6e67 207b 0a20  Pos2DMapping {. 
+00022f20: 2020 2020 2020 2070 6f73 5f6d 6170 3a20         pos_map: 
+00022f30: 6772 6170 680a 2020 2020 2020 2020 2020  graph.          
+00022f40: 2020 2e6e 6f64 655f 696e 6469 6365 7328    .node_indices(
+00022f50: 290a 2020 2020 2020 2020 2020 2020 2e6d  ).            .m
+00022f60: 6170 287c 6e7c 207b 0a20 2020 2020 2020  ap(|n| {.       
+00022f70: 2020 2020 2020 2020 206c 6574 206e 203d           let n =
+00022f80: 206e 2e69 6e64 6578 2829 3b0a 2020 2020   n.index();.    
+00022f90: 2020 2020 2020 2020 2020 2020 286e 2c20              (n, 
+00022fa0: 706f 735b 6e5d 290a 2020 2020 2020 2020  pos[n]).        
+00022fb0: 2020 2020 7d29 0a20 2020 2020 2020 2020      }).         
+00022fc0: 2020 202e 636f 6c6c 6563 7428 292c 0a20     .collect(),. 
+00022fd0: 2020 207d 290a 7d0a 0a2f 2f2f 2050 6f73     }).}../// Pos
+00022fe0: 6974 696f 6e20 6e6f 6465 7320 7573 696e  ition nodes usin
+00022ff0: 6720 4672 7563 6874 6572 6d61 6e2d 5265  g Fruchterman-Re
+00023000: 696e 676f 6c64 2066 6f72 6365 2d64 6972  ingold force-dir
+00023010: 6563 7465 6420 616c 676f 7269 7468 6d2e  ected algorithm.
+00023020: 0a2f 2f2f 0a2f 2f2f 2054 6865 2061 6c67  .///./// The alg
+00023030: 6f72 6974 686d 2073 696d 756c 6174 6573  orithm simulates
+00023040: 2061 2066 6f72 6365 2d64 6972 6563 7465   a force-directe
+00023050: 6420 7265 7072 6573 656e 7461 7469 6f6e  d representation
+00023060: 206f 6620 7468 6520 6e65 7477 6f72 6b0a   of the network.
+00023070: 2f2f 2f20 7472 6561 7469 6e67 2065 6467  /// treating edg
+00023080: 6573 2061 7320 7370 7269 6e67 7320 686f  es as springs ho
+00023090: 6c64 696e 6720 6e6f 6465 7320 636c 6f73  lding nodes clos
+000230a0: 652c 2077 6869 6c65 2074 7265 6174 696e  e, while treatin
+000230b0: 6720 6e6f 6465 730a 2f2f 2f20 6173 2072  g nodes./// as r
+000230c0: 6570 656c 6c69 6e67 206f 626a 6563 7473  epelling objects
+000230d0: 2c20 736f 6d65 7469 6d65 7320 6361 6c6c  , sometimes call
+000230e0: 6564 2061 6e20 616e 7469 2d67 7261 7669  ed an anti-gravi
+000230f0: 7479 2066 6f72 6365 2e0a 2f2f 2f20 5369  ty force../// Si
+00023100: 6d75 6c61 7469 6f6e 2063 6f6e 7469 6e75  mulation continu
+00023110: 6573 2075 6e74 696c 2074 6865 2070 6f73  es until the pos
+00023120: 6974 696f 6e73 2061 7265 2063 6c6f 7365  itions are close
+00023130: 2074 6f20 616e 2065 7175 696c 6962 7269   to an equilibri
+00023140: 756d 2e0a 2f2f 2f0a 2f2f 2f20 3a70 6172  um..///./// :par
+00023150: 616d 2050 7947 7261 7068 2067 7261 7068  am PyGraph graph
+00023160: 3a20 4772 6170 6820 746f 2062 6520 7573  : Graph to be us
+00023170: 6564 2e0a 2f2f 2f20 3a70 6172 616d 2064  ed../// :param d
+00023180: 6963 7420 706f 733a 0a2f 2f2f 2020 2020  ict pos:.///    
+00023190: 2049 6e69 7469 616c 206e 6f64 6520 706f   Initial node po
+000231a0: 7369 7469 6f6e 7320 6173 2061 2064 6963  sitions as a dic
+000231b0: 7469 6f6e 6172 7920 7769 7468 206e 6f64  tionary with nod
+000231c0: 6520 6964 7320 6173 206b 6579 7320 616e  e ids as keys an
+000231d0: 6420 7661 6c75 6573 0a2f 2f2f 2020 2020  d values.///    
+000231e0: 2061 7320 6120 636f 6f72 6469 6e61 7465   as a coordinate
+000231f0: 206c 6973 742e 2049 6620 6060 4e6f 6e65   list. If ``None
+00023200: 6060 2c20 7468 656e 2075 7365 2072 616e  ``, then use ran
+00023210: 646f 6d20 696e 6974 6961 6c20 706f 7369  dom initial posi
+00023220: 7469 6f6e 732e 2028 6060 6465 6661 756c  tions. (``defaul
+00023230: 743d 4e6f 6e65 6060 290a 2f2f 2f20 3a70  t=None``)./// :p
+00023240: 6172 616d 2073 6574 2066 6978 6564 3a20  aram set fixed: 
+00023250: 4e6f 6465 7320 746f 206b 6565 7020 6669  Nodes to keep fi
+00023260: 7865 6420 6174 2069 6e69 7469 616c 2070  xed at initial p
+00023270: 6f73 6974 696f 6e2e 0a2f 2f2f 2020 2020  osition..///    
+00023280: 2045 7272 6f72 2072 6169 7365 6420 6966   Error raised if
+00023290: 2066 6978 6564 2073 7065 6369 6669 6564   fixed specified
+000232a0: 2061 6e64 2060 6070 6f73 6060 2069 7320   and ``pos`` is 
+000232b0: 6e6f 742e 2028 6060 6465 6661 756c 743d  not. (``default=
+000232c0: 4e6f 6e65 6060 290a 2f2f 2f20 3a70 6172  None``)./// :par
+000232d0: 616d 2066 6c6f 6174 2020 6b3a 0a2f 2f2f  am float  k:.///
+000232e0: 2020 2020 204f 7074 696d 616c 2064 6973       Optimal dis
+000232f0: 7461 6e63 6520 6265 7477 6565 6e20 6e6f  tance between no
+00023300: 6465 732e 2049 6620 6060 4e6f 6e65 6060  des. If ``None``
+00023310: 2074 6865 2064 6973 7461 6e63 6520 6973   the distance is
+00023320: 2073 6574 2074 6f0a 2f2f 2f20 2020 2020   set to.///     
+00023330: 3a6d 6174 683a 605c 6672 6163 7b31 7d7b  :math:`\frac{1}{
+00023340: 5c73 7172 747b 6e7d 7d60 2077 6865 7265  \sqrt{n}}` where
+00023350: 203a 6d61 7468 3a60 6e60 2069 7320 7468   :math:`n` is th
+00023360: 6520 6e75 6d62 6572 206f 6620 6e6f 6465  e number of node
+00023370: 732e 2020 496e 6372 6561 7365 2074 6869  s.  Increase thi
+00023380: 7320 7661 6c75 650a 2f2f 2f20 2020 2020  s value.///     
+00023390: 746f 206d 6f76 6520 6e6f 6465 7320 6661  to move nodes fa
+000233a0: 7274 6865 7220 6170 6172 742e 2028 6060  rther apart. (``
+000233b0: 6465 6661 756c 743d 4e6f 6e65 6060 290a  default=None``).
+000233c0: 2f2f 2f20 3a70 6172 616d 2069 6e74 2072  /// :param int r
+000233d0: 6570 756c 7369 7665 5f65 7870 6f6e 656e  epulsive_exponen
+000233e0: 743a 0a2f 2f2f 2020 2020 2052 6570 756c  t:.///     Repul
+000233f0: 7369 7665 2066 6f72 6365 2065 7870 6f6e  sive force expon
+00023400: 656e 742e 2028 6060 6465 6661 756c 743d  ent. (``default=
+00023410: 3260 6029 0a2f 2f2f 203a 7061 7261 6d20  2``)./// :param 
+00023420: 626f 6f6c 2061 6461 7074 6976 655f 636f  bool adaptive_co
+00023430: 6f6c 696e 673a 0a2f 2f2f 2020 2020 2055  oling:.///     U
+00023440: 7365 2061 6e20 6164 6170 7469 7665 2063  se an adaptive c
+00023450: 6f6f 6c69 6e67 2073 6368 656d 652e 2049  ooling scheme. I
+00023460: 6620 7365 7420 746f 2060 6046 616c 7365  f set to ``False
+00023470: 6060 2c0a 2f2f 2f20 2020 2020 6120 6c69  ``,.///     a li
+00023480: 6e65 6172 2063 6f6f 6c69 6e67 2073 6368  near cooling sch
+00023490: 656d 6520 6973 2075 7365 642e 2028 6060  eme is used. (``
+000234a0: 6465 6661 756c 743d 5472 7565 6060 290a  default=True``).
+000234b0: 2f2f 2f20 3a70 6172 616d 2069 6e74 206e  /// :param int n
+000234c0: 756d 5f69 7465 723a 0a2f 2f2f 2020 2020  um_iter:.///    
+000234d0: 204d 6178 696d 756d 206e 756d 6265 7220   Maximum number 
+000234e0: 6f66 2069 7465 7261 7469 6f6e 732e 2028  of iterations. (
+000234f0: 6060 6465 6661 756c 743d 3530 6060 290a  ``default=50``).
+00023500: 2f2f 2f20 3a70 6172 616d 2066 6c6f 6174  /// :param float
+00023510: 2074 6f6c 3a0a 2f2f 2f20 2020 2020 5468   tol:.///     Th
+00023520: 7265 7368 6f6c 6420 666f 7220 7265 6c61  reshold for rela
+00023530: 7469 7665 2065 7272 6f72 2069 6e20 6e6f  tive error in no
+00023540: 6465 2070 6f73 6974 696f 6e20 6368 616e  de position chan
+00023550: 6765 732e 0a2f 2f2f 2020 2020 2054 6865  ges..///     The
+00023560: 2069 7465 7261 7469 6f6e 2073 746f 7073   iteration stops
+00023570: 2069 6620 7468 6520 6572 726f 7220 6973   if the error is
+00023580: 2062 656c 6f77 2074 6869 7320 7468 7265   below this thre
+00023590: 7368 6f6c 642e 0a2f 2f2f 2020 2020 2028  shold..///     (
+000235a0: 6060 6465 6661 756c 7420 3d20 3165 2d36  ``default = 1e-6
+000235b0: 6060 290a 2f2f 2f20 3a70 6172 616d 2077  ``)./// :param w
+000235c0: 6569 6768 745f 666e 3a20 416e 206f 7074  eight_fn: An opt
+000235d0: 696f 6e61 6c20 7765 6967 6874 2066 756e  ional weight fun
+000235e0: 6374 696f 6e20 666f 7220 616e 2065 6467  ction for an edg
+000235f0: 652e 2049 7420 7769 6c6c 2061 6363 6570  e. It will accep
+00023600: 740a 2f2f 2f20 2020 2020 6120 7369 6e67  t.///     a sing
+00023610: 6c65 2061 7267 756d 656e 742c 2074 6865  le argument, the
+00023620: 2065 6467 6527 7320 7765 6967 6874 206f   edge's weight o
+00023630: 626a 6563 7420 616e 6420 7769 6c6c 2072  bject and will r
+00023640: 6574 7572 6e20 6120 666c 6f61 740a 2f2f  eturn a float.//
+00023650: 2f20 2020 2020 7768 6963 6820 7769 6c6c  /     which will
+00023660: 2062 6520 7573 6564 2074 6f20 7265 7072   be used to repr
+00023670: 6573 656e 7420 7468 6520 7765 6967 6874  esent the weight
+00023680: 206f 6620 7468 6520 6564 6765 2e0a 2f2f   of the edge..//
+00023690: 2f20 3a70 6172 616d 2066 6c6f 6174 2028  / :param float (
+000236a0: 6465 6661 756c 743d 3129 2064 6566 6175  default=1) defau
+000236b0: 6c74 5f77 6569 6768 743a 2049 6620 6060  lt_weight: If ``
+000236c0: 7765 6967 6874 5f66 6e60 6020 6973 6e27  weight_fn`` isn'
+000236d0: 7420 7370 6563 6966 6965 640a 2f2f 2f20  t specified./// 
+000236e0: 2020 2020 7468 6973 206f 7074 696f 6e61      this optiona
+000236f0: 6c20 666c 6f61 7420 7661 6c75 6520 7769  l float value wi
+00023700: 6c6c 2062 6520 7573 6564 2066 6f72 2074  ll be used for t
+00023710: 6865 2077 6569 6768 742f 636f 7374 206f  he weight/cost o
+00023720: 6620 6561 6368 2065 6467 650a 2f2f 2f20  f each edge./// 
+00023730: 3a70 6172 616d 2066 6c6f 6174 7c4e 6f6e  :param float|Non
+00023740: 6520 7363 616c 653a 2053 6361 6c65 2066  e scale: Scale f
+00023750: 6163 746f 7220 666f 7220 706f 7369 7469  actor for positi
+00023760: 6f6e 732e 0a2f 2f2f 2020 2020 204e 6f74  ons..///     Not
+00023770: 2075 7365 6420 756e 6c65 7373 2066 6978   used unless fix
+00023780: 6564 2069 7320 4e6f 6e65 2e20 4966 2073  ed is None. If s
+00023790: 6361 6c65 2069 7320 6060 4e6f 6e65 6060  cale is ``None``
+000237a0: 2c20 6e6f 2072 652d 7363 616c 696e 6720  , no re-scaling 
+000237b0: 6973 0a2f 2f2f 2020 2020 2070 6572 666f  is.///     perfo
+000237c0: 726d 6564 2e20 2860 6064 6566 6175 6c74  rmed. (``default
+000237d0: 3d31 2e30 6060 290a 2f2f 2f20 3a70 6172  =1.0``)./// :par
+000237e0: 616d 206c 6973 7420 6365 6e74 6572 3a20  am list center: 
+000237f0: 436f 6f72 6469 6e61 7465 2070 6169 7220  Coordinate pair 
+00023800: 6172 6f75 6e64 2077 6869 6368 2074 6f20  around which to 
+00023810: 6365 6e74 6572 0a2f 2f2f 2020 2020 2074  center.///     t
+00023820: 6865 206c 6179 6f75 742e 204e 6f74 2075  he layout. Not u
+00023830: 7365 6420 756e 6c65 7373 2066 6978 6564  sed unless fixed
+00023840: 2069 7320 6060 4e6f 6e65 6060 2e20 2860   is ``None``. (`
+00023850: 6064 6566 6175 6c74 3d4e 6f6e 6560 6029  `default=None``)
+00023860: 0a2f 2f2f 203a 7061 7261 6d20 696e 7420  ./// :param int 
+00023870: 7365 6564 3a20 416e 206f 7074 696f 6e61  seed: An optiona
+00023880: 6c20 7365 6564 2074 6f20 7573 6520 666f  l seed to use fo
+00023890: 7220 7468 6520 7261 6e64 6f6d 206e 756d  r the random num
+000238a0: 6265 7220 6765 6e65 7261 746f 720a 2f2f  ber generator.//
+000238b0: 2f0a 2f2f 2f20 3a72 6574 7572 6e73 3a20  /./// :returns: 
+000238c0: 4120 6469 6374 696f 6e61 7279 206f 6620  A dictionary of 
+000238d0: 706f 7369 7469 6f6e 7320 6b65 7965 6420  positions keyed 
+000238e0: 6279 206e 6f64 6520 6964 2e0a 2f2f 2f20  by node id../// 
+000238f0: 3a72 7479 7065 3a20 6469 6374 0a23 5b70  :rtype: dict.#[p
+00023900: 7966 756e 6374 696f 6e5d 0a23 5b74 6578  yfunction].#[tex
+00023910: 745f 7369 676e 6174 7572 6520 3d20 2228  t_signature = "(
+00023920: 6772 6170 682c 2070 6f73 3d4e 6f6e 652c  graph, pos=None,
+00023930: 2066 6978 6564 3d4e 6f6e 652c 206b 3d4e   fixed=None, k=N
+00023940: 6f6e 652c 2072 6570 756c 7369 7665 5f65  one, repulsive_e
+00023950: 7870 6f6e 656e 743d 322c 2061 6461 7074  xponent=2, adapt
+00023960: 6976 655f 636f 6f6c 696e 673d 5472 7565  ive_cooling=True
+00023970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00023980: 2020 2020 2020 206e 756d 5f69 7465 723d         num_iter=
+00023990: 3530 2c20 746f 6c3d 3165 2d36 2c20 7765  50, tol=1e-6, we
+000239a0: 6967 6874 5f66 6e3d 4e6f 6e65 2c20 6465  ight_fn=None, de
+000239b0: 6661 756c 745f 7765 6967 6874 3d31 2c20  fault_weight=1, 
+000239c0: 7363 616c 653d 312c 0a20 2020 2020 2020  scale=1,.       
+000239d0: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+000239e0: 6e74 6572 3d4e 6f6e 652c 2073 6565 643d  nter=None, seed=
+000239f0: 4e6f 6e65 2c20 2f29 225d 0a23 5b61 6c6c  None, /)"].#[all
+00023a00: 6f77 2863 6c69 7070 793a 3a74 6f6f 5f6d  ow(clippy::too_m
+00023a10: 616e 795f 6172 6775 6d65 6e74 7329 5d0a  any_arguments)].
+00023a20: 7075 6220 666e 2067 7261 7068 5f73 7072  pub fn graph_spr
+00023a30: 696e 675f 6c61 796f 7574 280a 2020 2020  ing_layout(.    
+00023a40: 7079 3a20 5079 7468 6f6e 2c0a 2020 2020  py: Python,.    
+00023a50: 6772 6170 683a 2026 6772 6170 683a 3a50  graph: &graph::P
+00023a60: 7947 7261 7068 2c0a 2020 2020 706f 733a  yGraph,.    pos:
+00023a70: 204f 7074 696f 6e3c 4861 7368 4d61 703c   Option<HashMap<
+00023a80: 7573 697a 652c 206c 6179 6f75 743a 3a50  usize, layout::P
+00023a90: 6f69 6e74 3e3e 2c0a 2020 2020 6669 7865  oint>>,.    fixe
+00023aa0: 643a 204f 7074 696f 6e3c 4861 7368 5365  d: Option<HashSe
+00023ab0: 743c 7573 697a 653e 3e2c 0a20 2020 206b  t<usize>>,.    k
+00023ac0: 3a20 4f70 7469 6f6e 3c66 3634 3e2c 0a20  : Option<f64>,. 
+00023ad0: 2020 2072 6570 756c 7369 7665 5f65 7870     repulsive_exp
+00023ae0: 6f6e 656e 743a 204f 7074 696f 6e3c 6933  onent: Option<i3
+00023af0: 323e 2c0a 2020 2020 6164 6170 7469 7665  2>,.    adaptive
+00023b00: 5f63 6f6f 6c69 6e67 3a20 4f70 7469 6f6e  _cooling: Option
+00023b10: 3c62 6f6f 6c3e 2c0a 2020 2020 6e75 6d5f  <bool>,.    num_
+00023b20: 6974 6572 3a20 4f70 7469 6f6e 3c75 7369  iter: Option<usi
+00023b30: 7a65 3e2c 0a20 2020 2074 6f6c 3a20 4f70  ze>,.    tol: Op
+00023b40: 7469 6f6e 3c66 3634 3e2c 0a20 2020 2077  tion<f64>,.    w
+00023b50: 6569 6768 745f 666e 3a20 4f70 7469 6f6e  eight_fn: Option
+00023b60: 3c50 794f 626a 6563 743e 2c0a 2020 2020  <PyObject>,.    
+00023b70: 6465 6661 756c 745f 7765 6967 6874 3a20  default_weight: 
+00023b80: 6636 342c 0a20 2020 2073 6361 6c65 3a20  f64,.    scale: 
+00023b90: 4f70 7469 6f6e 3c66 3634 3e2c 0a20 2020  Option<f64>,.   
+00023ba0: 2063 656e 7465 723a 204f 7074 696f 6e3c   center: Option<
+00023bb0: 6c61 796f 7574 3a3a 506f 696e 743e 2c0a  layout::Point>,.
+00023bc0: 2020 2020 7365 6564 3a20 4f70 7469 6f6e      seed: Option
+00023bd0: 3c75 3634 3e2c 0a29 202d 3e20 5079 5265  <u64>,.) -> PyRe
+00023be0: 7375 6c74 3c50 6f73 3244 4d61 7070 696e  sult<Pos2DMappin
+00023bf0: 673e 207b 0a20 2020 205f 7370 7269 6e67  g> {.    _spring
+00023c00: 5f6c 6179 6f75 7428 0a20 2020 2020 2020  _layout(.       
+00023c10: 2070 792c 0a20 2020 2020 2020 2026 6772   py,.        &gr
+00023c20: 6170 682e 6772 6170 682c 0a20 2020 2020  aph.graph,.     
+00023c30: 2020 2070 6f73 2c0a 2020 2020 2020 2020     pos,.        
+00023c40: 6669 7865 642c 0a20 2020 2020 2020 206b  fixed,.        k
+00023c50: 2c0a 2020 2020 2020 2020 7265 7075 6c73  ,.        repuls
+00023c60: 6976 655f 6578 706f 6e65 6e74 2c0a 2020  ive_exponent,.  
+00023c70: 2020 2020 2020 6164 6170 7469 7665 5f63        adaptive_c
+00023c80: 6f6f 6c69 6e67 2c0a 2020 2020 2020 2020  ooling,.        
+00023c90: 6e75 6d5f 6974 6572 2c0a 2020 2020 2020  num_iter,.      
+00023ca0: 2020 746f 6c2c 0a20 2020 2020 2020 2077    tol,.        w
+00023cb0: 6569 6768 745f 666e 2c0a 2020 2020 2020  eight_fn,.      
+00023cc0: 2020 6465 6661 756c 745f 7765 6967 6874    default_weight
+00023cd0: 2c0a 2020 2020 2020 2020 7363 616c 652c  ,.        scale,
+00023ce0: 0a20 2020 2020 2020 2063 656e 7465 722c  .        center,
+00023cf0: 0a20 2020 2020 2020 2073 6565 642c 0a20  .        seed,. 
+00023d00: 2020 2029 0a7d 0a0a 2f2f 2f20 506f 7369     ).}../// Posi
+00023d10: 7469 6f6e 206e 6f64 6573 2075 7369 6e67  tion nodes using
+00023d20: 2046 7275 6368 7465 726d 616e 2d52 6569   Fruchterman-Rei
+00023d30: 6e67 6f6c 6420 666f 7263 652d 6469 7265  ngold force-dire
+00023d40: 6374 6564 2061 6c67 6f72 6974 686d 2e0a  cted algorithm..
+00023d50: 2f2f 2f0a 2f2f 2f20 5468 6520 616c 676f  ///./// The algo
+00023d60: 7269 7468 6d20 7369 6d75 6c61 7465 7320  rithm simulates 
+00023d70: 6120 666f 7263 652d 6469 7265 6374 6564  a force-directed
+00023d80: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
+00023d90: 6f66 2074 6865 206e 6574 776f 726b 0a2f  of the network./
+00023da0: 2f2f 2074 7265 6174 696e 6720 6564 6765  // treating edge
+00023db0: 7320 6173 2073 7072 696e 6773 2068 6f6c  s as springs hol
+00023dc0: 6469 6e67 206e 6f64 6573 2063 6c6f 7365  ding nodes close
+00023dd0: 2c20 7768 696c 6520 7472 6561 7469 6e67  , while treating
+00023de0: 206e 6f64 6573 0a2f 2f2f 2061 7320 7265   nodes./// as re
+00023df0: 7065 6c6c 696e 6720 6f62 6a65 6374 732c  pelling objects,
+00023e00: 2073 6f6d 6574 696d 6573 2063 616c 6c65   sometimes calle
+00023e10: 6420 616e 2061 6e74 692d 6772 6176 6974  d an anti-gravit
+00023e20: 7920 666f 7263 652e 0a2f 2f2f 2053 696d  y force../// Sim
+00023e30: 756c 6174 696f 6e20 636f 6e74 696e 7565  ulation continue
+00023e40: 7320 756e 7469 6c20 7468 6520 706f 7369  s until the posi
+00023e50: 7469 6f6e 7320 6172 6520 636c 6f73 6520  tions are close 
+00023e60: 746f 2061 6e20 6571 7569 6c69 6272 6975  to an equilibriu
+00023e70: 6d2e 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  m..///./// :para
+00023e80: 6d20 5079 4772 6170 6820 6772 6170 683a  m PyGraph graph:
+00023e90: 2047 7261 7068 2074 6f20 6265 2075 7365   Graph to be use
+00023ea0: 642e 0a2f 2f2f 203a 7061 7261 6d20 6469  d../// :param di
+00023eb0: 6374 2070 6f73 3a0a 2f2f 2f20 2020 2020  ct pos:.///     
+00023ec0: 496e 6974 6961 6c20 6e6f 6465 2070 6f73  Initial node pos
+00023ed0: 6974 696f 6e73 2061 7320 6120 6469 6374  itions as a dict
+00023ee0: 696f 6e61 7279 2077 6974 6820 6e6f 6465  ionary with node
+00023ef0: 2069 6473 2061 7320 6b65 7973 2061 6e64   ids as keys and
+00023f00: 2076 616c 7565 730a 2f2f 2f20 2020 2020   values.///     
+00023f10: 6173 2061 2063 6f6f 7264 696e 6174 6520  as a coordinate 
+00023f20: 6c69 7374 2e20 4966 2060 604e 6f6e 6560  list. If ``None`
+00023f30: 602c 2074 6865 6e20 7573 6520 7261 6e64  `, then use rand
+00023f40: 6f6d 2069 6e69 7469 616c 2070 6f73 6974  om initial posit
+00023f50: 696f 6e73 2e20 2860 6064 6566 6175 6c74  ions. (``default
+00023f60: 3d4e 6f6e 6560 6029 0a2f 2f2f 203a 7061  =None``)./// :pa
+00023f70: 7261 6d20 7365 7420 6669 7865 643a 204e  ram set fixed: N
+00023f80: 6f64 6573 2074 6f20 6b65 6570 2066 6978  odes to keep fix
+00023f90: 6564 2061 7420 696e 6974 6961 6c20 706f  ed at initial po
+00023fa0: 7369 7469 6f6e 2e0a 2f2f 2f20 2020 2020  sition..///     
+00023fb0: 4572 726f 7220 7261 6973 6564 2069 6620  Error raised if 
+00023fc0: 6669 7865 6420 7370 6563 6966 6965 6420  fixed specified 
+00023fd0: 616e 6420 6060 706f 7360 6020 6973 206e  and ``pos`` is n
+00023fe0: 6f74 2e20 2860 6064 6566 6175 6c74 3d4e  ot. (``default=N
+00023ff0: 6f6e 6560 6029 0a2f 2f2f 203a 7061 7261  one``)./// :para
+00024000: 6d20 666c 6f61 7420 206b 3a0a 2f2f 2f20  m float  k:./// 
+00024010: 2020 2020 4f70 7469 6d61 6c20 6469 7374      Optimal dist
+00024020: 616e 6365 2062 6574 7765 656e 206e 6f64  ance between nod
+00024030: 6573 2e20 4966 2060 604e 6f6e 6560 6020  es. If ``None`` 
+00024040: 7468 6520 6469 7374 616e 6365 2069 7320  the distance is 
+00024050: 7365 7420 746f 0a2f 2f2f 2020 2020 203a  set to.///     :
+00024060: 6d61 7468 3a60 5c66 7261 637b 317d 7b5c  math:`\frac{1}{\
+00024070: 7371 7274 7b6e 7d7d 6020 7768 6572 6520  sqrt{n}}` where 
+00024080: 3a6d 6174 683a 606e 6020 6973 2074 6865  :math:`n` is the
+00024090: 206e 756d 6265 7220 6f66 206e 6f64 6573   number of nodes
+000240a0: 2e20 2049 6e63 7265 6173 6520 7468 6973  .  Increase this
+000240b0: 2076 616c 7565 0a2f 2f2f 2020 2020 2074   value.///     t
+000240c0: 6f20 6d6f 7665 206e 6f64 6573 2066 6172  o move nodes far
+000240d0: 7468 6572 2061 7061 7274 2e20 2860 6064  ther apart. (``d
+000240e0: 6566 6175 6c74 3d4e 6f6e 6560 6029 0a2f  efault=None``)./
+000240f0: 2f2f 203a 7061 7261 6d20 696e 7420 7265  // :param int re
+00024100: 7075 6c73 6976 655f 6578 706f 6e65 6e74  pulsive_exponent
+00024110: 3a0a 2f2f 2f20 2020 2020 5265 7075 6c73  :.///     Repuls
+00024120: 6976 6520 666f 7263 6520 6578 706f 6e65  ive force expone
+00024130: 6e74 2e20 2860 6064 6566 6175 6c74 3d32  nt. (``default=2
+00024140: 6060 290a 2f2f 2f20 3a70 6172 616d 2062  ``)./// :param b
+00024150: 6f6f 6c20 6164 6170 7469 7665 5f63 6f6f  ool adaptive_coo
+00024160: 6c69 6e67 3a0a 2f2f 2f20 2020 2020 5573  ling:.///     Us
+00024170: 6520 616e 2061 6461 7074 6976 6520 636f  e an adaptive co
+00024180: 6f6c 696e 6720 7363 6865 6d65 2e20 4966  oling scheme. If
+00024190: 2073 6574 2074 6f20 6060 4661 6c73 6560   set to ``False`
+000241a0: 602c 0a2f 2f2f 2020 2020 2061 206c 696e  `,.///     a lin
+000241b0: 6561 7220 636f 6f6c 696e 6720 7363 6865  ear cooling sche
+000241c0: 6d65 2069 7320 7573 6564 2e20 2860 6064  me is used. (``d
+000241d0: 6566 6175 6c74 3d54 7275 6560 6029 0a2f  efault=True``)./
+000241e0: 2f2f 203a 7061 7261 6d20 696e 7420 6e75  // :param int nu
+000241f0: 6d5f 6974 6572 3a0a 2f2f 2f20 2020 2020  m_iter:.///     
+00024200: 4d61 7869 6d75 6d20 6e75 6d62 6572 206f  Maximum number o
+00024210: 6620 6974 6572 6174 696f 6e73 2e20 2860  f iterations. (`
+00024220: 6064 6566 6175 6c74 3d35 3060 6029 0a2f  `default=50``)./
+00024230: 2f2f 203a 7061 7261 6d20 666c 6f61 7420  // :param float 
+00024240: 746f 6c3a 0a2f 2f2f 2020 2020 2054 6872  tol:.///     Thr
+00024250: 6573 686f 6c64 2066 6f72 2072 656c 6174  eshold for relat
+00024260: 6976 6520 6572 726f 7220 696e 206e 6f64  ive error in nod
+00024270: 6520 706f 7369 7469 6f6e 2063 6861 6e67  e position chang
+00024280: 6573 2e0a 2f2f 2f20 2020 2020 5468 6520  es..///     The 
+00024290: 6974 6572 6174 696f 6e20 7374 6f70 7320  iteration stops 
+000242a0: 6966 2074 6865 2065 7272 6f72 2069 7320  if the error is 
+000242b0: 6265 6c6f 7720 7468 6973 2074 6872 6573  below this thres
+000242c0: 686f 6c64 2e0a 2f2f 2f20 2020 2020 2860  hold..///     (`
+000242d0: 6064 6566 6175 6c74 203d 2031 652d 3660  `default = 1e-6`
+000242e0: 6029 0a2f 2f2f 203a 7061 7261 6d20 7765  `)./// :param we
+000242f0: 6967 6874 5f66 6e3a 2041 6e20 6f70 7469  ight_fn: An opti
+00024300: 6f6e 616c 2077 6569 6768 7420 6675 6e63  onal weight func
+00024310: 7469 6f6e 2066 6f72 2061 6e20 6564 6765  tion for an edge
+00024320: 2e20 4974 2077 696c 6c20 6163 6365 7074  . It will accept
+00024330: 0a2f 2f2f 2020 2020 2061 2073 696e 676c  .///     a singl
+00024340: 6520 6172 6775 6d65 6e74 2c20 7468 6520  e argument, the 
+00024350: 6564 6765 2773 2077 6569 6768 7420 6f62  edge's weight ob
+00024360: 6a65 6374 2061 6e64 2077 696c 6c20 7265  ject and will re
+00024370: 7475 726e 2061 2066 6c6f 6174 0a2f 2f2f  turn a float.///
+00024380: 2020 2020 2077 6869 6368 2077 696c 6c20       which will 
+00024390: 6265 2075 7365 6420 746f 2072 6570 7265  be used to repre
+000243a0: 7365 6e74 2074 6865 2077 6569 6768 7420  sent the weight 
+000243b0: 6f66 2074 6865 2065 6467 652e 0a2f 2f2f  of the edge..///
+000243c0: 203a 7061 7261 6d20 666c 6f61 7420 2864   :param float (d
+000243d0: 6566 6175 6c74 3d31 2920 6465 6661 756c  efault=1) defaul
+000243e0: 745f 7765 6967 6874 3a20 4966 2060 6077  t_weight: If ``w
+000243f0: 6569 6768 745f 666e 6060 2069 736e 2774  eight_fn`` isn't
+00024400: 2073 7065 6369 6669 6564 0a2f 2f2f 2020   specified.///  
+00024410: 2020 2074 6869 7320 6f70 7469 6f6e 616c     this optional
+00024420: 2066 6c6f 6174 2076 616c 7565 2077 696c   float value wil
+00024430: 6c20 6265 2075 7365 6420 666f 7220 7468  l be used for th
+00024440: 6520 7765 6967 6874 2f63 6f73 7420 6f66  e weight/cost of
+00024450: 2065 6163 6820 6564 6765 0a2f 2f2f 203a   each edge./// :
+00024460: 7061 7261 6d20 666c 6f61 747c 4e6f 6e65  param float|None
+00024470: 2073 6361 6c65 3a20 5363 616c 6520 6661   scale: Scale fa
+00024480: 6374 6f72 2066 6f72 2070 6f73 6974 696f  ctor for positio
+00024490: 6e73 2e0a 2f2f 2f20 2020 2020 4e6f 7420  ns..///     Not 
+000244a0: 7573 6564 2075 6e6c 6573 7320 6669 7865  used unless fixe
+000244b0: 6420 6973 204e 6f6e 652e 2049 6620 7363  d is None. If sc
+000244c0: 616c 6520 6973 2060 604e 6f6e 6560 602c  ale is ``None``,
+000244d0: 206e 6f20 7265 2d73 6361 6c69 6e67 2069   no re-scaling i
+000244e0: 730a 2f2f 2f20 2020 2020 7065 7266 6f72  s.///     perfor
+000244f0: 6d65 642e 2028 6060 6465 6661 756c 743d  med. (``default=
+00024500: 312e 3060 6029 0a2f 2f2f 203a 7061 7261  1.0``)./// :para
+00024510: 6d20 6c69 7374 2063 656e 7465 723a 2043  m list center: C
+00024520: 6f6f 7264 696e 6174 6520 7061 6972 2061  oordinate pair a
+00024530: 726f 756e 6420 7768 6963 6820 746f 2063  round which to c
+00024540: 656e 7465 720a 2f2f 2f20 2020 2020 7468  enter.///     th
+00024550: 6520 6c61 796f 7574 2e20 4e6f 7420 7573  e layout. Not us
+00024560: 6564 2075 6e6c 6573 7320 6669 7865 6420  ed unless fixed 
+00024570: 6973 2060 604e 6f6e 6560 602e 2028 6060  is ``None``. (``
+00024580: 6465 6661 756c 743d 4e6f 6e65 6060 290a  default=None``).
+00024590: 2f2f 2f20 3a70 6172 616d 2069 6e74 2073  /// :param int s
+000245a0: 6565 643a 2041 6e20 6f70 7469 6f6e 616c  eed: An optional
+000245b0: 2073 6565 6420 746f 2075 7365 2066 6f72   seed to use for
+000245c0: 2074 6865 2072 616e 646f 6d20 6e75 6d62   the random numb
+000245d0: 6572 2067 656e 6572 6174 6f72 0a2f 2f2f  er generator.///
+000245e0: 0a2f 2f2f 203a 7265 7475 726e 733a 2041  ./// :returns: A
+000245f0: 2064 6963 7469 6f6e 6172 7920 6f66 2070   dictionary of p
+00024600: 6f73 6974 696f 6e73 206b 6579 6564 2062  ositions keyed b
+00024610: 7920 6e6f 6465 2069 642e 0a2f 2f2f 203a  y node id../// :
+00024620: 7274 7970 653a 2064 6963 740a 235b 7079  rtype: dict.#[py
+00024630: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+00024640: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+00024650: 7261 7068 2c20 706f 733d 4e6f 6e65 2c20  raph, pos=None, 
+00024660: 6669 7865 643d 4e6f 6e65 2c20 6b3d 4e6f  fixed=None, k=No
+00024670: 6e65 2c20 7265 7075 6c73 6976 655f 6578  ne, repulsive_ex
+00024680: 706f 6e65 6e74 3d32 2c20 6164 6170 7469  ponent=2, adapti
+00024690: 7665 5f63 6f6f 6c69 6e67 3d54 7275 652c  ve_cooling=True,
+000246a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000246b0: 2020 2020 2020 6e75 6d5f 6974 6572 3d35        num_iter=5
+000246c0: 302c 2074 6f6c 3d31 652d 362c 2077 6569  0, tol=1e-6, wei
+000246d0: 6768 745f 666e 3d4e 6f6e 652c 2064 6566  ght_fn=None, def
+000246e0: 6175 6c74 5f77 6569 6768 743d 312c 2073  ault_weight=1, s
+000246f0: 6361 6c65 3d31 2c0a 2020 2020 2020 2020  cale=1,.        
+00024700: 2020 2020 2020 2020 2020 2020 2063 656e               cen
+00024710: 7465 723d 4e6f 6e65 2c20 7365 6564 3d4e  ter=None, seed=N
+00024720: 6f6e 652c 202f 2922 5d0a 235b 616c 6c6f  one, /)"].#[allo
+00024730: 7728 636c 6970 7079 3a3a 746f 6f5f 6d61  w(clippy::too_ma
+00024740: 6e79 5f61 7267 756d 656e 7473 295d 0a70  ny_arguments)].p
+00024750: 7562 2066 6e20 6469 6772 6170 685f 7370  ub fn digraph_sp
+00024760: 7269 6e67 5f6c 6179 6f75 7428 0a20 2020  ring_layout(.   
+00024770: 2070 793a 2050 7974 686f 6e2c 0a20 2020   py: Python,.   
+00024780: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
+00024790: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
+000247a0: 2070 6f73 3a20 4f70 7469 6f6e 3c48 6173   pos: Option<Has
+000247b0: 684d 6170 3c75 7369 7a65 2c20 6c61 796f  hMap<usize, layo
+000247c0: 7574 3a3a 506f 696e 743e 3e2c 0a20 2020  ut::Point>>,.   
+000247d0: 2066 6978 6564 3a20 4f70 7469 6f6e 3c48   fixed: Option<H
+000247e0: 6173 6853 6574 3c75 7369 7a65 3e3e 2c0a  ashSet<usize>>,.
+000247f0: 2020 2020 6b3a 204f 7074 696f 6e3c 6636      k: Option<f6
+00024800: 343e 2c0a 2020 2020 7265 7075 6c73 6976  4>,.    repulsiv
+00024810: 655f 6578 706f 6e65 6e74 3a20 4f70 7469  e_exponent: Opti
+00024820: 6f6e 3c69 3332 3e2c 0a20 2020 2061 6461  on<i32>,.    ada
+00024830: 7074 6976 655f 636f 6f6c 696e 673a 204f  ptive_cooling: O
+00024840: 7074 696f 6e3c 626f 6f6c 3e2c 0a20 2020  ption<bool>,.   
+00024850: 206e 756d 5f69 7465 723a 204f 7074 696f   num_iter: Optio
+00024860: 6e3c 7573 697a 653e 2c0a 2020 2020 746f  n<usize>,.    to
+00024870: 6c3a 204f 7074 696f 6e3c 6636 343e 2c0a  l: Option<f64>,.
+00024880: 2020 2020 7765 6967 6874 5f66 6e3a 204f      weight_fn: O
+00024890: 7074 696f 6e3c 5079 4f62 6a65 6374 3e2c  ption<PyObject>,
+000248a0: 0a20 2020 2064 6566 6175 6c74 5f77 6569  .    default_wei
+000248b0: 6768 743a 2066 3634 2c0a 2020 2020 7363  ght: f64,.    sc
+000248c0: 616c 653a 204f 7074 696f 6e3c 6636 343e  ale: Option<f64>
+000248d0: 2c0a 2020 2020 6365 6e74 6572 3a20 4f70  ,.    center: Op
+000248e0: 7469 6f6e 3c6c 6179 6f75 743a 3a50 6f69  tion<layout::Poi
+000248f0: 6e74 3e2c 0a20 2020 2073 6565 643a 204f  nt>,.    seed: O
+00024900: 7074 696f 6e3c 7536 343e 2c0a 2920 2d3e  ption<u64>,.) ->
+00024910: 2050 7952 6573 756c 743c 506f 7332 444d   PyResult<Pos2DM
+00024920: 6170 7069 6e67 3e20 7b0a 2020 2020 5f73  apping> {.    _s
+00024930: 7072 696e 675f 6c61 796f 7574 280a 2020  pring_layout(.  
+00024940: 2020 2020 2020 7079 2c0a 2020 2020 2020        py,.      
+00024950: 2020 2667 7261 7068 2e67 7261 7068 2c0a    &graph.graph,.
+00024960: 2020 2020 2020 2020 706f 732c 0a20 2020          pos,.   
+00024970: 2020 2020 2066 6978 6564 2c0a 2020 2020       fixed,.    
+00024980: 2020 2020 6b2c 0a20 2020 2020 2020 2072      k,.        r
+00024990: 6570 756c 7369 7665 5f65 7870 6f6e 656e  epulsive_exponen
+000249a0: 742c 0a20 2020 2020 2020 2061 6461 7074  t,.        adapt
+000249b0: 6976 655f 636f 6f6c 696e 672c 0a20 2020  ive_cooling,.   
+000249c0: 2020 2020 206e 756d 5f69 7465 722c 0a20       num_iter,. 
+000249d0: 2020 2020 2020 2074 6f6c 2c0a 2020 2020         tol,.    
+000249e0: 2020 2020 7765 6967 6874 5f66 6e2c 0a20      weight_fn,. 
+000249f0: 2020 2020 2020 2064 6566 6175 6c74 5f77         default_w
+00024a00: 6569 6768 742c 0a20 2020 2020 2020 2073  eight,.        s
+00024a10: 6361 6c65 2c0a 2020 2020 2020 2020 6365  cale,.        ce
+00024a20: 6e74 6572 2c0a 2020 2020 2020 2020 7365  nter,.        se
+00024a30: 6564 2c0a 2020 2020 290a 7d0a 0a66 6e20  ed,.    ).}..fn 
+00024a40: 5f72 616e 646f 6d5f 6c61 796f 7574 3c54  _random_layout<T
+00024a50: 793a 2045 6467 6554 7970 653e 280a 2020  y: EdgeType>(.  
+00024a60: 2020 6772 6170 683a 2026 5374 6162 6c65    graph: &Stable
+00024a70: 4772 6170 683c 5079 4f62 6a65 6374 2c20  Graph<PyObject, 
+00024a80: 5079 4f62 6a65 6374 2c20 5479 3e2c 0a20  PyObject, Ty>,. 
+00024a90: 2020 2063 656e 7465 723a 204f 7074 696f     center: Optio
+00024aa0: 6e3c 5b66 3634 3b20 325d 3e2c 0a20 2020  n<[f64; 2]>,.   
+00024ab0: 2073 6565 643a 204f 7074 696f 6e3c 7536   seed: Option<u6
+00024ac0: 343e 2c0a 2920 2d3e 2050 6f73 3244 4d61  4>,.) -> Pos2DMa
+00024ad0: 7070 696e 6720 7b0a 2020 2020 6c65 7420  pping {.    let 
+00024ae0: 6d75 7420 726e 673a 2050 6367 3634 203d  mut rng: Pcg64 =
+00024af0: 206d 6174 6368 2073 6565 6420 7b0a 2020   match seed {.  
+00024b00: 2020 2020 2020 536f 6d65 2873 6565 6429        Some(seed)
+00024b10: 203d 3e20 5063 6736 343a 3a73 6565 645f   => Pcg64::seed_
+00024b20: 6672 6f6d 5f75 3634 2873 6565 6429 2c0a  from_u64(seed),.
+00024b30: 2020 2020 2020 2020 4e6f 6e65 203d 3e20          None => 
+00024b40: 5063 6736 343a 3a66 726f 6d5f 656e 7472  Pcg64::from_entr
+00024b50: 6f70 7928 292c 0a20 2020 207d 3b0a 0a20  opy(),.    };.. 
+00024b60: 2020 2050 6f73 3244 4d61 7070 696e 6720     Pos2DMapping 
+00024b70: 7b0a 2020 2020 2020 2020 706f 735f 6d61  {.        pos_ma
+00024b80: 703a 2067 7261 7068 0a20 2020 2020 2020  p: graph.       
+00024b90: 2020 2020 202e 6e6f 6465 5f69 6e64 6963       .node_indic
+00024ba0: 6573 2829 0a20 2020 2020 2020 2020 2020  es().           
+00024bb0: 202e 6d61 7028 7c6e 7c20 7b0a 2020 2020   .map(|n| {.    
+00024bc0: 2020 2020 2020 2020 2020 2020 6c65 7420              let 
+00024bd0: 7261 6e64 6f6d 5f74 7570 6c65 3a20 5b66  random_tuple: [f
+00024be0: 3634 3b20 325d 203d 2072 6e67 2e67 656e  64; 2] = rng.gen
+00024bf0: 2829 3b0a 2020 2020 2020 2020 2020 2020  ();.            
+00024c00: 2020 2020 6d61 7463 6820 6365 6e74 6572      match center
+00024c10: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00024c20: 2020 2020 2020 2053 6f6d 6528 6365 6e74         Some(cent
+00024c30: 6572 2920 3d3e 2028 0a20 2020 2020 2020  er) => (.       
+00024c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c50: 206e 2e69 6e64 6578 2829 2c0a 2020 2020   n.index(),.    
+00024c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c70: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00024c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c90: 2020 7261 6e64 6f6d 5f74 7570 6c65 5b30    random_tuple[0
+00024ca0: 5d20 2b20 6365 6e74 6572 5b30 5d2c 0a20  ] + center[0],. 
+00024cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024cc0: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00024cd0: 6d5f 7475 706c 655b 315d 202b 2063 656e  m_tuple[1] + cen
+00024ce0: 7465 725b 315d 2c0a 2020 2020 2020 2020  ter[1],.        
+00024cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024d00: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00024d10: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00024d20: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+00024d30: 6e65 203d 3e20 286e 2e69 6e64 6578 2829  ne => (n.index()
+00024d40: 2c20 7261 6e64 6f6d 5f74 7570 6c65 292c  , random_tuple),
+00024d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024d60: 207d 0a20 2020 2020 2020 2020 2020 207d   }.            }
+00024d70: 290a 2020 2020 2020 2020 2020 2020 2e63  ).            .c
+00024d80: 6f6c 6c65 6374 2829 2c0a 2020 2020 7d0a  ollect(),.    }.
+00024d90: 7d0a 0a2f 2f2f 2047 656e 6572 6174 6520  }../// Generate 
+00024da0: 6120 7261 6e64 6f6d 206c 6179 6f75 740a  a random layout.
+00024db0: 2f2f 2f0a 2f2f 2f20 3a70 6172 616d 2050  ///./// :param P
+00024dc0: 7947 7261 7068 2067 7261 7068 3a20 5468  yGraph graph: Th
+00024dd0: 6520 6772 6170 6820 746f 2067 656e 6572  e graph to gener
+00024de0: 6174 6520 7468 6520 6c61 796f 7574 2066  ate the layout f
+00024df0: 6f72 0a2f 2f2f 203a 7061 7261 6d20 7475  or./// :param tu
+00024e00: 706c 6520 6365 6e74 6572 3a20 416e 206f  ple center: An o
+00024e10: 7074 696f 6e61 6c20 6365 6e74 6572 2070  ptional center p
+00024e20: 6f73 6974 696f 6e2e 2054 6869 7320 6973  osition. This is
+00024e30: 2061 2032 2074 7570 6c65 206f 6620 7477   a 2 tuple of tw
+00024e40: 6f0a 2f2f 2f20 2020 2020 6060 666c 6f61  o.///     ``floa
+00024e50: 7460 6020 7661 6c75 6573 2066 6f72 2074  t`` values for t
+00024e60: 6865 2063 656e 7465 7220 706f 7369 7469  he center positi
+00024e70: 6f6e 0a2f 2f2f 203a 7061 7261 6d20 696e  on./// :param in
+00024e80: 7420 7365 6564 3a20 416e 206f 7074 696f  t seed: An optio
+00024e90: 6e61 6c20 7365 6564 2074 6f20 7365 7420  nal seed to set 
+00024ea0: 666f 7220 7468 6520 7261 6e64 6f6d 206e  for the random n
+00024eb0: 756d 6265 7220 6765 6e65 7261 746f 722e  umber generator.
+00024ec0: 0a2f 2f2f 0a2f 2f2f 203a 7265 7475 726e  .///./// :return
+00024ed0: 733a 2054 6865 2072 616e 646f 6d20 6c61  s: The random la
+00024ee0: 796f 7574 206f 6620 7468 6520 6772 6170  yout of the grap
+00024ef0: 682e 0a2f 2f2f 203a 7274 7970 653a 2050  h../// :rtype: P
+00024f00: 6f73 3244 4d61 7070 696e 670a 235b 7079  os2DMapping.#[py
+00024f10: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+00024f20: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+00024f30: 7261 7068 2c20 2f20 6365 6e74 6572 3d4e  raph, / center=N
+00024f40: 6f6e 652c 2073 6565 643d 4e6f 6e65 2922  one, seed=None)"
+00024f50: 5d0a 7075 6220 666e 2067 7261 7068 5f72  ].pub fn graph_r
+00024f60: 616e 646f 6d5f 6c61 796f 7574 280a 2020  andom_layout(.  
+00024f70: 2020 6772 6170 683a 2026 6772 6170 683a    graph: &graph:
+00024f80: 3a50 7947 7261 7068 2c0a 2020 2020 6365  :PyGraph,.    ce
+00024f90: 6e74 6572 3a20 4f70 7469 6f6e 3c5b 6636  nter: Option<[f6
+00024fa0: 343b 2032 5d3e 2c0a 2020 2020 7365 6564  4; 2]>,.    seed
+00024fb0: 3a20 4f70 7469 6f6e 3c75 3634 3e2c 0a29  : Option<u64>,.)
+00024fc0: 202d 3e20 506f 7332 444d 6170 7069 6e67   -> Pos2DMapping
+00024fd0: 207b 0a20 2020 205f 7261 6e64 6f6d 5f6c   {.    _random_l
+00024fe0: 6179 6f75 7428 2667 7261 7068 2e67 7261  ayout(&graph.gra
+00024ff0: 7068 2c20 6365 6e74 6572 2c20 7365 6564  ph, center, seed
+00025000: 290a 7d0a 0a2f 2f2f 2047 656e 6572 6174  ).}../// Generat
+00025010: 6520 6120 7261 6e64 6f6d 206c 6179 6f75  e a random layou
+00025020: 740a 2f2f 2f0a 2f2f 2f20 3a70 6172 616d  t.///./// :param
+00025030: 2050 7944 6947 7261 7068 2067 7261 7068   PyDiGraph graph
+00025040: 3a20 5468 6520 6772 6170 6820 746f 2067  : The graph to g
+00025050: 656e 6572 6174 6520 7468 6520 6c61 796f  enerate the layo
+00025060: 7574 2066 6f72 0a2f 2f2f 203a 7061 7261  ut for./// :para
+00025070: 6d20 7475 706c 6520 6365 6e74 6572 3a20  m tuple center: 
+00025080: 416e 206f 7074 696f 6e61 6c20 6365 6e74  An optional cent
+00025090: 6572 2070 6f73 6974 696f 6e2e 2054 6869  er position. Thi
+000250a0: 7320 6973 2061 2032 2074 7570 6c65 206f  s is a 2 tuple o
+000250b0: 6620 7477 6f0a 2f2f 2f20 2020 2020 6060  f two.///     ``
+000250c0: 666c 6f61 7460 6020 7661 6c75 6573 2066  float`` values f
+000250d0: 6f72 2074 6865 2063 656e 7465 7220 706f  or the center po
+000250e0: 7369 7469 6f6e 0a2f 2f2f 203a 7061 7261  sition./// :para
+000250f0: 6d20 696e 7420 7365 6564 3a20 416e 206f  m int seed: An o
+00025100: 7074 696f 6e61 6c20 7365 6564 2074 6f20  ptional seed to 
+00025110: 7365 7420 666f 7220 7468 6520 7261 6e64  set for the rand
+00025120: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+00025130: 746f 722e 0a2f 2f2f 0a2f 2f2f 203a 7265  tor..///./// :re
+00025140: 7475 726e 733a 2054 6865 2072 616e 646f  turns: The rando
+00025150: 6d20 6c61 796f 7574 206f 6620 7468 6520  m layout of the 
+00025160: 6772 6170 682e 0a2f 2f2f 203a 7274 7970  graph../// :rtyp
+00025170: 653a 2050 6f73 3244 4d61 7070 696e 670a  e: Pos2DMapping.
+00025180: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
+00025190: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+000251a0: 2022 2867 7261 7068 2c20 2f20 6365 6e74   "(graph, / cent
+000251b0: 6572 3d4e 6f6e 652c 2073 6565 643d 4e6f  er=None, seed=No
+000251c0: 6e65 2922 5d0a 7075 6220 666e 2064 6967  ne)"].pub fn dig
+000251d0: 7261 7068 5f72 616e 646f 6d5f 6c61 796f  raph_random_layo
+000251e0: 7574 280a 2020 2020 6772 6170 683a 2026  ut(.    graph: &
+000251f0: 6469 6772 6170 683a 3a50 7944 6947 7261  digraph::PyDiGra
+00025200: 7068 2c0a 2020 2020 6365 6e74 6572 3a20  ph,.    center: 
+00025210: 4f70 7469 6f6e 3c5b 6636 343b 2032 5d3e  Option<[f64; 2]>
+00025220: 2c0a 2020 2020 7365 6564 3a20 4f70 7469  ,.    seed: Opti
+00025230: 6f6e 3c75 3634 3e2c 0a29 202d 3e20 506f  on<u64>,.) -> Po
+00025240: 7332 444d 6170 7069 6e67 207b 0a20 2020  s2DMapping {.   
+00025250: 205f 7261 6e64 6f6d 5f6c 6179 6f75 7428   _random_layout(
+00025260: 2667 7261 7068 2e67 7261 7068 2c20 6365  &graph.graph, ce
+00025270: 6e74 6572 2c20 7365 6564 290a 7d0a 0a2f  nter, seed).}../
+00025280: 2f2f 2047 656e 6572 6174 6520 6120 6269  // Generate a bi
+00025290: 7061 7274 6974 6520 6c61 796f 7574 206f  partite layout o
+000252a0: 6620 7468 6520 6772 6170 680a 2f2f 2f0a  f the graph.///.
+000252b0: 2f2f 2f20 3a70 6172 616d 2050 7947 7261  /// :param PyGra
+000252c0: 7068 2067 7261 7068 3a20 5468 6520 6772  ph graph: The gr
+000252d0: 6170 6820 746f 2067 656e 6572 6174 6520  aph to generate 
+000252e0: 7468 6520 6c61 796f 7574 2066 6f72 0a2f  the layout for./
+000252f0: 2f2f 203a 7061 7261 6d20 7365 7420 6669  // :param set fi
+00025300: 7273 745f 6e6f 6465 733a 2054 6865 2073  rst_nodes: The s
+00025310: 6574 206f 6620 6e6f 6465 2069 6e64 6578  et of node index
+00025320: 6573 206f 6e20 7468 6520 6c65 6674 2028  es on the left (
+00025330: 6f72 2074 6f70 2069 660a 2f2f 2f20 2020  or top if.///   
+00025340: 2020 686f 7269 746f 6e74 616c 2069 7320    horitontal is 
+00025350: 7472 7565 290a 2f2f 2f20 3a70 6172 616d  true)./// :param
+00025360: 2062 6f6f 6c20 686f 7269 7a6f 6e74 616c   bool horizontal
+00025370: 3a20 416e 206f 7074 696f 6e61 6c20 626f  : An optional bo
+00025380: 6f6c 2073 7065 6369 6679 696e 6720 7468  ol specifying th
+00025390: 6520 6f72 6965 6e74 6174 696f 6e20 6f66  e orientation of
+000253a0: 2074 6865 0a2f 2f2f 2020 2020 206c 6179   the.///     lay
+000253b0: 6f75 740a 2f2f 2f20 3a70 6172 616d 2066  out./// :param f
+000253c0: 6c6f 6174 2073 6361 6c65 3a20 416e 206f  loat scale: An o
+000253d0: 7074 696f 6e61 6c20 7363 616c 696e 6720  ptional scaling 
+000253e0: 6661 6374 6f72 2074 6f20 7363 616c 6520  factor to scale 
+000253f0: 706f 7369 7469 6f6e 730a 2f2f 2f20 3a70  positions./// :p
+00025400: 6172 616d 2074 7570 6c65 2063 656e 7465  aram tuple cente
+00025410: 723a 2041 6e20 6f70 7469 6f6e 616c 2063  r: An optional c
+00025420: 656e 7465 7220 706f 7369 7469 6f6e 2e20  enter position. 
+00025430: 5468 6973 2069 7320 6120 3220 7475 706c  This is a 2 tupl
+00025440: 6520 6f66 2074 776f 0a2f 2f2f 2020 2020  e of two.///    
+00025450: 2060 6066 6c6f 6174 6060 2076 616c 7565   ``float`` value
+00025460: 7320 666f 7220 7468 6520 6365 6e74 6572  s for the center
+00025470: 2070 6f73 6974 696f 6e0a 2f2f 2f20 3a70   position./// :p
+00025480: 6172 616d 2066 6c6f 6174 2061 7370 6563  aram float aspec
+00025490: 745f 7261 7469 6f3a 2041 6e20 6f70 7469  t_ratio: An opti
+000254a0: 6f6e 616c 206e 756d 6265 7220 666f 7220  onal number for 
+000254b0: 7468 6520 7261 7469 6f20 6f66 2074 6865  the ratio of the
+000254c0: 2077 6964 7468 2074 6f0a 2f2f 2f20 2020   width to.///   
+000254d0: 2020 7468 6520 6865 6967 6874 206f 6620    the height of 
+000254e0: 7468 6520 6c61 796f 7574 2e0a 2f2f 2f0a  the layout..///.
+000254f0: 2f2f 2f20 3a72 6574 7572 6e73 3a20 5468  /// :returns: Th
+00025500: 6520 6269 7061 7274 6974 6520 6c61 796f  e bipartite layo
+00025510: 7574 206f 6620 7468 6520 6772 6170 682e  ut of the graph.
+00025520: 0a2f 2f2f 203a 7274 7970 653a 2050 6f73  ./// :rtype: Pos
+00025530: 3244 4d61 7070 696e 670a 235b 7079 6675  2DMapping.#[pyfu
+00025540: 6e63 7469 6f6e 5d0a 235b 7465 7874 5f73  nction].#[text_s
+00025550: 6967 6e61 7475 7265 203d 2022 2867 7261  ignature = "(gra
+00025560: 7068 2c20 6669 7273 745f 6e6f 6465 732c  ph, first_nodes,
+00025570: 202f 2c20 686f 7269 746f 6e74 616c 3d46   /, horitontal=F
+00025580: 616c 7365 2c20 7363 616c 653d 312c 200a  alse, scale=1, .
+00025590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255a0: 2020 2020 2063 656e 7465 723d 4e6f 6e65       center=None
+000255b0: 2c20 6173 7065 6374 5f72 6174 696f 3d31  , aspect_ratio=1
+000255c0: 2e33 3333 3333 3333 3333 3333 3333 3329  .33333333333333)
+000255d0: 225d 0a70 7562 2066 6e20 6772 6170 685f  "].pub fn graph_
+000255e0: 6269 7061 7274 6974 655f 6c61 796f 7574  bipartite_layout
+000255f0: 280a 2020 2020 6772 6170 683a 2026 6772  (.    graph: &gr
+00025600: 6170 683a 3a50 7947 7261 7068 2c0a 2020  aph::PyGraph,.  
+00025610: 2020 6669 7273 745f 6e6f 6465 733a 2048    first_nodes: H
+00025620: 6173 6853 6574 3c75 7369 7a65 3e2c 0a20  ashSet<usize>,. 
+00025630: 2020 2068 6f72 697a 6f6e 7461 6c3a 204f     horizontal: O
+00025640: 7074 696f 6e3c 626f 6f6c 3e2c 0a20 2020  ption<bool>,.   
+00025650: 2073 6361 6c65 3a20 4f70 7469 6f6e 3c66   scale: Option<f
+00025660: 3634 3e2c 0a20 2020 2063 656e 7465 723a  64>,.    center:
+00025670: 204f 7074 696f 6e3c 6c61 796f 7574 3a3a   Option<layout::
+00025680: 506f 696e 743e 2c0a 2020 2020 6173 7065  Point>,.    aspe
+00025690: 6374 5f72 6174 696f 3a20 4f70 7469 6f6e  ct_ratio: Option
+000256a0: 3c66 3634 3e2c 0a29 202d 3e20 506f 7332  <f64>,.) -> Pos2
+000256b0: 444d 6170 7069 6e67 207b 0a20 2020 206c  DMapping {.    l
+000256c0: 6179 6f75 743a 3a62 6970 6172 7469 7465  ayout::bipartite
+000256d0: 5f6c 6179 6f75 7428 0a20 2020 2020 2020  _layout(.       
+000256e0: 2026 6772 6170 682e 6772 6170 682c 0a20   &graph.graph,. 
+000256f0: 2020 2020 2020 2066 6972 7374 5f6e 6f64         first_nod
+00025700: 6573 2c0a 2020 2020 2020 2020 686f 7269  es,.        hori
+00025710: 7a6f 6e74 616c 2c0a 2020 2020 2020 2020  zontal,.        
+00025720: 7363 616c 652c 0a20 2020 2020 2020 2063  scale,.        c
+00025730: 656e 7465 722c 0a20 2020 2020 2020 2061  enter,.        a
+00025740: 7370 6563 745f 7261 7469 6f2c 0a20 2020  spect_ratio,.   
+00025750: 2029 0a7d 0a0a 2f2f 2f20 4765 6e65 7261   ).}../// Genera
+00025760: 7465 2061 2062 6970 6172 7469 7465 206c  te a bipartite l
+00025770: 6179 6f75 7420 6f66 2074 6865 2067 7261  ayout of the gra
+00025780: 7068 0a2f 2f2f 0a2f 2f2f 203a 7061 7261  ph.///./// :para
+00025790: 6d20 5079 4469 4772 6170 6820 6772 6170  m PyDiGraph grap
+000257a0: 683a 2054 6865 2067 7261 7068 2074 6f20  h: The graph to 
+000257b0: 6765 6e65 7261 7465 2074 6865 206c 6179  generate the lay
+000257c0: 6f75 7420 666f 720a 2f2f 2f20 3a70 6172  out for./// :par
+000257d0: 616d 2073 6574 2066 6972 7374 5f6e 6f64  am set first_nod
+000257e0: 6573 3a20 5468 6520 7365 7420 6f66 206e  es: The set of n
+000257f0: 6f64 6520 696e 6465 7865 7320 6f6e 2074  ode indexes on t
+00025800: 6865 206c 6566 7420 286f 7220 746f 7020  he left (or top 
+00025810: 6966 0a2f 2f2f 2020 2020 2068 6f72 697a  if.///     horiz
+00025820: 6f6e 7461 6c20 6973 2074 7275 6529 0a2f  ontal is true)./
+00025830: 2f2f 203a 7061 7261 6d20 626f 6f6c 2068  // :param bool h
+00025840: 6f72 697a 6f6e 7461 6c3a 2041 6e20 6f70  orizontal: An op
+00025850: 7469 6f6e 616c 2062 6f6f 6c20 7370 6563  tional bool spec
+00025860: 6966 7969 6e67 2074 6865 206f 7269 656e  ifying the orien
+00025870: 7461 7469 6f6e 206f 6620 7468 650a 2f2f  tation of the.//
+00025880: 2f20 2020 2020 6c61 796f 7574 0a2f 2f2f  /     layout.///
+00025890: 203a 7061 7261 6d20 666c 6f61 7420 7363   :param float sc
+000258a0: 616c 653a 2041 6e20 6f70 7469 6f6e 616c  ale: An optional
+000258b0: 2073 6361 6c69 6e67 2066 6163 746f 7220   scaling factor 
+000258c0: 746f 2073 6361 6c65 2070 6f73 6974 696f  to scale positio
+000258d0: 6e73 0a2f 2f2f 203a 7061 7261 6d20 7475  ns./// :param tu
+000258e0: 706c 6520 6365 6e74 6572 3a20 416e 206f  ple center: An o
+000258f0: 7074 696f 6e61 6c20 6365 6e74 6572 2070  ptional center p
+00025900: 6f73 6974 696f 6e2e 2054 6869 7320 6973  osition. This is
+00025910: 2061 2032 2074 7570 6c65 206f 6620 7477   a 2 tuple of tw
+00025920: 6f0a 2f2f 2f20 2020 2020 6060 666c 6f61  o.///     ``floa
+00025930: 7460 6020 7661 6c75 6573 2066 6f72 2074  t`` values for t
+00025940: 6865 2063 656e 7465 7220 706f 7369 7469  he center positi
+00025950: 6f6e 0a2f 2f2f 203a 7061 7261 6d20 666c  on./// :param fl
+00025960: 6f61 7420 6173 7065 6374 5f72 6174 696f  oat aspect_ratio
+00025970: 3a20 416e 206f 7074 696f 6e61 6c20 6e75  : An optional nu
+00025980: 6d62 6572 2066 6f72 2074 6865 2072 6174  mber for the rat
+00025990: 696f 206f 6620 7468 6520 7769 6474 6820  io of the width 
+000259a0: 746f 0a2f 2f2f 2020 2020 2074 6865 2068  to.///     the h
+000259b0: 6569 6768 7420 6f66 2074 6865 206c 6179  eight of the lay
+000259c0: 6f75 742e 0a2f 2f2f 0a2f 2f2f 203a 7265  out..///./// :re
+000259d0: 7475 726e 733a 2054 6865 2062 6970 6172  turns: The bipar
+000259e0: 7469 7465 206c 6179 6f75 7420 6f66 2074  tite layout of t
+000259f0: 6865 2067 7261 7068 2e0a 2f2f 2f20 3a72  he graph../// :r
+00025a00: 7479 7065 3a20 506f 7332 444d 6170 7069  type: Pos2DMappi
+00025a10: 6e67 0a23 5b70 7966 756e 6374 696f 6e5d  ng.#[pyfunction]
+00025a20: 0a23 5b74 6578 745f 7369 676e 6174 7572  .#[text_signatur
+00025a30: 6520 3d20 2228 6772 6170 682c 2066 6972  e = "(graph, fir
+00025a40: 7374 5f6e 6f64 6573 2c20 2f2c 2068 6f72  st_nodes, /, hor
+00025a50: 6974 6f6e 7461 6c3d 4661 6c73 652c 2073  itontal=False, s
+00025a60: 6361 6c65 3d31 2c20 0a20 2020 2020 2020  cale=1, .       
+00025a70: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00025a80: 6e74 6572 3d4e 6f6e 652c 2061 7370 6563  nter=None, aspec
+00025a90: 745f 7261 7469 6f3d 312e 3333 3333 3333  t_ratio=1.333333
+00025aa0: 3333 3333 3333 3333 2922 5d0a 7075 6220  33333333)"].pub 
+00025ab0: 666e 2064 6967 7261 7068 5f62 6970 6172  fn digraph_bipar
+00025ac0: 7469 7465 5f6c 6179 6f75 7428 0a20 2020  tite_layout(.   
+00025ad0: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
+00025ae0: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
+00025af0: 2066 6972 7374 5f6e 6f64 6573 3a20 4861   first_nodes: Ha
+00025b00: 7368 5365 743c 7573 697a 653e 2c0a 2020  shSet<usize>,.  
+00025b10: 2020 686f 7269 7a6f 6e74 616c 3a20 4f70    horizontal: Op
+00025b20: 7469 6f6e 3c62 6f6f 6c3e 2c0a 2020 2020  tion<bool>,.    
+00025b30: 7363 616c 653a 204f 7074 696f 6e3c 6636  scale: Option<f6
+00025b40: 343e 2c0a 2020 2020 6365 6e74 6572 3a20  4>,.    center: 
+00025b50: 4f70 7469 6f6e 3c6c 6179 6f75 743a 3a50  Option<layout::P
+00025b60: 6f69 6e74 3e2c 0a20 2020 2061 7370 6563  oint>,.    aspec
+00025b70: 745f 7261 7469 6f3a 204f 7074 696f 6e3c  t_ratio: Option<
+00025b80: 6636 343e 2c0a 2920 2d3e 2050 6f73 3244  f64>,.) -> Pos2D
+00025b90: 4d61 7070 696e 6720 7b0a 2020 2020 6c61  Mapping {.    la
+00025ba0: 796f 7574 3a3a 6269 7061 7274 6974 655f  yout::bipartite_
+00025bb0: 6c61 796f 7574 280a 2020 2020 2020 2020  layout(.        
+00025bc0: 2667 7261 7068 2e67 7261 7068 2c0a 2020  &graph.graph,.  
+00025bd0: 2020 2020 2020 6669 7273 745f 6e6f 6465        first_node
+00025be0: 732c 0a20 2020 2020 2020 2068 6f72 697a  s,.        horiz
+00025bf0: 6f6e 7461 6c2c 0a20 2020 2020 2020 2073  ontal,.        s
+00025c00: 6361 6c65 2c0a 2020 2020 2020 2020 6365  cale,.        ce
+00025c10: 6e74 6572 2c0a 2020 2020 2020 2020 6173  nter,.        as
+00025c20: 7065 6374 5f72 6174 696f 2c0a 2020 2020  pect_ratio,.    
+00025c30: 290a 7d0a 0a2f 2f2f 2047 656e 6572 6174  ).}../// Generat
+00025c40: 6520 6120 6369 7263 756c 6172 206c 6179  e a circular lay
+00025c50: 6f75 7420 6f66 2074 6865 2067 7261 7068  out of the graph
+00025c60: 0a2f 2f2f 0a2f 2f2f 203a 7061 7261 6d20  .///./// :param 
+00025c70: 5079 4772 6170 6820 6772 6170 683a 2054  PyGraph graph: T
+00025c80: 6865 2067 7261 7068 2074 6f20 6765 6e65  he graph to gene
+00025c90: 7261 7465 2074 6865 206c 6179 6f75 7420  rate the layout 
+00025ca0: 666f 720a 2f2f 2f20 3a70 6172 616d 2066  for./// :param f
+00025cb0: 6c6f 6174 2073 6361 6c65 3a20 416e 206f  loat scale: An o
+00025cc0: 7074 696f 6e61 6c20 7363 616c 696e 6720  ptional scaling 
+00025cd0: 6661 6374 6f72 2074 6f20 7363 616c 6520  factor to scale 
+00025ce0: 706f 7369 7469 6f6e 730a 2f2f 2f20 3a70  positions./// :p
+00025cf0: 6172 616d 2074 7570 6c65 2063 656e 7465  aram tuple cente
+00025d00: 723a 2041 6e20 6f70 7469 6f6e 616c 2063  r: An optional c
+00025d10: 656e 7465 7220 706f 7369 7469 6f6e 2e20  enter position. 
+00025d20: 5468 6973 2069 7320 6120 3220 7475 706c  This is a 2 tupl
+00025d30: 6520 6f66 2074 776f 0a2f 2f2f 2020 2020  e of two.///    
+00025d40: 2060 6066 6c6f 6174 6060 2076 616c 7565   ``float`` value
+00025d50: 7320 666f 7220 7468 6520 6365 6e74 6572  s for the center
+00025d60: 2070 6f73 6974 696f 6e0a 2f2f 2f0a 2f2f   position.///.//
+00025d70: 2f20 3a72 6574 7572 6e73 3a20 5468 6520  / :returns: The 
+00025d80: 6369 7263 756c 6172 206c 6179 6f75 7420  circular layout 
+00025d90: 6f66 2074 6865 2067 7261 7068 2e0a 2f2f  of the graph..//
+00025da0: 2f20 3a72 7479 7065 3a20 506f 7332 444d  / :rtype: Pos2DM
+00025db0: 6170 7069 6e67 0a23 5b70 7966 756e 6374  apping.#[pyfunct
+00025dc0: 696f 6e5d 0a23 5b74 6578 745f 7369 676e  ion].#[text_sign
+00025dd0: 6174 7572 6520 3d20 2228 6772 6170 682c  ature = "(graph,
+00025de0: 202f 2c20 7363 616c 653d 312c 2063 656e   /, scale=1, cen
+00025df0: 7465 723d 4e6f 6e65 2922 5d0a 7075 6220  ter=None)"].pub 
+00025e00: 666e 2067 7261 7068 5f63 6972 6375 6c61  fn graph_circula
+00025e10: 725f 6c61 796f 7574 280a 2020 2020 6772  r_layout(.    gr
+00025e20: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
+00025e30: 7261 7068 2c0a 2020 2020 7363 616c 653a  raph,.    scale:
+00025e40: 204f 7074 696f 6e3c 6636 343e 2c0a 2020   Option<f64>,.  
+00025e50: 2020 6365 6e74 6572 3a20 4f70 7469 6f6e    center: Option
+00025e60: 3c6c 6179 6f75 743a 3a50 6f69 6e74 3e2c  <layout::Point>,
+00025e70: 0a29 202d 3e20 506f 7332 444d 6170 7069  .) -> Pos2DMappi
+00025e80: 6e67 207b 0a20 2020 206c 6179 6f75 743a  ng {.    layout:
+00025e90: 3a63 6972 6375 6c61 725f 6c61 796f 7574  :circular_layout
+00025ea0: 2826 6772 6170 682e 6772 6170 682c 2073  (&graph.graph, s
+00025eb0: 6361 6c65 2c20 6365 6e74 6572 290a 7d0a  cale, center).}.
+00025ec0: 0a2f 2f2f 2047 656e 6572 6174 6520 6120  ./// Generate a 
+00025ed0: 6369 7263 756c 6172 206c 6179 6f75 7420  circular layout 
+00025ee0: 6f66 2074 6865 2067 7261 7068 0a2f 2f2f  of the graph.///
+00025ef0: 0a2f 2f2f 203a 7061 7261 6d20 5079 4469  ./// :param PyDi
+00025f00: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
+00025f10: 2067 7261 7068 2074 6f20 6765 6e65 7261   graph to genera
+00025f20: 7465 2074 6865 206c 6179 6f75 7420 666f  te the layout fo
+00025f30: 720a 2f2f 2f20 3a70 6172 616d 2066 6c6f  r./// :param flo
+00025f40: 6174 2073 6361 6c65 3a20 416e 206f 7074  at scale: An opt
+00025f50: 696f 6e61 6c20 7363 616c 696e 6720 6661  ional scaling fa
+00025f60: 6374 6f72 2074 6f20 7363 616c 6520 706f  ctor to scale po
+00025f70: 7369 7469 6f6e 730a 2f2f 2f20 3a70 6172  sitions./// :par
+00025f80: 616d 2074 7570 6c65 2063 656e 7465 723a  am tuple center:
+00025f90: 2041 6e20 6f70 7469 6f6e 616c 2063 656e   An optional cen
+00025fa0: 7465 7220 706f 7369 7469 6f6e 2e20 5468  ter position. Th
+00025fb0: 6973 2069 7320 6120 3220 7475 706c 6520  is is a 2 tuple 
+00025fc0: 6f66 2074 776f 0a2f 2f2f 2020 2020 2060  of two.///     `
+00025fd0: 6066 6c6f 6174 6060 2076 616c 7565 7320  `float`` values 
+00025fe0: 666f 7220 7468 6520 6365 6e74 6572 2070  for the center p
+00025ff0: 6f73 6974 696f 6e0a 2f2f 2f0a 2f2f 2f20  osition.///./// 
+00026000: 3a72 6574 7572 6e73 3a20 5468 6520 6369  :returns: The ci
+00026010: 7263 756c 6172 206c 6179 6f75 7420 6f66  rcular layout of
+00026020: 2074 6865 2067 7261 7068 2e0a 2f2f 2f20   the graph../// 
+00026030: 3a72 7479 7065 3a20 506f 7332 444d 6170  :rtype: Pos2DMap
+00026040: 7069 6e67 0a23 5b70 7966 756e 6374 696f  ping.#[pyfunctio
+00026050: 6e5d 0a23 5b74 6578 745f 7369 676e 6174  n].#[text_signat
+00026060: 7572 6520 3d20 2228 6772 6170 682c 202f  ure = "(graph, /
+00026070: 2c20 7363 616c 653d 312c 2063 656e 7465  , scale=1, cente
+00026080: 723d 4e6f 6e65 2922 5d0a 7075 6220 666e  r=None)"].pub fn
+00026090: 2064 6967 7261 7068 5f63 6972 6375 6c61   digraph_circula
+000260a0: 725f 6c61 796f 7574 280a 2020 2020 6772  r_layout(.    gr
+000260b0: 6170 683a 2026 6469 6772 6170 683a 3a50  aph: &digraph::P
+000260c0: 7944 6947 7261 7068 2c0a 2020 2020 7363  yDiGraph,.    sc
+000260d0: 616c 653a 204f 7074 696f 6e3c 6636 343e  ale: Option<f64>
+000260e0: 2c0a 2020 2020 6365 6e74 6572 3a20 4f70  ,.    center: Op
+000260f0: 7469 6f6e 3c6c 6179 6f75 743a 3a50 6f69  tion<layout::Poi
+00026100: 6e74 3e2c 0a29 202d 3e20 506f 7332 444d  nt>,.) -> Pos2DM
+00026110: 6170 7069 6e67 207b 0a20 2020 206c 6179  apping {.    lay
+00026120: 6f75 743a 3a63 6972 6375 6c61 725f 6c61  out::circular_la
+00026130: 796f 7574 2826 6772 6170 682e 6772 6170  yout(&graph.grap
+00026140: 682c 2073 6361 6c65 2c20 6365 6e74 6572  h, scale, center
+00026150: 290a 7d0a 0a2f 2f2f 2047 656e 6572 6174  ).}../// Generat
+00026160: 6520 6120 7368 656c 6c20 6c61 796f 7574  e a shell layout
+00026170: 206f 6620 7468 6520 6772 6170 680a 2f2f   of the graph.//
+00026180: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7947  /./// :param PyG
+00026190: 7261 7068 2067 7261 7068 3a20 5468 6520  raph graph: The 
+000261a0: 6772 6170 6820 746f 2067 656e 6572 6174  graph to generat
+000261b0: 6520 7468 6520 6c61 796f 7574 2066 6f72  e the layout for
+000261c0: 0a2f 2f2f 203a 7061 7261 6d20 6c69 7374  ./// :param list
+000261d0: 206e 6c69 7374 3a20 5468 6520 6c69 7374   nlist: The list
+000261e0: 206f 6620 6c69 7374 7320 6f66 2069 6e64   of lists of ind
+000261f0: 6578 6573 2077 6869 6368 2072 6570 7265  exes which repre
+00026200: 7365 6e74 7320 6561 6368 2073 6865 6c6c  sents each shell
+00026210: 0a2f 2f2f 203a 7061 7261 6d20 666c 6f61  ./// :param floa
+00026220: 7420 726f 7461 7465 3a20 416e 676c 6520  t rotate: Angle 
+00026230: 2869 6e20 7261 6469 616e 7329 2062 7920  (in radians) by 
+00026240: 7768 6963 6820 746f 2072 6f74 6174 6520  which to rotate 
+00026250: 7468 6520 7374 6172 7469 6e67 0a2f 2f2f  the starting.///
+00026260: 2020 2020 2070 6f73 6974 696f 6e20 6f66       position of
+00026270: 2065 6163 6820 7368 656c 6c20 7265 6c61   each shell rela
+00026280: 7469 7665 2074 6f20 7468 6520 7374 6172  tive to the star
+00026290: 7469 6e67 2070 6f73 6974 696f 6e20 6f66  ting position of
+000262a0: 2074 6865 0a2f 2f2f 2020 2020 2070 7265   the.///     pre
+000262b0: 7669 6f75 7320 7368 656c 6c0a 2f2f 2f20  vious shell./// 
+000262c0: 3a70 6172 616d 2066 6c6f 6174 2073 6361  :param float sca
+000262d0: 6c65 3a20 416e 206f 7074 696f 6e61 6c20  le: An optional 
+000262e0: 7363 616c 696e 6720 6661 6374 6f72 2074  scaling factor t
+000262f0: 6f20 7363 616c 6520 706f 7369 7469 6f6e  o scale position
+00026300: 730a 2f2f 2f20 3a70 6172 616d 2074 7570  s./// :param tup
+00026310: 6c65 2063 656e 7465 723a 2041 6e20 6f70  le center: An op
+00026320: 7469 6f6e 616c 2063 656e 7465 7220 706f  tional center po
+00026330: 7369 7469 6f6e 2e20 5468 6973 2069 7320  sition. This is 
+00026340: 6120 3220 7475 706c 6520 6f66 2074 776f  a 2 tuple of two
+00026350: 0a2f 2f2f 2020 2020 2060 6066 6c6f 6174  .///     ``float
+00026360: 6060 2076 616c 7565 7320 666f 7220 7468  `` values for th
+00026370: 6520 6365 6e74 6572 2070 6f73 6974 696f  e center positio
+00026380: 6e0a 2f2f 2f0a 2f2f 2f20 3a72 6574 7572  n.///./// :retur
+00026390: 6e73 3a20 5468 6520 7368 656c 6c20 6c61  ns: The shell la
+000263a0: 796f 7574 206f 6620 7468 6520 6772 6170  yout of the grap
+000263b0: 682e 0a2f 2f2f 203a 7274 7970 653a 2050  h../// :rtype: P
+000263c0: 6f73 3244 4d61 7070 696e 670a 235b 7079  os2DMapping.#[py
+000263d0: 6675 6e63 7469 6f6e 5d0a 235b 7465 7874  function].#[text
+000263e0: 5f73 6967 6e61 7475 7265 203d 2022 2867  _signature = "(g
+000263f0: 7261 7068 2c20 2f2c 206e 6c69 7374 3d4e  raph, /, nlist=N
+00026400: 6f6e 652c 2072 6f74 6174 653d 4e6f 6e65  one, rotate=None
+00026410: 2c20 7363 616c 653d 312c 2063 656e 7465  , scale=1, cente
+00026420: 723d 4e6f 6e65 2922 5d0a 7075 6220 666e  r=None)"].pub fn
+00026430: 2067 7261 7068 5f73 6865 6c6c 5f6c 6179   graph_shell_lay
+00026440: 6f75 7428 0a20 2020 2067 7261 7068 3a20  out(.    graph: 
+00026450: 2667 7261 7068 3a3a 5079 4772 6170 682c  &graph::PyGraph,
+00026460: 0a20 2020 206e 6c69 7374 3a20 4f70 7469  .    nlist: Opti
+00026470: 6f6e 3c56 6563 3c56 6563 3c75 7369 7a65  on<Vec<Vec<usize
+00026480: 3e3e 3e2c 0a20 2020 2072 6f74 6174 653a  >>>,.    rotate:
+00026490: 204f 7074 696f 6e3c 6636 343e 2c0a 2020   Option<f64>,.  
+000264a0: 2020 7363 616c 653a 204f 7074 696f 6e3c    scale: Option<
+000264b0: 6636 343e 2c0a 2020 2020 6365 6e74 6572  f64>,.    center
+000264c0: 3a20 4f70 7469 6f6e 3c6c 6179 6f75 743a  : Option<layout:
+000264d0: 3a50 6f69 6e74 3e2c 0a29 202d 3e20 506f  :Point>,.) -> Po
+000264e0: 7332 444d 6170 7069 6e67 207b 0a20 2020  s2DMapping {.   
+000264f0: 206c 6179 6f75 743a 3a73 6865 6c6c 5f6c   layout::shell_l
+00026500: 6179 6f75 7428 2667 7261 7068 2e67 7261  ayout(&graph.gra
+00026510: 7068 2c20 6e6c 6973 742c 2072 6f74 6174  ph, nlist, rotat
+00026520: 652c 2073 6361 6c65 2c20 6365 6e74 6572  e, scale, center
+00026530: 290a 7d0a 0a2f 2f2f 2047 656e 6572 6174  ).}../// Generat
+00026540: 6520 6120 7368 656c 6c20 6c61 796f 7574  e a shell layout
+00026550: 206f 6620 7468 6520 6772 6170 680a 2f2f   of the graph.//
+00026560: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
+00026570: 6947 7261 7068 2067 7261 7068 3a20 5468  iGraph graph: Th
+00026580: 6520 6772 6170 6820 746f 2067 656e 6572  e graph to gener
+00026590: 6174 6520 7468 6520 6c61 796f 7574 2066  ate the layout f
+000265a0: 6f72 0a2f 2f2f 203a 7061 7261 6d20 6c69  or./// :param li
+000265b0: 7374 206e 6c69 7374 3a20 5468 6520 6c69  st nlist: The li
+000265c0: 7374 206f 6620 6c69 7374 7320 6f66 2069  st of lists of i
+000265d0: 6e64 6578 6573 2077 6869 6368 2072 6570  ndexes which rep
+000265e0: 7265 7365 6e74 7320 6561 6368 2073 6865  resents each she
+000265f0: 6c6c 0a2f 2f2f 203a 7061 7261 6d20 666c  ll./// :param fl
+00026600: 6f61 7420 726f 7461 7465 3a20 416e 676c  oat rotate: Angl
+00026610: 6520 6279 2077 6869 6368 2074 6f20 726f  e by which to ro
+00026620: 7461 7465 2074 6865 2073 7461 7274 696e  tate the startin
+00026630: 6720 706f 7369 7469 6f6e 206f 6620 6561  g position of ea
+00026640: 6368 2073 6865 6c6c 0a2f 2f2f 2020 2020  ch shell.///    
+00026650: 2072 656c 6174 6976 6520 746f 2074 6865   relative to the
+00026660: 2073 7461 7274 696e 6720 706f 7369 7469   starting positi
+00026670: 6f6e 206f 6620 7468 6520 7072 6576 696f  on of the previo
+00026680: 7573 2073 6865 6c6c 2028 696e 2072 6164  us shell (in rad
+00026690: 6961 6e73 290a 2f2f 2f20 3a70 6172 616d  ians)./// :param
+000266a0: 2066 6c6f 6174 2073 6361 6c65 3a20 416e   float scale: An
+000266b0: 206f 7074 696f 6e61 6c20 7363 616c 696e   optional scalin
+000266c0: 6720 6661 6374 6f72 2074 6f20 7363 616c  g factor to scal
+000266d0: 6520 706f 7369 7469 6f6e 730a 2f2f 2f20  e positions./// 
+000266e0: 3a70 6172 616d 2074 7570 6c65 2063 656e  :param tuple cen
+000266f0: 7465 723a 2041 6e20 6f70 7469 6f6e 616c  ter: An optional
+00026700: 2063 656e 7465 7220 706f 7369 7469 6f6e   center position
+00026710: 2e20 5468 6973 2069 7320 6120 3220 7475  . This is a 2 tu
+00026720: 706c 6520 6f66 2074 776f 0a2f 2f2f 2020  ple of two.///  
+00026730: 2020 2060 6066 6c6f 6174 6060 2076 616c     ``float`` val
+00026740: 7565 7320 666f 7220 7468 6520 6365 6e74  ues for the cent
+00026750: 6572 2070 6f73 6974 696f 6e0a 2f2f 2f0a  er position.///.
+00026760: 2f2f 2f20 3a72 6574 7572 6e73 3a20 5468  /// :returns: Th
+00026770: 6520 7368 656c 6c20 6c61 796f 7574 206f  e shell layout o
+00026780: 6620 7468 6520 6772 6170 682e 0a2f 2f2f  f the graph..///
+00026790: 203a 7274 7970 653a 2050 6f73 3244 4d61   :rtype: Pos2DMa
+000267a0: 7070 696e 670a 235b 7079 6675 6e63 7469  pping.#[pyfuncti
+000267b0: 6f6e 5d0a 235b 7465 7874 5f73 6967 6e61  on].#[text_signa
+000267c0: 7475 7265 203d 2022 2867 7261 7068 2c20  ture = "(graph, 
+000267d0: 2f2c 206e 6c69 7374 3d4e 6f6e 652c 2072  /, nlist=None, r
+000267e0: 6f74 6174 653d 4e6f 6e65 2c20 7363 616c  otate=None, scal
+000267f0: 653d 312c 2063 656e 7465 723d 4e6f 6e65  e=1, center=None
+00026800: 2922 5d0a 7075 6220 666e 2064 6967 7261  )"].pub fn digra
+00026810: 7068 5f73 6865 6c6c 5f6c 6179 6f75 7428  ph_shell_layout(
+00026820: 0a20 2020 2067 7261 7068 3a20 2664 6967  .    graph: &dig
+00026830: 7261 7068 3a3a 5079 4469 4772 6170 682c  raph::PyDiGraph,
+00026840: 0a20 2020 206e 6c69 7374 3a20 4f70 7469  .    nlist: Opti
+00026850: 6f6e 3c56 6563 3c56 6563 3c75 7369 7a65  on<Vec<Vec<usize
+00026860: 3e3e 3e2c 0a20 2020 2072 6f74 6174 653a  >>>,.    rotate:
+00026870: 204f 7074 696f 6e3c 6636 343e 2c0a 2020   Option<f64>,.  
+00026880: 2020 7363 616c 653a 204f 7074 696f 6e3c    scale: Option<
+00026890: 6636 343e 2c0a 2020 2020 6365 6e74 6572  f64>,.    center
+000268a0: 3a20 4f70 7469 6f6e 3c6c 6179 6f75 743a  : Option<layout:
+000268b0: 3a50 6f69 6e74 3e2c 0a29 202d 3e20 506f  :Point>,.) -> Po
+000268c0: 7332 444d 6170 7069 6e67 207b 0a20 2020  s2DMapping {.   
+000268d0: 206c 6179 6f75 743a 3a73 6865 6c6c 5f6c   layout::shell_l
+000268e0: 6179 6f75 7428 2667 7261 7068 2e67 7261  ayout(&graph.gra
+000268f0: 7068 2c20 6e6c 6973 742c 2072 6f74 6174  ph, nlist, rotat
+00026900: 652c 2073 6361 6c65 2c20 6365 6e74 6572  e, scale, center
+00026910: 290a 7d0a 0a2f 2f2f 2047 656e 6572 6174  ).}../// Generat
+00026920: 6520 6120 7370 6972 616c 206c 6179 6f75  e a spiral layou
+00026930: 7420 6f66 2074 6865 2067 7261 7068 0a2f  t of the graph./
+00026940: 2f2f 0a2f 2f2f 203a 7061 7261 6d20 5079  //./// :param Py
+00026950: 4772 6170 6820 6772 6170 683a 2054 6865  Graph graph: The
+00026960: 2067 7261 7068 2074 6f20 6765 6e65 7261   graph to genera
+00026970: 7465 2074 6865 206c 6179 6f75 7420 666f  te the layout fo
+00026980: 720a 2f2f 2f20 3a70 6172 616d 2066 6c6f  r./// :param flo
+00026990: 6174 2073 6361 6c65 3a20 416e 206f 7074  at scale: An opt
+000269a0: 696f 6e61 6c20 7363 616c 696e 6720 6661  ional scaling fa
+000269b0: 6374 6f72 2074 6f20 7363 616c 6520 706f  ctor to scale po
+000269c0: 7369 7469 6f6e 730a 2f2f 2f20 3a70 6172  sitions./// :par
+000269d0: 616d 2074 7570 6c65 2063 656e 7465 723a  am tuple center:
+000269e0: 2041 6e20 6f70 7469 6f6e 616c 2063 656e   An optional cen
+000269f0: 7465 7220 706f 7369 7469 6f6e 2e20 5468  ter position. Th
+00026a00: 6973 2069 7320 6120 3220 7475 706c 6520  is is a 2 tuple 
+00026a10: 6f66 2074 776f 0a2f 2f2f 2020 2020 2060  of two.///     `
+00026a20: 6066 6c6f 6174 6060 2076 616c 7565 7320  `float`` values 
+00026a30: 666f 7220 7468 6520 6365 6e74 6572 2070  for the center p
+00026a40: 6f73 6974 696f 6e0a 2f2f 2f20 3a70 6172  osition./// :par
+00026a50: 616d 2066 6c6f 6174 2072 6573 6f6c 7574  am float resolut
+00026a60: 696f 6e3a 2054 6865 2063 6f6d 7061 6374  ion: The compact
+00026a70: 6e65 7373 206f 6620 7468 6520 7370 6972  ness of the spir
+00026a80: 616c 206c 6179 6f75 7420 7265 7475 726e  al layout return
+00026a90: 6564 2e0a 2f2f 2f20 2020 2020 4c6f 7765  ed..///     Lowe
+00026aa0: 7220 7661 6c75 6573 2072 6573 756c 7420  r values result 
+00026ab0: 696e 206d 6f72 6520 636f 6d70 7265 7373  in more compress
+00026ac0: 6564 2073 7069 7261 6c20 6c61 796f 7574  ed spiral layout
+00026ad0: 732e 0a2f 2f2f 203a 7061 7261 6d20 626f  s../// :param bo
+00026ae0: 6f6c 2065 7175 6964 6973 7461 6e74 3a20  ol equidistant: 
+00026af0: 4966 2074 7275 652c 206e 6f64 6573 2077  If true, nodes w
+00026b00: 696c 6c20 6265 2070 6c6f 7474 6564 2065  ill be plotted e
+00026b10: 7175 6964 6973 7461 6e74 2066 726f 6d0a  quidistant from.
+00026b20: 2f2f 2f20 2020 2020 6561 6368 206f 7468  ///     each oth
+00026b30: 6572 2e0a 2f2f 2f0a 2f2f 2f20 3a72 6574  er..///./// :ret
+00026b40: 7572 6e73 3a20 5468 6520 7370 6972 616c  urns: The spiral
+00026b50: 206c 6179 6f75 7420 6f66 2074 6865 2067   layout of the g
+00026b60: 7261 7068 2e0a 2f2f 2f20 3a72 7479 7065  raph../// :rtype
+00026b70: 3a20 506f 7332 444d 6170 7069 6e67 0a23  : Pos2DMapping.#
+00026b80: 5b70 7966 756e 6374 696f 6e5d 0a23 5b74  [pyfunction].#[t
+00026b90: 6578 745f 7369 676e 6174 7572 6520 3d20  ext_signature = 
+00026ba0: 2228 6772 6170 682c 202f 2c20 7363 616c  "(graph, /, scal
+00026bb0: 653d 312c 2063 656e 7465 723d 4e6f 6e65  e=1, center=None
+00026bc0: 2c20 7265 736f 6c75 7469 6f6e 3d30 2e33  , resolution=0.3
+00026bd0: 352c 200a 2020 2020 2020 2020 2020 2020  5, .            
+00026be0: 2020 2020 2020 2020 2065 7175 6964 6973           equidis
+00026bf0: 7461 6e74 3d46 616c 7365 2922 5d0a 7075  tant=False)"].pu
+00026c00: 6220 666e 2067 7261 7068 5f73 7069 7261  b fn graph_spira
+00026c10: 6c5f 6c61 796f 7574 280a 2020 2020 6772  l_layout(.    gr
+00026c20: 6170 683a 2026 6772 6170 683a 3a50 7947  aph: &graph::PyG
+00026c30: 7261 7068 2c0a 2020 2020 7363 616c 653a  raph,.    scale:
+00026c40: 204f 7074 696f 6e3c 6636 343e 2c0a 2020   Option<f64>,.  
+00026c50: 2020 6365 6e74 6572 3a20 4f70 7469 6f6e    center: Option
+00026c60: 3c6c 6179 6f75 743a 3a50 6f69 6e74 3e2c  <layout::Point>,
+00026c70: 0a20 2020 2072 6573 6f6c 7574 696f 6e3a  .    resolution:
+00026c80: 204f 7074 696f 6e3c 6636 343e 2c0a 2020   Option<f64>,.  
+00026c90: 2020 6571 7569 6469 7374 616e 743a 204f    equidistant: O
+00026ca0: 7074 696f 6e3c 626f 6f6c 3e2c 0a29 202d  ption<bool>,.) -
+00026cb0: 3e20 506f 7332 444d 6170 7069 6e67 207b  > Pos2DMapping {
+00026cc0: 0a20 2020 206c 6179 6f75 743a 3a73 7069  .    layout::spi
+00026cd0: 7261 6c5f 6c61 796f 7574 2826 6772 6170  ral_layout(&grap
+00026ce0: 682e 6772 6170 682c 2073 6361 6c65 2c20  h.graph, scale, 
+00026cf0: 6365 6e74 6572 2c20 7265 736f 6c75 7469  center, resoluti
+00026d00: 6f6e 2c20 6571 7569 6469 7374 616e 7429  on, equidistant)
+00026d10: 0a7d 0a0a 2f2f 2f20 4765 6e65 7261 7465  .}../// Generate
+00026d20: 2061 2073 7069 7261 6c20 6c61 796f 7574   a spiral layout
+00026d30: 206f 6620 7468 6520 6772 6170 680a 2f2f   of the graph.//
+00026d40: 2f0a 2f2f 2f20 3a70 6172 616d 2050 7944  /./// :param PyD
+00026d50: 6947 7261 7068 2067 7261 7068 3a20 5468  iGraph graph: Th
+00026d60: 6520 6772 6170 6820 746f 2067 656e 6572  e graph to gener
+00026d70: 6174 6520 7468 6520 6c61 796f 7574 2066  ate the layout f
+00026d80: 6f72 0a2f 2f2f 203a 7061 7261 6d20 666c  or./// :param fl
+00026d90: 6f61 7420 7363 616c 653a 2041 6e20 6f70  oat scale: An op
+00026da0: 7469 6f6e 616c 2073 6361 6c69 6e67 2066  tional scaling f
+00026db0: 6163 746f 7220 746f 2073 6361 6c65 2070  actor to scale p
+00026dc0: 6f73 6974 696f 6e73 0a2f 2f2f 203a 7061  ositions./// :pa
+00026dd0: 7261 6d20 7475 706c 6520 6365 6e74 6572  ram tuple center
+00026de0: 3a20 416e 206f 7074 696f 6e61 6c20 6365  : An optional ce
+00026df0: 6e74 6572 2070 6f73 6974 696f 6e2e 2054  nter position. T
+00026e00: 6869 7320 6973 2061 2032 2074 7570 6c65  his is a 2 tuple
+00026e10: 206f 6620 7477 6f0a 2f2f 2f20 2020 2020   of two.///     
+00026e20: 6060 666c 6f61 7460 6020 7661 6c75 6573  ``float`` values
+00026e30: 2066 6f72 2074 6865 2063 656e 7465 7220   for the center 
+00026e40: 706f 7369 7469 6f6e 0a2f 2f2f 203a 7061  position./// :pa
+00026e50: 7261 6d20 666c 6f61 7420 7265 736f 6c75  ram float resolu
+00026e60: 7469 6f6e 3a20 5468 6520 636f 6d70 6163  tion: The compac
+00026e70: 746e 6573 7320 6f66 2074 6865 2073 7069  tness of the spi
+00026e80: 7261 6c20 6c61 796f 7574 2072 6574 7572  ral layout retur
+00026e90: 6e65 642e 0a2f 2f2f 2020 2020 204c 6f77  ned..///     Low
+00026ea0: 6572 2076 616c 7565 7320 7265 7375 6c74  er values result
+00026eb0: 2069 6e20 6d6f 7265 2063 6f6d 7072 6573   in more compres
+00026ec0: 7365 6420 7370 6972 616c 206c 6179 6f75  sed spiral layou
+00026ed0: 7473 2e0a 2f2f 2f20 3a70 6172 616d 2062  ts../// :param b
+00026ee0: 6f6f 6c20 6571 7569 6469 7374 616e 743a  ool equidistant:
+00026ef0: 2049 6620 7472 7565 2c20 6e6f 6465 7320   If true, nodes 
+00026f00: 7769 6c6c 2062 6520 706c 6f74 7465 6420  will be plotted 
+00026f10: 6571 7569 6469 7374 616e 7420 6672 6f6d  equidistant from
+00026f20: 0a2f 2f2f 2020 2020 2065 6163 6820 6f74  .///     each ot
+00026f30: 6865 722e 0a2f 2f2f 0a2f 2f2f 203a 7265  her..///./// :re
+00026f40: 7475 726e 733a 2054 6865 2073 7069 7261  turns: The spira
+00026f50: 6c20 6c61 796f 7574 206f 6620 7468 6520  l layout of the 
+00026f60: 6772 6170 682e 0a2f 2f2f 203a 7274 7970  graph../// :rtyp
+00026f70: 653a 2050 6f73 3244 4d61 7070 696e 670a  e: Pos2DMapping.
+00026f80: 235b 7079 6675 6e63 7469 6f6e 5d0a 235b  #[pyfunction].#[
+00026f90: 7465 7874 5f73 6967 6e61 7475 7265 203d  text_signature =
+00026fa0: 2022 2867 7261 7068 2c20 2f2c 2073 6361   "(graph, /, sca
+00026fb0: 6c65 3d31 2c20 6365 6e74 6572 3d4e 6f6e  le=1, center=Non
+00026fc0: 652c 2072 6573 6f6c 7574 696f 6e3d 302e  e, resolution=0.
+00026fd0: 3335 2c20 0a20 2020 2020 2020 2020 2020  35, .           
+00026fe0: 2020 2020 2020 2020 2020 6571 7569 6469            equidi
+00026ff0: 7374 616e 743d 4661 6c73 6529 225d 0a70  stant=False)"].p
+00027000: 7562 2066 6e20 6469 6772 6170 685f 7370  ub fn digraph_sp
+00027010: 6972 616c 5f6c 6179 6f75 7428 0a20 2020  iral_layout(.   
+00027020: 2067 7261 7068 3a20 2664 6967 7261 7068   graph: &digraph
+00027030: 3a3a 5079 4469 4772 6170 682c 0a20 2020  ::PyDiGraph,.   
+00027040: 2073 6361 6c65 3a20 4f70 7469 6f6e 3c66   scale: Option<f
+00027050: 3634 3e2c 0a20 2020 2063 656e 7465 723a  64>,.    center:
+00027060: 204f 7074 696f 6e3c 6c61 796f 7574 3a3a   Option<layout::
+00027070: 506f 696e 743e 2c0a 2020 2020 7265 736f  Point>,.    reso
+00027080: 6c75 7469 6f6e 3a20 4f70 7469 6f6e 3c66  lution: Option<f
+00027090: 3634 3e2c 0a20 2020 2065 7175 6964 6973  64>,.    equidis
+000270a0: 7461 6e74 3a20 4f70 7469 6f6e 3c62 6f6f  tant: Option<boo
+000270b0: 6c3e 2c0a 2920 2d3e 2050 6f73 3244 4d61  l>,.) -> Pos2DMa
+000270c0: 7070 696e 6720 7b0a 2020 2020 6c61 796f  pping {.    layo
+000270d0: 7574 3a3a 7370 6972 616c 5f6c 6179 6f75  ut::spiral_layou
+000270e0: 7428 2667 7261 7068 2e67 7261 7068 2c20  t(&graph.graph, 
+000270f0: 7363 616c 652c 2063 656e 7465 722c 2072  scale, center, r
+00027100: 6573 6f6c 7574 696f 6e2c 2065 7175 6964  esolution, equid
+00027110: 6973 7461 6e74 290a 7d0a 0a2f 2f20 5468  istant).}..// Th
+00027120: 6520 7072 6f76 6964 6564 206e 6f64 6520  e provided node 
+00027130: 6973 2069 6e76 616c 6964 2e0a 6372 6561  is invalid..crea
+00027140: 7465 5f65 7863 6570 7469 6f6e 2128 7265  te_exception!(re
+00027150: 7477 6f72 6b78 2c20 496e 7661 6c69 644e  tworkx, InvalidN
+00027160: 6f64 652c 2050 7945 7863 6570 7469 6f6e  ode, PyException
+00027170: 293b 0a2f 2f20 5065 7266 6f72 6d69 6e67  );.// Performing
+00027180: 2074 6869 7320 6f70 6572 6174 696f 6e20   this operation 
+00027190: 776f 756c 6420 7265 7375 6c74 2069 6e20  would result in 
+000271a0: 7472 7969 6e67 2074 6f20 6164 6420 6120  trying to add a 
+000271b0: 6379 636c 6520 746f 2061 2044 4147 2e0a  cycle to a DAG..
+000271c0: 6372 6561 7465 5f65 7863 6570 7469 6f6e  create_exception
+000271d0: 2128 7265 7477 6f72 6b78 2c20 4441 4757  !(retworkx, DAGW
+000271e0: 6f75 6c64 4379 636c 652c 2050 7945 7863  ouldCycle, PyExc
+000271f0: 6570 7469 6f6e 293b 0a2f 2f20 5468 6572  eption);.// Ther
+00027200: 6520 6973 206e 6f20 6564 6765 2070 7265  e is no edge pre
+00027210: 7365 6e74 2062 6574 7765 656e 2074 6865  sent between the
+00027220: 2070 726f 7669 6465 6420 6e6f 6465 732e   provided nodes.
+00027230: 0a63 7265 6174 655f 6578 6365 7074 696f  .create_exceptio
+00027240: 6e21 2872 6574 776f 726b 782c 204e 6f45  n!(retworkx, NoE
+00027250: 6467 6542 6574 7765 656e 4e6f 6465 732c  dgeBetweenNodes,
+00027260: 2050 7945 7863 6570 7469 6f6e 293b 0a2f   PyException);./
+00027270: 2f20 5468 6520 7370 6563 6966 6965 6420  / The specified 
+00027280: 4469 7265 6374 6564 2047 7261 7068 2068  Directed Graph h
+00027290: 6173 2061 2063 7963 6c65 2061 6e64 2063  as a cycle and c
+000272a0: 616e 2774 2062 6520 7472 6561 7465 6420  an't be treated 
+000272b0: 6173 2061 2044 4147 2e0a 6372 6561 7465  as a DAG..create
+000272c0: 5f65 7863 6570 7469 6f6e 2128 7265 7477  _exception!(retw
+000272d0: 6f72 6b78 2c20 4441 4748 6173 4379 636c  orkx, DAGHasCycl
+000272e0: 652c 2050 7945 7863 6570 7469 6f6e 293b  e, PyException);
+000272f0: 0a2f 2f20 4e6f 206e 6569 6768 626f 7273  .// No neighbors
+00027300: 2066 6f75 6e64 206d 6174 6368 696e 6720   found matching 
+00027310: 7468 6520 7072 6f76 6964 6564 2070 7265  the provided pre
+00027320: 6469 6361 7465 2e0a 6372 6561 7465 5f65  dicate..create_e
+00027330: 7863 6570 7469 6f6e 2128 7265 7477 6f72  xception!(retwor
+00027340: 6b78 2c20 4e6f 5375 6974 6162 6c65 4e65  kx, NoSuitableNe
+00027350: 6967 6862 6f72 732c 2050 7945 7863 6570  ighbors, PyExcep
+00027360: 7469 6f6e 293b 0a2f 2f20 496e 7661 6c69  tion);.// Invali
+00027370: 6420 6f70 6572 6174 696f 6e20 6f6e 2061  d operation on a
+00027380: 206e 756c 6c20 6772 6170 680a 6372 6561   null graph.crea
+00027390: 7465 5f65 7863 6570 7469 6f6e 2128 7265  te_exception!(re
+000273a0: 7477 6f72 6b78 2c20 4e75 6c6c 4772 6170  tworkx, NullGrap
+000273b0: 682c 2050 7945 7863 6570 7469 6f6e 293b  h, PyException);
+000273c0: 0a2f 2f20 4e6f 2070 6174 6820 7761 7320  .// No path was 
+000273d0: 666f 756e 6420 6265 7477 6565 6e20 7468  found between th
+000273e0: 6520 7370 6563 6966 6965 6420 6e6f 6465  e specified node
+000273f0: 732e 0a63 7265 6174 655f 6578 6365 7074  s..create_except
+00027400: 696f 6e21 2872 6574 776f 726b 782c 204e  ion!(retworkx, N
+00027410: 6f50 6174 6846 6f75 6e64 2c20 5079 4578  oPathFound, PyEx
+00027420: 6365 7074 696f 6e29 3b0a 0a23 5b70 796d  ception);..#[pym
+00027430: 6f64 756c 655d 0a66 6e20 7265 7477 6f72  odule].fn retwor
+00027440: 6b78 2870 793a 2050 7974 686f 6e3c 275f  kx(py: Python<'_
+00027450: 3e2c 206d 3a20 2650 794d 6f64 756c 6529  >, m: &PyModule)
+00027460: 202d 3e20 5079 5265 7375 6c74 3c28 293e   -> PyResult<()>
+00027470: 207b 0a20 2020 206d 2e61 6464 2822 5f5f   {.    m.add("__
+00027480: 7665 7273 696f 6e5f 5f22 2c20 656e 7621  version__", env!
+00027490: 2822 4341 5247 4f5f 504b 475f 5645 5253  ("CARGO_PKG_VERS
+000274a0: 494f 4e22 2929 3f3b 0a20 2020 206d 2e61  ION"))?;.    m.a
+000274b0: 6464 2822 496e 7661 6c69 644e 6f64 6522  dd("InvalidNode"
+000274c0: 2c20 7079 2e67 6574 5f74 7970 653a 3a3c  , py.get_type::<
+000274d0: 496e 7661 6c69 644e 6f64 653e 2829 293f  InvalidNode>())?
+000274e0: 3b0a 2020 2020 6d2e 6164 6428 2244 4147  ;.    m.add("DAG
+000274f0: 576f 756c 6443 7963 6c65 222c 2070 792e  WouldCycle", py.
+00027500: 6765 745f 7479 7065 3a3a 3c44 4147 576f  get_type::<DAGWo
+00027510: 756c 6443 7963 6c65 3e28 2929 3f3b 0a20  uldCycle>())?;. 
+00027520: 2020 206d 2e61 6464 2822 4e6f 4564 6765     m.add("NoEdge
+00027530: 4265 7477 6565 6e4e 6f64 6573 222c 2070  BetweenNodes", p
+00027540: 792e 6765 745f 7479 7065 3a3a 3c4e 6f45  y.get_type::<NoE
+00027550: 6467 6542 6574 7765 656e 4e6f 6465 733e  dgeBetweenNodes>
+00027560: 2829 293f 3b0a 2020 2020 6d2e 6164 6428  ())?;.    m.add(
+00027570: 2244 4147 4861 7343 7963 6c65 222c 2070  "DAGHasCycle", p
+00027580: 792e 6765 745f 7479 7065 3a3a 3c44 4147  y.get_type::<DAG
+00027590: 4861 7343 7963 6c65 3e28 2929 3f3b 0a20  HasCycle>())?;. 
+000275a0: 2020 206d 2e61 6464 2822 4e6f 5375 6974     m.add("NoSuit
+000275b0: 6162 6c65 4e65 6967 6862 6f72 7322 2c20  ableNeighbors", 
+000275c0: 7079 2e67 6574 5f74 7970 653a 3a3c 4e6f  py.get_type::<No
+000275d0: 5375 6974 6162 6c65 4e65 6967 6862 6f72  SuitableNeighbor
+000275e0: 733e 2829 293f 3b0a 2020 2020 6d2e 6164  s>())?;.    m.ad
+000275f0: 6428 224e 6f50 6174 6846 6f75 6e64 222c  d("NoPathFound",
+00027600: 2070 792e 6765 745f 7479 7065 3a3a 3c4e   py.get_type::<N
+00027610: 6f50 6174 6846 6f75 6e64 3e28 2929 3f3b  oPathFound>())?;
+00027620: 0a20 2020 206d 2e61 6464 2822 4e75 6c6c  .    m.add("Null
+00027630: 4772 6170 6822 2c20 7079 2e67 6574 5f74  Graph", py.get_t
+00027640: 7970 653a 3a3c 4e75 6c6c 4772 6170 683e  ype::<NullGraph>
+00027650: 2829 293f 3b0a 2020 2020 6d2e 6164 645f  ())?;.    m.add_
+00027660: 7772 6170 7065 6428 7772 6170 5f70 7966  wrapped(wrap_pyf
+00027670: 756e 6374 696f 6e21 2862 6673 5f73 7563  unction!(bfs_suc
+00027680: 6365 7373 6f72 7329 293f 3b0a 2020 2020  cessors))?;.    
+00027690: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
+000276a0: 6170 5f70 7966 756e 6374 696f 6e21 2864  ap_pyfunction!(d
+000276b0: 6167 5f6c 6f6e 6765 7374 5f70 6174 6829  ag_longest_path)
+000276c0: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+000276d0: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+000276e0: 6374 696f 6e21 2864 6167 5f6c 6f6e 6765  ction!(dag_longe
+000276f0: 7374 5f70 6174 685f 6c65 6e67 7468 2929  st_path_length))
+00027700: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027710: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027720: 7469 6f6e 2128 6e75 6d62 6572 5f77 6561  tion!(number_wea
+00027730: 6b6c 795f 636f 6e6e 6563 7465 645f 636f  kly_connected_co
+00027740: 6d70 6f6e 656e 7473 2929 3f3b 0a20 2020  mponents))?;.   
+00027750: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00027760: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00027770: 7765 616b 6c79 5f63 6f6e 6e65 6374 6564  weakly_connected
+00027780: 5f63 6f6d 706f 6e65 6e74 7329 293f 3b0a  _components))?;.
+00027790: 2020 2020 6d2e 6164 645f 7772 6170 7065      m.add_wrappe
+000277a0: 6428 7772 6170 5f70 7966 756e 6374 696f  d(wrap_pyfunctio
+000277b0: 6e21 2869 735f 7765 616b 6c79 5f63 6f6e  n!(is_weakly_con
+000277c0: 6e65 6374 6564 2929 3f3b 0a20 2020 206d  nected))?;.    m
+000277d0: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
+000277e0: 705f 7079 6675 6e63 7469 6f6e 2128 6973  p_pyfunction!(is
+000277f0: 5f64 6972 6563 7465 645f 6163 7963 6c69  _directed_acycli
+00027800: 635f 6772 6170 6829 293f 3b0a 2020 2020  c_graph))?;.    
+00027810: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
+00027820: 6170 5f70 7966 756e 6374 696f 6e21 2864  ap_pyfunction!(d
+00027830: 6967 7261 7068 5f69 735f 6973 6f6d 6f72  igraph_is_isomor
+00027840: 7068 6963 2929 3f3b 0a20 2020 206d 2e61  phic))?;.    m.a
+00027850: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
+00027860: 7079 6675 6e63 7469 6f6e 2128 6772 6170  pyfunction!(grap
+00027870: 685f 6973 5f69 736f 6d6f 7270 6869 6329  h_is_isomorphic)
+00027880: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+00027890: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+000278a0: 6374 696f 6e21 2864 6967 7261 7068 5f69  ction!(digraph_i
+000278b0: 735f 7375 6267 7261 7068 5f69 736f 6d6f  s_subgraph_isomo
+000278c0: 7270 6869 6329 293f 3b0a 2020 2020 6d2e  rphic))?;.    m.
+000278d0: 6164 645f 7772 6170 7065 6428 7772 6170  add_wrapped(wrap
+000278e0: 5f70 7966 756e 6374 696f 6e21 2867 7261  _pyfunction!(gra
+000278f0: 7068 5f69 735f 7375 6267 7261 7068 5f69  ph_is_subgraph_i
+00027900: 736f 6d6f 7270 6869 6329 293f 3b0a 2020  somorphic))?;.  
+00027910: 2020 6d2e 6164 645f 7772 6170 7065 6428    m.add_wrapped(
+00027920: 7772 6170 5f70 7966 756e 6374 696f 6e21  wrap_pyfunction!
+00027930: 2864 6967 7261 7068 5f75 6e69 6f6e 2929  (digraph_union))
+00027940: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027950: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027960: 7469 6f6e 2128 746f 706f 6c6f 6769 6361  tion!(topologica
+00027970: 6c5f 736f 7274 2929 3f3b 0a20 2020 206d  l_sort))?;.    m
+00027980: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
+00027990: 705f 7079 6675 6e63 7469 6f6e 2128 6465  p_pyfunction!(de
+000279a0: 7363 656e 6461 6e74 7329 293f 3b0a 2020  scendants))?;.  
+000279b0: 2020 6d2e 6164 645f 7772 6170 7065 6428    m.add_wrapped(
+000279c0: 7772 6170 5f70 7966 756e 6374 696f 6e21  wrap_pyfunction!
+000279d0: 2861 6e63 6573 746f 7273 2929 3f3b 0a20  (ancestors))?;. 
+000279e0: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+000279f0: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00027a00: 2128 6c65 7869 636f 6772 6170 6869 6361  !(lexicographica
+00027a10: 6c5f 746f 706f 6c6f 6769 6361 6c5f 736f  l_topological_so
+00027a20: 7274 2929 3f3b 0a20 2020 206d 2e61 6464  rt))?;.    m.add
+00027a30: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
+00027a40: 6675 6e63 7469 6f6e 2128 666c 6f79 645f  function!(floyd_
+00027a50: 7761 7273 6861 6c6c 2929 3f3b 0a20 2020  warshall))?;.   
+00027a60: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00027a70: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00027a80: 6772 6170 685f 666c 6f79 645f 7761 7273  graph_floyd_wars
+00027a90: 6861 6c6c 5f6e 756d 7079 2929 3f3b 0a20  hall_numpy))?;. 
+00027aa0: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+00027ab0: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00027ac0: 2128 6469 6772 6170 685f 666c 6f79 645f  !(digraph_floyd_
+00027ad0: 7761 7273 6861 6c6c 5f6e 756d 7079 2929  warshall_numpy))
+00027ae0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027af0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027b00: 7469 6f6e 2128 636f 6c6c 6563 745f 7275  tion!(collect_ru
+00027b10: 6e73 2929 3f3b 0a20 2020 206d 2e61 6464  ns))?;.    m.add
+00027b20: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
+00027b30: 6675 6e63 7469 6f6e 2128 6c61 7965 7273  function!(layers
+00027b40: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
+00027b50: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
+00027b60: 6e63 7469 6f6e 2128 6772 6170 685f 6469  nction!(graph_di
+00027b70: 7374 616e 6365 5f6d 6174 7269 7829 293f  stance_matrix))?
+00027b80: 3b0a 2020 2020 6d2e 6164 645f 7772 6170  ;.    m.add_wrap
+00027b90: 7065 6428 7772 6170 5f70 7966 756e 6374  ped(wrap_pyfunct
+00027ba0: 696f 6e21 2864 6967 7261 7068 5f64 6973  ion!(digraph_dis
+00027bb0: 7461 6e63 655f 6d61 7472 6978 2929 3f3b  tance_matrix))?;
+00027bc0: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+00027bd0: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+00027be0: 6f6e 2128 6469 6772 6170 685f 6164 6a61  on!(digraph_adja
+00027bf0: 6365 6e63 795f 6d61 7472 6978 2929 3f3b  cency_matrix))?;
+00027c00: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+00027c10: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+00027c20: 6f6e 2128 6772 6170 685f 6164 6a61 6365  on!(graph_adjace
+00027c30: 6e63 795f 6d61 7472 6978 2929 3f3b 0a20  ncy_matrix))?;. 
+00027c40: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+00027c50: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00027c60: 2128 6772 6170 685f 616c 6c5f 7369 6d70  !(graph_all_simp
+00027c70: 6c65 5f70 6174 6873 2929 3f3b 0a20 2020  le_paths))?;.   
+00027c80: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00027c90: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00027ca0: 6469 6772 6170 685f 616c 6c5f 7369 6d70  digraph_all_simp
+00027cb0: 6c65 5f70 6174 6873 2929 3f3b 0a20 2020  le_paths))?;.   
+00027cc0: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00027cd0: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00027ce0: 6772 6170 685f 6469 6a6b 7374 7261 5f73  graph_dijkstra_s
+00027cf0: 686f 7274 6573 745f 7061 7468 7329 293f  hortest_paths))?
+00027d00: 3b0a 2020 2020 6d2e 6164 645f 7772 6170  ;.    m.add_wrap
+00027d10: 7065 6428 7772 6170 5f70 7966 756e 6374  ped(wrap_pyfunct
+00027d20: 696f 6e21 2864 6967 7261 7068 5f64 696a  ion!(digraph_dij
+00027d30: 6b73 7472 615f 7368 6f72 7465 7374 5f70  kstra_shortest_p
+00027d40: 6174 6873 2929 3f3b 0a20 2020 206d 2e61  aths))?;.    m.a
+00027d50: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
+00027d60: 7079 6675 6e63 7469 6f6e 2128 6772 6170  pyfunction!(grap
+00027d70: 685f 6469 6a6b 7374 7261 5f73 686f 7274  h_dijkstra_short
+00027d80: 6573 745f 7061 7468 5f6c 656e 6774 6873  est_path_lengths
+00027d90: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
+00027da0: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
+00027db0: 6e63 7469 6f6e 2128 6469 6772 6170 685f  nction!(digraph_
+00027dc0: 6469 6a6b 7374 7261 5f73 686f 7274 6573  dijkstra_shortes
+00027dd0: 745f 7061 7468 5f6c 656e 6774 6873 2929  t_path_lengths))
+00027de0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027df0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027e00: 7469 6f6e 2128 6469 6772 6170 685f 616c  tion!(digraph_al
+00027e10: 6c5f 7061 6972 735f 6469 6a6b 7374 7261  l_pairs_dijkstra
+00027e20: 5f70 6174 685f 6c65 6e67 7468 7329 293f  _path_lengths))?
+00027e30: 3b0a 2020 2020 6d2e 6164 645f 7772 6170  ;.    m.add_wrap
+00027e40: 7065 6428 7772 6170 5f70 7966 756e 6374  ped(wrap_pyfunct
+00027e50: 696f 6e21 2864 6967 7261 7068 5f61 6c6c  ion!(digraph_all
+00027e60: 5f70 6169 7273 5f64 696a 6b73 7472 615f  _pairs_dijkstra_
+00027e70: 7368 6f72 7465 7374 5f70 6174 6873 2929  shortest_paths))
+00027e80: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027e90: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027ea0: 7469 6f6e 2128 6772 6170 685f 616c 6c5f  tion!(graph_all_
+00027eb0: 7061 6972 735f 6469 6a6b 7374 7261 5f70  pairs_dijkstra_p
+00027ec0: 6174 685f 6c65 6e67 7468 7329 293f 3b0a  ath_lengths))?;.
+00027ed0: 2020 2020 6d2e 6164 645f 7772 6170 7065      m.add_wrappe
+00027ee0: 6428 7772 6170 5f70 7966 756e 6374 696f  d(wrap_pyfunctio
+00027ef0: 6e21 2867 7261 7068 5f61 6c6c 5f70 6169  n!(graph_all_pai
+00027f00: 7273 5f64 696a 6b73 7472 615f 7368 6f72  rs_dijkstra_shor
+00027f10: 7465 7374 5f70 6174 6873 2929 3f3b 0a20  test_paths))?;. 
+00027f20: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+00027f30: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00027f40: 2128 6772 6170 685f 6173 7461 725f 7368  !(graph_astar_sh
+00027f50: 6f72 7465 7374 5f70 6174 6829 293f 3b0a  ortest_path))?;.
+00027f60: 2020 2020 6d2e 6164 645f 7772 6170 7065      m.add_wrappe
+00027f70: 6428 7772 6170 5f70 7966 756e 6374 696f  d(wrap_pyfunctio
+00027f80: 6e21 2864 6967 7261 7068 5f61 7374 6172  n!(digraph_astar
+00027f90: 5f73 686f 7274 6573 745f 7061 7468 2929  _shortest_path))
+00027fa0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00027fb0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00027fc0: 7469 6f6e 2128 6772 6170 685f 6772 6565  tion!(graph_gree
+00027fd0: 6479 5f63 6f6c 6f72 2929 3f3b 0a20 2020  dy_color))?;.   
+00027fe0: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00027ff0: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00028000: 6469 7265 6374 6564 5f67 6e70 5f72 616e  directed_gnp_ran
+00028010: 646f 6d5f 6772 6170 6829 293f 3b0a 2020  dom_graph))?;.  
+00028020: 2020 6d2e 6164 645f 7772 6170 7065 6428    m.add_wrapped(
+00028030: 7772 6170 5f70 7966 756e 6374 696f 6e21  wrap_pyfunction!
+00028040: 2875 6e64 6972 6563 7465 645f 676e 705f  (undirected_gnp_
+00028050: 7261 6e64 6f6d 5f67 7261 7068 2929 3f3b  random_graph))?;
+00028060: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+00028070: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+00028080: 6f6e 2128 6469 7265 6374 6564 5f67 6e6d  on!(directed_gnm
+00028090: 5f72 616e 646f 6d5f 6772 6170 6829 293f  _random_graph))?
+000280a0: 3b0a 2020 2020 6d2e 6164 645f 7772 6170  ;.    m.add_wrap
+000280b0: 7065 6428 7772 6170 5f70 7966 756e 6374  ped(wrap_pyfunct
+000280c0: 696f 6e21 2875 6e64 6972 6563 7465 645f  ion!(undirected_
+000280d0: 676e 6d5f 7261 6e64 6f6d 5f67 7261 7068  gnm_random_graph
+000280e0: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
+000280f0: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
+00028100: 6e63 7469 6f6e 2128 7261 6e64 6f6d 5f67  nction!(random_g
+00028110: 656f 6d65 7472 6963 5f67 7261 7068 2929  eometric_graph))
+00028120: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+00028130: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+00028140: 7469 6f6e 2128 6379 636c 655f 6261 7369  tion!(cycle_basi
+00028150: 7329 293f 3b0a 2020 2020 6d2e 6164 645f  s))?;.    m.add_
+00028160: 7772 6170 7065 6428 7772 6170 5f70 7966  wrapped(wrap_pyf
+00028170: 756e 6374 696f 6e21 2873 7472 6f6e 676c  unction!(strongl
+00028180: 795f 636f 6e6e 6563 7465 645f 636f 6d70  y_connected_comp
+00028190: 6f6e 656e 7473 2929 3f3b 0a20 2020 206d  onents))?;.    m
+000281a0: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
+000281b0: 705f 7079 6675 6e63 7469 6f6e 2128 6469  p_pyfunction!(di
+000281c0: 6772 6170 685f 6466 735f 6564 6765 7329  graph_dfs_edges)
+000281d0: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+000281e0: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+000281f0: 6374 696f 6e21 2867 7261 7068 5f64 6673  ction!(graph_dfs
+00028200: 5f65 6467 6573 2929 3f3b 0a20 2020 206d  _edges))?;.    m
+00028210: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
+00028220: 705f 7079 6675 6e63 7469 6f6e 2128 6469  p_pyfunction!(di
+00028230: 6772 6170 685f 6669 6e64 5f63 7963 6c65  graph_find_cycle
+00028240: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
+00028250: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
+00028260: 6e63 7469 6f6e 2128 6469 6772 6170 685f  nction!(digraph_
+00028270: 6b5f 7368 6f72 7465 7374 5f70 6174 685f  k_shortest_path_
+00028280: 6c65 6e67 7468 7329 293f 3b0a 2020 2020  lengths))?;.    
+00028290: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
+000282a0: 6170 5f70 7966 756e 6374 696f 6e21 2867  ap_pyfunction!(g
+000282b0: 7261 7068 5f6b 5f73 686f 7274 6573 745f  raph_k_shortest_
+000282c0: 7061 7468 5f6c 656e 6774 6873 2929 3f3b  path_lengths))?;
+000282d0: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+000282e0: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+000282f0: 6f6e 2128 6973 5f6d 6174 6368 696e 6729  on!(is_matching)
+00028300: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+00028310: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+00028320: 6374 696f 6e21 2869 735f 6d61 7869 6d61  ction!(is_maxima
+00028330: 6c5f 6d61 7463 6869 6e67 2929 3f3b 0a20  l_matching))?;. 
+00028340: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+00028350: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00028360: 2128 6d61 785f 7765 6967 6874 5f6d 6174  !(max_weight_mat
+00028370: 6368 696e 6729 293f 3b0a 2020 2020 6d2e  ching))?;.    m.
+00028380: 6164 645f 7772 6170 7065 6428 7772 6170  add_wrapped(wrap
+00028390: 5f70 7966 756e 6374 696f 6e21 286d 696e  _pyfunction!(min
+000283a0: 696d 756d 5f73 7061 6e6e 696e 675f 6564  imum_spanning_ed
+000283b0: 6765 7329 293f 3b0a 2020 2020 6d2e 6164  ges))?;.    m.ad
+000283c0: 645f 7772 6170 7065 6428 7772 6170 5f70  d_wrapped(wrap_p
+000283d0: 7966 756e 6374 696f 6e21 286d 696e 696d  yfunction!(minim
+000283e0: 756d 5f73 7061 6e6e 696e 675f 7472 6565  um_spanning_tree
+000283f0: 2929 3f3b 0a20 2020 206d 2e61 6464 5f77  ))?;.    m.add_w
+00028400: 7261 7070 6564 2877 7261 705f 7079 6675  rapped(wrap_pyfu
+00028410: 6e63 7469 6f6e 2128 6772 6170 685f 7472  nction!(graph_tr
+00028420: 616e 7369 7469 7669 7479 2929 3f3b 0a20  ansitivity))?;. 
+00028430: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+00028440: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00028450: 2128 6469 6772 6170 685f 7472 616e 7369  !(digraph_transi
+00028460: 7469 7669 7479 2929 3f3b 0a20 2020 206d  tivity))?;.    m
+00028470: 2e61 6464 5f77 7261 7070 6564 2877 7261  .add_wrapped(wra
+00028480: 705f 7079 6675 6e63 7469 6f6e 2128 6772  p_pyfunction!(gr
+00028490: 6170 685f 636f 7265 5f6e 756d 6265 7229  aph_core_number)
+000284a0: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+000284b0: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+000284c0: 6374 696f 6e21 2864 6967 7261 7068 5f63  ction!(digraph_c
+000284d0: 6f72 655f 6e75 6d62 6572 2929 3f3b 0a20  ore_number))?;. 
+000284e0: 2020 206d 2e61 6464 5f77 7261 7070 6564     m.add_wrapped
+000284f0: 2877 7261 705f 7079 6675 6e63 7469 6f6e  (wrap_pyfunction
+00028500: 2128 6772 6170 685f 636f 6d70 6c65 6d65  !(graph_compleme
+00028510: 6e74 2929 3f3b 0a20 2020 206d 2e61 6464  nt))?;.    m.add
+00028520: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
+00028530: 6675 6e63 7469 6f6e 2128 6469 6772 6170  function!(digrap
+00028540: 685f 636f 6d70 6c65 6d65 6e74 2929 3f3b  h_complement))?;
+00028550: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+00028560: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+00028570: 6f6e 2128 6772 6170 685f 7261 6e64 6f6d  on!(graph_random
+00028580: 5f6c 6179 6f75 7429 293f 3b0a 2020 2020  _layout))?;.    
+00028590: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
+000285a0: 6170 5f70 7966 756e 6374 696f 6e21 2864  ap_pyfunction!(d
+000285b0: 6967 7261 7068 5f72 616e 646f 6d5f 6c61  igraph_random_la
+000285c0: 796f 7574 2929 3f3b 0a20 2020 206d 2e61  yout))?;.    m.a
+000285d0: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
+000285e0: 7079 6675 6e63 7469 6f6e 2128 6772 6170  pyfunction!(grap
+000285f0: 685f 6269 7061 7274 6974 655f 6c61 796f  h_bipartite_layo
+00028600: 7574 2929 3f3b 0a20 2020 206d 2e61 6464  ut))?;.    m.add
+00028610: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
+00028620: 6675 6e63 7469 6f6e 2128 6469 6772 6170  function!(digrap
+00028630: 685f 6269 7061 7274 6974 655f 6c61 796f  h_bipartite_layo
+00028640: 7574 2929 3f3b 0a20 2020 206d 2e61 6464  ut))?;.    m.add
+00028650: 5f77 7261 7070 6564 2877 7261 705f 7079  _wrapped(wrap_py
+00028660: 6675 6e63 7469 6f6e 2128 6772 6170 685f  function!(graph_
+00028670: 6369 7263 756c 6172 5f6c 6179 6f75 7429  circular_layout)
+00028680: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+00028690: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+000286a0: 6374 696f 6e21 2864 6967 7261 7068 5f63  ction!(digraph_c
+000286b0: 6972 6375 6c61 725f 6c61 796f 7574 2929  ircular_layout))
+000286c0: 3f3b 0a20 2020 206d 2e61 6464 5f77 7261  ?;.    m.add_wra
+000286d0: 7070 6564 2877 7261 705f 7079 6675 6e63  pped(wrap_pyfunc
+000286e0: 7469 6f6e 2128 6772 6170 685f 7368 656c  tion!(graph_shel
+000286f0: 6c5f 6c61 796f 7574 2929 3f3b 0a20 2020  l_layout))?;.   
+00028700: 206d 2e61 6464 5f77 7261 7070 6564 2877   m.add_wrapped(w
+00028710: 7261 705f 7079 6675 6e63 7469 6f6e 2128  rap_pyfunction!(
+00028720: 6469 6772 6170 685f 7368 656c 6c5f 6c61  digraph_shell_la
+00028730: 796f 7574 2929 3f3b 0a20 2020 206d 2e61  yout))?;.    m.a
+00028740: 6464 5f77 7261 7070 6564 2877 7261 705f  dd_wrapped(wrap_
+00028750: 7079 6675 6e63 7469 6f6e 2128 6772 6170  pyfunction!(grap
+00028760: 685f 7370 6972 616c 5f6c 6179 6f75 7429  h_spiral_layout)
+00028770: 293f 3b0a 2020 2020 6d2e 6164 645f 7772  )?;.    m.add_wr
+00028780: 6170 7065 6428 7772 6170 5f70 7966 756e  apped(wrap_pyfun
+00028790: 6374 696f 6e21 2864 6967 7261 7068 5f73  ction!(digraph_s
+000287a0: 7069 7261 6c5f 6c61 796f 7574 2929 3f3b  piral_layout))?;
+000287b0: 0a20 2020 206d 2e61 6464 5f77 7261 7070  .    m.add_wrapp
+000287c0: 6564 2877 7261 705f 7079 6675 6e63 7469  ed(wrap_pyfuncti
+000287d0: 6f6e 2128 6772 6170 685f 7370 7269 6e67  on!(graph_spring
+000287e0: 5f6c 6179 6f75 7429 293f 3b0a 2020 2020  _layout))?;.    
+000287f0: 6d2e 6164 645f 7772 6170 7065 6428 7772  m.add_wrapped(wr
+00028800: 6170 5f70 7966 756e 6374 696f 6e21 2864  ap_pyfunction!(d
+00028810: 6967 7261 7068 5f73 7072 696e 675f 6c61  igraph_spring_la
+00028820: 796f 7574 2929 3f3b 0a20 2020 206d 2e61  yout))?;.    m.a
+00028830: 6464 5f63 6c61 7373 3a3a 3c64 6967 7261  dd_class::<digra
+00028840: 7068 3a3a 5079 4469 4772 6170 683e 2829  ph::PyDiGraph>()
+00028850: 3f3b 0a20 2020 206d 2e61 6464 5f63 6c61  ?;.    m.add_cla
+00028860: 7373 3a3a 3c67 7261 7068 3a3a 5079 4772  ss::<graph::PyGr
+00028870: 6170 683e 2829 3f3b 0a20 2020 206d 2e61  aph>()?;.    m.a
+00028880: 6464 5f63 6c61 7373 3a3a 3c69 7465 7261  dd_class::<itera
+00028890: 746f 7273 3a3a 4246 5353 7563 6365 7373  tors::BFSSuccess
+000288a0: 6f72 733e 2829 3f3b 0a20 2020 206d 2e61  ors>()?;.    m.a
+000288b0: 6464 5f63 6c61 7373 3a3a 3c69 7465 7261  dd_class::<itera
+000288c0: 746f 7273 3a3a 4e6f 6465 496e 6469 6365  tors::NodeIndice
+000288d0: 733e 2829 3f3b 0a20 2020 206d 2e61 6464  s>()?;.    m.add
+000288e0: 5f63 6c61 7373 3a3a 3c69 7465 7261 746f  _class::<iterato
+000288f0: 7273 3a3a 4564 6765 496e 6469 6365 733e  rs::EdgeIndices>
+00028900: 2829 3f3b 0a20 2020 206d 2e61 6464 5f63  ()?;.    m.add_c
+00028910: 6c61 7373 3a3a 3c69 7465 7261 746f 7273  lass::<iterators
+00028920: 3a3a 4564 6765 4c69 7374 3e28 293f 3b0a  ::EdgeList>()?;.
+00028930: 2020 2020 6d2e 6164 645f 636c 6173 733a      m.add_class:
+00028940: 3a3c 6974 6572 6174 6f72 733a 3a45 6467  :<iterators::Edg
+00028950: 6549 6e64 6578 4d61 703e 2829 3f3b 0a20  eIndexMap>()?;. 
+00028960: 2020 206d 2e61 6464 5f63 6c61 7373 3a3a     m.add_class::
+00028970: 3c69 7465 7261 746f 7273 3a3a 5765 6967  <iterators::Weig
+00028980: 6874 6564 4564 6765 4c69 7374 3e28 293f  htedEdgeList>()?
+00028990: 3b0a 2020 2020 6d2e 6164 645f 636c 6173  ;.    m.add_clas
+000289a0: 733a 3a3c 6974 6572 6174 6f72 733a 3a50  s::<iterators::P
+000289b0: 6174 684d 6170 7069 6e67 3e28 293f 3b0a  athMapping>()?;.
+000289c0: 2020 2020 6d2e 6164 645f 636c 6173 733a      m.add_class:
+000289d0: 3a3c 6974 6572 6174 6f72 733a 3a50 6174  :<iterators::Pat
+000289e0: 684c 656e 6774 684d 6170 7069 6e67 3e28  hLengthMapping>(
+000289f0: 293f 3b0a 2020 2020 6d2e 6164 645f 636c  )?;.    m.add_cl
+00028a00: 6173 733a 3a3c 6974 6572 6174 6f72 733a  ass::<iterators:
+00028a10: 3a50 6f73 3244 4d61 7070 696e 673e 2829  :Pos2DMapping>()
+00028a20: 3f3b 0a20 2020 206d 2e61 6464 5f63 6c61  ?;.    m.add_cla
+00028a30: 7373 3a3a 3c69 7465 7261 746f 7273 3a3a  ss::<iterators::
+00028a40: 416c 6c50 6169 7273 5061 7468 4c65 6e67  AllPairsPathLeng
+00028a50: 7468 4d61 7070 696e 673e 2829 3f3b 0a20  thMapping>()?;. 
+00028a60: 2020 206d 2e61 6464 5f63 6c61 7373 3a3a     m.add_class::
+00028a70: 3c69 7465 7261 746f 7273 3a3a 416c 6c50  <iterators::AllP
+00028a80: 6169 7273 5061 7468 4d61 7070 696e 673e  airsPathMapping>
+00028a90: 2829 3f3b 0a20 2020 206d 2e61 6464 5f77  ()?;.    m.add_w
+00028aa0: 7261 7070 6564 2877 7261 705f 7079 6d6f  rapped(wrap_pymo
+00028ab0: 6475 6c65 2128 6765 6e65 7261 746f 7273  dule!(generators
+00028ac0: 2929 3f3b 0a20 2020 204f 6b28 2829 290a  ))?;.    Ok(()).
+00028ad0: 7d0a                                     }.
```

### Comparing `retworkx-0.8.0/src/max_weight_matching.rs` & `retworkx-0.9.0/src/max_weight_matching.rs`

 * *Files 0% similar despite different names*

```diff
@@ -115,18 +115,15 @@
         // with an external mate.)
         let blossom_index: usize = b;
         let base: usize = blossom_base[blossom_index].unwrap();
         assert!(mate.get(&base).is_some());
         assign_label(
             endpoints[mate[&base]],
             1,
-            match mate.get(&base) {
-                Some(p) => Some(p ^ 1),
-                None => None,
-            },
+            mate.get(&base).map(|p| (p ^ 1)),
             num_nodes,
             in_blossoms,
             labels,
             label_ends,
             best_edge,
             queue,
             blossom_children,
@@ -412,25 +409,24 @@
         // Decied in which direction we will go around the blossom.
         let i = blossom_children[blossom]
             .iter()
             .position(|x| *x == entry_child)
             .unwrap();
         let mut j = i as i128;
         let j_step: i128;
-        let endpoint_trick: usize;
-        if i & 1 != 0 {
+        let endpoint_trick: usize = if i & 1 != 0 {
             // Start index is odd; go forward and wrap
             j -= blossom_children[blossom].len() as i128;
             j_step = 1;
-            endpoint_trick = 0;
+            0
         } else {
             // start index is even; go backward
             j_step = -1;
-            endpoint_trick = 1;
-        }
+            1
+        };
         // Move along the blossom until we get to the base
         let mut p = label_ends[blossom].unwrap();
         while j != 0 {
             // Relabel the T-sub-blossom.
             labels[endpoints[p ^ 1]] = Some(0);
             if j < 0 {
                 let length = blossom_endpoints[blossom].len();
@@ -609,25 +605,24 @@
     // Decide in which direction we will go around the blossom.
     let i = blossom_children[blossom]
         .iter()
         .position(|x| *x == tmp)
         .unwrap();
     let mut j: i128 = i as i128;
     let j_step: i128;
-    let endpoint_trick: usize;
-    if i & 1 != 0 {
+    let endpoint_trick: usize = if i & 1 != 0 {
         // start index is odd; go forward and wrap.
         j -= blossom_children[blossom].len() as i128;
         j_step = 1;
-        endpoint_trick = 0;
+        0
     } else {
         // Start index is even; go backward.
         j_step = -1;
-        endpoint_trick = 1;
-    }
+        1
+    };
     // Move along the blossom until we get to the base.
     while j != 0 {
         // Step to the next sub-blossom and augment it recursively.
         j += j_step;
 
         tmp = if j < 0 {
             let length = blossom_children[blossom].len();
@@ -911,20 +906,19 @@
         ));
     }
     // If p is an edge endpoint
     // endpoints[p] is the node index to which endpoint p is attached
     let endpoints: Vec<usize> = (0..2 * num_edges)
         .map(|endpoint| {
             let edge_tuple = edges[endpoint / 2];
-            let out_value: usize;
-            if endpoint % 2 == 0 {
-                out_value = edge_tuple.0;
+            let out_value: usize = if endpoint % 2 == 0 {
+                edge_tuple.0
             } else {
-                out_value = edge_tuple.1;
-            }
+                edge_tuple.1
+            };
             out_value
         })
         .collect();
     // If v is a node/vertex
     // neighbor_endpoints[v] is the list of remote endpoints of the edges
     // attached to v.
     // Not modified by algorithm (only mut to initially construct contents).
@@ -1116,19 +1110,19 @@
                                 &in_blossoms,
                                 &blossom_base,
                                 &endpoints,
                                 &mut labels,
                                 &label_ends,
                                 &mate,
                             );
-                            if base.is_some() {
+                            match base {
                                 // Found a new blossom; add it to the blossom
                                 // bookkeeping and turn it into an S-blossom.
-                                add_blossom(
-                                    base.unwrap(),
+                                Some(base) => add_blossom(
+                                    base,
                                     k,
                                     &mut blossom_children,
                                     num_nodes,
                                     &edges,
                                     &mut in_blossoms,
                                     &mut dual_var,
                                     &mut labels,
@@ -1139,35 +1133,36 @@
                                     &endpoints,
                                     &mut blossom_endpoints,
                                     &mut unused_blossoms,
                                     &mut blossom_best_edges,
                                     &mut blossom_parents,
                                     &neighbor_endpoints,
                                     &mate,
-                                )?;
-                            } else {
+                                )?,
                                 // Found an augmenting path; augment the
                                 // matching and end this stage.
-                                augment_matching(
-                                    k,
-                                    num_nodes,
-                                    &edges,
-                                    &in_blossoms,
-                                    &labels,
-                                    &label_ends,
-                                    &blossom_parents,
-                                    &endpoints,
-                                    &mut blossom_children,
-                                    &mut blossom_endpoints,
-                                    &mut blossom_base,
-                                    &mut mate,
-                                );
-                                augmented = true;
-                                break;
-                            }
+                                None => {
+                                    augment_matching(
+                                        k,
+                                        num_nodes,
+                                        &edges,
+                                        &in_blossoms,
+                                        &labels,
+                                        &label_ends,
+                                        &blossom_parents,
+                                        &endpoints,
+                                        &mut blossom_children,
+                                        &mut blossom_endpoints,
+                                        &mut blossom_base,
+                                        &mut mate,
+                                    );
+                                    augmented = true;
+                                    break;
+                                }
+                            };
                         } else if labels[w] == Some(0) {
                             // w is inside a T-blossom, but w itself has not
                             // yet been reached from outside the blossom;
                             // mark it as reached (we need this to relabel
                             // during T-blossom expansion).
                             assert!(labels[in_blossoms[w]] == Some(2));
                             labels[w] = Some(2);
```

### Comparing `retworkx-0.8.0/src/union.rs` & `retworkx-0.9.0/src/union.rs`

 * *Files identical despite different names*

