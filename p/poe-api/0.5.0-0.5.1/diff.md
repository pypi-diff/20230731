# Comparing `tmp/poe_api-0.5.0-py3-none-any.whl.zip` & `tmp/poe_api-0.5.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,10 +1,11 @@
-Zip file size: 64017 bytes, number of entries: 78
+Zip file size: 69518 bytes, number of entries: 80
 -rw-r--r--  2.0 unx    24913 b- defN 23-Jul-24 15:53 poe.py
--rw-r--r--  2.0 unx    25283 b- defN 23-Jul-29 22:19 poe/__init__.py
+-rw-r--r--  2.0 unx    25482 b- defN 23-Jul-31 06:05 poe/__init__.py
+-rw-r--r--  2.0 unx     1756 b- defN 23-Jul-31 05:41 poe/hashes.py
 -rw-r--r--  2.0 unx     1093 b- defN 23-Jul-23 18:41 poe/poe_graphql/AddHumanMessageMutation.graphql
 -rw-r--r--  2.0 unx      504 b- defN 23-Jul-23 18:41 poe/poe_graphql/AddMessageBreakMutation.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-Jul-23 18:41 poe/poe_graphql/AutoSubscriptionMutation.graphql
 -rw-r--r--  2.0 unx       97 b- defN 23-Jul-23 18:41 poe/poe_graphql/BioFragment.graphql
 -rw-r--r--  2.0 unx       73 b- defN 23-Jul-23 18:41 poe/poe_graphql/ChatAddedSubscription.graphql
 -rw-r--r--  2.0 unx      100 b- defN 23-Jul-23 18:41 poe/poe_graphql/ChatFragment.graphql
 -rw-r--r--  2.0 unx    11486 b- defN 23-Jul-23 18:41 poe/poe_graphql/ChatListPaginationQuery.graphql
@@ -32,14 +33,15 @@
 -rw-r--r--  2.0 unx       95 b- defN 23-Jul-23 18:41 poe/poe_graphql/SummarizePlainPostQuery.graphql
 -rw-r--r--  2.0 unx      147 b- defN 23-Jul-23 18:41 poe/poe_graphql/SummarizeQuotePostQuery.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-Jul-23 18:41 poe/poe_graphql/SummarizeSharePostQuery.graphql
 -rw-r--r--  2.0 unx      368 b- defN 23-Jul-23 18:41 poe/poe_graphql/UserSnippetFragment.graphql
 -rw-r--r--  2.0 unx      400 b- defN 23-Jul-23 18:41 poe/poe_graphql/ViewerInfoQuery.graphql
 -rw-r--r--  2.0 unx     1038 b- defN 23-Jul-23 18:41 poe/poe_graphql/ViewerStateFragment.graphql
 -rw-r--r--  2.0 unx      657 b- defN 23-Jul-23 18:41 poe/poe_graphql/ViewerStateUpdatedSubscription.graphql
+-rw-r--r--  2.0 unx     8386 b- defN 23-Jul-31 05:44 poe/poe_graphql/queries.json
 -rw-r--r--  2.0 unx     1093 b- defN 23-Jul-23 18:41 poe_graphql/AddHumanMessageMutation.graphql
 -rw-r--r--  2.0 unx      504 b- defN 23-Jul-23 18:41 poe_graphql/AddMessageBreakMutation.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-Jul-23 18:41 poe_graphql/AutoSubscriptionMutation.graphql
 -rw-r--r--  2.0 unx       97 b- defN 23-Jul-23 18:41 poe_graphql/BioFragment.graphql
 -rw-r--r--  2.0 unx       73 b- defN 23-Jul-23 18:41 poe_graphql/ChatAddedSubscription.graphql
 -rw-r--r--  2.0 unx      100 b- defN 23-Jul-23 18:41 poe_graphql/ChatFragment.graphql
 -rw-r--r--  2.0 unx    11486 b- defN 23-Jul-23 18:41 poe_graphql/ChatListPaginationQuery.graphql
@@ -68,13 +70,13 @@
 -rw-r--r--  2.0 unx      147 b- defN 23-Jul-23 18:41 poe_graphql/SummarizeQuotePostQuery.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-Jul-23 18:41 poe_graphql/SummarizeSharePostQuery.graphql
 -rw-r--r--  2.0 unx      368 b- defN 23-Jul-23 18:41 poe_graphql/UserSnippetFragment.graphql
 -rw-r--r--  2.0 unx      400 b- defN 23-Jul-23 18:41 poe_graphql/ViewerInfoQuery.graphql
 -rw-r--r--  2.0 unx     1038 b- defN 23-Jul-23 18:41 poe_graphql/ViewerStateFragment.graphql
 -rw-r--r--  2.0 unx      657 b- defN 23-Jul-23 18:41 poe_graphql/ViewerStateUpdatedSubscription.graphql
 -rw-r--r--  2.0 unx        0 b- defN 23-May-27 23:16 poe_graphql/__init__.py
--rw-r--r--  2.0 unx    35149 b- defN 23-Jul-30 00:31 poe_api-0.5.0.dist-info/LICENSE
--rw-r--r--  2.0 unx    20227 b- defN 23-Jul-30 00:31 poe_api-0.5.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-30 00:31 poe_api-0.5.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        4 b- defN 23-Jul-30 00:31 poe_api-0.5.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     7621 b- defN 23-Jul-30 00:31 poe_api-0.5.0.dist-info/RECORD
-78 files, 166231 bytes uncompressed, 51477 bytes compressed:  69.0%
+-rw-r--r--  2.0 unx    35149 b- defN 23-Jul-31 06:37 poe_api-0.5.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx    20227 b- defN 23-Jul-31 06:37 poe_api-0.5.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-31 06:37 poe_api-0.5.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 23-Jul-31 06:37 poe_api-0.5.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     7776 b- defN 23-Jul-31 06:37 poe_api-0.5.1.dist-info/RECORD
+80 files, 176727 bytes uncompressed, 56744 bytes compressed:  67.9%
```

## zipnote {}

```diff
@@ -1,13 +1,16 @@
 Filename: poe.py
 Comment: 
 
 Filename: poe/__init__.py
 Comment: 
 
+Filename: poe/hashes.py
+Comment: 
+
 Filename: poe/poe_graphql/AddHumanMessageMutation.graphql
 Comment: 
 
 Filename: poe/poe_graphql/AddMessageBreakMutation.graphql
 Comment: 
 
 Filename: poe/poe_graphql/AutoSubscriptionMutation.graphql
@@ -105,14 +108,17 @@
 
 Filename: poe/poe_graphql/ViewerStateFragment.graphql
 Comment: 
 
 Filename: poe/poe_graphql/ViewerStateUpdatedSubscription.graphql
 Comment: 
 
+Filename: poe/poe_graphql/queries.json
+Comment: 
+
 Filename: poe_graphql/AddHumanMessageMutation.graphql
 Comment: 
 
 Filename: poe_graphql/AddMessageBreakMutation.graphql
 Comment: 
 
 Filename: poe_graphql/AutoSubscriptionMutation.graphql
@@ -213,23 +219,23 @@
 
 Filename: poe_graphql/ViewerStateUpdatedSubscription.graphql
 Comment: 
 
 Filename: poe_graphql/__init__.py
 Comment: 
 
-Filename: poe_api-0.5.0.dist-info/LICENSE
+Filename: poe_api-0.5.1.dist-info/LICENSE
 Comment: 
 
-Filename: poe_api-0.5.0.dist-info/METADATA
+Filename: poe_api-0.5.1.dist-info/METADATA
 Comment: 
 
-Filename: poe_api-0.5.0.dist-info/WHEEL
+Filename: poe_api-0.5.1.dist-info/WHEEL
 Comment: 
 
-Filename: poe_api-0.5.0.dist-info/top_level.txt
+Filename: poe_api-0.5.1.dist-info/top_level.txt
 Comment: 
 
-Filename: poe_api-0.5.0.dist-info/RECORD
+Filename: poe_api-0.5.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## poe/__init__.py

```diff
@@ -6,15 +6,15 @@
 import websocket
 import uuid
 import random
 from pathlib import Path
 from urllib.parse import urlparse
 
 parent_path = Path(__file__).resolve().parent
-queries_path = parent_path / "poe_graphql"
+queries_path = parent_path / "poe_graphql" / "queries.json"
 queries = {}
 
 logging.basicConfig()
 logger = logging.getLogger()
 
 user_agent = "This will be ignored! See the README for info on how to set custom headers."
 headers = {
@@ -25,26 +25,28 @@
   "Sec-Ch-Ua": "\"Not.A/Brand\";v=\"8\", \"Chromium\";v=\"112\"",
   "Sec-Ch-Ua-Mobile": "?0",
   "Sec-Ch-Ua-Platform": "\"Linux\"",
   "Upgrade-Insecure-Requests": "1"
 }
 client_identifier = "chrome112"
 
-def load_queries():
-  for path in queries_path.iterdir():
-    if path.suffix != ".graphql":
-      continue
-    with open(path) as f:
-      queries[path.stem] = f.read()
+#load gql queries
+try:
+  queries = json.loads(queries_path.read_text())
+except FileNotFoundError:
+  logger.error("GraphQL queries file not found.")
+  queries = {}
 
 def generate_payload(query_name, variables):
   if query_name == "recv":
     return generate_recv_payload(variables)
   return {
-    "query": queries[query_name],
+    "extensions": {
+      "hash": queries[query_name]
+    },  
     "queryName": query_name,
     "variables": variables
   }
 
 def generate_recv_payload(variables):
   payload = [
     {
@@ -389,19 +391,21 @@
 
   def subscribe(self):
     logger.info("Subscribing to mutations")
     result = self.send_query("SubscriptionsMutation", {
       "subscriptions": [
         {
           "subscriptionName": "messageAdded",
-          "query": queries["MessageAddedSubscription"]
+          "queryHash": queries["MessageAdded"],
+          "query": None
         },
         {
           "subscriptionName": "viewerStateUpdated",
-          "query": queries["ViewerStateUpdatedSubscription"]
+          "queryHash": queries["ViewerStateUpdated"],
+          "query": None
         }
       ]
     })
 
   def ws_run_thread(self):
     kwargs = {}
     if self.proxy:
@@ -543,18 +547,24 @@
 
     chat_id = self.get_bot_by_codename(chatbot)["chatId"]
     try:
       message_data = self.send_query("SendMessageMutation", {
         "bot": chatbot,
         "query": message,
         "chatId": chat_id,
-        "source": None,
+        "source": {
+          "chatInputMetadata": {
+            "useVoiceRecord": False
+          },
+          "sourceType": "chat_input"
+        },
         "clientNonce": generate_nonce(),
         "sdid": self.device_id,
         "withChatBreak": with_chat_break,
+        "attachments": []
       })
       del self.active_messages["pending"]
     except Exception as e:
       del self.active_messages["pending"]
       raise e
 
     if not message_data["data"]["messageEdgeCreate"]["message"]:
@@ -671,15 +681,15 @@
     return messages
 
   def delete_message(self, message_ids):
     logger.info(f"Deleting messages: {message_ids}")
     if not type(message_ids) is list:
       message_ids = [int(message_ids)]
 
-    result = self.send_query("DeleteMessageMutation", {
+    result = self.send_query("DeleteUserMessagesMutation", {
       "messageIds": message_ids
     })
 
   def purge_conversation(self, chatbot, count=-1):
     logger.info(f"Purging messages from {chatbot}")
     last_messages = self.get_message_history(chatbot, count=50)[::-1]
     while last_messages:
@@ -699,15 +709,15 @@
     logger.info(f"No more messages left to delete.")
 
   def create_bot(self, handle, prompt, display_name=None, base_model="chinchilla", description="",
                   intro_message="", api_key=None, api_bot=False, api_url=None,
                   prompt_public=True, pfp_url=None, linkification=False,
                   markdown_rendering=True, suggested_replies=False, private=False,
                   temperature=None):
-    result = self.send_query("PoeBotCreateMutation", {
+    result = self.send_query("PoeBotCreate", {
       "model": base_model,
       "displayName": display_name,
       "handle": handle,
       "prompt": prompt,
       "isPromptPublic": prompt_public,
       "introduction": intro_message,
       "description": description,
@@ -733,15 +743,15 @@
                 prompt_public=True, pfp_url=None, linkification=False,
                 markdown_rendering=True, suggested_replies=False, temperature=None, new_handle=None):
 
     if bot_id is None and handle is not None:
       bot_id = self.get_bot(handle)["defaultBotObject"]["botId"]
     new_handle = new_handle or handle
     
-    result = self.send_query("PoeBotEditMutation", {
+    result = self.send_query("PoeBotEdit", {
       "baseBot": base_model,
       "botId": bot_id,
       "handle": new_handle,
       "displayName": display_name,
       "prompt": prompt,
       "isPromptPublic": prompt_public,
       "introduction": intro_message,
@@ -761,9 +771,7 @@
       raise RuntimeError(f"Poe returned an error while trying to edit a bot: {data['status']}")
     self.get_bots()
     return data
 
   def purge_all_conversations(self):
     logger.info("Purging all conversations")
     self.send_query("DeleteUserMessagesMutation", {})
-
-load_queries()
```

## Comparing `poe_api-0.5.0.dist-info/LICENSE` & `poe_api-0.5.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `poe_api-0.5.0.dist-info/METADATA` & `poe_api-0.5.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: poe-api
-Version: 0.5.0
+Version: 0.5.1
 Summary: A reverse engineered API wrapper for Quora's Poe
 Home-page: https://github.com/ading2210/poe-api
 Author: ading2210
 License: GPLv3
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License (GPL)
 Classifier: Operating System :: OS Independent
```

## Comparing `poe_api-0.5.0.dist-info/RECORD` & `poe_api-0.5.1.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,9 +1,10 @@
 poe.py,sha256=JXpKBp-F8mJmMSepHTwr695mgGWJXlWqdk2_c1sK36g,24913
-poe/__init__.py,sha256=X-FCdp39EtBJpf9hfSCxauId5Krpcx8m1ZTyGao7buU,25283
+poe/__init__.py,sha256=PghKTICqY-LCyUoVvZk2g1cKpxGvaO2jqOosU3RBpUU,25482
+poe/hashes.py,sha256=2RnbXCDzLRm0OLu4x2l5lEkeSUEmdR3AQNu_HVk-844,1756
 poe/poe_graphql/AddHumanMessageMutation.graphql,sha256=Va4SoysKE2qPlJfbwoKp6mNv0vs5hnVR20g8hPvAxdY,1093
 poe/poe_graphql/AddMessageBreakMutation.graphql,sha256=lFDgYYX0ZTHso-ZQwm-oUk-HaSTRqOmj-zIjBQRL2sM,504
 poe/poe_graphql/AutoSubscriptionMutation.graphql,sha256=3i8EnqwUrjOcJ2Hxly-lKhwPBJdbpO99POiM_K6jVD4,180
 poe/poe_graphql/BioFragment.graphql,sha256=3ZdXaPtuHK38bG10WFH6bvpebcyrTLu5fs-ddtfLjf0,97
 poe/poe_graphql/ChatAddedSubscription.graphql,sha256=NFLZJAwi0V2WQea1oelyRUrtNrwOE58NOeX8ChzVE10,73
 poe/poe_graphql/ChatFragment.graphql,sha256=NFVSvT3NdYlEquue3yTHPu9ezCIgx6k1OXJZo2ytIzU,100
 poe/poe_graphql/ChatListPaginationQuery.graphql,sha256=WameJV_yyS6Ey_VKn7okXAzR45AE9wOB2U6QlRgp-M4,11486
@@ -31,14 +32,15 @@
 poe/poe_graphql/SummarizePlainPostQuery.graphql,sha256=pylPCqxrYZzP-twKldjP2SYzk5EAPcjWbA42pkNGkgo,95
 poe/poe_graphql/SummarizeQuotePostQuery.graphql,sha256=V4PQ1XkEDCsVR3z7h4SLsonZsWG7RptFd6JPwlGwOvE,147
 poe/poe_graphql/SummarizeSharePostQuery.graphql,sha256=iCN8oiUUp2jfsiBxmsTA7k3_60E0MNwA5gnNrhnYpJc,180
 poe/poe_graphql/UserSnippetFragment.graphql,sha256=Eg8rK7XM6-HqVJkpEBY0bJaYqF-FdDdWdg-Jj3VTnF0,368
 poe/poe_graphql/ViewerInfoQuery.graphql,sha256=Xtn-VGGiknKgrW81s7YfIJwhmilobrSqiCObpoJdYfw,400
 poe/poe_graphql/ViewerStateFragment.graphql,sha256=aicUJncsRpPBh_L2xqDv0aHcUIPIsDrDFPfDs3jcFoU,1038
 poe/poe_graphql/ViewerStateUpdatedSubscription.graphql,sha256=1dPs0WuOLl4ybZXm4bUF60eVc94O10EkKOtqnQYODic,657
+poe/poe_graphql/queries.json,sha256=1rCaSHvAZOFjYdpsO7yidujO9xs1sFHYEXQU2dz1Jbo,8386
 poe_graphql/AddHumanMessageMutation.graphql,sha256=Va4SoysKE2qPlJfbwoKp6mNv0vs5hnVR20g8hPvAxdY,1093
 poe_graphql/AddMessageBreakMutation.graphql,sha256=lFDgYYX0ZTHso-ZQwm-oUk-HaSTRqOmj-zIjBQRL2sM,504
 poe_graphql/AutoSubscriptionMutation.graphql,sha256=3i8EnqwUrjOcJ2Hxly-lKhwPBJdbpO99POiM_K6jVD4,180
 poe_graphql/BioFragment.graphql,sha256=3ZdXaPtuHK38bG10WFH6bvpebcyrTLu5fs-ddtfLjf0,97
 poe_graphql/ChatAddedSubscription.graphql,sha256=NFLZJAwi0V2WQea1oelyRUrtNrwOE58NOeX8ChzVE10,73
 poe_graphql/ChatFragment.graphql,sha256=NFVSvT3NdYlEquue3yTHPu9ezCIgx6k1OXJZo2ytIzU,100
 poe_graphql/ChatListPaginationQuery.graphql,sha256=WameJV_yyS6Ey_VKn7okXAzR45AE9wOB2U6QlRgp-M4,11486
@@ -67,12 +69,12 @@
 poe_graphql/SummarizeQuotePostQuery.graphql,sha256=V4PQ1XkEDCsVR3z7h4SLsonZsWG7RptFd6JPwlGwOvE,147
 poe_graphql/SummarizeSharePostQuery.graphql,sha256=iCN8oiUUp2jfsiBxmsTA7k3_60E0MNwA5gnNrhnYpJc,180
 poe_graphql/UserSnippetFragment.graphql,sha256=Eg8rK7XM6-HqVJkpEBY0bJaYqF-FdDdWdg-Jj3VTnF0,368
 poe_graphql/ViewerInfoQuery.graphql,sha256=Xtn-VGGiknKgrW81s7YfIJwhmilobrSqiCObpoJdYfw,400
 poe_graphql/ViewerStateFragment.graphql,sha256=aicUJncsRpPBh_L2xqDv0aHcUIPIsDrDFPfDs3jcFoU,1038
 poe_graphql/ViewerStateUpdatedSubscription.graphql,sha256=1dPs0WuOLl4ybZXm4bUF60eVc94O10EkKOtqnQYODic,657
 poe_graphql/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-poe_api-0.5.0.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-poe_api-0.5.0.dist-info/METADATA,sha256=wHkZamxUuL0AtJ-A2_RGbZx2FJ81OC2F91-3h6phXMY,20227
-poe_api-0.5.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-poe_api-0.5.0.dist-info/top_level.txt,sha256=8IJJSolh5PYmJVLFbOXvZqa9Bj2P7KEz-YsGylO6oGE,4
-poe_api-0.5.0.dist-info/RECORD,,
+poe_api-0.5.1.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+poe_api-0.5.1.dist-info/METADATA,sha256=IAsjypt27Ian53VkxVsLxv_Zi9ySveN8obrNjs2U3v8,20227
+poe_api-0.5.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+poe_api-0.5.1.dist-info/top_level.txt,sha256=8IJJSolh5PYmJVLFbOXvZqa9Bj2P7KEz-YsGylO6oGE,4
+poe_api-0.5.1.dist-info/RECORD,,
```

