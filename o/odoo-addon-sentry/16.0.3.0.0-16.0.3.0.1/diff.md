# Comparing `tmp/odoo_addon_sentry-16.0.3.0.0-py3-none-any.whl.zip` & `tmp/odoo_addon_sentry-16.0.3.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,29 +1,29 @@
-Zip file size: 32543 bytes, number of entries: 27
--rw-r--r--  2.0 unx    10714 b- defN 23-Jun-07 16:58 odoo/addons/sentry/README.rst
--rw-r--r--  2.0 unx       29 b- defN 23-Jun-07 16:58 odoo/addons/sentry/__init__.py
--rw-r--r--  2.0 unx      750 b- defN 23-Jun-07 16:58 odoo/addons/sentry/__manifest__.py
--rw-r--r--  2.0 unx     4310 b- defN 23-Jun-07 16:58 odoo/addons/sentry/const.py
--rw-r--r--  2.0 unx     1712 b- defN 23-Jun-07 16:58 odoo/addons/sentry/generalutils.py
--rw-r--r--  2.0 unx     4322 b- defN 23-Jun-07 16:58 odoo/addons/sentry/hooks.py
--rw-r--r--  2.0 unx     3755 b- defN 23-Jun-07 16:58 odoo/addons/sentry/logutils.py
--rw-r--r--  2.0 unx     4376 b- defN 23-Jun-07 16:58 odoo/addons/sentry/processor.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-07 16:58 odoo/addons/sentry/i18n/ca.po
--rw-r--r--  2.0 unx      341 b- defN 23-Jun-07 16:58 odoo/addons/sentry/i18n/sentry.pot
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-07 16:58 odoo/addons/sentry/i18n/zh_CN.po
--rw-r--r--  2.0 unx     5346 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      212 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx        9 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/CREDITS.rst
--rw-r--r--  2.0 unx       83 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      526 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/INSTALL.rst
--rw-r--r--  2.0 unx      704 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/ROADMAP.rst
--rw-r--r--  2.0 unx      333 b- defN 23-Jun-07 16:58 odoo/addons/sentry/readme/USAGE.rst
--rw-r--r--  2.0 unx     2220 b- defN 23-Jun-07 16:58 odoo/addons/sentry/static/description/icon.png
--rw-r--r--  2.0 unx    20903 b- defN 23-Jun-07 16:58 odoo/addons/sentry/static/description/index.html
--rw-r--r--  2.0 unx      158 b- defN 23-Jun-07 16:58 odoo/addons/sentry/tests/__init__.py
--rw-r--r--  2.0 unx     5333 b- defN 23-Jun-07 16:58 odoo/addons/sentry/tests/test_client.py
--rw-r--r--  2.0 unx     1978 b- defN 23-Jun-07 16:58 odoo/addons/sentry/tests/test_logutils.py
--rw-r--r--  2.0 unx    11314 b- defN 23-Jun-07 16:58 odoo_addon_sentry-16.0.3.0.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-07 16:58 odoo_addon_sentry-16.0.3.0.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Jun-07 16:58 odoo_addon_sentry-16.0.3.0.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2466 b- defN 23-Jun-07 16:58 odoo_addon_sentry-16.0.3.0.0.dist-info/RECORD
-27 files, 81991 bytes uncompressed, 28463 bytes compressed:  65.3%
+Zip file size: 33171 bytes, number of entries: 27
+-rw-r--r--  2.0 unx    10786 b- defN 23-Jul-31 14:29 odoo/addons/sentry/README.rst
+-rw-r--r--  2.0 unx       29 b- defN 23-Jul-31 14:29 odoo/addons/sentry/__init__.py
+-rw-r--r--  2.0 unx      750 b- defN 23-Jul-31 14:29 odoo/addons/sentry/__manifest__.py
+-rw-r--r--  2.0 unx     4310 b- defN 23-Jul-31 14:29 odoo/addons/sentry/const.py
+-rw-r--r--  2.0 unx     1712 b- defN 23-Jul-31 14:29 odoo/addons/sentry/generalutils.py
+-rw-r--r--  2.0 unx     4990 b- defN 23-Jul-31 14:29 odoo/addons/sentry/hooks.py
+-rw-r--r--  2.0 unx     3755 b- defN 23-Jul-31 14:29 odoo/addons/sentry/logutils.py
+-rw-r--r--  2.0 unx     4376 b- defN 23-Jul-31 14:29 odoo/addons/sentry/processor.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-31 14:29 odoo/addons/sentry/i18n/ca.po
+-rw-r--r--  2.0 unx      341 b- defN 23-Jul-31 14:29 odoo/addons/sentry/i18n/sentry.pot
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-31 14:29 odoo/addons/sentry/i18n/zh_CN.po
+-rw-r--r--  2.0 unx     5346 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx      284 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx        9 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/CREDITS.rst
+-rw-r--r--  2.0 unx       83 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      526 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/INSTALL.rst
+-rw-r--r--  2.0 unx      704 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx      333 b- defN 23-Jul-31 14:29 odoo/addons/sentry/readme/USAGE.rst
+-rw-r--r--  2.0 unx     2220 b- defN 23-Jul-31 14:29 odoo/addons/sentry/static/description/icon.png
+-rw-r--r--  2.0 unx    21154 b- defN 23-Jul-31 14:29 odoo/addons/sentry/static/description/index.html
+-rw-r--r--  2.0 unx      158 b- defN 23-Jul-31 14:29 odoo/addons/sentry/tests/__init__.py
+-rw-r--r--  2.0 unx     6664 b- defN 23-Jul-31 14:29 odoo/addons/sentry/tests/test_client.py
+-rw-r--r--  2.0 unx     1978 b- defN 23-Jul-31 14:29 odoo/addons/sentry/tests/test_logutils.py
+-rw-r--r--  2.0 unx    11386 b- defN 23-Jul-31 14:29 odoo_addon_sentry-16.0.3.0.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-31 14:29 odoo_addon_sentry-16.0.3.0.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jul-31 14:29 odoo_addon_sentry-16.0.3.0.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2466 b- defN 23-Jul-31 14:29 odoo_addon_sentry-16.0.3.0.1.dist-info/RECORD
+27 files, 84457 bytes uncompressed, 29091 bytes compressed:  65.6%
```

## zipnote {}

```diff
@@ -63,20 +63,20 @@
 
 Filename: odoo/addons/sentry/tests/test_client.py
 Comment: 
 
 Filename: odoo/addons/sentry/tests/test_logutils.py
 Comment: 
 
-Filename: odoo_addon_sentry-16.0.3.0.0.dist-info/METADATA
+Filename: odoo_addon_sentry-16.0.3.0.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_sentry-16.0.3.0.0.dist-info/WHEEL
+Filename: odoo_addon_sentry-16.0.3.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_sentry-16.0.3.0.0.dist-info/top_level.txt
+Filename: odoo_addon_sentry-16.0.3.0.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_sentry-16.0.3.0.0.dist-info/RECORD
+Filename: odoo_addon_sentry-16.0.3.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/sentry/README.rst

```diff
@@ -177,14 +177,16 @@
 ~~~~~~~~~~~~
 
 * Mohammed Barsi <barsintod@gmail.com>
 * Andrius Preimantas <andrius@versada.eu>
 * Naglis Jonaitis <naglis@versada.eu>
 * Atte Isopuro <atte.isopuro@avoin.systems>
 * Florian Mounier <florian.mounier@akretion.com>
+* Jon Ashton <jon@monkeyinferno.com>
+* Mark Schuit <mark@gig.solutions>
 
 Other credits
 ~~~~~~~~~~~~~
 
 * Vauxoo
 
 Maintainers
```

## odoo/addons/sentry/__manifest__.py

```diff
@@ -1,13 +1,13 @@
 # Copyright 2016-2017 Versada <https://versada.eu/>
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 {
     "name": "Sentry",
     "summary": "Report Odoo errors to Sentry",
-    "version": "16.0.3.0.0",
+    "version": "16.0.3.0.1",
     "category": "Extra Tools",
     "website": "https://github.com/OCA/server-tools",
     "author": "Mohammed Barsi,"
     "Versada,"
     "Nicolas JEUDY,"
     "Odoo Community Association (OCA),"
     "Vauxoo",
```

## odoo/addons/sentry/hooks.py

```diff
@@ -29,16 +29,34 @@
     _logger.debug(
         "Cannot import 'sentry-sdk'.\
                         Please make sure it is installed."
     )  # pragma: no cover
 
 
 def before_send(event, hint):
-    """Add context to event if include_context is True
+    """Prevent the capture of any exceptions in
+    the DEFAULT_IGNORED_EXCEPTIONS list
+        -- or --
+    Add context to event if include_context is True
     and sanitize sensitive data"""
+
+    exc_info = hint.get("exc_info")
+    if exc_info is None and "log_record" in hint:
+        # Odoo handles UserErrors by logging the raw exception rather
+        # than a message string in odoo/http.py
+        try:
+            module_name = hint["log_record"].msg.__module__
+            class_name = hint["log_record"].msg.__class__.__name__
+            qualified_name = module_name + "." + class_name
+        except AttributeError:
+            qualified_name = "not found"
+
+        if qualified_name in const.DEFAULT_IGNORED_EXCEPTIONS:
+            return None
+
     if event.setdefault("tags", {})["include_context"]:
         cxtest = get_extra_context(odoo.http.request)
         info_request = ["tags", "user", "extra", "request"]
 
         for item in info_request:
             info_item = event.setdefault(item, {})
             info_item.update(cxtest.setdefault(item, {}))
```

## odoo/addons/sentry/readme/CONTRIBUTORS.rst

```diff
@@ -1,5 +1,7 @@
 * Mohammed Barsi <barsintod@gmail.com>
 * Andrius Preimantas <andrius@versada.eu>
 * Naglis Jonaitis <naglis@versada.eu>
 * Atte Isopuro <atte.isopuro@avoin.systems>
 * Florian Mounier <florian.mounier@akretion.com>
+* Jon Ashton <jon@monkeyinferno.com>
+* Mark Schuit <mark@gig.solutions>
```

## odoo/addons/sentry/static/description/index.html

### odoo/addons/sentry/static/description/index.html

```diff
@@ -733,14 +733,24 @@
               &gt;
             </li>
             <li>
               Florian Mounier &lt;
               <a class="reference external" href="mailto:florian.mounier@akretion.com">florian.mounier@akretion.com</a>
               &gt;
             </li>
+            <li>
+              Jon Ashton &lt;
+              <a class="reference external" href="mailto:jon@monkeyinferno.com">jon@monkeyinferno.com</a>
+              &gt;
+            </li>
+            <li>
+              Mark Schuit &lt;
+              <a class="reference external" href="mailto:mark@gig.solutions">mark@gig.solutions</a>
+              &gt;
+            </li>
           </ul>
         </div>
         <div class="section" id="other-credits">
           <h2>
             <a class="toc-backref" href="#id10">Other credits</a>
           </h2>
           <ul class="simple">
```

## odoo/addons/sentry/tests/test_client.py

```diff
@@ -13,14 +13,16 @@
 from odoo.tools import config
 
 from ..hooks import initialize_sentry
 
 GIT_SHA = "d670460b4b4aece5915caf5c68d12f560a9fe3e4"
 RELEASE = "test@1.2.3"
 
+_logger = logging.getLogger(__name__)
+
 
 def remove_handler_ignore(handler_name):
     """Removes handlers of handlers ignored list."""
     _IGNORED_LOGGERS.discard(handler_name)
 
 
 class TestException(exceptions.UserError):
@@ -114,24 +116,52 @@
             raise exceptions.UserError(msg)
         except exceptions.UserError:
             exc_info = sys.exc_info()
         self.log(level, msg, exc_info)
         level = "warning"
         self.assertEventNotCaptured(client, level, msg)
 
+    def test_capture_exceptions_with_no_exc_info(self):
+        """A UserError that isn't in the DEFAULT_IGNORED_EXCEPTIONS list is captured
+        (there is no exc_info in the ValidationError exception)."""
+        client = initialize_sentry(config)._client
+        client.transport = InMemoryTransport({"dsn": self.dsn})
+        level, msg = logging.WARNING, "Test exception"
+
+        # Odoo handles UserErrors by logging the exception
+        with patch("odoo.addons.sentry.const.DEFAULT_IGNORED_EXCEPTIONS", new=[]):
+            _logger.warning(exceptions.ValidationError(msg))
+
+        level = "warning"
+        self.assertEventCaptured(client, level, msg)
+
+    def test_ignore_exceptions_with_no_exc_info(self):
+        """A UserError that is in the DEFAULT_IGNORED_EXCEPTIONS is not captured
+        (there is no exc_info in the ValidationError exception)."""
+        client = initialize_sentry(config)._client
+        client.transport = InMemoryTransport({"dsn": self.dsn})
+        level, msg = logging.WARNING, "Test exception"
+
+        # Odoo handles UserErrors by logging the exception
+        _logger.warning(exceptions.ValidationError(msg))
+
+        level = "warning"
+        self.assertEventNotCaptured(client, level, msg)
+
     def test_exclude_logger(self):
         config.options["sentry_enabled"] = True
         config.options["sentry_exclude_loggers"] = __name__
         client = initialize_sentry(config)._client
         client.transport = InMemoryTransport({"dsn": self.dsn})
         level, msg = logging.WARNING, "Test exclude logger %s" % __name__
         self.log(level, msg)
         level = "warning"
         # Revert ignored logger so it doesn't affect other tests
         remove_handler_ignore(__name__)
+        del config.options["sentry_exclude_loggers"]
         self.assertEventNotCaptured(client, level, msg)
 
     @patch("odoo.addons.sentry.hooks.get_odoo_commit", return_value=GIT_SHA)
     def test_config_odoo_dir(self, get_odoo_commit):
         config.options["sentry_odoo_dir"] = "/opt/odoo/core"
         client = initialize_sentry(config)._client
```

## Comparing `odoo_addon_sentry-16.0.3.0.0.dist-info/METADATA` & `odoo_addon_sentry-16.0.3.0.1.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-sentry
-Version: 16.0.3.0.0
+Version: 16.0.3.0.1
 Summary: Report Odoo errors to Sentry
 Home-page: https://github.com/OCA/server-tools
 Author: Mohammed Barsi,Versada,Nicolas JEUDY,Odoo Community Association (OCA),Vauxoo
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -194,14 +194,16 @@
 ~~~~~~~~~~~~
 
 * Mohammed Barsi <barsintod@gmail.com>
 * Andrius Preimantas <andrius@versada.eu>
 * Naglis Jonaitis <naglis@versada.eu>
 * Atte Isopuro <atte.isopuro@avoin.systems>
 * Florian Mounier <florian.mounier@akretion.com>
+* Jon Ashton <jon@monkeyinferno.com>
+* Mark Schuit <mark@gig.solutions>
 
 Other credits
 ~~~~~~~~~~~~~
 
 * Vauxoo
 
 Maintainers
```

## Comparing `odoo_addon_sentry-16.0.3.0.0.dist-info/RECORD` & `odoo_addon_sentry-16.0.3.0.1.dist-info/RECORD`

 * *Files 24% similar despite different names*

```diff
@@ -1,27 +1,27 @@
-odoo/addons/sentry/README.rst,sha256=u0o1JG6a-_1RjVNyVOlYo58MJTUWyWUZ1TSxk5GDLFE,10714
+odoo/addons/sentry/README.rst,sha256=QX_Y5RhHRKIyFrfbZ7kWsgro9CtM4i0eIcCsiJW2Ic0,10786
 odoo/addons/sentry/__init__.py,sha256=bmTmgWp2JegCVdiXoup5usJyplNmVjXrbBopizC1tDo,29
-odoo/addons/sentry/__manifest__.py,sha256=bEDgW1OjfgC2oiyrPXKc-m2c4OO7z74N4o4pqa3PBjY,750
+odoo/addons/sentry/__manifest__.py,sha256=YVjhLvxRFZT1eH0Nw0eWRovZSyA3B-4OyhvLyvHTK3E,750
 odoo/addons/sentry/const.py,sha256=gdbasPXVgVUhw-72SUtk41FVct7O00k2OsUSNDRlLHg,4310
 odoo/addons/sentry/generalutils.py,sha256=3_QGEhrBPG0IscaEsEfyGjEsBPDQYSpAMuUJLyJIqXI,1712
-odoo/addons/sentry/hooks.py,sha256=OUPvnJdDfAbzokPOtwOKSlcuiMRLOhJOVDq7nTAIpXg,4322
+odoo/addons/sentry/hooks.py,sha256=FmUsYOjfcxhI-XxcICR6s8OQJIiG38GPnAlg8UiBFts,4990
 odoo/addons/sentry/logutils.py,sha256=6_uCR12gjuHP7O8BFHHfacdeABpXIhazPQLh2XAMR58,3755
 odoo/addons/sentry/processor.py,sha256=afqLb7a2hrAMPs9zK0j8neyyOSGg2PfBUAabjvykb_8,4376
 odoo/addons/sentry/i18n/ca.po,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 odoo/addons/sentry/i18n/sentry.pot,sha256=leB6MlaWiU1sPOdcOTxNVY5KVORnHv0MfD14HgQJIIs,341
 odoo/addons/sentry/i18n/zh_CN.po,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 odoo/addons/sentry/readme/CONFIGURE.rst,sha256=FD49rXNBEOIn5QQbkUB8-Ki9Lzp7B8rOHLvl0bifXOA,5346
-odoo/addons/sentry/readme/CONTRIBUTORS.rst,sha256=FlQBB1gtcjQVLXPzU0e-HQoqrfW2nydZys9a9bn-qIo,212
+odoo/addons/sentry/readme/CONTRIBUTORS.rst,sha256=kSYB0Osx6JU2e3t_JBOyg033yuEVlb1_XXACLAeSHxQ,284
 odoo/addons/sentry/readme/CREDITS.rst,sha256=FSsi_Gyms8SHEF5ldjzTARhHiU1yZr8pmZLeG1pZq-c,9
 odoo/addons/sentry/readme/DESCRIPTION.rst,sha256=8fMrrgCYbpXvjRkGbl80_EWXGyNg2b3rR63lZuvgBAo,83
 odoo/addons/sentry/readme/INSTALL.rst,sha256=Xnz3UyaP0VukB6Dp-bOM_phxlHBrJ8A5YbwOa1eOvOI,526
 odoo/addons/sentry/readme/ROADMAP.rst,sha256=zsKXlHssfuMQ19kp9qkvCSO5YMN6WIqWb4H089d5YKA,704
 odoo/addons/sentry/readme/USAGE.rst,sha256=PmpuM-7sM2Y58nkeurQhYf8JpmLnAbyVMqcJNtxepoU,333
 odoo/addons/sentry/static/description/icon.png,sha256=Rnw-3miThiaAtUNl1DNsLjt20f_lhgI0aHyQVx_Paok,2220
-odoo/addons/sentry/static/description/index.html,sha256=31OyhaM9A5BzFIzzH6mFjv6kuc0d7emhC7Hh9weMDmg,20903
+odoo/addons/sentry/static/description/index.html,sha256=ebl4mqfkd0vUJ2mfbNQcO1-AcpABu3R12Gjg293dqOY,21154
 odoo/addons/sentry/tests/__init__.py,sha256=XRFrqetdxElZsRxWhikezH4GDB1Z9brXMfTsOElgQeY,158
-odoo/addons/sentry/tests/test_client.py,sha256=sYhblicb7ZyrnPzVuO3vr3YLzUnlmWR0tNxL97HCoSQ,5333
+odoo/addons/sentry/tests/test_client.py,sha256=5HDbwy5WD2JuAhiDl5CFT2enMPySvFxj1y7F2Q2vjBw,6664
 odoo/addons/sentry/tests/test_logutils.py,sha256=nUPQZ_HjGHIPc6lEXKGXxGPnJhhQl0OKMH24w0uNIC0,1978
-odoo_addon_sentry-16.0.3.0.0.dist-info/METADATA,sha256=7Io1Hkfcd6ST0yBJjKI2uJ9c8X3BudxfEHKwOHwwMIo,11314
-odoo_addon_sentry-16.0.3.0.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo_addon_sentry-16.0.3.0.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_sentry-16.0.3.0.0.dist-info/RECORD,,
+odoo_addon_sentry-16.0.3.0.1.dist-info/METADATA,sha256=rxuYq6IcZJ05fay982N23OrczvpKkmGeSv1yr5NOGuA,11386
+odoo_addon_sentry-16.0.3.0.1.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
+odoo_addon_sentry-16.0.3.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_sentry-16.0.3.0.1.dist-info/RECORD,,
```

