# Comparing `tmp/snowflake-snowpark-python-1.5.1.tar.gz` & `tmp/snowflake-snowpark-python-1.6.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "snowflake-snowpark-python-1.5.1.tar", last modified: Wed Jun 21 18:14:55 2023, max compression
+gzip compressed data, was "snowflake-snowpark-python-1.6.0.tar", last modified: Mon Jul 31 21:45:31 2023, max compression
```

## Comparing `snowflake-snowpark-python-1.5.1.tar` & `snowflake-snowpark-python-1.6.0.tar`

### file list

```diff
@@ -1,73 +1,75 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.864706 snowflake-snowpark-python-1.5.1/
--rw-r--r--   0 runner    (1001) docker     (123)    31093 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/CHANGELOG.md
--rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)      242 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)    37741 2023-06-21 18:14:55.864706 snowflake-snowpark-python-1.5.1/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     4761 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/README.md
--rw-r--r--   0 runner    (1001) docker     (123)       38 2023-06-21 18:14:55.864706 snowflake-snowpark-python-1.5.1/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     3968 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.852706 snowflake-snowpark-python-1.5.1/src/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.852706 snowflake-snowpark-python-1.5.1/src/snowflake/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.856706 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/
--rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.860706 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.864706 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    38350 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/analyzer.py
--rw-r--r--   0 runner    (1001) docker     (123)    35327 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     6427 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
--rw-r--r--   0 runner    (1001) docker     (123)    11336 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/expression.py
--rw-r--r--   0 runner    (1001) docker     (123)      986 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
--rw-r--r--   0 runner    (1001) docker     (123)     3550 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    42766 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/select_statement.py
--rw-r--r--   0 runner    (1001) docker     (123)    40138 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
--rw-r--r--   0 runner    (1001) docker     (123)     4591 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3441 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3152 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/window_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)    26737 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/code_generation.py
--rw-r--r--   0 runner    (1001) docker     (123)    16330 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/error_message.py
--rw-r--r--   0 runner    (1001) docker     (123)    26038 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/server_connection.py
--rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/telemetry.py
--rw-r--r--   0 runner    (1001) docker     (123)    21752 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/type_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    27689 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/udf_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    26286 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    16167 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/async_job.py
--rw-r--r--   0 runner    (1001) docker     (123)    34333 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/column.py
--rw-r--r--   0 runner    (1001) docker     (123)      550 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/context.py
--rw-r--r--   0 runner    (1001) docker     (123)   150984 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    23490 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_na_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    28130 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_reader.py
--rw-r--r--   0 runner    (1001) docker     (123)    11143 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_stat_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    14687 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_writer.py
--rw-r--r--   0 runner    (1001) docker     (123)     6357 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/exceptions.py
--rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/file_operation.py
--rw-r--r--   0 runner    (1001) docker     (123)     8301 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/files.py
--rw-r--r--   0 runner    (1001) docker     (123)   269192 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/functions.py
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/py.typed
--rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/query_history.py
--rw-r--r--   0 runner    (1001) docker     (123)    12315 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/relational_grouped_dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    12095 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/row.py
--rw-r--r--   0 runner    (1001) docker     (123)    93056 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/session.py
--rw-r--r--   0 runner    (1001) docker     (123)    39467 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/stored_procedure.py
--rw-r--r--   0 runner    (1001) docker     (123)    29592 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/table.py
--rw-r--r--   0 runner    (1001) docker     (123)    11516 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)    12753 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/types.py
--rw-r--r--   0 runner    (1001) docker     (123)    45807 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/udf.py
--rw-r--r--   0 runner    (1001) docker     (123)    35699 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/udtf.py
--rw-r--r--   0 runner    (1001) docker     (123)      151 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/version.py
--rw-r--r--   0 runner    (1001) docker     (123)     9486 2023-06-21 18:14:44.000000 snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/window.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-21 18:14:55.864706 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)    37741 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     2876 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (123)      341 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-06-21 18:14:55.000000 snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.172767 snowflake-snowpark-python-1.6.0/
+-rw-r--r--   0 runner    (1001) docker     (123)    33356 2023-07-31 21:45:19.000000 snowflake-snowpark-python-1.6.0/CHANGELOG.md
+-rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-07-31 21:45:19.000000 snowflake-snowpark-python-1.6.0/LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      242 2023-07-31 21:45:19.000000 snowflake-snowpark-python-1.6.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)    40004 2023-07-31 21:45:31.172767 snowflake-snowpark-python-1.6.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     4761 2023-07-31 21:45:19.000000 snowflake-snowpark-python-1.6.0/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-07-31 21:45:31.172767 snowflake-snowpark-python-1.6.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     3941 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.164767 snowflake-snowpark-python-1.6.0/src/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.164767 snowflake-snowpark-python-1.6.0/src/snowflake/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.168767 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/
+-rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.168767 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.172767 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    38812 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py
+-rw-r--r--   0 runner    (1001) docker     (123)    36373 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7168 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11336 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)      986 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3550 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    43127 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py
+-rw-r--r--   0 runner    (1001) docker     (123)    41482 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4591 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3441 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3365 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26737 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/code_generation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16330 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/error_message.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22116 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/packaging_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25879 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/server_connection.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/telemetry.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23433 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/type_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    40565 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/udf_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27196 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17181 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/async_job.py
+-rw-r--r--   0 runner    (1001) docker     (123)    34396 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/column.py
+-rw-r--r--   0 runner    (1001) docker     (123)      550 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/context.py
+-rw-r--r--   0 runner    (1001) docker     (123)   155080 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23490 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_na_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31616 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_reader.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11159 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_stat_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14803 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_writer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6357 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/exceptions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/file_operation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8301 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/files.py
+-rw-r--r--   0 runner    (1001) docker     (123)   291315 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/py.typed
+-rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/query_history.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12346 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/relational_grouped_dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12095 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/row.py
+-rw-r--r--   0 runner    (1001) docker     (123)   113249 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/session.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39808 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/stored_procedure.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29974 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/table.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11550 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14550 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31358 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/udaf.py
+-rw-r--r--   0 runner    (1001) docker     (123)    46552 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/udf.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39832 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/udtf.py
+-rw-r--r--   0 runner    (1001) docker     (123)      151 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/version.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9486 2023-07-31 21:45:20.000000 snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/window.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-31 21:45:31.172767 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)    40004 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     2959 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-07-31 21:45:30.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (123)      313 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-07-31 21:45:31.000000 snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/top_level.txt
```

### Comparing `snowflake-snowpark-python-1.5.1/CHANGELOG.md` & `snowflake-snowpark-python-1.6.0/CHANGELOG.md`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,51 @@
 # Release History
 
+## 1.6.0 (2023-07-28)
+
+### New Features
+
+- Added support for these new functions in `snowflake.snowpark.functions`:
+  - `array_sort`
+  - `sort_array`
+  - `array_min`
+  - `array_max`
+  - `explode_outer`
+- Added support for pure Python packages specified via `Session.add_requirements` or `Session.add_packages`. They are now usable in stored procedures and UDFs even if packages are not present on the Snowflake Anaconda channel.
+  - Added Session parameter `custom_packages_upload_enabled` and `custom_packages_force_upload_enabled` to enable the support for pure Python packages feature mentioned above. Both parameters default to `False`.
+- Added support for specifying package requirements by passing a Conda environment yaml file to `Session.add_requirements`.
+- Added support for asynchronous execution of multi-query dataframes that contain binding variables.
+- Added support for renaming multiple columns in `DataFrame.rename`.
+- Added support for Geometry datatypes.
+- Added support for `params` in `session.sql()` in stored procedures.
+- Added support for user-defined aggregate functions (UDAFs). This feature is currently in private preview.
+- Added support for vectorized UDTFs (user-defined table functions). This feature is currently in public preview.
+- Added support for Snowflake Timestamp variants (i.e., `TIMESTAMP_NTZ`, `TIMESTAMP_LTZ`, `TIMESTAMP_TZ`)
+  - Added `TimestampTimezone` as an argument in `TimestampType` constructor.
+  - Added type hints `NTZ`, `LTZ`, `TZ` and `Timestamp` to annotate functions when registering UDFs.
+
+### Improvements
+
+- Removed redundant dependency `typing-extensions`.
+- `DataFrame.cache_result` now creates temp table fully qualified names under current database and current schema.
+
+### Bug Fixes
+
+- Fixed a bug where type check happens on pandas before it is imported.
+- Fixed a bug when creating a UDF from `numpy.ufunc`.
+- Fixed a bug where `DataFrame.union` was not generating the correct `Selectable.schema_query` when SQL simplifier is enabled.
+
+### Behavior Changes
+
+- `DataFrameWriter.save_as_table` now respects the `nullable` field of the schema provided by the user or the inferred schema based on data from user input.
+
+### Dependency updates
+
+- Updated ``snowflake-connector-python`` to 3.0.4.
+
 ## 1.5.1 (2023-06-20)
 
 ### New Features
 
 - Added support for the Python 3.10 runtime environment.
 
 ## 1.5.0 (2023-06-09)
```

### Comparing `snowflake-snowpark-python-1.5.1/LICENSE.txt` & `snowflake-snowpark-python-1.6.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/PKG-INFO` & `snowflake-snowpark-python-1.6.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.5.1
+Version: 1.6.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -132,14 +132,56 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.6.0 (2023-07-28)
+
+### New Features
+
+- Added support for these new functions in `snowflake.snowpark.functions`:
+  - `array_sort`
+  - `sort_array`
+  - `array_min`
+  - `array_max`
+  - `explode_outer`
+- Added support for pure Python packages specified via `Session.add_requirements` or `Session.add_packages`. They are now usable in stored procedures and UDFs even if packages are not present on the Snowflake Anaconda channel.
+  - Added Session parameter `custom_packages_upload_enabled` and `custom_packages_force_upload_enabled` to enable the support for pure Python packages feature mentioned above. Both parameters default to `False`.
+- Added support for specifying package requirements by passing a Conda environment yaml file to `Session.add_requirements`.
+- Added support for asynchronous execution of multi-query dataframes that contain binding variables.
+- Added support for renaming multiple columns in `DataFrame.rename`.
+- Added support for Geometry datatypes.
+- Added support for `params` in `session.sql()` in stored procedures.
+- Added support for user-defined aggregate functions (UDAFs). This feature is currently in private preview.
+- Added support for vectorized UDTFs (user-defined table functions). This feature is currently in public preview.
+- Added support for Snowflake Timestamp variants (i.e., `TIMESTAMP_NTZ`, `TIMESTAMP_LTZ`, `TIMESTAMP_TZ`)
+  - Added `TimestampTimezone` as an argument in `TimestampType` constructor.
+  - Added type hints `NTZ`, `LTZ`, `TZ` and `Timestamp` to annotate functions when registering UDFs.
+
+### Improvements
+
+- Removed redundant dependency `typing-extensions`.
+- `DataFrame.cache_result` now creates temp table fully qualified names under current database and current schema.
+
+### Bug Fixes
+
+- Fixed a bug where type check happens on pandas before it is imported.
+- Fixed a bug when creating a UDF from `numpy.ufunc`.
+- Fixed a bug where `DataFrame.union` was not generating the correct `Selectable.schema_query` when SQL simplifier is enabled.
+
+### Behavior Changes
+
+- `DataFrameWriter.save_as_table` now respects the `nullable` field of the schema provided by the user or the inferred schema based on data from user input.
+
+### Dependency updates
+
+- Updated ``snowflake-connector-python`` to 3.0.4.
+
 ## 1.5.1 (2023-06-20)
 
 ### New Features
 
 - Added support for the Python 3.10 runtime environment.
 
 ## 1.5.0 (2023-06-09)
```

### Comparing `snowflake-snowpark-python-1.5.1/README.md` & `snowflake-snowpark-python-1.6.0/README.md`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/setup.py` & `snowflake-snowpark-python-1.6.0/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -6,15 +6,15 @@
 from codecs import open
 
 from setuptools import setup
 
 THIS_DIR = os.path.dirname(os.path.realpath(__file__))
 SRC_DIR = os.path.join(THIS_DIR, "src")
 SNOWPARK_SRC_DIR = os.path.join(SRC_DIR, "snowflake", "snowpark")
-CONNECTOR_DEPENDENCY_VERSION = ">=2.7.12, <4.0.0"
+CONNECTOR_DEPENDENCY_VERSION = ">=3.0.4, <4.0.0"
 REQUIRED_PYTHON_VERSION = ">=3.8, <3.11"
 if os.getenv("SNOWFLAKE_IS_PYTHON_RUNTIME_TEST", False):
     REQUIRED_PYTHON_VERSION = ">=3.8"
 
 # read the version
 VERSION = ()
 with open(os.path.join(SNOWPARK_SRC_DIR, "version.py"), encoding="utf-8") as f:
@@ -47,15 +47,15 @@
     },
     python_requires=REQUIRED_PYTHON_VERSION,
     install_requires=[
         "setuptools>=40.6.0",
         "wheel",
         "cloudpickle>=1.6.0,<=2.0.0",
         f"snowflake-connector-python{CONNECTOR_DEPENDENCY_VERSION}",
-        "typing-extensions>=4.1.0, <5.0.0",
+        "pyyaml",
     ],
     namespace_packages=["snowflake"],
     # When a new package (directory) is added, we should also add it here
     packages=[
         "snowflake.snowpark",
         "snowflake.snowpark._internal",
         "snowflake.snowpark._internal.analyzer",
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/__init__.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/__init__.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/analyzer.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,14 +25,15 @@
     list_agg,
     named_arguments_function,
     order_expression,
     quote_name,
     range_statement,
     rank_related_function_expression,
     regexp_expression,
+    schema_query_for_values_statement,
     specified_window_frame_expression,
     subfield_expression,
     subquery_expression,
     table_function_partition_spec,
     unary_expression,
     update_merge_statement,
     values_statement,
@@ -122,14 +123,15 @@
     CreateDynamicTableCommand,
     CreateViewCommand,
     Filter,
     LocalTempView,
     PersistedView,
     Pivot,
     Project,
+    Rename,
     Sample,
     Sort,
     Unpivot,
 )
 from snowflake.snowpark._internal.analyzer.window_expression import (
     RankRelatedFunctionExpression,
     SpecialFrameBoundary,
@@ -862,31 +864,34 @@
                 range_statement(
                     logical_plan.start, logical_plan.end, logical_plan.step, "id"
                 ),
                 logical_plan,
             )
 
         if isinstance(logical_plan, SnowflakeValues):
+            schema_query = schema_query_for_values_statement(logical_plan.output)
             if logical_plan.data:
                 if (
                     len(logical_plan.output) * len(logical_plan.data)
                     < ARRAY_BIND_THRESHOLD
                 ):
                     return self.plan_builder.query(
                         values_statement(logical_plan.output, logical_plan.data),
                         logical_plan,
+                        schema_query=schema_query,
                     )
                 else:
                     return self.plan_builder.large_local_relation_plan(
                         logical_plan.output, logical_plan.data, logical_plan
                     )
             else:
                 return self.plan_builder.query(
                     empty_values_statement(logical_plan.output),
                     logical_plan,
+                    schema_query=schema_query,
                 )
 
         if isinstance(logical_plan, UnresolvedRelation):
             return self.plan_builder.table(logical_plan.name)
 
         if isinstance(logical_plan, SnowflakeCreateTable):
             return self.plan_builder.save_as_table(
@@ -937,14 +942,21 @@
                     self.analyze(c, df_aliased_col_name_to_real_col_name)
                     for c in logical_plan.column_list
                 ],
                 resolved_children[logical_plan.child],
                 logical_plan,
             )
 
+        if isinstance(logical_plan, Rename):
+            return self.plan_builder.rename(
+                logical_plan.column_map,
+                resolved_children[logical_plan.child],
+                logical_plan,
+            )
+
         if isinstance(logical_plan, CreateViewCommand):
             if isinstance(logical_plan.view_type, PersistedView):
                 is_temp = False
             elif isinstance(logical_plan.view_type, LocalTempView):
                 is_temp = True
             else:
                 raise SnowparkClientExceptionMessages.PLAN_ANALYZER_UNSUPPORTED_VIEW_TYPE(
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,14 +24,15 @@
 from snowflake.snowpark._internal.analyzer.expression import Attribute
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.type_utils import convert_sp_to_sf_type
 from snowflake.snowpark._internal.utils import (
     TempObjectType,
     get_temp_type_for_object,
     is_single_quoted,
+    is_sql_select_statement,
     random_name_for_temp_object,
 )
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.types import DataType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
@@ -146,16 +147,18 @@
 MERGE = " MERGE "
 MATCHED = " MATCHED "
 LISTAGG = " LISTAGG "
 HEADER = " HEADER "
 IGNORE_NULLS = " IGNORE NULLS "
 UNION = " UNION "
 UNION_ALL = " UNION ALL "
+RENAME = " RENAME "
 INTERSECT = f" {Intersect.sql} "
 EXCEPT = f" {Except.sql} "
+NOT_NULL = " NOT NULL "
 
 TEMPORARY_STRING_SET = frozenset(["temporary", "temp"])
 
 
 def result_scan_statement(uuid_place_holder: str) -> str:
     return (
         SELECT
@@ -446,14 +449,29 @@
             + AS
             + column_name
         ],
         table(generator(0 if count < 0 else count)),
     )
 
 
+def schema_query_for_values_statement(output: List[Attribute]) -> str:
+    cells = [schema_expression(attr.datatype, attr.nullable) for attr in output]
+
+    query = (
+        SELECT
+        + COMMA.join([f"{DOLLAR}{i+1}{AS}{attr.name}" for i, attr in enumerate(output)])
+        + FROM
+        + VALUES
+        + LEFT_PARENTHESIS
+        + COMMA.join(cells)
+        + RIGHT_PARENTHESIS
+    )
+    return query
+
+
 def values_statement(output: List[Attribute], data: List[Row]) -> str:
     data_types = [attr.datatype for attr in output]
     names = [quote_name(attr.name) for attr in output]
     rows = []
     for row in data:
         cells = [
             to_sql(value, data_type, from_values_statement=True)
@@ -643,14 +661,16 @@
     )
 
 
 def insert_into_statement(
     table_name: str, child: str, column_names: Optional[Iterable[str]] = None
 ) -> str:
     table_columns = f"({COMMA.join(column_names)})" if column_names else EMPTY_STRING
+    if is_sql_select_statement(child):
+        return f"{INSERT}{INTO}{table_name}{table_columns}{SPACE}{child}"
     return f"{INSERT}{INTO}{table_name}{table_columns}{project_statement([], child)}"
 
 
 def batch_insert_into_statement(table_name: str, column_names: List[str]) -> str:
     return (
         f"{INSERT}{INTO}{table_name}"
         f"{LEFT_PARENTHESIS}{COMMA.join(column_names)}{RIGHT_PARENTHESIS}"
@@ -948,14 +968,29 @@
         + LEFT_PARENTHESIS
         + COMMA.join(column_list)
         + RIGHT_PARENTHESIS
         + RIGHT_PARENTHESIS
     )
 
 
+def rename_statement(column_map: Dict[str, str], child: str) -> str:
+    return (
+        SELECT
+        + STAR
+        + RENAME
+        + LEFT_PARENTHESIS
+        + COMMA.join([f"{before}{AS}{after}" for before, after in column_map.items()])
+        + RIGHT_PARENTHESIS
+        + FROM
+        + LEFT_PARENTHESIS
+        + child
+        + RIGHT_PARENTHESIS
+    )
+
+
 def copy_into_table(
     table_name: str,
     file_path: str,
     file_format_type: str,
     format_type_options: Dict[str, Any],
     copy_options: Dict[str, Any],
     pattern: str,
@@ -1207,15 +1242,19 @@
 
 def drop_table_if_exists_statement(table_name: str) -> str:
     return DROP + TABLE + IF + EXISTS + table_name
 
 
 def attribute_to_schema_string(attributes: List[Attribute]) -> str:
     return COMMA.join(
-        attr.name + SPACE + convert_sp_to_sf_type(attr.datatype) for attr in attributes
+        attr.name
+        + SPACE
+        + convert_sp_to_sf_type(attr.datatype)
+        + (NOT_NULL if not attr.nullable else EMPTY_STRING)
+        for attr in attributes
     )
 
 
 def schema_value_statement(output: List[Attribute]) -> str:
     return SELECT + COMMA.join(
         [
             schema_expression(attr.datatype, attr.nullable) + AS + quote_name(attr.name)
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/binary_expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py`

 * *Files 7% similar despite different names*

```diff
@@ -17,18 +17,20 @@
     ArrayType,
     BinaryType,
     BooleanType,
     DataType,
     DateType,
     DecimalType,
     GeographyType,
+    GeometryType,
     MapType,
     NullType,
     StringType,
     StructType,
+    TimestampTimeZone,
     TimestampType,
     TimeType,
     VariantType,
     _FractionalType,
     _IntegralType,
     _NumericType,
 )
@@ -44,15 +46,15 @@
 
 def to_sql(value: Any, datatype: DataType, from_values_statement: bool = False) -> str:
     """Convert a value with DataType to a snowflake compatible sql"""
 
     # Handle null values
     if isinstance(
         datatype,
-        (NullType, ArrayType, MapType, StructType, GeographyType),
+        (NullType, ArrayType, MapType, StructType, GeographyType, GeometryType),
     ):
         if value is None:
             return "NULL"
     if isinstance(datatype, BinaryType):
         if value is None:
             return "NULL :: BINARY"
     if isinstance(datatype, _IntegralType):
@@ -106,24 +108,28 @@
             # add value as number of days to 1970-01-01
             target_date = date(1970, 1, 1) + timedelta(days=value)
             return f"DATE '{target_date.isoformat()}'"
         elif isinstance(value, date):
             return f"DATE '{value.isoformat()}'"
 
     if isinstance(datatype, TimestampType):
-        if isinstance(value, int):
-            # add value as microseconds to 1970-01-01 00:00:00.00.
-            target_time = datetime(1970, 1, 1, tzinfo=timezone.utc) + timedelta(
-                microseconds=value
-            )
-            trimmed_ms = target_time.strftime("%Y-%m-%d %H:%M:%S.%f")[:-3]
-            return f"TIMESTAMP '{trimmed_ms}'"
-        elif isinstance(value, datetime):
-            trimmed_ms = value.strftime("%Y-%m-%d %H:%M:%S.%f")[:-3]
-            return f"TIMESTAMP '{trimmed_ms}'"
+        if isinstance(value, (int, datetime)):
+            if isinstance(value, int):
+                # add value as microseconds to 1970-01-01 00:00:00.00.
+                value = datetime(1970, 1, 1, tzinfo=timezone.utc) + timedelta(
+                    microseconds=value
+                )
+            if datatype.tz == TimestampTimeZone.NTZ:
+                return f"'{value}'::TIMESTAMP_NTZ"
+            elif datatype.tz == TimestampTimeZone.LTZ:
+                return f"'{value}'::TIMESTAMP_LTZ"
+            elif datatype.tz == TimestampTimeZone.TZ:
+                return f"'{value}'::TIMESTAMP_TZ"
+            else:
+                return f"TIMESTAMP '{value}'"
 
     if isinstance(datatype, TimeType):
         if isinstance(value, time):
             trimmed_ms = value.strftime("%H:%M:%S.%f")[:-3]
             return f"TIME('{trimmed_ms}')"
 
     if isinstance(value, (list, bytes, bytearray)) and isinstance(datatype, BinaryType):
@@ -138,44 +144,55 @@
     raise TypeError(f"Unsupported datatype {datatype}, value {value} by to_sql()")
 
 
 def schema_expression(data_type: DataType, is_nullable: bool) -> str:
     if is_nullable:
         if isinstance(data_type, GeographyType):
             return "TRY_TO_GEOGRAPHY(NULL)"
+        if isinstance(data_type, GeometryType):
+            return "TRY_TO_GEOMETRY(NULL)"
         if isinstance(data_type, ArrayType):
             return "PARSE_JSON('NULL') :: ARRAY"
         if isinstance(data_type, MapType):
             return "PARSE_JSON('NULL') :: OBJECT"
         if isinstance(data_type, VariantType):
             return "PARSE_JSON('NULL') :: VARIANT"
         return "NULL :: " + convert_sp_to_sf_type(data_type)
 
     if isinstance(data_type, _NumericType):
         return "0 :: " + convert_sp_to_sf_type(data_type)
     if isinstance(data_type, StringType):
         return f"'a' :: {analyzer_utils.string(data_type.length)}"
     if isinstance(data_type, BinaryType):
-        return "to_binary(hex_encode(1))"
+        return "'01' :: BINARY"
     if isinstance(data_type, DateType):
         return "date('2020-9-16')"
     if isinstance(data_type, BooleanType):
         return "true"
     if isinstance(data_type, TimeType):
         return "to_time('04:15:29.999')"
     if isinstance(data_type, TimestampType):
-        return "to_timestamp_ntz('2020-09-16 06:30:00')"
+        if data_type.tz == TimestampTimeZone.NTZ:
+            return "to_timestamp_ntz('2020-09-16 06:30:00')"
+        elif data_type.tz == TimestampTimeZone.LTZ:
+            return "to_timestamp_ltz('2020-09-16 06:30:00')"
+        elif data_type.tz == TimestampTimeZone.TZ:
+            return "to_timestamp_tz('2020-09-16 06:30:00')"
+        else:
+            return "to_timestamp('2020-09-16 06:30:00')"
     if isinstance(data_type, ArrayType):
         return "to_array(0)"
     if isinstance(data_type, MapType):
         return "to_object(parse_json('0'))"
     if isinstance(data_type, VariantType):
         return "to_variant(0)"
     if isinstance(data_type, GeographyType):
         return "to_geography('POINT(-122.35 37.55)')"
+    if isinstance(data_type, GeometryType):
+        return "to_geometry('POINT(-122.35 37.55)')"
     raise Exception(f"Unsupported data type: {data_type.__class__.__name__}")
 
 
 def to_sql_without_cast(value: Any, datatype: DataType) -> str:
     if value is None:
         return "NULL"
     if isinstance(datatype, StringType):
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/grouping_set.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/schema_utils.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/select_statement.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py`

 * *Files 1% similar despite different names*

```diff
@@ -28,15 +28,18 @@
     from snowflake.snowpark._internal.analyzer.analyzer import (
         Analyzer,
     )  # pragma: no cover
 
 import sys
 
 from snowflake.snowpark._internal.analyzer import analyzer_utils
-from snowflake.snowpark._internal.analyzer.analyzer_utils import result_scan_statement
+from snowflake.snowpark._internal.analyzer.analyzer_utils import (
+    result_scan_statement,
+    schema_value_statement,
+)
 from snowflake.snowpark._internal.analyzer.binary_expression import And
 from snowflake.snowpark._internal.analyzer.expression import (
     COLUMN_DEPENDENCY_ALL,
     COLUMN_DEPENDENCY_DOLLAR,
     COLUMN_DEPENDENCY_EMPTY,
     Attribute,
     Expression,
@@ -808,15 +811,20 @@
             sql = f"{sql}{self.set_operands[i].operator}({self.set_operands[i].selectable.sql_query})"
         return sql
 
     @property
     def schema_query(self) -> str:
         """The first operand decide the column attributes of a query with set operations.
         Refer to https://docs.snowflake.com/en/sql-reference/operators-query.html#general-usage-notes"""
-        return self.set_operands[0].selectable.schema_query
+        attributes = self.set_operands[0].selectable.snowflake_plan.attributes
+        sql = f"({schema_value_statement(attributes)})"
+        for i in range(1, len(self.set_operands)):
+            attributes = self.set_operands[i].selectable.snowflake_plan.attributes
+            sql = f"{sql}{self.set_operands[i].operator}({schema_value_statement(attributes)})"
+        return sql
 
     @property
     def column_states(self) -> Optional[ColumnStateDict]:
         if not self._column_states:
             self._column_states = initiate_column_states(
                 self.set_operands[0].selectable.column_states.projection,
                 self.analyzer,
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py`

 * *Files 3% similar despite different names*

```diff
@@ -49,14 +49,15 @@
     join_statement,
     join_table_function_statement,
     lateral_statement,
     limit_statement,
     merge_statement,
     pivot_statement,
     project_statement,
+    rename_statement,
     result_scan_statement,
     sample_statement,
     schema_cast_named,
     schema_cast_seq,
     schema_value_statement,
     select_from_path_with_format_statement,
     set_operator_statement,
@@ -406,18 +407,19 @@
 
     def query(
         self,
         sql: str,
         source_plan: Optional[LogicalPlan],
         api_calls: Optional[List[Dict]] = None,
         params: Optional[Sequence[Any]] = None,
+        schema_query: Optional[str] = None,
     ) -> SnowflakePlan:
         return SnowflakePlan(
             queries=[Query(sql, params=params)],
-            schema_query=sql,
+            schema_query=schema_query or sql,
             session=self.session,
             source_plan=source_plan,
             api_calls=api_calls,
         )
 
     def large_local_relation_plan(
         self,
@@ -556,77 +558,76 @@
         table_name: Iterable[str],
         column_names: Optional[Iterable[str]],
         mode: SaveMode,
         table_type: str,
         child: SnowflakePlan,
     ) -> SnowflakePlan:
         full_table_name = ".".join(table_name)
+
+        def get_create_and_insert_plan(child: SnowflakePlan, replace=False, error=True):
+            create_table = create_table_statement(
+                full_table_name,
+                attribute_to_schema_string(child.attributes),
+                replace=replace,
+                error=error,
+                table_type=table_type,
+            )
+
+            # so that dataframes created from non-select statements,
+            # such as table sprocs, work
+            child = self.add_result_scan_if_not_select(child)
+            return SnowflakePlan(
+                [
+                    *child.queries[0:-1],
+                    Query(create_table),
+                    Query(
+                        insert_into_statement(
+                            table_name=full_table_name,
+                            child=child.queries[-1].sql,
+                            column_names=column_names,
+                        ),
+                        params=child.queries[-1].params,
+                    ),
+                ],
+                create_table,
+                child.post_actions,
+                {},
+                self.session,
+                None,
+                api_calls=child.api_calls,
+            )
+
         if mode == SaveMode.APPEND:
             if self.session._table_exists(table_name):
                 return self.build(
                     lambda x: insert_into_statement(
                         table_name=full_table_name,
                         child=x,
                         column_names=column_names,
                     ),
                     child,
                     None,
                 )
             else:
-                create_table = create_table_statement(
-                    full_table_name,
-                    attribute_to_schema_string(child.attributes),
-                    error=False,
-                    table_type=table_type,
-                )
-
-                return SnowflakePlan(
-                    [
-                        *child.queries[0:-1],
-                        Query(create_table),
-                        Query(
-                            insert_into_statement(
-                                table_name=full_table_name,
-                                child=child.queries[-1].sql,
-                                column_names=column_names,
-                            ),
-                            params=child.queries[-1].params,
-                        ),
-                    ],
-                    create_table,
-                    child.post_actions,
-                    {},
-                    self.session,
-                    None,
-                    api_calls=child.api_calls,
-                )
+                return get_create_and_insert_plan(child, replace=False, error=False)
         elif mode == SaveMode.OVERWRITE:
-            return self.build(
-                lambda x: create_table_as_select_statement(
-                    full_table_name, x, replace=True, table_type=table_type
-                ),
-                child,
-                None,
-            )
+            return get_create_and_insert_plan(child, replace=True)
         elif mode == SaveMode.IGNORE:
-            return self.build(
-                lambda x: create_table_as_select_statement(
-                    full_table_name, x, error=False, table_type=table_type
-                ),
-                child,
-                None,
-            )
+            if self.session._table_exists(table_name):
+                return self.build(
+                    lambda x: create_table_as_select_statement(
+                        full_table_name, x, error=False, table_type=table_type
+                    ),
+                    child,
+                    None,
+                )
+            else:
+                return get_create_and_insert_plan(child, replace=False, error=False)
         elif mode == SaveMode.ERROR_IF_EXISTS:
-            return self.build(
-                lambda x: create_table_as_select_statement(
-                    full_table_name, x, table_type=table_type
-                ),
-                child,
-                None,
-            )
+            return get_create_and_insert_plan(child, replace=False, error=True)
 
     def limit(
         self,
         limit_expr: str,
         offset_expr: str,
         child: SnowflakePlan,
         on_top_of_oder_by: bool,
@@ -662,14 +663,26 @@
     ) -> SnowflakePlan:
         return self.build(
             lambda x: unpivot_statement(value_column, name_column, column_list, x),
             child,
             source_plan,
         )
 
+    def rename(
+        self,
+        column_map: Dict[str, str],
+        child: SnowflakePlan,
+        source_plan: Optional[LogicalPlan],
+    ) -> SnowflakePlan:
+        return self.build(
+            lambda x: rename_statement(column_map, x),
+            child,
+            source_plan,
+        )
+
     def create_or_replace_view(
         self, name: str, child: SnowflakePlan, is_temp: bool
     ) -> SnowflakePlan:
         if len(child.queries) != 1:
             raise SnowparkClientExceptionMessages.PLAN_CREATE_VIEW_FROM_DDL_DML_OPERATIONS()
 
         if not is_sql_select_statement(child.queries[0].sql.lower().strip()):
@@ -764,23 +777,34 @@
         schema_to_cast: Optional[List[Tuple[str, str]]] = None,
         transformations: Optional[List[str]] = None,
         metadata_project: Optional[List[str]] = None,
     ):
         format_type_options, copy_options = get_copy_into_table_options(options)
         pattern = options.get("PATTERN", None)
         # Can only infer the schema for parquet, orc and avro
+        # csv and json in preview
         infer_schema = (
             options.get("INFER_SCHEMA", True)
             if format in INFER_SCHEMA_FORMAT_TYPES
             else False
         )
         # tracking usage of pattern, will refactor this function in future
         if pattern:
             self.session._conn._telemetry_client.send_copy_pattern_telemetry()
 
+        if format_type_options.get("PARSE_HEADER", False):
+            # This option is only available for CSV file format
+            # The options is used when specified with INFER_SCHEMA( ..., FILE_FORMAT => (.., PARSE_HEADER)) see
+            # https://docs.snowflake.com/en/sql-reference/sql/create-file-format#format-type-options-formattypeoptions
+            # PARSE_HEADER does not work with FILE_FORMAT when used with SELECT FROM LOCATION(FILE_FORMAT ...). Thus,
+            # if user has set option("PARSE_HEADER", True), we have already read the header in
+            # DataframeReader._infer_schema_for_file_format so now we must set skip_header = 1 to skip the header line.
+            format_type_options["SKIP_HEADER"] = 1
+        format_type_options.pop("PARSE_HEADER", None)
+
         if not copy_options:  # use select
             queries: List[Query] = []
             post_queries: List[Query] = []
             use_temp_file_format: bool = "FORMAT_NAME" not in options
             if use_temp_file_format:
                 format_name = (
                     fully_qualified_schema
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/sort_expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/table_function.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/table_function.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/unary_expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
-from typing import List, Optional
+from typing import Dict, List, Optional
 
 from snowflake.snowpark._internal.analyzer.expression import Expression, NamedExpression
 from snowflake.snowpark._internal.analyzer.snowflake_plan import LogicalPlan
 from snowflake.snowpark._internal.analyzer.sort_expression import SortOrder
 
 
 class UnaryNode(LogicalPlan):
@@ -70,14 +70,24 @@
     ) -> None:
         super().__init__(child)
         self.value_column = value_column
         self.name_column = name_column
         self.column_list = column_list
 
 
+class Rename(UnaryNode):
+    def __init__(
+        self,
+        column_map: Dict[str, str],
+        child: LogicalPlan,
+    ) -> None:
+        super().__init__(child)
+        self.column_map = column_map
+
+
 class Filter(UnaryNode):
     def __init__(self, condition: Expression, child: LogicalPlan) -> None:
         super().__init__(child)
         self.condition = condition
 
 
 class Project(UnaryNode):
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/analyzer/window_expression.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/code_generation.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/code_generation.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/error_message.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/error_message.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/server_connection.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/server_connection.py`

 * *Files 2% similar despite different names*

```diff
@@ -330,14 +330,15 @@
         data_type: _AsyncResultType = _AsyncResultType.ROW,
         async_job_plan: Optional[
             SnowflakePlan
         ] = None,  # this argument is currently only used by AsyncJob
         log_on_exception: bool = False,
         case_sensitive: bool = True,
         params: Optional[Sequence[Any]] = None,
+        num_statements: Optional[int] = None,
         **kwargs,
     ) -> Union[Dict[str, Any], AsyncJob]:
         try:
             # Set SNOWPARK_SKIP_TXN_COMMIT_IN_DDL to True to avoid DDL commands to commit the open transaction
             if is_ddl_on_temp_object:
                 if not kwargs.get("_statement_params"):
                     kwargs["_statement_params"] = {}
@@ -346,15 +347,15 @@
                 results_cursor = self._cursor.execute(query, params=params, **kwargs)
                 self.notify_query_listeners(
                     QueryRecord(results_cursor.sfqid, results_cursor.query)
                 )
                 logger.debug(f"Execute query [queryID: {results_cursor.sfqid}] {query}")
             else:
                 results_cursor = self._cursor.execute_async(
-                    query, params=params, **kwargs
+                    query, params=params, num_statements=num_statements, **kwargs
                 )
                 self.notify_query_listeners(
                     QueryRecord(results_cursor["queryId"], query)
                 )
                 logger.debug(
                     f"Execute async query [queryID: {results_cursor['queryId']}] {query}"
                 )
@@ -378,22 +379,24 @@
                 results_cursor["queryId"],
                 query,
                 async_job_plan.session,
                 data_type,
                 async_job_plan.post_actions,
                 log_on_exception,
                 case_sensitive=case_sensitive,
+                num_statements=num_statements,
                 **kwargs,
             )
 
     def _to_data_or_iter(
         self,
         results_cursor: SnowflakeCursor,
         to_pandas: bool = False,
         to_iter: bool = False,
+        num_statements: Optional[int] = None,
     ) -> Dict[str, Any]:
         if to_pandas:
             try:
                 data_or_iter = (
                     map(
                         functools.partial(
                             _fix_pandas_df_integer, results_cursor=results_cursor
@@ -495,45 +498,38 @@
             is_batch_insert = False
             for q in plan.queries:
                 if isinstance(q, BatchInsertQuery):
                     is_batch_insert = True
                     break
             # since batch insert does not support async execution (? in the query), we handle it separately here
             if len(plan.queries) > 1 and not block and not is_batch_insert:
-                final_query = f"""EXECUTE IMMEDIATE $$
-DECLARE
-    res resultset;
-BEGIN
-    {";".join(q.sql for q in plan.queries[:-1])};
-    res := ({plan.queries[-1].sql});
-    return table(res);
-END;
-$$"""
-                # In multiple queries scenario, we are unable to get the query id of former query, so we replace
-                # place holder with fucntion last_query_id() here
+                params = []
+                final_queries = []
+                last_place_holder = None
                 for q in plan.queries:
-                    final_query = final_query.replace(
-                        f"'{q.query_id_place_holder}'", "LAST_QUERY_ID()"
+                    final_queries.append(
+                        q.sql.replace(f"'{last_place_holder}'", "LAST_QUERY_ID()")
+                        if last_place_holder
+                        else q.sql
                     )
-                    if q.params:
-                        # TODO(SNOW-791242): Support this use case after migrating to use multi-statement from connector
-                        raise NotImplementedError(
-                            "Async multi-query dataframe using bind variable is not supported yet"
-                        )
+                    last_place_holder = q.query_id_place_holder
+                    params.extend(q.params)
 
                 result = self.run_query(
-                    final_query,
+                    ";".join(final_queries),
                     to_pandas,
                     to_iter,
                     is_ddl_on_temp_object=plan.queries[0].is_ddl_on_temp_object,
                     block=block,
                     data_type=data_type,
                     async_job_plan=plan,
                     log_on_exception=log_on_exception,
                     case_sensitive=case_sensitive,
+                    num_statements=len(plan.queries),
+                    params=params,
                     **kwargs,
                 )
 
                 # since we will return a AsyncJob instance, result_meta is not needed, we will create result_meta in
                 # AsyncJob instance when needed
                 result_meta = None
                 if action_id < plan.session._last_canceled_id:
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/telemetry.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/telemetry.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/type_utils.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/type_utils.py`

 * *Files 16% similar despite different names*

```diff
@@ -28,33 +28,40 @@
     get_args,
     get_origin,
 )
 
 import snowflake.snowpark.types  # type: ignore
 from snowflake.connector.options import installed_pandas, pandas
 from snowflake.snowpark.types import (
+    LTZ,
+    NTZ,
+    TZ,
     ArrayType,
     BinaryType,
     BooleanType,
     ByteType,
     DataType,
     DateType,
     DecimalType,
     DoubleType,
     FloatType,
     Geography,
     GeographyType,
+    Geometry,
+    GeometryType,
     IntegerType,
     LongType,
     MapType,
     NullType,
     ShortType,
     StringType,
     StructField,
     StructType,
+    Timestamp,
+    TimestampTimeZone,
     TimestampType,
     TimeType,
     Variant,
     VariantType,
     _NumericType,
 )
 
@@ -83,33 +90,36 @@
         return ArrayType(StringType())
     if column_type_name == "VARIANT":
         return VariantType()
     if column_type_name == "OBJECT":
         return MapType(StringType(), StringType())
     if column_type_name == "GEOGRAPHY":
         return GeographyType()
+    if column_type_name == "GEOMETRY":
+        return GeometryType()
     if column_type_name == "BOOLEAN":
         return BooleanType()
     if column_type_name == "BINARY":
         return BinaryType()
     if column_type_name == "TEXT":
         if internal_size > 0:
             return StringType(internal_size)
         elif internal_size == 0:
             return StringType()
-        raise ValueError(f"Negative value is not a valid input for StringType")
+        raise ValueError("Negative value is not a valid input for StringType")
     if column_type_name == "TIME":
         return TimeType()
-    if column_type_name in (
-        "TIMESTAMP",
-        "TIMESTAMP_LTZ",
-        "TIMESTAMP_TZ",
-        "TIMESTAMP_NTZ",
-    ):
-        return TimestampType()
+    if column_type_name == "TIMESTAMP":
+        return TimestampType(timezone=TimestampTimeZone.DEFAULT)
+    if column_type_name == "TIMESTAMP_NTZ":
+        return TimestampType(timezone=TimestampTimeZone.NTZ)
+    if column_type_name == "TIMESTAMP_LTZ":
+        return TimestampType(timezone=TimestampTimeZone.LTZ)
+    if column_type_name == "TIMESTAMP_TZ":
+        return TimestampType(timezone=TimestampTimeZone.TZ)
     if column_type_name == "DATE":
         return DateType()
     if column_type_name == "DECIMAL" or (
         (column_type_name == "FIXED" or column_type_name == "NUMBER") and scale != 0
     ):
         if precision != 0 or scale != 0:
             if precision > DecimalType._MAX_PRECISION:
@@ -158,25 +168,34 @@
     if isinstance(datatype, BooleanType):
         return "BOOLEAN"
     if isinstance(datatype, DateType):
         return "DATE"
     if isinstance(datatype, TimeType):
         return "TIME"
     if isinstance(datatype, TimestampType):
-        return "TIMESTAMP"
+        if datatype.tz == TimestampTimeZone.NTZ:
+            return "TIMESTAMP_NTZ"
+        elif datatype.tz == TimestampTimeZone.LTZ:
+            return "TIMESTAMP_LTZ"
+        elif datatype.tz == TimestampTimeZone.TZ:
+            return "TIMESTAMP_TZ"
+        else:
+            return "TIMESTAMP"
     if isinstance(datatype, BinaryType):
         return "BINARY"
     if isinstance(datatype, ArrayType):
         return "ARRAY"
     if isinstance(datatype, MapType):
         return "OBJECT"
     if isinstance(datatype, VariantType):
         return "VARIANT"
     if isinstance(datatype, GeographyType):
         return "GEOGRAPHY"
+    if isinstance(datatype, GeometryType):
+        return "GEOMETRY"
     raise TypeError(f"Unsupported data type: {datatype.__class__.__name__}")
 
 
 # Mapping Python types to DataType
 NoneType = type(None)
 PYTHON_TO_SNOW_TYPE_MAPPINGS = {
     NoneType: NullType,
@@ -275,14 +294,18 @@
     if obj is None:
         return NullType()
 
     datatype = PYTHON_TO_SNOW_TYPE_MAPPINGS.get(type(obj))
     if datatype is DecimalType:
         # the precision and scale of `obj` may be different from row to row.
         return DecimalType(38, 18)
+    elif datatype is TimestampType and obj.tzinfo is not None:
+        # infer tz-aware datetime to TIMESTAMP_TZ
+        return datatype(TimestampTimeZone.TZ)
+
     elif datatype is not None:
         return datatype()
 
     if isinstance(obj, dict):
         for key, value in obj.items():
             if key is not None and value is not None:
                 return MapType(infer_type(key), infer_type(value))
@@ -323,15 +346,15 @@
             items = zip(names if names else ["_1"], [row])
         else:
             raise TypeError("Can not infer schema for type: %s" % type(row))
 
     fields = []
     for k, v in items:
         try:
-            fields.append(StructField(k, infer_type(v), True))
+            fields.append(StructField(k, infer_type(v), v is None))
         except TypeError as e:
             raise TypeError(f"Unable to infer the type of the field {k}.") from e
     return StructType(fields)
 
 
 def merge_type(a: DataType, b: DataType, name: Optional[str] = None) -> DataType:
     # null type
@@ -343,30 +366,34 @@
         err_msg = f"Cannot merge type {type(a)} and {type(b)}"
         if name:
             err_msg = f"{name}: {err_msg}"
         raise TypeError(err_msg)
 
     # same type
     if isinstance(a, StructType):
-        nfs = {f.name: f.datatype for f in b.fields}
+        name_to_datatype_b = {f.name: f.datatype for f in b.fields}
+        name_to_nullable_b = {f.name: f.nullable for f in b.fields}
         fields = [
             StructField(
                 f.name,
                 merge_type(
                     f.datatype,
-                    nfs.get(f.name, NullType()),
+                    name_to_datatype_b.get(f.name, NullType()),
                     name=f"field {f.name} in {name}" if name else f"field {f.name}",
                 ),
+                f.nullable or name_to_nullable_b.get(f.name, True),
             )
             for f in a.fields
         ]
         names = {f.name for f in fields}
-        for n in nfs:
+        for n in name_to_datatype_b:
             if n not in names:
-                fields.append(StructField(n, nfs[n]))
+                fields.append(
+                    StructField(n, name_to_datatype_b[n], name_to_nullable_b[n])
+                )
         return StructType(fields)
 
     elif isinstance(a, ArrayType):
         return ArrayType(
             merge_type(
                 a.element_type, b.element_type, name="element in array %s" % name
             )
@@ -400,14 +427,15 @@
 
 
 def python_type_to_snow_type(tp: Union[str, Type]) -> Tuple[DataType, bool]:
     """Converts a Python type or a Python type string to a Snowpark type.
     Returns a Snowpark type and whether it's nullable.
     """
     from snowflake.snowpark.dataframe import DataFrame
+
     # convert a type string to a type object
     if isinstance(tp, str):
         tp = python_type_str_to_object(tp)
 
     if tp is decimal.Decimal:
         return DecimalType(38, 18), False
     elif tp in PYTHON_TO_SNOW_TYPE_MAPPINGS:
@@ -471,14 +499,32 @@
 
     if tp == Variant:
         return VariantType(), False
 
     if tp == Geography:
         return GeographyType(), False
 
+    if tp == Geometry:
+        return GeometryType(), False
+
+    if tp == Timestamp or tp_origin == Timestamp:
+        if not tp_args:
+            timezone = TimestampTimeZone.DEFAULT
+        elif tp_args[0] == NTZ:
+            timezone = TimestampTimeZone.NTZ
+        elif tp_args[0] == LTZ:
+            timezone = TimestampTimeZone.LTZ
+        elif tp_args[0] == TZ:
+            timezone = TimestampTimeZone.TZ
+        else:
+            raise TypeError(
+                f"Only Timestamp, Timestamp[NTZ], Timestamp[LTZ] and Timestamp[TZ] are allowed, but got {tp}"
+            )
+        return TimestampType(timezone), False
+
     raise TypeError(f"invalid type {tp}")
 
 
 def snow_type_to_dtype_str(snow_type: DataType) -> str:
     if isinstance(
         snow_type,
         (
@@ -486,14 +532,15 @@
             BooleanType,
             FloatType,
             DoubleType,
             DateType,
             TimestampType,
             TimeType,
             GeographyType,
+            GeometryType,
             VariantType,
         ),
     ):
         return snow_type.__class__.__name__[:-4].lower()
     if isinstance(snow_type, StringType):
         if snow_type.length:
             return f"string({snow_type.length})"
@@ -519,17 +566,18 @@
 
 
 def retrieve_func_type_hints_from_source(
     file_path: str,
     func_name: str,
     class_name: Optional[str] = None,
     _source: Optional[str] = None,
-) -> Dict[str, str]:
+) -> Optional[Dict[str, str]]:
     """
     Retrieve type hints of a function from a source file, or a source string (test only).
+    Returna None if the function is not found.
     """
 
     def parse_arg_annotation(annotation: ast.expr) -> str:
         if isinstance(annotation, (ast.Tuple, ast.List)):
             return ", ".join([parse_arg_annotation(e) for e in annotation.elts])
         if isinstance(annotation, ast.Attribute):
             return f"{parse_arg_annotation(annotation.value)}.{annotation.attr}"
@@ -568,25 +616,23 @@
             def visit_ClassDef(self, node):
                 if node.name == class_name:
                     self.class_node = node
 
         class_visitor = ClassNodeVisitor()
         class_visitor.visit(ast.parse(_source))
         if class_visitor.class_node is None:
-            raise ValueError(f"class {class_name} is not found in file {file_path}")
+            return None
         to_visit_node_for_func = class_visitor.class_node
     else:
         to_visit_node_for_func = ast.parse(_source)
 
     visitor = FuncNodeVisitor()
     visitor.visit(to_visit_node_for_func)
     if not visitor.func_exist:
-        raise ValueError(
-            f"function {class_name if class_name else ''}{'.' if class_name else ''}{func_name} is not found in file {file_path}"
-        )
+        return None
     return visitor.type_hints
 
 
 # Get a mapping from type string to type object, for cast() function
 def get_data_type_string_object_mappings(
     to_fill_dict: Dict[str, Type[DataType]],
     data_type: Optional[Type[DataType]] = None,
@@ -613,17 +659,15 @@
 DATA_TYPE_STRING_OBJECT_MAPPINGS["array"] = ArrayType
 
 DECIMAL_RE = re.compile(
     r"^\s*(numeric|number|decimal)\s*\(\s*(\s*)(\d*)\s*,\s*(\d*)\s*\)\s*$"
 )
 # support type string format like "  decimal  (  2  ,  1  )  "
 
-STRING_RE = re.compile(
-    r"^\s*(varchar|string|text)\s*\(\s*(\d*)\s*\)\s*$"
-)
+STRING_RE = re.compile(r"^\s*(varchar|string|text)\s*\(\s*(\d*)\s*\)\s*$")
 # support type string format like "  string  (  23  )  "
 
 
 def get_number_precision_scale(type_str: str) -> Optional[Tuple[int, int]]:
     decimal_matches = DECIMAL_RE.match(type_str)
     if decimal_matches:
         return int(decimal_matches.group(3)), int(decimal_matches.group(4))
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/udf_utils.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/udf_utils.py`

 * *Files 21% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
-
+import collections.abc
 import io
 import os
 import pickle
 import sys
 import typing
 import zipfile
 from logging import getLogger
@@ -21,40 +21,45 @@
     Union,
     get_type_hints,
 )
 
 import cloudpickle
 
 import snowflake.snowpark
-from snowflake.snowpark._internal import code_generation
+from snowflake.connector.options import installed_pandas, pandas
+from snowflake.snowpark._internal import code_generation, type_utils
 from snowflake.snowpark._internal.analyzer.datatype_mapper import to_sql
 from snowflake.snowpark._internal.telemetry import TelemetryField
 from snowflake.snowpark._internal.type_utils import (
+    NoneType,
     convert_sp_to_sf_type,
     infer_type,
+    python_type_str_to_object,
     python_type_to_snow_type,
     retrieve_func_type_hints_from_source,
 )
 from snowflake.snowpark._internal.utils import (
     STAGE_PREFIX,
     TempObjectType,
     get_udf_upload_prefix,
     is_single_quoted,
     normalize_remote_file_or_dir,
     random_name_for_temp_object,
     random_number,
     unwrap_stage_location_single_quote,
     validate_object_name,
 )
-from snowflake.snowpark.types import (
-    DataType,
-    PandasDataFrameType,
-    PandasSeriesType,
-    StructType,
-)
+from snowflake.snowpark.types import DataType, StructField, StructType
+
+if installed_pandas:
+    from snowflake.snowpark.types import (
+        PandasDataFrame,
+        PandasDataFrameType,
+        PandasSeriesType,
+    )
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
 if sys.version_info <= (3, 9):
     from typing import Iterable
 else:
@@ -68,63 +73,233 @@
 # Max code size to inline generated closure. Beyond this threshold, the closure will be uploaded to a stage for imports.
 # Current number is the same as scala. We might have the potential to make it larger but that requires further benchmark
 # because zip compression ratio is quite high.
 _MAX_INLINE_CLOSURE_SIZE_BYTES = 8192
 
 # Every table function handler class must define the process method.
 TABLE_FUNCTION_PROCESS_METHOD = "process"
+TABLE_FUNCTION_END_PARTITION_METHOD = "end_partition"
+
+# Every aggregate function handler class must define accumulate and finish methods.
+AGGREGATE_FUNCTION_ACCULUMATE_METHOD = "accumulate"
+AGGREGATE_FUNCTION_FINISH_METHOD = "finish"
+AGGREGATE_FUNCTION_MERGE_METHOD = "merge"
+AGGREGATE_FUNCTION_STATE_METHOD = "aggregate_state"
 
 EXECUTE_AS_WHITELIST = frozenset(["owner", "caller"])
 
 
 class UDFColumn(NamedTuple):
     datatype: DataType
     name: str
 
 
 def is_local_python_file(file_path: str) -> bool:
     return not file_path.startswith(STAGE_PREFIX) and file_path.endswith(".py")
 
 
+def get_python_types_dict_for_udaf(
+    accumulate_hints: Dict[str, Any], finish_hints: Dict[str, Any]
+) -> Dict[str, Any]:
+    python_types_dict = {k: v for k, v in accumulate_hints.items() if k != "return"}
+    if "return" in finish_hints:
+        python_types_dict["return"] = finish_hints["return"]
+    return python_types_dict
+
+
+def get_python_types_dict_for_udtf(
+    process: Dict[str, Any], end_partition: Dict[str, Any]
+) -> Dict[str, Any]:
+    # Prefer input types from process and return types from end_partition
+    python_types_dict = {**end_partition, **process}
+    if "return" in end_partition:
+        python_types_dict["return"] = end_partition["return"]
+    return python_types_dict
+
+
+def extract_return_type_from_udtf_type_hints(
+    return_type_hint, output_schema, func_name
+) -> Union[StructType, "PandasDataFrameType", None]:
+    if return_type_hint is None and output_schema is not None:
+        raise ValueError(
+            "The return type hint is not set but 'output_schema' has only column names. You can either use a StructType instance for 'output_schema', or use"
+            "a combination of a return type hint for method 'process' and column names for 'output_schema'."
+        )
+    if typing.get_origin(return_type_hint) in [
+        list,
+        tuple,
+        collections.abc.Iterable,
+        collections.abc.Iterator,
+    ]:
+        row_type_hint = typing.get_args(return_type_hint)[0]  # The inner Tuple
+        if typing.get_origin(row_type_hint) != tuple:
+            raise ValueError(
+                f"The return type hint of method '{func_name}.process' must be a collection of tuples, for instance, Iterable[Tuple[str, int]], if you specify return type hint."
+            )
+        column_type_hints = typing.get_args(row_type_hint)
+        if len(column_type_hints) > 1 and column_type_hints[1] == Ellipsis:
+            return StructType(
+                [
+                    StructField(
+                        name,
+                        type_utils.python_type_to_snow_type(column_type_hints[0])[0],
+                    )
+                    for name in output_schema
+                ]
+            )
+        elif output_schema:
+            if len(column_type_hints) != len(output_schema):
+                raise ValueError(
+                    f"'output_schema' has {len(output_schema)} names while type hints Tuple has only {len(column_type_hints)}."
+                )
+            return StructType(
+                [
+                    StructField(
+                        name,
+                        type_utils.python_type_to_snow_type(column_type)[0],
+                    )
+                    for name, column_type in zip(output_schema, column_type_hints)
+                ]
+            )
+        else:  # both type hints and return type are specified
+            return None
+    elif return_type_hint is None:
+        return None
+    else:
+        # Vectorized UDTF
+        if not installed_pandas:
+            raise RuntimeError(
+                "No pandas detected in local environment, please install pandas to use vectorized UDTF"
+            )
+        elif typing.get_origin(return_type_hint) == PandasDataFrame:
+            return PandasDataFrameType(
+                col_types=[
+                    python_type_to_snow_type(x)[0]
+                    for x in typing.get_args(return_type_hint)
+                ],
+                col_names=output_schema,
+            )
+        elif return_type_hint is pandas.DataFrame:
+            return PandasDataFrameType(
+                []
+            )  # placeholder, indicating the return type is pandas DataFrame
+        elif return_type_hint is NoneType:
+            return None
+        else:
+            raise ValueError(
+                f"The return type hint for a UDTF handler must be a collection type or None or a PandasDataFrame. {return_type_hint} is used."
+            )
+
+
 def get_types_from_type_hints(
     func: Union[Callable, Tuple[str, str]],
     object_type: TempObjectType,
+    output_schema: Optional[List[str]] = None,
 ) -> Tuple[DataType, List[DataType]]:
     if isinstance(func, Callable):
         # For Python 3.10+, the result values of get_type_hints()
         # will become strings, which we have to change the implementation
         # here at that time. https://www.python.org/dev/peps/pep-0563/
-        python_types_dict = get_type_hints(
-            getattr(func, TABLE_FUNCTION_PROCESS_METHOD, func)
-        )
+        func_name = func.__name__
+        try:
+            if object_type == TempObjectType.AGGREGATE_FUNCTION:
+                accumulate_hints = get_type_hints(
+                    getattr(func, AGGREGATE_FUNCTION_ACCULUMATE_METHOD, func)
+                )
+                finish_hints = get_type_hints(
+                    getattr(func, AGGREGATE_FUNCTION_FINISH_METHOD, func)
+                )
+                python_types_dict = get_python_types_dict_for_udaf(
+                    accumulate_hints, finish_hints
+                )
+
+            elif object_type == TempObjectType.TABLE_FUNCTION:
+                if not (
+                    hasattr(func, TABLE_FUNCTION_END_PARTITION_METHOD)
+                    or hasattr(func, TABLE_FUNCTION_PROCESS_METHOD)
+                ):
+                    raise AttributeError(
+                        f"Neither `{TABLE_FUNCTION_PROCESS_METHOD}` nor `{TABLE_FUNCTION_END_PARTITION_METHOD}` is defined for class {func}"
+                    )
+                process_types_dict = {}
+                end_partition_types_dict = {}
+                # PROCESS and END_PARTITION have the same return type but input types might be different, favor PROCESS's types if both methods are present
+                if hasattr(func, TABLE_FUNCTION_PROCESS_METHOD):
+                    process_types_dict = get_type_hints(
+                        getattr(func, TABLE_FUNCTION_PROCESS_METHOD)
+                    )
+                if hasattr(func, TABLE_FUNCTION_END_PARTITION_METHOD):
+                    end_partition_types_dict = get_type_hints(
+                        getattr(func, TABLE_FUNCTION_END_PARTITION_METHOD)
+                    )
+                python_types_dict = get_python_types_dict_for_udtf(
+                    process_types_dict, end_partition_types_dict
+                )
+            else:
+                python_types_dict = get_type_hints(func)
+        except TypeError:
+            # if we fail to run get_type_hints on a function (a TypeError will be raised),
+            # return empty type dict. This will fail for functions like numpy.ufunc
+            # (e.g., get_type_hints(np.exp))
+            python_types_dict = {}
+        return_type_hint = python_types_dict.get("return")
     else:
-        if object_type == TempObjectType.TABLE_FUNCTION:
-            python_types_dict = (
-                retrieve_func_type_hints_from_source(
-                    func[0], TABLE_FUNCTION_PROCESS_METHOD, class_name=func[1]
-                )  # use method process of a UDTF handler class.
-                if is_local_python_file(func[0])
-                else {}
+        # Register from file
+        filename, func_name = func[0], func[1]
+        if not is_local_python_file(filename):
+            python_types_dict = {}
+        elif object_type == TempObjectType.AGGREGATE_FUNCTION:
+            accumulate_hints = retrieve_func_type_hints_from_source(
+                filename, AGGREGATE_FUNCTION_ACCULUMATE_METHOD, class_name=func_name
+            )
+            finish_hints = retrieve_func_type_hints_from_source(
+                filename, AGGREGATE_FUNCTION_FINISH_METHOD, class_name=func_name
+            )
+            python_types_dict = get_python_types_dict_for_udaf(
+                accumulate_hints, finish_hints
+            )
+        elif object_type == TempObjectType.TABLE_FUNCTION:
+            process_types_dict = retrieve_func_type_hints_from_source(
+                filename, TABLE_FUNCTION_PROCESS_METHOD, class_name=func[1]
+            )
+            end_partition_types_dict = retrieve_func_type_hints_from_source(
+                func[0], TABLE_FUNCTION_END_PARTITION_METHOD, class_name=func[1]
+            )
+            if process_types_dict is None and end_partition_types_dict is None:
+                raise ValueError(
+                    f"Neither {func_name}.{TABLE_FUNCTION_PROCESS_METHOD} or {func_name}.{TABLE_FUNCTION_END_PARTITION_METHOD} could be found from {filename}"
+                )
+            python_types_dict = get_python_types_dict_for_udtf(
+                process_types_dict or {}, end_partition_types_dict or {}
+            )
+        elif object_type in (TempObjectType.FUNCTION, TempObjectType.PROCEDURE):
+            python_types_dict = retrieve_func_type_hints_from_source(
+                filename, func_name
             )
         else:
-            python_types_dict = (
-                retrieve_func_type_hints_from_source(func[0], func[1])
-                if is_local_python_file(func[0])
-                else {}
+            raise ValueError(
+                f"Expecting FUNCTION, PROCEDURE, TABLE_FUNCTION, or AGGREGATE_FUNCTION as object_type, got {object_type}"
             )
 
+        if "return" in python_types_dict:
+            return_type_hint = python_type_str_to_object(python_types_dict["return"])
+        else:
+            return_type_hint = None
+
     if object_type == TempObjectType.TABLE_FUNCTION:
-        return_type = None
-        # The return type is processed in udtf.py. Return None here.
+        return_type = extract_return_type_from_udtf_type_hints(
+            return_type_hint, output_schema, func_name
+        )
     else:
         return_type = (
             python_type_to_snow_type(python_types_dict["return"])[0]
             if "return" in python_types_dict
             else None
         )
+
     input_types = []
 
     # types are in order
     index = 0
     for key, python_type in python_types_dict.items():
         # The first parameter of sp function should be Session
         if object_type == TempObjectType.PROCEDURE and index == 0:
@@ -145,14 +320,16 @@
 def get_error_message_abbr(object_type: TempObjectType) -> str:
     if object_type == TempObjectType.FUNCTION:
         return "udf"
     if object_type == TempObjectType.PROCEDURE:
         return "stored proc"
     if object_type == TempObjectType.TABLE_FUNCTION:
         return "table function"
+    if object_type == TempObjectType.AGGREGATE_FUNCTION:
+        return "aggregate function"
     raise ValueError(f"Expect FUNCTION of PROCEDURE, but get {object_type}")
 
 
 def check_register_args(
     object_type: TempObjectType,
     name: Optional[Union[str, Iterable[str]]] = None,
     is_permanent: bool = False,
@@ -182,40 +359,62 @@
     ):
         raise TypeError(
             f"'execute_as' value '{execute_as}' is invalid, choose from "
             f"{', '.join(EXECUTE_AS_WHITELIST, )}"
         )
 
 
+def check_python_runtime_version(runtime_version_from_requirement: Optional[str]):
+    system_version = f"{sys.version_info[0]}.{sys.version_info[1]}"
+    if (
+        runtime_version_from_requirement is not None
+        and runtime_version_from_requirement != system_version
+    ):
+        raise ValueError(
+            f"Cloudpickle can only be used to send objects between the exact same version of Python. "
+            f"Your system version is {system_version} while your requirements have specified version "
+            f"{runtime_version_from_requirement}!"
+        )
+
+
 def process_file_path(file_path: str) -> str:
     file_path = file_path.strip()
     if not file_path.startswith(STAGE_PREFIX) and not os.path.exists(file_path):
         raise ValueError(f"file_path {file_path} does not exist")
     return file_path
 
 
 def extract_return_input_types(
     func: Union[Callable, Tuple[str, str]],
     return_type: Optional[DataType],
     input_types: Optional[List[DataType]],
     object_type: TempObjectType,
-) -> Tuple[bool, bool, DataType, List[DataType]]:
-    # return results are: is_pandas_udf, is_dataframe_input, return_type, input_types
+    output_schema: Optional[List[str]] = None,
+) -> Tuple[bool, bool, Union[DataType, List[DataType]], List[DataType]]:
+    """
+    Returns:
+        is_pandas_udf
+        is_dataframe_input
+        return_types
+        input_types
+
+    Notes:
+        There are 3 cases:
+           1. return_type and input_types are provided:
+              a. type hints are provided and they are all pandas.Series or pandas.DataFrame,
+                 then combine them to pandas-related types.
+              b. otherwise, just use return_type and input_types.
+           2. return_type and input_types are not provided, but type hints are provided,
+              then just use the types inferred from type hints.
+    """
 
-    # there are 3 cases:
-    #   1. return_type and input_types are provided:
-    #      a. type hints are provided and they are all pandas.Series or pandas.DataFrame,
-    #         then combine them to pandas-related types.
-    #      b. otherwise, just use return_type and input_types.
-    #   2. return_type and input_types are not provided, but type hints are provided,
-    #      then just use the types inferred from type hints.
     (
         return_type_from_type_hints,
         input_types_from_type_hints,
-    ) = get_types_from_type_hints(func, object_type)
+    ) = get_types_from_type_hints(func, object_type, output_schema)
     if return_type and return_type_from_type_hints:
         if isinstance(return_type_from_type_hints, PandasSeriesType):
             res_return_type = (
                 return_type.element_type
                 if isinstance(return_type, PandasSeriesType)
                 else return_type
             )
@@ -235,14 +434,20 @@
                 input_types_from_type_hints[0], PandasDataFrameType
             ):
                 return True, True, res_return_type, res_input_types
             elif all(
                 isinstance(tp, PandasSeriesType) for tp in input_types_from_type_hints
             ):
                 return True, False, res_return_type, res_input_types
+        elif isinstance(
+            return_type_from_type_hints, PandasDataFrameType
+        ):  # vectorized UDTF
+            return_type = PandasDataFrameType(
+                [x.datatype for x in return_type], [x.name for x in return_type]
+            )
 
     res_return_type = return_type or return_type_from_type_hints
     res_input_types = input_types or input_types_from_type_hints
 
     if not res_return_type or (
         isinstance(res_return_type, PandasSeriesType)
         and not res_return_type.element_type
@@ -275,49 +480,65 @@
         elif len(res_input_types) == 1 and isinstance(
             res_input_types[0], PandasDataFrameType
         ):
             return (
                 True,
                 True,
                 res_return_type.element_type,
-                [
-                    tp.element_type if isinstance(tp, PandasSeriesType) else tp
-                    for tp in res_input_types[0].col_types
-                ],
+                res_input_types[0].get_snowflake_col_datatypes(),
             )
         elif all(isinstance(tp, PandasSeriesType) for tp in res_input_types):
             return (
                 True,
                 False,
                 res_return_type.element_type,
                 [tp.element_type for tp in res_input_types],
             )
+    elif isinstance(res_return_type, PandasDataFrameType):
+        if len(res_input_types) == 0:
+            return True, True, res_return_type, []
+        elif len(res_input_types) == 1 and isinstance(
+            res_input_types[0], PandasDataFrameType
+        ):
+            return (
+                True,
+                True,
+                res_return_type,
+                res_input_types[0].get_snowflake_col_datatypes(),
+            )
+        else:
+            return True, True, res_return_type, res_input_types
 
     # not pandas UDF
     if not isinstance(res_return_type, (PandasSeriesType, PandasDataFrameType)) and all(
         not isinstance(tp, (PandasSeriesType, PandasDataFrameType))
         for tp in res_input_types
     ):
         return False, False, res_return_type, res_input_types
 
     raise TypeError(
-        f"Invalid return type or input types for UDF: return type {res_return_type}, input types {res_input_types}"
+        f"Invalid return type or input types: return type {res_return_type}, input types {res_input_types}"
     )
 
 
 def process_registration_inputs(
     session: "snowflake.snowpark.Session",
     object_type: TempObjectType,
     func: Union[Callable, Tuple[str, str]],
     return_type: Optional[DataType],
     input_types: Optional[List[DataType]],
     name: Optional[Union[str, Iterable[str]]],
     anonymous: bool = False,
+    output_schema: Optional[List[str]] = None,
 ) -> Tuple[str, bool, bool, DataType, List[DataType]]:
-    # get the udf name
+    """
+
+    Args:
+        output_schema: List of column names of in the output, only applicable to UDTF
+    """
     if name:
         object_name = name if isinstance(name, str) else ".".join(name)
     else:
         object_name = random_name_for_temp_object(object_type)
         if not anonymous:
             object_name = (
                 f"{session.get_fully_qualified_current_schema()}.{object_name}"
@@ -327,15 +548,15 @@
     # get return and input types
     (
         is_pandas_udf,
         is_dataframe_input,
         return_type,
         input_types,
     ) = extract_return_input_types(
-        func, return_type, [] if input_types is None else input_types, object_type
+        func, return_type, input_types or [], object_type, output_schema
     )
 
     return object_name, is_pandas_udf, is_dataframe_input, return_type, input_types
 
 
 def cleanup_failed_permanent_registration(
     session: "snowflake.snowpark.Session",
@@ -385,30 +606,52 @@
     max_batch_size: Optional[int] = None,
     source_code_display: bool = False,
 ) -> str:
     # if func is a method object, we need to extract the target function first to check
     # annotations. However, we still serialize the original method because the extracted
     # function will have an extra argument `cls` or `self` from the class.
     if object_type == TempObjectType.TABLE_FUNCTION:
-        target_func = getattr(func, TABLE_FUNCTION_PROCESS_METHOD)
+        if is_pandas_udf:
+            annotated_funcs = [getattr(func, TABLE_FUNCTION_END_PARTITION_METHOD)]
+        else:
+            annotated_funcs = [getattr(func, TABLE_FUNCTION_PROCESS_METHOD)]
+    elif object_type == TempObjectType.AGGREGATE_FUNCTION:
+        annotated_funcs = [
+            getattr(func, AGGREGATE_FUNCTION_ACCULUMATE_METHOD),
+            getattr(func, AGGREGATE_FUNCTION_FINISH_METHOD),
+            getattr(func, AGGREGATE_FUNCTION_MERGE_METHOD),
+            getattr(func, AGGREGATE_FUNCTION_STATE_METHOD).fget,
+        ]
+    elif object_type in (TempObjectType.FUNCTION, TempObjectType.PROCEDURE):
+        annotated_funcs = [getattr(func, "__func__", func)]
     else:
-        target_func = getattr(func, "__func__", func)
+        raise ValueError(
+            f"Expecting FUNCTION, PROCEDURE, TABLE_FUNCTION or AGGREGATE_FUNCTION for object_type, got {object_type}"
+        )
 
     # clear the annotations because when the user annotates Variant and Geography,
     # which are from snowpark modules and will not work on the server side
     # built-in functions don't have __annotations__
-    if hasattr(target_func, "__annotations__"):
-        annotations = target_func.__annotations__
+    # TODO(SNOW-861329): This removal could cause race condition if two sessions are trying to register UDF using the
+    #   same decorated function/class.
+    annotations = [
+        getattr(annotated_func, "__annotations__", None)
+        for annotated_func in annotated_funcs
+    ]
+    if any(annotations):
         try:
-            target_func.__annotations__ = {}
+            for annotated_func in annotated_funcs:
+                annotated_func.__annotations__ = {}
             # we still serialize the original function
             pickled_func = pickle_function(func)
         finally:
             # restore the annotations so we don't change the original function
-            target_func.__annotations__ = annotations
+            for annotated_func, annotation in zip(annotated_funcs, annotations):
+                if annotation:
+                    annotated_func.__annotations__ = annotation
     else:
         pickled_func = pickle_function(func)
     args = ",".join(arg_names)
 
     try:
         source_code_comment = (
             code_generation.generate_source_code(func) if source_code_display else ""
@@ -431,14 +674,25 @@
 
     if object_type == TempObjectType.PROCEDURE:
         func_code = f"""
 def {_DEFAULT_HANDLER_NAME}({args}):
     return func({args})
 """
     else:
+        # UDF and UDTF use wrapper functions to invoke the pickled functions.
+        if is_pandas_udf:
+            func_args = "df"
+            wrapper_params = func_args
+            if not is_dataframe_input:
+                func_args = "*[df[idx] for idx in range(df.shape[1])]"
+        else:
+            func_args = args
+            wrapper_params = args
+
+        # Function/Class definition
         func_code = """
 
 from threading import RLock
 
 lock = RLock()
 
 class InvokedFlag:
@@ -463,59 +717,69 @@
 init_invoked = InvokedFlag()
 process_invoked = InvokedFlag()
 end_partition_invoked = InvokedFlag()
 
 class {_DEFAULT_HANDLER_NAME}(func):
     def __init__(self):
         lock_function_once(super().__init__, init_invoked)()
-
-    def process(self, {args}):
-        return lock_function_once(super().process, process_invoked)({args})
 """
-            if hasattr(func, "end_partition"):
+            if hasattr(func, TABLE_FUNCTION_PROCESS_METHOD):
                 func_code = f"""{func_code}
-    def end_partition(self):
-        return lock_function_once(super().end_partition, end_partition_invoked)()
+    def process(self, {wrapper_params}):
+        return lock_function_once(super().process, process_invoked)({func_args})
 """
-        elif is_pandas_udf:
+            if hasattr(func, TABLE_FUNCTION_END_PARTITION_METHOD):
+                func_code = f"""{func_code}
+    def end_partition(self, {wrapper_params if is_pandas_udf else ""}):
+        return lock_function_once(super().end_partition, end_partition_invoked)({func_args if is_pandas_udf else ""})
+"""
+        elif object_type == TempObjectType.AGGREGATE_FUNCTION:
+            func_code = f"""{func_code}
+init_invoked = InvokedFlag()
+accumulate_invoked = InvokedFlag()
+merge_invoked = InvokedFlag()
+finish_invoked = InvokedFlag()
+
+class {_DEFAULT_HANDLER_NAME}(func):
+    def __init__(self):
+        lock_function_once(super().__init__, init_invoked)()
+
+    def accumulate(self, {args}):
+        return lock_function_once(super().accumulate, accumulate_invoked)({args})
+
+    def merge(self, other_agg_state):
+        return lock_function_once(super().merge, merge_invoked)(other_agg_state)
+
+    def finish(self):
+        return lock_function_once(super().finish, finish_invoked)()
+            """
+        elif object_type == TempObjectType.FUNCTION:
+            func_code = f"""{func_code}
+invoked = InvokedFlag()
+
+def {_DEFAULT_HANDLER_NAME}({wrapper_params}):
+    return lock_function_once(func, invoked)({func_args})
+""".rstrip()
+
+        # Vectorized UDxF attributes
+        if is_pandas_udf:
             pandas_code = f"""
 import pandas
 
-{_DEFAULT_HANDLER_NAME}._sf_vectorized_input = pandas.DataFrame
+{_DEFAULT_HANDLER_NAME}{("."+TABLE_FUNCTION_END_PARTITION_METHOD) if object_type == TempObjectType.TABLE_FUNCTION else ""}._sf_vectorized_input = pandas.DataFrame
 """.rstrip()
             if max_batch_size:
                 pandas_code = f"""
 {pandas_code}
 {_DEFAULT_HANDLER_NAME}._sf_max_batch_size = {int(max_batch_size)}
 """.rstrip()
-            if is_dataframe_input:
-                func_code = f"""{func_code}
-invoked = InvokedFlag()
-
-def {_DEFAULT_HANDLER_NAME}(df):
-    return lock_function_once(func, invoked)(df)
-""".rstrip()
-            else:
-                func_code = f"""{func_code}
-invoked = InvokedFlag()
-
-def {_DEFAULT_HANDLER_NAME}(df):
-    return lock_function_once(func, invoked)(*[df[idx] for idx in range(df.shape[1])])
-""".rstrip()
             func_code = f"""
 {func_code}
 {pandas_code}
 """.rstrip()
-        else:
-            func_code = f"""{func_code}
-invoked = InvokedFlag()
-
-def {_DEFAULT_HANDLER_NAME}({args}):
-    return lock_function_once(func, invoked)({args})
-""".rstrip()
 
     return f"""
 {deserialization_code}
 {func_code}
 """.strip()
 
 
@@ -532,21 +796,33 @@
     is_pandas_udf: bool = False,
     is_dataframe_input: bool = False,
     max_batch_size: Optional[int] = None,
     *,
     statement_params: Optional[Dict[str, str]] = None,
     source_code_display: bool = False,
     skip_upload_on_content_match: bool = False,
-) -> Tuple[str, str, str, str, str]:
+) -> Tuple[str, str, str, str, str, bool]:
     upload_stage = (
         unwrap_stage_location_single_quote(stage_location)
         if stage_location
         else session.get_session_stage()
     )
 
+    # resolve packages
+    resolved_packages = (
+        session._resolve_packages(packages, include_pandas=is_pandas_udf)
+        if packages is not None
+        else session._resolve_packages(
+            [],
+            session._packages,
+            validate_package=False,
+            include_pandas=is_pandas_udf,
+        )
+    )
+
     # resolve imports
     if imports:
         udf_level_imports = {}
         for udf_import in imports:
             if isinstance(udf_import, str):
                 resolved_import_tuple = session._resolve_import_path(udf_import)
             elif isinstance(udf_import, tuple) and len(udf_import) == 2:
@@ -565,27 +841,22 @@
     elif imports is None:
         all_urls = session._resolve_imports(
             upload_stage, statement_params=statement_params
         )
     else:
         all_urls = []
 
-    # resolve packages
-    resolved_packages = (
-        session._resolve_packages(packages, include_pandas=is_pandas_udf)
-        if packages is not None
-        else session._resolve_packages(
-            [], session._packages, validate_package=False, include_pandas=is_pandas_udf
-        )
-    )
-
     dest_prefix = get_udf_upload_prefix(udf_name)
 
     # Upload closure to stage if it is beyond inline closure size limit
     if isinstance(func, Callable):
+        custom_python_runtime_version_allowed = (
+            False  # As cloudpickle is being used, we cannot allow a custom runtime
+        )
+
         # generate a random name for udf py file
         # and we compress it first then upload it
         udf_file_name_base = f"udf_py_{random_number()}"
         udf_file_name = f"{udf_file_name_base}.zip"
         code = generate_python_code(
             func,
             arg_names,
@@ -622,14 +893,15 @@
             inline_code = None
             handler = f"{udf_file_name_base}.{_DEFAULT_HANDLER_NAME}"
         else:
             inline_code = code
             upload_file_stage_location = None
             handler = _DEFAULT_HANDLER_NAME
     else:
+        custom_python_runtime_version_allowed = True
         udf_file_name = os.path.basename(func[0])
         # for a compressed file, it might have multiple extensions
         # and we should remove all extensions
         udf_file_name_base = udf_file_name.split(".")[0]
         inline_code = None
         handler = f"{udf_file_name_base}.{func[1]}"
 
@@ -652,15 +924,22 @@
             all_urls.append(upload_file_stage_location)
 
     # build imports and packages string
     all_imports = ",".join(
         [url if is_single_quoted(url) else f"'{url}'" for url in all_urls]
     )
     all_packages = ",".join([f"'{package}'" for package in resolved_packages])
-    return handler, inline_code, all_imports, all_packages, upload_file_stage_location
+    return (
+        handler,
+        inline_code,
+        all_imports,
+        all_packages,
+        upload_file_stage_location,
+        custom_python_runtime_version_allowed,
+    )
 
 
 def create_python_udf_or_sp(
     session: "snowflake.snowpark.Session",
     return_type: DataType,
     input_args: List[UDFColumn],
     handler: str,
@@ -673,18 +952,25 @@
     if_not_exists: bool,
     inline_python_code: Optional[str] = None,
     execute_as: Optional[typing.Literal["caller", "owner"]] = None,
     api_call_source: Optional[str] = None,
     strict: bool = False,
     secure: bool = False,
 ) -> None:
+    runtime_version = (
+        f"{sys.version_info[0]}.{sys.version_info[1]}"
+        if not session._runtime_version_from_requirement
+        else session._runtime_version_from_requirement
+    )
     if replace and if_not_exists:
         raise ValueError("options replace and if_not_exists are incompatible")
     if isinstance(return_type, StructType):
         return_sql = f'RETURNS TABLE ({",".join(f"{field.name} {convert_sp_to_sf_type(field.datatype)}" for field in return_type.fields)})'
+    elif isinstance(return_type, PandasDataFrameType):
+        return_sql = f'RETURNS TABLE ({",".join(f"{name} {convert_sp_to_sf_type(datatype)}" for name, datatype in zip(return_type.col_names, return_type.col_types))})'
     else:
         return_sql = f"RETURNS {convert_sp_to_sf_type(return_type)}"
     input_sql_types = [convert_sp_to_sf_type(arg.datatype) for arg in input_args]
     sql_func_args = ",".join(
         [f"{a.name} {t}" for a, t in zip(input_args, input_sql_types)]
     )
     imports_in_sql = f"IMPORTS=({all_imports})" if all_imports else ""
@@ -709,18 +995,18 @@
         else ""
     )
 
     strict_as_sql = "\nSTRICT" if strict else ""
 
     create_query = f"""
 CREATE{" OR REPLACE " if replace else ""}
-{"TEMPORARY" if is_temporary else ""} {"SECURE" if secure else ""} {object_type.value} {"IF NOT EXISTS" if if_not_exists else ""} {object_name}({sql_func_args})
+{"TEMPORARY" if is_temporary else ""} {"SECURE" if secure else ""} {object_type.value.replace("_", " ")} {"IF NOT EXISTS" if if_not_exists else ""} {object_name}({sql_func_args})
 {return_sql}
 LANGUAGE PYTHON {strict_as_sql}
-RUNTIME_VERSION={sys.version_info[0]}.{sys.version_info[1]}
+RUNTIME_VERSION={runtime_version}
 {imports_in_sql}
 {packages_in_sql}
 HANDLER='{handler}'{execute_as_sql}
 {inline_python_code_in_sql}
 """
     session._run_query(create_query, is_ddl_on_temp_object=is_temporary)
 
@@ -737,15 +1023,21 @@
     input_args: List[UDFColumn],
     handler: str,
     object_name: str,
     all_imports: str,
     all_packages: str,
     inline_python_code: Optional[str] = None,
     strict: bool = False,
+    runtime_version: Optional[str] = None,
 ):
+    runtime_version = (
+        f"{sys.version_info[0]}.{sys.version_info[1]}"
+        if not runtime_version
+        else runtime_version
+    )
     if isinstance(return_type, StructType):
         return_sql = f'RETURNS TABLE ({",".join(f"{field.name} {convert_sp_to_sf_type(field.datatype)}" for field in return_type.fields)})'
     else:
         return_sql = f"RETURNS {convert_sp_to_sf_type(return_type)}"
     input_sql_types = [convert_sp_to_sf_type(arg.datatype) for arg in input_args]
     sql_func_args = ",".join(
         [f"{a.name} {t}" for a, t in zip(input_args, input_sql_types)]
@@ -763,15 +1055,15 @@
     )
     strict_as_sql = "\nSTRICT" if strict else ""
 
     sql = f"""
 WITH {object_name} AS PROCEDURE ({sql_func_args})
 {return_sql}
 LANGUAGE PYTHON {strict_as_sql}
-RUNTIME_VERSION={sys.version_info[0]}.{sys.version_info[1]}
+RUNTIME_VERSION={runtime_version}
 {imports_in_sql}
 {packages_in_sql}
 HANDLER='{handler}'
 {inline_python_code_in_sql}
 """
     return sql
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/_internal/utils.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/_internal/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -123,15 +123,15 @@
 
 MODULE_NAME_TO_PACKAGE_NAME_MAP = {
     v: k for k, v in PACKAGE_NAME_TO_MODULE_NAME_MAP.items()
 }
 
 GENERATED_PY_FILE_EXT = (".pyc", ".pyo", ".pyd", ".pyi")
 
-INFER_SCHEMA_FORMAT_TYPES = ("PARQUET", "ORC", "AVRO")
+INFER_SCHEMA_FORMAT_TYPES = ("PARQUET", "ORC", "AVRO", "JSON", "CSV")
 
 COPY_OPTIONS = {
     "ON_ERROR",
     "SIZE_LIMIT",
     "PURGE",
     "RETURN_FAILED_ONLY",
     "MATCH_BY_COLUMN_NAME",
@@ -175,14 +175,15 @@
     FUNCTION = "FUNCTION"
     FILE_FORMAT = "FILE_FORMAT"
     QUERY_TAG = "QUERY_TAG"
     COLUMN = "COLUMN"
     PROCEDURE = "PROCEDURE"
     TABLE_FUNCTION = "TABLE_FUNCTION"
     DYNAMIC_TABLE = "DYNAMIC_TABLE"
+    AGGREGATE_FUNCTION = "AGGREGATE_FUNCTION"
 
 
 def validate_object_name(name: str):
     if not SNOWFLAKE_OBJECT_RE_PATTERN.match(name):
         raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(name)
 
 
@@ -619,14 +620,35 @@
             return func(*args, **kwargs)
 
         return func_call_wrapper
 
     return wrapper
 
 
+def param_decorator(
+    decorator_type: Literal["deprecated", "experimental", "in private preview"],
+    *,
+    version: str,
+) -> Callable:
+    def wrapper(param_setter_function):
+        warning_text = (
+            f"Parameter {param_setter_function.__name__} is {decorator_type} since {version}. "
+            f"{'Do not use it in production. ' if decorator_type in ('experimental', 'in private preview') else ''}"
+        )
+
+        @functools.wraps(param_setter_function)
+        def func_call_wrapper(*args, **kwargs):
+            warning(param_setter_function.__name__, warning_text)
+            return param_setter_function(*args, **kwargs)
+
+        return func_call_wrapper
+
+    return wrapper
+
+
 def deprecated(
     *, version: str, extra_warning_text: str = "", extra_doc_string: str = ""
 ) -> Callable:
     return func_decorator(
         "deprecated",
         version=version,
         extra_warning_text=extra_warning_text,
@@ -641,14 +663,21 @@
         "experimental",
         version=version,
         extra_warning_text=extra_warning_text,
         extra_doc_string=extra_doc_string,
     )
 
 
+def experimental_parameter(*, version: str) -> Callable:
+    return param_decorator(
+        "experimental",
+        version=version,
+    )
+
+
 def private_preview(
     *, version: str, extra_warning_text: str = "", extra_doc_string: str = ""
 ) -> Callable:
     return func_decorator(
         "in private preview",
         version=version,
         extra_warning_text=extra_warning_text,
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/async_job.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/async_job.py`

 * *Files 4% similar despite different names*

```diff
@@ -50,14 +50,15 @@
     ``_nowait`` execute asynchronously and create an :class:`AsyncJob` instance. They are also
     equivalent to corresponding functions in :class:`DataFrame` and other classes that set
     ``block=False``. Therefore, to use it, you need to create a dataframe first. Here we demonstrate
     how to do that:
 
     First, we create a dataframe:
         >>> from snowflake.snowpark.functions import when_matched, when_not_matched
+        >>> from snowflake.snowpark.types import IntegerType, StringType, StructField, StructType
         >>> df = session.create_dataframe([[float(4), 3, 5], [2.0, -4, 7], [3.0, 5, 6],[4.0,6,8]], schema=["a", "b", "c"])
 
     Example 1
         :meth:`DataFrame.collect` can be performed asynchronously::
 
             >>> async_job = df.collect_nowait()
             >>> async_job.result()
@@ -105,18 +106,19 @@
             >>> async_job = df.write.copy_into_location(remote_location, block=False)
             >>> async_job.result()[0]['rows_unloaded']
             4
 
     Example 7
         :meth:`Table.merge`, :meth:`Table.update`, :meth:`Table.delete` can also be performed asynchronously::
 
-            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
+            >>> schema = StructType([StructField("key", IntegerType()), StructField("value", StringType())])
+            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=schema)
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
-            >>> source = session.create_dataframe([(10, "new"), (12, "new"), (13, "old")], schema=["key", "value"])
+            >>> source = session.create_dataframe([(10, "new"), (12, "new"), (13, "old")], schema=schema)
             >>> async_job = target.merge(source,target["key"] == source["key"],[when_matched().update({"value": source["value"]}),when_not_matched().insert({"key": source["key"]})],block=False)
             >>> async_job.result()
             MergeResult(rows_inserted=2, rows_updated=2, rows_deleted=0)
 
     Example 8
         Cancel the running query associated with the dataframe::
 
@@ -132,24 +134,24 @@
             >>> start = time()
             >>> res = [df.collect() for df in dfs]
             >>> time1 = time() - start
             >>> start = time()
             >>> async_jobs = [df.collect_nowait() for df in dfs]
             >>> res = [async_job.result() for async_job in async_jobs]
             >>> time2 = time() - start
-            >>> time2 < time1
+            >>> time2 < time1 # doctest: +SKIP
             True
 
     Example 10
         Creating an :class:`AsyncJob` from an existing query ID, retrieving results and converting it back to a :class:`DataFrame`:
 
             >>> from snowflake.snowpark.functions import col
             >>> query_id = session.sql("select 1 as A, 2 as B, 3 as C").collect_nowait().query_id
             >>> async_job = session.create_async_job(query_id)
-            >>> async_job.query
+            >>> async_job.query # doctest: +SKIP
             'select 1 as A, 2 as B, 3 as C'
             >>> async_job.result()
             [Row(A=1, B=2, C=3)]
             >>> async_job.result(result_type="pandas")
                A  B  C
             0  1  2  3
             >>> df = async_job.to_df()
@@ -178,25 +180,27 @@
         query_id: str,
         query: Optional[str],
         session: "snowflake.snowpark.session.Session",
         result_type: _AsyncResultType = _AsyncResultType.ROW,
         post_actions: Optional[List[Query]] = None,
         log_on_exception: bool = False,
         case_sensitive: bool = True,
+        num_statements: Optional[int] = None,
         **kwargs,
     ) -> None:
         self.query_id: str = query_id  #: The query ID of the executed query
         self._query = query
         self._can_query_be_retrieved = True
         self._session = session
         self._cursor = session._conn._conn.cursor()
         self._result_type = result_type
         self._post_actions = post_actions if post_actions else []
         self._log_on_exception = log_on_exception
         self._case_sensitive = case_sensitive
+        self._num_statements = num_statements
         self._parameters = kwargs
         self._result_meta = None
         self._inserted = False
         self._updated = False
         self._deleted = False
 
     @property
@@ -327,14 +331,27 @@
                 corresponding type. If you still provide a value for it, this value will overwrite
                 the original result data type.
         """
         result_type = (
             _AsyncResultType(result_type.lower()) if result_type else self._result_type
         )
         self._cursor.get_results_from_sfqid(self.query_id)
+        if self._num_statements is not None:
+            for _ in range(self._num_statements - 1):
+                self._cursor.nextset()
+
+            # The intermediate result is in JSON format, which cannot be converted to pandas. We need to do a result
+            # scan to have Snowflake read the result and return Arrow format.
+            # TODO: Once we support fetch_pandas_all for multi-statement query in connector, we could remove this
+            #   workaround.
+            if result_type in (_AsyncResultType.PANDAS, _AsyncResultType.PANDAS_BATCH):
+                self._cursor.execute(
+                    f"select * from table(result_scan('{self._cursor.sfqid}'))"
+                )
+
         if result_type == _AsyncResultType.NO_RESULT:
             result = None
         elif result_type == _AsyncResultType.PANDAS:
             result = self._session._conn._to_data_or_iter(
                 self._cursor, to_pandas=True, to_iter=False
             )["data"]
             check_is_pandas_dataframe_in_to_pandas(result)
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/column.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/column.py`

 * *Files 1% similar despite different names*

```diff
@@ -335,14 +335,17 @@
         )
 
     def __round__(self, n=None):
         raise TypeError(
             "Column cannot be rounded. This error can occur when you use the Python built-in round. Please make sure you use the snowflake.snowpark.functions.round function instead."
         )
 
+    def __hash__(self):
+        return hash(self._expression)
+
     def in_(
         self,
         *vals: Union[
             LiteralType,
             Iterable[LiteralType],
             "snowflake.snowpark.DataFrame",
         ],
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/context.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/context.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe.py`

 * *Files 1% similar despite different names*

```diff
@@ -77,14 +77,15 @@
 from snowflake.snowpark._internal.analyzer.unary_plan_node import (
     CreateDynamicTableCommand,
     CreateViewCommand,
     Filter,
     LocalTempView,
     PersistedView,
     Project,
+    Rename,
     Sample,
     Sort,
     Unpivot,
     ViewType,
 )
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import (
@@ -1572,15 +1573,15 @@
             ... (1, 400, 'JAN'),
             ... (2, 4500, 'JAN'),
             ... (2, 35000, 'JAN'),
             ... (1, 5000, 'FEB'),
             ... (1, 3000, 'FEB'),
             ... (2, 200, 'FEB') ''').collect()
             >>> df = session.table("monthly_sales")
-            >>> df.pivot("month", ['JAN', 'FEB']).sum("amount").show()
+            >>> df.pivot("month", ['JAN', 'FEB']).sum("amount").sort(df["empid"]).show()
             -------------------------------
             |"EMPID"  |"'JAN'"  |"'FEB'"  |
             -------------------------------
             |1        |10400    |8000     |
             |2        |39500    |200      |
             -------------------------------
             <BLANKLINE>
@@ -3361,14 +3362,86 @@
             "DataFrame.describe",
             precalls=self._plan.api_calls,
             subcalls=res_df._plan.api_calls.copy(),
         )
         return res_df
 
     @df_api_usage
+    def rename(
+        self,
+        col_or_mapper: Union[ColumnOrName, dict],
+        new_column: str = None,
+    ):
+        """
+        Returns a DataFrame with the specified column ``col_or_mapper`` renamed as ``new_column``. If ``col_or_mapper``
+        is a dictionary, multiple columns will be renamed in the returned DataFrame.
+
+        Example::
+            >>> # This example renames the column `A` as `NEW_A` in the DataFrame.
+            >>> df = session.sql("select 1 as A, 2 as B")
+            >>> df_renamed = df.rename(col("A"), "NEW_A")
+            >>> df_renamed.show()
+            -----------------
+            |"NEW_A"  |"B"  |
+            -----------------
+            |1        |2    |
+            -----------------
+            <BLANKLINE>
+            >>> # This example renames the column `A` as `NEW_A` and `B` as `NEW_B` in the DataFrame.
+            >>> df = session.sql("select 1 as A, 2 as B")
+            >>> df_renamed = df.rename({col("A"): "NEW_A", "B":"NEW_B"})
+            >>> df_renamed.show()
+            ---------------------
+            |"NEW_A"  |"NEW_B"  |
+            ---------------------
+            |1        |2        |
+            ---------------------
+            <BLANKLINE>
+
+        Args:
+            col_or_mapper: The old column instance or column name to be renamed, or the dictionary mapping from column instances or columns names to their new names (string)
+            new_column: The new column name (string value), if a single old column is given
+        """
+        if new_column is not None:
+            return self.with_column_renamed(col_or_mapper, new_column)
+
+        if not isinstance(col_or_mapper, dict):
+            raise ValueError(
+                f"If new_column parameter is not specified, col_or_mapper needs to be of type dict, "
+                f"not {type(col_or_mapper).__name__}"
+            )
+
+        if len(col_or_mapper) == 0:
+            raise ValueError("col_or_mapper dictionary cannot be empty")
+
+        column_or_name_list, rename_list = zip(*col_or_mapper.items())
+        for name in rename_list:
+            if not isinstance(name, str):
+                raise TypeError(
+                    f"You cannot rename a column using value {name} of type {type(name).__name__} as it "
+                    f"is not a string."
+                )
+
+        names = self._get_column_names_from_column_or_name_list(column_or_name_list)
+        normalized_name_list = [quote_name(n) for n in names]
+        rename_map = {k: v for k, v in zip(normalized_name_list, rename_list)}
+        rename_plan = Rename(rename_map, self._plan)
+
+        if self._select_statement:
+            return self._with_plan(
+                SelectStatement(
+                    from_=SelectSnowflakePlan(
+                        rename_plan, analyzer=self._session._analyzer
+                    ),
+                    analyzer=self._session._analyzer,
+                )
+            )
+        return self._with_plan(rename_plan)
+
+    @df_api_usage
     def with_column_renamed(self, existing: ColumnOrName, new: str) -> "DataFrame":
         """Returns a DataFrame with the specified column ``existing`` renamed as ``new``.
 
         Example::
 
             >>> # This example renames the column `A` as `NEW_A` in the DataFrame.
             >>> df = session.sql("select 1 as A, 2 as B")
@@ -3380,16 +3453,14 @@
             |1        |2    |
             -----------------
             <BLANKLINE>
 
         Args:
             existing: The old column instance or column name to be renamed.
             new: The new column name.
-
-        :meth:`with_column_renamed` is an alias of :meth:`rename`.
         """
         new_quoted_name = quote_name(new)
         if isinstance(existing, str):
             old_name = quote_name(existing)
         elif isinstance(existing, Column):
             if isinstance(existing._expression, Attribute):
                 att = existing._expression
@@ -3404,15 +3475,15 @@
             elif isinstance(existing._expression, NamedExpression):
                 old_name = existing._expression.name
             else:
                 raise ValueError(
                     f"Unable to rename column {existing} because it doesn't exist."
                 )
         else:
-            raise TypeError("'exisitng' must be a column name or Column object.")
+            raise TypeError(f"{str(existing)} must be a column name or Column object.")
 
         to_be_renamed = [x for x in self._output if x.name.upper() == old_name.upper()]
         if not to_be_renamed:
             raise ValueError(
                 f'Unable to rename column "{existing}" because it doesn\'t exist.'
             )
         elif len(to_be_renamed) > 1:
@@ -3482,15 +3553,16 @@
         Args:
             statement_params: Dictionary of statement level parameters to be set while executing this action.
 
         Returns:
              A :class:`Table` object that holds the cached result in a temporary table.
              All operations on this new DataFrame have no effect on the original.
         """
-        temp_table_name = random_name_for_temp_object(TempObjectType.TABLE)
+        temp_table_name = f'{self._session.get_current_database()}.{self._session.get_current_schema()}."{random_name_for_temp_object(TempObjectType.TABLE)}"'
+
         create_temp_table = self._session._plan_builder.create_temp_table(
             temp_table_name,
             self._plan,
             use_scoped_temp_objects=self._session._use_scoped_temp_objects,
             is_generated=True,
         )
         self._session._conn.execute(
@@ -3646,14 +3718,44 @@
         return dtypes
 
     def _with_plan(self, plan) -> "DataFrame":
         df = DataFrame(self._session, plan)
         df._statement_params = self._statement_params
         return df
 
+    def _get_column_names_from_column_or_name_list(
+        self, exprs: List[ColumnOrName]
+    ) -> List:
+        names = []
+        for c in exprs:
+            if isinstance(c, str):
+                names.append(c)
+            elif isinstance(c, Column) and isinstance(c._expression, Attribute):
+                names.append(
+                    self._plan.expr_to_alias.get(
+                        c._expression.expr_id, c._expression.name
+                    )
+                )
+            elif (
+                isinstance(c, Column)
+                and isinstance(c._expression, UnresolvedAttribute)
+                and c._expression.df_alias
+            ):
+                names.append(
+                    self._plan.df_aliased_col_name_to_real_col_name.get(
+                        c._expression.name, c._expression.name
+                    )
+                )
+            elif isinstance(c, Column) and isinstance(c._expression, NamedExpression):
+                names.append(c._expression.name)
+            else:
+                raise TypeError(f"{str(c)} must be a column name or Column object.")
+
+        return names
+
     def _convert_cols_to_exprs(
         self,
         calling_method: str,
         *cols: Union[ColumnOrName, Iterable[ColumnOrName]],
     ) -> List[Expression]:
         """Convert a string or a Column, or a list of string and Column objects to expression(s)."""
 
@@ -3704,10 +3806,7 @@
     orderBy = order_by
 
     # These methods are not needed for code migration. So no aliases for them.
     # groupByGrouping_sets = group_by_grouping_sets
     # joinTableFunction = join_table_function
     # naturalJoin = natural_join
     # withColumns = with_columns
-
-    # Add this alias because snowpark scala has rename
-    rename = with_column_renamed
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_na_functions.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_na_functions.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_reader.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_reader.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,13 +1,14 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import sys
-from typing import Any, Dict, List, Optional, Union
+from logging import getLogger
+from typing import Any, Dict, List, Optional, Tuple, Union
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.analyzer_utils import (
     create_file_format_statement,
     drop_file_format_if_exists_statement,
     infer_schema_statement,
     quote_name_without_upper_casing,
@@ -36,14 +37,16 @@
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
 if sys.version_info <= (3, 9):
     from typing import Iterable
 else:
     from collections.abc import Iterable
 
+logger = getLogger(__name__)
+
 
 class DataFrameReader:
     """Provides methods to load data in various supported formats from a Snowflake
     stage to a :class:`DataFrame`. The paths provided to the DataFrameReader must refer
     to Snowflake stages.
 
     To use this object:
@@ -57,14 +60,15 @@
     specifying copy options can make error handling more robust during the reading
     process, it may have an effect on performance.)
 
     3. Specify the schema of the data that you plan to load by constructing a
     :class:`types.StructType` object and passing it to the :func:`schema` method if the file format is CSV. Other file
     formats such as JSON, XML, Parquet, ORC, and AVRO don't accept a schema.
     This method returns a :class:`DataFrameReader` that is configured to read data that uses the specified schema.
+    Currently, inferring schema is also supported for CSV and JSON formats as a preview feature open to all accounts.
 
     4. Specify the format of the data by calling the method named after the format
     (e.g. :func:`csv`, :func:`json`, etc.). These methods return a :class:`DataFrame`
     that is configured to load data in the specified format.
 
     5. Call a :class:`DataFrame` method that performs an action (e.g.
     :func:`DataFrame.collect`) to load the data from the file.
@@ -246,30 +250,70 @@
             |"METADATA$FILENAME"  |"ROW NUMBER"  |"A"  |"B"  |"C"  |
             --------------------------------------------------------
             |testCSV.csv          |1             |1    |one  |1.2  |
             |testCSV.csv          |2             |2    |two  |2.2  |
             --------------------------------------------------------
             <BLANKLINE>
 
+    Example 12:
+        Inferring schema for csv and json files (Preview Feature - Open):
+            >>> # Read a csv file without a header
+            >>> df = session.read.option("INFER_SCHEMA", True).csv("@mystage/testCSV.csv")
+            >>> df.show()
+            ----------------------
+            |"c1"  |"c2"  |"c3"  |
+            ----------------------
+            |1     |one   |1.2   |
+            |2     |two   |2.2   |
+            ----------------------
+            <BLANKLINE>
+
+            >>> # Read a csv file with header and parse the header
+            >>> _ = session.file.put("tests/resources/testCSVheader.csv", "@mystage", auto_compress=False)
+            >>> df = session.read.option("INFER_SCHEMA", True).option("PARSE_HEADER", True).csv("@mystage/testCSVheader.csv")
+            >>> df.show()
+            ----------------------------
+            |"id"  |"name"  |"rating"  |
+            ----------------------------
+            |1     |one     |1.2       |
+            |2     |two     |2.2       |
+            ----------------------------
+            <BLANKLINE>
+
+            >>> df = session.read.option("INFER_SCHEMA", True).json("@mystage/testJson.json")
+            >>> df.show()
+            ------------------------------
+            |"color"  |"fruit"  |"size"  |
+            ------------------------------
+            |Red      |Apple    |Large   |
+            |Red      |Apple    |Large   |
+            ------------------------------
+            <BLANKLINE>
     """
 
     def __init__(self, session: "snowflake.snowpark.session.Session") -> None:
         self._session = session
         self._user_schema: Optional[StructType] = None
         self._cur_options: dict[str, Any] = {}
         self._file_path: Optional[str] = None
         self._file_type: Optional[str] = None
         self._metadata_cols: Optional[Iterable[ColumnOrName]] = None
         # Infer schema information
-        self._infer_schema = False
         self._infer_schema_transformations: Optional[
             List["snowflake.snowpark.column.Column"]
         ] = None
         self._infer_schema_target_columns: Optional[List[str]] = None
 
+    @property
+    def _infer_schema(self):
+        # let _cur_options to be the source of truth
+        if self._file_type in INFER_SCHEMA_FORMAT_TYPES:
+            return self._cur_options.get("INFER_SCHEMA", True)
+        return False
+
     def table(self, name: Union[str, Iterable[str]]) -> Table:
         """Returns a Table that points to the specified table.
 
         This method is an alias of :meth:`~snowflake.snowpark.session.Session.table`.
 
         Args:
             name: Name of the table to use.
@@ -310,19 +354,44 @@
 
         Args:
             path: The stage location of a CSV file, or a stage location that has CSV files.
 
         Returns:
             a :class:`DataFrame` that is set up to load data from the specified CSV file(s) in a Snowflake stage.
         """
+        self._file_path = path
+        self._file_type = "CSV"
+
+        # infer schema is set to false by default
+        if "INFER_SCHEMA" not in self._cur_options:
+            self._cur_options["INFER_SCHEMA"] = False
+        schema_to_cast, transformations = None, None
+
         if not self._user_schema:
-            raise SnowparkClientExceptionMessages.DF_MUST_PROVIDE_SCHEMA_FOR_READING_FILE()
+            if not self._infer_schema:
+                raise SnowparkClientExceptionMessages.DF_MUST_PROVIDE_SCHEMA_FOR_READING_FILE()
 
-        self._file_path = path
-        self._file_type = "csv"
+            (
+                schema,
+                schema_to_cast,
+                transformations,
+                exception,
+            ) = self._infer_schema_for_file_format(path, "CSV")
+            if exception is not None:
+                # if infer schema query fails, use $1, VariantType as schema
+                logger.warn(
+                    f"Could not infer csv schema due to exception: {exception}. "
+                    "\nUsing schema (C1, VariantType()) instead. Please use DataFrameReader.schema() "
+                    "to specify user schema for the file."
+                )
+                schema = [Attribute('"C1"', VariantType(), True)]
+                schema_to_cast = [("$1", "C1")]
+                transformations = []
+        else:
+            schema = self._user_schema._to_attributes()
 
         if self._metadata_cols:
             metadata_project = [
                 self._session._analyzer.analyze(col._expression, {})
                 for col in self._metadata_cols
             ]
         else:
@@ -334,15 +403,17 @@
                 SelectStatement(
                     from_=SelectSnowflakePlan(
                         self._session._plan_builder.read_file(
                             path,
                             self._file_type,
                             self._cur_options,
                             self._session.get_fully_qualified_current_schema(),
-                            self._user_schema._to_attributes(),
+                            schema,
+                            schema_to_cast=schema_to_cast,
+                            transformations=transformations,
                             metadata_project=metadata_project,
                         ),
                         analyzer=self._session._analyzer,
                     ),
                     analyzer=self._session._analyzer,
                 ),
             )
@@ -350,15 +421,17 @@
             df = DataFrame(
                 self._session,
                 self._session._plan_builder.read_file(
                     path,
                     self._file_type,
                     self._cur_options,
                     self._session.get_fully_qualified_current_schema(),
-                    self._user_schema._to_attributes(),
+                    schema,
+                    schema_to_cast=schema_to_cast,
+                    transformations=transformations,
                     metadata_project=metadata_project,
                 ),
             )
         df._reader = self
         set_api_call_source(df, "DataFrameReader.csv")
         return df
 
@@ -367,14 +440,17 @@
 
         Args:
             path: The stage location of a JSON file, or a stage location that has JSON files.
 
         Returns:
             a :class:`DataFrame` that is set up to load data from the specified JSON file(s) in a Snowflake stage.
         """
+        # infer_schema is set to false by default for JSON
+        if "INFER_SCHEMA" not in self._cur_options:
+            self._cur_options["INFER_SCHEMA"] = False
         return self._read_semi_structured_file(path, "JSON")
 
     def avro(self, path: str) -> DataFrame:
         """Specify the path of the AVRO file(s) to load.
 
         Args:
             path: The stage location of an AVRO file, or a stage location that has AVRO files.
@@ -461,101 +537,109 @@
             configs: Dictionary of the names of options (e.g. ``compression``,
                 ``skip_header``, etc.) and their corresponding values.
         """
         for k, v in configs.items():
             self.option(k, v)
         return self
 
+    def _infer_schema_for_file_format(
+        self, path: str, format: str
+    ) -> Tuple[List, List, List, Exception]:
+        format_type_options, _ = get_copy_into_table_options(self._cur_options)
+
+        temp_file_format_name = (
+            self._session.get_fully_qualified_current_schema()
+            + "."
+            + random_name_for_temp_object(TempObjectType.FILE_FORMAT)
+        )
+        drop_tmp_file_format_if_exists_query: Optional[str] = None
+        use_temp_file_format = "FORMAT_NAME" not in self._cur_options
+        file_format_name = self._cur_options.get("FORMAT_NAME", temp_file_format_name)
+        infer_schema_query = infer_schema_statement(path, file_format_name)
+        try:
+            if use_temp_file_format:
+                self._session._conn.run_query(
+                    create_file_format_statement(
+                        file_format_name,
+                        format,
+                        format_type_options,
+                        temp=True,
+                        if_not_exist=True,
+                        use_scoped_temp_objects=self._session._use_scoped_temp_objects,
+                        is_generated=True,
+                    ),
+                    is_ddl_on_temp_object=True,
+                )
+                drop_tmp_file_format_if_exists_query = (
+                    drop_file_format_if_exists_statement(file_format_name)
+                )
+            results = self._session._conn.run_query(infer_schema_query)["data"]
+            new_schema = []
+            schema_to_cast = []
+            transformations: List["snowflake.snowpark.column.Column"] = []
+            read_file_transformations = None
+            for r in results:
+                # Columns for r [column_name, type, nullable, expression, filenames]
+                name = quote_name_without_upper_casing(r[0])
+                # Parse the type returned by infer_schema command to
+                # pass to determine datatype for schema
+                data_type_parts = r[1].split("(")
+                parts_length = len(data_type_parts)
+                if parts_length == 1:
+                    data_type = r[1]
+                    precision = 0
+                    scale = 0
+                else:
+                    data_type = data_type_parts[0]
+                    precision = int(data_type_parts[1].split(",")[0])
+                    scale = int(data_type_parts[1].split(",")[1][:-1])
+                new_schema.append(
+                    Attribute(
+                        name,
+                        convert_sf_to_sp_type(data_type, precision, scale, 0),
+                        r[2],
+                    )
+                )
+                identifier = f"$1:{name}::{r[1]}" if format != "CSV" else r[3]
+                schema_to_cast.append((identifier, r[0]))
+                transformations.append(sql_expr(identifier))
+            self._user_schema = StructType._from_attributes(new_schema)
+            # If the user sets transformations, we should not override this
+            self._infer_schema_transformations = transformations
+            self._infer_schema_target_columns = self._user_schema.names
+            read_file_transformations = [t._expression.sql for t in transformations]
+        except Exception as e:
+            return None, None, None, e
+        finally:
+            # Clean up the file format we created
+            if drop_tmp_file_format_if_exists_query is not None:
+                self._session._conn.run_query(
+                    drop_tmp_file_format_if_exists_query, is_ddl_on_temp_object=True
+                )
+
+        return new_schema, schema_to_cast, read_file_transformations, None
+
     def _read_semi_structured_file(self, path: str, format: str) -> DataFrame:
         if self._user_schema:
             raise ValueError(f"Read {format} does not support user schema")
         self._file_path = path
         self._file_type = format
 
-        format_type_options, _ = get_copy_into_table_options(self._cur_options)
-
-        self._infer_schema = (
-            self._cur_options.get("INFER_SCHEMA", True)
-            if format in INFER_SCHEMA_FORMAT_TYPES
-            else False
-        )
-
         schema = [Attribute('"$1"', VariantType())]
         read_file_transformations = None
         schema_to_cast = None
-        drop_tmp_file_format_if_exists_query: Optional[str] = None
         if self._infer_schema:
-            temp_file_format_name = (
-                self._session.get_fully_qualified_current_schema()
-                + "."
-                + random_name_for_temp_object(TempObjectType.FILE_FORMAT)
-            )
-            use_temp_file_format = "FORMAT_NAME" not in self._cur_options
-            file_format_name = self._cur_options.get(
-                "FORMAT_NAME", temp_file_format_name
-            )
-            infer_schema_query = infer_schema_statement(path, file_format_name)
-            try:
-                if use_temp_file_format:
-                    self._session._conn.run_query(
-                        create_file_format_statement(
-                            file_format_name,
-                            format,
-                            format_type_options,
-                            temp=True,
-                            if_not_exist=True,
-                            use_scoped_temp_objects=self._session._use_scoped_temp_objects,
-                            is_generated=True,
-                        ),
-                        is_ddl_on_temp_object=True,
-                    )
-                    drop_tmp_file_format_if_exists_query = (
-                        drop_file_format_if_exists_statement(file_format_name)
-                    )
-                results = self._session._conn.run_query(infer_schema_query)["data"]
-                new_schema = []
-                schema_to_cast = []
-                transformations: List["snowflake.snowpark.column.Column"] = []
-                for r in results:
-                    # Columns for r [column_name, type, nullable, expression, filenames]
-                    name = quote_name_without_upper_casing(r[0])
-                    # Parse the type returned by infer_schema command to
-                    # pass to determine datatype for schema
-                    data_type_parts = r[1].split("(")
-                    parts_length = len(data_type_parts)
-                    if parts_length == 1:
-                        data_type = r[1]
-                        precision = 0
-                        scale = 0
-                    else:
-                        data_type = data_type_parts[0]
-                        precision = int(data_type_parts[1].split(",")[0])
-                        scale = int(data_type_parts[1].split(",")[1][:-1])
-                    new_schema.append(
-                        Attribute(
-                            name,
-                            convert_sf_to_sp_type(data_type, precision, scale, 0),
-                            r[2],
-                        )
-                    )
-                    identifier = f"$1:{name}::{r[1]}"
-                    schema_to_cast.append((identifier, r[0]))
-                    transformations.append(sql_expr(identifier))
+            (
+                new_schema,
+                schema_to_cast,
+                read_file_transformations,
+                _,  # we don't check for error in case of infer schema failures. We use $1, Variant type
+            ) = self._infer_schema_for_file_format(path, format)
+            if new_schema:
                 schema = new_schema
-                self._user_schema = StructType._from_attributes(schema)
-                # If the user sets transformations, we should not override this
-                self._infer_schema_transformations = transformations
-                self._infer_schema_target_columns = self._user_schema.names
-                read_file_transformations = [t._expression.sql for t in transformations]
-            finally:
-                # Clean up the file format we created
-                if drop_tmp_file_format_if_exists_query is not None:
-                    self._session._conn.run_query(
-                        drop_tmp_file_format_if_exists_query, is_ddl_on_temp_object=True
-                    )
 
         if self._metadata_cols:
             metadata_project = [
                 self._session._analyzer.analyze(col._expression, {})
                 for col in self._metadata_cols
             ]
         else:
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_stat_functions.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_stat_functions.py`

 * *Files 0% similar despite different names*

```diff
@@ -182,15 +182,15 @@
 
         Note:
             The number of distinct values in ``col2`` should not exceed 1000.
 
         Example::
 
             >>> df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])
-            >>> ct = df.stat.crosstab("key", "value")
+            >>> ct = df.stat.crosstab("key", "value").sort(df["key"])
             >>> ct.show()
             ---------------------------------------------------------------------------------------------
             |"KEY"  |"CAST(1 AS NUMBER(38,0))"  |"CAST(2 AS NUMBER(38,0))"  |"CAST(3 AS NUMBER(38,0))"  |
             ---------------------------------------------------------------------------------------------
             |1      |1                          |1                          |0                          |
             |2      |2                          |0                          |1                          |
             |3      |0                          |1                          |1                          |
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/dataframe_writer.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/dataframe_writer.py`

 * *Files 2% similar despite different names*

```diff
@@ -57,21 +57,21 @@
 
     def mode(self, save_mode: str) -> "DataFrameWriter":
         """Set the save mode of this :class:`DataFrameWriter`.
 
         Args:
             save_mode: One of the following strings.
 
-                "append": Append data of this DataFrame to existing data.
+                "append": Append data of this DataFrame to the existing table. Creates a table if it does not exist.
 
-                "overwrite": Overwrite existing data.
+                "overwrite": Overwrite the existing table.
 
-                "errorifexists": Throw an exception if data already exists.
+                "errorifexists": Throw an exception if the table already exists.
 
-                "ignore": Ignore this operation if data already exists.
+                "ignore": Ignore this operation if the table already exists.
 
                 Default value is "errorifexists".
 
         Returns:
             The :class:`DataFrameWriter` itself.
         """
         self._save_mode = str_to_enum(save_mode.lower(), SaveMode, "`save_mode`")
@@ -122,21 +122,21 @@
         Args:
             table_name: A string or list of strings representing table name.
                 If input is a string, it represents the table name; if input is of type iterable of strings,
                 it represents the fully-qualified object identifier (database name, schema name, and table name).
             mode: One of the following values. When it's ``None`` or not provided,
                 the save mode set by :meth:`mode` is used.
 
-                "append": Append data of this DataFrame to existing data.
+                "append": Append data of this DataFrame to the existing table. Creates a table if it does not exist.
 
-                "overwrite": Overwrite existing data.
+                "overwrite": Overwrite the existing table.
 
-                "errorifexists": Throw an exception if data already exists.
+                "errorifexists": Throw an exception if the table already exists.
 
-                "ignore": Ignore this operation if data already exists.
+                "ignore": Ignore this operation if the table already exists.
 
             column_order: When ``mode`` is "append", data will be inserted into the target table by matching column sequence or column name. Default is "index". When ``mode`` is not "append", the ``column_order`` makes no difference.
 
                 "index": Data will be inserted into the target table by column sequence.
                 "name": Data will be inserted into the target table by matching column names. If the target table has more columns than the source DataFrame, use this one.
 
             create_temp_table: (Deprecated) The to-be-created table will be temporary if this is set to ``True``.
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/exceptions.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/exceptions.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/file_operation.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/file_operation.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/files.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/files.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/functions.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/functions.py`

 * *Files 4% similar despite different names*

```diff
@@ -487,16339 +487,17722 @@
 00001e60: 4f72 5371 6c45 7870 722c 0a20 2020 204c  OrSqlExpr,.    L
 00001e70: 6974 6572 616c 5479 7065 2c0a 290a 6672  iteralType,.).fr
 00001e80: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
 00001e90: 7770 6172 6b2e 5f69 6e74 6572 6e61 6c2e  wpark._internal.
 00001ea0: 7574 696c 7320 696d 706f 7274 2028 0a20  utils import (. 
 00001eb0: 2020 2070 6172 7365 5f70 6f73 6974 696f     parse_positio
 00001ec0: 6e61 6c5f 6172 6773 5f74 6f5f 6c69 7374  nal_args_to_list
-00001ed0: 2c0a 2020 2020 7661 6c69 6461 7465 5f6f  ,.    validate_o
-00001ee0: 626a 6563 745f 6e61 6d65 2c0a 290a 6672  bject_name,.).fr
-00001ef0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00001f00: 7770 6172 6b2e 636f 6c75 6d6e 2069 6d70  wpark.column imp
-00001f10: 6f72 7420 280a 2020 2020 4361 7365 4578  ort (.    CaseEx
-00001f20: 7072 2c0a 2020 2020 436f 6c75 6d6e 2c0a  pr,.    Column,.
-00001f30: 2020 2020 5f74 6f5f 636f 6c5f 6966 5f6c      _to_col_if_l
-00001f40: 6974 2c0a 2020 2020 5f74 6f5f 636f 6c5f  it,.    _to_col_
-00001f50: 6966 5f73 716c 5f65 7870 722c 0a20 2020  if_sql_expr,.   
-00001f60: 205f 746f 5f63 6f6c 5f69 665f 7374 722c   _to_col_if_str,
-00001f70: 0a20 2020 205f 746f 5f63 6f6c 5f69 665f  .    _to_col_if_
-00001f80: 7374 725f 6f72 5f69 6e74 2c0a 290a 6672  str_or_int,.).fr
-00001f90: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00001fa0: 7770 6172 6b2e 7374 6f72 6564 5f70 726f  wpark.stored_pro
-00001fb0: 6365 6475 7265 2069 6d70 6f72 7420 5374  cedure import St
-00001fc0: 6f72 6564 5072 6f63 6564 7572 650a 6672  oredProcedure.fr
-00001fd0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00001fe0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-00001ff0: 7274 2044 6174 6154 7970 652c 2046 6c6f  rt DataType, Flo
-00002000: 6174 5479 7065 2c20 5374 7269 6e67 5479  atType, StringTy
-00002010: 7065 2c20 5374 7275 6374 5479 7065 0a66  pe, StructType.f
-00002020: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00002030: 6f77 7061 726b 2e75 6466 2069 6d70 6f72  owpark.udf impor
-00002040: 7420 5573 6572 4465 6669 6e65 6446 756e  t UserDefinedFun
-00002050: 6374 696f 6e0a 6672 6f6d 2073 6e6f 7766  ction.from snowf
-00002060: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7564  lake.snowpark.ud
-00002070: 7466 2069 6d70 6f72 7420 5573 6572 4465  tf import UserDe
-00002080: 6669 6e65 6454 6162 6c65 4675 6e63 7469  finedTableFuncti
-00002090: 6f6e 0a0a 2320 5079 7468 6f6e 2033 2e38  on..# Python 3.8
-000020a0: 206e 6565 6473 2074 6f20 7573 6520 7479   needs to use ty
-000020b0: 7069 6e67 2e49 7465 7261 626c 6520 6265  ping.Iterable be
-000020c0: 6361 7573 6520 636f 6c6c 6563 7469 6f6e  cause collection
-000020d0: 732e 6162 632e 4974 6572 6162 6c65 2069  s.abc.Iterable i
-000020e0: 7320 6e6f 7420 7375 6273 6372 6970 7461  s not subscripta
-000020f0: 626c 650a 2320 5079 7468 6f6e 2033 2e39  ble.# Python 3.9
-00002100: 2063 616e 2075 7365 2062 6f74 680a 2320   can use both.# 
-00002110: 5079 7468 6f6e 2033 2e31 3020 6e65 6564  Python 3.10 need
-00002120: 7320 746f 2075 7365 2063 6f6c 6c65 6374  s to use collect
-00002130: 696f 6e73 2e61 6263 2e49 7465 7261 626c  ions.abc.Iterabl
-00002140: 6520 6265 6361 7573 6520 7479 7069 6e67  e because typing
-00002150: 2e49 7465 7261 626c 6520 6973 2072 656d  .Iterable is rem
-00002160: 6f76 6564 0a69 6620 7379 732e 7665 7273  oved.if sys.vers
-00002170: 696f 6e5f 696e 666f 203c 3d20 2833 2c20  ion_info <= (3, 
-00002180: 3929 3a0a 2020 2020 6672 6f6d 2074 7970  9):.    from typ
-00002190: 696e 6720 696d 706f 7274 2049 7465 7261  ing import Itera
-000021a0: 626c 650a 656c 7365 3a0a 2020 2020 6672  ble.else:.    fr
-000021b0: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2e61  om collections.a
-000021c0: 6263 2069 6d70 6f72 7420 4974 6572 6162  bc import Iterab
-000021d0: 6c65 0a0a 0a40 6f76 6572 6c6f 6164 0a64  le...@overload.d
-000021e0: 6566 2063 6f6c 2863 6f6c 5f6e 616d 653a  ef col(col_name:
-000021f0: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
-00002200: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00002210: 7468 6520 3a63 6c61 7373 3a60 7e73 6e6f  the :class:`~sno
-00002220: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00002230: 436f 6c75 6d6e 6020 7769 7468 2074 6865  Column` with the
-00002240: 2073 7065 6369 6669 6564 206e 616d 652e   specified name.
-00002250: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00002260: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00002270: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
-00002280: 6c65 6374 2031 2061 7320 6122 290a 2020  lect 1 as a").  
-00002290: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000022a0: 6563 7428 636f 6c28 2261 2229 292e 636f  ect(col("a")).co
-000022b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000022c0: 5b52 6f77 2841 3d31 295d 0a20 2020 2022  [Row(A=1)].    "
-000022d0: 2222 0a20 2020 202e 2e2e 2020 2320 7072  "".    ...  # pr
-000022e0: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a0a  agma: no cover..
-000022f0: 0a40 6f76 6572 6c6f 6164 0a64 6566 2063  .@overload.def c
-00002300: 6f6c 2864 665f 616c 6961 733a 2073 7472  ol(df_alias: str
-00002310: 2c20 636f 6c5f 6e61 6d65 3a20 7374 7229  , col_name: str)
-00002320: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00002330: 2222 2252 6574 7572 6e73 2074 6865 203a  """Returns the :
-00002340: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-00002350: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
-00002360: 6e60 2077 6974 6820 7468 6520 7370 6563  n` with the spec
-00002370: 6966 6965 6420 6461 7461 6672 616d 6520  ified dataframe 
-00002380: 616c 6961 7320 616e 6420 636f 6c75 6d6e  alias and column
-00002390: 206e 616d 652e 0a0a 2020 2020 4578 616d   name...    Exam
-000023a0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-000023b0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-000023c0: 716c 2822 7365 6c65 6374 2031 2061 7320  ql("select 1 as 
-000023d0: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
-000023e0: 6466 2e61 6c69 6173 2822 6466 2229 2e73  df.alias("df").s
-000023f0: 656c 6563 7428 636f 6c28 2264 6622 2c20  elect(col("df", 
-00002400: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
-00002410: 2020 2020 2020 2020 5b52 6f77 2841 3d31          [Row(A=1
-00002420: 295d 0a20 2020 2022 2222 0a20 2020 202e  )].    """.    .
-00002430: 2e2e 2020 2320 7072 6167 6d61 3a20 6e6f  ..  # pragma: no
-00002440: 2063 6f76 6572 0a0a 0a64 6566 2063 6f6c   cover...def col
-00002450: 286e 616d 6531 3a20 7374 722c 206e 616d  (name1: str, nam
-00002460: 6532 3a20 4f70 7469 6f6e 616c 5b73 7472  e2: Optional[str
-00002470: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
-00002480: 756d 6e3a 0a20 2020 2069 6620 6e61 6d65  umn:.    if name
-00002490: 3220 6973 204e 6f6e 653a 0a20 2020 2020  2 is None:.     
-000024a0: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
-000024b0: 286e 616d 6531 290a 2020 2020 656c 7365  (name1).    else
-000024c0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000024d0: 2043 6f6c 756d 6e28 6e61 6d65 312c 206e   Column(name1, n
-000024e0: 616d 6532 290a 0a0a 406f 7665 726c 6f61  ame2)...@overloa
-000024f0: 640a 6465 6620 636f 6c75 6d6e 2863 6f6c  d.def column(col
-00002500: 5f6e 616d 653a 2073 7472 2920 2d3e 2043  _name: str) -> C
-00002510: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00002520: 7475 726e 7320 6120 3a63 6c61 7373 3a60  turns a :class:`
-00002530: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00002540: 6172 6b2e 436f 6c75 6d6e 6020 7769 7468  ark.Column` with
-00002550: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
-00002560: 616d 652e 2041 6c69 6173 2066 6f72 2063  ame. Alias for c
-00002570: 6f6c 2e0a 0a20 2020 2045 7861 6d70 6c65  ol...    Example
-00002580: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-00002590: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
-000025a0: 2273 656c 6563 7420 3120 6173 2061 2229  "select 1 as a")
-000025b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000025c0: 7365 6c65 6374 2863 6f6c 756d 6e28 2261  select(column("a
-000025d0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-000025e0: 2020 2020 2020 5b52 6f77 2841 3d31 295d        [Row(A=1)]
-000025f0: 0a20 2020 2022 2222 0a20 2020 202e 2e2e  .    """.    ...
-00002600: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
-00002610: 6f76 6572 0a0a 0a40 6f76 6572 6c6f 6164  over...@overload
-00002620: 0a64 6566 2063 6f6c 756d 6e28 6466 5f61  .def column(df_a
-00002630: 6c69 6173 3a20 7374 722c 2063 6f6c 5f6e  lias: str, col_n
-00002640: 616d 653a 2073 7472 2920 2d3e 2043 6f6c  ame: str) -> Col
-00002650: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00002660: 726e 7320 6120 3a63 6c61 7373 3a60 7e73  rns a :class:`~s
-00002670: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00002680: 6b2e 436f 6c75 6d6e 6020 7769 7468 2074  k.Column` with t
-00002690: 6865 2073 7065 6369 6669 6564 206e 616d  he specified nam
-000026a0: 6520 616e 6420 6461 7461 6672 616d 6520  e and dataframe 
-000026b0: 616c 6961 7320 6e61 6d65 2e20 416c 6961  alias name. Alia
-000026c0: 7320 666f 7220 636f 6c2e 0a0a 2020 2020  s for col...    
-000026d0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-000026e0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000026f0: 6f6e 2e73 716c 2822 7365 6c65 6374 2031  on.sql("select 1
-00002700: 2061 7320 6122 290a 2020 2020 2020 2020   as a").        
-00002710: 3e3e 3e20 6466 2e61 6c69 6173 2822 6466  >>> df.alias("df
-00002720: 2229 2e73 656c 6563 7428 636f 6c75 6d6e  ").select(column
-00002730: 2822 6466 222c 2022 6122 2929 2e63 6f6c  ("df", "a")).col
-00002740: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00002750: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
-00002760: 220a 2020 2020 2e2e 2e20 2023 2070 7261  ".    ...  # pra
-00002770: 676d 613a 206e 6f20 636f 7665 720a 0a0a  gma: no cover...
-00002780: 6465 6620 636f 6c75 6d6e 286e 616d 6531  def column(name1
-00002790: 3a20 7374 722c 206e 616d 6532 3a20 4f70  : str, name2: Op
-000027a0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-000027b0: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
-000027c0: 2020 2069 6620 6e61 6d65 3220 6973 204e     if name2 is N
-000027d0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
-000027e0: 7572 6e20 436f 6c75 6d6e 286e 616d 6531  urn Column(name1
-000027f0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-00002800: 2020 2020 7265 7475 726e 2043 6f6c 756d      return Colum
-00002810: 6e28 6e61 6d65 312c 206e 616d 6532 290a  n(name1, name2).
-00002820: 0a0a 6465 6620 6c69 7428 6c69 7465 7261  ..def lit(litera
-00002830: 6c3a 204c 6974 6572 616c 5479 7065 2920  l: LiteralType) 
-00002840: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00002850: 2222 0a20 2020 2043 7265 6174 6573 2061  "".    Creates a
-00002860: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-00002870: 616b 652e 736e 6f77 7061 726b 2e43 6f6c  ake.snowpark.Col
-00002880: 756d 6e60 2065 7870 7265 7373 696f 6e20  umn` expression 
-00002890: 666f 7220 6120 6c69 7465 7261 6c20 7661  for a literal va
-000028a0: 6c75 652e 0a20 2020 2049 7420 7375 7070  lue..    It supp
-000028b0: 6f72 7473 2062 6173 6963 2050 7974 686f  orts basic Pytho
-000028c0: 6e20 6461 7461 2074 7970 6573 2c20 696e  n data types, in
-000028d0: 636c 7564 696e 6720 6060 696e 7460 602c  cluding ``int``,
-000028e0: 2060 6066 6c6f 6174 6060 2c20 6060 7374   ``float``, ``st
-000028f0: 7260 602c 0a20 2020 2060 6062 6f6f 6c60  r``,.    ``bool`
-00002900: 602c 2060 6062 7974 6573 6060 2c20 6060  `, ``bytes``, ``
-00002910: 6279 7465 6172 7261 7960 602c 2060 6064  bytearray``, ``d
-00002920: 6174 6574 696d 652e 7469 6d65 6060 2c20  atetime.time``, 
-00002930: 6060 6461 7465 7469 6d65 2e64 6174 6560  ``datetime.date`
-00002940: 602c 0a20 2020 2060 6064 6174 6574 696d  `,.    ``datetim
-00002950: 652e 6461 7465 7469 6d65 6060 2061 6e64  e.datetime`` and
-00002960: 2060 6064 6563 696d 616c 2e44 6563 696d   ``decimal.Decim
-00002970: 616c 6060 2e20 416c 736f 2c20 6974 2073  al``. Also, it s
-00002980: 7570 706f 7274 7320 5079 7468 6f6e 2073  upports Python s
-00002990: 7472 7563 7475 7265 6420 6461 7461 2074  tructured data t
-000029a0: 7970 6573 2c0a 2020 2020 696e 636c 7564  ypes,.    includ
-000029b0: 696e 6720 6060 6c69 7374 6060 2c20 6060  ing ``list``, ``
-000029c0: 7475 706c 6560 6020 616e 6420 6060 6469  tuple`` and ``di
-000029d0: 6374 6060 2c20 6275 7420 7468 6973 2063  ct``, but this c
-000029e0: 6f6e 7461 696e 6572 206d 7573 740a 2020  ontainer must.  
-000029f0: 2020 6265 204a 534f 4e20 7365 7269 616c    be JSON serial
-00002a00: 697a 6162 6c65 2e0a 0a20 2020 2045 7861  izable...    Exa
-00002a10: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00002a20: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
-00002a30: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
-00002a40: 636f 6c75 6d6e 7320 3d20 5b6c 6974 2831  columns = [lit(1
-00002a50: 292c 206c 6974 2822 3122 292c 206c 6974  ), lit("1"), lit
-00002a60: 2831 2e30 292c 206c 6974 2854 7275 6529  (1.0), lit(True)
-00002a70: 2c20 6c69 7428 6227 736e 6f77 2729 2c20  , lit(b'snow'), 
-00002a80: 6c69 7428 6461 7465 7469 6d65 2e64 6174  lit(datetime.dat
-00002a90: 6528 3230 3233 2c20 322c 2032 2929 2c20  e(2023, 2, 2)), 
-00002aa0: 6c69 7428 5b31 2c20 325d 292c 206c 6974  lit([1, 2]), lit
-00002ab0: 287b 2273 6e6f 7722 3a20 2266 6c61 6b65  ({"snow": "flake
-00002ac0: 227d 295d 0a20 2020 2020 2020 203e 3e3e  "})].        >>>
-00002ad0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00002ae0: 6461 7461 6672 616d 6528 5b5b 5d5d 292e  dataframe([[]]).
-00002af0: 7365 6c65 6374 285b 632e 6173 5f28 7374  select([c.as_(st
-00002b00: 7228 6929 2920 666f 7220 692c 2063 2069  r(i)) for i, c i
-00002b10: 6e20 656e 756d 6572 6174 6528 636f 6c75  n enumerate(colu
-00002b20: 6d6e 7329 5d29 2e73 686f 7728 290a 2020  mns)]).show().  
-00002b30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00002b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002b60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002b70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002b80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00002b90: 2020 2020 2020 7c22 3022 2020 7c22 3122        |"0"  |"1"
-00002ba0: 2020 7c22 3222 2020 7c22 3322 2020 207c    |"2"  |"3"   |
-00002bb0: 2234 2220 2020 2020 2020 2020 2020 2020  "4"             
-00002bc0: 2020 2020 7c22 3522 2020 2020 2020 2020      |"5"        
-00002bd0: 207c 2236 2220 2020 7c22 3722 2020 2020   |"6"   |"7"    
-00002be0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00002bf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00002c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00002c50: 2020 2020 2020 7c31 2020 2020 7c31 2020        |1    |1  
-00002c60: 2020 7c31 2e30 2020 7c54 7275 6520 207c    |1.0  |True  |
-00002c70: 6279 7465 6172 7261 7928 6227 736e 6f77  bytearray(b'snow
-00002c80: 2729 2020 7c32 3032 332d 3032 2d30 3220  ')  |2023-02-02 
-00002c90: 207c 5b20 2020 2020 7c7b 2020 2020 2020   |[     |{      
-00002ca0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00002cb0: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
-00002cc0: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
-00002cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ce0: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
-00002cf0: 207c 2020 312c 2020 7c20 2022 736e 6f77   |  1,  |  "snow
-00002d00: 223a 2022 666c 616b 6522 2020 7c0a 2020  ": "flake"  |.  
-00002d10: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
-00002d20: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
-00002d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d40: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
-00002d50: 207c 2020 3220 2020 7c7d 2020 2020 2020   |  2   |}      
-00002d60: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00002d70: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
-00002d80: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
-00002d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002da0: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
-00002db0: 207c 5d20 2020 2020 7c20 2020 2020 2020   |]     |       
-00002dc0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00002dd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00002de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00002e30: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00002e40: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
-00002e50: 7475 726e 206c 6974 6572 616c 2069 6620  turn literal if 
-00002e60: 6973 696e 7374 616e 6365 286c 6974 6572  isinstance(liter
-00002e70: 616c 2c20 436f 6c75 6d6e 2920 656c 7365  al, Column) else
-00002e80: 2043 6f6c 756d 6e28 4c69 7465 7261 6c28   Column(Literal(
-00002e90: 6c69 7465 7261 6c29 290a 0a0a 6465 6620  literal))...def 
-00002ea0: 7371 6c5f 6578 7072 2873 716c 3a20 7374  sql_expr(sql: st
-00002eb0: 7229 202d 3e20 436f 6c75 6d6e 3a0a 2020  r) -> Column:.  
-00002ec0: 2020 2222 2243 7265 6174 6573 2061 203a    """Creates a :
-00002ed0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-00002ee0: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
-00002ef0: 6e60 2065 7870 7265 7373 696f 6e20 6672  n` expression fr
-00002f00: 6f6d 2072 6177 2053 514c 2074 6578 742e  om raw SQL text.
-00002f10: 0a20 2020 204e 6f74 6520 7468 6174 2074  .    Note that t
-00002f20: 6865 2066 756e 6374 696f 6e20 646f 6573  he function does
-00002f30: 206e 6f74 2069 6e74 6572 7072 6574 206f   not interpret o
-00002f40: 7220 6368 6563 6b20 7468 6520 5351 4c20  r check the SQL 
-00002f50: 7465 7874 2e0a 0a20 2020 2045 7861 6d70  text...    Examp
-00002f60: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00002f70: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00002f80: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00002f90: 5b31 2c20 325d 2c20 5b33 2c20 345d 5d2c  [1, 2], [3, 4]],
-00002fa0: 2073 6368 656d 613d 5b22 4122 2c20 2242   schema=["A", "B
-00002fb0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00002fc0: 6466 2e66 696c 7465 7228 2261 203e 2031  df.filter("a > 1
-00002fd0: 2229 2e63 6f6c 6c65 6374 2829 2020 2320  ").collect()  # 
-00002fe0: 7573 6520 5351 4c20 6578 7072 6573 7369  use SQL expressi
-00002ff0: 6f6e 0a20 2020 2020 2020 205b 526f 7728  on.        [Row(
-00003000: 413d 332c 2042 3d34 295d 0a20 2020 2022  A=3, B=4)].    "
-00003010: 2222 0a20 2020 2072 6574 7572 6e20 436f  "".    return Co
-00003020: 6c75 6d6e 2e5f 6578 7072 2873 716c 290a  lumn._expr(sql).
-00003030: 0a0a 6465 6620 6375 7272 656e 745f 7365  ..def current_se
-00003040: 7373 696f 6e28 2920 2d3e 2043 6f6c 756d  ssion() -> Colum
-00003050: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-00003060: 6574 7572 6e73 2061 2075 6e69 7175 6520  eturns a unique 
-00003070: 7379 7374 656d 2069 6465 6e74 6966 6965  system identifie
-00003080: 7220 666f 7220 7468 6520 536e 6f77 666c  r for the Snowfl
-00003090: 616b 6520 7365 7373 696f 6e20 636f 7272  ake session corr
-000030a0: 6573 706f 6e64 696e 6720 746f 2074 6865  esponding to the
-000030b0: 2070 7265 7365 6e74 2063 6f6e 6e65 6374   present connect
-000030c0: 696f 6e2e 0a20 2020 2054 6869 7320 7769  ion..    This wi
-000030d0: 6c6c 2067 656e 6572 616c 6c79 2062 6520  ll generally be 
-000030e0: 6120 7379 7374 656d 2d67 656e 6572 6174  a system-generat
-000030f0: 6564 2061 6c70 6861 6e75 6d65 7269 6320  ed alphanumeric 
-00003100: 7374 7269 6e67 2e20 4974 2069 7320 4e4f  string. It is NO
-00003110: 5420 6465 7269 7665 6420 6672 6f6d 2074  T derived from t
-00003120: 6865 2075 7365 7220 6e61 6d65 206f 7220  he user name or 
-00003130: 7573 6572 2061 6363 6f75 6e74 2e0a 0a20  user account... 
-00003140: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00003150: 2020 2020 3e3e 3e20 2320 5265 7475 726e      >>> # Return
-00003160: 2072 6573 756c 7420 6973 2074 6965 6420   result is tied 
-00003170: 746f 2073 6573 7369 6f6e 2c20 736f 2077  to session, so w
-00003180: 6520 6f6e 6c79 2074 6573 7420 6966 2074  e only test if t
-00003190: 6865 2072 6573 756c 7420 6578 6973 7473  he result exists
-000031a0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-000031b0: 756c 7420 3d20 7365 7373 696f 6e2e 6372  ult = session.cr
-000031c0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-000031d0: 315d 292e 7365 6c65 6374 2863 7572 7265  1]).select(curre
-000031e0: 6e74 5f73 6573 7369 6f6e 2829 292e 636f  nt_session()).co
-000031f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00003200: 3e3e 3e20 6173 7365 7274 2072 6573 756c  >>> assert resul
-00003210: 745b 305d 5b27 4355 5252 454e 545f 5345  t[0]['CURRENT_SE
-00003220: 5353 494f 4e28 2927 5d20 6973 206e 6f74  SSION()'] is not
-00003230: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
-00003240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00003250: 2822 6375 7272 656e 745f 7365 7373 696f  ("current_sessio
-00003260: 6e22 2928 290a 0a0a 6465 6620 6375 7272  n")()...def curr
-00003270: 656e 745f 7374 6174 656d 656e 7428 2920  ent_statement() 
-00003280: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00003290: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-000032a0: 6865 2053 514c 2074 6578 7420 6f66 2074  he SQL text of t
-000032b0: 6865 2073 7461 7465 6d65 6e74 2074 6861  he statement tha
-000032c0: 7420 6973 2063 7572 7265 6e74 6c79 2065  t is currently e
-000032d0: 7865 6375 7469 6e67 2e0a 0a20 2020 2045  xecuting...    E
-000032e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-000032f0: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
-00003300: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
-00003310: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
-00003320: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
-00003330: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
-00003340: 2020 2020 203e 3e3e 2073 6573 7369 6f6e       >>> session
-00003350: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00003360: 6528 5b31 5d29 2e73 656c 6563 7428 6375  e([1]).select(cu
-00003370: 7272 656e 745f 7374 6174 656d 656e 7428  rrent_statement(
-00003380: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00003390: 2020 2020 205b 526f 7728 4355 5252 454e       [Row(CURREN
-000033a0: 545f 5354 4154 454d 454e 5428 293d 2753  T_STATEMENT()='S
-000033b0: 454c 4543 5420 6375 7272 656e 745f 7374  ELECT current_st
-000033c0: 6174 656d 656e 7428 2920 4652 4f4d 2028  atement() FROM (
-000033d0: 2053 454c 4543 5420 225f 3122 2046 524f   SELECT "_1" FRO
-000033e0: 4d20 2820 5345 4c45 4354 2024 3120 4153  M ( SELECT $1 AS
-000033f0: 2022 5f31 2220 4652 4f4d 2020 5641 4c55   "_1" FROM  VALU
-00003400: 4553 2028 3120 3a3a 2049 4e54 2929 2927  ES (1 :: INT)))'
-00003410: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
-00003420: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
-00003430: 7572 7265 6e74 5f73 7461 7465 6d65 6e74  urrent_statement
-00003440: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
-00003450: 6e74 5f75 7365 7228 2920 2d3e 2043 6f6c  nt_user() -> Col
-00003460: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00003470: 2052 6574 7572 6e73 2074 6865 206e 616d   Returns the nam
-00003480: 6520 6f66 2074 6865 2075 7365 7220 6375  e of the user cu
-00003490: 7272 656e 746c 7920 6c6f 6767 6564 2069  rrently logged i
-000034a0: 6e74 6f20 7468 6520 7379 7374 656d 2e0a  nto the system..
-000034b0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-000034c0: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
-000034d0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
-000034e0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
-000034f0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
-00003500: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
-00003510: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
-00003520: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
-00003530: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00003540: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
-00003550: 7265 6e74 5f75 7365 7228 2929 2e63 6f6c  rent_user()).col
-00003560: 6c65 6374 2829 0a20 2020 2020 2020 203e  lect().        >
-00003570: 3e3e 2061 7373 6572 7420 7265 7375 6c74  >> assert result
-00003580: 5b30 5d5b 2743 5552 5245 4e54 5f55 5345  [0]['CURRENT_USE
-00003590: 5228 2927 5d20 6973 206e 6f74 204e 6f6e  R()'] is not Non
-000035a0: 650a 2020 2020 2222 220a 2020 2020 7265  e.    """.    re
-000035b0: 7475 726e 2062 7569 6c74 696e 2822 6375  turn builtin("cu
-000035c0: 7272 656e 745f 7573 6572 2229 2829 0a0a  rrent_user")()..
-000035d0: 0a64 6566 2063 7572 7265 6e74 5f76 6572  .def current_ver
-000035e0: 7369 6f6e 2829 202d 3e20 436f 6c75 6d6e  sion() -> Column
-000035f0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00003600: 7475 726e 7320 7468 6520 6375 7272 656e  turns the curren
-00003610: 7420 536e 6f77 666c 616b 6520 7665 7273  t Snowflake vers
-00003620: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
-00003630: 653a 0a20 2020 2020 2020 203e 3e3e 2023  e:.        >>> #
-00003640: 2052 6574 7572 6e20 7265 7375 6c74 2069   Return result i
-00003650: 7320 7469 6564 2074 6f20 7365 7373 696f  s tied to sessio
-00003660: 6e2c 2073 6f20 7765 206f 6e6c 7920 7465  n, so we only te
-00003670: 7374 2069 6620 7468 6520 7265 7375 6c74  st if the result
-00003680: 2065 7869 7374 730a 2020 2020 2020 2020   exists.        
-00003690: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
-000036a0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000036b0: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
-000036c0: 7428 6375 7272 656e 745f 7665 7273 696f  t(current_versio
-000036d0: 6e28 2929 2e63 6f6c 6c65 6374 2829 0a20  n()).collect(). 
-000036e0: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
-000036f0: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
-00003700: 5245 4e54 5f56 4552 5349 4f4e 2829 275d  RENT_VERSION()']
-00003710: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-00003720: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
-00003730: 6275 696c 7469 6e28 2263 7572 7265 6e74  builtin("current
-00003740: 5f76 6572 7369 6f6e 2229 2829 0a0a 0a64  _version")()...d
-00003750: 6566 2063 7572 7265 6e74 5f77 6172 6568  ef current_wareh
-00003760: 6f75 7365 2829 202d 3e20 436f 6c75 6d6e  ouse() -> Column
-00003770: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00003780: 7475 726e 7320 7468 6520 6e61 6d65 206f  turns the name o
-00003790: 6620 7468 6520 7761 7265 686f 7573 6520  f the warehouse 
-000037a0: 696e 2075 7365 2066 6f72 2074 6865 2063  in use for the c
-000037b0: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
-000037c0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-000037d0: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
-000037e0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
-000037f0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
-00003800: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
-00003810: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
-00003820: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
-00003830: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
-00003840: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00003850: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
-00003860: 7265 6e74 5f77 6172 6568 6f75 7365 2829  rent_warehouse()
-00003870: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00003880: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
-00003890: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
-000038a0: 545f 5741 5245 484f 5553 4528 2927 5d20  T_WAREHOUSE()'] 
-000038b0: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-000038c0: 2222 220a 2020 2020 7265 7475 726e 2062  """.    return b
-000038d0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
-000038e0: 7761 7265 686f 7573 6522 2928 290a 0a0a  warehouse")()...
-000038f0: 6465 6620 6375 7272 656e 745f 6461 7461  def current_data
-00003900: 6261 7365 2829 202d 3e20 436f 6c75 6d6e  base() -> Column
-00003910: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-00003920: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
-00003930: 2064 6174 6162 6173 6520 696e 2075 7365   database in use
-00003940: 2066 6f72 2074 6865 2063 7572 7265 6e74   for the current
-00003950: 2073 6573 7369 6f6e 2e0a 0a20 2020 2045   session...    E
-00003960: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00003970: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
-00003980: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
-00003990: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
-000039a0: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
-000039b0: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
-000039c0: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
-000039d0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000039e0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
-000039f0: 7365 6c65 6374 2863 7572 7265 6e74 5f64  select(current_d
-00003a00: 6174 6162 6173 6528 2929 2e63 6f6c 6c65  atabase()).colle
-00003a10: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
-00003a20: 2061 7373 6572 7420 7265 7375 6c74 5b30   assert result[0
-00003a30: 5d5b 2743 5552 5245 4e54 5f44 4154 4142  ]['CURRENT_DATAB
-00003a40: 4153 4528 2927 5d20 6973 206e 6f74 204e  ASE()'] is not N
-00003a50: 6f6e 650a 2020 2020 2222 220a 2020 2020  one.    """.    
-00003a60: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00003a70: 6375 7272 656e 745f 6461 7461 6261 7365  current_database
-00003a80: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
-00003a90: 6e74 5f72 6f6c 6528 2920 2d3e 2043 6f6c  nt_role() -> Col
-00003aa0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00003ab0: 726e 7320 7468 6520 6e61 6d65 206f 6620  rns the name of 
-00003ac0: 7468 6520 726f 6c65 2069 6e20 7573 6520  the role in use 
-00003ad0: 666f 7220 7468 6520 6375 7272 656e 7420  for the current 
-00003ae0: 7365 7373 696f 6e2e 0a0a 2020 2020 4578  session...    Ex
-00003af0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00003b00: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
-00003b10: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
-00003b20: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
-00003b30: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
-00003b40: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
-00003b50: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
-00003b60: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00003b70: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
-00003b80: 656c 6563 7428 6375 7272 656e 745f 726f  elect(current_ro
-00003b90: 6c65 2829 292e 636f 6c6c 6563 7428 290a  le()).collect().
-00003ba0: 2020 2020 2020 2020 3e3e 3e20 6173 7365          >>> asse
-00003bb0: 7274 2072 6573 756c 745b 305d 5b27 4355  rt result[0]['CU
-00003bc0: 5252 454e 545f 524f 4c45 2829 275d 2069  RRENT_ROLE()'] i
-00003bd0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2022  s not None.    "
-00003be0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00003bf0: 696c 7469 6e28 2263 7572 7265 6e74 5f72  iltin("current_r
-00003c00: 6f6c 6522 2928 290a 0a0a 6465 6620 6375  ole")()...def cu
-00003c10: 7272 656e 745f 7363 6865 6d61 2829 202d  rrent_schema() -
-00003c20: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00003c30: 2252 6574 7572 6e73 2074 6865 206e 616d  "Returns the nam
-00003c40: 6520 6f66 2074 6865 2073 6368 656d 6120  e of the schema 
-00003c50: 696e 2075 7365 2066 6f72 2074 6865 2063  in use for the c
-00003c60: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
-00003c70: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-00003c80: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
-00003c90: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
-00003ca0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
-00003cb0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
-00003cc0: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
-00003cd0: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
-00003ce0: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
-00003cf0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00003d00: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
-00003d10: 7265 6e74 5f73 6368 656d 6128 2929 2e63  rent_schema()).c
-00003d20: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00003d30: 203e 3e3e 2061 7373 6572 7420 7265 7375   >>> assert resu
-00003d40: 6c74 5b30 5d5b 2743 5552 5245 4e54 5f53  lt[0]['CURRENT_S
-00003d50: 4348 454d 4128 2927 5d20 6973 206e 6f74  CHEMA()'] is not
-00003d60: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
-00003d70: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00003d80: 2822 6375 7272 656e 745f 7363 6865 6d61  ("current_schema
-00003d90: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
-00003da0: 6e74 5f73 6368 656d 6173 2829 202d 3e20  nt_schemas() -> 
-00003db0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00003dc0: 6574 7572 6e73 2061 6374 6976 6520 7365  eturns active se
-00003dd0: 6172 6368 2070 6174 6820 7363 6865 6d61  arch path schema
-00003de0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
-00003df0: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-00003e00: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-00003e10: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-00003e20: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-00003e30: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-00003e40: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-00003e50: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
-00003e60: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00003e70: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
-00003e80: 6375 7272 656e 745f 7363 6865 6d61 7328  current_schemas(
-00003e90: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00003ea0: 2020 2020 203e 3e3e 2061 7373 6572 7420       >>> assert 
-00003eb0: 7265 7375 6c74 5b30 5d5b 2743 5552 5245  result[0]['CURRE
-00003ec0: 4e54 5f53 4348 454d 4153 2829 275d 2069  NT_SCHEMAS()'] i
-00003ed0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2022  s not None.    "
-00003ee0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00003ef0: 696c 7469 6e28 2263 7572 7265 6e74 5f73  iltin("current_s
-00003f00: 6368 656d 6173 2229 2829 0a0a 0a64 6566  chemas")()...def
-00003f10: 2063 7572 7265 6e74 5f72 6567 696f 6e28   current_region(
-00003f20: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00003f30: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00003f40: 6e61 6d65 206f 6620 7468 6520 7265 6769  name of the regi
-00003f50: 6f6e 2066 6f72 2074 6865 2061 6363 6f75  on for the accou
-00003f60: 6e74 2077 6865 7265 2074 6865 2063 7572  nt where the cur
-00003f70: 7265 6e74 2075 7365 7220 6973 206c 6f67  rent user is log
-00003f80: 6765 6420 696e 2e0a 0a20 2020 2045 7861  ged in...    Exa
-00003f90: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00003fa0: 3e20 2320 5265 7475 726e 2072 6573 756c  > # Return resul
-00003fb0: 7420 6973 2074 6965 6420 746f 2073 6573  t is tied to ses
-00003fc0: 7369 6f6e 2c20 736f 2077 6520 6f6e 6c79  sion, so we only
-00003fd0: 2074 6573 7420 6966 2074 6865 2072 6573   test if the res
-00003fe0: 756c 7420 6578 6973 7473 0a20 2020 2020  ult exists.     
-00003ff0: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
-00004000: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00004010: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
-00004020: 6c65 6374 2863 7572 7265 6e74 5f72 6567  lect(current_reg
-00004030: 696f 6e28 2929 2e63 6f6c 6c65 6374 2829  ion()).collect()
-00004040: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
-00004050: 6572 7420 7265 7375 6c74 5b30 5d5b 2743  ert result[0]['C
-00004060: 5552 5245 4e54 5f52 4547 494f 4e28 2927  URRENT_REGION()'
-00004070: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
-00004080: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00004090: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
-000040a0: 745f 7265 6769 6f6e 2229 2829 0a0a 0a64  t_region")()...d
-000040b0: 6566 2063 7572 7265 6e74 5f61 7661 696c  ef current_avail
-000040c0: 6162 6c65 5f72 6f6c 6573 2829 202d 3e20  able_roles() -> 
-000040d0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-000040e0: 6574 7572 6e73 2061 204a 534f 4e20 7374  eturns a JSON st
-000040f0: 7269 6e67 2074 6861 7420 6c69 7374 7320  ring that lists 
-00004100: 616c 6c20 726f 6c65 7320 6772 616e 7465  all roles grante
-00004110: 6420 746f 2074 6865 2063 7572 7265 6e74  d to the current
-00004120: 2075 7365 722e 0a0a 2020 2020 4578 616d   user...    Exam
-00004130: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00004140: 2023 2052 6574 7572 6e20 7265 7375 6c74   # Return result
-00004150: 2069 7320 7469 6564 2074 6f20 7365 7373   is tied to sess
-00004160: 696f 6e2c 2073 6f20 7765 206f 6e6c 7920  ion, so we only 
-00004170: 7465 7374 2069 6620 7468 6520 7265 7375  test if the resu
-00004180: 6c74 2065 7869 7374 730a 2020 2020 2020  lt exists.      
-00004190: 2020 3e3e 3e20 7265 7375 6c74 203d 2073    >>> result = s
-000041a0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000041b0: 7461 6672 616d 6528 5b31 5d29 2e73 656c  taframe([1]).sel
-000041c0: 6563 7428 6375 7272 656e 745f 6176 6169  ect(current_avai
-000041d0: 6c61 626c 655f 726f 6c65 7328 2929 2e63  lable_roles()).c
-000041e0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000041f0: 203e 3e3e 2061 7373 6572 7420 7265 7375   >>> assert resu
-00004200: 6c74 5b30 5d5b 2743 5552 5245 4e54 5f41  lt[0]['CURRENT_A
-00004210: 5641 494c 4142 4c45 5f52 4f4c 4553 2829  VAILABLE_ROLES()
-00004220: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
-00004230: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-00004240: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
-00004250: 6e74 5f61 7661 696c 6162 6c65 5f72 6f6c  nt_available_rol
-00004260: 6573 2229 2829 0a0a 0a64 6566 2061 6464  es")()...def add
-00004270: 5f6d 6f6e 7468 7328 0a20 2020 2064 6174  _months(.    dat
-00004280: 655f 6f72 5f74 696d 6573 7461 6d70 3a20  e_or_timestamp: 
-00004290: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6e75  ColumnOrName, nu
-000042a0: 6d62 6572 5f6f 665f 6d6f 6e74 6873 3a20  mber_of_months: 
-000042b0: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
-000042c0: 745d 0a29 202d 3e20 436f 6c75 6d6e 3a0a  t].) -> Column:.
-000042d0: 2020 2020 2222 2241 6464 7320 6f72 2073      """Adds or s
-000042e0: 7562 7472 6163 7473 2061 2073 7065 6369  ubtracts a speci
-000042f0: 6669 6564 206e 756d 6265 7220 6f66 206d  fied number of m
-00004300: 6f6e 7468 7320 746f 2061 2064 6174 6520  onths to a date 
-00004310: 6f72 2074 696d 6573 7461 6d70 2c20 7072  or timestamp, pr
-00004320: 6573 6572 7669 6e67 2074 6865 2065 6e64  eserving the end
-00004330: 2d6f 662d 6d6f 6e74 6820 696e 666f 726d  -of-month inform
-00004340: 6174 696f 6e2e 0a0a 2020 2020 4578 616d  ation...    Exam
-00004350: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00004360: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-00004370: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00004380: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00004390: 5f64 6174 6166 7261 6d65 285b 6461 7465  _dataframe([date
-000043a0: 7469 6d65 2e64 6174 6528 3230 3232 2c20  time.date(2022, 
-000043b0: 342c 2036 295d 2c20 7363 6865 6d61 3d5b  4, 6)], schema=[
-000043c0: 2264 225d 290a 2020 2020 2020 2020 3e3e  "d"]).        >>
-000043d0: 3e20 6466 2e73 656c 6563 7428 6164 645f  > df.select(add_
-000043e0: 6d6f 6e74 6873 2822 6422 2c20 3429 292e  months("d", 4)).
-000043f0: 636f 6c6c 6563 7428 295b 305d 5b30 5d0a  collect()[0][0].
-00004400: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-00004410: 2e64 6174 6528 3230 3232 2c20 382c 2036  .date(2022, 8, 6
-00004420: 290a 2020 2020 2222 220a 2020 2020 6320  ).    """.    c 
-00004430: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00004440: 2864 6174 655f 6f72 5f74 696d 6573 7461  (date_or_timesta
-00004450: 6d70 2c20 2261 6464 5f6d 6f6e 7468 7322  mp, "add_months"
-00004460: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00004470: 6c74 696e 2822 6164 645f 6d6f 6e74 6873  ltin("add_months
-00004480: 2229 2863 2c20 6e75 6d62 6572 5f6f 665f  ")(c, number_of_
-00004490: 6d6f 6e74 6873 290a 0a0a 6465 6620 616e  months)...def an
-000044a0: 795f 7661 6c75 6528 653a 2043 6f6c 756d  y_value(e: Colum
-000044b0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000044c0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-000044d0: 6e73 2061 206e 6f6e 2d64 6574 6572 6d69  ns a non-determi
-000044e0: 6e69 7374 6963 2061 6e79 2076 616c 7565  nistic any value
-000044f0: 2066 6f72 2074 6865 2073 7065 6369 6669   for the specifi
-00004500: 6564 2063 6f6c 756d 6e2e 0a20 2020 2054  ed column..    T
-00004510: 6869 7320 6973 2061 6e20 6167 6772 6567  his is an aggreg
-00004520: 6174 6520 616e 6420 7769 6e64 6f77 2066  ate and window f
-00004530: 756e 6374 696f 6e2e 0a0a 2020 2020 4578  unction...    Ex
-00004540: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00004550: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00004560: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00004570: 285b 5b31 2c20 325d 2c20 5b33 2c20 345d  ([[1, 2], [3, 4]
-00004580: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-00004590: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-000045a0: 3e20 7265 7375 6c74 203d 2064 662e 7365  > result = df.se
-000045b0: 6c65 6374 2861 6e79 5f76 616c 7565 2822  lect(any_value("
-000045c0: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
-000045d0: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
-000045e0: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
-000045f0: 2031 2020 2320 6e6f 6e2d 6465 7465 726d   1  # non-determ
-00004600: 696e 6973 7469 6320 7661 6c75 6520 696e  inistic value in
-00004610: 2072 6573 756c 742e 0a20 2020 2022 2222   result..    """
-00004620: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00004630: 5f69 665f 7374 7228 652c 2022 616e 795f  _if_str(e, "any_
-00004640: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
-00004650: 726e 2063 616c 6c5f 6275 696c 7469 6e28  rn call_builtin(
-00004660: 2261 6e79 5f76 616c 7565 222c 2063 290a  "any_value", c).
-00004670: 0a0a 6465 6620 6269 746e 6f74 2865 3a20  ..def bitnot(e: 
-00004680: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00004690: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000046a0: 5265 7475 726e 7320 7468 6520 6269 7477  Returns the bitw
-000046b0: 6973 6520 6e65 6761 7469 6f6e 206f 6620  ise negation of 
-000046c0: 6120 6e75 6d65 7269 6320 6578 7072 6573  a numeric expres
-000046d0: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
-000046e0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-000046f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00004700: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-00004710: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00004720: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00004730: 7365 6c65 6374 2862 6974 6e6f 7428 2261  select(bitnot("a
-00004740: 2229 292e 636f 6c6c 6563 7428 295b 305d  ")).collect()[0]
-00004750: 5b30 5d0a 2020 2020 2020 2020 2d32 0a20  [0].        -2. 
-00004760: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-00004770: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-00004780: 2022 6269 746e 6f74 2229 0a20 2020 2072   "bitnot").    r
-00004790: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
-000047a0: 696e 2822 6269 746e 6f74 222c 2063 290a  in("bitnot", c).
-000047b0: 0a0a 6465 6620 6269 7473 6869 6674 6c65  ..def bitshiftle
-000047c0: 6674 2874 6f5f 7368 6966 745f 636f 6c75  ft(to_shift_colu
-000047d0: 6d6e 3a20 436f 6c75 6d6e 4f72 4e61 6d65  mn: ColumnOrName
-000047e0: 2c20 6e3a 2055 6e69 6f6e 5b43 6f6c 756d  , n: Union[Colum
-000047f0: 6e2c 2069 6e74 5d29 202d 3e20 436f 6c75  n, int]) -> Colu
-00004800: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00004810: 6e73 2074 6865 2062 6974 7769 7365 206e  ns the bitwise n
-00004820: 6567 6174 696f 6e20 6f66 2061 206e 756d  egation of a num
-00004830: 6572 6963 2065 7870 7265 7373 696f 6e2e  eric expression.
-00004840: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
-00004850: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00004860: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00004870: 6174 6166 7261 6d65 285b 325d 2c20 7363  ataframe([2], sc
-00004880: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00004890: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000048a0: 7428 6269 7473 6869 6674 6c65 6674 2822  t(bitshiftleft("
-000048b0: 6122 2c20 3129 292e 636f 6c6c 6563 7428  a", 1)).collect(
-000048c0: 295b 305d 5b30 5d0a 2020 2020 2020 2020  )[0][0].        
-000048d0: 340a 2020 2020 2222 220a 2020 2020 6320  4.    """.    c 
-000048e0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-000048f0: 2874 6f5f 7368 6966 745f 636f 6c75 6d6e  (to_shift_column
-00004900: 2c20 2262 6974 7368 6966 746c 6566 7422  , "bitshiftleft"
-00004910: 290a 2020 2020 7265 7475 726e 2063 616c  ).    return cal
-00004920: 6c5f 6275 696c 7469 6e28 2262 6974 7368  l_builtin("bitsh
-00004930: 6966 746c 6566 7422 2c20 632c 206e 290a  iftleft", c, n).
-00004940: 0a0a 6465 6620 6269 7473 6869 6674 7269  ..def bitshiftri
-00004950: 6768 7428 746f 5f73 6869 6674 5f63 6f6c  ght(to_shift_col
-00004960: 756d 6e3a 2043 6f6c 756d 6e4f 724e 616d  umn: ColumnOrNam
-00004970: 652c 206e 3a20 556e 696f 6e5b 436f 6c75  e, n: Union[Colu
-00004980: 6d6e 2c20 696e 745d 2920 2d3e 2043 6f6c  mn, int]) -> Col
-00004990: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000049a0: 726e 7320 7468 6520 6269 7477 6973 6520  rns the bitwise 
-000049b0: 6e65 6761 7469 6f6e 206f 6620 6120 6e75  negation of a nu
-000049c0: 6d65 7269 6320 6578 7072 6573 7369 6f6e  meric expression
-000049d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-000049e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000049f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00004a00: 6461 7461 6672 616d 6528 5b32 5d2c 2073  dataframe([2], s
-00004a10: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00004a20: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00004a30: 6374 2862 6974 7368 6966 7472 6967 6874  ct(bitshiftright
-00004a40: 2822 6122 2c20 3129 292e 636f 6c6c 6563  ("a", 1)).collec
-00004a50: 7428 295b 305d 5b30 5d0a 2020 2020 2020  t()[0][0].      
-00004a60: 2020 310a 2020 2020 2222 220a 2020 2020    1.    """.    
-00004a70: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00004a80: 7472 2874 6f5f 7368 6966 745f 636f 6c75  tr(to_shift_colu
-00004a90: 6d6e 2c20 2262 6974 7368 6966 7472 6967  mn, "bitshiftrig
-00004aa0: 6874 2229 0a20 2020 2072 6574 7572 6e20  ht").    return 
-00004ab0: 6361 6c6c 5f62 7569 6c74 696e 2822 6269  call_builtin("bi
-00004ac0: 7473 6869 6674 7269 6768 7422 2c20 632c  tshiftright", c,
-00004ad0: 206e 290a 0a0a 6465 6620 6272 6f75 6e64   n)...def bround
-00004ae0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-00004af0: 6d65 2c20 7363 616c 653a 2055 6e69 6f6e  me, scale: Union
-00004b00: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 202d  [Column, int]) -
-00004b10: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00004b20: 220a 2020 2020 526f 756e 6473 2074 6865  ".    Rounds the
-00004b30: 206e 756d 6265 7220 7573 696e 6720 6048   number using `H
-00004b40: 414c 465f 544f 5f45 5645 4e60 206f 7074  ALF_TO_EVEN` opt
-00004b50: 696f 6e2e 2054 6865 2060 4841 4c46 5f54  ion. The `HALF_T
-00004b60: 4f5f 4556 454e 6020 726f 756e 6469 6e67  O_EVEN` rounding
-00004b70: 206d 6f64 6520 726f 756e 6473 2074 6865   mode rounds the
-00004b80: 2067 6976 656e 2064 6563 696d 616c 2076   given decimal v
-00004b90: 616c 7565 2074 6f20 7468 6520 7370 6563  alue to the spec
-00004ba0: 6966 6965 6420 7363 616c 6520 286e 756d  ified scale (num
-00004bb0: 6265 7220 6f66 2064 6563 696d 616c 2070  ber of decimal p
-00004bc0: 6c61 6365 7329 2061 7320 666f 6c6c 6f77  laces) as follow
-00004bd0: 733a 0a20 2020 202a 2049 6620 7363 616c  s:.    * If scal
-00004be0: 6520 6973 2067 7265 6174 6572 2074 6861  e is greater tha
-00004bf0: 6e20 6f72 2065 7175 616c 2074 6f20 302c  n or equal to 0,
-00004c00: 2072 6f75 6e64 2074 6f20 7468 6520 7370   round to the sp
-00004c10: 6563 6966 6965 6420 6e75 6d62 6572 206f  ecified number o
-00004c20: 6620 6465 6369 6d61 6c20 706c 6163 6573  f decimal places
-00004c30: 2075 7369 6e67 2068 616c 662d 6576 656e   using half-even
-00004c40: 2072 6f75 6e64 696e 672e 2054 6869 7320   rounding. This 
-00004c50: 726f 756e 6473 2074 6f77 6172 6473 2074  rounds towards t
-00004c60: 6865 206e 6561 7265 7374 2076 616c 7565  he nearest value
-00004c70: 2077 6974 6820 7469 6573 2028 6571 7561   with ties (equa
-00004c80: 6c6c 7920 636c 6f73 6520 7661 6c75 6573  lly close values
-00004c90: 2920 726f 756e 6469 6e67 2074 6f20 7468  ) rounding to th
-00004ca0: 6520 6e65 6172 6573 7420 6576 656e 2064  e nearest even d
-00004cb0: 6967 6974 2e0a 2020 2020 2a20 4966 2073  igit..    * If s
-00004cc0: 6361 6c65 2069 7320 6c65 7373 2074 6861  cale is less tha
-00004cd0: 6e20 302c 2072 6f75 6e64 2074 6f20 7468  n 0, round to th
-00004ce0: 6520 696e 7465 6772 616c 2070 6172 7420  e integral part 
-00004cf0: 6f66 2074 6865 2064 6563 696d 616c 2e20  of the decimal. 
-00004d00: 5468 6973 2072 6f75 6e64 7320 746f 7761  This rounds towa
-00004d10: 7264 7320 3020 616e 6420 7472 756e 6361  rds 0 and trunca
-00004d20: 7465 7320 7468 6520 6465 6369 6d61 6c20  tes the decimal 
-00004d30: 706c 6163 6573 2e0a 0a20 2020 204e 6f74  places...    Not
-00004d40: 653a 0a0a 2020 2020 2020 2020 312e 2054  e:..        1. T
-00004d50: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
-00004d60: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
-00004d70: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
-00004d80: 6520 6064 6174 6120 7479 7065 7320 666f  e `data types fo
-00004d90: 7220 6120 6669 7865 642d 706f 696e 7420  r a fixed-point 
-00004da0: 6e75 6d62 6572 0a20 2020 2020 2020 203c  number.        <
-00004db0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-00004dc0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-00004dd0: 6c2d 7265 6665 7265 6e63 652f 6461 7461  l-reference/data
-00004de0: 2d74 7970 6573 2d6e 756d 6572 6963 2e68  -types-numeric.h
-00004df0: 746d 6c23 6c61 6265 6c2d 6461 7461 2d74  tml#label-data-t
-00004e00: 7970 6573 2d66 6f72 2d66 6978 6564 2d70  ypes-for-fixed-p
-00004e10: 6f69 6e74 2d6e 756d 6265 7273 3e60 5f2e  oint-numbers>`_.
-00004e20: 0a0a 2020 2020 2020 2020 322e 2044 6174  ..        2. Dat
-00004e30: 6120 7479 7065 7320 666f 7220 666c 6f61  a types for floa
-00004e40: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
-00004e50: 7273 2028 652e 672e 2046 4c4f 4154 2920  rs (e.g. FLOAT) 
-00004e60: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
-00004e70: 6420 7769 7468 2074 6869 7320 6172 6775  d with this argu
-00004e80: 6d65 6e74 2e0a 0a20 2020 2020 2020 2033  ment...        3
-00004e90: 2e20 4966 2074 6865 2065 7870 7265 7373  . If the express
-00004ea0: 696f 6e20 6461 7461 2074 7970 6520 6973  ion data type is
-00004eb0: 206e 6f74 2073 7570 706f 7274 6564 2c20   not supported, 
-00004ec0: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
-00004ed0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
-00004ee0: 7920 6361 7374 2074 6f20 6465 6369 6d61  y cast to decima
-00004ef0: 6c20 6265 666f 7265 2063 616c 6c69 6e67  l before calling
-00004f00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-00004f10: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-00004f20: 7274 2064 6563 696d 616c 0a20 2020 2020  rt decimal.     
-00004f30: 2020 203e 3e3e 2064 6174 6120 3d20 5b28     >>> data = [(
-00004f40: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
-00004f50: 312e 3233 3529 292c 2864 6563 696d 616c  1.235)),(decimal
-00004f60: 2e44 6563 696d 616c 2833 2e35 2929 5d0a  .Decimal(3.5))].
-00004f70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00004f80: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
-00004f90: 6174 6146 7261 6d65 2864 6174 612c 205b  ataFrame(data, [
-00004fa0: 2276 616c 7565 225d 290a 2020 2020 2020  "value"]).      
-00004fb0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00004fc0: 6272 6f75 6e64 2827 5641 4c55 4527 2c31  bround('VALUE',1
-00004fd0: 292e 616c 6961 7328 2256 414c 5545 2229  ).alias("VALUE")
-00004fe0: 292e 7368 6f77 2829 2023 2052 6f75 6e64  ).show() # Round
-00004ff0: 7320 746f 2031 2064 6563 696d 616c 2070  s to 1 decimal p
-00005000: 6c61 6365 0a20 2020 2020 2020 202d 2d2d  lace.        ---
-00005010: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005020: 207c 2256 414c 5545 2220 207c 0a20 2020   |"VALUE"  |.   
-00005030: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00005040: 0a20 2020 2020 2020 207c 312e 3220 2020  .        |1.2   
-00005050: 2020 207c 0a20 2020 2020 2020 207c 332e     |.        |3.
-00005060: 3520 2020 2020 207c 0a20 2020 2020 2020  5      |.       
-00005070: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020   -----------.   
-00005080: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00005090: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000050a0: 7365 6c65 6374 2862 726f 756e 6428 2756  select(bround('V
-000050b0: 414c 5545 272c 3029 2e61 6c69 6173 2822  ALUE',0).alias("
-000050c0: 5641 4c55 4522 2929 2e73 686f 7728 2920  VALUE")).show() 
-000050d0: 2320 526f 756e 6473 2074 6f20 3120 6465  # Rounds to 1 de
-000050e0: 6369 6d61 6c20 706c 6163 650a 2020 2020  cimal place.    
-000050f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a      -----------.
-00005100: 2020 2020 2020 2020 7c22 5641 4c55 4522          |"VALUE"
-00005110: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00005120: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005130: 7c31 2020 2020 2020 2020 7c0a 2020 2020  |1        |.    
-00005140: 2020 2020 7c34 2020 2020 2020 2020 7c0a      |4        |.
-00005150: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00005160: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00005170: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00005180: 2020 2020 636f 6c20 3d20 5f74 6f5f 636f      col = _to_co
-00005190: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2262  l_if_str(col, "b
-000051a0: 726f 756e 6422 290a 2020 2020 7363 616c  round").    scal
-000051b0: 6520 3d20 5f74 6f5f 636f 6c5f 6966 5f6c  e = _to_col_if_l
-000051c0: 6974 2873 6361 6c65 2c20 2262 726f 756e  it(scale, "broun
-000051d0: 6422 290a 2020 2020 7265 7475 726e 2063  d").    return c
-000051e0: 616c 6c5f 6275 696c 7469 6e28 2252 4f55  all_builtin("ROU
-000051f0: 4e44 222c 2063 6f6c 2c20 7363 616c 652c  ND", col, scale,
-00005200: 206c 6974 2822 4841 4c46 5f54 4f5f 4556   lit("HALF_TO_EV
-00005210: 454e 2229 290a 0a0a 6465 6620 636f 6e76  EN"))...def conv
-00005220: 6572 745f 7469 6d65 7a6f 6e65 280a 2020  ert_timezone(.  
-00005230: 2020 7461 7267 6574 5f74 696d 657a 6f6e    target_timezon
-00005240: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
-00005250: 0a20 2020 2073 6f75 7263 655f 7469 6d65  .    source_time
-00005260: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
-00005270: 2020 2020 736f 7572 6365 5f74 696d 657a      source_timez
-00005280: 6f6e 653a 204f 7074 696f 6e61 6c5b 436f  one: Optional[Co
-00005290: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
-000052a0: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
-000052b0: 0a20 2020 2022 2222 436f 6e76 6572 7473  .    """Converts
-000052c0: 2074 6865 2067 6976 656e 2073 6f75 7263   the given sourc
-000052d0: 655f 7469 6d65 2074 6f20 7468 6520 7461  e_time to the ta
-000052e0: 7267 6574 2074 696d 657a 6f6e 652e 0a0a  rget timezone...
-000052f0: 2020 2020 466f 7220 7469 6d65 7a6f 6e65      For timezone
-00005300: 2069 6e66 6f72 6d61 7469 6f6e 2c20 7265   information, re
-00005310: 6665 7220 746f 2074 6865 2060 536e 6f77  fer to the `Snow
-00005320: 666c 616b 6520 5351 4c20 636f 6e76 6572  flake SQL conver
-00005330: 745f 7469 6d65 7a6f 6e65 206e 6f74 6573  t_timezone notes
-00005340: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-00005350: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-00005360: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
-00005370: 6e63 7469 6f6e 732f 636f 6e76 6572 745f  nctions/convert_
-00005380: 7469 6d65 7a6f 6e65 2e68 746d 6c23 7573  timezone.html#us
-00005390: 6167 652d 6e6f 7465 733e 605f 0a0a 2020  age-notes>`_..  
-000053a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-000053b0: 2020 2020 2020 2020 7461 7267 6574 5f74          target_t
-000053c0: 696d 657a 6f6e 653a 2054 6865 2074 696d  imezone: The tim
-000053d0: 6520 7a6f 6e65 2074 6f20 7768 6963 6820  e zone to which 
-000053e0: 7468 6520 696e 7075 7420 7469 6d65 7374  the input timest
-000053f0: 616d 7020 7368 6f75 6c64 2062 6520 636f  amp should be co
-00005400: 6e76 6572 7465 642e 3d0a 2020 2020 2020  nverted.=.      
-00005410: 2020 2020 2020 736f 7572 6365 5f74 696d        source_tim
-00005420: 653a 2054 6865 2074 696d 6573 7461 6d70  e: The timestamp
-00005430: 2074 6f20 636f 6e76 6572 742e 2057 6865   to convert. Whe
-00005440: 6e20 6974 2773 2061 2054 494d 4553 5441  n it's a TIMESTA
-00005450: 4d50 5f4c 545a 2c20 7573 6520 6060 4e6f  MP_LTZ, use ``No
-00005460: 6e65 6060 2066 6f72 2060 6073 6f75 7263  ne`` for ``sourc
-00005470: 655f 7469 6d65 7a6f 6e65 6060 2e0a 2020  e_timezone``..  
-00005480: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00005490: 5f74 696d 657a 6f6e 653a 2054 6865 2074  _timezone: The t
-000054a0: 696d 6520 7a6f 6e65 2066 6f72 2074 6865  ime zone for the
-000054b0: 2060 6073 6f75 7263 655f 7469 6d65 6060   ``source_time``
-000054c0: 2e20 5265 7175 6972 6564 2066 6f72 2074  . Required for t
-000054d0: 696d 6573 7461 6d70 7320 7769 7468 206e  imestamps with n
-000054e0: 6f20 7469 6d65 207a 6f6e 6520 2869 2e65  o time zone (i.e
-000054f0: 2e20 5449 4d45 5354 414d 505f 4e54 5a29  . TIMESTAMP_NTZ)
-00005500: 2e20 5573 6520 6060 4e6f 6e65 6060 2069  . Use ``None`` i
-00005510: 6620 7468 6520 7469 6d65 7374 616d 7073  f the timestamps
-00005520: 2068 6176 6520 6120 7469 6d65 207a 6f6e   have a time zon
-00005530: 6520 2869 2e65 2e20 5449 4d45 5354 414d  e (i.e. TIMESTAM
-00005540: 505f 4c54 5a29 2e20 4465 6661 756c 7420  P_LTZ). Default 
-00005550: 6973 2060 604e 6f6e 6560 602e 0a0a 2020  is ``None``...  
-00005560: 2020 2020 2020 4e6f 7465 3a0a 2020 2020        Note:.    
-00005570: 2020 2020 2020 2020 5468 6520 7365 7175          The sequ
-00005580: 656e 6365 206f 6620 7468 6520 3320 7061  ence of the 3 pa
-00005590: 7261 6d73 2069 7320 6469 6666 6572 656e  rams is differen
-000055a0: 7420 6672 6f6d 2074 6865 2053 514c 2066  t from the SQL f
-000055b0: 756e 6374 696f 6e2c 2077 6869 6368 2074  unction, which t
-000055c0: 776f 206f 7665 726c 6f61 6473 3a0a 0a20  wo overloads:.. 
-000055d0: 2020 2020 2020 2020 2020 2020 202d 2060               - `
-000055e0: 6043 4f4e 5645 5254 5f54 494d 455a 4f4e  `CONVERT_TIMEZON
-000055f0: 4528 203c 736f 7572 6365 5f74 7a3e 202c  E( <source_tz> ,
-00005600: 203c 7461 7267 6574 5f74 7a3e 202c 203c   <target_tz> , <
-00005610: 736f 7572 6365 5f74 696d 6573 7461 6d70  source_timestamp
-00005620: 5f6e 747a 3e20 2960 600a 2020 2020 2020  _ntz> )``.      
-00005630: 2020 2020 2020 2020 2d20 6060 434f 4e56          - ``CONV
-00005640: 4552 545f 5449 4d45 5a4f 4e45 2820 3c74  ERT_TIMEZONE( <t
-00005650: 6172 6765 745f 747a 3e20 2c20 3c73 6f75  arget_tz> , <sou
-00005660: 7263 655f 7469 6d65 7374 616d 703e 2029  rce_timestamp> )
-00005670: 6060 0a0a 2020 2020 2020 2020 2020 2020  ``..            
-00005680: 5468 6520 6669 7273 7420 7061 7261 6d65  The first parame
-00005690: 7465 7220 6060 736f 7572 6365 5f74 7a60  ter ``source_tz`
-000056a0: 6020 6973 206f 7074 696f 6e61 6c2e 2042  ` is optional. B
-000056b0: 7574 2069 6e20 5079 7468 6f6e 2061 6e20  ut in Python an 
-000056c0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-000056d0: 7420 7368 6f75 6c64 6e27 7420 6265 2070  t shouldn't be p
-000056e0: 6c61 6365 6420 6174 2074 6865 2066 6972  laced at the fir
-000056f0: 7374 2e0a 2020 2020 2020 2020 2020 2020  st..            
-00005700: 536f 2060 6073 6f75 7263 655f 7469 6d65  So ``source_time
-00005710: 7a6f 6e65 6060 2069 7320 6166 7465 7220  zone`` is after 
-00005720: 6060 736f 7572 6365 5f74 696d 6560 602e  ``source_time``.
-00005730: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00005740: 653a 0a20 2020 2020 2020 2020 2020 203e  e:.            >
-00005750: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00005760: 6d65 0a20 2020 2020 2020 2020 2020 203e  me.            >
-00005770: 3e3e 2066 726f 6d20 6461 7465 7574 696c  >> from dateutil
-00005780: 2069 6d70 6f72 7420 747a 0a20 2020 2020   import tz.     
-00005790: 2020 2020 2020 203e 3e3e 2064 6174 6574         >>> datet
-000057a0: 696d 655f 7769 7468 5f74 7a20 3d20 6461  ime_with_tz = da
-000057b0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-000057c0: 3230 3232 2c20 342c 2036 2c20 392c 2030  2022, 4, 6, 9, 0
-000057d0: 2c20 302c 2074 7a69 6e66 6f3d 747a 2e74  , 0, tzinfo=tz.t
-000057e0: 7a6f 6666 7365 7428 226d 797a 6f6e 6522  zoffset("myzone"
-000057f0: 2c20 2d33 3630 302a 3729 290a 2020 2020  , -3600*7)).    
-00005800: 2020 2020 2020 2020 3e3e 3e20 6461 7465          >>> date
-00005810: 7469 6d65 5f77 6974 685f 6e6f 5f74 7a20  time_with_no_tz 
-00005820: 3d20 6461 7465 7469 6d65 2e64 6174 6574  = datetime.datet
-00005830: 696d 6528 3230 3232 2c20 342c 2036 2c20  ime(2022, 4, 6, 
-00005840: 392c 2030 2c20 3029 0a20 2020 2020 2020  9, 0, 0).       
-00005850: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00005860: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00005870: 6166 7261 6d65 285b 5b64 6174 6574 696d  aframe([[datetim
-00005880: 655f 7769 7468 5f74 7a2c 2064 6174 6574  e_with_tz, datet
-00005890: 696d 655f 7769 7468 5f6e 6f5f 747a 5d5d  ime_with_no_tz]]
-000058a0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-000058b0: 6222 5d29 0a20 2020 2020 2020 2020 2020  b"]).           
-000058c0: 203e 3e3e 2072 6573 756c 7420 3d20 6466   >>> result = df
-000058d0: 2e73 656c 6563 7428 636f 6e76 6572 745f  .select(convert_
-000058e0: 7469 6d65 7a6f 6e65 286c 6974 2822 5554  timezone(lit("UT
-000058f0: 4322 292c 2063 6f6c 2822 6122 2929 2c20  C"), col("a")), 
-00005900: 636f 6e76 6572 745f 7469 6d65 7a6f 6e65  convert_timezone
-00005910: 286c 6974 2822 5554 4322 292c 2063 6f6c  (lit("UTC"), col
-00005920: 2822 6222 292c 206c 6974 2822 4173 6961  ("b"), lit("Asia
-00005930: 2f53 6861 6e67 6861 6922 2929 292e 636f  /Shanghai"))).co
-00005940: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00005950: 2020 2020 3e3e 3e20 7265 7375 6c74 5b30      >>> result[0
-00005960: 5d5b 305d 0a20 2020 2020 2020 2020 2020  ][0].           
-00005970: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-00005980: 6d65 2832 3032 322c 2034 2c20 362c 2031  me(2022, 4, 6, 1
-00005990: 362c 2030 2c20 747a 696e 666f 3d3c 5554  6, 0, tzinfo=<UT
-000059a0: 433e 290a 2020 2020 2020 2020 2020 2020  C>).            
-000059b0: 3e3e 3e20 7265 7375 6c74 5b30 5d5b 315d  >>> result[0][1]
-000059c0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000059d0: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
-000059e0: 3032 322c 2034 2c20 362c 2031 2c20 3029  022, 4, 6, 1, 0)
-000059f0: 0a20 2020 2022 2222 0a20 2020 2073 6f75  .    """.    sou
-00005a00: 7263 655f 747a 203d 2028 0a20 2020 2020  rce_tz = (.     
-00005a10: 2020 205f 746f 5f63 6f6c 5f69 665f 7374     _to_col_if_st
-00005a20: 7228 736f 7572 6365 5f74 696d 657a 6f6e  r(source_timezon
-00005a30: 652c 2022 636f 6e76 6572 745f 7469 6d65  e, "convert_time
-00005a40: 7a6f 6e65 2229 0a20 2020 2020 2020 2069  zone").        i
-00005a50: 6620 736f 7572 6365 5f74 696d 657a 6f6e  f source_timezon
-00005a60: 6520 6973 206e 6f74 204e 6f6e 650a 2020  e is not None.  
-00005a70: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
-00005a80: 2020 2020 290a 2020 2020 7461 7267 6574      ).    target
-00005a90: 5f74 7a20 3d20 5f74 6f5f 636f 6c5f 6966  _tz = _to_col_if
-00005aa0: 5f73 7472 2874 6172 6765 745f 7469 6d65  _str(target_time
-00005ab0: 7a6f 6e65 2c20 2263 6f6e 7665 7274 5f74  zone, "convert_t
-00005ac0: 696d 657a 6f6e 6522 290a 2020 2020 736f  imezone").    so
-00005ad0: 7572 6365 5f74 696d 655f 746f 5f63 6f6e  urce_time_to_con
-00005ae0: 7665 7274 203d 205f 746f 5f63 6f6c 5f69  vert = _to_col_i
-00005af0: 665f 7374 7228 736f 7572 6365 5f74 696d  f_str(source_tim
-00005b00: 652c 2022 636f 6e76 6572 745f 7469 6d65  e, "convert_time
-00005b10: 7a6f 6e65 2229 0a0a 2020 2020 6966 2073  zone")..    if s
-00005b20: 6f75 7263 655f 7469 6d65 7a6f 6e65 2069  ource_timezone i
-00005b30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00005b40: 7265 7475 726e 2063 616c 6c5f 6275 696c  return call_buil
-00005b50: 7469 6e28 2263 6f6e 7665 7274 5f74 696d  tin("convert_tim
-00005b60: 657a 6f6e 6522 2c20 7461 7267 6574 5f74  ezone", target_t
-00005b70: 7a2c 2073 6f75 7263 655f 7469 6d65 5f74  z, source_time_t
-00005b80: 6f5f 636f 6e76 6572 7429 0a20 2020 2072  o_convert).    r
-00005b90: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
-00005ba0: 696e 280a 2020 2020 2020 2020 2263 6f6e  in(.        "con
-00005bb0: 7665 7274 5f74 696d 657a 6f6e 6522 2c20  vert_timezone", 
-00005bc0: 736f 7572 6365 5f74 7a2c 2074 6172 6765  source_tz, targe
-00005bd0: 745f 747a 2c20 736f 7572 6365 5f74 696d  t_tz, source_tim
-00005be0: 655f 746f 5f63 6f6e 7665 7274 0a20 2020  e_to_convert.   
-00005bf0: 2029 0a0a 0a64 6566 2061 7070 726f 785f   )...def approx_
-00005c00: 636f 756e 745f 6469 7374 696e 6374 2865  count_distinct(e
-00005c10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00005c20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00005c30: 2222 5573 6573 2048 7970 6572 4c6f 674c  ""Uses HyperLogL
-00005c40: 6f67 2074 6f20 7265 7475 726e 2061 6e20  og to return an 
-00005c50: 6170 7072 6f78 696d 6174 696f 6e20 6f66  approximation of
-00005c60: 2074 6865 2064 6973 7469 6e63 7420 6361   the distinct ca
-00005c70: 7264 696e 616c 6974 7920 6f66 2074 6865  rdinality of the
-00005c80: 2069 6e70 7574 2028 692e 652e 2048 4c4c   input (i.e. HLL
-00005c90: 2863 6f6c 312c 2063 6f6c 322c 202e 2e2e  (col1, col2, ...
-00005ca0: 2029 0a20 2020 2072 6574 7572 6e73 2061   ).    returns a
-00005cb0: 6e20 6170 7072 6f78 696d 6174 696f 6e20  n approximation 
-00005cc0: 6f66 2043 4f55 4e54 2844 4953 5449 4e43  of COUNT(DISTINC
-00005cd0: 5420 636f 6c31 2c20 636f 6c32 2c20 2e2e  T col1, col2, ..
-00005ce0: 2e20 2929 2e0a 0a20 2020 2045 7861 6d70  . ))...    Examp
-00005cf0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00005d00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00005d10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00005d20: 5b31 2c20 325d 2c20 5b33 2c20 345d 2c20  [1, 2], [3, 4], 
-00005d30: 5b35 2c20 365d 5d2c 2073 6368 656d 613d  [5, 6]], schema=
-00005d40: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
-00005d50: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00005d60: 7428 6170 7072 6f78 5f63 6f75 6e74 5f64  t(approx_count_d
-00005d70: 6973 7469 6e63 7428 2261 2229 2e61 6c69  istinct("a").ali
-00005d80: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-00005d90: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00005da0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00005db0: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-00005dc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00005dd0: 2d2d 2d0a 2020 2020 2020 2020 7c33 2020  ---.        |3  
-00005de0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00005df0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00005e00: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00005e10: 3e0a 0a20 2020 2022 2222 0a20 2020 2063  >..    """.    c
-00005e20: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00005e30: 7228 652c 2022 6170 7072 6f78 5f63 6f75  r(e, "approx_cou
-00005e40: 6e74 5f64 6973 7469 6e63 7422 290a 2020  nt_distinct").  
-00005e50: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00005e60: 2822 6170 7072 6f78 5f63 6f75 6e74 5f64  ("approx_count_d
-00005e70: 6973 7469 6e63 7422 2928 6329 0a0a 0a64  istinct")(c)...d
-00005e80: 6566 2061 7667 2865 3a20 436f 6c75 6d6e  ef avg(e: Column
-00005e90: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00005ea0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00005eb0: 7320 7468 6520 6176 6572 6167 6520 6f66  s the average of
-00005ec0: 206e 6f6e 2d4e 554c 4c20 7265 636f 7264   non-NULL record
-00005ed0: 732e 2049 6620 616c 6c20 7265 636f 7264  s. If all record
-00005ee0: 7320 696e 7369 6465 2061 2067 726f 7570  s inside a group
-00005ef0: 2061 7265 204e 554c 4c2c 0a20 2020 2074   are NULL,.    t
-00005f00: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
-00005f10: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
-00005f20: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00005f30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00005f40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00005f50: 6d65 285b 5b31 5d2c 205b 325d 2c20 5b32  me([[1], [2], [2
-00005f60: 5d5d 2c20 7363 6865 6d61 3d5b 2264 225d  ]], schema=["d"]
-00005f70: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00005f80: 2e73 656c 6563 7428 6176 6728 6466 2e64  .select(avg(df.d
-00005f90: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00005fa0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00005fb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00005fc0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00005fd0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00005fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005ff0: 207c 312e 3636 3636 3637 2020 7c0a 2020   |1.666667  |.  
-00006000: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00006010: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00006020: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00006030: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00006040: 665f 7374 7228 652c 2022 6176 6722 290a  f_str(e, "avg").
-00006050: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00006060: 696e 2822 6176 6722 2928 6329 0a0a 0a64  in("avg")(c)...d
-00006070: 6566 2063 6f72 7228 636f 6c75 6d6e 313a  ef corr(column1:
-00006080: 2043 6f6c 756d 6e4f 724e 616d 652c 2063   ColumnOrName, c
-00006090: 6f6c 756d 6e32 3a20 436f 6c75 6d6e 4f72  olumn2: ColumnOr
-000060a0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-000060b0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-000060c0: 7468 6520 636f 7272 656c 6174 696f 6e20  the correlation 
-000060d0: 636f 6566 6669 6369 656e 7420 666f 7220  coefficient for 
-000060e0: 6e6f 6e2d 6e75 6c6c 2070 6169 7273 2069  non-null pairs i
-000060f0: 6e20 6120 6772 6f75 702e 0a0a 2020 2020  n a group...    
-00006100: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-00006110: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00006120: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00006130: 6d65 285b 5b31 2c20 325d 2c20 5b31 2c20  me([[1, 2], [1, 
-00006140: 325d 2c20 5b34 2c20 355d 2c20 5b32 2c20  2], [4, 5], [2, 
-00006150: 335d 2c20 5b33 2c20 4e6f 6e65 5d2c 205b  3], [3, None], [
-00006160: 342c 204e 6f6e 655d 2c20 5b36 2c34 5d5d  4, None], [6,4]]
-00006170: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-00006180: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-00006190: 2064 662e 7365 6c65 6374 2863 6f72 7228   df.select(corr(
-000061a0: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
-000061b0: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-000061c0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-000061d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000061e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000061f0: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
-00006200: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00006210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c30  -----.        |0
-00006230: 2e38 3133 3638 3135 3038 3332 3838 3039  .813681508328809
-00006240: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00006250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006260: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00006270: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00006280: 2020 6331 203d 205f 746f 5f63 6f6c 5f69    c1 = _to_col_i
-00006290: 665f 7374 7228 636f 6c75 6d6e 312c 2022  f_str(column1, "
-000062a0: 636f 7272 2229 0a20 2020 2063 3220 3d20  corr").    c2 = 
-000062b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-000062c0: 6f6c 756d 6e32 2c20 2263 6f72 7222 290a  olumn2, "corr").
-000062d0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000062e0: 696e 2822 636f 7272 2229 2863 312c 2063  in("corr")(c1, c
-000062f0: 3229 0a0a 0a64 6566 2063 6f75 6e74 2865  2)...def count(e
-00006300: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00006310: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00006320: 2222 5265 7475 726e 7320 6569 7468 6572  ""Returns either
-00006330: 2074 6865 206e 756d 6265 7220 6f66 206e   the number of n
-00006340: 6f6e 2d4e 554c 4c20 7265 636f 7264 7320  on-NULL records 
-00006350: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
-00006360: 6420 636f 6c75 6d6e 732c 206f 7220 7468  d columns, or th
-00006370: 650a 2020 2020 746f 7461 6c20 6e75 6d62  e.    total numb
-00006380: 6572 206f 6620 7265 636f 7264 732e 0a0a  er of records...
-00006390: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-000063a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000063b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000063c0: 6166 7261 6d65 285b 5b31 5d2c 205b 4e6f  aframe([[1], [No
-000063d0: 6e65 5d2c 205b 335d 2c20 5b34 5d2c 205b  ne], [3], [4], [
-000063e0: 4e6f 6e65 5d5d 2c20 7363 6865 6d61 3d5b  None]], schema=[
-000063f0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00006400: 3e20 6466 2e73 656c 6563 7428 636f 756e  > df.select(coun
-00006410: 7428 636f 6c28 2261 2229 292e 616c 6961  t(col("a")).alia
-00006420: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-00006430: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00006440: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00006450: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-00006460: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00006470: 2d2d 0a20 2020 2020 2020 207c 3320 2020  --.        |3   
-00006480: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00006490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-000064a0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-000064b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000064c0: 7365 6c65 6374 2863 6f75 6e74 2822 2a22  select(count("*"
-000064d0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-000064e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-000064f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00006500: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00006510: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00006520: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00006530: 207c 3520 2020 2020 2020 2020 7c0a 2020   |5         |.  
-00006540: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00006550: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00006560: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00006570: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00006580: 665f 7374 7228 652c 2022 636f 756e 7422  f_str(e, "count"
-00006590: 290a 2020 2020 7265 7475 726e 2028 0a20  ).    return (. 
-000065a0: 2020 2020 2020 2062 7569 6c74 696e 2822         builtin("
-000065b0: 636f 756e 7422 2928 4c69 7465 7261 6c28  count")(Literal(
-000065c0: 3129 290a 2020 2020 2020 2020 6966 2069  1)).        if i
-000065d0: 7369 6e73 7461 6e63 6528 632e 5f65 7870  sinstance(c._exp
-000065e0: 7265 7373 696f 6e2c 2053 7461 7229 0a20  ression, Star). 
-000065f0: 2020 2020 2020 2065 6c73 6520 6275 696c         else buil
-00006600: 7469 6e28 2263 6f75 6e74 2229 2863 2e5f  tin("count")(c._
-00006610: 6578 7072 6573 7369 6f6e 290a 2020 2020  expression).    
-00006620: 290a 0a0a 6465 6620 636f 756e 745f 6469  )...def count_di
-00006630: 7374 696e 6374 282a 636f 6c73 3a20 436f  stinct(*cols: Co
-00006640: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00006650: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00006660: 7475 726e 7320 6569 7468 6572 2074 6865  turns either the
-00006670: 206e 756d 6265 7220 6f66 206e 6f6e 2d4e   number of non-N
-00006680: 554c 4c20 6469 7374 696e 6374 2072 6563  ULL distinct rec
-00006690: 6f72 6473 2066 6f72 2074 6865 2073 7065  ords for the spe
-000066a0: 6369 6669 6564 2063 6f6c 756d 6e73 2c0a  cified columns,.
-000066b0: 2020 2020 6f72 2074 6865 2074 6f74 616c      or the total
-000066c0: 206e 756d 6265 7220 6f66 2074 6865 2064   number of the d
-000066d0: 6973 7469 6e63 7420 7265 636f 7264 732e  istinct records.
-000066e0: 0a0a 2020 2020 4578 616d 706c 653a 0a0a  ..    Example:..
-000066f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00006700: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00006710: 6461 7461 6672 616d 6528 5b5b 312c 2032  dataframe([[1, 2
-00006720: 5d2c 205b 312c 2032 5d2c 205b 332c 204e  ], [1, 2], [3, N
-00006730: 6f6e 655d 2c20 5b32 2c20 335d 2c20 5b33  one], [2, 3], [3
-00006740: 2c20 4e6f 6e65 5d2c 205b 342c 204e 6f6e  , None], [4, Non
-00006750: 655d 5d2c 2073 6368 656d 613d 5b22 6122  e]], schema=["a"
-00006760: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-00006770: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
-00006780: 756e 745f 6469 7374 696e 6374 2863 6f6c  unt_distinct(col
-00006790: 2822 6122 292c 2063 6f6c 2822 6222 2929  ("a"), col("b"))
-000067a0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-000067b0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-000067c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-000067d0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-000067e0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000067f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00006800: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
-00006810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00006820: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00006830: 4c49 4e45 3e0a 2020 2020 2020 2020 3e3e  LINE>.        >>
-00006840: 3e20 2320 2054 6865 2072 6573 756c 7420  > #  The result 
-00006850: 7368 6f75 6c64 2062 6520 3220 666f 7220  should be 2 for 
-00006860: 7b5b 312c 325d 2c5b 322c 335d 7d20 7369  {[1,2],[2,3]} si
-00006870: 6e63 6520 7468 6520 7265 7374 2061 7265  nce the rest are
-00006880: 2065 6974 6865 7220 6475 706c 6963 6174   either duplicat
-00006890: 6520 6f72 204e 554c 4c20 7265 636f 7264  e or NULL record
-000068a0: 730a 2020 2020 2222 220a 2020 2020 6373  s.    """.    cs
-000068b0: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
-000068c0: 7472 2863 2c20 2263 6f75 6e74 5f64 6973  tr(c, "count_dis
-000068d0: 7469 6e63 7422 2920 666f 7220 6320 696e  tinct") for c in
-000068e0: 2063 6f6c 735d 0a20 2020 2072 6574 7572   cols].    retur
-000068f0: 6e20 436f 6c75 6d6e 280a 2020 2020 2020  n Column(.      
-00006900: 2020 4675 6e63 7469 6f6e 4578 7072 6573    FunctionExpres
-00006910: 7369 6f6e 2822 636f 756e 7422 2c20 5b63  sion("count", [c
-00006920: 2e5f 6578 7072 6573 7369 6f6e 2066 6f72  ._expression for
-00006930: 2063 2069 6e20 6373 5d2c 2069 735f 6469   c in cs], is_di
-00006940: 7374 696e 6374 3d54 7275 6529 0a20 2020  stinct=True).   
-00006950: 2029 0a0a 0a64 6566 2063 6f76 6172 5f70   )...def covar_p
-00006960: 6f70 2863 6f6c 756d 6e31 3a20 436f 6c75  op(column1: Colu
-00006970: 6d6e 4f72 4e61 6d65 2c20 636f 6c75 6d6e  mnOrName, column
-00006980: 323a 2043 6f6c 756d 6e4f 724e 616d 6529  2: ColumnOrName)
-00006990: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-000069a0: 2222 2252 6574 7572 6e73 2074 6865 2070  """Returns the p
-000069b0: 6f70 756c 6174 696f 6e20 636f 7661 7269  opulation covari
-000069c0: 616e 6365 2066 6f72 206e 6f6e 2d6e 756c  ance for non-nul
-000069d0: 6c20 7061 6972 7320 696e 2061 2067 726f  l pairs in a gro
-000069e0: 7570 2e0a 0a20 2020 2045 7861 6d70 6c65  up...    Example
-000069f0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-00006a00: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00006a10: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-00006a20: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
-00006a30: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00006a40: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00006a50: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
-00006a60: 2c20 5b31 2c20 325d 2c20 5b34 2c20 355d  , [1, 2], [4, 5]
-00006a70: 2c20 5b32 2c20 335d 2c20 5b33 2c20 4e6f  , [2, 3], [3, No
-00006a80: 6e65 5d2c 205b 342c 204e 6f6e 655d 2c20  ne], [4, None], 
-00006a90: 5b36 2c34 5d5d 2c20 7363 6865 6d61 3d5b  [6,4]], schema=[
-00006aa0: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-00006ab0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00006ac0: 2863 6f76 6172 5f70 6f70 2863 6f6c 2822  (covar_pop(col("
-00006ad0: 6122 292c 2063 6f6c 2822 6222 2929 2e63  a"), col("b")).c
-00006ae0: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
-00006af0: 7363 616c 653d 3329 292e 616c 6961 7328  scale=3)).alias(
-00006b00: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00006b10: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00006b20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00006b30: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00006b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00006b50: 0a20 2020 2020 2020 207c 312e 3834 3020  .        |1.840 
-00006b60: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00006b70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00006b80: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-00006b90: 2020 2022 2222 0a20 2020 2063 6f6c 3120     """.    col1 
-00006ba0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00006bb0: 2863 6f6c 756d 6e31 2c20 2263 6f76 6172  (column1, "covar
-00006bc0: 5f70 6f70 2229 0a20 2020 2063 6f6c 3220  _pop").    col2 
-00006bd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00006be0: 2863 6f6c 756d 6e32 2c20 2263 6f76 6172  (column2, "covar
-00006bf0: 5f70 6f70 2229 0a20 2020 2072 6574 7572  _pop").    retur
-00006c00: 6e20 6275 696c 7469 6e28 2263 6f76 6172  n builtin("covar
-00006c10: 5f70 6f70 2229 2863 6f6c 312c 2063 6f6c  _pop")(col1, col
-00006c20: 3229 0a0a 0a64 6566 2063 6f76 6172 5f73  2)...def covar_s
-00006c30: 616d 7028 636f 6c75 6d6e 313a 2043 6f6c  amp(column1: Col
-00006c40: 756d 6e4f 724e 616d 652c 2063 6f6c 756d  umnOrName, colum
-00006c50: 6e32 3a20 436f 6c75 6d6e 4f72 4e61 6d65  n2: ColumnOrName
-00006c60: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00006c70: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00006c80: 7361 6d70 6c65 2063 6f76 6172 6961 6e63  sample covarianc
-00006c90: 6520 666f 7220 6e6f 6e2d 6e75 6c6c 2070  e for non-null p
-00006ca0: 6169 7273 2069 6e20 6120 6772 6f75 702e  airs in a group.
-00006cb0: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
-00006cc0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00006cd0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00006ce0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-00006cf0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
-00006d00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00006d10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00006d20: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
-00006d30: 312c 2032 5d2c 205b 342c 2035 5d2c 205b  1, 2], [4, 5], [
-00006d40: 322c 2033 5d2c 205b 332c 204e 6f6e 655d  2, 3], [3, None]
-00006d50: 2c20 5b34 2c20 4e6f 6e65 5d2c 205b 362c  , [4, None], [6,
-00006d60: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
-00006d70: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-00006d80: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
-00006d90: 7661 725f 7361 6d70 2863 6f6c 2822 6122  var_samp(col("a"
-00006da0: 292c 2063 6f6c 2822 6222 2929 2e63 6173  ), col("b")).cas
-00006db0: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
-00006dc0: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
-00006dd0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00006de0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00006df0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-00006e00: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-00006e10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00006e20: 2020 2020 2020 207c 322e 3330 3020 2020         |2.300   
-00006e30: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00006e40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00006e50: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00006e60: 2022 2222 0a20 2020 2063 6f6c 3120 3d20   """.    col1 = 
-00006e70: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-00006e80: 6f6c 756d 6e31 2c20 2263 6f76 6172 5f73  olumn1, "covar_s
-00006e90: 616d 7022 290a 2020 2020 636f 6c32 203d  amp").    col2 =
-00006ea0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00006eb0: 636f 6c75 6d6e 322c 2022 636f 7661 725f  column2, "covar_
-00006ec0: 7361 6d70 2229 0a20 2020 2072 6574 7572  samp").    retur
-00006ed0: 6e20 6275 696c 7469 6e28 2263 6f76 6172  n builtin("covar
-00006ee0: 5f73 616d 7022 2928 636f 6c31 2c20 636f  _samp")(col1, co
-00006ef0: 6c32 290a 0a0a 6465 6620 6b75 7274 6f73  l2)...def kurtos
-00006f00: 6973 2865 3a20 436f 6c75 6d6e 4f72 4e61  is(e: ColumnOrNa
-00006f10: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00006f20: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-00006f30: 6e73 2074 6865 2070 6f70 756c 6174 696f  ns the populatio
-00006f40: 6e20 6578 6365 7373 206b 7572 746f 7369  n excess kurtosi
-00006f50: 7320 6f66 206e 6f6e 2d4e 554c 4c20 7265  s of non-NULL re
-00006f60: 636f 7264 732e 2049 6620 616c 6c20 7265  cords. If all re
-00006f70: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
-00006f80: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
-00006f90: 4c2c 2074 6865 2066 756e 6374 696f 6e20  L, the function 
-00006fa0: 7265 7475 726e 7320 4e55 4c4c 2e0a 0a20  returns NULL... 
-00006fb0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00006fc0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00006fd0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00006fe0: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-00006ff0: 7274 206b 7572 746f 7369 730a 2020 2020  rt kurtosis.    
-00007000: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00007010: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00007020: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
-00007030: 2031 2c20 335d 2c20 7363 6865 6d61 3d5b   1, 3], schema=[
-00007040: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
-00007050: 3e20 6466 2e73 656c 6563 7428 6b75 7274  > df.select(kurt
-00007060: 6f73 6973 2822 7822 292e 6173 5f28 2278  osis("x").as_("x
-00007070: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00007080: 2020 2020 2020 5b52 6f77 2858 3d44 6563        [Row(X=Dec
-00007090: 696d 616c 2827 332e 3631 3337 3336 3630  imal('3.61373660
-000070a0: 3939 3536 2729 295d 0a20 2020 2022 2222  9956'))].    """
-000070b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000070c0: 5f69 665f 7374 7228 652c 2022 6b75 7274  _if_str(e, "kurt
-000070d0: 6f73 6973 2229 0a20 2020 2072 6574 7572  osis").    retur
-000070e0: 6e20 6275 696c 7469 6e28 226b 7572 746f  n builtin("kurto
-000070f0: 7369 7322 2928 6329 0a0a 0a64 6566 206d  sis")(c)...def m
-00007100: 6178 2865 3a20 436f 6c75 6d6e 4f72 4e61  ax(e: ColumnOrNa
-00007110: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00007120: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-00007130: 6e73 2074 6865 206d 6178 696d 756d 2076  ns the maximum v
-00007140: 616c 7565 2066 6f72 2074 6865 2072 6563  alue for the rec
-00007150: 6f72 6473 2069 6e20 6120 6772 6f75 702e  ords in a group.
-00007160: 204e 554c 4c20 7661 6c75 6573 2061 7265   NULL values are
-00007170: 2069 676e 6f72 6564 0a20 2020 2075 6e6c   ignored.    unl
-00007180: 6573 7320 616c 6c20 7468 6520 7265 636f  ess all the reco
-00007190: 7264 7320 6172 6520 4e55 4c4c 2c20 696e  rds are NULL, in
-000071a0: 2077 6869 6368 2063 6173 6520 6120 4e55   which case a NU
-000071b0: 4c4c 2076 616c 7565 2069 7320 7265 7475  LL value is retu
-000071c0: 726e 6564 2e0a 0a20 2020 2045 7861 6d70  rned...    Examp
-000071d0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-000071e0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000071f0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00007200: 5b31 2c20 332c 2031 302c 2031 2c20 335d  [1, 3, 10, 1, 3]
-00007210: 2c20 7363 6865 6d61 3d5b 2278 225d 290a  , schema=["x"]).
-00007220: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00007230: 656c 6563 7428 6d61 7828 2278 2229 2e61  elect(max("x").a
-00007240: 735f 2822 7822 2929 2e63 6f6c 6c65 6374  s_("x")).collect
-00007250: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00007260: 583d 3130 295d 0a20 2020 2022 2222 0a20  X=10)].    """. 
-00007270: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00007280: 665f 7374 7228 652c 2022 6d61 7822 290a  f_str(e, "max").
-00007290: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000072a0: 696e 2822 6d61 7822 2928 6329 0a0a 0a64  in("max")(c)...d
-000072b0: 6566 206d 6561 6e28 653a 2043 6f6c 756d  ef mean(e: Colum
-000072c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000072d0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000072e0: 5265 7475 726e 2074 6865 2061 7665 7261  Return the avera
-000072f0: 6765 2066 6f72 2074 6865 2073 7065 6369  ge for the speci
-00007300: 6669 6320 6e75 6d65 7269 6320 636f 6c75  fic numeric colu
-00007310: 6d6e 732e 2041 6c69 6173 206f 6620 3a66  mns. Alias of :f
-00007320: 756e 633a 6061 7667 602e 0a0a 2020 2020  unc:`avg`...    
-00007330: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00007340: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00007350: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00007360: 7261 6d65 285b 312c 2033 2c20 3130 2c20  rame([1, 3, 10, 
-00007370: 312c 2033 5d2c 2073 6368 656d 613d 5b22  1, 3], schema=["
-00007380: 7822 5d29 0a20 2020 2020 2020 203e 3e3e  x"]).        >>>
-00007390: 2064 662e 7365 6c65 6374 286d 6561 6e28   df.select(mean(
-000073a0: 2278 2229 2e61 735f 2822 7822 2929 2e63  "x").as_("x")).c
-000073b0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000073c0: 205b 526f 7728 583d 4465 6369 6d61 6c28   [Row(X=Decimal(
-000073d0: 2733 2e36 3030 3030 3027 2929 5d0a 2020  '3.600000'))].  
-000073e0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-000073f0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00007400: 226d 6561 6e22 290a 2020 2020 7265 7475  "mean").    retu
-00007410: 726e 2061 7667 2863 290a 0a0a 6465 6620  rn avg(c)...def 
-00007420: 6d65 6469 616e 2865 3a20 436f 6c75 6d6e  median(e: Column
-00007430: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00007440: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-00007450: 6574 7572 6e73 2074 6865 206d 6564 6961  eturns the media
-00007460: 6e20 7661 6c75 6520 666f 7220 7468 6520  n value for the 
-00007470: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
-00007480: 7570 2e20 4e55 4c4c 2076 616c 7565 7320  up. NULL values 
-00007490: 6172 6520 6967 6e6f 7265 640a 2020 2020  are ignored.    
-000074a0: 756e 6c65 7373 2061 6c6c 2074 6865 2072  unless all the r
-000074b0: 6563 6f72 6473 2061 7265 204e 554c 4c2c  ecords are NULL,
-000074c0: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
-000074d0: 204e 554c 4c20 7661 6c75 6520 6973 2072   NULL value is r
-000074e0: 6574 7572 6e65 642e 0a0a 2020 2020 4578  eturned...    Ex
-000074f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00007500: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00007510: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00007520: 6d65 285b 312c 2033 2c20 3130 2c20 312c  me([1, 3, 10, 1,
-00007530: 2033 5d2c 2073 6368 656d 613d 5b22 7822   3], schema=["x"
-00007540: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00007550: 662e 7365 6c65 6374 286d 6564 6961 6e28  f.select(median(
-00007560: 2278 2229 2e61 735f 2822 7822 2929 2e63  "x").as_("x")).c
-00007570: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00007580: 205b 526f 7728 583d 4465 6369 6d61 6c28   [Row(X=Decimal(
-00007590: 2733 2e30 3030 2729 295d 0a20 2020 2022  '3.000'))].    "
-000075a0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-000075b0: 6f6c 5f69 665f 7374 7228 652c 2022 6d65  ol_if_str(e, "me
-000075c0: 6469 616e 2229 0a20 2020 2072 6574 7572  dian").    retur
-000075d0: 6e20 6275 696c 7469 6e28 226d 6564 6961  n builtin("media
-000075e0: 6e22 2928 6329 0a0a 0a64 6566 206d 696e  n")(c)...def min
-000075f0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00007600: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00007610: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00007620: 2074 6865 206d 696e 696d 756d 2076 616c   the minimum val
-00007630: 7565 2066 6f72 2074 6865 2072 6563 6f72  ue for the recor
-00007640: 6473 2069 6e20 6120 6772 6f75 702e 204e  ds in a group. N
-00007650: 554c 4c20 7661 6c75 6573 2061 7265 2069  ULL values are i
-00007660: 676e 6f72 6564 0a20 2020 2075 6e6c 6573  gnored.    unles
-00007670: 7320 616c 6c20 7468 6520 7265 636f 7264  s all the record
-00007680: 7320 6172 6520 4e55 4c4c 2c20 696e 2077  s are NULL, in w
-00007690: 6869 6368 2063 6173 6520 6120 4e55 4c4c  hich case a NULL
-000076a0: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
-000076b0: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
-000076c0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-000076d0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-000076e0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-000076f0: 2c20 332c 2031 302c 2031 2c20 335d 2c20  , 3, 10, 1, 3], 
-00007700: 7363 6865 6d61 3d5b 2278 225d 290a 2020  schema=["x"]).  
-00007710: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00007720: 6563 7428 6d69 6e28 2278 2229 2e61 735f  ect(min("x").as_
-00007730: 2822 7822 2929 2e63 6f6c 6c65 6374 2829  ("x")).collect()
-00007740: 0a20 2020 2020 2020 205b 526f 7728 583d  .        [Row(X=
-00007750: 3129 5d0a 2020 2020 2222 220a 2020 2020  1)].    """.    
-00007760: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00007770: 7472 2865 2c20 226d 696e 2229 0a20 2020  tr(e, "min").   
-00007780: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00007790: 226d 696e 2229 2863 290a 0a0a 6465 6620  "min")(c)...def 
-000077a0: 6d6f 6465 2865 3a20 436f 6c75 6d6e 4f72  mode(e: ColumnOr
-000077b0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-000077c0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-000077d0: 7572 6e73 2074 6865 206d 6f73 7420 6672  urns the most fr
-000077e0: 6571 7565 6e74 2076 616c 7565 2066 6f72  equent value for
-000077f0: 2074 6865 2072 6563 6f72 6473 2069 6e20   the records in 
-00007800: 6120 6772 6f75 702e 204e 554c 4c20 7661  a group. NULL va
-00007810: 6c75 6573 2061 7265 2069 676e 6f72 6564  lues are ignored
-00007820: 2e0a 2020 2020 4966 2061 6c6c 2074 6865  ..    If all the
-00007830: 2076 616c 7565 7320 6172 6520 4e55 4c4c   values are NULL
-00007840: 2c20 6f72 2074 6865 7265 2061 7265 2030  , or there are 0
-00007850: 2072 6f77 732c 2074 6865 6e20 7468 6520   rows, then the 
-00007860: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
-00007870: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
-00007880: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00007890: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000078a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000078b0: 285b 312c 2033 2c20 3130 2c20 312c 2034  ([1, 3, 10, 1, 4
-000078c0: 5d2c 2073 6368 656d 613d 5b22 7822 5d29  ], schema=["x"])
-000078d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000078e0: 7365 6c65 6374 286d 6f64 6528 2278 2229  select(mode("x")
-000078f0: 2e61 735f 2822 7822 2929 2e63 6f6c 6c65  .as_("x")).colle
-00007900: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00007910: 7728 583d 3129 5d0a 2020 2020 2222 220a  w(X=1)].    """.
-00007920: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00007930: 6966 5f73 7472 2865 2c20 226d 6f64 6522  if_str(e, "mode"
-00007940: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00007950: 6c74 696e 2822 6d6f 6465 2229 2863 290a  ltin("mode")(c).
-00007960: 0a0a 6465 6620 736b 6577 2865 3a20 436f  ..def skew(e: Co
-00007970: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00007980: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00007990: 7475 726e 7320 7468 6520 7361 6d70 6c65  turns the sample
-000079a0: 2073 6b65 776e 6573 7320 6f66 206e 6f6e   skewness of non
-000079b0: 2d4e 554c 4c20 7265 636f 7264 732e 2049  -NULL records. I
-000079c0: 6620 616c 6c20 7265 636f 7264 7320 696e  f all records in
-000079d0: 7369 6465 2061 2067 726f 7570 0a20 2020  side a group.   
-000079e0: 2061 7265 204e 554c 4c2c 2074 6865 2066   are NULL, the f
-000079f0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-00007a00: 4e55 4c4c 2e0a 0a20 2020 2045 7861 6d70  NULL...    Examp
-00007a10: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00007a20: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-00007a30: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-00007a40: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
-00007a50: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00007a60: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00007a70: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-00007a80: 2020 2020 202e 2e2e 2020 2020 205b 3130       ...     [10
-00007a90: 2c20 3130 2c20 3230 2c20 3235 2c20 3330  , 10, 20, 25, 30
-00007aa0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-00007ab0: 2020 2073 6368 656d 613d 5b22 6122 5d0a     schema=["a"].
-00007ac0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
-00007ad0: 6c65 6374 2873 6b65 7728 2261 2229 2e63  lect(skew("a").c
-00007ae0: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
-00007af0: 7363 616c 653d 3429 2929 0a20 2020 2020  scale=4))).     
-00007b00: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
-00007b10: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00007b20: 2843 4153 5420 2853 4b45 5728 2241 2229  (CAST (SKEW("A")
-00007b30: 2041 5320 4e55 4d42 4552 2833 382c 2034   AS NUMBER(38, 4
-00007b40: 2929 3d44 6563 696d 616c 2827 302e 3035  ))=Decimal('0.05
-00007b50: 3234 2729 295d 0a20 2020 2022 2222 0a20  24'))].    """. 
-00007b60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00007b70: 665f 7374 7228 652c 2022 736b 6577 2229  f_str(e, "skew")
-00007b80: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00007b90: 7469 6e28 2273 6b65 7722 2928 6329 0a0a  tin("skew")(c)..
-00007ba0: 0a64 6566 2073 7464 6465 7628 653a 2043  .def stddev(e: C
-00007bb0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00007bc0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00007bd0: 6574 7572 6e73 2074 6865 2073 616d 706c  eturns the sampl
-00007be0: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
-00007bf0: 7469 6f6e 2028 7371 7561 7265 2072 6f6f  tion (square roo
-00007c00: 7420 6f66 2073 616d 706c 6520 7661 7269  t of sample vari
-00007c10: 616e 6365 2920 6f66 0a20 2020 206e 6f6e  ance) of.    non
-00007c20: 2d4e 554c 4c20 7661 6c75 6573 2e20 4966  -NULL values. If
-00007c30: 2061 6c6c 2072 6563 6f72 6473 2069 6e73   all records ins
-00007c40: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
-00007c50: 4e55 4c4c 2c20 7265 7475 726e 7320 4e55  NULL, returns NU
-00007c60: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
-00007c70: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
-00007c80: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00007c90: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-00007ca0: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
-00007cb0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00007cc0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00007cd0: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-00007ce0: 2020 202e 2e2e 2020 2020 205b 342c 2039     ...     [4, 9
-00007cf0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-00007d00: 2020 2073 6368 656d 613d 5b22 4e22 5d2c     schema=["N"],
-00007d10: 0a20 2020 2020 2020 202e 2e2e 2029 2e73  .        ... ).s
-00007d20: 656c 6563 7428 7374 6464 6576 2863 6f6c  elect(stddev(col
-00007d30: 2822 4e22 2929 2e63 6173 7428 4465 6369  ("N")).cast(Deci
-00007d40: 6d61 6c54 7970 6528 7363 616c 653d 3429  malType(scale=4)
-00007d50: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
-00007d60: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
-00007d70: 2020 2020 5b52 6f77 2843 4153 5420 2853      [Row(CAST (S
-00007d80: 5444 4445 5628 224e 2229 2041 5320 4e55  TDDEV("N") AS NU
-00007d90: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
-00007da0: 696d 616c 2827 332e 3533 3535 2729 295d  imal('3.5355'))]
-00007db0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00007dc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00007dd0: 652c 2022 7374 6464 6576 2229 0a20 2020  e, "stddev").   
-00007de0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00007df0: 2273 7464 6465 7622 2928 6329 0a0a 0a64  "stddev")(c)...d
-00007e00: 6566 2073 7464 6465 765f 7361 6d70 2865  ef stddev_samp(e
-00007e10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00007e20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00007e30: 2222 5265 7475 726e 7320 7468 6520 7361  ""Returns the sa
-00007e40: 6d70 6c65 2073 7461 6e64 6172 6420 6465  mple standard de
-00007e50: 7669 6174 696f 6e20 2873 7175 6172 6520  viation (square 
-00007e60: 726f 6f74 206f 6620 7361 6d70 6c65 2076  root of sample v
-00007e70: 6172 6961 6e63 6529 206f 660a 2020 2020  ariance) of.    
-00007e80: 6e6f 6e2d 4e55 4c4c 2076 616c 7565 732e  non-NULL values.
-00007e90: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
-00007ea0: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
-00007eb0: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
-00007ec0: 204e 554c 4c2e 2041 6c69 6173 206f 660a   NULL. Alias of.
-00007ed0: 2020 2020 3a66 756e 633a 6073 7464 6465      :func:`stdde
-00007ee0: 7660 2e0a 0a20 2020 2045 7861 6d70 6c65  v`...    Example
-00007ef0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
-00007f00: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00007f10: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-00007f20: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
-00007f30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00007f40: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00007f50: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-00007f60: 2020 202e 2e2e 2020 2020 205b 342c 2039     ...     [4, 9
-00007f70: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-00007f80: 2020 2073 6368 656d 613d 5b22 4e22 5d2c     schema=["N"],
-00007f90: 0a20 2020 2020 2020 202e 2e2e 2029 2e73  .        ... ).s
-00007fa0: 656c 6563 7428 7374 6464 6576 5f73 616d  elect(stddev_sam
-00007fb0: 7028 636f 6c28 224e 2229 292e 6361 7374  p(col("N")).cast
-00007fc0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
-00007fd0: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
-00007fe0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
-00007ff0: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
-00008000: 5354 2028 5354 4444 4556 5f53 414d 5028  ST (STDDEV_SAMP(
-00008010: 224e 2229 2041 5320 4e55 4d42 4552 2833  "N") AS NUMBER(3
-00008020: 382c 2034 2929 3d44 6563 696d 616c 2827  8, 4))=Decimal('
-00008030: 332e 3533 3535 2729 295d 0a20 2020 2022  3.5355'))].    "
-00008040: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00008050: 6f6c 5f69 665f 7374 7228 652c 2022 7374  ol_if_str(e, "st
-00008060: 6464 6576 5f73 616d 7022 290a 2020 2020  ddev_samp").    
-00008070: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00008080: 7374 6464 6576 5f73 616d 7022 2928 6329  stddev_samp")(c)
-00008090: 0a0a 0a64 6566 2073 7464 6465 765f 706f  ...def stddev_po
-000080a0: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
-000080b0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-000080c0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-000080d0: 2070 6f70 756c 6174 696f 6e20 7374 616e   population stan
-000080e0: 6461 7264 2064 6576 6961 7469 6f6e 2028  dard deviation (
-000080f0: 7371 7561 7265 2072 6f6f 7420 6f66 2076  square root of v
-00008100: 6172 6961 6e63 6529 206f 6620 6e6f 6e2d  ariance) of non-
-00008110: 4e55 4c4c 0a20 2020 2076 616c 7565 732e  NULL.    values.
-00008120: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
-00008130: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
-00008140: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
-00008150: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
-00008160: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00008170: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00008180: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00008190: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-000081a0: 205b 342c 2039 5d2c 0a20 2020 2020 2020   [4, 9],.       
-000081b0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-000081c0: 5b22 4e22 5d2c 0a20 2020 2020 2020 202e  ["N"],.        .
-000081d0: 2e2e 2029 2e73 656c 6563 7428 7374 6464  .. ).select(stdd
-000081e0: 6576 5f70 6f70 2863 6f6c 2822 4e22 2929  ev_pop(col("N"))
-000081f0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00008200: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00008210: 2020 205b 526f 7728 5354 4444 4556 5f50     [Row(STDDEV_P
-00008220: 4f50 2822 4e22 293d 322e 3529 5d0a 2020  OP("N")=2.5)].  
-00008230: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00008240: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00008250: 2273 7464 6465 765f 706f 7022 290a 2020  "stddev_pop").  
-00008260: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00008270: 2822 7374 6464 6576 5f70 6f70 2229 2863  ("stddev_pop")(c
-00008280: 290a 0a0a 6465 6620 7375 6d28 653a 2043  )...def sum(e: C
-00008290: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-000082a0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-000082b0: 6574 7572 6e73 2074 6865 2073 756d 206f  eturns the sum o
-000082c0: 6620 6e6f 6e2d 4e55 4c4c 2072 6563 6f72  f non-NULL recor
-000082d0: 6473 2069 6e20 6120 6772 6f75 702e 2059  ds in a group. Y
-000082e0: 6f75 2063 616e 2075 7365 2074 6865 2044  ou can use the D
-000082f0: 4953 5449 4e43 5420 6b65 7977 6f72 640a  ISTINCT keyword.
-00008300: 2020 2020 746f 2063 6f6d 7075 7465 2074      to compute t
-00008310: 6865 2073 756d 206f 6620 756e 6971 7565  he sum of unique
-00008320: 206e 6f6e 2d6e 756c 6c20 7661 6c75 6573   non-null values
-00008330: 2e20 4966 2061 6c6c 2072 6563 6f72 6473  . If all records
-00008340: 2069 6e73 6964 6520 6120 6772 6f75 7020   inside a group 
-00008350: 6172 650a 2020 2020 4e55 4c4c 2c20 7468  are.    NULL, th
-00008360: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-00008370: 6e73 204e 554c 4c2e 0a0a 2020 2020 4578  ns NULL...    Ex
-00008380: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00008390: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000083a0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000083b0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-000083c0: 2020 205b 342c 2039 5d2c 0a20 2020 2020     [4, 9],.     
-000083d0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-000083e0: 613d 5b22 4e22 5d2c 0a20 2020 2020 2020  a=["N"],.       
-000083f0: 202e 2e2e 2029 2e73 656c 6563 7428 7375   ... ).select(su
-00008400: 6d28 636f 6c28 224e 2229 2929 0a20 2020  m(col("N"))).   
-00008410: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
-00008420: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00008430: 6f77 2853 554d 2822 4e22 293d 3133 295d  ow(SUM("N")=13)]
-00008440: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00008450: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00008460: 652c 2022 7375 6d22 290a 2020 2020 7265  e, "sum").    re
-00008470: 7475 726e 2062 7569 6c74 696e 2822 7375  turn builtin("su
-00008480: 6d22 2928 6329 0a0a 0a64 6566 2073 756d  m")(c)...def sum
-00008490: 5f64 6973 7469 6e63 7428 653a 2043 6f6c  _distinct(e: Col
-000084a0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000084b0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-000084c0: 7572 6e73 2074 6865 2073 756d 206f 6620  urns the sum of 
-000084d0: 6e6f 6e2d 4e55 4c4c 2064 6973 7469 6e63  non-NULL distinc
-000084e0: 7420 7265 636f 7264 7320 696e 2061 2067  t records in a g
-000084f0: 726f 7570 2e20 596f 7520 6361 6e20 7573  roup. You can us
-00008500: 6520 7468 650a 2020 2020 4449 5354 494e  e the.    DISTIN
-00008510: 4354 206b 6579 776f 7264 2074 6f20 636f  CT keyword to co
-00008520: 6d70 7574 6520 7468 6520 7375 6d20 6f66  mpute the sum of
-00008530: 2075 6e69 7175 6520 6e6f 6e2d 6e75 6c6c   unique non-null
-00008540: 2076 616c 7565 732e 2049 6620 616c 6c20   values. If all 
-00008550: 7265 636f 7264 730a 2020 2020 696e 7369  records.    insi
-00008560: 6465 2061 2067 726f 7570 2061 7265 204e  de a group are N
-00008570: 554c 4c2c 2074 6865 2066 756e 6374 696f  ULL, the functio
-00008580: 6e20 7265 7475 726e 7320 4e55 4c4c 2e0a  n returns NULL..
-00008590: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-000085a0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000085b0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000085c0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-000085d0: 2020 2e2e 2e20 2020 2020 5b31 2c20 322c    ...     [1, 2,
-000085e0: 204e 6f6e 652c 2033 5d2c 0a20 2020 2020   None, 3],.     
-000085f0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-00008600: 613d 5b22 4e22 5d2c 0a20 2020 2020 2020  a=["N"],.       
-00008610: 202e 2e2e 2029 2e73 656c 6563 7428 7375   ... ).select(su
-00008620: 6d5f 6469 7374 696e 6374 2863 6f6c 2822  m_distinct(col("
-00008630: 4e22 2929 290a 2020 2020 2020 2020 3e3e  N"))).        >>
-00008640: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
-00008650: 2020 2020 2020 205b 526f 7728 5355 4d28         [Row(SUM(
-00008660: 2044 4953 5449 4e43 5420 224e 2229 3d36   DISTINCT "N")=6
-00008670: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-00008680: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00008690: 7228 652c 2022 7375 6d5f 6469 7374 696e  r(e, "sum_distin
-000086a0: 6374 2229 0a20 2020 2072 6574 7572 6e20  ct").    return 
-000086b0: 5f63 616c 6c5f 6675 6e63 7469 6f6e 2822  _call_function("
-000086c0: 7375 6d22 2c20 5472 7565 2c20 6329 0a0a  sum", True, c)..
-000086d0: 0a64 6566 2076 6172 6961 6e63 6528 653a  .def variance(e:
-000086e0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000086f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00008700: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
-00008710: 706c 6520 7661 7269 616e 6365 206f 6620  ple variance of 
-00008720: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
-00008730: 2069 6e20 6120 6772 6f75 702e 2049 6620   in a group. If 
-00008740: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
-00008750: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
-00008760: 7265 204e 554c 4c2c 2061 204e 554c 4c20  re NULL, a NULL 
-00008770: 6973 2072 6574 7572 6e65 642e 2046 6f72  is returned. For
-00008780: 2061 2073 696e 676c 6520 726f 772c 204e   a single row, N
-00008790: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
-000087a0: 6173 2073 616d 706c 6520 7661 7269 616e  as sample varian
-000087b0: 6365 2e0a 0a20 2020 2045 7861 6d70 6c65  ce...    Example
-000087c0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-000087d0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-000087e0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-000087f0: 2c20 2d31 2c20 312c 202d 312c 202d 315d  , -1, 1, -1, -1]
-00008800: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00008810: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00008820: 656c 6563 7428 7661 7269 616e 6365 2863  elect(variance(c
-00008830: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
-00008840: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00008850: 2856 4152 4941 4e43 4528 2241 2229 3d44  (VARIANCE("A")=D
-00008860: 6563 696d 616c 2827 312e 3230 3030 3030  ecimal('1.200000
-00008870: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
-00008880: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00008890: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000088a0: 5b31 2c20 4e6f 6e65 2c20 322c 2033 2c20  [1, None, 2, 3, 
-000088b0: 4e6f 6e65 2c20 352c 2036 5d2c 2073 6368  None, 5, 6], sch
-000088c0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-000088d0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000088e0: 2876 6172 6961 6e63 6528 636f 6c28 2261  (variance(col("a
-000088f0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00008900: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
-00008910: 414e 4345 2822 4122 293d 4465 6369 6d61  ANCE("A")=Decima
-00008920: 6c28 2734 2e33 3030 3030 3027 2929 5d0a  l('4.300000'))].
-00008930: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00008940: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00008950: 5f64 6174 6166 7261 6d65 285b 4e6f 6e65  _dataframe([None
-00008960: 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c 2073  , None, None], s
-00008970: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00008980: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00008990: 6374 2876 6172 6961 6e63 6528 636f 6c28  ct(variance(col(
-000089a0: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-000089b0: 0a20 2020 2020 2020 205b 526f 7728 5641  .        [Row(VA
-000089c0: 5249 414e 4345 2822 4122 293d 4e6f 6e65  RIANCE("A")=None
-000089d0: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-000089e0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-000089f0: 6174 655f 6461 7461 6672 616d 6528 5b34  ate_dataframe([4
-00008a00: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
-00008a10: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00008a20: 2e73 656c 6563 7428 7661 7269 616e 6365  .select(variance
-00008a30: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-00008a40: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00008a50: 6f77 2856 4152 4941 4e43 4528 2241 2229  ow(VARIANCE("A")
-00008a60: 3d4e 6f6e 6529 5d0a 0a20 2020 2022 2222  =None)]..    """
-00008a70: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00008a80: 5f69 665f 7374 7228 652c 2022 7661 7269  _if_str(e, "vari
-00008a90: 616e 6365 2229 0a20 2020 2072 6574 7572  ance").    retur
-00008aa0: 6e20 6275 696c 7469 6e28 2276 6172 6961  n builtin("varia
-00008ab0: 6e63 6522 2928 6329 0a0a 0a64 6566 2076  nce")(c)...def v
-00008ac0: 6172 5f73 616d 7028 653a 2043 6f6c 756d  ar_samp(e: Colum
-00008ad0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00008ae0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00008af0: 6e73 2074 6865 2073 616d 706c 6520 7661  ns the sample va
-00008b00: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
-00008b10: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
-00008b20: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
-00008b30: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
-00008b40: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
-00008b50: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
-00008b60: 7572 6e65 642e 2046 6f72 2061 2073 696e  urned. For a sin
-00008b70: 676c 6520 726f 772c 204e 554c 4c20 6973  gle row, NULL is
-00008b80: 2072 6574 7572 6e65 6420 6173 2073 616d   returned as sam
-00008b90: 706c 6520 7661 7269 616e 6365 2e0a 2020  ple variance..  
-00008ba0: 2020 416c 6961 7320 6f66 203a 6675 6e63    Alias of :func
-00008bb0: 3a60 7661 7269 616e 6365 600a 0a20 2020  :`variance`..   
-00008bc0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00008bd0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00008be0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00008bf0: 6672 616d 6528 5b31 2c20 2d31 2c20 312c  frame([1, -1, 1,
-00008c00: 202d 312c 202d 315d 2c20 7363 6865 6d61   -1, -1], schema
-00008c10: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00008c20: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
-00008c30: 725f 7361 6d70 2863 6f6c 2822 6122 2929  r_samp(col("a"))
-00008c40: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00008c50: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
-00008c60: 4528 2241 2229 3d44 6563 696d 616c 2827  E("A")=Decimal('
-00008c70: 312e 3230 3030 3030 2729 295d 0a0a 2020  1.200000'))]..  
-00008c80: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00008c90: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00008ca0: 7461 6672 616d 6528 5b31 2c20 4e6f 6e65  taframe([1, None
-00008cb0: 2c20 322c 2033 2c20 4e6f 6e65 2c20 352c  , 2, 3, None, 5,
-00008cc0: 2036 5d2c 2073 6368 656d 613d 5b22 6122   6], schema=["a"
-00008cd0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00008ce0: 662e 7365 6c65 6374 2876 6172 5f73 616d  f.select(var_sam
-00008cf0: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
-00008d00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00008d10: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
-00008d20: 293d 4465 6369 6d61 6c28 2734 2e33 3030  )=Decimal('4.300
-00008d30: 3030 3027 2929 5d0a 0a20 2020 2020 2020  000'))]..       
-00008d40: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00008d50: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00008d60: 6d65 285b 4e6f 6e65 2c20 4e6f 6e65 2c20  me([None, None, 
-00008d70: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b22  None], schema=["
-00008d80: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00008d90: 2064 662e 7365 6c65 6374 2876 6172 5f73   df.select(var_s
-00008da0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
-00008db0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00008dc0: 205b 526f 7728 5641 5249 414e 4345 2822   [Row(VARIANCE("
-00008dd0: 4122 293d 4e6f 6e65 295d 0a0a 2020 2020  A")=None)]..    
-00008de0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00008df0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00008e00: 6672 616d 6528 5b34 325d 2c20 7363 6865  frame([42], sche
-00008e10: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00008e20: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00008e30: 7661 725f 7361 6d70 2863 6f6c 2822 6122  var_samp(col("a"
-00008e40: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
-00008e50: 2020 2020 2020 5b52 6f77 2856 4152 4941        [Row(VARIA
-00008e60: 4e43 4528 2241 2229 3d4e 6f6e 6529 5d0a  NCE("A")=None)].
-00008e70: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00008e80: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00008e90: 652c 2022 7661 725f 7361 6d70 2229 0a20  e, "var_samp"). 
-00008ea0: 2020 2072 6574 7572 6e20 7661 7269 616e     return varian
-00008eb0: 6365 2863 290a 0a0a 6465 6620 7661 725f  ce(c)...def var_
-00008ec0: 706f 7028 653a 2043 6f6c 756d 6e4f 724e  pop(e: ColumnOrN
-00008ed0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00008ee0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00008ef0: 6865 2070 6f70 756c 6174 696f 6e20 7661  he population va
-00008f00: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
-00008f10: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
-00008f20: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
-00008f30: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
-00008f40: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
-00008f50: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
-00008f60: 7572 6e65 642e 2054 6865 2070 6f70 756c  urned. The popul
-00008f70: 6174 696f 6e20 7661 7269 616e 6365 206f  ation variance o
-00008f80: 6620 6120 7369 6e67 6c65 2072 6f77 2069  f a single row i
-00008f90: 7320 302e 302e 0a0a 2020 2020 4578 616d  s 0.0...    Exam
-00008fa0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00008fb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00008fc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00008fd0: 285b 312c 202d 312c 2031 2c20 2d31 2c20  ([1, -1, 1, -1, 
-00008fe0: 2d31 5d2c 2073 6368 656d 613d 5b22 6122  -1], schema=["a"
-00008ff0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00009000: 662e 7365 6c65 6374 2876 6172 5f70 6f70  f.select(var_pop
-00009010: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-00009020: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00009030: 6f77 2856 4152 5f50 4f50 2822 4122 293d  ow(VAR_POP("A")=
-00009040: 4465 6369 6d61 6c28 2730 2e39 3630 3030  Decimal('0.96000
-00009050: 3027 2929 5d0a 0a20 2020 2020 2020 203e  0'))]..        >
-00009060: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00009070: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00009080: 285b 312c 204e 6f6e 652c 2032 2c20 332c  ([1, None, 2, 3,
-00009090: 204e 6f6e 652c 2035 2c20 365d 2c20 7363   None, 5, 6], sc
-000090a0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-000090b0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000090c0: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
-000090d0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-000090e0: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
-000090f0: 504f 5028 2241 2229 3d44 6563 696d 616c  POP("A")=Decimal
-00009100: 2827 332e 3434 3030 3030 2729 295d 0a0a  ('3.440000'))]..
-00009110: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00009120: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00009130: 6461 7461 6672 616d 6528 5b4e 6f6e 652c  dataframe([None,
-00009140: 204e 6f6e 652c 204e 6f6e 655d 2c20 7363   None, None], sc
-00009150: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00009160: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00009170: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
-00009180: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00009190: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
-000091a0: 504f 5028 2241 2229 3d4e 6f6e 6529 5d0a  POP("A")=None)].
-000091b0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000091c0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000091d0: 5f64 6174 6166 7261 6d65 285b 3432 5d2c  _dataframe([42],
-000091e0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-000091f0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00009200: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
-00009210: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00009220: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-00009230: 4152 5f50 4f50 2822 4122 293d 4465 6369  AR_POP("A")=Deci
-00009240: 6d61 6c28 2730 2e30 3030 3030 3027 2929  mal('0.000000'))
-00009250: 5d0a 0a20 2020 2022 2222 0a20 2020 2063  ]..    """.    c
-00009260: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00009270: 7228 652c 2022 7661 725f 706f 7022 290a  r(e, "var_pop").
-00009280: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00009290: 696e 2822 7661 725f 706f 7022 2928 6329  in("var_pop")(c)
-000092a0: 0a0a 0a64 6566 2061 7070 726f 785f 7065  ...def approx_pe
-000092b0: 7263 656e 7469 6c65 2863 6f6c 3a20 436f  rcentile(col: Co
-000092c0: 6c75 6d6e 4f72 4e61 6d65 2c20 7065 7263  lumnOrName, perc
-000092d0: 656e 7469 6c65 3a20 666c 6f61 7429 202d  entile: float) -
-000092e0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000092f0: 2252 6574 7572 6e73 2061 6e20 6170 7072  "Returns an appr
-00009300: 6f78 696d 6174 6564 2076 616c 7565 2066  oximated value f
-00009310: 6f72 2074 6865 2064 6573 6972 6564 2070  or the desired p
-00009320: 6572 6365 6e74 696c 652e 2054 6869 7320  ercentile. This 
-00009330: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
-00009340: 6520 742d 4469 6765 7374 2061 6c67 6f72  e t-Digest algor
-00009350: 6974 686d 2e0a 0a20 2020 2045 7861 6d70  ithm...    Examp
-00009360: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00009370: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00009380: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00009390: 302c 312c 322c 332c 342c 352c 362c 372c  0,1,2,3,4,5,6,7,
-000093a0: 382c 395d 2c20 7363 6865 6d61 3d5b 2261  8,9], schema=["a
-000093b0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000093c0: 6466 2e73 656c 6563 7428 6170 7072 6f78  df.select(approx
-000093d0: 5f70 6572 6365 6e74 696c 6528 2261 222c  _percentile("a",
-000093e0: 2030 2e35 292e 616c 6961 7328 2272 6573   0.5).alias("res
-000093f0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-00009400: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00009410: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-00009420: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-00009430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00009440: 2020 2020 207c 342e 3520 2020 2020 2020       |4.5       
-00009450: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00009460: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00009470: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00009480: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00009490: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-000094a0: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
-000094b0: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
-000094c0: 7569 6c74 696e 2822 6170 7072 6f78 5f70  uiltin("approx_p
-000094d0: 6572 6365 6e74 696c 6522 2928 632c 206c  ercentile")(c, l
-000094e0: 6974 2870 6572 6365 6e74 696c 6529 290a  it(percentile)).
-000094f0: 0a0a 6465 6620 6170 7072 6f78 5f70 6572  ..def approx_per
-00009500: 6365 6e74 696c 655f 6163 6375 6d75 6c61  centile_accumula
-00009510: 7465 2863 6f6c 3a20 436f 6c75 6d6e 4f72  te(col: ColumnOr
-00009520: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00009530: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00009540: 7468 6520 696e 7465 726e 616c 2072 6570  the internal rep
-00009550: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
-00009560: 6865 2074 2d44 6967 6573 7420 7374 6174  he t-Digest stat
-00009570: 6520 2861 7320 6120 4a53 4f4e 206f 626a  e (as a JSON obj
-00009580: 6563 7429 2061 7420 7468 6520 656e 6420  ect) at the end 
-00009590: 6f66 2061 6767 7265 6761 7469 6f6e 2e0a  of aggregation..
-000095a0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-000095b0: 6e20 7573 6573 2074 6865 2074 2d44 6967  n uses the t-Dig
-000095c0: 6573 7420 616c 676f 7269 7468 6d2e 0a0a  est algorithm...
-000095d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-000095e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000095f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00009600: 7461 6672 616d 6528 5b31 2c32 2c33 2c34  taframe([1,2,3,4
-00009610: 2c35 5d2c 2073 6368 656d 613d 5b22 6122  ,5], schema=["a"
-00009620: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00009630: 662e 7365 6c65 6374 2861 7070 726f 785f  f.select(approx_
-00009640: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
-00009650: 756c 6174 6528 2261 2229 2e61 6c69 6173  ulate("a").alias
-00009660: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-00009670: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00009680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009690: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000096a0: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
-000096b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000096c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000096d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000096e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000096f0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
-00009700: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-00009710: 2020 2020 2020 207c 2020 2273 7461 7465         |  "state
-00009720: 223a 205b 2020 2020 2020 2020 2020 2020  ": [            
-00009730: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00009740: 2020 2031 2e30 3030 3030 3030 3030 3030     1.00000000000
-00009750: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
-00009760: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
-00009770: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
-00009780: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
-00009790: 2032 2e30 3030 3030 3030 3030 3030 3030   2.0000000000000
-000097a0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
-000097b0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
-000097c0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
-000097d0: 7c0a 2020 2020 2020 2020 7c20 2020 2033  |.        |    3
-000097e0: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
-000097f0: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
-00009800: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
-00009810: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
-00009820: 2020 2020 2020 2020 7c20 2020 2034 2e30          |    4.0
-00009830: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
-00009840: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
-00009850: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
-00009860: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
-00009870: 2020 2020 2020 7c20 2020 2035 2e30 3030        |    5.000
-00009880: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
-00009890: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
-000098a0: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
-000098b0: 3030 3065 2b30 3020 2020 7c0a 2020 2020  000e+00   |.    
-000098c0: 2020 2020 7c20 205d 2c20 2020 2020 2020      |  ],       
-000098d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098e0: 207c 0a20 2020 2020 2020 207c 2020 2274   |.        |  "t
-000098f0: 7970 6522 3a20 2274 6469 6765 7374 222c  ype": "tdigest",
-00009900: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00009910: 2020 7c20 2022 7665 7273 696f 6e22 3a20    |  "version": 
-00009920: 3120 2020 2020 2020 2020 2020 2020 207c  1              |
-00009930: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
-00009940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009950: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00009960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00009980: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-00009990: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-000099a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000099b0: 7228 636f 6c2c 2022 6170 7072 6f78 5f70  r(col, "approx_p
-000099c0: 6572 6365 6e74 696c 655f 6163 6375 6d75  ercentile_accumu
-000099d0: 6c61 7465 2229 0a20 2020 2072 6574 7572  late").    retur
-000099e0: 6e20 6275 696c 7469 6e28 2261 7070 726f  n builtin("appro
-000099f0: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
-00009a00: 756d 756c 6174 6522 2928 6329 0a0a 0a64  umulate")(c)...d
-00009a10: 6566 2061 7070 726f 785f 7065 7263 656e  ef approx_percen
-00009a20: 7469 6c65 5f65 7374 696d 6174 6528 7374  tile_estimate(st
-00009a30: 6174 653a 2043 6f6c 756d 6e4f 724e 616d  ate: ColumnOrNam
-00009a40: 652c 2070 6572 6365 6e74 696c 653a 2066  e, percentile: f
-00009a50: 6c6f 6174 2920 2d3e 2043 6f6c 756d 6e3a  loat) -> Column:
-00009a60: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00009a70: 7468 6520 6465 7369 7265 6420 6170 7072  the desired appr
-00009a80: 6f78 696d 6174 6564 2070 6572 6365 6e74  oximated percent
-00009a90: 696c 6520 7661 6c75 6520 666f 7220 7468  ile value for th
-00009aa0: 6520 7370 6563 6966 6965 6420 742d 4469  e specified t-Di
-00009ab0: 6765 7374 2073 7461 7465 2e0a 2020 2020  gest state..    
-00009ac0: 4150 5052 4f58 5f50 4552 4345 4e54 494c  APPROX_PERCENTIL
-00009ad0: 455f 4553 5449 4d41 5445 2841 5050 524f  E_ESTIMATE(APPRO
-00009ae0: 585f 5045 5243 454e 5449 4c45 5f41 4343  X_PERCENTILE_ACC
-00009af0: 554d 554c 4154 4528 2e29 2920 6973 2065  UMULATE(.)) is e
-00009b00: 7175 6976 616c 656e 7420 746f 0a20 2020  quivalent to.   
-00009b10: 2041 5050 524f 585f 5045 5243 454e 5449   APPROX_PERCENTI
-00009b20: 4c45 282e 292e 0a0a 2020 2020 4578 616d  LE(.)...    Exam
-00009b30: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00009b40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00009b50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00009b60: 5b31 2c32 2c33 2c34 2c35 5d2c 2073 6368  [1,2,3,4,5], sch
-00009b70: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00009b80: 2020 203e 3e3e 2064 665f 6163 6375 203d     >>> df_accu =
-00009b90: 2064 662e 7365 6c65 6374 2861 7070 726f   df.select(appro
-00009ba0: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
-00009bb0: 756d 756c 6174 6528 2261 2229 2e61 6c69  umulate("a").ali
-00009bc0: 6173 2822 6170 705f 7065 7263 656e 7469  as("app_percenti
-00009bd0: 6c65 5f61 6363 7522 2929 0a20 2020 2020  le_accu")).     
-00009be0: 2020 203e 3e3e 2064 665f 6163 6375 2e73     >>> df_accu.s
-00009bf0: 656c 6563 7428 6170 7072 6f78 5f70 6572  elect(approx_per
-00009c00: 6365 6e74 696c 655f 6573 7469 6d61 7465  centile_estimate
-00009c10: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
-00009c20: 5f61 6363 7522 2c20 302e 3529 2e61 6c69  _accu", 0.5).ali
-00009c30: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-00009c40: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00009c50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00009c60: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-00009c70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00009c80: 2d2d 2d0a 2020 2020 2020 2020 7c33 2e30  ---.        |3.0
-00009c90: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00009ca0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00009cb0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00009cc0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
-00009cd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00009ce0: 2873 7461 7465 2c20 2261 7070 726f 785f  (state, "approx_
-00009cf0: 7065 7263 656e 7469 6c65 5f65 7374 696d  percentile_estim
-00009d00: 6174 6522 290a 2020 2020 7265 7475 726e  ate").    return
-00009d10: 2062 7569 6c74 696e 2822 6170 7072 6f78   builtin("approx
-00009d20: 5f70 6572 6365 6e74 696c 655f 6573 7469  _percentile_esti
-00009d30: 6d61 7465 2229 2863 2c20 6c69 7428 7065  mate")(c, lit(pe
-00009d40: 7263 656e 7469 6c65 2929 0a0a 0a64 6566  rcentile))...def
-00009d50: 2061 7070 726f 785f 7065 7263 656e 7469   approx_percenti
-00009d60: 6c65 5f63 6f6d 6269 6e65 2873 7461 7465  le_combine(state
-00009d70: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00009d80: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00009d90: 2222 436f 6d62 696e 6573 2028 6d65 7267  ""Combines (merg
-00009da0: 6573 2920 7065 7263 656e 7469 6c65 2069  es) percentile i
-00009db0: 6e70 7574 2073 7461 7465 7320 696e 746f  nput states into
-00009dc0: 2061 2073 696e 676c 6520 6f75 7470 7574   a single output
-00009dd0: 2073 7461 7465 2e0a 2020 2020 5468 6973   state..    This
-00009de0: 2061 6c6c 6f77 7320 7363 656e 6172 696f   allows scenario
-00009df0: 7320 7768 6572 6520 4150 5052 4f58 5f50  s where APPROX_P
-00009e00: 4552 4345 4e54 494c 455f 4143 4355 4d55  ERCENTILE_ACCUMU
-00009e10: 4c41 5445 2069 7320 7275 6e20 6f76 6572  LATE is run over
-00009e20: 2068 6f72 697a 6f6e 7461 6c20 7061 7274   horizontal part
-00009e30: 6974 696f 6e73 0a20 2020 206f 6620 7468  itions.    of th
-00009e40: 6520 7361 6d65 2074 6162 6c65 2c20 7072  e same table, pr
-00009e50: 6f64 7563 696e 6720 616e 2061 6c67 6f72  oducing an algor
-00009e60: 6974 686d 2073 7461 7465 2066 6f72 2065  ithm state for e
-00009e70: 6163 6820 7461 626c 6520 7061 7274 6974  ach table partit
-00009e80: 696f 6e2e 2054 6865 7365 2073 7461 7465  ion. These state
-00009e90: 7320 6361 6e0a 2020 2020 6c61 7465 7220  s can.    later 
-00009ea0: 6265 2063 6f6d 6269 6e65 6420 7573 696e  be combined usin
-00009eb0: 6720 4150 5052 4f58 5f50 4552 4345 4e54  g APPROX_PERCENT
-00009ec0: 494c 455f 434f 4d42 494e 452c 2070 726f  ILE_COMBINE, pro
-00009ed0: 6475 6369 6e67 2074 6865 2073 616d 6520  ducing the same 
-00009ee0: 6f75 7470 7574 2073 7461 7465 2061 7320  output state as 
-00009ef0: 610a 2020 2020 7369 6e67 6c65 2072 756e  a.    single run
-00009f00: 206f 6620 4150 5052 4f58 5f50 4552 4345   of APPROX_PERCE
-00009f10: 4e54 494c 455f 4143 4355 4d55 4c41 5445  NTILE_ACCUMULATE
-00009f20: 206f 7665 7220 7468 6520 656e 7469 7265   over the entire
-00009f30: 2074 6162 6c65 2e0a 0a20 2020 2045 7861   table...    Exa
-00009f40: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00009f50: 3e3e 2064 6631 203d 2073 6573 7369 6f6e  >> df1 = session
-00009f60: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00009f70: 6528 5b31 2c32 2c33 2c34 2c35 5d2c 2073  e([1,2,3,4,5], s
-00009f80: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00009f90: 2020 2020 203e 3e3e 2064 6632 203d 2073       >>> df2 = s
-00009fa0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00009fb0: 7461 6672 616d 6528 5b36 2c37 2c38 2c39  taframe([6,7,8,9
-00009fc0: 2c31 305d 2c20 7363 6865 6d61 3d5b 2262  ,10], schema=["b
-00009fd0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00009fe0: 6466 5f61 6363 7531 203d 2064 6631 2e73  df_accu1 = df1.s
-00009ff0: 656c 6563 7428 6170 7072 6f78 5f70 6572  elect(approx_per
-0000a000: 6365 6e74 696c 655f 6163 6375 6d75 6c61  centile_accumula
-0000a010: 7465 2822 6122 292e 616c 6961 7328 2261  te("a").alias("a
-0000a020: 7070 5f70 6572 6365 6e74 696c 655f 6163  pp_percentile_ac
-0000a030: 6375 2229 290a 2020 2020 2020 2020 3e3e  cu")).        >>
-0000a040: 3e20 6466 5f61 6363 7532 203d 2064 6632  > df_accu2 = df2
-0000a050: 2e73 656c 6563 7428 6170 7072 6f78 5f70  .select(approx_p
-0000a060: 6572 6365 6e74 696c 655f 6163 6375 6d75  ercentile_accumu
-0000a070: 6c61 7465 2822 6222 292e 616c 6961 7328  late("b").alias(
-0000a080: 2261 7070 5f70 6572 6365 6e74 696c 655f  "app_percentile_
-0000a090: 6163 6375 2229 290a 2020 2020 2020 2020  accu")).        
-0000a0a0: 3e3e 3e20 6466 5f61 6363 7531 2e75 6e69  >>> df_accu1.uni
-0000a0b0: 6f6e 2864 665f 6163 6375 3229 2e73 656c  on(df_accu2).sel
-0000a0c0: 6563 7428 6170 7072 6f78 5f70 6572 6365  ect(approx_perce
-0000a0d0: 6e74 696c 655f 636f 6d62 696e 6528 2261  ntile_combine("a
-0000a0e0: 7070 5f70 6572 6365 6e74 696c 655f 6163  pp_percentile_ac
-0000a0f0: 6375 2229 2e61 6c69 6173 2822 7265 7375  cu").alias("resu
-0000a100: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-0000a110: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000a120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a130: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0000a140: 5355 4c54 2220 2020 2020 2020 2020 2020  SULT"           
-0000a150: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0000a160: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00001ed0: 2c0a 2020 2020 7072 6976 6174 655f 7072  ,.    private_pr
+00001ee0: 6576 6965 772c 0a20 2020 2076 616c 6964  eview,.    valid
+00001ef0: 6174 655f 6f62 6a65 6374 5f6e 616d 652c  ate_object_name,
+00001f00: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001f10: 652e 736e 6f77 7061 726b 2e63 6f6c 756d  e.snowpark.colum
+00001f20: 6e20 696d 706f 7274 2028 0a20 2020 2043  n import (.    C
+00001f30: 6173 6545 7870 722c 0a20 2020 2043 6f6c  aseExpr,.    Col
+00001f40: 756d 6e2c 0a20 2020 205f 746f 5f63 6f6c  umn,.    _to_col
+00001f50: 5f69 665f 6c69 742c 0a20 2020 205f 746f  _if_lit,.    _to
+00001f60: 5f63 6f6c 5f69 665f 7371 6c5f 6578 7072  _col_if_sql_expr
+00001f70: 2c0a 2020 2020 5f74 6f5f 636f 6c5f 6966  ,.    _to_col_if
+00001f80: 5f73 7472 2c0a 2020 2020 5f74 6f5f 636f  _str,.    _to_co
+00001f90: 6c5f 6966 5f73 7472 5f6f 725f 696e 742c  l_if_str_or_int,
+00001fa0: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
+00001fb0: 652e 736e 6f77 7061 726b 2e73 746f 7265  e.snowpark.store
+00001fc0: 645f 7072 6f63 6564 7572 6520 696d 706f  d_procedure impo
+00001fd0: 7274 2053 746f 7265 6450 726f 6365 6475  rt StoredProcedu
+00001fe0: 7265 0a66 726f 6d20 736e 6f77 666c 616b  re.from snowflak
+00001ff0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00002000: 2069 6d70 6f72 7420 4461 7461 5479 7065   import DataType
+00002010: 2c20 466c 6f61 7454 7970 652c 2053 7472  , FloatType, Str
+00002020: 696e 6754 7970 652c 2053 7472 7563 7454  ingType, StructT
+00002030: 7970 650a 6672 6f6d 2073 6e6f 7766 6c61  ype.from snowfla
+00002040: 6b65 2e73 6e6f 7770 6172 6b2e 7564 6166  ke.snowpark.udaf
+00002050: 2069 6d70 6f72 7420 5573 6572 4465 6669   import UserDefi
+00002060: 6e65 6441 6767 7265 6761 7465 4675 6e63  nedAggregateFunc
+00002070: 7469 6f6e 0a66 726f 6d20 736e 6f77 666c  tion.from snowfl
+00002080: 616b 652e 736e 6f77 7061 726b 2e75 6466  ake.snowpark.udf
+00002090: 2069 6d70 6f72 7420 5573 6572 4465 6669   import UserDefi
+000020a0: 6e65 6446 756e 6374 696f 6e0a 6672 6f6d  nedFunction.from
+000020b0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+000020c0: 6172 6b2e 7564 7466 2069 6d70 6f72 7420  ark.udtf import 
+000020d0: 5573 6572 4465 6669 6e65 6454 6162 6c65  UserDefinedTable
+000020e0: 4675 6e63 7469 6f6e 0a0a 2320 5079 7468  Function..# Pyth
+000020f0: 6f6e 2033 2e38 206e 6565 6473 2074 6f20  on 3.8 needs to 
+00002100: 7573 6520 7479 7069 6e67 2e49 7465 7261  use typing.Itera
+00002110: 626c 6520 6265 6361 7573 6520 636f 6c6c  ble because coll
+00002120: 6563 7469 6f6e 732e 6162 632e 4974 6572  ections.abc.Iter
+00002130: 6162 6c65 2069 7320 6e6f 7420 7375 6273  able is not subs
+00002140: 6372 6970 7461 626c 650a 2320 5079 7468  criptable.# Pyth
+00002150: 6f6e 2033 2e39 2063 616e 2075 7365 2062  on 3.9 can use b
+00002160: 6f74 680a 2320 5079 7468 6f6e 2033 2e31  oth.# Python 3.1
+00002170: 3020 6e65 6564 7320 746f 2075 7365 2063  0 needs to use c
+00002180: 6f6c 6c65 6374 696f 6e73 2e61 6263 2e49  ollections.abc.I
+00002190: 7465 7261 626c 6520 6265 6361 7573 6520  terable because 
+000021a0: 7479 7069 6e67 2e49 7465 7261 626c 6520  typing.Iterable 
+000021b0: 6973 2072 656d 6f76 6564 0a69 6620 7379  is removed.if sy
+000021c0: 732e 7665 7273 696f 6e5f 696e 666f 203c  s.version_info <
+000021d0: 3d20 2833 2c20 3929 3a0a 2020 2020 6672  = (3, 9):.    fr
+000021e0: 6f6d 2074 7970 696e 6720 696d 706f 7274  om typing import
+000021f0: 2049 7465 7261 626c 650a 656c 7365 3a0a   Iterable.else:.
+00002200: 2020 2020 6672 6f6d 2063 6f6c 6c65 6374      from collect
+00002210: 696f 6e73 2e61 6263 2069 6d70 6f72 7420  ions.abc import 
+00002220: 4974 6572 6162 6c65 0a0a 0a40 6f76 6572  Iterable...@over
+00002230: 6c6f 6164 0a64 6566 2063 6f6c 2863 6f6c  load.def col(col
+00002240: 5f6e 616d 653a 2073 7472 2920 2d3e 2043  _name: str) -> C
+00002250: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00002260: 7475 726e 7320 7468 6520 3a63 6c61 7373  turns the :class
+00002270: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+00002280: 7770 6172 6b2e 436f 6c75 6d6e 6020 7769  wpark.Column` wi
+00002290: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
+000022a0: 206e 616d 652e 0a0a 2020 2020 4578 616d   name...    Exam
+000022b0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+000022c0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+000022d0: 716c 2822 7365 6c65 6374 2031 2061 7320  ql("select 1 as 
+000022e0: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
+000022f0: 6466 2e73 656c 6563 7428 636f 6c28 2261  df.select(col("a
+00002300: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00002310: 2020 2020 2020 5b52 6f77 2841 3d31 295d        [Row(A=1)]
+00002320: 0a20 2020 2022 2222 0a20 2020 202e 2e2e  .    """.    ...
+00002330: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00002340: 6f76 6572 0a0a 0a40 6f76 6572 6c6f 6164  over...@overload
+00002350: 0a64 6566 2063 6f6c 2864 665f 616c 6961  .def col(df_alia
+00002360: 733a 2073 7472 2c20 636f 6c5f 6e61 6d65  s: str, col_name
+00002370: 3a20 7374 7229 202d 3e20 436f 6c75 6d6e  : str) -> Column
+00002380: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+00002390: 2074 6865 203a 636c 6173 733a 607e 736e   the :class:`~sn
+000023a0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+000023b0: 2e43 6f6c 756d 6e60 2077 6974 6820 7468  .Column` with th
+000023c0: 6520 7370 6563 6966 6965 6420 6461 7461  e specified data
+000023d0: 6672 616d 6520 616c 6961 7320 616e 6420  frame alias and 
+000023e0: 636f 6c75 6d6e 206e 616d 652e 0a0a 2020  column name...  
+000023f0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00002400: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00002410: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+00002420: 2031 2061 7320 6122 290a 2020 2020 2020   1 as a").      
+00002430: 2020 3e3e 3e20 6466 2e61 6c69 6173 2822    >>> df.alias("
+00002440: 6466 2229 2e73 656c 6563 7428 636f 6c28  df").select(col(
+00002450: 2264 6622 2c20 2261 2229 292e 636f 6c6c  "df", "a")).coll
+00002460: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00002470: 6f77 2841 3d31 295d 0a20 2020 2022 2222  ow(A=1)].    """
+00002480: 0a20 2020 202e 2e2e 2020 2320 7072 6167  .    ...  # prag
+00002490: 6d61 3a20 6e6f 2063 6f76 6572 0a0a 0a64  ma: no cover...d
+000024a0: 6566 2063 6f6c 286e 616d 6531 3a20 7374  ef col(name1: st
+000024b0: 722c 206e 616d 6532 3a20 4f70 7469 6f6e  r, name2: Option
+000024c0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2920  al[str] = None) 
+000024d0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2069  -> Column:.    i
+000024e0: 6620 6e61 6d65 3220 6973 204e 6f6e 653a  f name2 is None:
+000024f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00002500: 436f 6c75 6d6e 286e 616d 6531 290a 2020  Column(name1).  
+00002510: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002520: 7265 7475 726e 2043 6f6c 756d 6e28 6e61  return Column(na
+00002530: 6d65 312c 206e 616d 6532 290a 0a0a 406f  me1, name2)...@o
+00002540: 7665 726c 6f61 640a 6465 6620 636f 6c75  verload.def colu
+00002550: 6d6e 2863 6f6c 5f6e 616d 653a 2073 7472  mn(col_name: str
+00002560: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00002570: 2022 2222 5265 7475 726e 7320 6120 3a63   """Returns a :c
+00002580: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
+00002590: 2e73 6e6f 7770 6172 6b2e 436f 6c75 6d6e  .snowpark.Column
+000025a0: 6020 7769 7468 2074 6865 2073 7065 6369  ` with the speci
+000025b0: 6669 6564 206e 616d 652e 2041 6c69 6173  fied name. Alias
+000025c0: 2066 6f72 2063 6f6c 2e0a 0a20 2020 2045   for col...    E
+000025d0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+000025e0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000025f0: 6e2e 7371 6c28 2273 656c 6563 7420 3120  n.sql("select 1 
+00002600: 6173 2061 2229 0a20 2020 2020 2020 203e  as a").        >
+00002610: 3e3e 2064 662e 7365 6c65 6374 2863 6f6c  >> df.select(col
+00002620: 756d 6e28 2261 2229 292e 636f 6c6c 6563  umn("a")).collec
+00002630: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00002640: 2841 3d31 295d 0a20 2020 2022 2222 0a20  (A=1)].    """. 
+00002650: 2020 202e 2e2e 2020 2320 7072 6167 6d61     ...  # pragma
+00002660: 3a20 6e6f 2063 6f76 6572 0a0a 0a40 6f76  : no cover...@ov
+00002670: 6572 6c6f 6164 0a64 6566 2063 6f6c 756d  erload.def colum
+00002680: 6e28 6466 5f61 6c69 6173 3a20 7374 722c  n(df_alias: str,
+00002690: 2063 6f6c 5f6e 616d 653a 2073 7472 2920   col_name: str) 
+000026a0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000026b0: 2222 5265 7475 726e 7320 6120 3a63 6c61  ""Returns a :cla
+000026c0: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
+000026d0: 6e6f 7770 6172 6b2e 436f 6c75 6d6e 6020  nowpark.Column` 
+000026e0: 7769 7468 2074 6865 2073 7065 6369 6669  with the specifi
+000026f0: 6564 206e 616d 6520 616e 6420 6461 7461  ed name and data
+00002700: 6672 616d 6520 616c 6961 7320 6e61 6d65  frame alias name
+00002710: 2e20 416c 6961 7320 666f 7220 636f 6c2e  . Alias for col.
+00002720: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00002730: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00002740: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
+00002750: 6c65 6374 2031 2061 7320 6122 290a 2020  lect 1 as a").  
+00002760: 2020 2020 2020 3e3e 3e20 6466 2e61 6c69        >>> df.ali
+00002770: 6173 2822 6466 2229 2e73 656c 6563 7428  as("df").select(
+00002780: 636f 6c75 6d6e 2822 6466 222c 2022 6122  column("df", "a"
+00002790: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000027a0: 2020 2020 205b 526f 7728 413d 3129 5d0a       [Row(A=1)].
+000027b0: 2020 2020 2222 220a 2020 2020 2e2e 2e20      """.    ... 
+000027c0: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
+000027d0: 7665 720a 0a0a 6465 6620 636f 6c75 6d6e  ver...def column
+000027e0: 286e 616d 6531 3a20 7374 722c 206e 616d  (name1: str, nam
+000027f0: 6532 3a20 4f70 7469 6f6e 616c 5b73 7472  e2: Optional[str
+00002800: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
+00002810: 756d 6e3a 0a20 2020 2069 6620 6e61 6d65  umn:.    if name
+00002820: 3220 6973 204e 6f6e 653a 0a20 2020 2020  2 is None:.     
+00002830: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
+00002840: 286e 616d 6531 290a 2020 2020 656c 7365  (name1).    else
+00002850: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00002860: 2043 6f6c 756d 6e28 6e61 6d65 312c 206e   Column(name1, n
+00002870: 616d 6532 290a 0a0a 6465 6620 6c69 7428  ame2)...def lit(
+00002880: 6c69 7465 7261 6c3a 204c 6974 6572 616c  literal: Literal
+00002890: 5479 7065 2920 2d3e 2043 6f6c 756d 6e3a  Type) -> Column:
+000028a0: 0a20 2020 2022 2222 0a20 2020 2043 7265  .    """.    Cre
+000028b0: 6174 6573 2061 203a 636c 6173 733a 607e  ates a :class:`~
+000028c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000028d0: 726b 2e43 6f6c 756d 6e60 2065 7870 7265  rk.Column` expre
+000028e0: 7373 696f 6e20 666f 7220 6120 6c69 7465  ssion for a lite
+000028f0: 7261 6c20 7661 6c75 652e 0a20 2020 2049  ral value..    I
+00002900: 7420 7375 7070 6f72 7473 2062 6173 6963  t supports basic
+00002910: 2050 7974 686f 6e20 6461 7461 2074 7970   Python data typ
+00002920: 6573 2c20 696e 636c 7564 696e 6720 6060  es, including ``
+00002930: 696e 7460 602c 2060 6066 6c6f 6174 6060  int``, ``float``
+00002940: 2c20 6060 7374 7260 602c 0a20 2020 2060  , ``str``,.    `
+00002950: 6062 6f6f 6c60 602c 2060 6062 7974 6573  `bool``, ``bytes
+00002960: 6060 2c20 6060 6279 7465 6172 7261 7960  ``, ``bytearray`
+00002970: 602c 2060 6064 6174 6574 696d 652e 7469  `, ``datetime.ti
+00002980: 6d65 6060 2c20 6060 6461 7465 7469 6d65  me``, ``datetime
+00002990: 2e64 6174 6560 602c 0a20 2020 2060 6064  .date``,.    ``d
+000029a0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000029b0: 6060 2061 6e64 2060 6064 6563 696d 616c  `` and ``decimal
+000029c0: 2e44 6563 696d 616c 6060 2e20 416c 736f  .Decimal``. Also
+000029d0: 2c20 6974 2073 7570 706f 7274 7320 5079  , it supports Py
+000029e0: 7468 6f6e 2073 7472 7563 7475 7265 6420  thon structured 
+000029f0: 6461 7461 2074 7970 6573 2c0a 2020 2020  data types,.    
+00002a00: 696e 636c 7564 696e 6720 6060 6c69 7374  including ``list
+00002a10: 6060 2c20 6060 7475 706c 6560 6020 616e  ``, ``tuple`` an
+00002a20: 6420 6060 6469 6374 6060 2c20 6275 7420  d ``dict``, but 
+00002a30: 7468 6973 2063 6f6e 7461 696e 6572 206d  this container m
+00002a40: 7573 740a 2020 2020 6265 204a 534f 4e20  ust.    be JSON 
+00002a50: 7365 7269 616c 697a 6162 6c65 2e0a 0a20  serializable... 
+00002a60: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00002a70: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00002a80: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
+00002a90: 2020 3e3e 3e20 636f 6c75 6d6e 7320 3d20    >>> columns = 
+00002aa0: 5b6c 6974 2831 292c 206c 6974 2822 3122  [lit(1), lit("1"
+00002ab0: 292c 206c 6974 2831 2e30 292c 206c 6974  ), lit(1.0), lit
+00002ac0: 2854 7275 6529 2c20 6c69 7428 6227 736e  (True), lit(b'sn
+00002ad0: 6f77 2729 2c20 6c69 7428 6461 7465 7469  ow'), lit(dateti
+00002ae0: 6d65 2e64 6174 6528 3230 3233 2c20 322c  me.date(2023, 2,
+00002af0: 2032 2929 2c20 6c69 7428 5b31 2c20 325d   2)), lit([1, 2]
+00002b00: 292c 206c 6974 287b 2273 6e6f 7722 3a20  ), lit({"snow": 
+00002b10: 2266 6c61 6b65 227d 295d 0a20 2020 2020  "flake"})].     
+00002b20: 2020 203e 3e3e 2073 6573 7369 6f6e 2e63     >>> session.c
+00002b30: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00002b40: 5b5b 5d5d 292e 7365 6c65 6374 285b 632e  [[]]).select([c.
+00002b50: 6173 5f28 7374 7228 6929 2920 666f 7220  as_(str(i)) for 
+00002b60: 692c 2063 2069 6e20 656e 756d 6572 6174  i, c in enumerat
+00002b70: 6528 636f 6c75 6d6e 7329 5d29 2e73 686f  e(columns)]).sho
+00002b80: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00002b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002bc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002bd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002be0: 2d2d 2d0a 2020 2020 2020 2020 7c22 3022  ---.        |"0"
+00002bf0: 2020 7c22 3122 2020 7c22 3222 2020 7c22    |"1"  |"2"  |"
+00002c00: 3322 2020 207c 2234 2220 2020 2020 2020  3"   |"4"       
+00002c10: 2020 2020 2020 2020 2020 7c22 3522 2020            |"5"  
+00002c20: 2020 2020 2020 207c 2236 2220 2020 7c22         |"6"   |"
+00002c30: 3722 2020 2020 2020 2020 2020 2020 2020  7"              
+00002c40: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00002c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002ca0: 2d2d 2d0a 2020 2020 2020 2020 7c31 2020  ---.        |1  
+00002cb0: 2020 7c31 2020 2020 7c31 2e30 2020 7c54    |1    |1.0  |T
+00002cc0: 7275 6520 207c 6279 7465 6172 7261 7928  rue  |bytearray(
+00002cd0: 6227 736e 6f77 2729 2020 7c32 3032 332d  b'snow')  |2023-
+00002ce0: 3032 2d30 3220 207c 5b20 2020 2020 7c7b  02-02  |[     |{
+00002cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d00: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+00002d10: 2020 7c20 2020 2020 7c20 2020 2020 7c20    |     |     | 
+00002d20: 2020 2020 207c 2020 2020 2020 2020 2020       |          
+00002d30: 2020 2020 2020 2020 2020 7c20 2020 2020            |     
+00002d40: 2020 2020 2020 207c 2020 312c 2020 7c20         |  1,  | 
+00002d50: 2022 736e 6f77 223a 2022 666c 616b 6522   "snow": "flake"
+00002d60: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+00002d70: 2020 7c20 2020 2020 7c20 2020 2020 7c20    |     |     | 
+00002d80: 2020 2020 207c 2020 2020 2020 2020 2020       |          
+00002d90: 2020 2020 2020 2020 2020 7c20 2020 2020            |     
+00002da0: 2020 2020 2020 207c 2020 3220 2020 7c7d         |  2   |}
+00002db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002dc0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+00002dd0: 2020 7c20 2020 2020 7c20 2020 2020 7c20    |     |     | 
+00002de0: 2020 2020 207c 2020 2020 2020 2020 2020       |          
+00002df0: 2020 2020 2020 2020 2020 7c20 2020 2020            |     
+00002e00: 2020 2020 2020 207c 5d20 2020 2020 7c20         |]     | 
+00002e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002e20: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00002e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e80: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00002e90: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00002ea0: 2020 2020 7265 7475 726e 206c 6974 6572      return liter
+00002eb0: 616c 2069 6620 6973 696e 7374 616e 6365  al if isinstance
+00002ec0: 286c 6974 6572 616c 2c20 436f 6c75 6d6e  (literal, Column
+00002ed0: 2920 656c 7365 2043 6f6c 756d 6e28 4c69  ) else Column(Li
+00002ee0: 7465 7261 6c28 6c69 7465 7261 6c29 290a  teral(literal)).
+00002ef0: 0a0a 6465 6620 7371 6c5f 6578 7072 2873  ..def sql_expr(s
+00002f00: 716c 3a20 7374 7229 202d 3e20 436f 6c75  ql: str) -> Colu
+00002f10: 6d6e 3a0a 2020 2020 2222 2243 7265 6174  mn:.    """Creat
+00002f20: 6573 2061 203a 636c 6173 733a 607e 736e  es a :class:`~sn
+00002f30: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00002f40: 2e43 6f6c 756d 6e60 2065 7870 7265 7373  .Column` express
+00002f50: 696f 6e20 6672 6f6d 2072 6177 2053 514c  ion from raw SQL
+00002f60: 2074 6578 742e 0a20 2020 204e 6f74 6520   text..    Note 
+00002f70: 7468 6174 2074 6865 2066 756e 6374 696f  that the functio
+00002f80: 6e20 646f 6573 206e 6f74 2069 6e74 6572  n does not inter
+00002f90: 7072 6574 206f 7220 6368 6563 6b20 7468  pret or check th
+00002fa0: 6520 5351 4c20 7465 7874 2e0a 0a20 2020  e SQL text...   
+00002fb0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00002fc0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00002fd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00002fe0: 7261 6d65 285b 5b31 2c20 325d 2c20 5b33  rame([[1, 2], [3
+00002ff0: 2c20 345d 5d2c 2073 6368 656d 613d 5b22  , 4]], schema=["
+00003000: 4122 2c20 2242 225d 290a 2020 2020 2020  A", "B"]).      
+00003010: 2020 3e3e 3e20 6466 2e66 696c 7465 7228    >>> df.filter(
+00003020: 2261 203e 2031 2229 2e63 6f6c 6c65 6374  "a > 1").collect
+00003030: 2829 2020 2320 7573 6520 5351 4c20 6578  ()  # use SQL ex
+00003040: 7072 6573 7369 6f6e 0a20 2020 2020 2020  pression.       
+00003050: 205b 526f 7728 413d 332c 2042 3d34 295d   [Row(A=3, B=4)]
+00003060: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
+00003070: 7572 6e20 436f 6c75 6d6e 2e5f 6578 7072  urn Column._expr
+00003080: 2873 716c 290a 0a0a 6465 6620 6375 7272  (sql)...def curr
+00003090: 656e 745f 7365 7373 696f 6e28 2920 2d3e  ent_session() ->
+000030a0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000030b0: 0a20 2020 2052 6574 7572 6e73 2061 2075  .    Returns a u
+000030c0: 6e69 7175 6520 7379 7374 656d 2069 6465  nique system ide
+000030d0: 6e74 6966 6965 7220 666f 7220 7468 6520  ntifier for the 
+000030e0: 536e 6f77 666c 616b 6520 7365 7373 696f  Snowflake sessio
+000030f0: 6e20 636f 7272 6573 706f 6e64 696e 6720  n corresponding 
+00003100: 746f 2074 6865 2070 7265 7365 6e74 2063  to the present c
+00003110: 6f6e 6e65 6374 696f 6e2e 0a20 2020 2054  onnection..    T
+00003120: 6869 7320 7769 6c6c 2067 656e 6572 616c  his will general
+00003130: 6c79 2062 6520 6120 7379 7374 656d 2d67  ly be a system-g
+00003140: 656e 6572 6174 6564 2061 6c70 6861 6e75  enerated alphanu
+00003150: 6d65 7269 6320 7374 7269 6e67 2e20 4974  meric string. It
+00003160: 2069 7320 4e4f 5420 6465 7269 7665 6420   is NOT derived 
+00003170: 6672 6f6d 2074 6865 2075 7365 7220 6e61  from the user na
+00003180: 6d65 206f 7220 7573 6572 2061 6363 6f75  me or user accou
+00003190: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
+000031a0: 3a0a 2020 2020 2020 2020 3e3e 3e20 2320  :.        >>> # 
+000031b0: 5265 7475 726e 2072 6573 756c 7420 6973  Return result is
+000031c0: 2074 6965 6420 746f 2073 6573 7369 6f6e   tied to session
+000031d0: 2c20 736f 2077 6520 6f6e 6c79 2074 6573  , so we only tes
+000031e0: 7420 6966 2074 6865 2072 6573 756c 7420  t if the result 
+000031f0: 6578 6973 7473 0a20 2020 2020 2020 203e  exists.        >
+00003200: 3e3e 2072 6573 756c 7420 3d20 7365 7373  >> result = sess
+00003210: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00003220: 7261 6d65 285b 315d 292e 7365 6c65 6374  rame([1]).select
+00003230: 2863 7572 7265 6e74 5f73 6573 7369 6f6e  (current_session
+00003240: 2829 292e 636f 6c6c 6563 7428 290a 2020  ()).collect().  
+00003250: 2020 2020 2020 3e3e 3e20 6173 7365 7274        >>> assert
+00003260: 2072 6573 756c 745b 305d 5b27 4355 5252   result[0]['CURR
+00003270: 454e 545f 5345 5353 494f 4e28 2927 5d20  ENT_SESSION()'] 
+00003280: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00003290: 2222 220a 2020 2020 7265 7475 726e 2062  """.    return b
+000032a0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
+000032b0: 7365 7373 696f 6e22 2928 290a 0a0a 6465  session")()...de
+000032c0: 6620 6375 7272 656e 745f 7374 6174 656d  f current_statem
+000032d0: 656e 7428 2920 2d3e 2043 6f6c 756d 6e3a  ent() -> Column:
+000032e0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+000032f0: 7572 6e73 2074 6865 2053 514c 2074 6578  urns the SQL tex
+00003300: 7420 6f66 2074 6865 2073 7461 7465 6d65  t of the stateme
+00003310: 6e74 2074 6861 7420 6973 2063 7572 7265  nt that is curre
+00003320: 6e74 6c79 2065 7865 6375 7469 6e67 2e0a  ntly executing..
+00003330: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+00003340: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
+00003350: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
+00003360: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
+00003370: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
+00003380: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
+00003390: 7473 0a20 2020 2020 2020 203e 3e3e 2073  ts.        >>> s
+000033a0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000033b0: 7461 6672 616d 6528 5b31 5d29 2e73 656c  taframe([1]).sel
+000033c0: 6563 7428 6375 7272 656e 745f 7374 6174  ect(current_stat
+000033d0: 656d 656e 7428 2929 2e63 6f6c 6c65 6374  ement()).collect
+000033e0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+000033f0: 4355 5252 454e 545f 5354 4154 454d 454e  CURRENT_STATEMEN
+00003400: 5428 293d 2753 454c 4543 5420 6375 7272  T()='SELECT curr
+00003410: 656e 745f 7374 6174 656d 656e 7428 2920  ent_statement() 
+00003420: 4652 4f4d 2028 2053 454c 4543 5420 225f  FROM ( SELECT "_
+00003430: 3122 2046 524f 4d20 2820 5345 4c45 4354  1" FROM ( SELECT
+00003440: 2024 3120 4153 2022 5f31 2220 4652 4f4d   $1 AS "_1" FROM
+00003450: 2020 5641 4c55 4553 2028 3120 3a3a 2049    VALUES (1 :: I
+00003460: 4e54 2929 2927 295d 0a20 2020 2022 2222  NT)))')].    """
+00003470: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00003480: 7469 6e28 2263 7572 7265 6e74 5f73 7461  tin("current_sta
+00003490: 7465 6d65 6e74 2229 2829 0a0a 0a64 6566  tement")()...def
+000034a0: 2063 7572 7265 6e74 5f75 7365 7228 2920   current_user() 
+000034b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000034c0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000034d0: 6865 206e 616d 6520 6f66 2074 6865 2075  he name of the u
+000034e0: 7365 7220 6375 7272 656e 746c 7920 6c6f  ser currently lo
+000034f0: 6767 6564 2069 6e74 6f20 7468 6520 7379  gged into the sy
+00003500: 7374 656d 2e0a 0a20 2020 2045 7861 6d70  stem...    Examp
+00003510: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00003520: 2320 5265 7475 726e 2072 6573 756c 7420  # Return result 
+00003530: 6973 2074 6965 6420 746f 2073 6573 7369  is tied to sessi
+00003540: 6f6e 2c20 736f 2077 6520 6f6e 6c79 2074  on, so we only t
+00003550: 6573 7420 6966 2074 6865 2072 6573 756c  est if the resul
+00003560: 7420 6578 6973 7473 0a20 2020 2020 2020  t exists.       
+00003570: 203e 3e3e 2072 6573 756c 7420 3d20 7365   >>> result = se
+00003580: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00003590: 6166 7261 6d65 285b 315d 292e 7365 6c65  aframe([1]).sele
+000035a0: 6374 2863 7572 7265 6e74 5f75 7365 7228  ct(current_user(
+000035b0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000035c0: 2020 2020 203e 3e3e 2061 7373 6572 7420       >>> assert 
+000035d0: 7265 7375 6c74 5b30 5d5b 2743 5552 5245  result[0]['CURRE
+000035e0: 4e54 5f55 5345 5228 2927 5d20 6973 206e  NT_USER()'] is n
+000035f0: 6f74 204e 6f6e 650a 2020 2020 2222 220a  ot None.    """.
+00003600: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00003610: 696e 2822 6375 7272 656e 745f 7573 6572  in("current_user
+00003620: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
+00003630: 6e74 5f76 6572 7369 6f6e 2829 202d 3e20  nt_version() -> 
+00003640: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00003650: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00003660: 6375 7272 656e 7420 536e 6f77 666c 616b  current Snowflak
+00003670: 6520 7665 7273 696f 6e2e 0a0a 2020 2020  e version...    
+00003680: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00003690: 203e 3e3e 2023 2052 6574 7572 6e20 7265   >>> # Return re
+000036a0: 7375 6c74 2069 7320 7469 6564 2074 6f20  sult is tied to 
+000036b0: 7365 7373 696f 6e2c 2073 6f20 7765 206f  session, so we o
+000036c0: 6e6c 7920 7465 7374 2069 6620 7468 6520  nly test if the 
+000036d0: 7265 7375 6c74 2065 7869 7374 730a 2020  result exists.  
+000036e0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
+000036f0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00003700: 655f 6461 7461 6672 616d 6528 5b31 5d29  e_dataframe([1])
+00003710: 2e73 656c 6563 7428 6375 7272 656e 745f  .select(current_
+00003720: 7665 7273 696f 6e28 2929 2e63 6f6c 6c65  version()).colle
+00003730: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
+00003740: 2061 7373 6572 7420 7265 7375 6c74 5b30   assert result[0
+00003750: 5d5b 2743 5552 5245 4e54 5f56 4552 5349  ]['CURRENT_VERSI
+00003760: 4f4e 2829 275d 2069 7320 6e6f 7420 4e6f  ON()'] is not No
+00003770: 6e65 0a20 2020 2022 2222 0a20 2020 2072  ne.    """.    r
+00003780: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+00003790: 7572 7265 6e74 5f76 6572 7369 6f6e 2229  urrent_version")
+000037a0: 2829 0a0a 0a64 6566 2063 7572 7265 6e74  ()...def current
+000037b0: 5f77 6172 6568 6f75 7365 2829 202d 3e20  _warehouse() -> 
+000037c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+000037d0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+000037e0: 6e61 6d65 206f 6620 7468 6520 7761 7265  name of the ware
+000037f0: 686f 7573 6520 696e 2075 7365 2066 6f72  house in use for
+00003800: 2074 6865 2063 7572 7265 6e74 2073 6573   the current ses
+00003810: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
+00003820: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00003830: 2320 5265 7475 726e 2072 6573 756c 7420  # Return result 
+00003840: 6973 2074 6965 6420 746f 2073 6573 7369  is tied to sessi
+00003850: 6f6e 2c20 736f 2077 6520 6f6e 6c79 2074  on, so we only t
+00003860: 6573 7420 6966 2074 6865 2072 6573 756c  est if the resul
+00003870: 7420 6578 6973 7473 0a20 2020 2020 2020  t exists.       
+00003880: 203e 3e3e 2072 6573 756c 7420 3d20 7365   >>> result = se
+00003890: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000038a0: 6166 7261 6d65 285b 315d 292e 7365 6c65  aframe([1]).sele
+000038b0: 6374 2863 7572 7265 6e74 5f77 6172 6568  ct(current_wareh
+000038c0: 6f75 7365 2829 292e 636f 6c6c 6563 7428  ouse()).collect(
+000038d0: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
+000038e0: 7365 7274 2072 6573 756c 745b 305d 5b27  sert result[0]['
+000038f0: 4355 5252 454e 545f 5741 5245 484f 5553  CURRENT_WAREHOUS
+00003900: 4528 2927 5d20 6973 206e 6f74 204e 6f6e  E()'] is not Non
+00003910: 650a 2020 2020 2222 220a 2020 2020 7265  e.    """.    re
+00003920: 7475 726e 2062 7569 6c74 696e 2822 6375  turn builtin("cu
+00003930: 7272 656e 745f 7761 7265 686f 7573 6522  rrent_warehouse"
+00003940: 2928 290a 0a0a 6465 6620 6375 7272 656e  )()...def curren
+00003950: 745f 6461 7461 6261 7365 2829 202d 3e20  t_database() -> 
+00003960: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00003970: 6574 7572 6e73 2074 6865 206e 616d 6520  eturns the name 
+00003980: 6f66 2074 6865 2064 6174 6162 6173 6520  of the database 
+00003990: 696e 2075 7365 2066 6f72 2074 6865 2063  in use for the c
+000039a0: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
+000039b0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+000039c0: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
+000039d0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
+000039e0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
+000039f0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
+00003a00: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
+00003a10: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
+00003a20: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
+00003a30: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00003a40: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
+00003a50: 7265 6e74 5f64 6174 6162 6173 6528 2929  rent_database())
+00003a60: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00003a70: 2020 203e 3e3e 2061 7373 6572 7420 7265     >>> assert re
+00003a80: 7375 6c74 5b30 5d5b 2743 5552 5245 4e54  sult[0]['CURRENT
+00003a90: 5f44 4154 4142 4153 4528 2927 5d20 6973  _DATABASE()'] is
+00003aa0: 206e 6f74 204e 6f6e 650a 2020 2020 2222   not None.    ""
+00003ab0: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
+00003ac0: 6c74 696e 2822 6375 7272 656e 745f 6461  ltin("current_da
+00003ad0: 7461 6261 7365 2229 2829 0a0a 0a64 6566  tabase")()...def
+00003ae0: 2063 7572 7265 6e74 5f72 6f6c 6528 2920   current_role() 
+00003af0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00003b00: 2222 5265 7475 726e 7320 7468 6520 6e61  ""Returns the na
+00003b10: 6d65 206f 6620 7468 6520 726f 6c65 2069  me of the role i
+00003b20: 6e20 7573 6520 666f 7220 7468 6520 6375  n use for the cu
+00003b30: 7272 656e 7420 7365 7373 696f 6e2e 0a0a  rrent session...
+00003b40: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+00003b50: 2020 2020 203e 3e3e 2023 2052 6574 7572       >>> # Retur
+00003b60: 6e20 7265 7375 6c74 2069 7320 7469 6564  n result is tied
+00003b70: 2074 6f20 7365 7373 696f 6e2c 2073 6f20   to session, so 
+00003b80: 7765 206f 6e6c 7920 7465 7374 2069 6620  we only test if 
+00003b90: 7468 6520 7265 7375 6c74 2065 7869 7374  the result exist
+00003ba0: 730a 2020 2020 2020 2020 3e3e 3e20 7265  s.        >>> re
+00003bb0: 7375 6c74 203d 2073 6573 7369 6f6e 2e63  sult = session.c
+00003bc0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00003bd0: 5b31 5d29 2e73 656c 6563 7428 6375 7272  [1]).select(curr
+00003be0: 656e 745f 726f 6c65 2829 292e 636f 6c6c  ent_role()).coll
+00003bf0: 6563 7428 290a 2020 2020 2020 2020 3e3e  ect().        >>
+00003c00: 3e20 6173 7365 7274 2072 6573 756c 745b  > assert result[
+00003c10: 305d 5b27 4355 5252 454e 545f 524f 4c45  0]['CURRENT_ROLE
+00003c20: 2829 275d 2069 7320 6e6f 7420 4e6f 6e65  ()'] is not None
+00003c30: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
+00003c40: 7572 6e20 6275 696c 7469 6e28 2263 7572  urn builtin("cur
+00003c50: 7265 6e74 5f72 6f6c 6522 2928 290a 0a0a  rent_role")()...
+00003c60: 6465 6620 6375 7272 656e 745f 7363 6865  def current_sche
+00003c70: 6d61 2829 202d 3e20 436f 6c75 6d6e 3a0a  ma() -> Column:.
+00003c80: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00003c90: 6865 206e 616d 6520 6f66 2074 6865 2073  he name of the s
+00003ca0: 6368 656d 6120 696e 2075 7365 2066 6f72  chema in use for
+00003cb0: 2074 6865 2063 7572 7265 6e74 2073 6573   the current ses
+00003cc0: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
+00003cd0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00003ce0: 2320 5265 7475 726e 2072 6573 756c 7420  # Return result 
+00003cf0: 6973 2074 6965 6420 746f 2073 6573 7369  is tied to sessi
+00003d00: 6f6e 2c20 736f 2077 6520 6f6e 6c79 2074  on, so we only t
+00003d10: 6573 7420 6966 2074 6865 2072 6573 756c  est if the resul
+00003d20: 7420 6578 6973 7473 0a20 2020 2020 2020  t exists.       
+00003d30: 203e 3e3e 2072 6573 756c 7420 3d20 7365   >>> result = se
+00003d40: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00003d50: 6166 7261 6d65 285b 315d 292e 7365 6c65  aframe([1]).sele
+00003d60: 6374 2863 7572 7265 6e74 5f73 6368 656d  ct(current_schem
+00003d70: 6128 2929 2e63 6f6c 6c65 6374 2829 0a20  a()).collect(). 
+00003d80: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+00003d90: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
+00003da0: 5245 4e54 5f53 4348 454d 4128 2927 5d20  RENT_SCHEMA()'] 
+00003db0: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00003dc0: 2222 220a 2020 2020 7265 7475 726e 2062  """.    return b
+00003dd0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
+00003de0: 7363 6865 6d61 2229 2829 0a0a 0a64 6566  schema")()...def
+00003df0: 2063 7572 7265 6e74 5f73 6368 656d 6173   current_schemas
+00003e00: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00003e10: 2020 2222 2252 6574 7572 6e73 2061 6374    """Returns act
+00003e20: 6976 6520 7365 6172 6368 2070 6174 6820  ive search path 
+00003e30: 7363 6865 6d61 732e 0a0a 2020 2020 4578  schemas...    Ex
+00003e40: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00003e50: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
+00003e60: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
+00003e70: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
+00003e80: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
+00003e90: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
+00003ea0: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
+00003eb0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00003ec0: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
+00003ed0: 656c 6563 7428 6375 7272 656e 745f 7363  elect(current_sc
+00003ee0: 6865 6d61 7328 2929 2e63 6f6c 6c65 6374  hemas()).collect
+00003ef0: 2829 0a20 2020 2020 2020 203e 3e3e 2061  ().        >>> a
+00003f00: 7373 6572 7420 7265 7375 6c74 5b30 5d5b  ssert result[0][
+00003f10: 2743 5552 5245 4e54 5f53 4348 454d 4153  'CURRENT_SCHEMAS
+00003f20: 2829 275d 2069 7320 6e6f 7420 4e6f 6e65  ()'] is not None
+00003f30: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
+00003f40: 7572 6e20 6275 696c 7469 6e28 2263 7572  urn builtin("cur
+00003f50: 7265 6e74 5f73 6368 656d 6173 2229 2829  rent_schemas")()
+00003f60: 0a0a 0a64 6566 2063 7572 7265 6e74 5f72  ...def current_r
+00003f70: 6567 696f 6e28 2920 2d3e 2043 6f6c 756d  egion() -> Colum
+00003f80: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00003f90: 7320 7468 6520 6e61 6d65 206f 6620 7468  s the name of th
+00003fa0: 6520 7265 6769 6f6e 2066 6f72 2074 6865  e region for the
+00003fb0: 2061 6363 6f75 6e74 2077 6865 7265 2074   account where t
+00003fc0: 6865 2063 7572 7265 6e74 2075 7365 7220  he current user 
+00003fd0: 6973 206c 6f67 6765 6420 696e 2e0a 0a20  is logged in... 
+00003fe0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+00003ff0: 2020 2020 3e3e 3e20 2320 5265 7475 726e      >>> # Return
+00004000: 2072 6573 756c 7420 6973 2074 6965 6420   result is tied 
+00004010: 746f 2073 6573 7369 6f6e 2c20 736f 2077  to session, so w
+00004020: 6520 6f6e 6c79 2074 6573 7420 6966 2074  e only test if t
+00004030: 6865 2072 6573 756c 7420 6578 6973 7473  he result exists
+00004040: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00004050: 756c 7420 3d20 7365 7373 696f 6e2e 6372  ult = session.cr
+00004060: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00004070: 315d 292e 7365 6c65 6374 2863 7572 7265  1]).select(curre
+00004080: 6e74 5f72 6567 696f 6e28 2929 2e63 6f6c  nt_region()).col
+00004090: 6c65 6374 2829 0a20 2020 2020 2020 203e  lect().        >
+000040a0: 3e3e 2061 7373 6572 7420 7265 7375 6c74  >> assert result
+000040b0: 5b30 5d5b 2743 5552 5245 4e54 5f52 4547  [0]['CURRENT_REG
+000040c0: 494f 4e28 2927 5d20 6973 206e 6f74 204e  ION()'] is not N
+000040d0: 6f6e 650a 2020 2020 2222 220a 2020 2020  one.    """.    
+000040e0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+000040f0: 6375 7272 656e 745f 7265 6769 6f6e 2229  current_region")
+00004100: 2829 0a0a 0a64 6566 2063 7572 7265 6e74  ()...def current
+00004110: 5f61 7661 696c 6162 6c65 5f72 6f6c 6573  _available_roles
+00004120: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00004130: 2020 2222 2252 6574 7572 6e73 2061 204a    """Returns a J
+00004140: 534f 4e20 7374 7269 6e67 2074 6861 7420  SON string that 
+00004150: 6c69 7374 7320 616c 6c20 726f 6c65 7320  lists all roles 
+00004160: 6772 616e 7465 6420 746f 2074 6865 2063  granted to the c
+00004170: 7572 7265 6e74 2075 7365 722e 0a0a 2020  urrent user...  
+00004180: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+00004190: 2020 203e 3e3e 2023 2052 6574 7572 6e20     >>> # Return 
+000041a0: 7265 7375 6c74 2069 7320 7469 6564 2074  result is tied t
+000041b0: 6f20 7365 7373 696f 6e2c 2073 6f20 7765  o session, so we
+000041c0: 206f 6e6c 7920 7465 7374 2069 6620 7468   only test if th
+000041d0: 6520 7265 7375 6c74 2065 7869 7374 730a  e result exists.
+000041e0: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
+000041f0: 6c74 203d 2073 6573 7369 6f6e 2e63 7265  lt = session.cre
+00004200: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+00004210: 5d29 2e73 656c 6563 7428 6375 7272 656e  ]).select(curren
+00004220: 745f 6176 6169 6c61 626c 655f 726f 6c65  t_available_role
+00004230: 7328 2929 2e63 6f6c 6c65 6374 2829 0a20  s()).collect(). 
+00004240: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+00004250: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
+00004260: 5245 4e54 5f41 5641 494c 4142 4c45 5f52  RENT_AVAILABLE_R
+00004270: 4f4c 4553 2829 275d 2069 7320 6e6f 7420  OLES()'] is not 
+00004280: 4e6f 6e65 0a20 2020 2022 2222 0a20 2020  None.    """.   
+00004290: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000042a0: 2263 7572 7265 6e74 5f61 7661 696c 6162  "current_availab
+000042b0: 6c65 5f72 6f6c 6573 2229 2829 0a0a 0a64  le_roles")()...d
+000042c0: 6566 2061 6464 5f6d 6f6e 7468 7328 0a20  ef add_months(. 
+000042d0: 2020 2064 6174 655f 6f72 5f74 696d 6573     date_or_times
+000042e0: 7461 6d70 3a20 436f 6c75 6d6e 4f72 4e61  tamp: ColumnOrNa
+000042f0: 6d65 2c20 6e75 6d62 6572 5f6f 665f 6d6f  me, number_of_mo
+00004300: 6e74 6873 3a20 556e 696f 6e5b 436f 6c75  nths: Union[Colu
+00004310: 6d6e 2c20 696e 745d 0a29 202d 3e20 436f  mn, int].) -> Co
+00004320: 6c75 6d6e 3a0a 2020 2020 2222 2241 6464  lumn:.    """Add
+00004330: 7320 6f72 2073 7562 7472 6163 7473 2061  s or subtracts a
+00004340: 2073 7065 6369 6669 6564 206e 756d 6265   specified numbe
+00004350: 7220 6f66 206d 6f6e 7468 7320 746f 2061  r of months to a
+00004360: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
+00004370: 6d70 2c20 7072 6573 6572 7669 6e67 2074  mp, preserving t
+00004380: 6865 2065 6e64 2d6f 662d 6d6f 6e74 6820  he end-of-month 
+00004390: 696e 666f 726d 6174 696f 6e2e 0a0a 2020  information...  
+000043a0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+000043b0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+000043c0: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+000043d0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000043e0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000043f0: 285b 6461 7465 7469 6d65 2e64 6174 6528  ([datetime.date(
+00004400: 3230 3232 2c20 342c 2036 295d 2c20 7363  2022, 4, 6)], sc
+00004410: 6865 6d61 3d5b 2264 225d 290a 2020 2020  hema=["d"]).    
+00004420: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00004430: 7428 6164 645f 6d6f 6e74 6873 2822 6422  t(add_months("d"
+00004440: 2c20 3429 292e 636f 6c6c 6563 7428 295b  , 4)).collect()[
+00004450: 305d 5b30 5d0a 2020 2020 2020 2020 6461  0][0].        da
+00004460: 7465 7469 6d65 2e64 6174 6528 3230 3232  tetime.date(2022
+00004470: 2c20 382c 2036 290a 2020 2020 2222 220a  , 8, 6).    """.
+00004480: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00004490: 6966 5f73 7472 2864 6174 655f 6f72 5f74  if_str(date_or_t
+000044a0: 696d 6573 7461 6d70 2c20 2261 6464 5f6d  imestamp, "add_m
+000044b0: 6f6e 7468 7322 290a 2020 2020 7265 7475  onths").    retu
+000044c0: 726e 2062 7569 6c74 696e 2822 6164 645f  rn builtin("add_
+000044d0: 6d6f 6e74 6873 2229 2863 2c20 6e75 6d62  months")(c, numb
+000044e0: 6572 5f6f 665f 6d6f 6e74 6873 290a 0a0a  er_of_months)...
+000044f0: 6465 6620 616e 795f 7661 6c75 6528 653a  def any_value(e:
+00004500: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00004510: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00004520: 2252 6574 7572 6e73 2061 206e 6f6e 2d64  "Returns a non-d
+00004530: 6574 6572 6d69 6e69 7374 6963 2061 6e79  eterministic any
+00004540: 2076 616c 7565 2066 6f72 2074 6865 2073   value for the s
+00004550: 7065 6369 6669 6564 2063 6f6c 756d 6e2e  pecified column.
+00004560: 0a20 2020 2054 6869 7320 6973 2061 6e20  .    This is an 
+00004570: 6167 6772 6567 6174 6520 616e 6420 7769  aggregate and wi
+00004580: 6e64 6f77 2066 756e 6374 696f 6e2e 0a0a  ndow function...
+00004590: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+000045a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000045b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000045c0: 6166 7261 6d65 285b 5b31 2c20 325d 2c20  aframe([[1, 2], 
+000045d0: 5b33 2c20 345d 5d2c 2073 6368 656d 613d  [3, 4]], schema=
+000045e0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+000045f0: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
+00004600: 2064 662e 7365 6c65 6374 2861 6e79 5f76   df.select(any_v
+00004610: 616c 7565 2822 6122 2929 2e63 6f6c 6c65  alue("a")).colle
+00004620: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
+00004630: 2061 7373 6572 7420 6c65 6e28 7265 7375   assert len(resu
+00004640: 6c74 2920 3d3d 2031 2020 2320 6e6f 6e2d  lt) == 1  # non-
+00004650: 6465 7465 726d 696e 6973 7469 6320 7661  deterministic va
+00004660: 6c75 6520 696e 2072 6573 756c 742e 0a20  lue in result.. 
+00004670: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00004680: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00004690: 2022 616e 795f 7661 6c75 6522 290a 2020   "any_value").  
+000046a0: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
+000046b0: 696c 7469 6e28 2261 6e79 5f76 616c 7565  iltin("any_value
+000046c0: 222c 2063 290a 0a0a 6465 6620 6269 746e  ", c)...def bitn
+000046d0: 6f74 2865 3a20 436f 6c75 6d6e 4f72 4e61  ot(e: ColumnOrNa
+000046e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+000046f0: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
+00004700: 6520 6269 7477 6973 6520 6e65 6761 7469  e bitwise negati
+00004710: 6f6e 206f 6620 6120 6e75 6d65 7269 6320  on of a numeric 
+00004720: 6578 7072 6573 7369 6f6e 2e0a 0a20 2020  expression...   
+00004730: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00004740: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00004750: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00004760: 616d 6528 5b31 5d2c 2073 6368 656d 613d  ame([1], schema=
+00004770: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00004780: 3e3e 2064 662e 7365 6c65 6374 2862 6974  >> df.select(bit
+00004790: 6e6f 7428 2261 2229 292e 636f 6c6c 6563  not("a")).collec
+000047a0: 7428 295b 305d 5b30 5d0a 2020 2020 2020  t()[0][0].      
+000047b0: 2020 2d32 0a20 2020 2022 2222 0a20 2020    -2.    """.   
+000047c0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+000047d0: 7374 7228 652c 2022 6269 746e 6f74 2229  str(e, "bitnot")
+000047e0: 0a20 2020 2072 6574 7572 6e20 6361 6c6c  .    return call
+000047f0: 5f62 7569 6c74 696e 2822 6269 746e 6f74  _builtin("bitnot
+00004800: 222c 2063 290a 0a0a 6465 6620 6269 7473  ", c)...def bits
+00004810: 6869 6674 6c65 6674 2874 6f5f 7368 6966  hiftleft(to_shif
+00004820: 745f 636f 6c75 6d6e 3a20 436f 6c75 6d6e  t_column: Column
+00004830: 4f72 4e61 6d65 2c20 6e3a 2055 6e69 6f6e  OrName, n: Union
+00004840: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 202d  [Column, int]) -
+00004850: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00004860: 2252 6574 7572 6e73 2074 6865 2062 6974  "Returns the bit
+00004870: 7769 7365 206e 6567 6174 696f 6e20 6f66  wise negation of
+00004880: 2061 206e 756d 6572 6963 2065 7870 7265   a numeric expre
+00004890: 7373 696f 6e2e 0a0a 2020 2020 4578 616d  ssion...    Exam
+000048a0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+000048b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000048c0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000048d0: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
+000048e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000048f0: 2e73 656c 6563 7428 6269 7473 6869 6674  .select(bitshift
+00004900: 6c65 6674 2822 6122 2c20 3129 292e 636f  left("a", 1)).co
+00004910: 6c6c 6563 7428 295b 305d 5b30 5d0a 2020  llect()[0][0].  
+00004920: 2020 2020 2020 340a 2020 2020 2222 220a        4.    """.
+00004930: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00004940: 6966 5f73 7472 2874 6f5f 7368 6966 745f  if_str(to_shift_
+00004950: 636f 6c75 6d6e 2c20 2262 6974 7368 6966  column, "bitshif
+00004960: 746c 6566 7422 290a 2020 2020 7265 7475  tleft").    retu
+00004970: 726e 2063 616c 6c5f 6275 696c 7469 6e28  rn call_builtin(
+00004980: 2262 6974 7368 6966 746c 6566 7422 2c20  "bitshiftleft", 
+00004990: 632c 206e 290a 0a0a 6465 6620 6269 7473  c, n)...def bits
+000049a0: 6869 6674 7269 6768 7428 746f 5f73 6869  hiftright(to_shi
+000049b0: 6674 5f63 6f6c 756d 6e3a 2043 6f6c 756d  ft_column: Colum
+000049c0: 6e4f 724e 616d 652c 206e 3a20 556e 696f  nOrName, n: Unio
+000049d0: 6e5b 436f 6c75 6d6e 2c20 696e 745d 2920  n[Column, int]) 
+000049e0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000049f0: 2222 5265 7475 726e 7320 7468 6520 6269  ""Returns the bi
+00004a00: 7477 6973 6520 6e65 6761 7469 6f6e 206f  twise negation o
+00004a10: 6620 6120 6e75 6d65 7269 6320 6578 7072  f a numeric expr
+00004a20: 6573 7369 6f6e 2e0a 0a20 2020 2045 7861  ession...    Exa
+00004a30: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00004a40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00004a50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00004a60: 5b32 5d2c 2073 6368 656d 613d 5b22 6122  [2], schema=["a"
+00004a70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00004a80: 662e 7365 6c65 6374 2862 6974 7368 6966  f.select(bitshif
+00004a90: 7472 6967 6874 2822 6122 2c20 3129 292e  tright("a", 1)).
+00004aa0: 636f 6c6c 6563 7428 295b 305d 5b30 5d0a  collect()[0][0].
+00004ab0: 2020 2020 2020 2020 310a 2020 2020 2222          1.    ""
+00004ac0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00004ad0: 6c5f 6966 5f73 7472 2874 6f5f 7368 6966  l_if_str(to_shif
+00004ae0: 745f 636f 6c75 6d6e 2c20 2262 6974 7368  t_column, "bitsh
+00004af0: 6966 7472 6967 6874 2229 0a20 2020 2072  iftright").    r
+00004b00: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
+00004b10: 696e 2822 6269 7473 6869 6674 7269 6768  in("bitshiftrigh
+00004b20: 7422 2c20 632c 206e 290a 0a0a 6465 6620  t", c, n)...def 
+00004b30: 6272 6f75 6e64 2863 6f6c 3a20 436f 6c75  bround(col: Colu
+00004b40: 6d6e 4f72 4e61 6d65 2c20 7363 616c 653a  mnOrName, scale:
+00004b50: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
+00004b60: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
+00004b70: 2020 2020 2222 220a 2020 2020 526f 756e      """.    Roun
+00004b80: 6473 2074 6865 206e 756d 6265 7220 7573  ds the number us
+00004b90: 696e 6720 6048 414c 465f 544f 5f45 5645  ing `HALF_TO_EVE
+00004ba0: 4e60 206f 7074 696f 6e2e 2054 6865 2060  N` option. The `
+00004bb0: 4841 4c46 5f54 4f5f 4556 454e 6020 726f  HALF_TO_EVEN` ro
+00004bc0: 756e 6469 6e67 206d 6f64 6520 726f 756e  unding mode roun
+00004bd0: 6473 2074 6865 2067 6976 656e 2064 6563  ds the given dec
+00004be0: 696d 616c 2076 616c 7565 2074 6f20 7468  imal value to th
+00004bf0: 6520 7370 6563 6966 6965 6420 7363 616c  e specified scal
+00004c00: 6520 286e 756d 6265 7220 6f66 2064 6563  e (number of dec
+00004c10: 696d 616c 2070 6c61 6365 7329 2061 7320  imal places) as 
+00004c20: 666f 6c6c 6f77 733a 0a20 2020 202a 2049  follows:.    * I
+00004c30: 6620 7363 616c 6520 6973 2067 7265 6174  f scale is great
+00004c40: 6572 2074 6861 6e20 6f72 2065 7175 616c  er than or equal
+00004c50: 2074 6f20 302c 2072 6f75 6e64 2074 6f20   to 0, round to 
+00004c60: 7468 6520 7370 6563 6966 6965 6420 6e75  the specified nu
+00004c70: 6d62 6572 206f 6620 6465 6369 6d61 6c20  mber of decimal 
+00004c80: 706c 6163 6573 2075 7369 6e67 2068 616c  places using hal
+00004c90: 662d 6576 656e 2072 6f75 6e64 696e 672e  f-even rounding.
+00004ca0: 2054 6869 7320 726f 756e 6473 2074 6f77   This rounds tow
+00004cb0: 6172 6473 2074 6865 206e 6561 7265 7374  ards the nearest
+00004cc0: 2076 616c 7565 2077 6974 6820 7469 6573   value with ties
+00004cd0: 2028 6571 7561 6c6c 7920 636c 6f73 6520   (equally close 
+00004ce0: 7661 6c75 6573 2920 726f 756e 6469 6e67  values) rounding
+00004cf0: 2074 6f20 7468 6520 6e65 6172 6573 7420   to the nearest 
+00004d00: 6576 656e 2064 6967 6974 2e0a 2020 2020  even digit..    
+00004d10: 2a20 4966 2073 6361 6c65 2069 7320 6c65  * If scale is le
+00004d20: 7373 2074 6861 6e20 302c 2072 6f75 6e64  ss than 0, round
+00004d30: 2074 6f20 7468 6520 696e 7465 6772 616c   to the integral
+00004d40: 2070 6172 7420 6f66 2074 6865 2064 6563   part of the dec
+00004d50: 696d 616c 2e20 5468 6973 2072 6f75 6e64  imal. This round
+00004d60: 7320 746f 7761 7264 7320 3020 616e 6420  s towards 0 and 
+00004d70: 7472 756e 6361 7465 7320 7468 6520 6465  truncates the de
+00004d80: 6369 6d61 6c20 706c 6163 6573 2e0a 0a20  cimal places... 
+00004d90: 2020 204e 6f74 653a 0a0a 2020 2020 2020     Note:..      
+00004da0: 2020 312e 2054 6865 2064 6174 6120 7479    1. The data ty
+00004db0: 7065 206f 6620 7468 6520 6578 7072 6573  pe of the expres
+00004dc0: 7369 6f6e 206d 7573 7420 6265 206f 6e65  sion must be one
+00004dd0: 206f 6620 7468 6520 6064 6174 6120 7479   of the `data ty
+00004de0: 7065 7320 666f 7220 6120 6669 7865 642d  pes for a fixed-
+00004df0: 706f 696e 7420 6e75 6d62 6572 0a20 2020  point number.   
+00004e00: 2020 2020 203c 6874 7470 733a 2f2f 646f       <https://do
+00004e10: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+00004e20: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+00004e30: 652f 6461 7461 2d74 7970 6573 2d6e 756d  e/data-types-num
+00004e40: 6572 6963 2e68 746d 6c23 6c61 6265 6c2d  eric.html#label-
+00004e50: 6461 7461 2d74 7970 6573 2d66 6f72 2d66  data-types-for-f
+00004e60: 6978 6564 2d70 6f69 6e74 2d6e 756d 6265  ixed-point-numbe
+00004e70: 7273 3e60 5f2e 0a0a 2020 2020 2020 2020  rs>`_...        
+00004e80: 322e 2044 6174 6120 7479 7065 7320 666f  2. Data types fo
+00004e90: 7220 666c 6f61 7469 6e67 2070 6f69 6e74  r floating point
+00004ea0: 206e 756d 6265 7273 2028 652e 672e 2046   numbers (e.g. F
+00004eb0: 4c4f 4154 2920 6172 6520 6e6f 7420 7375  LOAT) are not su
+00004ec0: 7070 6f72 7465 6420 7769 7468 2074 6869  pported with thi
+00004ed0: 7320 6172 6775 6d65 6e74 2e0a 0a20 2020  s argument...   
+00004ee0: 2020 2020 2033 2e20 4966 2074 6865 2065       3. If the e
+00004ef0: 7870 7265 7373 696f 6e20 6461 7461 2074  xpression data t
+00004f00: 7970 6520 6973 206e 6f74 2073 7570 706f  ype is not suppo
+00004f10: 7274 6564 2c20 7468 6520 6578 7072 6573  rted, the expres
+00004f20: 7369 6f6e 206d 7573 7420 6265 2065 7870  sion must be exp
+00004f30: 6c69 6369 746c 7920 6361 7374 2074 6f20  licitly cast to 
+00004f40: 6465 6369 6d61 6c20 6265 666f 7265 2063  decimal before c
+00004f50: 616c 6c69 6e67 2e0a 0a20 2020 2045 7861  alling...    Exa
+00004f60: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00004f70: 3e20 696d 706f 7274 2064 6563 696d 616c  > import decimal
+00004f80: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+00004f90: 6120 3d20 5b28 6465 6369 6d61 6c2e 4465  a = [(decimal.De
+00004fa0: 6369 6d61 6c28 312e 3233 3529 292c 2864  cimal(1.235)),(d
+00004fb0: 6563 696d 616c 2e44 6563 696d 616c 2833  ecimal.Decimal(3
+00004fc0: 2e35 2929 5d0a 2020 2020 2020 2020 3e3e  .5))].        >>
+00004fd0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00004fe0: 7265 6174 6544 6174 6146 7261 6d65 2864  reateDataFrame(d
+00004ff0: 6174 612c 205b 2276 616c 7565 225d 290a  ata, ["value"]).
+00005000: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00005010: 656c 6563 7428 6272 6f75 6e64 2827 5641  elect(bround('VA
+00005020: 4c55 4527 2c31 292e 616c 6961 7328 2256  LUE',1).alias("V
+00005030: 414c 5545 2229 292e 7368 6f77 2829 2023  ALUE")).show() #
+00005040: 2052 6f75 6e64 7320 746f 2031 2064 6563   Rounds to 1 dec
+00005050: 696d 616c 2070 6c61 6365 0a20 2020 2020  imal place.     
+00005060: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20     -----------. 
+00005070: 2020 2020 2020 207c 2256 414c 5545 2220         |"VALUE" 
+00005080: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00005090: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+000050a0: 312e 3220 2020 2020 207c 0a20 2020 2020  1.2      |.     
+000050b0: 2020 207c 332e 3520 2020 2020 207c 0a20     |3.5      |. 
+000050c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000050d0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+000050e0: 4b4c 494e 453e 0a20 2020 2020 2020 203e  KLINE>.        >
+000050f0: 3e3e 2064 662e 7365 6c65 6374 2862 726f  >> df.select(bro
+00005100: 756e 6428 2756 414c 5545 272c 3029 2e61  und('VALUE',0).a
+00005110: 6c69 6173 2822 5641 4c55 4522 2929 2e73  lias("VALUE")).s
+00005120: 686f 7728 2920 2320 526f 756e 6473 2074  how() # Rounds t
+00005130: 6f20 3120 6465 6369 6d61 6c20 706c 6163  o 1 decimal plac
+00005140: 650a 2020 2020 2020 2020 2d2d 2d2d 2d2d  e.        ------
+00005150: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00005160: 5641 4c55 4522 2020 7c0a 2020 2020 2020  VALUE"  |.      
+00005170: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020    -----------.  
+00005180: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
+00005190: 7c0a 2020 2020 2020 2020 7c34 2020 2020  |.        |4    
+000051a0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+000051b0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000051c0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+000051d0: 2020 2222 220a 2020 2020 636f 6c20 3d20    """.    col = 
+000051e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000051f0: 6f6c 2c20 2262 726f 756e 6422 290a 2020  ol, "bround").  
+00005200: 2020 7363 616c 6520 3d20 5f74 6f5f 636f    scale = _to_co
+00005210: 6c5f 6966 5f6c 6974 2873 6361 6c65 2c20  l_if_lit(scale, 
+00005220: 2262 726f 756e 6422 290a 2020 2020 7265  "bround").    re
+00005230: 7475 726e 2063 616c 6c5f 6275 696c 7469  turn call_builti
+00005240: 6e28 2252 4f55 4e44 222c 2063 6f6c 2c20  n("ROUND", col, 
+00005250: 7363 616c 652c 206c 6974 2822 4841 4c46  scale, lit("HALF
+00005260: 5f54 4f5f 4556 454e 2229 290a 0a0a 6465  _TO_EVEN"))...de
+00005270: 6620 636f 6e76 6572 745f 7469 6d65 7a6f  f convert_timezo
+00005280: 6e65 280a 2020 2020 7461 7267 6574 5f74  ne(.    target_t
+00005290: 696d 657a 6f6e 653a 2043 6f6c 756d 6e4f  imezone: ColumnO
+000052a0: 724e 616d 652c 0a20 2020 2073 6f75 7263  rName,.    sourc
+000052b0: 655f 7469 6d65 3a20 436f 6c75 6d6e 4f72  e_time: ColumnOr
+000052c0: 4e61 6d65 2c0a 2020 2020 736f 7572 6365  Name,.    source
+000052d0: 5f74 696d 657a 6f6e 653a 204f 7074 696f  _timezone: Optio
+000052e0: 6e61 6c5b 436f 6c75 6d6e 4f72 4e61 6d65  nal[ColumnOrName
+000052f0: 5d20 3d20 4e6f 6e65 2c0a 2920 2d3e 2043  ] = None,.) -> C
+00005300: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+00005310: 6e76 6572 7473 2074 6865 2067 6976 656e  nverts the given
+00005320: 2073 6f75 7263 655f 7469 6d65 2074 6f20   source_time to 
+00005330: 7468 6520 7461 7267 6574 2074 696d 657a  the target timez
+00005340: 6f6e 652e 0a0a 2020 2020 466f 7220 7469  one...    For ti
+00005350: 6d65 7a6f 6e65 2069 6e66 6f72 6d61 7469  mezone informati
+00005360: 6f6e 2c20 7265 6665 7220 746f 2074 6865  on, refer to the
+00005370: 2060 536e 6f77 666c 616b 6520 5351 4c20   `Snowflake SQL 
+00005380: 636f 6e76 6572 745f 7469 6d65 7a6f 6e65  convert_timezone
+00005390: 206e 6f74 6573 203c 6874 7470 733a 2f2f   notes <https://
+000053a0: 646f 6373 2e73 6e6f 7766 6c61 6b65 2e63  docs.snowflake.c
+000053b0: 6f6d 2f65 6e2f 7371 6c2d 7265 6665 7265  om/en/sql-refere
+000053c0: 6e63 652f 6675 6e63 7469 6f6e 732f 636f  nce/functions/co
+000053d0: 6e76 6572 745f 7469 6d65 7a6f 6e65 2e68  nvert_timezone.h
+000053e0: 746d 6c23 7573 6167 652d 6e6f 7465 733e  tml#usage-notes>
+000053f0: 605f 0a0a 2020 2020 2020 2020 4172 6773  `_..        Args
+00005400: 3a0a 2020 2020 2020 2020 2020 2020 7461  :.            ta
+00005410: 7267 6574 5f74 696d 657a 6f6e 653a 2054  rget_timezone: T
+00005420: 6865 2074 696d 6520 7a6f 6e65 2074 6f20  he time zone to 
+00005430: 7768 6963 6820 7468 6520 696e 7075 7420  which the input 
+00005440: 7469 6d65 7374 616d 7020 7368 6f75 6c64  timestamp should
+00005450: 2062 6520 636f 6e76 6572 7465 642e 3d0a   be converted.=.
+00005460: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00005470: 6365 5f74 696d 653a 2054 6865 2074 696d  ce_time: The tim
+00005480: 6573 7461 6d70 2074 6f20 636f 6e76 6572  estamp to conver
+00005490: 742e 2057 6865 6e20 6974 2773 2061 2054  t. When it's a T
+000054a0: 494d 4553 5441 4d50 5f4c 545a 2c20 7573  IMESTAMP_LTZ, us
+000054b0: 6520 6060 4e6f 6e65 6060 2066 6f72 2060  e ``None`` for `
+000054c0: 6073 6f75 7263 655f 7469 6d65 7a6f 6e65  `source_timezone
+000054d0: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+000054e0: 736f 7572 6365 5f74 696d 657a 6f6e 653a  source_timezone:
+000054f0: 2054 6865 2074 696d 6520 7a6f 6e65 2066   The time zone f
+00005500: 6f72 2074 6865 2060 6073 6f75 7263 655f  or the ``source_
+00005510: 7469 6d65 6060 2e20 5265 7175 6972 6564  time``. Required
+00005520: 2066 6f72 2074 696d 6573 7461 6d70 7320   for timestamps 
+00005530: 7769 7468 206e 6f20 7469 6d65 207a 6f6e  with no time zon
+00005540: 6520 2869 2e65 2e20 5449 4d45 5354 414d  e (i.e. TIMESTAM
+00005550: 505f 4e54 5a29 2e20 5573 6520 6060 4e6f  P_NTZ). Use ``No
+00005560: 6e65 6060 2069 6620 7468 6520 7469 6d65  ne`` if the time
+00005570: 7374 616d 7073 2068 6176 6520 6120 7469  stamps have a ti
+00005580: 6d65 207a 6f6e 6520 2869 2e65 2e20 5449  me zone (i.e. TI
+00005590: 4d45 5354 414d 505f 4c54 5a29 2e20 4465  MESTAMP_LTZ). De
+000055a0: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
+000055b0: 602e 0a0a 2020 2020 2020 2020 4e6f 7465  `...        Note
+000055c0: 3a0a 2020 2020 2020 2020 2020 2020 5468  :.            Th
+000055d0: 6520 7365 7175 656e 6365 206f 6620 7468  e sequence of th
+000055e0: 6520 3320 7061 7261 6d73 2069 7320 6469  e 3 params is di
+000055f0: 6666 6572 656e 7420 6672 6f6d 2074 6865  fferent from the
+00005600: 2053 514c 2066 756e 6374 696f 6e2c 2077   SQL function, w
+00005610: 6869 6368 2074 776f 206f 7665 726c 6f61  hich two overloa
+00005620: 6473 3a0a 0a20 2020 2020 2020 2020 2020  ds:..           
+00005630: 2020 202d 2060 6043 4f4e 5645 5254 5f54     - ``CONVERT_T
+00005640: 494d 455a 4f4e 4528 203c 736f 7572 6365  IMEZONE( <source
+00005650: 5f74 7a3e 202c 203c 7461 7267 6574 5f74  _tz> , <target_t
+00005660: 7a3e 202c 203c 736f 7572 6365 5f74 696d  z> , <source_tim
+00005670: 6573 7461 6d70 5f6e 747a 3e20 2960 600a  estamp_ntz> )``.
+00005680: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00005690: 6060 434f 4e56 4552 545f 5449 4d45 5a4f  ``CONVERT_TIMEZO
+000056a0: 4e45 2820 3c74 6172 6765 745f 747a 3e20  NE( <target_tz> 
+000056b0: 2c20 3c73 6f75 7263 655f 7469 6d65 7374  , <source_timest
+000056c0: 616d 703e 2029 6060 0a0a 2020 2020 2020  amp> )``..      
+000056d0: 2020 2020 2020 5468 6520 6669 7273 7420        The first 
+000056e0: 7061 7261 6d65 7465 7220 6060 736f 7572  parameter ``sour
+000056f0: 6365 5f74 7a60 6020 6973 206f 7074 696f  ce_tz`` is optio
+00005700: 6e61 6c2e 2042 7574 2069 6e20 5079 7468  nal. But in Pyth
+00005710: 6f6e 2061 6e20 6f70 7469 6f6e 616c 2061  on an optional a
+00005720: 7267 756d 656e 7420 7368 6f75 6c64 6e27  rgument shouldn'
+00005730: 7420 6265 2070 6c61 6365 6420 6174 2074  t be placed at t
+00005740: 6865 2066 6972 7374 2e0a 2020 2020 2020  he first..      
+00005750: 2020 2020 2020 536f 2060 6073 6f75 7263        So ``sourc
+00005760: 655f 7469 6d65 7a6f 6e65 6060 2069 7320  e_timezone`` is 
+00005770: 6166 7465 7220 6060 736f 7572 6365 5f74  after ``source_t
+00005780: 696d 6560 602e 0a0a 2020 2020 2020 2020  ime``...        
+00005790: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+000057a0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+000057b0: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
+000057c0: 2020 2020 203e 3e3e 2066 726f 6d20 6461       >>> from da
+000057d0: 7465 7574 696c 2069 6d70 6f72 7420 747a  teutil import tz
+000057e0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000057f0: 2064 6174 6574 696d 655f 7769 7468 5f74   datetime_with_t
+00005800: 7a20 3d20 6461 7465 7469 6d65 2e64 6174  z = datetime.dat
+00005810: 6574 696d 6528 3230 3232 2c20 342c 2036  etime(2022, 4, 6
+00005820: 2c20 392c 2030 2c20 302c 2074 7a69 6e66  , 9, 0, 0, tzinf
+00005830: 6f3d 747a 2e74 7a6f 6666 7365 7428 226d  o=tz.tzoffset("m
+00005840: 797a 6f6e 6522 2c20 2d33 3630 302a 3729  yzone", -3600*7)
+00005850: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00005860: 3e20 6461 7465 7469 6d65 5f77 6974 685f  > datetime_with_
+00005870: 6e6f 5f74 7a20 3d20 6461 7465 7469 6d65  no_tz = datetime
+00005880: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
+00005890: 342c 2036 2c20 392c 2030 2c20 3029 0a20  4, 6, 9, 0, 0). 
+000058a0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+000058b0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000058c0: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
+000058d0: 6174 6574 696d 655f 7769 7468 5f74 7a2c  atetime_with_tz,
+000058e0: 2064 6174 6574 696d 655f 7769 7468 5f6e   datetime_with_n
+000058f0: 6f5f 747a 5d5d 2c20 7363 6865 6d61 3d5b  o_tz]], schema=[
+00005900: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00005910: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+00005920: 7420 3d20 6466 2e73 656c 6563 7428 636f  t = df.select(co
+00005930: 6e76 6572 745f 7469 6d65 7a6f 6e65 286c  nvert_timezone(l
+00005940: 6974 2822 5554 4322 292c 2063 6f6c 2822  it("UTC"), col("
+00005950: 6122 2929 2c20 636f 6e76 6572 745f 7469  a")), convert_ti
+00005960: 6d65 7a6f 6e65 286c 6974 2822 5554 4322  mezone(lit("UTC"
+00005970: 292c 2063 6f6c 2822 6222 292c 206c 6974  ), col("b"), lit
+00005980: 2822 4173 6961 2f53 6861 6e67 6861 6922  ("Asia/Shanghai"
+00005990: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+000059a0: 2020 2020 2020 2020 2020 3e3e 3e20 7265            >>> re
+000059b0: 7375 6c74 5b30 5d5b 305d 0a20 2020 2020  sult[0][0].     
+000059c0: 2020 2020 2020 2064 6174 6574 696d 652e         datetime.
+000059d0: 6461 7465 7469 6d65 2832 3032 322c 2034  datetime(2022, 4
+000059e0: 2c20 362c 2031 362c 2030 2c20 747a 696e  , 6, 16, 0, tzin
+000059f0: 666f 3d3c 5554 433e 290a 2020 2020 2020  fo=<UTC>).      
+00005a00: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
+00005a10: 5b30 5d5b 315d 0a20 2020 2020 2020 2020  [0][1].         
+00005a20: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+00005a30: 7469 6d65 2832 3032 322c 2034 2c20 362c  time(2022, 4, 6,
+00005a40: 2031 2c20 3029 0a20 2020 2022 2222 0a20   1, 0).    """. 
+00005a50: 2020 2073 6f75 7263 655f 747a 203d 2028     source_tz = (
+00005a60: 0a20 2020 2020 2020 205f 746f 5f63 6f6c  .        _to_col
+00005a70: 5f69 665f 7374 7228 736f 7572 6365 5f74  _if_str(source_t
+00005a80: 696d 657a 6f6e 652c 2022 636f 6e76 6572  imezone, "conver
+00005a90: 745f 7469 6d65 7a6f 6e65 2229 0a20 2020  t_timezone").   
+00005aa0: 2020 2020 2069 6620 736f 7572 6365 5f74       if source_t
+00005ab0: 696d 657a 6f6e 6520 6973 206e 6f74 204e  imezone is not N
+00005ac0: 6f6e 650a 2020 2020 2020 2020 656c 7365  one.        else
+00005ad0: 204e 6f6e 650a 2020 2020 290a 2020 2020   None.    ).    
+00005ae0: 7461 7267 6574 5f74 7a20 3d20 5f74 6f5f  target_tz = _to_
+00005af0: 636f 6c5f 6966 5f73 7472 2874 6172 6765  col_if_str(targe
+00005b00: 745f 7469 6d65 7a6f 6e65 2c20 2263 6f6e  t_timezone, "con
+00005b10: 7665 7274 5f74 696d 657a 6f6e 6522 290a  vert_timezone").
+00005b20: 2020 2020 736f 7572 6365 5f74 696d 655f      source_time_
+00005b30: 746f 5f63 6f6e 7665 7274 203d 205f 746f  to_convert = _to
+00005b40: 5f63 6f6c 5f69 665f 7374 7228 736f 7572  _col_if_str(sour
+00005b50: 6365 5f74 696d 652c 2022 636f 6e76 6572  ce_time, "conver
+00005b60: 745f 7469 6d65 7a6f 6e65 2229 0a0a 2020  t_timezone")..  
+00005b70: 2020 6966 2073 6f75 7263 655f 7469 6d65    if source_time
+00005b80: 7a6f 6e65 2069 7320 4e6f 6e65 3a0a 2020  zone is None:.  
+00005b90: 2020 2020 2020 7265 7475 726e 2063 616c        return cal
+00005ba0: 6c5f 6275 696c 7469 6e28 2263 6f6e 7665  l_builtin("conve
+00005bb0: 7274 5f74 696d 657a 6f6e 6522 2c20 7461  rt_timezone", ta
+00005bc0: 7267 6574 5f74 7a2c 2073 6f75 7263 655f  rget_tz, source_
+00005bd0: 7469 6d65 5f74 6f5f 636f 6e76 6572 7429  time_to_convert)
+00005be0: 0a20 2020 2072 6574 7572 6e20 6361 6c6c  .    return call
+00005bf0: 5f62 7569 6c74 696e 280a 2020 2020 2020  _builtin(.      
+00005c00: 2020 2263 6f6e 7665 7274 5f74 696d 657a    "convert_timez
+00005c10: 6f6e 6522 2c20 736f 7572 6365 5f74 7a2c  one", source_tz,
+00005c20: 2074 6172 6765 745f 747a 2c20 736f 7572   target_tz, sour
+00005c30: 6365 5f74 696d 655f 746f 5f63 6f6e 7665  ce_time_to_conve
+00005c40: 7274 0a20 2020 2029 0a0a 0a64 6566 2061  rt.    )...def a
+00005c50: 7070 726f 785f 636f 756e 745f 6469 7374  pprox_count_dist
+00005c60: 696e 6374 2865 3a20 436f 6c75 6d6e 4f72  inct(e: ColumnOr
+00005c70: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00005c80: 0a20 2020 2022 2222 5573 6573 2048 7970  .    """Uses Hyp
+00005c90: 6572 4c6f 674c 6f67 2074 6f20 7265 7475  erLogLog to retu
+00005ca0: 726e 2061 6e20 6170 7072 6f78 696d 6174  rn an approximat
+00005cb0: 696f 6e20 6f66 2074 6865 2064 6973 7469  ion of the disti
+00005cc0: 6e63 7420 6361 7264 696e 616c 6974 7920  nct cardinality 
+00005cd0: 6f66 2074 6865 2069 6e70 7574 2028 692e  of the input (i.
+00005ce0: 652e 2048 4c4c 2863 6f6c 312c 2063 6f6c  e. HLL(col1, col
+00005cf0: 322c 202e 2e2e 2029 0a20 2020 2072 6574  2, ... ).    ret
+00005d00: 7572 6e73 2061 6e20 6170 7072 6f78 696d  urns an approxim
+00005d10: 6174 696f 6e20 6f66 2043 4f55 4e54 2844  ation of COUNT(D
+00005d20: 4953 5449 4e43 5420 636f 6c31 2c20 636f  ISTINCT col1, co
+00005d30: 6c32 2c20 2e2e 2e20 2929 2e0a 0a20 2020  l2, ... ))...   
+00005d40: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00005d50: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00005d60: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00005d70: 7261 6d65 285b 5b31 2c20 325d 2c20 5b33  rame([[1, 2], [3
+00005d80: 2c20 345d 2c20 5b35 2c20 365d 5d2c 2073  , 4], [5, 6]], s
+00005d90: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
+00005da0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00005db0: 2e73 656c 6563 7428 6170 7072 6f78 5f63  .select(approx_c
+00005dc0: 6f75 6e74 5f64 6973 7469 6e63 7428 2261  ount_distinct("a
+00005dd0: 2229 2e61 6c69 6173 2822 7265 7375 6c74  ").alias("result
+00005de0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00005df0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00005e00: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00005e10: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00005e20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00005e30: 2020 7c33 2020 2020 2020 2020 207c 0a20    |3         |. 
+00005e40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00005e50: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00005e60: 4e4b 4c49 4e45 3e0a 0a20 2020 2022 2222  NKLINE>..    """
+00005e70: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00005e80: 5f69 665f 7374 7228 652c 2022 6170 7072  _if_str(e, "appr
+00005e90: 6f78 5f63 6f75 6e74 5f64 6973 7469 6e63  ox_count_distinc
+00005ea0: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+00005eb0: 7569 6c74 696e 2822 6170 7072 6f78 5f63  uiltin("approx_c
+00005ec0: 6f75 6e74 5f64 6973 7469 6e63 7422 2928  ount_distinct")(
+00005ed0: 6329 0a0a 0a64 6566 2061 7667 2865 3a20  c)...def avg(e: 
+00005ee0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00005ef0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00005f00: 5265 7475 726e 7320 7468 6520 6176 6572  Returns the aver
+00005f10: 6167 6520 6f66 206e 6f6e 2d4e 554c 4c20  age of non-NULL 
+00005f20: 7265 636f 7264 732e 2049 6620 616c 6c20  records. If all 
+00005f30: 7265 636f 7264 7320 696e 7369 6465 2061  records inside a
+00005f40: 2067 726f 7570 2061 7265 204e 554c 4c2c   group are NULL,
+00005f50: 0a20 2020 2074 6865 2066 756e 6374 696f  .    the functio
+00005f60: 6e20 7265 7475 726e 7320 4e55 4c4c 2e0a  n returns NULL..
+00005f70: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00005f80: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00005f90: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00005fa0: 6174 6166 7261 6d65 285b 5b31 5d2c 205b  ataframe([[1], [
+00005fb0: 325d 2c20 5b32 5d5d 2c20 7363 6865 6d61  2], [2]], schema
+00005fc0: 3d5b 2264 225d 290a 2020 2020 2020 2020  =["d"]).        
+00005fd0: 3e3e 3e20 6466 2e73 656c 6563 7428 6176  >>> df.select(av
+00005fe0: 6728 6466 2e64 292e 616c 6961 7328 2272  g(df.d).alias("r
+00005ff0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00006000: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006010: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00006020: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+00006030: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00006040: 2020 2020 2020 207c 312e 3636 3636 3637         |1.666667
+00006050: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00006060: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00006070: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00006080: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00006090: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+000060a0: 6176 6722 290a 2020 2020 7265 7475 726e  avg").    return
+000060b0: 2062 7569 6c74 696e 2822 6176 6722 2928   builtin("avg")(
+000060c0: 6329 0a0a 0a64 6566 2063 6f72 7228 636f  c)...def corr(co
+000060d0: 6c75 6d6e 313a 2043 6f6c 756d 6e4f 724e  lumn1: ColumnOrN
+000060e0: 616d 652c 2063 6f6c 756d 6e32 3a20 436f  ame, column2: Co
+000060f0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00006100: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00006110: 7475 726e 7320 7468 6520 636f 7272 656c  turns the correl
+00006120: 6174 696f 6e20 636f 6566 6669 6369 656e  ation coefficien
+00006130: 7420 666f 7220 6e6f 6e2d 6e75 6c6c 2070  t for non-null p
+00006140: 6169 7273 2069 6e20 6120 6772 6f75 702e  airs in a group.
+00006150: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
+00006160: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00006170: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00006180: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
+00006190: 2c20 5b31 2c20 325d 2c20 5b34 2c20 355d  , [1, 2], [4, 5]
+000061a0: 2c20 5b32 2c20 335d 2c20 5b33 2c20 4e6f  , [2, 3], [3, No
+000061b0: 6e65 5d2c 205b 342c 204e 6f6e 655d 2c20  ne], [4, None], 
+000061c0: 5b36 2c34 5d5d 2c20 7363 6865 6d61 3d5b  [6,4]], schema=[
+000061d0: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+000061e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000061f0: 2863 6f72 7228 636f 6c28 2261 2229 2c20  (corr(col("a"), 
+00006200: 636f 6c28 2262 2229 292e 616c 6961 7328  col("b")).alias(
+00006210: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00006220: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00006230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00006240: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00006250: 2220 2020 2020 2020 2020 2020 7c0a 2020  "           |.  
+00006260: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00006270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00006280: 2020 2020 7c30 2e38 3133 3638 3135 3038      |0.813681508
+00006290: 3332 3838 3039 2020 7c0a 2020 2020 2020  328809  |.      
+000062a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000062b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000062c0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+000062d0: 2222 220a 2020 2020 6331 203d 205f 746f  """.    c1 = _to
+000062e0: 5f63 6f6c 5f69 665f 7374 7228 636f 6c75  _col_if_str(colu
+000062f0: 6d6e 312c 2022 636f 7272 2229 0a20 2020  mn1, "corr").   
+00006300: 2063 3220 3d20 5f74 6f5f 636f 6c5f 6966   c2 = _to_col_if
+00006310: 5f73 7472 2863 6f6c 756d 6e32 2c20 2263  _str(column2, "c
+00006320: 6f72 7222 290a 2020 2020 7265 7475 726e  orr").    return
+00006330: 2062 7569 6c74 696e 2822 636f 7272 2229   builtin("corr")
+00006340: 2863 312c 2063 3229 0a0a 0a64 6566 2063  (c1, c2)...def c
+00006350: 6f75 6e74 2865 3a20 436f 6c75 6d6e 4f72  ount(e: ColumnOr
+00006360: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00006370: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00006380: 6569 7468 6572 2074 6865 206e 756d 6265  either the numbe
+00006390: 7220 6f66 206e 6f6e 2d4e 554c 4c20 7265  r of non-NULL re
+000063a0: 636f 7264 7320 666f 7220 7468 6520 7370  cords for the sp
+000063b0: 6563 6966 6965 6420 636f 6c75 6d6e 732c  ecified columns,
+000063c0: 206f 7220 7468 650a 2020 2020 746f 7461   or the.    tota
+000063d0: 6c20 6e75 6d62 6572 206f 6620 7265 636f  l number of reco
+000063e0: 7264 732e 0a0a 2020 2020 4578 616d 706c  rds...    Exampl
+000063f0: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
+00006400: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00006410: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+00006420: 5d2c 205b 4e6f 6e65 5d2c 205b 335d 2c20  ], [None], [3], 
+00006430: 5b34 5d2c 205b 4e6f 6e65 5d5d 2c20 7363  [4], [None]], sc
+00006440: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00006450: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00006460: 7428 636f 756e 7428 636f 6c28 2261 2229  t(count(col("a")
+00006470: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00006480: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00006490: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000064a0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+000064b0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000064c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000064d0: 207c 3320 2020 2020 2020 2020 7c0a 2020   |3         |.  
+000064e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000064f0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00006500: 4b4c 494e 453e 0a20 2020 2020 2020 203e  KLINE>.        >
+00006510: 3e3e 2064 662e 7365 6c65 6374 2863 6f75  >> df.select(cou
+00006520: 6e74 2822 2a22 292e 616c 6961 7328 2272  nt("*").alias("r
+00006530: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00006540: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006550: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00006560: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+00006570: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00006580: 2020 2020 2020 207c 3520 2020 2020 2020         |5       
+00006590: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000065a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000065b0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+000065c0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000065d0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+000065e0: 636f 756e 7422 290a 2020 2020 7265 7475  count").    retu
+000065f0: 726e 2028 0a20 2020 2020 2020 2062 7569  rn (.        bui
+00006600: 6c74 696e 2822 636f 756e 7422 2928 4c69  ltin("count")(Li
+00006610: 7465 7261 6c28 3129 290a 2020 2020 2020  teral(1)).      
+00006620: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00006630: 632e 5f65 7870 7265 7373 696f 6e2c 2053  c._expression, S
+00006640: 7461 7229 0a20 2020 2020 2020 2065 6c73  tar).        els
+00006650: 6520 6275 696c 7469 6e28 2263 6f75 6e74  e builtin("count
+00006660: 2229 2863 2e5f 6578 7072 6573 7369 6f6e  ")(c._expression
+00006670: 290a 2020 2020 290a 0a0a 6465 6620 636f  ).    )...def co
+00006680: 756e 745f 6469 7374 696e 6374 282a 636f  unt_distinct(*co
+00006690: 6c73 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ls: ColumnOrName
+000066a0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000066b0: 2022 2222 5265 7475 726e 7320 6569 7468   """Returns eith
+000066c0: 6572 2074 6865 206e 756d 6265 7220 6f66  er the number of
+000066d0: 206e 6f6e 2d4e 554c 4c20 6469 7374 696e   non-NULL distin
+000066e0: 6374 2072 6563 6f72 6473 2066 6f72 2074  ct records for t
+000066f0: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
+00006700: 756d 6e73 2c0a 2020 2020 6f72 2074 6865  umns,.    or the
+00006710: 2074 6f74 616c 206e 756d 6265 7220 6f66   total number of
+00006720: 2074 6865 2064 6973 7469 6e63 7420 7265   the distinct re
+00006730: 636f 7264 732e 0a0a 2020 2020 4578 616d  cords...    Exam
+00006740: 706c 653a 0a0a 2020 2020 2020 2020 3e3e  ple:..        >>
+00006750: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00006760: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00006770: 5b5b 312c 2032 5d2c 205b 312c 2032 5d2c  [[1, 2], [1, 2],
+00006780: 205b 332c 204e 6f6e 655d 2c20 5b32 2c20   [3, None], [2, 
+00006790: 335d 2c20 5b33 2c20 4e6f 6e65 5d2c 205b  3], [3, None], [
+000067a0: 342c 204e 6f6e 655d 5d2c 2073 6368 656d  4, None]], schem
+000067b0: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+000067c0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000067d0: 6563 7428 636f 756e 745f 6469 7374 696e  ect(count_distin
+000067e0: 6374 2863 6f6c 2822 6122 292c 2063 6f6c  ct(col("a"), col
+000067f0: 2822 6222 2929 2e61 6c69 6173 2822 7265  ("b")).alias("re
+00006800: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00006810: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00006820: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00006830: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00006840: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00006850: 2020 2020 2020 7c32 2020 2020 2020 2020        |2        
+00006860: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00006870: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00006880: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+00006890: 2020 2020 3e3e 3e20 2320 2054 6865 2072      >>> #  The r
+000068a0: 6573 756c 7420 7368 6f75 6c64 2062 6520  esult should be 
+000068b0: 3220 666f 7220 7b5b 312c 325d 2c5b 322c  2 for {[1,2],[2,
+000068c0: 335d 7d20 7369 6e63 6520 7468 6520 7265  3]} since the re
+000068d0: 7374 2061 7265 2065 6974 6865 7220 6475  st are either du
+000068e0: 706c 6963 6174 6520 6f72 204e 554c 4c20  plicate or NULL 
+000068f0: 7265 636f 7264 730a 2020 2020 2222 220a  records.    """.
+00006900: 2020 2020 6373 203d 205b 5f74 6f5f 636f      cs = [_to_co
+00006910: 6c5f 6966 5f73 7472 2863 2c20 2263 6f75  l_if_str(c, "cou
+00006920: 6e74 5f64 6973 7469 6e63 7422 2920 666f  nt_distinct") fo
+00006930: 7220 6320 696e 2063 6f6c 735d 0a20 2020  r c in cols].   
+00006940: 2072 6574 7572 6e20 436f 6c75 6d6e 280a   return Column(.
+00006950: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+00006960: 4578 7072 6573 7369 6f6e 2822 636f 756e  Expression("coun
+00006970: 7422 2c20 5b63 2e5f 6578 7072 6573 7369  t", [c._expressi
+00006980: 6f6e 2066 6f72 2063 2069 6e20 6373 5d2c  on for c in cs],
+00006990: 2069 735f 6469 7374 696e 6374 3d54 7275   is_distinct=Tru
+000069a0: 6529 0a20 2020 2029 0a0a 0a64 6566 2063  e).    )...def c
+000069b0: 6f76 6172 5f70 6f70 2863 6f6c 756d 6e31  ovar_pop(column1
+000069c0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+000069d0: 636f 6c75 6d6e 323a 2043 6f6c 756d 6e4f  column2: ColumnO
+000069e0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+000069f0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+00006a00: 2074 6865 2070 6f70 756c 6174 696f 6e20   the population 
+00006a10: 636f 7661 7269 616e 6365 2066 6f72 206e  covariance for n
+00006a20: 6f6e 2d6e 756c 6c20 7061 6972 7320 696e  on-null pairs in
+00006a30: 2061 2067 726f 7570 2e0a 0a20 2020 2045   a group...    E
+00006a40: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00006a50: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00006a60: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00006a70: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
+00006a80: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+00006a90: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00006aa0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00006ab0: 5b31 2c20 325d 2c20 5b31 2c20 325d 2c20  [1, 2], [1, 2], 
+00006ac0: 5b34 2c20 355d 2c20 5b32 2c20 335d 2c20  [4, 5], [2, 3], 
+00006ad0: 5b33 2c20 4e6f 6e65 5d2c 205b 342c 204e  [3, None], [4, N
+00006ae0: 6f6e 655d 2c20 5b36 2c34 5d5d 2c20 7363  one], [6,4]], sc
+00006af0: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
+00006b00: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00006b10: 7365 6c65 6374 2863 6f76 6172 5f70 6f70  select(covar_pop
+00006b20: 2863 6f6c 2822 6122 292c 2063 6f6c 2822  (col("a"), col("
+00006b30: 6222 2929 2e63 6173 7428 4465 6369 6d61  b")).cast(Decima
+00006b40: 6c54 7970 6528 7363 616c 653d 3329 292e  lType(scale=3)).
+00006b50: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00006b60: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00006b70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00006b80: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00006b90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00006ba0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00006bb0: 312e 3834 3020 2020 2020 7c0a 2020 2020  1.840     |.    
+00006bc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00006bd0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00006be0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00006bf0: 2063 6f6c 3120 3d20 5f74 6f5f 636f 6c5f   col1 = _to_col_
+00006c00: 6966 5f73 7472 2863 6f6c 756d 6e31 2c20  if_str(column1, 
+00006c10: 2263 6f76 6172 5f70 6f70 2229 0a20 2020  "covar_pop").   
+00006c20: 2063 6f6c 3220 3d20 5f74 6f5f 636f 6c5f   col2 = _to_col_
+00006c30: 6966 5f73 7472 2863 6f6c 756d 6e32 2c20  if_str(column2, 
+00006c40: 2263 6f76 6172 5f70 6f70 2229 0a20 2020  "covar_pop").   
+00006c50: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00006c60: 2263 6f76 6172 5f70 6f70 2229 2863 6f6c  "covar_pop")(col
+00006c70: 312c 2063 6f6c 3229 0a0a 0a64 6566 2063  1, col2)...def c
+00006c80: 6f76 6172 5f73 616d 7028 636f 6c75 6d6e  ovar_samp(column
+00006c90: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
+00006ca0: 2063 6f6c 756d 6e32 3a20 436f 6c75 6d6e   column2: Column
+00006cb0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00006cc0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00006cd0: 7320 7468 6520 7361 6d70 6c65 2063 6f76  s the sample cov
+00006ce0: 6172 6961 6e63 6520 666f 7220 6e6f 6e2d  ariance for non-
+00006cf0: 6e75 6c6c 2070 6169 7273 2069 6e20 6120  null pairs in a 
+00006d00: 6772 6f75 702e 0a0a 2020 2020 4578 616d  group...    Exam
+00006d10: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00006d20: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+00006d30: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+00006d40: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
+00006d50: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00006d60: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00006d70: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+00006d80: 2032 5d2c 205b 312c 2032 5d2c 205b 342c   2], [1, 2], [4,
+00006d90: 2035 5d2c 205b 322c 2033 5d2c 205b 332c   5], [2, 3], [3,
+00006da0: 204e 6f6e 655d 2c20 5b34 2c20 4e6f 6e65   None], [4, None
+00006db0: 5d2c 205b 362c 345d 5d2c 2073 6368 656d  ], [6,4]], schem
+00006dc0: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+00006dd0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00006de0: 6563 7428 636f 7661 725f 7361 6d70 2863  ect(covar_samp(c
+00006df0: 6f6c 2822 6122 292c 2063 6f6c 2822 6222  ol("a"), col("b"
+00006e00: 2929 2e63 6173 7428 4465 6369 6d61 6c54  )).cast(DecimalT
+00006e10: 7970 6528 7363 616c 653d 3329 292e 616c  ype(scale=3)).al
+00006e20: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00006e30: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00006e40: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00006e50: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+00006e60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006e70: 2d2d 2d2d 0a20 2020 2020 2020 207c 322e  ----.        |2.
+00006e80: 3330 3020 2020 2020 7c0a 2020 2020 2020  300     |.      
+00006e90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00006ea0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00006eb0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+00006ec0: 6f6c 3120 3d20 5f74 6f5f 636f 6c5f 6966  ol1 = _to_col_if
+00006ed0: 5f73 7472 2863 6f6c 756d 6e31 2c20 2263  _str(column1, "c
+00006ee0: 6f76 6172 5f73 616d 7022 290a 2020 2020  ovar_samp").    
+00006ef0: 636f 6c32 203d 205f 746f 5f63 6f6c 5f69  col2 = _to_col_i
+00006f00: 665f 7374 7228 636f 6c75 6d6e 322c 2022  f_str(column2, "
+00006f10: 636f 7661 725f 7361 6d70 2229 0a20 2020  covar_samp").   
+00006f20: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00006f30: 2263 6f76 6172 5f73 616d 7022 2928 636f  "covar_samp")(co
+00006f40: 6c31 2c20 636f 6c32 290a 0a0a 6465 6620  l1, col2)...def 
+00006f50: 6b75 7274 6f73 6973 2865 3a20 436f 6c75  kurtosis(e: Colu
+00006f60: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00006f70: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00006f80: 2052 6574 7572 6e73 2074 6865 2070 6f70   Returns the pop
+00006f90: 756c 6174 696f 6e20 6578 6365 7373 206b  ulation excess k
+00006fa0: 7572 746f 7369 7320 6f66 206e 6f6e 2d4e  urtosis of non-N
+00006fb0: 554c 4c20 7265 636f 7264 732e 2049 6620  ULL records. If 
+00006fc0: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
+00006fd0: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00006fe0: 7265 204e 554c 4c2c 2074 6865 2066 756e  re NULL, the fun
+00006ff0: 6374 696f 6e20 7265 7475 726e 7320 4e55  ction returns NU
+00007000: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
+00007010: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00007020: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00007030: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+00007040: 7320 696d 706f 7274 206b 7572 746f 7369  s import kurtosi
+00007050: 730a 2020 2020 2020 2020 3e3e 3e20 6466  s.        >>> df
+00007060: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00007070: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+00007080: 332c 2031 302c 2031 2c20 335d 2c20 7363  3, 10, 1, 3], sc
+00007090: 6865 6d61 3d5b 2278 225d 290a 2020 2020  hema=["x"]).    
+000070a0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000070b0: 7428 6b75 7274 6f73 6973 2822 7822 292e  t(kurtosis("x").
+000070c0: 6173 5f28 2278 2229 292e 636f 6c6c 6563  as_("x")).collec
+000070d0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+000070e0: 2858 3d44 6563 696d 616c 2827 332e 3631  (X=Decimal('3.61
+000070f0: 3337 3336 3630 3939 3536 2729 295d 0a20  3736609956'))]. 
+00007100: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00007110: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00007120: 2022 6b75 7274 6f73 6973 2229 0a20 2020   "kurtosis").   
+00007130: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00007140: 226b 7572 746f 7369 7322 2928 6329 0a0a  "kurtosis")(c)..
+00007150: 0a64 6566 206d 6178 2865 3a20 436f 6c75  .def max(e: Colu
+00007160: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00007170: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00007180: 2052 6574 7572 6e73 2074 6865 206d 6178   Returns the max
+00007190: 696d 756d 2076 616c 7565 2066 6f72 2074  imum value for t
+000071a0: 6865 2072 6563 6f72 6473 2069 6e20 6120  he records in a 
+000071b0: 6772 6f75 702e 204e 554c 4c20 7661 6c75  group. NULL valu
+000071c0: 6573 2061 7265 2069 676e 6f72 6564 0a20  es are ignored. 
+000071d0: 2020 2075 6e6c 6573 7320 616c 6c20 7468     unless all th
+000071e0: 6520 7265 636f 7264 7320 6172 6520 4e55  e records are NU
+000071f0: 4c4c 2c20 696e 2077 6869 6368 2063 6173  LL, in which cas
+00007200: 6520 6120 4e55 4c4c 2076 616c 7565 2069  e a NULL value i
+00007210: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
+00007220: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00007230: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00007240: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00007250: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
+00007260: 2031 2c20 335d 2c20 7363 6865 6d61 3d5b   1, 3], schema=[
+00007270: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
+00007280: 3e20 6466 2e73 656c 6563 7428 6d61 7828  > df.select(max(
+00007290: 2278 2229 2e61 735f 2822 7822 2929 2e63  "x").as_("x")).c
+000072a0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000072b0: 205b 526f 7728 583d 3130 295d 0a20 2020   [Row(X=10)].   
+000072c0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000072d0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+000072e0: 6d61 7822 290a 2020 2020 7265 7475 726e  max").    return
+000072f0: 2062 7569 6c74 696e 2822 6d61 7822 2928   builtin("max")(
+00007300: 6329 0a0a 0a64 6566 206d 6561 6e28 653a  c)...def mean(e:
+00007310: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00007320: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00007330: 220a 2020 2020 5265 7475 726e 2074 6865  ".    Return the
+00007340: 2061 7665 7261 6765 2066 6f72 2074 6865   average for the
+00007350: 2073 7065 6369 6669 6320 6e75 6d65 7269   specific numeri
+00007360: 6320 636f 6c75 6d6e 732e 2041 6c69 6173  c columns. Alias
+00007370: 206f 6620 3a66 756e 633a 6061 7667 602e   of :func:`avg`.
+00007380: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00007390: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000073a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000073b0: 5f64 6174 6166 7261 6d65 285b 312c 2033  _dataframe([1, 3
+000073c0: 2c20 3130 2c20 312c 2033 5d2c 2073 6368  , 10, 1, 3], sch
+000073d0: 656d 613d 5b22 7822 5d29 0a20 2020 2020  ema=["x"]).     
+000073e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000073f0: 286d 6561 6e28 2278 2229 2e61 735f 2822  (mean("x").as_("
+00007400: 7822 2929 2e63 6f6c 6c65 6374 2829 0a20  x")).collect(). 
+00007410: 2020 2020 2020 205b 526f 7728 583d 4465         [Row(X=De
+00007420: 6369 6d61 6c28 2733 2e36 3030 3030 3027  cimal('3.600000'
+00007430: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+00007440: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00007450: 7472 2865 2c20 226d 6561 6e22 290a 2020  tr(e, "mean").  
+00007460: 2020 7265 7475 726e 2061 7667 2863 290a    return avg(c).
+00007470: 0a0a 6465 6620 6d65 6469 616e 2865 3a20  ..def median(e: 
+00007480: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00007490: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000074a0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
+000074b0: 206d 6564 6961 6e20 7661 6c75 6520 666f   median value fo
+000074c0: 7220 7468 6520 7265 636f 7264 7320 696e  r the records in
+000074d0: 2061 2067 726f 7570 2e20 4e55 4c4c 2076   a group. NULL v
+000074e0: 616c 7565 7320 6172 6520 6967 6e6f 7265  alues are ignore
+000074f0: 640a 2020 2020 756e 6c65 7373 2061 6c6c  d.    unless all
+00007500: 2074 6865 2072 6563 6f72 6473 2061 7265   the records are
+00007510: 204e 554c 4c2c 2069 6e20 7768 6963 6820   NULL, in which 
+00007520: 6361 7365 2061 204e 554c 4c20 7661 6c75  case a NULL valu
+00007530: 6520 6973 2072 6574 7572 6e65 642e 0a0a  e is returned...
+00007540: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00007550: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00007560: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00007570: 6174 6166 7261 6d65 285b 312c 2033 2c20  ataframe([1, 3, 
+00007580: 3130 2c20 312c 2033 5d2c 2073 6368 656d  10, 1, 3], schem
+00007590: 613d 5b22 7822 5d29 0a20 2020 2020 2020  a=["x"]).       
+000075a0: 203e 3e3e 2064 662e 7365 6c65 6374 286d   >>> df.select(m
+000075b0: 6564 6961 6e28 2278 2229 2e61 735f 2822  edian("x").as_("
+000075c0: 7822 2929 2e63 6f6c 6c65 6374 2829 0a20  x")).collect(). 
+000075d0: 2020 2020 2020 205b 526f 7728 583d 4465         [Row(X=De
+000075e0: 6369 6d61 6c28 2733 2e30 3030 2729 295d  cimal('3.000'))]
+000075f0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00007600: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00007610: 652c 2022 6d65 6469 616e 2229 0a20 2020  e, "median").   
+00007620: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00007630: 226d 6564 6961 6e22 2928 6329 0a0a 0a64  "median")(c)...d
+00007640: 6566 206d 696e 2865 3a20 436f 6c75 6d6e  ef min(e: Column
+00007650: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00007660: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00007670: 6574 7572 6e73 2074 6865 206d 696e 696d  eturns the minim
+00007680: 756d 2076 616c 7565 2066 6f72 2074 6865  um value for the
+00007690: 2072 6563 6f72 6473 2069 6e20 6120 6772   records in a gr
+000076a0: 6f75 702e 204e 554c 4c20 7661 6c75 6573  oup. NULL values
+000076b0: 2061 7265 2069 676e 6f72 6564 0a20 2020   are ignored.   
+000076c0: 2075 6e6c 6573 7320 616c 6c20 7468 6520   unless all the 
+000076d0: 7265 636f 7264 7320 6172 6520 4e55 4c4c  records are NULL
+000076e0: 2c20 696e 2077 6869 6368 2063 6173 6520  , in which case 
+000076f0: 6120 4e55 4c4c 2076 616c 7565 2069 7320  a NULL value is 
+00007700: 7265 7475 726e 6564 2e0a 0a20 2020 2045  returned...    E
+00007710: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00007720: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00007730: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00007740: 616d 6528 5b31 2c20 332c 2031 302c 2031  ame([1, 3, 10, 1
+00007750: 2c20 335d 2c20 7363 6865 6d61 3d5b 2278  , 3], schema=["x
+00007760: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00007770: 6466 2e73 656c 6563 7428 6d69 6e28 2278  df.select(min("x
+00007780: 2229 2e61 735f 2822 7822 2929 2e63 6f6c  ").as_("x")).col
+00007790: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000077a0: 526f 7728 583d 3129 5d0a 2020 2020 2222  Row(X=1)].    ""
+000077b0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+000077c0: 6c5f 6966 5f73 7472 2865 2c20 226d 696e  l_if_str(e, "min
+000077d0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+000077e0: 696c 7469 6e28 226d 696e 2229 2863 290a  iltin("min")(c).
+000077f0: 0a0a 6465 6620 6d6f 6465 2865 3a20 436f  ..def mode(e: Co
+00007800: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00007810: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00007820: 2020 2052 6574 7572 6e73 2074 6865 206d     Returns the m
+00007830: 6f73 7420 6672 6571 7565 6e74 2076 616c  ost frequent val
+00007840: 7565 2066 6f72 2074 6865 2072 6563 6f72  ue for the recor
+00007850: 6473 2069 6e20 6120 6772 6f75 702e 204e  ds in a group. N
+00007860: 554c 4c20 7661 6c75 6573 2061 7265 2069  ULL values are i
+00007870: 676e 6f72 6564 2e0a 2020 2020 4966 2061  gnored..    If a
+00007880: 6c6c 2074 6865 2076 616c 7565 7320 6172  ll the values ar
+00007890: 6520 4e55 4c4c 2c20 6f72 2074 6865 7265  e NULL, or there
+000078a0: 2061 7265 2030 2072 6f77 732c 2074 6865   are 0 rows, the
+000078b0: 6e20 7468 6520 6675 6e63 7469 6f6e 2072  n the function r
+000078c0: 6574 7572 6e73 204e 554c 4c2e 0a0a 2020  eturns NULL...  
+000078d0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+000078e0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000078f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00007900: 6166 7261 6d65 285b 312c 2033 2c20 3130  aframe([1, 3, 10
+00007910: 2c20 312c 2034 5d2c 2073 6368 656d 613d  , 1, 4], schema=
+00007920: 5b22 7822 5d29 0a20 2020 2020 2020 203e  ["x"]).        >
+00007930: 3e3e 2064 662e 7365 6c65 6374 286d 6f64  >> df.select(mod
+00007940: 6528 2278 2229 2e61 735f 2822 7822 2929  e("x").as_("x"))
+00007950: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00007960: 2020 205b 526f 7728 583d 3129 5d0a 2020     [Row(X=1)].  
+00007970: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00007980: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00007990: 226d 6f64 6522 290a 2020 2020 7265 7475  "mode").    retu
+000079a0: 726e 2062 7569 6c74 696e 2822 6d6f 6465  rn builtin("mode
+000079b0: 2229 2863 290a 0a0a 6465 6620 736b 6577  ")(c)...def skew
+000079c0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+000079d0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000079e0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+000079f0: 7361 6d70 6c65 2073 6b65 776e 6573 7320  sample skewness 
+00007a00: 6f66 206e 6f6e 2d4e 554c 4c20 7265 636f  of non-NULL reco
+00007a10: 7264 732e 2049 6620 616c 6c20 7265 636f  rds. If all reco
+00007a20: 7264 7320 696e 7369 6465 2061 2067 726f  rds inside a gro
+00007a30: 7570 0a20 2020 2061 7265 204e 554c 4c2c  up.    are NULL,
+00007a40: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+00007a50: 7475 726e 7320 4e55 4c4c 2e0a 0a20 2020  turns NULL...   
+00007a60: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00007a70: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00007a80: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+00007a90: 7970 6573 2069 6d70 6f72 7420 4465 6369  ypes import Deci
+00007aa0: 6d61 6c54 7970 650a 2020 2020 2020 2020  malType.        
+00007ab0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00007ac0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00007ad0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+00007ae0: 2020 205b 3130 2c20 3130 2c20 3230 2c20     [10, 10, 20, 
+00007af0: 3235 2c20 3330 5d2c 0a20 2020 2020 2020  25, 30],.       
+00007b00: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00007b10: 5b22 6122 5d0a 2020 2020 2020 2020 2e2e  ["a"].        ..
+00007b20: 2e20 292e 7365 6c65 6374 2873 6b65 7728  . ).select(skew(
+00007b30: 2261 2229 2e63 6173 7428 4465 6369 6d61  "a").cast(Decima
+00007b40: 6c54 7970 6528 7363 616c 653d 3429 2929  lType(scale=4)))
+00007b50: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00007b60: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00007b70: 2020 5b52 6f77 2843 4153 5420 2853 4b45    [Row(CAST (SKE
+00007b80: 5728 2241 2229 2041 5320 4e55 4d42 4552  W("A") AS NUMBER
+00007b90: 2833 382c 2034 2929 3d44 6563 696d 616c  (38, 4))=Decimal
+00007ba0: 2827 302e 3035 3234 2729 295d 0a20 2020  ('0.0524'))].   
+00007bb0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00007bc0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00007bd0: 736b 6577 2229 0a20 2020 2072 6574 7572  skew").    retur
+00007be0: 6e20 6275 696c 7469 6e28 2273 6b65 7722  n builtin("skew"
+00007bf0: 2928 6329 0a0a 0a64 6566 2073 7464 6465  )(c)...def stdde
+00007c00: 7628 653a 2043 6f6c 756d 6e4f 724e 616d  v(e: ColumnOrNam
+00007c10: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00007c20: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+00007c30: 2073 616d 706c 6520 7374 616e 6461 7264   sample standard
+00007c40: 2064 6576 6961 7469 6f6e 2028 7371 7561   deviation (squa
+00007c50: 7265 2072 6f6f 7420 6f66 2073 616d 706c  re root of sampl
+00007c60: 6520 7661 7269 616e 6365 2920 6f66 0a20  e variance) of. 
+00007c70: 2020 206e 6f6e 2d4e 554c 4c20 7661 6c75     non-NULL valu
+00007c80: 6573 2e20 4966 2061 6c6c 2072 6563 6f72  es. If all recor
+00007c90: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
+00007ca0: 7020 6172 6520 4e55 4c4c 2c20 7265 7475  p are NULL, retu
+00007cb0: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
+00007cc0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00007cd0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00007ce0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+00007cf0: 6573 2069 6d70 6f72 7420 4465 6369 6d61  es import Decima
+00007d00: 6c54 7970 650a 2020 2020 2020 2020 3e3e  lType.        >>
+00007d10: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00007d20: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00007d30: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00007d40: 205b 342c 2039 5d2c 0a20 2020 2020 2020   [4, 9],.       
+00007d50: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00007d60: 5b22 4e22 5d2c 0a20 2020 2020 2020 202e  ["N"],.        .
+00007d70: 2e2e 2029 2e73 656c 6563 7428 7374 6464  .. ).select(stdd
+00007d80: 6576 2863 6f6c 2822 4e22 2929 2e63 6173  ev(col("N")).cas
+00007d90: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
+00007da0: 616c 653d 3429 2929 0a20 2020 2020 2020  ale=4))).       
+00007db0: 203e 3e3e 2064 662e 636f 6c6c 6563 7428   >>> df.collect(
+00007dc0: 290a 2020 2020 2020 2020 5b52 6f77 2843  ).        [Row(C
+00007dd0: 4153 5420 2853 5444 4445 5628 224e 2229  AST (STDDEV("N")
+00007de0: 2041 5320 4e55 4d42 4552 2833 382c 2034   AS NUMBER(38, 4
+00007df0: 2929 3d44 6563 696d 616c 2827 332e 3533  ))=Decimal('3.53
+00007e00: 3535 2729 295d 0a20 2020 2022 2222 0a20  55'))].    """. 
+00007e10: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00007e20: 665f 7374 7228 652c 2022 7374 6464 6576  f_str(e, "stddev
+00007e30: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00007e40: 696c 7469 6e28 2273 7464 6465 7622 2928  iltin("stddev")(
+00007e50: 6329 0a0a 0a64 6566 2073 7464 6465 765f  c)...def stddev_
+00007e60: 7361 6d70 2865 3a20 436f 6c75 6d6e 4f72  samp(e: ColumnOr
+00007e70: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00007e80: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00007e90: 7468 6520 7361 6d70 6c65 2073 7461 6e64  the sample stand
+00007ea0: 6172 6420 6465 7669 6174 696f 6e20 2873  ard deviation (s
+00007eb0: 7175 6172 6520 726f 6f74 206f 6620 7361  quare root of sa
+00007ec0: 6d70 6c65 2076 6172 6961 6e63 6529 206f  mple variance) o
+00007ed0: 660a 2020 2020 6e6f 6e2d 4e55 4c4c 2076  f.    non-NULL v
+00007ee0: 616c 7565 732e 2049 6620 616c 6c20 7265  alues. If all re
+00007ef0: 636f 7264 7320 696e 7369 6465 2061 2067  cords inside a g
+00007f00: 726f 7570 2061 7265 204e 554c 4c2c 2072  roup are NULL, r
+00007f10: 6574 7572 6e73 204e 554c 4c2e 2041 6c69  eturns NULL. Ali
+00007f20: 6173 206f 660a 2020 2020 3a66 756e 633a  as of.    :func:
+00007f30: 6073 7464 6465 7660 2e0a 0a20 2020 2045  `stddev`...    E
+00007f40: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00007f50: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00007f60: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+00007f70: 6573 2069 6d70 6f72 7420 4465 6369 6d61  es import Decima
+00007f80: 6c54 7970 650a 2020 2020 2020 2020 3e3e  lType.        >>
+00007f90: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00007fa0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00007fb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00007fc0: 205b 342c 2039 5d2c 0a20 2020 2020 2020   [4, 9],.       
+00007fd0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00007fe0: 5b22 4e22 5d2c 0a20 2020 2020 2020 202e  ["N"],.        .
+00007ff0: 2e2e 2029 2e73 656c 6563 7428 7374 6464  .. ).select(stdd
+00008000: 6576 5f73 616d 7028 636f 6c28 224e 2229  ev_samp(col("N")
+00008010: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
+00008020: 7065 2873 6361 6c65 3d34 2929 290a 2020  pe(scale=4))).  
+00008030: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+00008040: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00008050: 526f 7728 4341 5354 2028 5354 4444 4556  Row(CAST (STDDEV
+00008060: 5f53 414d 5028 224e 2229 2041 5320 4e55  _SAMP("N") AS NU
+00008070: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+00008080: 696d 616c 2827 332e 3533 3535 2729 295d  imal('3.5355'))]
+00008090: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+000080a0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+000080b0: 652c 2022 7374 6464 6576 5f73 616d 7022  e, "stddev_samp"
+000080c0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+000080d0: 6c74 696e 2822 7374 6464 6576 5f73 616d  ltin("stddev_sam
+000080e0: 7022 2928 6329 0a0a 0a64 6566 2073 7464  p")(c)...def std
+000080f0: 6465 765f 706f 7028 653a 2043 6f6c 756d  dev_pop(e: Colum
+00008100: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00008110: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00008120: 6e73 2074 6865 2070 6f70 756c 6174 696f  ns the populatio
+00008130: 6e20 7374 616e 6461 7264 2064 6576 6961  n standard devia
+00008140: 7469 6f6e 2028 7371 7561 7265 2072 6f6f  tion (square roo
+00008150: 7420 6f66 2076 6172 6961 6e63 6529 206f  t of variance) o
+00008160: 6620 6e6f 6e2d 4e55 4c4c 0a20 2020 2076  f non-NULL.    v
+00008170: 616c 7565 732e 2049 6620 616c 6c20 7265  alues. If all re
+00008180: 636f 7264 7320 696e 7369 6465 2061 2067  cords inside a g
+00008190: 726f 7570 2061 7265 204e 554c 4c2c 2072  roup are NULL, r
+000081a0: 6574 7572 6e73 204e 554c 4c2e 0a0a 2020  eturns NULL...  
+000081b0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+000081c0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000081d0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000081e0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+000081f0: 2e2e 2020 2020 205b 342c 2039 5d2c 0a20  ..     [4, 9],. 
+00008200: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+00008210: 6368 656d 613d 5b22 4e22 5d2c 0a20 2020  chema=["N"],.   
+00008220: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
+00008230: 7428 7374 6464 6576 5f70 6f70 2863 6f6c  t(stddev_pop(col
+00008240: 2822 4e22 2929 290a 2020 2020 2020 2020  ("N"))).        
+00008250: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+00008260: 0a20 2020 2020 2020 205b 526f 7728 5354  .        [Row(ST
+00008270: 4444 4556 5f50 4f50 2822 4e22 293d 322e  DDEV_POP("N")=2.
+00008280: 3529 5d0a 2020 2020 2222 220a 2020 2020  5)].    """.    
+00008290: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000082a0: 7472 2865 2c20 2273 7464 6465 765f 706f  tr(e, "stddev_po
+000082b0: 7022 290a 2020 2020 7265 7475 726e 2062  p").    return b
+000082c0: 7569 6c74 696e 2822 7374 6464 6576 5f70  uiltin("stddev_p
+000082d0: 6f70 2229 2863 290a 0a0a 6465 6620 7375  op")(c)...def su
+000082e0: 6d28 653a 2043 6f6c 756d 6e4f 724e 616d  m(e: ColumnOrNam
+000082f0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00008300: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+00008310: 2073 756d 206f 6620 6e6f 6e2d 4e55 4c4c   sum of non-NULL
+00008320: 2072 6563 6f72 6473 2069 6e20 6120 6772   records in a gr
+00008330: 6f75 702e 2059 6f75 2063 616e 2075 7365  oup. You can use
+00008340: 2074 6865 2044 4953 5449 4e43 5420 6b65   the DISTINCT ke
+00008350: 7977 6f72 640a 2020 2020 746f 2063 6f6d  yword.    to com
+00008360: 7075 7465 2074 6865 2073 756d 206f 6620  pute the sum of 
+00008370: 756e 6971 7565 206e 6f6e 2d6e 756c 6c20  unique non-null 
+00008380: 7661 6c75 6573 2e20 4966 2061 6c6c 2072  values. If all r
+00008390: 6563 6f72 6473 2069 6e73 6964 6520 6120  ecords inside a 
+000083a0: 6772 6f75 7020 6172 650a 2020 2020 4e55  group are.    NU
+000083b0: 4c4c 2c20 7468 6520 6675 6e63 7469 6f6e  LL, the function
+000083c0: 2072 6574 7572 6e73 204e 554c 4c2e 0a0a   returns NULL...
+000083d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+000083e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000083f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00008400: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+00008410: 202e 2e2e 2020 2020 205b 342c 2039 5d2c   ...     [4, 9],
+00008420: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00008430: 2073 6368 656d 613d 5b22 4e22 5d2c 0a20   schema=["N"],. 
+00008440: 2020 2020 2020 202e 2e2e 2029 2e73 656c         ... ).sel
+00008450: 6563 7428 7375 6d28 636f 6c28 224e 2229  ect(sum(col("N")
+00008460: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
+00008470: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+00008480: 2020 2020 5b52 6f77 2853 554d 2822 4e22      [Row(SUM("N"
+00008490: 293d 3133 295d 0a20 2020 2022 2222 0a20  )=13)].    """. 
+000084a0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+000084b0: 665f 7374 7228 652c 2022 7375 6d22 290a  f_str(e, "sum").
+000084c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000084d0: 696e 2822 7375 6d22 2928 6329 0a0a 0a64  in("sum")(c)...d
+000084e0: 6566 2073 756d 5f64 6973 7469 6e63 7428  ef sum_distinct(
+000084f0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+00008500: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00008510: 2222 2252 6574 7572 6e73 2074 6865 2073  """Returns the s
+00008520: 756d 206f 6620 6e6f 6e2d 4e55 4c4c 2064  um of non-NULL d
+00008530: 6973 7469 6e63 7420 7265 636f 7264 7320  istinct records 
+00008540: 696e 2061 2067 726f 7570 2e20 596f 7520  in a group. You 
+00008550: 6361 6e20 7573 6520 7468 650a 2020 2020  can use the.    
+00008560: 4449 5354 494e 4354 206b 6579 776f 7264  DISTINCT keyword
+00008570: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00008580: 7375 6d20 6f66 2075 6e69 7175 6520 6e6f  sum of unique no
+00008590: 6e2d 6e75 6c6c 2076 616c 7565 732e 2049  n-null values. I
+000085a0: 6620 616c 6c20 7265 636f 7264 730a 2020  f all records.  
+000085b0: 2020 696e 7369 6465 2061 2067 726f 7570    inside a group
+000085c0: 2061 7265 204e 554c 4c2c 2074 6865 2066   are NULL, the f
+000085d0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+000085e0: 4e55 4c4c 2e0a 0a20 2020 2045 7861 6d70  NULL...    Examp
+000085f0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00008600: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00008610: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00008620: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00008630: 5b31 2c20 322c 204e 6f6e 652c 2033 5d2c  [1, 2, None, 3],
+00008640: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00008650: 2073 6368 656d 613d 5b22 4e22 5d2c 0a20   schema=["N"],. 
+00008660: 2020 2020 2020 202e 2e2e 2029 2e73 656c         ... ).sel
+00008670: 6563 7428 7375 6d5f 6469 7374 696e 6374  ect(sum_distinct
+00008680: 2863 6f6c 2822 4e22 2929 290a 2020 2020  (col("N"))).    
+00008690: 2020 2020 3e3e 3e20 6466 2e63 6f6c 6c65      >>> df.colle
+000086a0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+000086b0: 7728 5355 4d28 2044 4953 5449 4e43 5420  w(SUM( DISTINCT 
+000086c0: 224e 2229 3d36 295d 0a20 2020 2022 2222  "N")=6)].    """
+000086d0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000086e0: 5f69 665f 7374 7228 652c 2022 7375 6d5f  _if_str(e, "sum_
+000086f0: 6469 7374 696e 6374 2229 0a20 2020 2072  distinct").    r
+00008700: 6574 7572 6e20 5f63 616c 6c5f 6675 6e63  eturn _call_func
+00008710: 7469 6f6e 2822 7375 6d22 2c20 5472 7565  tion("sum", True
+00008720: 2c20 6329 0a0a 0a64 6566 2076 6172 6961  , c)...def varia
+00008730: 6e63 6528 653a 2043 6f6c 756d 6e4f 724e  nce(e: ColumnOrN
+00008740: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00008750: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00008760: 6865 2073 616d 706c 6520 7661 7269 616e  he sample varian
+00008770: 6365 206f 6620 6e6f 6e2d 4e55 4c4c 2072  ce of non-NULL r
+00008780: 6563 6f72 6473 2069 6e20 6120 6772 6f75  ecords in a grou
+00008790: 702e 2049 6620 616c 6c20 7265 636f 7264  p. If all record
+000087a0: 730a 2020 2020 696e 7369 6465 2061 2067  s.    inside a g
+000087b0: 726f 7570 2061 7265 204e 554c 4c2c 2061  roup are NULL, a
+000087c0: 204e 554c 4c20 6973 2072 6574 7572 6e65   NULL is returne
+000087d0: 642e 2046 6f72 2061 2073 696e 676c 6520  d. For a single 
+000087e0: 726f 772c 204e 554c 4c20 6973 2072 6574  row, NULL is ret
+000087f0: 7572 6e65 6420 6173 2073 616d 706c 6520  urned as sample 
+00008800: 7661 7269 616e 6365 2e0a 0a20 2020 2045  variance...    E
+00008810: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00008820: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00008830: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00008840: 616d 6528 5b31 2c20 2d31 2c20 312c 202d  ame([1, -1, 1, -
+00008850: 312c 202d 315d 2c20 7363 6865 6d61 3d5b  1, -1], schema=[
+00008860: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00008870: 3e20 6466 2e73 656c 6563 7428 7661 7269  > df.select(vari
+00008880: 616e 6365 2863 6f6c 2822 6122 2929 292e  ance(col("a"))).
+00008890: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000088a0: 2020 5b52 6f77 2856 4152 4941 4e43 4528    [Row(VARIANCE(
+000088b0: 2241 2229 3d44 6563 696d 616c 2827 312e  "A")=Decimal('1.
+000088c0: 3230 3030 3030 2729 295d 0a0a 2020 2020  200000'))]..    
+000088d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000088e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000088f0: 6672 616d 6528 5b31 2c20 4e6f 6e65 2c20  frame([1, None, 
+00008900: 322c 2033 2c20 4e6f 6e65 2c20 352c 2036  2, 3, None, 5, 6
+00008910: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00008920: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00008930: 7365 6c65 6374 2876 6172 6961 6e63 6528  select(variance(
+00008940: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
+00008950: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00008960: 7728 5641 5249 414e 4345 2822 4122 293d  w(VARIANCE("A")=
+00008970: 4465 6369 6d61 6c28 2734 2e33 3030 3030  Decimal('4.30000
+00008980: 3027 2929 5d0a 0a20 2020 2020 2020 203e  0'))]..        >
+00008990: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000089a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000089b0: 285b 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  ([None, None, No
+000089c0: 6e65 5d2c 2073 6368 656d 613d 5b22 6122  ne], schema=["a"
+000089d0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+000089e0: 662e 7365 6c65 6374 2876 6172 6961 6e63  f.select(varianc
+000089f0: 6528 636f 6c28 2261 2229 2929 2e63 6f6c  e(col("a"))).col
+00008a00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00008a10: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
+00008a20: 293d 4e6f 6e65 295d 0a0a 2020 2020 2020  )=None)]..      
+00008a30: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00008a40: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00008a50: 616d 6528 5b34 325d 2c20 7363 6865 6d61  ame([42], schema
+00008a60: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00008a70: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
+00008a80: 7269 616e 6365 2863 6f6c 2822 6122 2929  riance(col("a"))
+00008a90: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00008aa0: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
+00008ab0: 4528 2241 2229 3d4e 6f6e 6529 5d0a 0a20  E("A")=None)].. 
+00008ac0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00008ad0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00008ae0: 2022 7661 7269 616e 6365 2229 0a20 2020   "variance").   
+00008af0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00008b00: 2276 6172 6961 6e63 6522 2928 6329 0a0a  "variance")(c)..
+00008b10: 0a64 6566 2076 6172 5f73 616d 7028 653a  .def var_samp(e:
+00008b20: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00008b30: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00008b40: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
+00008b50: 706c 6520 7661 7269 616e 6365 206f 6620  ple variance of 
+00008b60: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
+00008b70: 2069 6e20 6120 6772 6f75 702e 2049 6620   in a group. If 
+00008b80: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
+00008b90: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00008ba0: 7265 204e 554c 4c2c 2061 204e 554c 4c20  re NULL, a NULL 
+00008bb0: 6973 2072 6574 7572 6e65 642e 2046 6f72  is returned. For
+00008bc0: 2061 2073 696e 676c 6520 726f 772c 204e   a single row, N
+00008bd0: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
+00008be0: 6173 2073 616d 706c 6520 7661 7269 616e  as sample varian
+00008bf0: 6365 2e0a 2020 2020 416c 6961 7320 6f66  ce..    Alias of
+00008c00: 203a 6675 6e63 3a60 7661 7269 616e 6365   :func:`variance
+00008c10: 600a 0a20 2020 2045 7861 6d70 6c65 3a3a  `..    Example::
+00008c20: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00008c30: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00008c40: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+00008c50: 2d31 2c20 312c 202d 312c 202d 315d 2c20  -1, 1, -1, -1], 
+00008c60: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00008c70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00008c80: 6563 7428 7661 725f 7361 6d70 2863 6f6c  ect(var_samp(col
+00008c90: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00008ca0: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+00008cb0: 4152 4941 4e43 4528 2241 2229 3d44 6563  ARIANCE("A")=Dec
+00008cc0: 696d 616c 2827 312e 3230 3030 3030 2729  imal('1.200000')
+00008cd0: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
+00008ce0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00008cf0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+00008d00: 2c20 4e6f 6e65 2c20 322c 2033 2c20 4e6f  , None, 2, 3, No
+00008d10: 6e65 2c20 352c 2036 5d2c 2073 6368 656d  ne, 5, 6], schem
+00008d20: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00008d30: 203e 3e3e 2064 662e 7365 6c65 6374 2876   >>> df.select(v
+00008d40: 6172 5f73 616d 7028 636f 6c28 2261 2229  ar_samp(col("a")
+00008d50: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00008d60: 2020 2020 205b 526f 7728 5641 5249 414e       [Row(VARIAN
+00008d70: 4345 2822 4122 293d 4465 6369 6d61 6c28  CE("A")=Decimal(
+00008d80: 2734 2e33 3030 3030 3027 2929 5d0a 0a20  '4.300000'))].. 
+00008d90: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00008da0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00008db0: 6174 6166 7261 6d65 285b 4e6f 6e65 2c20  ataframe([None, 
+00008dc0: 4e6f 6e65 2c20 4e6f 6e65 5d2c 2073 6368  None, None], sch
+00008dd0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00008de0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00008df0: 2876 6172 5f73 616d 7028 636f 6c28 2261  (var_samp(col("a
+00008e00: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+00008e10: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
+00008e20: 414e 4345 2822 4122 293d 4e6f 6e65 295d  ANCE("A")=None)]
+00008e30: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00008e40: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00008e50: 655f 6461 7461 6672 616d 6528 5b34 325d  e_dataframe([42]
+00008e60: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00008e70: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00008e80: 656c 6563 7428 7661 725f 7361 6d70 2863  elect(var_samp(c
+00008e90: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
+00008ea0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00008eb0: 2856 4152 4941 4e43 4528 2241 2229 3d4e  (VARIANCE("A")=N
+00008ec0: 6f6e 6529 5d0a 0a20 2020 2022 2222 0a20  one)]..    """. 
+00008ed0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00008ee0: 665f 7374 7228 652c 2022 7661 725f 7361  f_str(e, "var_sa
+00008ef0: 6d70 2229 0a20 2020 2072 6574 7572 6e20  mp").    return 
+00008f00: 7661 7269 616e 6365 2863 290a 0a0a 6465  variance(c)...de
+00008f10: 6620 7661 725f 706f 7028 653a 2043 6f6c  f var_pop(e: Col
+00008f20: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00008f30: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00008f40: 7572 6e73 2074 6865 2070 6f70 756c 6174  urns the populat
+00008f50: 696f 6e20 7661 7269 616e 6365 206f 6620  ion variance of 
+00008f60: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
+00008f70: 2069 6e20 6120 6772 6f75 702e 2049 6620   in a group. If 
+00008f80: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
+00008f90: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00008fa0: 7265 204e 554c 4c2c 2061 204e 554c 4c20  re NULL, a NULL 
+00008fb0: 6973 2072 6574 7572 6e65 642e 2054 6865  is returned. The
+00008fc0: 2070 6f70 756c 6174 696f 6e20 7661 7269   population vari
+00008fd0: 616e 6365 206f 6620 6120 7369 6e67 6c65  ance of a single
+00008fe0: 2072 6f77 2069 7320 302e 302e 0a0a 2020   row is 0.0...  
+00008ff0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00009000: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00009010: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00009020: 6166 7261 6d65 285b 312c 202d 312c 2031  aframe([1, -1, 1
+00009030: 2c20 2d31 2c20 2d31 5d2c 2073 6368 656d  , -1, -1], schem
+00009040: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00009050: 203e 3e3e 2064 662e 7365 6c65 6374 2876   >>> df.select(v
+00009060: 6172 5f70 6f70 2863 6f6c 2822 6122 2929  ar_pop(col("a"))
+00009070: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00009080: 2020 2020 5b52 6f77 2856 4152 5f50 4f50      [Row(VAR_POP
+00009090: 2822 4122 293d 4465 6369 6d61 6c28 2730  ("A")=Decimal('0
+000090a0: 2e39 3630 3030 3027 2929 5d0a 0a20 2020  .960000'))]..   
+000090b0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000090c0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000090d0: 6166 7261 6d65 285b 312c 204e 6f6e 652c  aframe([1, None,
+000090e0: 2032 2c20 332c 204e 6f6e 652c 2035 2c20   2, 3, None, 5, 
+000090f0: 365d 2c20 7363 6865 6d61 3d5b 2261 225d  6], schema=["a"]
+00009100: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00009110: 2e73 656c 6563 7428 7661 725f 706f 7028  .select(var_pop(
+00009120: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
+00009130: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00009140: 7728 5641 525f 504f 5028 2241 2229 3d44  w(VAR_POP("A")=D
+00009150: 6563 696d 616c 2827 332e 3434 3030 3030  ecimal('3.440000
+00009160: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
+00009170: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00009180: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00009190: 5b4e 6f6e 652c 204e 6f6e 652c 204e 6f6e  [None, None, Non
+000091a0: 655d 2c20 7363 6865 6d61 3d5b 2261 225d  e], schema=["a"]
+000091b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000091c0: 2e73 656c 6563 7428 7661 725f 706f 7028  .select(var_pop(
+000091d0: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
+000091e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+000091f0: 7728 5641 525f 504f 5028 2241 2229 3d4e  w(VAR_POP("A")=N
+00009200: 6f6e 6529 5d0a 0a20 2020 2020 2020 203e  one)]..        >
+00009210: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00009220: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00009230: 285b 3432 5d2c 2073 6368 656d 613d 5b22  ([42], schema=["
+00009240: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00009250: 2064 662e 7365 6c65 6374 2876 6172 5f70   df.select(var_p
+00009260: 6f70 2863 6f6c 2822 6122 2929 292e 636f  op(col("a"))).co
+00009270: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00009280: 5b52 6f77 2856 4152 5f50 4f50 2822 4122  [Row(VAR_POP("A"
+00009290: 293d 4465 6369 6d61 6c28 2730 2e30 3030  )=Decimal('0.000
+000092a0: 3030 3027 2929 5d0a 0a20 2020 2022 2222  000'))]..    """
+000092b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000092c0: 5f69 665f 7374 7228 652c 2022 7661 725f  _if_str(e, "var_
+000092d0: 706f 7022 290a 2020 2020 7265 7475 726e  pop").    return
+000092e0: 2062 7569 6c74 696e 2822 7661 725f 706f   builtin("var_po
+000092f0: 7022 2928 6329 0a0a 0a64 6566 2061 7070  p")(c)...def app
+00009300: 726f 785f 7065 7263 656e 7469 6c65 2863  rox_percentile(c
+00009310: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+00009320: 2c20 7065 7263 656e 7469 6c65 3a20 666c  , percentile: fl
+00009330: 6f61 7429 202d 3e20 436f 6c75 6d6e 3a0a  oat) -> Column:.
+00009340: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+00009350: 6e20 6170 7072 6f78 696d 6174 6564 2076  n approximated v
+00009360: 616c 7565 2066 6f72 2074 6865 2064 6573  alue for the des
+00009370: 6972 6564 2070 6572 6365 6e74 696c 652e  ired percentile.
+00009380: 2054 6869 7320 6675 6e63 7469 6f6e 2075   This function u
+00009390: 7365 7320 7468 6520 742d 4469 6765 7374  ses the t-Digest
+000093a0: 2061 6c67 6f72 6974 686d 2e0a 0a20 2020   algorithm...   
+000093b0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+000093c0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000093d0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000093e0: 7261 6d65 285b 302c 312c 322c 332c 342c  rame([0,1,2,3,4,
+000093f0: 352c 362c 372c 382c 395d 2c20 7363 6865  5,6,7,8,9], sche
+00009400: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+00009410: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00009420: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
+00009430: 6528 2261 222c 2030 2e35 292e 616c 6961  e("a", 0.5).alia
+00009440: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00009450: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00009460: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00009470: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00009480: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00009490: 2d2d 0a20 2020 2020 2020 207c 342e 3520  --.        |4.5 
+000094a0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+000094b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000094c0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+000094d0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+000094e0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+000094f0: 636f 6c2c 2022 6170 7072 6f78 5f70 6572  col, "approx_per
+00009500: 6365 6e74 696c 6522 290a 2020 2020 7265  centile").    re
+00009510: 7475 726e 2062 7569 6c74 696e 2822 6170  turn builtin("ap
+00009520: 7072 6f78 5f70 6572 6365 6e74 696c 6522  prox_percentile"
+00009530: 2928 632c 206c 6974 2870 6572 6365 6e74  )(c, lit(percent
+00009540: 696c 6529 290a 0a0a 6465 6620 6170 7072  ile))...def appr
+00009550: 6f78 5f70 6572 6365 6e74 696c 655f 6163  ox_percentile_ac
+00009560: 6375 6d75 6c61 7465 2863 6f6c 3a20 436f  cumulate(col: Co
+00009570: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00009580: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00009590: 7475 726e 7320 7468 6520 696e 7465 726e  turns the intern
+000095a0: 616c 2072 6570 7265 7365 6e74 6174 696f  al representatio
+000095b0: 6e20 6f66 2074 6865 2074 2d44 6967 6573  n of the t-Diges
+000095c0: 7420 7374 6174 6520 2861 7320 6120 4a53  t state (as a JS
+000095d0: 4f4e 206f 626a 6563 7429 2061 7420 7468  ON object) at th
+000095e0: 6520 656e 6420 6f66 2061 6767 7265 6761  e end of aggrega
+000095f0: 7469 6f6e 2e0a 2020 2020 5468 6973 2066  tion..    This f
+00009600: 756e 6374 696f 6e20 7573 6573 2074 6865  unction uses the
+00009610: 2074 2d44 6967 6573 7420 616c 676f 7269   t-Digest algori
+00009620: 7468 6d2e 0a0a 2020 2020 4578 616d 706c  thm...    Exampl
+00009630: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00009640: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00009650: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+00009660: 2c32 2c33 2c34 2c35 5d2c 2073 6368 656d  ,2,3,4,5], schem
+00009670: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00009680: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+00009690: 7070 726f 785f 7065 7263 656e 7469 6c65  pprox_percentile
+000096a0: 5f61 6363 756d 756c 6174 6528 2261 2229  _accumulate("a")
+000096b0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+000096c0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+000096d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000096e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000096f0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00009700: 2220 2020 2020 2020 2020 2020 2020 2020  "               
+00009710: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00009720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00009740: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
+00009750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009760: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+00009770: 2273 7461 7465 223a 205b 2020 2020 2020  "state": [      
+00009780: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00009790: 2020 2020 7c20 2020 2031 2e30 3030 3030      |    1.00000
+000097a0: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
+000097b0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+000097c0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
+000097d0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+000097e0: 2020 7c20 2020 2032 2e30 3030 3030 3030    |    2.0000000
+000097f0: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+00009800: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
+00009810: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+00009820: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
+00009830: 7c20 2020 2033 2e30 3030 3030 3030 3030  |    3.000000000
+00009840: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
+00009850: 2020 2020 2020 207c 2020 2020 312e 3030         |    1.00
+00009860: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
+00009870: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
+00009880: 2020 2034 2e30 3030 3030 3030 3030 3030     4.00000000000
+00009890: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+000098a0: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
+000098b0: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+000098c0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+000098d0: 2035 2e30 3030 3030 3030 3030 3030 3030   5.0000000000000
+000098e0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
+000098f0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
+00009900: 3030 3030 3030 3030 3065 2b30 3020 2020  000000000e+00   
+00009910: 7c0a 2020 2020 2020 2020 7c20 205d 2c20  |.        |  ], 
+00009920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009930: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00009940: 207c 2020 2274 7970 6522 3a20 2274 6469   |  "type": "tdi
+00009950: 6765 7374 222c 2020 2020 2020 2020 7c0a  gest",        |.
+00009960: 2020 2020 2020 2020 7c20 2022 7665 7273          |  "vers
+00009970: 696f 6e22 3a20 3120 2020 2020 2020 2020  ion": 1         
+00009980: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00009990: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+000099a0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+000099b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000099c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000099d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+000099e0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+000099f0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00009a00: 5f69 665f 7374 7228 636f 6c2c 2022 6170  _if_str(col, "ap
+00009a10: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
+00009a20: 6163 6375 6d75 6c61 7465 2229 0a20 2020  accumulate").   
+00009a30: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00009a40: 2261 7070 726f 785f 7065 7263 656e 7469  "approx_percenti
+00009a50: 6c65 5f61 6363 756d 756c 6174 6522 2928  le_accumulate")(
+00009a60: 6329 0a0a 0a64 6566 2061 7070 726f 785f  c)...def approx_
+00009a70: 7065 7263 656e 7469 6c65 5f65 7374 696d  percentile_estim
+00009a80: 6174 6528 7374 6174 653a 2043 6f6c 756d  ate(state: Colum
+00009a90: 6e4f 724e 616d 652c 2070 6572 6365 6e74  nOrName, percent
+00009aa0: 696c 653a 2066 6c6f 6174 2920 2d3e 2043  ile: float) -> C
+00009ab0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00009ac0: 7475 726e 7320 7468 6520 6465 7369 7265  turns the desire
+00009ad0: 6420 6170 7072 6f78 696d 6174 6564 2070  d approximated p
+00009ae0: 6572 6365 6e74 696c 6520 7661 6c75 6520  ercentile value 
+00009af0: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
+00009b00: 6420 742d 4469 6765 7374 2073 7461 7465  d t-Digest state
+00009b10: 2e0a 2020 2020 4150 5052 4f58 5f50 4552  ..    APPROX_PER
+00009b20: 4345 4e54 494c 455f 4553 5449 4d41 5445  CENTILE_ESTIMATE
+00009b30: 2841 5050 524f 585f 5045 5243 454e 5449  (APPROX_PERCENTI
+00009b40: 4c45 5f41 4343 554d 554c 4154 4528 2e29  LE_ACCUMULATE(.)
+00009b50: 2920 6973 2065 7175 6976 616c 656e 7420  ) is equivalent 
+00009b60: 746f 0a20 2020 2041 5050 524f 585f 5045  to.    APPROX_PE
+00009b70: 5243 454e 5449 4c45 282e 292e 0a0a 2020  RCENTILE(.)...  
+00009b80: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00009b90: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00009ba0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00009bb0: 6672 616d 6528 5b31 2c32 2c33 2c34 2c35  frame([1,2,3,4,5
+00009bc0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00009bd0: 0a20 2020 2020 2020 203e 3e3e 2064 665f  .        >>> df_
+00009be0: 6163 6375 203d 2064 662e 7365 6c65 6374  accu = df.select
+00009bf0: 2861 7070 726f 785f 7065 7263 656e 7469  (approx_percenti
+00009c00: 6c65 5f61 6363 756d 756c 6174 6528 2261  le_accumulate("a
+00009c10: 2229 2e61 6c69 6173 2822 6170 705f 7065  ").alias("app_pe
+00009c20: 7263 656e 7469 6c65 5f61 6363 7522 2929  rcentile_accu"))
+00009c30: 0a20 2020 2020 2020 203e 3e3e 2064 665f  .        >>> df_
+00009c40: 6163 6375 2e73 656c 6563 7428 6170 7072  accu.select(appr
+00009c50: 6f78 5f70 6572 6365 6e74 696c 655f 6573  ox_percentile_es
+00009c60: 7469 6d61 7465 2822 6170 705f 7065 7263  timate("app_perc
+00009c70: 656e 7469 6c65 5f61 6363 7522 2c20 302e  entile_accu", 0.
+00009c80: 3529 2e61 6c69 6173 2822 7265 7375 6c74  5).alias("result
+00009c90: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00009ca0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00009cb0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00009cc0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00009cd0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00009ce0: 2020 7c33 2e30 2020 2020 2020 207c 0a20    |3.0       |. 
+00009cf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00009d00: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00009d10: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00009d20: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00009d30: 6966 5f73 7472 2873 7461 7465 2c20 2261  if_str(state, "a
+00009d40: 7070 726f 785f 7065 7263 656e 7469 6c65  pprox_percentile
+00009d50: 5f65 7374 696d 6174 6522 290a 2020 2020  _estimate").    
+00009d60: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00009d70: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
+00009d80: 655f 6573 7469 6d61 7465 2229 2863 2c20  e_estimate")(c, 
+00009d90: 6c69 7428 7065 7263 656e 7469 6c65 2929  lit(percentile))
+00009da0: 0a0a 0a64 6566 2061 7070 726f 785f 7065  ...def approx_pe
+00009db0: 7263 656e 7469 6c65 5f63 6f6d 6269 6e65  rcentile_combine
+00009dc0: 2873 7461 7465 3a20 436f 6c75 6d6e 4f72  (state: ColumnOr
+00009dd0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00009de0: 0a20 2020 2022 2222 436f 6d62 696e 6573  .    """Combines
+00009df0: 2028 6d65 7267 6573 2920 7065 7263 656e   (merges) percen
+00009e00: 7469 6c65 2069 6e70 7574 2073 7461 7465  tile input state
+00009e10: 7320 696e 746f 2061 2073 696e 676c 6520  s into a single 
+00009e20: 6f75 7470 7574 2073 7461 7465 2e0a 2020  output state..  
+00009e30: 2020 5468 6973 2061 6c6c 6f77 7320 7363    This allows sc
+00009e40: 656e 6172 696f 7320 7768 6572 6520 4150  enarios where AP
+00009e50: 5052 4f58 5f50 4552 4345 4e54 494c 455f  PROX_PERCENTILE_
+00009e60: 4143 4355 4d55 4c41 5445 2069 7320 7275  ACCUMULATE is ru
+00009e70: 6e20 6f76 6572 2068 6f72 697a 6f6e 7461  n over horizonta
+00009e80: 6c20 7061 7274 6974 696f 6e73 0a20 2020  l partitions.   
+00009e90: 206f 6620 7468 6520 7361 6d65 2074 6162   of the same tab
+00009ea0: 6c65 2c20 7072 6f64 7563 696e 6720 616e  le, producing an
+00009eb0: 2061 6c67 6f72 6974 686d 2073 7461 7465   algorithm state
+00009ec0: 2066 6f72 2065 6163 6820 7461 626c 6520   for each table 
+00009ed0: 7061 7274 6974 696f 6e2e 2054 6865 7365  partition. These
+00009ee0: 2073 7461 7465 7320 6361 6e0a 2020 2020   states can.    
+00009ef0: 6c61 7465 7220 6265 2063 6f6d 6269 6e65  later be combine
+00009f00: 6420 7573 696e 6720 4150 5052 4f58 5f50  d using APPROX_P
+00009f10: 4552 4345 4e54 494c 455f 434f 4d42 494e  ERCENTILE_COMBIN
+00009f20: 452c 2070 726f 6475 6369 6e67 2074 6865  E, producing the
+00009f30: 2073 616d 6520 6f75 7470 7574 2073 7461   same output sta
+00009f40: 7465 2061 7320 610a 2020 2020 7369 6e67  te as a.    sing
+00009f50: 6c65 2072 756e 206f 6620 4150 5052 4f58  le run of APPROX
+00009f60: 5f50 4552 4345 4e54 494c 455f 4143 4355  _PERCENTILE_ACCU
+00009f70: 4d55 4c41 5445 206f 7665 7220 7468 6520  MULATE over the 
+00009f80: 656e 7469 7265 2074 6162 6c65 2e0a 0a20  entire table... 
+00009f90: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00009fa0: 2020 2020 203e 3e3e 2064 6631 203d 2073       >>> df1 = s
+00009fb0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00009fc0: 7461 6672 616d 6528 5b31 2c32 2c33 2c34  taframe([1,2,3,4
+00009fd0: 2c35 5d2c 2073 6368 656d 613d 5b22 6122  ,5], schema=["a"
+00009fe0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00009ff0: 6632 203d 2073 6573 7369 6f6e 2e63 7265  f2 = session.cre
+0000a000: 6174 655f 6461 7461 6672 616d 6528 5b36  ate_dataframe([6
+0000a010: 2c37 2c38 2c39 2c31 305d 2c20 7363 6865  ,7,8,9,10], sche
+0000a020: 6d61 3d5b 2262 225d 290a 2020 2020 2020  ma=["b"]).      
+0000a030: 2020 3e3e 3e20 6466 5f61 6363 7531 203d    >>> df_accu1 =
+0000a040: 2064 6631 2e73 656c 6563 7428 6170 7072   df1.select(appr
+0000a050: 6f78 5f70 6572 6365 6e74 696c 655f 6163  ox_percentile_ac
+0000a060: 6375 6d75 6c61 7465 2822 6122 292e 616c  cumulate("a").al
+0000a070: 6961 7328 2261 7070 5f70 6572 6365 6e74  ias("app_percent
+0000a080: 696c 655f 6163 6375 2229 290a 2020 2020  ile_accu")).    
+0000a090: 2020 2020 3e3e 3e20 6466 5f61 6363 7532      >>> df_accu2
+0000a0a0: 203d 2064 6632 2e73 656c 6563 7428 6170   = df2.select(ap
+0000a0b0: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
+0000a0c0: 6163 6375 6d75 6c61 7465 2822 6222 292e  accumulate("b").
+0000a0d0: 616c 6961 7328 2261 7070 5f70 6572 6365  alias("app_perce
+0000a0e0: 6e74 696c 655f 6163 6375 2229 290a 2020  ntile_accu")).  
+0000a0f0: 2020 2020 2020 3e3e 3e20 6466 5f61 6363        >>> df_acc
+0000a100: 7531 2e75 6e69 6f6e 2864 665f 6163 6375  u1.union(df_accu
+0000a110: 3229 2e73 656c 6563 7428 6170 7072 6f78  2).select(approx
+0000a120: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
+0000a130: 696e 6528 2261 7070 5f70 6572 6365 6e74  ine("app_percent
+0000a140: 696c 655f 6163 6375 2229 2e61 6c69 6173  ile_accu").alias
+0000a150: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+0000a160: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
 0000a170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a180: 2d0a 2020 2020 2020 2020 7c7b 2020 2020  -.        |{    
-0000a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1a0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0000a1b0: 207c 2020 2273 7461 7465 223a 205b 2020   |  "state": [  
-0000a1c0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-0000a1d0: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
-0000a1e0: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
-0000a1f0: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
-0000a200: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
-0000a210: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
-0000a220: 2020 2020 2020 7c20 2020 2032 2e30 3030        |    2.000
-0000a230: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
-0000a240: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
-0000a250: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
-0000a260: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
-0000a270: 2020 2020 7c20 2020 2033 2e30 3030 3030      |    3.00000
-0000a280: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
-0000a290: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
-0000a2a0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
-0000a2b0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
-0000a2c0: 2020 7c20 2020 2034 2e30 3030 3030 3030    |    4.0000000
-0000a2d0: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
-0000a2e0: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
-0000a2f0: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
-0000a300: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
-0000a310: 7c20 2020 2035 2e30 3030 3030 3030 3030  |    5.000000000
-0000a320: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
-0000a330: 2020 2020 2020 207c 2020 2020 312e 3030         |    1.00
-0000a340: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
-0000a350: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
-0000a360: 2020 2036 2e30 3030 3030 3030 3030 3030     6.00000000000
-0000a370: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
-0000a380: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
-0000a390: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
-0000a3a0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
-0000a3b0: 2037 2e30 3030 3030 3030 3030 3030 3030   7.0000000000000
-0000a3c0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
-0000a3d0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
-0000a3e0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
-0000a3f0: 7c0a 2020 2020 2020 2020 7c20 2020 2038  |.        |    8
-0000a400: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
-0000a410: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
-0000a420: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
-0000a430: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
-0000a440: 2020 2020 2020 2020 7c20 2020 2039 2e30          |    9.0
-0000a450: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
-0000a460: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
-0000a470: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
-0000a480: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
-0000a490: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
-0000a4a0: 3030 3030 3030 3030 3030 3030 652b 3031  000000000000e+01
-0000a4b0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
-0000a4c0: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
-0000a4d0: 3030 3065 2b30 3020 2020 7c0a 2020 2020  000e+00   |.    
-0000a4e0: 2020 2020 7c20 205d 2c20 2020 2020 2020      |  ],       
-0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a500: 207c 0a20 2020 2020 2020 207c 2020 2274   |.        |  "t
-0000a510: 7970 6522 3a20 2274 6469 6765 7374 222c  ype": "tdigest",
-0000a520: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0000a530: 2020 7c20 2022 7665 7273 696f 6e22 3a20    |  "version": 
-0000a540: 3120 2020 2020 2020 2020 2020 2020 207c  1              |
-0000a550: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
-0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a570: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0000a580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0000a5a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000a5b0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0000a5c0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000a5d0: 7228 7374 6174 652c 2022 6170 7072 6f78  r(state, "approx
-0000a5e0: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
-0000a5f0: 696e 6522 290a 2020 2020 7265 7475 726e  ine").    return
-0000a600: 2062 7569 6c74 696e 2822 6170 7072 6f78   builtin("approx
-0000a610: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
-0000a620: 696e 6522 2928 6329 0a0a 0a64 6566 2065  ine")(c)...def e
-0000a630: 7870 6c6f 6465 2863 6f6c 3a20 436f 6c75  xplode(col: Colu
-0000a640: 6d6e 4f72 4e61 6d65 2920 2d3e 2054 6162  mnOrName) -> Tab
-0000a650: 6c65 4675 6e63 7469 6f6e 4361 6c6c 3a0a  leFunctionCall:.
-0000a660: 2020 2020 2222 2246 6c61 7474 656e 7320      """Flattens 
-0000a670: 6120 6769 7665 6e20 6172 7261 7920 6f72  a given array or
-0000a680: 206d 6170 2074 7970 6520 636f 6c75 6d6e   map type column
-0000a690: 2069 6e74 6f20 696e 6469 7669 6475 616c   into individual
-0000a6a0: 2072 6f77 732e 2054 6865 2064 6566 6175   rows. The defau
-0000a6b0: 6c74 0a20 2020 2063 6f6c 756d 6e20 6e61  lt.    column na
-0000a6c0: 6d65 2066 6f72 2074 6865 206f 7574 7075  me for the outpu
-0000a6d0: 7420 636f 6c75 6d6e 2069 6e20 6361 7365  t column in case
-0000a6e0: 206f 6620 6172 7261 7920 696e 7075 7420   of array input 
-0000a6f0: 636f 6c75 6d6e 2069 7320 6060 5641 4c55  column is ``VALU
-0000a700: 4560 602c 0a20 2020 2061 6e64 2069 7320  E``,.    and is 
-0000a710: 6060 4b45 5960 6020 616e 6420 6060 5641  ``KEY`` and ``VA
-0000a720: 4c55 4560 6020 696e 2063 6173 6520 6f66  LUE`` in case of
-0000a730: 206d 6170 2069 6e70 7574 2063 6f6c 756d   map input colum
-0000a740: 6e2e 0a0a 2020 2020 4578 616d 706c 6573  n...    Examples
-0000a750: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-0000a760: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000a770: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
-0000a780: 2c20 5b31 2c20 322c 2033 5d2c 207b 2241  , [1, 2, 3], {"A
-0000a790: 7368 6920 4761 7261 6d69 223a 2022 5369  shi Garami": "Si
-0000a7a0: 6e67 6c65 204c 6567 2058 227d 2c20 224b  ngle Leg X"}, "K
-0000a7b0: 696d 7572 6122 5d2c 0a20 2020 2020 2020  imura"],.       
-0000a7c0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0000a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7e0: 2020 2020 5b32 2c20 5b31 312c 2032 325d      [2, [11, 22]
-0000a7f0: 2c20 7b22 5361 6e6b 616b 7522 3a20 2254  , {"Sankaku": "T
-0000a800: 7269 616e 676c 6522 7d2c 2022 436f 6666  riangle"}, "Coff
-0000a810: 6565 225d 5d2c 0a20 2020 2020 2020 202e  ee"]],.        .
-0000a820: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a840: 2020 7363 6865 6d61 3d5b 2269 6478 222c    schema=["idx",
-0000a850: 2022 6c69 7374 7322 2c20 226d 6170 7322   "lists", "maps"
-0000a860: 2c20 2273 7472 7322 5d29 0a20 2020 2020  , "strs"]).     
-0000a870: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0000a880: 2864 662e 6964 782c 2065 7870 6c6f 6465  (df.idx, explode
-0000a890: 2864 662e 6c69 7374 7329 292e 7368 6f77  (df.lists)).show
-0000a8a0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0000a8b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0000a8c0: 2020 2020 2020 207c 2249 4458 2220 207c         |"IDX"  |
-0000a8d0: 2256 414c 5545 2220 207c 0a20 2020 2020  "VALUE"  |.     
-0000a8e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0000a8f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000a900: 3120 2020 2020 207c 3120 2020 2020 2020  1      |1       
-0000a910: 207c 0a20 2020 2020 2020 207c 3120 2020   |.        |1   
-0000a920: 2020 207c 3220 2020 2020 2020 207c 0a20     |2        |. 
-0000a930: 2020 2020 2020 207c 3120 2020 2020 207c         |1      |
-0000a940: 3320 2020 2020 2020 207c 0a20 2020 2020  3        |.     
-0000a950: 2020 207c 3220 2020 2020 207c 3131 2020     |2      |11  
-0000a960: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0000a970: 3220 2020 2020 207c 3232 2020 2020 2020  2      |22      
-0000a980: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000a990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0000a9a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000a9b0: 453e 0a0a 2020 2020 2020 2020 3e3e 3e20  E>..        >>> 
-0000a9c0: 6466 2e73 656c 6563 7428 6466 2e73 7472  df.select(df.str
-0000a9d0: 732c 2065 7870 6c6f 6465 2864 662e 6d61  s, explode(df.ma
-0000a9e0: 7073 2929 2e73 686f 7728 290a 2020 2020  ps)).show().    
-0000a9f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000aa00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000aa10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0000aa20: 2020 2020 2020 7c22 5354 5253 2220 207c        |"STRS"  |
-0000aa30: 224b 4559 2220 2020 2020 2020 207c 2256  "KEY"        |"V
-0000aa40: 414c 5545 2220 2020 2020 2020 2020 7c0a  ALUE"         |.
-0000aa50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000aa60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a180: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000a190: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
+0000a1a0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0000a1b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000a1c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a1d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000a1e0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
+0000a1f0: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+0000a200: 2020 2020 2020 207c 2020 2273 7461 7465         |  "state
+0000a210: 223a 205b 2020 2020 2020 2020 2020 2020  ": [            
+0000a220: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0000a230: 2020 2031 2e30 3030 3030 3030 3030 3030     1.00000000000
+0000a240: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+0000a250: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
+0000a260: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+0000a270: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+0000a280: 2032 2e30 3030 3030 3030 3030 3030 3030   2.0000000000000
+0000a290: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
+0000a2a0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
+0000a2b0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
+0000a2c0: 7c0a 2020 2020 2020 2020 7c20 2020 2033  |.        |    3
+0000a2d0: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
+0000a2e0: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
+0000a2f0: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
+0000a300: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
+0000a310: 2020 2020 2020 2020 7c20 2020 2034 2e30          |    4.0
+0000a320: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+0000a330: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+0000a340: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
+0000a350: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+0000a360: 2020 2020 2020 7c20 2020 2035 2e30 3030        |    5.000
+0000a370: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+0000a380: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+0000a390: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
+0000a3a0: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
+0000a3b0: 2020 2020 7c20 2020 2036 2e30 3030 3030      |    6.00000
+0000a3c0: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
+0000a3d0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+0000a3e0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
+0000a3f0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+0000a400: 2020 7c20 2020 2037 2e30 3030 3030 3030    |    7.0000000
+0000a410: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+0000a420: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
+0000a430: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+0000a440: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
+0000a450: 7c20 2020 2038 2e30 3030 3030 3030 3030  |    8.000000000
+0000a460: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
+0000a470: 2020 2020 2020 207c 2020 2020 312e 3030         |    1.00
+0000a480: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
+0000a490: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
+0000a4a0: 2020 2039 2e30 3030 3030 3030 3030 3030     9.00000000000
+0000a4b0: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+0000a4c0: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
+0000a4d0: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+0000a4e0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+0000a4f0: 2031 2e30 3030 3030 3030 3030 3030 3030   1.0000000000000
+0000a500: 3030 652b 3031 2c20 207c 0a20 2020 2020  00e+01,  |.     
+0000a510: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
+0000a520: 3030 3030 3030 3030 3065 2b30 3020 2020  000000000e+00   
+0000a530: 7c0a 2020 2020 2020 2020 7c20 205d 2c20  |.        |  ], 
+0000a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a550: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0000a560: 207c 2020 2274 7970 6522 3a20 2274 6469   |  "type": "tdi
+0000a570: 6765 7374 222c 2020 2020 2020 2020 7c0a  gest",        |.
+0000a580: 2020 2020 2020 2020 7c20 2022 7665 7273          |  "vers
+0000a590: 696f 6e22 3a20 3120 2020 2020 2020 2020  ion": 1         
+0000a5a0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0000a5b0: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+0000a5c0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+0000a5d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000a5e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a5f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0000a600: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0000a610: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0000a620: 5f69 665f 7374 7228 7374 6174 652c 2022  _if_str(state, "
+0000a630: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
+0000a640: 655f 636f 6d62 696e 6522 290a 2020 2020  e_combine").    
+0000a650: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000a660: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
+0000a670: 655f 636f 6d62 696e 6522 2928 6329 0a0a  e_combine")(c)..
+0000a680: 0a64 6566 2065 7870 6c6f 6465 2863 6f6c  .def explode(col
+0000a690: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0000a6a0: 2d3e 2054 6162 6c65 4675 6e63 7469 6f6e  -> TableFunction
+0000a6b0: 4361 6c6c 3a0a 2020 2020 2222 2246 6c61  Call:.    """Fla
+0000a6c0: 7474 656e 7320 6120 6769 7665 6e20 6172  ttens a given ar
+0000a6d0: 7261 7920 6f72 206d 6170 2074 7970 6520  ray or map type 
+0000a6e0: 636f 6c75 6d6e 2069 6e74 6f20 696e 6469  column into indi
+0000a6f0: 7669 6475 616c 2072 6f77 732e 2054 6865  vidual rows. The
+0000a700: 2064 6566 6175 6c74 0a20 2020 2063 6f6c   default.    col
+0000a710: 756d 6e20 6e61 6d65 2066 6f72 2074 6865  umn name for the
+0000a720: 206f 7574 7075 7420 636f 6c75 6d6e 2069   output column i
+0000a730: 6e20 6361 7365 206f 6620 6172 7261 7920  n case of array 
+0000a740: 696e 7075 7420 636f 6c75 6d6e 2069 7320  input column is 
+0000a750: 6060 5641 4c55 4560 602c 0a20 2020 2061  ``VALUE``,.    a
+0000a760: 6e64 2069 7320 6060 4b45 5960 6020 616e  nd is ``KEY`` an
+0000a770: 6420 6060 5641 4c55 4560 6020 696e 2063  d ``VALUE`` in c
+0000a780: 6173 6520 6f66 206d 6170 2069 6e70 7574  ase of map input
+0000a790: 2063 6f6c 756d 6e2e 0a0a 2020 2020 4578   column...    Ex
+0000a7a0: 616d 706c 6573 3a3a 0a20 2020 2020 2020  amples::.       
+0000a7b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000a7c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0000a7d0: 6d65 285b 5b31 2c20 5b31 2c20 322c 2033  me([[1, [1, 2, 3
+0000a7e0: 5d2c 207b 2241 7368 6920 4761 7261 6d69  ], {"Ashi Garami
+0000a7f0: 223a 2022 5369 6e67 6c65 204c 6567 2058  ": "Single Leg X
+0000a800: 227d 2c20 224b 696d 7572 6122 5d2c 0a20  "}, "Kimura"],. 
+0000a810: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0000a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a830: 2020 2020 2020 2020 2020 5b32 2c20 5b31            [2, [1
+0000a840: 312c 2032 325d 2c20 7b22 5361 6e6b 616b  1, 22], {"Sankak
+0000a850: 7522 3a20 2254 7269 616e 676c 6522 7d2c  u": "Triangle"},
+0000a860: 2022 436f 6666 6565 225d 5d2c 0a20 2020   "Coffee"]],.   
+0000a870: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0000a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a890: 2020 2020 2020 2020 7363 6865 6d61 3d5b          schema=[
+0000a8a0: 2269 6478 222c 2022 6c69 7374 7322 2c20  "idx", "lists", 
+0000a8b0: 226d 6170 7322 2c20 2273 7472 7322 5d29  "maps", "strs"])
+0000a8c0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000a8d0: 7365 6c65 6374 2864 662e 6964 782c 2065  select(df.idx, e
+0000a8e0: 7870 6c6f 6465 2864 662e 6c69 7374 7329  xplode(df.lists)
+0000a8f0: 292e 736f 7274 2863 6f6c 2822 6964 7822  ).sort(col("idx"
+0000a900: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0000a910: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0000a920: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0000a930: 4944 5822 2020 7c22 5641 4c55 4522 2020  IDX"  |"VALUE"  
+0000a940: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000a950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0000a960: 2020 2020 2020 7c31 2020 2020 2020 7c31        |1      |1
+0000a970: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0000a980: 2020 7c31 2020 2020 2020 7c32 2020 2020    |1      |2    
+0000a990: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
+0000a9a0: 2020 2020 2020 7c33 2020 2020 2020 2020        |3        
+0000a9b0: 7c0a 2020 2020 2020 2020 7c32 2020 2020  |.        |2    
+0000a9c0: 2020 7c31 3120 2020 2020 2020 7c0a 2020    |11       |.  
+0000a9d0: 2020 2020 2020 7c32 2020 2020 2020 7c32        |2      |2
+0000a9e0: 3220 2020 2020 2020 7c0a 2020 2020 2020  2       |.      
+0000a9f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0000aa00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0000aa10: 4c41 4e4b 4c49 4e45 3e0a 0a20 2020 2020  LANKLINE>..     
+0000aa20: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0000aa30: 2864 662e 7374 7273 2c20 6578 706c 6f64  (df.strs, explod
+0000aa40: 6528 6466 2e6d 6170 7329 292e 736f 7274  e(df.maps)).sort
+0000aa50: 2863 6f6c 2822 7374 7273 2229 292e 7368  (col("strs")).sh
+0000aa60: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
 0000aa70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000aa80: 2d0a 2020 2020 2020 2020 7c4b 696d 7572  -.        |Kimur
-0000aa90: 6120 207c 4173 6869 2047 6172 616d 6920  a  |Ashi Garami 
-0000aaa0: 207c 2253 696e 676c 6520 4c65 6720 5822   |"Single Leg X"
-0000aab0: 2020 7c0a 2020 2020 2020 2020 7c43 6f66    |.        |Cof
-0000aac0: 6665 6520 207c 5361 6e6b 616b 7520 2020  fee  |Sankaku   
-0000aad0: 2020 207c 2254 7269 616e 676c 6522 2020     |"Triangle"  
-0000aae0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0000aaf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ab00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ab10: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000ab20: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
-0000ab30: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000ab40: 6374 2865 7870 6c6f 6465 2863 6f6c 2822  ct(explode(col("
-0000ab50: 6c69 7374 7322 2929 2e61 6c69 6173 2822  lists")).alias("
-0000ab60: 756e 6f22 2929 2e73 686f 7728 290a 2020  uno")).show().  
-0000ab70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
-0000ab80: 2020 2020 2020 2020 7c22 554e 4f22 2020          |"UNO"  
-0000ab90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000aba0: 2d2d 2d0a 2020 2020 2020 2020 7c31 2020  ---.        |1  
-0000abb0: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
-0000abc0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0000abd0: 7c33 2020 2020 2020 7c0a 2020 2020 2020  |3      |.      
-0000abe0: 2020 7c31 3120 2020 2020 7c0a 2020 2020    |11     |.    
-0000abf0: 2020 2020 7c32 3220 2020 2020 7c0a 2020      |22     |.  
-0000ac00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
-0000ac10: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0000ac20: 4e45 3e0a 0a20 2020 2020 2020 203e 3e3e  NE>..        >>>
-0000ac30: 2064 662e 7365 6c65 6374 2865 7870 6c6f   df.select(explo
-0000ac40: 6465 2827 6d61 7073 2729 2e61 735f 2822  de('maps').as_("
-0000ac50: 7072 696d 6f22 2c20 2273 6563 756e 646f  primo", "secundo
-0000ac60: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-0000ac70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0000ac80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ac90: 2d2d 2d0a 2020 2020 2020 2020 7c22 5052  ---.        |"PR
-0000aca0: 494d 4f22 2020 2020 2020 7c22 5345 4355  IMO"      |"SECU
-0000acb0: 4e44 4f22 2020 2020 2020 207c 0a20 2020  NDO"       |.   
-0000acc0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000acd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ace0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c41  -----.        |A
-0000acf0: 7368 6920 4761 7261 6d69 2020 7c22 5369  shi Garami  |"Si
-0000ad00: 6e67 6c65 204c 6567 2058 2220 207c 0a20  ngle Leg X"  |. 
-0000ad10: 2020 2020 2020 207c 5361 6e6b 616b 7520         |Sankaku 
-0000ad20: 2020 2020 207c 2254 7269 616e 676c 6522       |"Triangle"
-0000ad30: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0000ad40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ad50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ad60: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0000ad70: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0000ad80: 2066 756e 635f 6361 6c6c 203d 205f 4578   func_call = _Ex
-0000ad90: 706c 6f64 6546 756e 6374 696f 6e43 616c  plodeFunctionCal
-0000ada0: 6c28 636f 6c29 0a20 2020 2066 756e 635f  l(col).    func_
-0000adb0: 6361 6c6c 2e5f 7365 745f 6170 695f 6361  call._set_api_ca
-0000adc0: 6c6c 5f73 6f75 7263 6528 2266 756e 6374  ll_source("funct
-0000add0: 696f 6e73 2e65 7870 6c6f 6465 2229 0a20  ions.explode"). 
-0000ade0: 2020 2072 6574 7572 6e20 6675 6e63 5f63     return func_c
-0000adf0: 616c 6c0a 0a0a 6465 6620 6772 6f75 7069  all...def groupi
-0000ae00: 6e67 282a 636f 6c73 3a20 436f 6c75 6d6e  ng(*cols: Column
-0000ae10: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000ae20: 6e3a 0a20 2020 2022 2222 0a20 2020 2044  n:.    """.    D
-0000ae30: 6573 6372 6962 6573 2077 6869 6368 206f  escribes which o
-0000ae40: 6620 6120 6c69 7374 206f 6620 6578 7072  f a list of expr
-0000ae50: 6573 7369 6f6e 7320 6172 6520 6772 6f75  essions are grou
-0000ae60: 7065 6420 696e 2061 2072 6f77 2070 726f  ped in a row pro
-0000ae70: 6475 6365 6420 6279 2061 2047 524f 5550  duced by a GROUP
-0000ae80: 2042 5920 7175 6572 792e 0a0a 2020 2020   BY query...    
-0000ae90: 3a66 756e 633a 6067 726f 7570 696e 675f  :func:`grouping_
-0000aea0: 6964 6020 6973 2061 6e20 616c 6961 7320  id` is an alias 
-0000aeb0: 6f66 203a 6675 6e63 3a60 6772 6f75 7069  of :func:`groupi
-0000aec0: 6e67 602e 0a0a 2020 2020 4578 616d 706c  ng`...    Exampl
-0000aed0: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0000aee0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0000aef0: 6e6f 7770 6172 6b20 696d 706f 7274 2047  nowpark import G
-0000af00: 726f 7570 696e 6753 6574 730a 2020 2020  roupingSets.    
-0000af10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000af20: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0000af30: 6672 616d 6528 5b5b 312c 2032 2c20 335d  frame([[1, 2, 3]
-0000af40: 2c20 5b34 2c20 352c 2036 5d5d 2c73 6368  , [4, 5, 6]],sch
-0000af50: 656d 613d 5b22 6122 2c20 2262 222c 2022  ema=["a", "b", "
-0000af60: 6322 5d29 0a20 2020 2020 2020 203e 3e3e  c"]).        >>>
-0000af70: 2067 726f 7570 696e 675f 7365 7473 203d   grouping_sets =
-0000af80: 2047 726f 7570 696e 6753 6574 7328 5b63   GroupingSets([c
-0000af90: 6f6c 2822 6122 295d 2c20 5b63 6f6c 2822  ol("a")], [col("
-0000afa0: 6222 295d 2c20 5b63 6f6c 2822 6122 292c  b")], [col("a"),
-0000afb0: 2063 6f6c 2822 6222 295d 290a 2020 2020   col("b")]).    
-0000afc0: 2020 2020 3e3e 3e20 6466 2e67 726f 7570      >>> df.group
-0000afd0: 5f62 795f 6772 6f75 7069 6e67 5f73 6574  _by_grouping_set
-0000afe0: 7328 6772 6f75 7069 6e67 5f73 6574 7329  s(grouping_sets)
-0000aff0: 2e61 6767 285b 636f 756e 7428 2263 2229  .agg([count("c")
-0000b000: 2c20 6772 6f75 7069 6e67 2822 6122 292c  , grouping("a"),
-0000b010: 2067 726f 7570 696e 6728 2262 2229 2c20   grouping("b"), 
-0000b020: 6772 6f75 7069 6e67 2822 6122 2c20 2262  grouping("a", "b
-0000b030: 2229 5d29 2e63 6f6c 6c65 6374 2829 0a20  ")]).collect(). 
-0000b040: 2020 2020 2020 205b 526f 7728 413d 312c         [Row(A=1,
-0000b050: 2042 3d32 2c20 434f 554e 5428 4329 3d31   B=2, COUNT(C)=1
-0000b060: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
-0000b070: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
-0000b080: 4752 4f55 5049 4e47 2841 2c20 4229 3d30  GROUPING(A, B)=0
-0000b090: 292c 205c 0a52 6f77 2841 3d34 2c20 423d  ), \.Row(A=4, B=
-0000b0a0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
-0000b0b0: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
-0000b0c0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
-0000b0d0: 5550 494e 4728 412c 2042 293d 3029 2c20  UPING(A, B)=0), 
-0000b0e0: 5c0a 526f 7728 413d 312c 2042 3d4e 6f6e  \.Row(A=1, B=Non
-0000b0f0: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
-0000b100: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
-0000b110: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
-0000b120: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
-0000b130: 5c0a 526f 7728 413d 342c 2042 3d4e 6f6e  \.Row(A=4, B=Non
-0000b140: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
-0000b150: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
-0000b160: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
-0000b170: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
-0000b180: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
-0000b190: 322c 2043 4f55 4e54 2843 293d 312c 2047  2, COUNT(C)=1, G
-0000b1a0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
-0000b1b0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
-0000b1c0: 5550 494e 4728 412c 2042 293d 3229 2c20  UPING(A, B)=2), 
-0000b1d0: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
-0000b1e0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
-0000b1f0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
-0000b200: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
-0000b210: 5550 494e 4728 412c 2042 293d 3229 5d0a  UPING(A, B)=2)].
-0000b220: 2020 2020 2222 220a 2020 2020 636f 6c75      """.    colu
-0000b230: 6d6e 7320 3d20 5b5f 746f 5f63 6f6c 5f69  mns = [_to_col_i
-0000b240: 665f 7374 7228 632c 2022 6772 6f75 7069  f_str(c, "groupi
-0000b250: 6e67 2229 2066 6f72 2063 2069 6e20 636f  ng") for c in co
-0000b260: 6c73 5d0a 2020 2020 7265 7475 726e 2062  ls].    return b
-0000b270: 7569 6c74 696e 2822 6772 6f75 7069 6e67  uiltin("grouping
-0000b280: 2229 282a 636f 6c75 6d6e 7329 0a0a 0a67  ")(*columns)...g
-0000b290: 726f 7570 696e 675f 6964 203d 2067 726f  rouping_id = gro
-0000b2a0: 7570 696e 670a 0a0a 6465 6620 636f 616c  uping...def coal
-0000b2b0: 6573 6365 282a 653a 2043 6f6c 756d 6e4f  esce(*e: ColumnO
-0000b2c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000b2d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-0000b2e0: 2074 6865 2066 6972 7374 206e 6f6e 2d4e   the first non-N
-0000b2f0: 554c 4c20 6578 7072 6573 7369 6f6e 2061  ULL expression a
-0000b300: 6d6f 6e67 2069 7473 2061 7267 756d 656e  mong its argumen
-0000b310: 7473 2c20 6f72 204e 554c 4c20 6966 2061  ts, or NULL if a
-0000b320: 6c6c 2069 7473 0a20 2020 2061 7267 756d  ll its.    argum
-0000b330: 656e 7473 2061 7265 204e 554c 4c2e 0a0a  ents are NULL...
-0000b340: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0000b350: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000b360: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0000b370: 6174 6166 7261 6d65 285b 5b31 2c20 322c  ataframe([[1, 2,
-0000b380: 2033 5d2c 205b 4e6f 6e65 2c20 322c 2033   3], [None, 2, 3
-0000b390: 5d2c 205b 4e6f 6e65 2c20 4e6f 6e65 2c20  ], [None, None, 
-0000b3a0: 335d 2c20 5b4e 6f6e 652c 204e 6f6e 652c  3], [None, None,
-0000b3b0: 204e 6f6e 655d 5d2c 2073 6368 656d 613d   None]], schema=
-0000b3c0: 5b27 6127 2c20 2762 272c 2027 6327 5d29  ['a', 'b', 'c'])
-0000b3d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000b3e0: 7365 6c65 6374 2864 662e 612c 2064 662e  select(df.a, df.
-0000b3f0: 622c 2064 662e 632c 2063 6f61 6c65 7363  b, df.c, coalesc
-0000b400: 6528 6466 2e61 2c20 6466 2e62 2c20 6466  e(df.a, df.b, df
-0000b410: 2e63 292e 6173 5f28 2243 4f41 4c45 5343  .c).as_("COALESC
-0000b420: 4522 2929 2e73 686f 7728 290a 2020 2020  E")).show().    
-0000b430: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000b440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b450: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000b460: 7c22 4122 2020 207c 2242 2220 2020 7c22  |"A"   |"B"   |"
-0000b470: 4322 2020 207c 2243 4f41 4c45 5343 4522  C"   |"COALESCE"
-0000b480: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0000b490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b4a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0000b4b0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
-0000b4c0: 3220 2020 2020 7c33 2020 2020 207c 3120  2     |3     |1 
-0000b4d0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0000b4e0: 2020 2020 7c4e 554c 4c20 207c 3220 2020      |NULL  |2   
-0000b4f0: 2020 7c33 2020 2020 207c 3220 2020 2020    |3     |2     
-0000b500: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0000b510: 7c4e 554c 4c20 207c 4e55 4c4c 2020 7c33  |NULL  |NULL  |3
-0000b520: 2020 2020 207c 3320 2020 2020 2020 2020       |3         
-0000b530: 2020 7c0a 2020 2020 2020 2020 7c4e 554c    |.        |NUL
-0000b540: 4c20 207c 4e55 4c4c 2020 7c4e 554c 4c20  L  |NULL  |NULL 
-0000b550: 207c 4e55 4c4c 2020 2020 2020 2020 7c0a   |NULL        |.
-0000b560: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000b570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000b590: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0000b5a0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000b5b0: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
-0000b5c0: 6578 2c20 2263 6f61 6c65 7363 6522 2920  ex, "coalesce") 
-0000b5d0: 666f 7220 6578 2069 6e20 655d 0a20 2020  for ex in e].   
-0000b5e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000b5f0: 2263 6f61 6c65 7363 6522 2928 2a63 290a  "coalesce")(*c).
-0000b600: 0a0a 6465 6620 6571 7561 6c5f 6e61 6e28  ..def equal_nan(
-0000b610: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0000b620: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0000b630: 2222 220a 2020 2020 5265 7475 726e 2074  """.    Return t
-0000b640: 7275 6520 6966 2074 6865 2076 616c 7565  rue if the value
-0000b650: 2069 6e20 7468 6520 636f 6c75 6d6e 2069   in the column i
-0000b660: 7320 6e6f 7420 6120 6e75 6d62 6572 2028  s not a number (
-0000b670: 4e61 4e29 2e0a 0a20 2020 2045 7861 6d70  NaN)...    Examp
-0000b680: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0000b690: 3e20 696d 706f 7274 206d 6174 680a 2020  > import math.  
-0000b6a0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000b6b0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000b6c0: 7461 6672 616d 6528 5b31 2e31 2c20 6d61  taframe([1.1, ma
-0000b6d0: 7468 2e6e 616e 2c20 322e 335d 2c20 7363  th.nan, 2.3], sc
-0000b6e0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0000b6f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000b700: 7428 6571 7561 6c5f 6e61 6e28 6466 5b22  t(equal_nan(df["
-0000b710: 6122 5d29 2e61 6c69 6173 2822 6571 7561  a"]).alias("equa
-0000b720: 6c5f 6e61 6e22 2929 2e63 6f6c 6c65 6374  l_nan")).collect
-0000b730: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0000b740: 4551 5541 4c5f 4e41 4e3d 4661 6c73 6529  EQUAL_NAN=False)
-0000b750: 2c20 526f 7728 4551 5541 4c5f 4e41 4e3d  , Row(EQUAL_NAN=
-0000b760: 5472 7565 292c 2052 6f77 2845 5155 414c  True), Row(EQUAL
-0000b770: 5f4e 414e 3d46 616c 7365 295d 0a20 2020  _NAN=False)].   
-0000b780: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0000b790: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-0000b7a0: 6571 7561 6c5f 6e61 6e22 290a 2020 2020  equal_nan").    
-0000b7b0: 7265 7475 726e 2063 2e65 7175 616c 5f6e  return c.equal_n
-0000b7c0: 616e 2829 0a0a 0a64 6566 2069 735f 6e75  an()...def is_nu
-0000b7d0: 6c6c 2865 3a20 436f 6c75 6d6e 4f72 4e61  ll(e: ColumnOrNa
-0000b7e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000b7f0: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0000b800: 6e20 7472 7565 2069 6620 7468 6520 7661  n true if the va
-0000b810: 6c75 6520 696e 2074 6865 2063 6f6c 756d  lue in the colum
-0000b820: 6e20 6973 206e 756c 6c2e 0a0a 2020 2020  n is null...    
-0000b830: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0000b840: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0000b850: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-0000b860: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-0000b870: 6973 5f6e 756c 6c0a 2020 2020 2020 2020  is_null.        
-0000b880: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0000b890: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0000b8a0: 6528 5b31 2e32 2c20 666c 6f61 7428 226e  e([1.2, float("n
-0000b8b0: 616e 2229 2c20 4e6f 6e65 2c20 312e 305d  an"), None, 1.0]
-0000b8c0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0000b8d0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000b8e0: 656c 6563 7428 6973 5f6e 756c 6c28 2261  elect(is_null("a
-0000b8f0: 2229 2e61 735f 2822 6122 2929 2e63 6f6c  ").as_("a")).col
-0000b900: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0000b910: 526f 7728 413d 4661 6c73 6529 2c20 526f  Row(A=False), Ro
-0000b920: 7728 413d 4661 6c73 6529 2c20 526f 7728  w(A=False), Row(
-0000b930: 413d 5472 7565 292c 2052 6f77 2841 3d46  A=True), Row(A=F
-0000b940: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
-0000b950: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000b960: 665f 7374 7228 652c 2022 6973 5f6e 756c  f_str(e, "is_nul
-0000b970: 6c22 290a 2020 2020 7265 7475 726e 2063  l").    return c
-0000b980: 2e69 735f 6e75 6c6c 2829 0a0a 0a64 6566  .is_null()...def
-0000b990: 206e 6567 6174 6528 653a 2043 6f6c 756d   negate(e: Colum
-0000b9a0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0000b9b0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0000b9c0: 6e73 2074 6865 206e 6567 6174 696f 6e20  ns the negation 
-0000b9d0: 6f66 2074 6865 2076 616c 7565 2069 6e20  of the value in 
-0000b9e0: 7468 6520 636f 6c75 6d6e 2028 6571 7569  the column (equi
-0000b9f0: 7661 6c65 6e74 2074 6f20 6120 756e 6172  valent to a unar
-0000ba00: 7920 6d69 6e75 7329 2e0a 0a20 2020 2045  y minus)...    E
-0000ba10: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000ba20: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000ba30: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000ba40: 616d 6528 5b5b 315d 5d2c 2073 6368 656d  ame([[1]], schem
-0000ba50: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-0000ba60: 203e 3e3e 2064 662e 7365 6c65 6374 286e   >>> df.select(n
-0000ba70: 6567 6174 6528 636f 6c28 2261 2229 2e61  egate(col("a").a
-0000ba80: 6c69 6173 2822 7265 7375 6c74 2229 2929  lias("result")))
-0000ba90: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0000baa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000bab0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0000bac0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000bad0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000bae0: 2d31 2020 2020 2020 2020 7c0a 2020 2020  -1        |.    
-0000baf0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000bb00: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0000bb10: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
-0000bb20: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000bb30: 5f73 7472 2865 2c20 226e 6567 6174 6522  _str(e, "negate"
-0000bb40: 290a 2020 2020 7265 7475 726e 202d 630a  ).    return -c.
-0000bb50: 0a0a 6465 6620 6e6f 745f 2865 3a20 436f  ..def not_(e: Co
-0000bb60: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000bb70: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-0000bb80: 7475 726e 7320 7468 6520 696e 7665 7273  turns the invers
-0000bb90: 6520 6f66 2061 2062 6f6f 6c65 616e 2065  e of a boolean e
-0000bba0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
-0000bbb0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0000bbc0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0000bbd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0000bbe0: 7261 6d65 285b 5b54 7275 655d 5d2c 2073  rame([[True]], s
-0000bbf0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000bc00: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000bc10: 6374 286e 6f74 5f28 636f 6c28 2261 2229  ct(not_(col("a")
-0000bc20: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-0000bc30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0000bc40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000bc50: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0000bc60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0000bc70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000bc80: 207c 4661 6c73 6520 2020 2020 7c0a 2020   |False     |.  
-0000bc90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000bca0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0000bcb0: 4b4c 494e 453e 0a20 2020 2022 2222 0a0a  KLINE>.    """..
-0000bcc0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0000bcd0: 6966 5f73 7472 2865 2c20 226e 6f74 5f22  if_str(e, "not_"
-0000bce0: 290a 2020 2020 7265 7475 726e 207e 630a  ).    return ~c.
-0000bcf0: 0a0a 6465 6620 7261 6e64 6f6d 2873 6565  ..def random(see
-0000bd00: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
-0000bd10: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
-0000bd20: 6d6e 3a0a 2020 2020 2222 2245 6163 6820  mn:.    """Each 
-0000bd30: 6361 6c6c 2072 6574 7572 6e73 2061 2070  call returns a p
-0000bd40: 7365 7564 6f2d 7261 6e64 6f6d 2036 342d  seudo-random 64-
-0000bd50: 6269 7420 696e 7465 6765 722e 0a0a 2020  bit integer...  
-0000bd60: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-0000bd70: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000bd80: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
-0000bd90: 2031 2229 0a20 2020 2020 2020 203e 3e3e   1").        >>>
-0000bda0: 2064 6620 3d20 6466 2e73 656c 6563 7428   df = df.select(
-0000bdb0: 7261 6e64 6f6d 2831 3233 292e 616c 6961  random(123).alia
-0000bdc0: 7328 2272 6573 756c 7422 2929 0a20 2020  s("result")).   
-0000bdd0: 2022 2222 0a20 2020 2073 203d 2073 6565   """.    s = see
-0000bde0: 6420 6966 2073 6565 6420 6973 206e 6f74  d if seed is not
-0000bdf0: 204e 6f6e 6520 656c 7365 2072 616e 6469   None else randi
-0000be00: 6e74 282d 2832 2a2a 3633 292c 2032 2a2a  nt(-(2**63), 2**
-0000be10: 3633 202d 2031 290a 2020 2020 7265 7475  63 - 1).    retu
-0000be20: 726e 2062 7569 6c74 696e 2822 7261 6e64  rn builtin("rand
-0000be30: 6f6d 2229 284c 6974 6572 616c 2873 2929  om")(Literal(s))
-0000be40: 0a0a 0a64 6566 2075 6e69 666f 726d 280a  ...def uniform(.
-0000be50: 2020 2020 6d69 6e5f 3a20 556e 696f 6e5b      min_: Union[
-0000be60: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-0000be70: 742c 2066 6c6f 6174 5d2c 0a20 2020 206d  t, float],.    m
-0000be80: 6178 5f3a 2055 6e69 6f6e 5b43 6f6c 756d  ax_: Union[Colum
-0000be90: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
-0000bea0: 6f61 745d 2c0a 2020 2020 6765 6e3a 2055  oat],.    gen: U
-0000beb0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-0000bec0: 652c 2069 6e74 2c20 666c 6f61 745d 2c0a  e, int, float],.
-0000bed0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0000bee0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-0000bef0: 2061 2075 6e69 666f 726d 6c79 2072 616e   a uniformly ran
-0000bf00: 646f 6d20 6e75 6d62 6572 2e0a 0a20 2020  dom number...   
-0000bf10: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0000bf20: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0000bf30: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-0000bf40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0000bf50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0000bf60: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-0000bf70: 2020 5b5b 315d 5d2c 0a20 2020 2020 2020    [[1]],.       
-0000bf80: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-0000bf90: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
-0000bfa0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0000bfb0: 2064 662e 7365 6c65 6374 2875 6e69 666f   df.select(unifo
-0000bfc0: 726d 2831 2c20 3130 302c 2063 6f6c 2822  rm(1, 100, col("
-0000bfd0: 6122 2929 2e61 6c69 6173 2822 554e 4946  a")).alias("UNIF
-0000bfe0: 4f52 4d22 2929 2e63 6f6c 6c65 6374 2829  ORM")).collect()
-0000bff0: 0a20 2020 2020 2020 205b 526f 7728 554e  .        [Row(UN
-0000c000: 4946 4f52 4d3d 3632 295d 0a20 2020 2022  IFORM=62)].    "
-0000c010: 2222 0a0a 2020 2020 6465 6620 636f 6e76  ""..    def conv
-0000c020: 6572 745f 6c69 6d69 745f 746f 5f63 6f6c  ert_limit_to_col
-0000c030: 286c 696d 6974 293a 0a20 2020 2020 2020  (limit):.       
-0000c040: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
-0000c050: 696d 6974 2c20 696e 7429 3a0a 2020 2020  imit, int):.    
-0000c060: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-0000c070: 6974 286c 696d 6974 290a 2020 2020 2020  it(limit).      
-0000c080: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0000c090: 6528 6c69 6d69 742c 2066 6c6f 6174 293a  e(limit, float):
-0000c0a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000c0b0: 7572 6e20 6c69 7428 6c69 6d69 7429 2e63  urn lit(limit).c
-0000c0c0: 6173 7428 466c 6f61 7454 7970 6528 2929  ast(FloatType())
-0000c0d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000c0e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286c  _to_col_if_str(l
-0000c0f0: 696d 6974 2c20 2275 6e69 666f 726d 2229  imit, "uniform")
-0000c100: 0a0a 2020 2020 6d69 6e5f 636f 6c20 3d20  ..    min_col = 
-0000c110: 636f 6e76 6572 745f 6c69 6d69 745f 746f  convert_limit_to
-0000c120: 5f63 6f6c 286d 696e 5f29 0a20 2020 206d  _col(min_).    m
-0000c130: 6178 5f63 6f6c 203d 2063 6f6e 7665 7274  ax_col = convert
-0000c140: 5f6c 696d 6974 5f74 6f5f 636f 6c28 6d61  _limit_to_col(ma
-0000c150: 785f 290a 2020 2020 6765 6e5f 636f 6c20  x_).    gen_col 
-0000c160: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
-0000c170: 6765 6e29 2069 6620 6973 696e 7374 616e  gen) if isinstan
-0000c180: 6365 2867 656e 2c20 2869 6e74 2c20 666c  ce(gen, (int, fl
-0000c190: 6f61 7429 2920 656c 7365 205f 746f 5f63  oat)) else _to_c
-0000c1a0: 6f6c 5f69 665f 7374 7228 6765 6e2c 2022  ol_if_str(gen, "
-0000c1b0: 756e 6966 6f72 6d22 290a 2020 2020 290a  uniform").    ).
-0000c1c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000c1d0: 696e 2822 756e 6966 6f72 6d22 2928 6d69  in("uniform")(mi
-0000c1e0: 6e5f 636f 6c2c 206d 6178 5f63 6f6c 2c20  n_col, max_col, 
-0000c1f0: 6765 6e5f 636f 6c29 0a0a 0a64 6566 2073  gen_col)...def s
-0000c200: 6571 3128 7369 676e 3a20 696e 7420 3d20  eq1(sign: int = 
-0000c210: 3029 202d 3e20 436f 6c75 6d6e 3a0a 2020  0) -> Column:.  
-0000c220: 2020 2222 2252 6574 7572 6e73 2061 2073    """Returns a s
-0000c230: 6571 7565 6e63 6520 6f66 206d 6f6e 6f74  equence of monot
-0000c240: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
-0000c250: 696e 6720 696e 7465 6765 7273 2c20 7769  ing integers, wi
-0000c260: 7468 2077 7261 702d 6172 6f75 6e64 0a20  th wrap-around. 
-0000c270: 2020 2077 6869 6368 2068 6170 7065 6e73     which happens
-0000c280: 2061 6674 6572 206c 6172 6765 7374 2072   after largest r
-0000c290: 6570 7265 7365 6e74 6162 6c65 2069 6e74  epresentable int
-0000c2a0: 6567 6572 206f 6620 696e 7465 6765 7220  eger of integer 
-0000c2b0: 7769 6474 6820 3120 6279 7465 2e0a 0a20  width 1 byte... 
-0000c2c0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000c2d0: 2073 6967 6e3a 2057 6865 6e20 302c 2074   sign: When 0, t
-0000c2e0: 6865 2073 6571 7565 6e63 6520 636f 6e74  he sequence cont
-0000c2f0: 696e 7565 7320 6174 2030 2061 6674 6572  inues at 0 after
-0000c300: 2077 7261 702d 6172 6f75 6e64 2e20 5768   wrap-around. Wh
-0000c310: 656e 2031 2c20 7468 6520 7365 7175 656e  en 1, the sequen
-0000c320: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
-0000c330: 6f6e 7469 6e75 6573 2061 7420 736d 616c  ontinues at smal
-0000c340: 6c65 7374 2072 6570 7265 7365 6e74 6162  lest representab
-0000c350: 6c65 2031 2062 7974 6520 696e 7465 6765  le 1 byte intege
-0000c360: 722e 2044 6566 6175 6c74 7320 746f 2030  r. Defaults to 0
-0000c370: 2e0a 0a20 2020 2053 6565 2041 6c73 6f3a  ...    See Also:
-0000c380: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
-0000c390: 3a60 5365 7373 696f 6e2e 6765 6e65 7261  :`Session.genera
-0000c3a0: 746f 7260 2c20 7768 6963 6820 6361 6e20  tor`, which can 
-0000c3b0: 6265 2075 7365 6420 746f 2067 656e 6572  be used to gener
-0000c3c0: 6174 6520 696e 2074 616e 6465 6d20 7769  ate in tandem wi
-0000c3d0: 7468 2060 7365 7131 6020 746f 0a20 2020  th `seq1` to.   
-0000c3e0: 2020 2020 2020 2020 2067 656e 6572 6174           generat
-0000c3f0: 6520 7365 7175 656e 6365 732e 0a0a 2020  e sequences...  
-0000c400: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-0000c410: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000c420: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
-0000c430: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
-0000c440: 3d33 290a 2020 2020 2020 2020 3e3e 3e20  =3).        >>> 
-0000c450: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
-0000c460: 2020 2020 205b 526f 7728 5345 5131 2830       [Row(SEQ1(0
-0000c470: 293d 3029 2c20 526f 7728 5345 5131 2830  )=0), Row(SEQ1(0
-0000c480: 293d 3129 2c20 526f 7728 5345 5131 2830  )=1), Row(SEQ1(0
-0000c490: 293d 3229 5d0a 2020 2020 2222 220a 2020  )=2)].    """.  
-0000c4a0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0000c4b0: 2822 7365 7131 2229 284c 6974 6572 616c  ("seq1")(Literal
-0000c4c0: 2873 6967 6e29 290a 0a0a 6465 6620 7365  (sign))...def se
-0000c4d0: 7132 2873 6967 6e3a 2069 6e74 203d 2030  q2(sign: int = 0
-0000c4e0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0000c4f0: 2022 2222 5265 7475 726e 7320 6120 7365   """Returns a se
-0000c500: 7175 656e 6365 206f 6620 6d6f 6e6f 746f  quence of monoto
-0000c510: 6e69 6361 6c6c 7920 696e 6372 6561 7369  nically increasi
-0000c520: 6e67 2069 6e74 6567 6572 732c 2077 6974  ng integers, wit
-0000c530: 6820 7772 6170 2d61 726f 756e 640a 2020  h wrap-around.  
-0000c540: 2020 7768 6963 6820 6861 7070 656e 7320    which happens 
-0000c550: 6166 7465 7220 6c61 7267 6573 7420 7265  after largest re
-0000c560: 7072 6573 656e 7461 626c 6520 696e 7465  presentable inte
-0000c570: 6765 7220 6f66 2069 6e74 6567 6572 2077  ger of integer w
-0000c580: 6964 7468 2032 2062 7974 652e 0a0a 2020  idth 2 byte...  
-0000c590: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0000c5a0: 7369 676e 3a20 5768 656e 2030 2c20 7468  sign: When 0, th
-0000c5b0: 6520 7365 7175 656e 6365 2063 6f6e 7469  e sequence conti
-0000c5c0: 6e75 6573 2061 7420 3020 6166 7465 7220  nues at 0 after 
-0000c5d0: 7772 6170 2d61 726f 756e 642e 2057 6865  wrap-around. Whe
-0000c5e0: 6e20 312c 2074 6865 2073 6571 7565 6e63  n 1, the sequenc
-0000c5f0: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
-0000c600: 6e74 696e 7565 7320 6174 2073 6d61 6c6c  ntinues at small
-0000c610: 6573 7420 7265 7072 6573 656e 7461 626c  est representabl
-0000c620: 6520 3220 6279 7465 2069 6e74 6567 6572  e 2 byte integer
-0000c630: 2e20 4465 6661 756c 7473 2074 6f20 302e  . Defaults to 0.
-0000c640: 0a0a 2020 2020 5365 6520 416c 736f 3a0a  ..    See Also:.
-0000c650: 2020 2020 2020 2020 2d20 3a6d 6574 683a          - :meth:
-0000c660: 6053 6573 7369 6f6e 2e67 656e 6572 6174  `Session.generat
-0000c670: 6f72 602c 2077 6869 6368 2063 616e 2062  or`, which can b
-0000c680: 6520 7573 6564 2074 6f20 6765 6e65 7261  e used to genera
-0000c690: 7465 2069 6e20 7461 6e64 656d 2077 6974  te in tandem wit
-0000c6a0: 6820 6073 6571 3260 2074 6f0a 2020 2020  h `seq2` to.    
-0000c6b0: 2020 2020 2020 2020 6765 6e65 7261 7465          generate
-0000c6c0: 2073 6571 7565 6e63 6573 2e0a 0a20 2020   sequences...   
-0000c6d0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0000c6e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0000c6f0: 696f 6e2e 6765 6e65 7261 746f 7228 7365  ion.generator(se
-0000c700: 7132 2830 292c 2072 6f77 636f 756e 743d  q2(0), rowcount=
-0000c710: 3329 0a20 2020 2020 2020 203e 3e3e 2064  3).        >>> d
-0000c720: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
-0000c730: 2020 2020 5b52 6f77 2853 4551 3228 3029      [Row(SEQ2(0)
-0000c740: 3d30 292c 2052 6f77 2853 4551 3228 3029  =0), Row(SEQ2(0)
-0000c750: 3d31 292c 2052 6f77 2853 4551 3228 3029  =1), Row(SEQ2(0)
-0000c760: 3d32 295d 0a20 2020 2022 2222 0a20 2020  =2)].    """.   
-0000c770: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000c780: 2273 6571 3222 2928 4c69 7465 7261 6c28  "seq2")(Literal(
-0000c790: 7369 676e 2929 0a0a 0a64 6566 2073 6571  sign))...def seq
-0000c7a0: 3428 7369 676e 3a20 696e 7420 3d20 3029  4(sign: int = 0)
-0000c7b0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0000c7c0: 2222 2252 6574 7572 6e73 2061 2073 6571  """Returns a seq
-0000c7d0: 7565 6e63 6520 6f66 206d 6f6e 6f74 6f6e  uence of monoton
-0000c7e0: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
-0000c7f0: 6720 696e 7465 6765 7273 2c20 7769 7468  g integers, with
-0000c800: 2077 7261 702d 6172 6f75 6e64 0a20 2020   wrap-around.   
-0000c810: 2077 6869 6368 2068 6170 7065 6e73 2061   which happens a
-0000c820: 6674 6572 206c 6172 6765 7374 2072 6570  fter largest rep
-0000c830: 7265 7365 6e74 6162 6c65 2069 6e74 6567  resentable integ
-0000c840: 6572 206f 6620 696e 7465 6765 7220 7769  er of integer wi
-0000c850: 6474 6820 3420 6279 7465 2e0a 0a20 2020  dth 4 byte...   
-0000c860: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
-0000c870: 6967 6e3a 2057 6865 6e20 302c 2074 6865  ign: When 0, the
-0000c880: 2073 6571 7565 6e63 6520 636f 6e74 696e   sequence contin
-0000c890: 7565 7320 6174 2030 2061 6674 6572 2077  ues at 0 after w
-0000c8a0: 7261 702d 6172 6f75 6e64 2e20 5768 656e  rap-around. When
-0000c8b0: 2031 2c20 7468 6520 7365 7175 656e 6365   1, the sequence
-0000c8c0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-0000c8d0: 7469 6e75 6573 2061 7420 736d 616c 6c65  tinues at smalle
-0000c8e0: 7374 2072 6570 7265 7365 6e74 6162 6c65  st representable
-0000c8f0: 2034 2062 7974 6520 696e 7465 6765 722e   4 byte integer.
-0000c900: 2044 6566 6175 6c74 7320 746f 2030 2e0a   Defaults to 0..
-0000c910: 0a20 2020 2053 6565 2041 6c73 6f3a 0a20  .    See Also:. 
-0000c920: 2020 2020 2020 202d 203a 6d65 7468 3a60         - :meth:`
-0000c930: 5365 7373 696f 6e2e 6765 6e65 7261 746f  Session.generato
-0000c940: 7260 2c20 7768 6963 6820 6361 6e20 6265  r`, which can be
-0000c950: 2075 7365 6420 746f 2067 656e 6572 6174   used to generat
-0000c960: 6520 696e 2074 616e 6465 6d20 7769 7468  e in tandem with
-0000c970: 2060 7365 7134 6020 746f 0a20 2020 2020   `seq4` to.     
-0000c980: 2020 2020 2020 2067 656e 6572 6174 6520         generate 
-0000c990: 7365 7175 656e 6365 732e 0a0a 2020 2020  sequences...    
-0000c9a0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-0000c9b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000c9c0: 6f6e 2e67 656e 6572 6174 6f72 2873 6571  on.generator(seq
-0000c9d0: 3428 3029 2c20 726f 7763 6f75 6e74 3d33  4(0), rowcount=3
-0000c9e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000c9f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0000ca00: 2020 205b 526f 7728 5345 5134 2830 293d     [Row(SEQ4(0)=
-0000ca10: 3029 2c20 526f 7728 5345 5134 2830 293d  0), Row(SEQ4(0)=
-0000ca20: 3129 2c20 526f 7728 5345 5134 2830 293d  1), Row(SEQ4(0)=
-0000ca30: 3229 5d0a 2020 2020 2222 220a 2020 2020  2)].    """.    
-0000ca40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000ca50: 7365 7134 2229 284c 6974 6572 616c 2873  seq4")(Literal(s
-0000ca60: 6967 6e29 290a 0a0a 6465 6620 7365 7138  ign))...def seq8
-0000ca70: 2873 6967 6e3a 2069 6e74 203d 2030 2920  (sign: int = 0) 
-0000ca80: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000ca90: 2222 5265 7475 726e 7320 6120 7365 7175  ""Returns a sequ
-0000caa0: 656e 6365 206f 6620 6d6f 6e6f 746f 6e69  ence of monotoni
-0000cab0: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
-0000cac0: 2069 6e74 6567 6572 732c 2077 6974 6820   integers, with 
-0000cad0: 7772 6170 2d61 726f 756e 640a 2020 2020  wrap-around.    
-0000cae0: 7768 6963 6820 6861 7070 656e 7320 6166  which happens af
-0000caf0: 7465 7220 6c61 7267 6573 7420 7265 7072  ter largest repr
-0000cb00: 6573 656e 7461 626c 6520 696e 7465 6765  esentable intege
-0000cb10: 7220 6f66 2069 6e74 6567 6572 2077 6964  r of integer wid
-0000cb20: 7468 2038 2062 7974 652e 0a0a 2020 2020  th 8 byte...    
-0000cb30: 4172 6773 3a0a 2020 2020 2020 2020 7369  Args:.        si
-0000cb40: 676e 3a20 5768 656e 2030 2c20 7468 6520  gn: When 0, the 
-0000cb50: 7365 7175 656e 6365 2063 6f6e 7469 6e75  sequence continu
-0000cb60: 6573 2061 7420 3020 6166 7465 7220 7772  es at 0 after wr
-0000cb70: 6170 2d61 726f 756e 642e 2057 6865 6e20  ap-around. When 
-0000cb80: 312c 2074 6865 2073 6571 7565 6e63 650a  1, the sequence.
-0000cb90: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0000cba0: 696e 7565 7320 6174 2073 6d61 6c6c 6573  inues at smalles
-0000cbb0: 7420 7265 7072 6573 656e 7461 626c 6520  t representable 
-0000cbc0: 3820 6279 7465 2069 6e74 6567 6572 2e20  8 byte integer. 
-0000cbd0: 4465 6661 756c 7473 2074 6f20 302e 0a0a  Defaults to 0...
-0000cbe0: 2020 2020 5365 6520 416c 736f 3a0a 2020      See Also:.  
-0000cbf0: 2020 2020 2020 2d20 3a6d 6574 683a 6053        - :meth:`S
-0000cc00: 6573 7369 6f6e 2e67 656e 6572 6174 6f72  ession.generator
-0000cc10: 602c 2077 6869 6368 2063 616e 2062 6520  `, which can be 
-0000cc20: 7573 6564 2074 6f20 6765 6e65 7261 7465  used to generate
-0000cc30: 2069 6e20 7461 6e64 656d 2077 6974 6820   in tandem with 
-0000cc40: 6073 6571 3860 2074 6f0a 2020 2020 2020  `seq8` to.      
-0000cc50: 2020 2020 2020 6765 6e65 7261 7465 2073        generate s
-0000cc60: 6571 7565 6e63 6573 2e0a 0a20 2020 2045  equences...    E
-0000cc70: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0000cc80: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0000cc90: 6e2e 6765 6e65 7261 746f 7228 7365 7138  n.generator(seq8
-0000cca0: 2830 292c 2072 6f77 636f 756e 743d 3329  (0), rowcount=3)
-0000ccb0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000ccc0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0000ccd0: 2020 5b52 6f77 2853 4551 3828 3029 3d30    [Row(SEQ8(0)=0
-0000cce0: 292c 2052 6f77 2853 4551 3828 3029 3d31  ), Row(SEQ8(0)=1
-0000ccf0: 292c 2052 6f77 2853 4551 3828 3029 3d32  ), Row(SEQ8(0)=2
-0000cd00: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
-0000cd10: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
-0000cd20: 6571 3822 2928 4c69 7465 7261 6c28 7369  eq8")(Literal(si
-0000cd30: 676e 2929 0a0a 0a64 6566 2074 6f5f 6465  gn))...def to_de
-0000cd40: 6369 6d61 6c28 653a 2043 6f6c 756d 6e4f  cimal(e: ColumnO
-0000cd50: 724e 616d 652c 2070 7265 6369 7369 6f6e  rName, precision
-0000cd60: 3a20 696e 742c 2073 6361 6c65 3a20 696e  : int, scale: in
-0000cd70: 7429 202d 3e20 436f 6c75 6d6e 3a0a 2020  t) -> Column:.  
-0000cd80: 2020 2222 2243 6f6e 7665 7274 7320 616e    """Converts an
-0000cd90: 2069 6e70 7574 2065 7870 7265 7373 696f   input expressio
-0000cda0: 6e20 746f 2061 2064 6563 696d 616c 2e0a  n to a decimal..
-0000cdb0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0000cdc0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000cdd0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0000cde0: 6174 6166 7261 6d65 285b 2731 3227 2c20  ataframe(['12', 
-0000cdf0: 2731 312e 3327 2c20 272d 3930 2e31 3233  '11.3', '-90.123
-0000ce00: 3435 275d 2c20 7363 6865 6d61 3d5b 2761  45'], schema=['a
-0000ce10: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-0000ce20: 6466 2e73 656c 6563 7428 746f 5f64 6563  df.select(to_dec
-0000ce30: 696d 616c 2863 6f6c 2827 6127 292c 2033  imal(col('a'), 3
-0000ce40: 382c 2030 292e 6173 5f28 2761 6e73 2729  8, 0).as_('ans')
-0000ce50: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0000ce60: 2020 2020 5b52 6f77 2841 4e53 3d31 3229      [Row(ANS=12)
-0000ce70: 2c20 526f 7728 414e 533d 3131 292c 2052  , Row(ANS=11), R
-0000ce80: 6f77 2841 4e53 3d2d 3930 295d 0a0a 2020  ow(ANS=-90)]..  
-0000ce90: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000cea0: 6563 7428 746f 5f64 6563 696d 616c 2863  ect(to_decimal(c
-0000ceb0: 6f6c 2827 6127 292c 2033 382c 2032 292e  ol('a'), 38, 2).
-0000cec0: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
-0000ced0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0000cee0: 6f77 2841 4e53 3d44 6563 696d 616c 2827  ow(ANS=Decimal('
-0000cef0: 3132 2e30 3027 2929 2c20 526f 7728 414e  12.00')), Row(AN
-0000cf00: 533d 4465 6369 6d61 6c28 2731 312e 3330  S=Decimal('11.30
-0000cf10: 2729 292c 2052 6f77 2841 4e53 3d44 6563  ')), Row(ANS=Dec
-0000cf20: 696d 616c 2827 2d39 302e 3132 2729 295d  imal('-90.12'))]
-0000cf30: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0000cf40: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000cf50: 652c 2022 746f 5f64 6563 696d 616c 2229  e, "to_decimal")
-0000cf60: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000cf70: 7469 6e28 2274 6f5f 6465 6369 6d61 6c22  tin("to_decimal"
-0000cf80: 2928 632c 206c 6974 2870 7265 6369 7369  )(c, lit(precisi
-0000cf90: 6f6e 292c 206c 6974 2873 6361 6c65 2929  on), lit(scale))
-0000cfa0: 0a0a 0a64 6566 2064 6976 3028 0a20 2020  ...def div0(.   
-0000cfb0: 2064 6976 6964 656e 643a 2055 6e69 6f6e   dividend: Union
-0000cfc0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-0000cfd0: 6e74 2c20 666c 6f61 745d 2c20 6469 7669  nt, float], divi
-0000cfe0: 736f 723a 2055 6e69 6f6e 5b43 6f6c 756d  sor: Union[Colum
-0000cff0: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
-0000d000: 6f61 745d 0a29 202d 3e20 436f 6c75 6d6e  oat].) -> Column
-0000d010: 3a0a 2020 2020 2222 220a 2020 2020 5065  :.    """.    Pe
-0000d020: 7266 6f72 6d73 2064 6976 6973 696f 6e20  rforms division 
-0000d030: 6c69 6b65 2074 6865 2064 6976 6973 696f  like the divisio
-0000d040: 6e20 6f70 6572 6174 6f72 2028 2f29 2c0a  n operator (/),.
-0000d050: 2020 2020 6275 7420 7265 7475 726e 7320      but returns 
-0000d060: 3020 7768 656e 2074 6865 2064 6976 6973  0 when the divis
-0000d070: 6f72 2069 7320 3020 2872 6174 6865 7220  or is 0 (rather 
-0000d080: 7468 616e 2072 6570 6f72 7469 6e67 2061  than reporting a
-0000d090: 6e20 6572 726f 7229 2e0a 0a20 2020 2045  n error)...    E
-0000d0a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0000d0b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000d0c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000d0d0: 616d 6528 5b31 5d2c 2073 6368 656d 613d  ame([1], schema=
-0000d0e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-0000d0f0: 3e3e 2064 662e 7365 6c65 6374 2864 6976  >> df.select(div
-0000d100: 3028 6466 5b22 6122 5d2c 2031 292e 616c  0(df["a"], 1).al
-0000d110: 6961 7328 2264 6976 6964 6564 5f62 795f  ias("divided_by_
-0000d120: 6f6e 6522 292c 2064 6976 3028 6466 5b22  one"), div0(df["
-0000d130: 6122 5d2c 2030 292e 616c 6961 7328 2264  a"], 0).alias("d
-0000d140: 6976 6964 6564 5f62 795f 7a65 726f 2229  ivided_by_zero")
-0000d150: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0000d160: 2020 2020 5b52 6f77 2844 4956 4944 4544      [Row(DIVIDED
-0000d170: 5f42 595f 4f4e 453d 4465 6369 6d61 6c28  _BY_ONE=Decimal(
-0000d180: 2731 2e30 3030 3030 3027 292c 2044 4956  '1.000000'), DIV
-0000d190: 4944 4544 5f42 595f 5a45 524f 3d44 6563  IDED_BY_ZERO=Dec
-0000d1a0: 696d 616c 2827 302e 3030 3030 3030 2729  imal('0.000000')
-0000d1b0: 295d 0a20 2020 2022 2222 0a20 2020 2064  )].    """.    d
-0000d1c0: 6976 6964 656e 645f 636f 6c20 3d20 280a  ividend_col = (.
-0000d1d0: 2020 2020 2020 2020 6c69 7428 6469 7669          lit(divi
-0000d1e0: 6465 6e64 290a 2020 2020 2020 2020 6966  dend).        if
-0000d1f0: 2069 7369 6e73 7461 6e63 6528 6469 7669   isinstance(divi
-0000d200: 6465 6e64 2c20 2869 6e74 2c20 666c 6f61  dend, (int, floa
-0000d210: 7429 290a 2020 2020 2020 2020 656c 7365  t)).        else
-0000d220: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000d230: 6469 7669 6465 6e64 2c20 2264 6976 3022  dividend, "div0"
-0000d240: 290a 2020 2020 290a 2020 2020 6469 7669  ).    ).    divi
-0000d250: 736f 725f 636f 6c20 3d20 280a 2020 2020  sor_col = (.    
-0000d260: 2020 2020 6c69 7428 6469 7669 736f 7229      lit(divisor)
-0000d270: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0000d280: 7374 616e 6365 2864 6976 6973 6f72 2c20  stance(divisor, 
-0000d290: 2869 6e74 2c20 666c 6f61 7429 290a 2020  (int, float)).  
-0000d2a0: 2020 2020 2020 656c 7365 205f 746f 5f63        else _to_c
-0000d2b0: 6f6c 5f69 665f 7374 7228 6469 7669 736f  ol_if_str(diviso
-0000d2c0: 722c 2022 6469 7630 2229 0a20 2020 2029  r, "div0").    )
-0000d2d0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000d2e0: 7469 6e28 2264 6976 3022 2928 6469 7669  tin("div0")(divi
-0000d2f0: 6465 6e64 5f63 6f6c 2c20 6469 7669 736f  dend_col, diviso
-0000d300: 725f 636f 6c29 0a0a 0a64 6566 2073 7172  r_col)...def sqr
-0000d310: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
-0000d320: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0000d330: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-0000d340: 2073 7175 6172 652d 726f 6f74 206f 6620   square-root of 
-0000d350: 6120 6e6f 6e2d 6e65 6761 7469 7665 206e  a non-negative n
-0000d360: 756d 6572 6963 2065 7870 7265 7373 696f  umeric expressio
-0000d370: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
-0000d380: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-0000d390: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000d3a0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-0000d3b0: 2020 2020 202e 2e2e 2020 2020 205b 342c       ...     [4,
-0000d3c0: 2039 5d2c 0a20 2020 2020 2020 202e 2e2e   9],.        ...
-0000d3d0: 2020 2020 2073 6368 656d 613d 5b22 4e22       schema=["N"
-0000d3e0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
-0000d3f0: 2e73 656c 6563 7428 7371 7274 2863 6f6c  .select(sqrt(col
-0000d400: 2822 4e22 2929 290a 2020 2020 2020 2020  ("N"))).        
-0000d410: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
-0000d420: 0a20 2020 2020 2020 205b 526f 7728 5351  .        [Row(SQ
-0000d430: 5254 2822 4e22 293d 322e 3029 2c20 526f  RT("N")=2.0), Ro
-0000d440: 7728 5351 5254 2822 4e22 293d 332e 3029  w(SQRT("N")=3.0)
-0000d450: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0000d460: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000d470: 2865 2c20 2273 7172 7422 290a 2020 2020  (e, "sqrt").    
-0000d480: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000d490: 7371 7274 2229 2863 290a 0a0a 6465 6620  sqrt")(c)...def 
-0000d4a0: 6162 7328 653a 2043 6f6c 756d 6e4f 724e  abs(e: ColumnOrN
-0000d4b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000d4c0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-0000d4d0: 6865 2061 6273 6f6c 7574 6520 7661 6c75  he absolute valu
-0000d4e0: 6520 6f66 2061 206e 756d 6572 6963 2065  e of a numeric e
-0000d4f0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
-0000d500: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-0000d510: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000d520: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000d530: 616d 6528 5b5b 2d31 5d5d 2c20 7363 6865  ame([[-1]], sche
-0000d540: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000d550: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000d560: 6162 7328 636f 6c28 2261 2229 292e 616c  abs(col("a")).al
-0000d570: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-0000d580: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0000d590: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000d5a0: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-0000d5b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000d5c0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
-0000d5d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0000d5e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000d5f0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000d600: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0000d610: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000d620: 7228 652c 2022 6162 7322 290a 2020 2020  r(e, "abs").    
-0000d630: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000d640: 6162 7322 2928 6329 0a0a 0a64 6566 2061  abs")(c)...def a
-0000d650: 636f 7328 653a 2043 6f6c 756d 6e4f 724e  cos(e: ColumnOrN
-0000d660: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000d670: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
-0000d680: 7468 6520 696e 7665 7273 6520 636f 7369  the inverse cosi
-0000d690: 6e65 2028 6172 6320 636f 7369 6e65 2920  ne (arc cosine) 
-0000d6a0: 6f66 2069 7473 2069 6e70 7574 3b0a 2020  of its input;.  
-0000d6b0: 2020 7468 6520 7265 7375 6c74 2069 7320    the result is 
-0000d6c0: 6120 6e75 6d62 6572 2069 6e20 7468 6520  a number in the 
-0000d6d0: 696e 7465 7276 616c 205b 2d70 692c 2070  interval [-pi, p
-0000d6e0: 695d 2e0a 0a20 2020 2045 7861 6d70 6c65  i]...    Example
-0000d6f0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
-0000d700: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-0000d710: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-0000d720: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
-0000d730: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000d740: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0000d750: 6461 7461 6672 616d 6528 5b5b 302e 355d  dataframe([[0.5]
-0000d760: 5d2c 2073 6368 656d 613d 5b22 6465 6722  ], schema=["deg"
-0000d770: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000d780: 662e 7365 6c65 6374 2861 636f 7328 636f  f.select(acos(co
-0000d790: 6c28 2264 6567 2229 292e 6361 7374 2844  l("deg")).cast(D
-0000d7a0: 6563 696d 616c 5479 7065 2873 6361 6c65  ecimalType(scale
-0000d7b0: 3d33 2929 2e61 6c69 6173 2822 7265 7375  =3)).alias("resu
-0000d7c0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-0000d7d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000d7e0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-0000d7f0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-0000d800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000d810: 2020 2020 7c31 2e30 3437 2020 2020 207c      |1.047     |
-0000d820: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000d830: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0000d840: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0000d850: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0000d860: 6c5f 6966 5f73 7472 2865 2c20 2261 636f  l_if_str(e, "aco
-0000d870: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
-0000d880: 7569 6c74 696e 2822 6163 6f73 2229 2863  uiltin("acos")(c
-0000d890: 290a 0a0a 6465 6620 6173 696e 2865 3a20  )...def asin(e: 
-0000d8a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0000d8b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0000d8c0: 436f 6d70 7574 6573 2074 6865 2069 6e76  Computes the inv
-0000d8d0: 6572 7365 2073 696e 6520 2861 7263 2073  erse sine (arc s
-0000d8e0: 696e 6529 206f 6620 6974 7320 696e 7075  ine) of its inpu
-0000d8f0: 743b 0a20 2020 2074 6865 2072 6573 756c  t;.    the resul
-0000d900: 7420 6973 2061 206e 756d 6265 7220 696e  t is a number in
-0000d910: 2074 6865 2069 6e74 6572 7661 6c20 5b2d   the interval [-
-0000d920: 7069 2c20 7069 5d2e 0a0a 2020 2020 4578  pi, pi]...    Ex
-0000d930: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-0000d940: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0000d950: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-0000d960: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
-0000d970: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-0000d980: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0000d990: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0000d9a0: 5b31 5d5d 2c20 7363 6865 6d61 3d5b 2264  [1]], schema=["d
-0000d9b0: 6567 225d 290a 2020 2020 2020 2020 3e3e  eg"]).        >>
-0000d9c0: 3e20 6466 2e73 656c 6563 7428 6173 696e  > df.select(asin
-0000d9d0: 2863 6f6c 2822 6465 6722 2929 2e63 6173  (col("deg")).cas
-0000d9e0: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
-0000d9f0: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
-0000da00: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0000da10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000da20: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0000da30: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0000da40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000da50: 2020 2020 2020 207c 312e 3537 3120 2020         |1.571   
-0000da60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0000da70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000da80: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0000da90: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0000daa0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-0000dab0: 6173 696e 2229 0a20 2020 2072 6574 7572  asin").    retur
-0000dac0: 6e20 6275 696c 7469 6e28 2261 7369 6e22  n builtin("asin"
-0000dad0: 2928 6329 0a0a 0a64 6566 2061 7461 6e28  )(c)...def atan(
-0000dae0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0000daf0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0000db00: 2222 2243 6f6d 7075 7465 7320 7468 6520  """Computes the 
-0000db10: 696e 7665 7273 6520 7461 6e67 656e 7420  inverse tangent 
-0000db20: 2861 7263 2074 616e 6765 6e74 2920 6f66  (arc tangent) of
-0000db30: 2069 7473 2069 6e70 7574 3b0a 2020 2020   its input;.    
-0000db40: 7468 6520 7265 7375 6c74 2069 7320 6120  the result is a 
-0000db50: 6e75 6d62 6572 2069 6e20 7468 6520 696e  number in the in
-0000db60: 7465 7276 616c 205b 2d70 692c 2070 695d  terval [-pi, pi]
-0000db70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0000db80: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0000db90: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0000dba0: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-0000dbb0: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
-0000dbc0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000dbd0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000dbe0: 7461 6672 616d 6528 5b5b 315d 5d2c 2073  taframe([[1]], s
-0000dbf0: 6368 656d 613d 5b22 6465 6722 5d29 0a20  chema=["deg"]). 
-0000dc00: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000dc10: 6c65 6374 2861 7461 6e28 636f 6c28 2264  lect(atan(col("d
-0000dc20: 6567 2229 292e 6361 7374 2844 6563 696d  eg")).cast(Decim
-0000dc30: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
-0000dc40: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-0000dc50: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0000dc60: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0000dc70: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-0000dc80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000dc90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000dca0: 7c30 2e37 3835 2020 2020 207c 0a20 2020  |0.785     |.   
-0000dcb0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000dcc0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000dcd0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0000dce0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000dcf0: 5f73 7472 2865 2c20 2261 7461 6e22 290a  _str(e, "atan").
-0000dd00: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000dd10: 696e 2822 6174 616e 2229 2863 290a 0a0a  in("atan")(c)...
-0000dd20: 6465 6620 6174 616e 3228 793a 2043 6f6c  def atan2(y: Col
-0000dd30: 756d 6e4f 724e 616d 652c 2078 3a20 436f  umnOrName, x: Co
-0000dd40: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000dd50: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
-0000dd60: 6d70 7574 6573 2074 6865 2069 6e76 6572  mputes the inver
-0000dd70: 7365 2074 616e 6765 6e74 2028 6172 6320  se tangent (arc 
-0000dd80: 7461 6e67 656e 7429 206f 6620 6974 7320  tangent) of its 
-0000dd90: 696e 7075 743b 0a20 2020 2074 6865 2072  input;.    the r
-0000dda0: 6573 756c 7420 6973 2061 206e 756d 6265  esult is a numbe
-0000ddb0: 7220 696e 2074 6865 2069 6e74 6572 7661  r in the interva
-0000ddc0: 6c20 5b2d 7069 2c20 7069 5d2e 0a0a 2020  l [-pi, pi]...  
-0000ddd0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-0000dde0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0000ddf0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0000de00: 7479 7065 7320 696d 706f 7274 2044 6563  types import Dec
-0000de10: 696d 616c 5479 7065 0a20 2020 2020 2020  imalType.       
-0000de20: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0000de30: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0000de40: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
-0000de50: 656d 613d 5b22 7822 2c20 2279 225d 290a  ema=["x", "y"]).
-0000de60: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000de70: 656c 6563 7428 6174 616e 3228 6466 2e78  elect(atan2(df.x
-0000de80: 2c20 6466 2e79 292e 6361 7374 2844 6563  , df.y).cast(Dec
-0000de90: 696d 616c 5479 7065 2873 6361 6c65 3d33  imalType(scale=3
-0000dea0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
-0000deb0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-0000dec0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0000ded0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-0000dee0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-0000def0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000df00: 2020 7c30 2e34 3634 2020 2020 207c 0a20    |0.464     |. 
-0000df10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000df20: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0000df30: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0000df40: 2020 2020 795f 636f 6c20 3d20 5f74 6f5f      y_col = _to_
-0000df50: 636f 6c5f 6966 5f73 7472 2879 2c20 2261  col_if_str(y, "a
-0000df60: 7461 6e32 2229 0a20 2020 2078 5f63 6f6c  tan2").    x_col
-0000df70: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000df80: 7228 782c 2022 6174 616e 3222 290a 2020  r(x, "atan2").  
-0000df90: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0000dfa0: 2822 6174 616e 3222 2928 795f 636f 6c2c  ("atan2")(y_col,
-0000dfb0: 2078 5f63 6f6c 290a 0a0a 6465 6620 6365   x_col)...def ce
-0000dfc0: 696c 2865 3a20 436f 6c75 6d6e 4f72 4e61  il(e: ColumnOrNa
-0000dfd0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000dfe0: 2020 2022 2222 5265 7475 726e 7320 7661     """Returns va
-0000dff0: 6c75 6573 2066 726f 6d20 7468 6520 7370  lues from the sp
-0000e000: 6563 6966 6965 6420 636f 6c75 6d6e 2072  ecified column r
-0000e010: 6f75 6e64 6564 2074 6f20 7468 6520 6e65  ounded to the ne
-0000e020: 6172 6573 7420 6571 7561 6c20 6f72 206c  arest equal or l
-0000e030: 6172 6765 720a 2020 2020 696e 7465 6765  arger.    intege
-0000e040: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
-0000e050: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-0000e060: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000e070: 7465 5f64 6174 6166 7261 6d65 285b 3133  te_dataframe([13
-0000e080: 352e 3133 352c 202d 3937 352e 3937 355d  5.135, -975.975]
-0000e090: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0000e0a0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000e0b0: 656c 6563 7428 6365 696c 2864 665b 2261  elect(ceil(df["a
-0000e0c0: 225d 292e 616c 6961 7328 2263 6569 6c22  "]).alias("ceil"
-0000e0d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0000e0e0: 2020 2020 205b 526f 7728 4345 494c 3d31       [Row(CEIL=1
-0000e0f0: 3336 2e30 292c 2052 6f77 2843 4549 4c3d  36.0), Row(CEIL=
-0000e100: 2d39 3735 2e30 295d 0a20 2020 2022 2222  -975.0)].    """
-0000e110: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0000e120: 5f69 665f 7374 7228 652c 2022 6365 696c  _if_str(e, "ceil
-0000e130: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0000e140: 696c 7469 6e28 2263 6569 6c22 2928 6329  iltin("ceil")(c)
-0000e150: 0a0a 0a64 6566 2063 6f73 2865 3a20 436f  ...def cos(e: Co
-0000e160: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000e170: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
-0000e180: 6d70 7574 6573 2074 6865 2063 6f73 696e  mputes the cosin
-0000e190: 6520 6f66 2069 7473 2061 7267 756d 656e  e of its argumen
-0000e1a0: 743b 2074 6865 2061 7267 756d 656e 7420  t; the argument 
-0000e1b0: 7368 6f75 6c64 2062 6520 6578 7072 6573  should be expres
-0000e1c0: 7365 6420 696e 2072 6164 6961 6e73 2e0a  sed in radians..
-0000e1d0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
-0000e1e0: 2020 2020 2020 3e3e 3e20 6672 6f6d 206d        >>> from m
-0000e1f0: 6174 6820 696d 706f 7274 2070 690a 2020  ath import pi.  
-0000e200: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000e210: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000e220: 7461 6672 616d 6528 5b5b 7069 5d5d 2c20  taframe([[pi]], 
-0000e230: 7363 6865 6d61 3d5b 2264 6567 225d 290a  schema=["deg"]).
-0000e240: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000e250: 656c 6563 7428 636f 7328 636f 6c28 2264  elect(cos(col("d
-0000e260: 6567 2229 292e 616c 6961 7328 2272 6573  eg")).alias("res
-0000e270: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0000e280: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000e290: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0000e2a0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-0000e2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000e2c0: 2020 2020 207c 2d31 2e30 2020 2020 2020       |-1.0      
-0000e2d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000e2e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0000e2f0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0000e300: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0000e310: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
-0000e320: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
-0000e330: 7569 6c74 696e 2822 636f 7322 2928 6329  uiltin("cos")(c)
-0000e340: 0a0a 0a64 6566 2063 6f73 6828 653a 2043  ...def cosh(e: C
-0000e350: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000e360: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0000e370: 6f6d 7075 7465 7320 7468 6520 6879 7065  omputes the hype
-0000e380: 7262 6f6c 6963 2063 6f73 696e 6520 6f66  rbolic cosine of
-0000e390: 2069 7473 2061 7267 756d 656e 742e 0a0a   its argument...
-0000e3a0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-0000e3b0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0000e3c0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0000e3d0: 2e74 7970 6573 2069 6d70 6f72 7420 4465  .types import De
-0000e3e0: 6369 6d61 6c54 7970 650a 2020 2020 2020  cimalType.      
-0000e3f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000e400: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000e410: 616d 6528 5b5b 305d 5d2c 2073 6368 656d  ame([[0]], schem
-0000e420: 613d 5b22 6465 6722 5d29 0a20 2020 2020  a=["deg"]).     
-0000e430: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0000e440: 2863 6f73 6828 636f 6c28 2264 6567 2229  (cosh(col("deg")
-0000e450: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-0000e460: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0000e470: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000e480: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0000e490: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0000e4a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000e4b0: 207c 312e 3020 2020 2020 2020 7c0a 2020   |1.0       |.  
-0000e4c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000e4d0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0000e4e0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-0000e4f0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000e500: 665f 7374 7228 652c 2022 636f 7368 2229  f_str(e, "cosh")
-0000e510: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000e520: 7469 6e28 2263 6f73 6822 2928 6329 0a0a  tin("cosh")(c)..
-0000e530: 0a64 6566 2065 7870 2865 3a20 436f 6c75  .def exp(e: Colu
-0000e540: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000e550: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0000e560: 2043 6f6d 7075 7465 7320 4575 6c65 7227   Computes Euler'
-0000e570: 7320 6e75 6d62 6572 2065 2072 6169 7365  s number e raise
-0000e580: 6420 746f 2061 2066 6c6f 6174 696e 672d  d to a floating-
-0000e590: 706f 696e 7420 7661 6c75 652e 0a0a 2020  point value...  
-0000e5a0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0000e5b0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0000e5c0: 6d61 7468 0a20 2020 2020 2020 203e 3e3e  math.        >>>
-0000e5d0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0000e5e0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0000e5f0: 6d70 6f72 7420 496e 7465 6765 7254 7970  mport IntegerTyp
-0000e600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0000e610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000e620: 655f 6461 7461 6672 616d 6528 5b30 2e30  e_dataframe([0.0
-0000e630: 2c20 6d61 7468 2e6c 6f67 2831 3029 5d2c  , math.log(10)],
-0000e640: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0000e650: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000e660: 6c65 6374 2865 7870 2864 665b 2261 225d  lect(exp(df["a"]
-0000e670: 292e 6361 7374 2849 6e74 6567 6572 5479  ).cast(IntegerTy
-0000e680: 7065 2829 292e 616c 6961 7328 2265 7870  pe()).alias("exp
-0000e690: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-0000e6a0: 2020 2020 2020 5b52 6f77 2845 5850 3d31        [Row(EXP=1
-0000e6b0: 292c 2052 6f77 2845 5850 3d31 3029 5d0a  ), Row(EXP=10)].
-0000e6c0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000e6d0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000e6e0: 2c20 2265 7870 2229 0a20 2020 2072 6574  , "exp").    ret
-0000e6f0: 7572 6e20 6275 696c 7469 6e28 2265 7870  urn builtin("exp
-0000e700: 2229 2863 290a 0a0a 6465 6620 6661 6374  ")(c)...def fact
-0000e710: 6f72 6961 6c28 653a 2043 6f6c 756d 6e4f  orial(e: ColumnO
-0000e720: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000e730: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
-0000e740: 6d70 7574 6573 2074 6865 2066 6163 746f  mputes the facto
-0000e750: 7269 616c 206f 6620 6974 7320 696e 7075  rial of its inpu
-0000e760: 742e 2054 6865 2069 6e70 7574 2061 7267  t. The input arg
-0000e770: 756d 656e 7420 6d75 7374 2062 6520 616e  ument must be an
-0000e780: 2069 6e74 6567 6572 0a20 2020 2065 7870   integer.    exp
-0000e790: 7265 7373 696f 6e20 696e 2074 6865 2072  ression in the r
-0000e7a0: 616e 6765 206f 6620 3020 746f 2033 332e  ange of 0 to 33.
-0000e7b0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0000e7c0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000e7d0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000e7e0: 5f64 6174 6166 7261 6d65 285b 302c 2031  _dataframe([0, 1
-0000e7f0: 2c20 352c 2031 305d 2c20 7363 6865 6d61  , 5, 10], schema
-0000e800: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-0000e810: 3e3e 3e20 6466 2e73 656c 6563 7428 6661  >>> df.select(fa
-0000e820: 6374 6f72 6961 6c28 6466 5b22 6122 5d29  ctorial(df["a"])
-0000e830: 2e61 6c69 6173 2822 6661 6374 6f72 6961  .alias("factoria
-0000e840: 6c22 2929 2e63 6f6c 6c65 6374 2829 0a20  l")).collect(). 
-0000e850: 2020 2020 2020 205b 526f 7728 4641 4354         [Row(FACT
-0000e860: 4f52 4941 4c3d 3129 2c20 526f 7728 4641  ORIAL=1), Row(FA
-0000e870: 4354 4f52 4941 4c3d 3129 2c20 526f 7728  CTORIAL=1), Row(
-0000e880: 4641 4354 4f52 4941 4c3d 3132 3029 2c20  FACTORIAL=120), 
-0000e890: 526f 7728 4641 4354 4f52 4941 4c3d 3336  Row(FACTORIAL=36
-0000e8a0: 3238 3830 3029 5d0a 2020 2020 2222 220a  28800)].    """.
-0000e8b0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0000e8c0: 6966 5f73 7472 2865 2c20 2266 6163 746f  if_str(e, "facto
-0000e8d0: 7269 616c 2229 0a20 2020 2072 6574 7572  rial").    retur
-0000e8e0: 6e20 6275 696c 7469 6e28 2266 6163 746f  n builtin("facto
-0000e8f0: 7269 616c 2229 2863 290a 0a0a 6465 6620  rial")(c)...def 
-0000e900: 666c 6f6f 7228 653a 2043 6f6c 756d 6e4f  floor(e: ColumnO
-0000e910: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000e920: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0000e930: 7475 726e 7320 7661 6c75 6573 2066 726f  turns values fro
-0000e940: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
-0000e950: 636f 6c75 6d6e 2072 6f75 6e64 6564 2074  column rounded t
-0000e960: 6f20 7468 6520 6e65 6172 6573 7420 6571  o the nearest eq
-0000e970: 7561 6c20 6f72 0a20 2020 2073 6d61 6c6c  ual or.    small
-0000e980: 6572 2069 6e74 6567 6572 2e0a 0a20 2020  er integer...   
-0000e990: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
-0000e9a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000e9b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000e9c0: 6166 7261 6d65 285b 3133 352e 3133 352c  aframe([135.135,
-0000e9d0: 202d 3937 352e 3937 355d 2c20 7363 6865   -975.975], sche
-0000e9e0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000e9f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000ea00: 666c 6f6f 7228 6466 5b22 6122 5d29 2e61  floor(df["a"]).a
-0000ea10: 6c69 6173 2822 666c 6f6f 7222 2929 2e63  lias("floor")).c
-0000ea20: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0000ea30: 205b 526f 7728 464c 4f4f 523d 3133 352e   [Row(FLOOR=135.
-0000ea40: 3029 2c20 526f 7728 464c 4f4f 523d 2d39  0), Row(FLOOR=-9
-0000ea50: 3736 2e30 295d 0a20 2020 2022 2222 0a20  76.0)].    """. 
-0000ea60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000ea70: 665f 7374 7228 652c 2022 666c 6f6f 7222  f_str(e, "floor"
-0000ea80: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0000ea90: 6c74 696e 2822 666c 6f6f 7222 2928 6329  ltin("floor")(c)
-0000eaa0: 0a0a 0a64 6566 2066 6f72 6d61 745f 6e75  ...def format_nu
-0000eab0: 6d62 6572 2863 6f6c 3a20 436f 6c75 6d6e  mber(col: Column
-0000eac0: 4f72 4e61 6d65 2c20 643a 2055 6e69 6f6e  OrName, d: Union
-0000ead0: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 3a0a  [Column, int]):.
-0000eae0: 2020 2020 2222 2246 6f72 6d61 7420 6e75      """Format nu
-0000eaf0: 6d62 6572 7320 746f 2061 2073 7065 6369  mbers to a speci
-0000eb00: 6669 6320 6e75 6d62 6572 206f 6620 6465  fic number of de
-0000eb10: 6369 6d61 6c20 706c 6163 6573 2077 6974  cimal places wit
-0000eb20: 6820 4841 4c46 5f54 4f5f 4556 454e 2072  h HALF_TO_EVEN r
-0000eb30: 6f75 6e64 696e 672e 0a0a 2020 2020 4e6f  ounding...    No
-0000eb40: 7465 3a0a 2020 2020 2020 2020 312e 2054  te:.        1. T
-0000eb50: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
-0000eb60: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
-0000eb70: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
-0000eb80: 6520 6064 6174 6120 7479 7065 7320 666f  e `data types fo
-0000eb90: 7220 6120 6669 7865 642d 706f 696e 7420  r a fixed-point 
-0000eba0: 6e75 6d62 6572 0a20 2020 2020 2020 203c  number.        <
-0000ebb0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-0000ebc0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-0000ebd0: 6c2d 7265 6665 7265 6e63 652f 6461 7461  l-reference/data
-0000ebe0: 2d74 7970 6573 2d6e 756d 6572 6963 2e68  -types-numeric.h
-0000ebf0: 746d 6c23 6c61 6265 6c2d 6461 7461 2d74  tml#label-data-t
-0000ec00: 7970 6573 2d66 6f72 2d66 6978 6564 2d70  ypes-for-fixed-p
-0000ec10: 6f69 6e74 2d6e 756d 6265 7273 3e60 5f2e  oint-numbers>`_.
-0000ec20: 0a0a 2020 2020 2020 2020 322e 2044 6174  ..        2. Dat
-0000ec30: 6120 7479 7065 7320 666f 7220 666c 6f61  a types for floa
-0000ec40: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
-0000ec50: 7273 2028 652e 672e 2046 4c4f 4154 2920  rs (e.g. FLOAT) 
-0000ec60: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
-0000ec70: 6420 7769 7468 2074 6869 7320 6172 6775  d with this argu
-0000ec80: 6d65 6e74 2e0a 0a20 2020 2020 2020 2033  ment...        3
-0000ec90: 2e20 4966 2074 6865 2065 7870 7265 7373  . If the express
-0000eca0: 696f 6e20 6461 7461 2074 7970 6520 6973  ion data type is
-0000ecb0: 206e 6f74 2073 7570 706f 7274 6564 2c20   not supported, 
-0000ecc0: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
-0000ecd0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
-0000ece0: 7920 6361 7374 2074 6f20 6465 6369 6d61  y cast to decima
-0000ecf0: 6c20 6265 666f 7265 2063 616c 6c69 6e67  l before calling
-0000ed00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0000ed10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0000ed20: 2069 6d70 6f72 7420 6465 6369 6d61 6c0a   import decimal.
-0000ed30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0000ed40: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0000ed50: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-0000ed60: 7320 696d 706f 7274 2066 6f72 6d61 745f  s import format_
-0000ed70: 6e75 6d62 6572 0a20 2020 2020 2020 2020  number.         
-0000ed80: 2020 203e 3e3e 2064 6174 6120 3d20 5b28     >>> data = [(
-0000ed90: 312c 2064 6563 696d 616c 2e44 6563 696d  1, decimal.Decim
-0000eda0: 616c 2833 2e31 3431 3539 2929 2c20 2832  al(3.14159)), (2
-0000edb0: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-0000edc0: 6c28 322e 3731 3832 3829 292c 2028 332c  l(2.71828)), (3,
-0000edd0: 2064 6563 696d 616c 2e44 6563 696d 616c   decimal.Decimal
-0000ede0: 2831 2e34 3134 3231 2929 5d0a 2020 2020  (1.41421))].    
-0000edf0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000ee00: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
-0000ee10: 6174 6146 7261 6d65 2864 6174 612c 205b  ataFrame(data, [
-0000ee20: 2269 6422 2c20 2276 616c 7565 225d 290a  "id", "value"]).
-0000ee30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0000ee40: 6466 2e73 656c 6563 7428 2269 6422 2c66  df.select("id",f
-0000ee50: 6f72 6d61 745f 6e75 6d62 6572 2822 7661  ormat_number("va
-0000ee60: 6c75 6522 2c32 292e 616c 6961 7328 2276  lue",2).alias("v
-0000ee70: 616c 7565 2229 292e 7368 6f77 2829 0a20  alue")).show(). 
-0000ee80: 2020 2020 2020 2020 2020 202d 2d2d 2d2d             -----
-0000ee90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0000eea0: 2020 2020 2020 2020 2020 7c22 4944 2220            |"ID" 
-0000eeb0: 207c 2256 414c 5545 2220 207c 0a20 2020   |"VALUE"  |.   
-0000eec0: 2020 2020 2020 2020 202d 2d2d 2d2d 2d2d           -------
-0000eed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000eee0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
-0000eef0: 332e 3134 2020 2020 207c 0a20 2020 2020  3.14     |.     
-0000ef00: 2020 2020 2020 207c 3220 2020 2020 7c32         |2     |2
-0000ef10: 2e37 3220 2020 2020 7c0a 2020 2020 2020  .72     |.      
-0000ef20: 2020 2020 2020 7c33 2020 2020 207c 312e        |3     |1.
-0000ef30: 3431 2020 2020 207c 0a20 2020 2020 2020  41     |.       
-0000ef40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000ef50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000ef60: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0000ef70: 2020 2020 2222 220a 2020 2020 636f 6c20      """.    col 
-0000ef80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000ef90: 2863 6f6c 2c20 2266 6f72 6d61 745f 6e75  (col, "format_nu
-0000efa0: 6d62 6572 2229 0a20 2020 2072 6574 7572  mber").    retur
-0000efb0: 6e20 6272 6f75 6e64 2863 6f6c 2c20 6429  n bround(col, d)
-0000efc0: 2e63 6173 7428 5374 7269 6e67 5479 7065  .cast(StringType
-0000efd0: 2829 290a 0a0a 6465 6620 7369 6e28 653a  ())...def sin(e:
-0000efe0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0000eff0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0000f000: 2243 6f6d 7075 7465 7320 7468 6520 7369  "Computes the si
-0000f010: 6e65 206f 6620 6974 7320 6172 6775 6d65  ne of its argume
-0000f020: 6e74 3b20 7468 6520 6172 6775 6d65 6e74  nt; the argument
-0000f030: 2073 686f 756c 6420 6265 2065 7870 7265   should be expre
-0000f040: 7373 6564 2069 6e20 7261 6469 616e 732e  ssed in radians.
-0000f050: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0000f060: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0000f070: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0000f080: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-0000f090: 2044 6563 696d 616c 5479 7065 0a20 2020   DecimalType.   
-0000f0a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000f0b0: 7373 696f 6e2e 6765 6e65 7261 746f 7228  ssion.generator(
-0000f0c0: 7365 7131 2830 292c 2072 6f77 636f 756e  seq1(0), rowcoun
-0000f0d0: 743d 3329 2e73 656c 6563 7428 7369 6e28  t=3).select(sin(
-0000f0e0: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
-0000f0f0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
-0000f100: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
-0000f110: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
-0000f120: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
-0000f130: 2853 494e 2853 4551 3128 3029 2920 4153  (SIN(SEQ1(0)) AS
-0000f140: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
-0000f150: 4465 6369 6d61 6c28 2730 2e30 3030 3027  Decimal('0.0000'
-0000f160: 2929 2c20 526f 7728 4341 5354 2028 5349  )), Row(CAST (SI
-0000f170: 4e28 5345 5131 2830 2929 2041 5320 4e55  N(SEQ1(0)) AS NU
-0000f180: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
-0000f190: 696d 616c 2827 302e 3834 3135 2729 292c  imal('0.8415')),
-0000f1a0: 2052 6f77 2843 4153 5420 2853 494e 2853   Row(CAST (SIN(S
-0000f1b0: 4551 3128 3029 2920 4153 204e 554d 4245  EQ1(0)) AS NUMBE
-0000f1c0: 5228 3338 2c20 3429 293d 4465 6369 6d61  R(38, 4))=Decima
-0000f1d0: 6c28 2730 2e39 3039 3327 2929 5d0a 2020  l('0.9093'))].  
-0000f1e0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000f1f0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000f200: 2273 696e 2229 0a20 2020 2072 6574 7572  "sin").    retur
-0000f210: 6e20 6275 696c 7469 6e28 2273 696e 2229  n builtin("sin")
-0000f220: 2863 290a 0a0a 6465 6620 7369 6e68 2865  (c)...def sinh(e
-0000f230: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0000f240: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000f250: 2222 436f 6d70 7574 6573 2074 6865 2068  ""Computes the h
-0000f260: 7970 6572 626f 6c69 6320 7369 6e65 206f  yperbolic sine o
-0000f270: 6620 6974 7320 6172 6775 6d65 6e74 2e0a  f its argument..
-0000f280: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0000f290: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0000f2a0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0000f2b0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0000f2c0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
-0000f2d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000f2e0: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
-0000f2f0: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
-0000f300: 3d33 292e 7365 6c65 6374 2873 696e 6828  =3).select(sinh(
-0000f310: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
-0000f320: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
-0000f330: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
-0000f340: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
-0000f350: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
-0000f360: 2853 494e 4828 5345 5131 2830 2929 2041  (SINH(SEQ1(0)) A
-0000f370: 5320 4e55 4d42 4552 2833 382c 2034 2929  S NUMBER(38, 4))
-0000f380: 3d44 6563 696d 616c 2827 302e 3030 3030  =Decimal('0.0000
-0000f390: 2729 292c 2052 6f77 2843 4153 5420 2853  ')), Row(CAST (S
-0000f3a0: 494e 4828 5345 5131 2830 2929 2041 5320  INH(SEQ1(0)) AS 
-0000f3b0: 4e55 4d42 4552 2833 382c 2034 2929 3d44  NUMBER(38, 4))=D
-0000f3c0: 6563 696d 616c 2827 312e 3137 3532 2729  ecimal('1.1752')
-0000f3d0: 292c 2052 6f77 2843 4153 5420 2853 494e  ), Row(CAST (SIN
-0000f3e0: 4828 5345 5131 2830 2929 2041 5320 4e55  H(SEQ1(0)) AS NU
-0000f3f0: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
-0000f400: 696d 616c 2827 332e 3632 3639 2729 295d  imal('3.6269'))]
-0000f410: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0000f420: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000f430: 652c 2022 7369 6e68 2229 0a20 2020 2072  e, "sinh").    r
-0000f440: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
-0000f450: 696e 6822 2928 6329 0a0a 0a64 6566 2074  inh")(c)...def t
-0000f460: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
-0000f470: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000f480: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
-0000f490: 6865 2074 616e 6765 6e74 206f 6620 6974  he tangent of it
-0000f4a0: 7320 6172 6775 6d65 6e74 3b20 7468 6520  s argument; the 
-0000f4b0: 6172 6775 6d65 6e74 2073 686f 756c 6420  argument should 
-0000f4c0: 6265 2065 7870 7265 7373 6564 2069 6e20  be expressed in 
-0000f4d0: 7261 6469 616e 732e 0a0a 2020 2020 4578  radians...    Ex
-0000f4e0: 616d 706c 653a 3a0a 2020 2020 2020 203e  ample::.       >
-0000f4f0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0000f500: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-0000f510: 2069 6d70 6f72 7420 4465 6369 6d61 6c54   import DecimalT
-0000f520: 7970 650a 2020 2020 2020 203e 3e3e 2064  ype.       >>> d
-0000f530: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000f540: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
-0000f550: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
-0000f560: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
-0000f570: 2020 2e2e 2e20 2020 2020 7461 6e28 636f    ...     tan(co
-0000f580: 6c28 224e 2229 292e 6361 7374 2844 6563  l("N")).cast(Dec
-0000f590: 696d 616c 5479 7065 2873 6361 6c65 3d34  imalType(scale=4
-0000f5a0: 2929 0a20 2020 2020 2020 2e2e 2e20 290a  )).       ... ).
-0000f5b0: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
-0000f5c0: 6c6c 6563 7428 290a 2020 2020 2020 205b  llect().       [
-0000f5d0: 526f 7728 4341 5354 2028 5441 4e28 224e  Row(CAST (TAN("N
-0000f5e0: 2229 2041 5320 4e55 4d42 4552 2833 382c  ") AS NUMBER(38,
-0000f5f0: 2034 2929 3d44 6563 696d 616c 2827 302e   4))=Decimal('0.
-0000f600: 3030 3030 2729 292c 2052 6f77 2843 4153  0000')), Row(CAS
-0000f610: 5420 2854 414e 2822 4e22 2920 4153 204e  T (TAN("N") AS N
-0000f620: 554d 4245 5228 3338 2c20 3429 293d 4465  UMBER(38, 4))=De
-0000f630: 6369 6d61 6c28 2731 2e35 3537 3427 2929  cimal('1.5574'))
-0000f640: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-0000f650: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0000f660: 2865 2c20 2274 616e 2229 0a20 2020 2072  (e, "tan").    r
-0000f670: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
-0000f680: 616e 2229 2863 290a 0a0a 6465 6620 7461  an")(c)...def ta
-0000f690: 6e68 2865 3a20 436f 6c75 6d6e 4f72 4e61  nh(e: ColumnOrNa
-0000f6a0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000f6b0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
-0000f6c0: 6865 2068 7970 6572 626f 6c69 6320 7461  he hyperbolic ta
-0000f6d0: 6e67 656e 7420 6f66 2069 7473 2061 7267  ngent of its arg
-0000f6e0: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
-0000f6f0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-0000f700: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0000f710: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-0000f720: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
-0000f730: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-0000f740: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000f750: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
-0000f760: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
-0000f770: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
-0000f780: 2020 202e 2e2e 2020 2020 2074 616e 6828     ...     tanh(
-0000f790: 636f 6c28 224e 2229 2e63 6173 7428 4465  col("N").cast(De
-0000f7a0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
-0000f7b0: 3429 2929 0a20 2020 2020 2020 202e 2e2e  4))).        ...
-0000f7c0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-0000f7d0: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
-0000f7e0: 2020 2020 5b52 6f77 2854 414e 4828 2043      [Row(TANH( C
-0000f7f0: 4153 5420 2822 4e22 2041 5320 4e55 4d42  AST ("N" AS NUMB
-0000f800: 4552 2833 382c 2034 2929 293d 302e 3029  ER(38, 4)))=0.0)
-0000f810: 2c20 526f 7728 5441 4e48 2820 4341 5354  , Row(TANH( CAST
-0000f820: 2028 224e 2220 4153 204e 554d 4245 5228   ("N" AS NUMBER(
-0000f830: 3338 2c20 3429 2929 3d30 2e37 3631 3539  38, 4)))=0.76159
-0000f840: 3431 3535 3935 3537 3634 3929 5d0a 2020  41559557649)].  
-0000f850: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000f860: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000f870: 2274 616e 6822 290a 2020 2020 7265 7475  "tanh").    retu
-0000f880: 726e 2062 7569 6c74 696e 2822 7461 6e68  rn builtin("tanh
-0000f890: 2229 2863 290a 0a0a 6465 6620 6465 6772  ")(c)...def degr
-0000f8a0: 6565 7328 653a 2043 6f6c 756d 6e4f 724e  ees(e: ColumnOrN
-0000f8b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0000f8c0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
-0000f8d0: 6572 7473 2072 6164 6961 6e73 2074 6f20  erts radians to 
-0000f8e0: 6465 6772 6565 732e 0a0a 2020 2020 4578  degrees...    Ex
-0000f8f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0000f900: 203e 3e3e 2069 6d70 6f72 7420 6d61 7468   >>> import math
-0000f910: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0000f920: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0000f930: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-0000f940: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
-0000f950: 7275 6374 4669 656c 642c 2044 6f75 626c  ructField, Doubl
-0000f960: 6554 7970 652c 2049 6e74 6567 6572 5479  eType, IntegerTy
-0000f970: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-0000f980: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000f990: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-0000f9a0: 2020 2020 2020 2e2e 2e20 2020 2020 5b6d        ...     [m
-0000f9b0: 6174 682e 7069 202f 2033 2c20 6d61 7468  ath.pi / 3, math
-0000f9c0: 2e70 692c 2033 202a 206d 6174 682e 7069  .pi, 3 * math.pi
-0000f9d0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0000f9e0: 2020 2073 6368 656d 613d 5374 7275 6374     schema=Struct
-0000f9f0: 5479 7065 285b 5374 7275 6374 4669 656c  Type([StructFiel
-0000fa00: 6428 2261 222c 2044 6f75 626c 6554 7970  d("a", DoubleTyp
-0000fa10: 6528 2929 5d29 2c0a 2020 2020 2020 2020  e())]),.        
-0000fa20: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-0000fa30: 3e20 6466 2e73 656c 6563 7428 6465 6772  > df.select(degr
-0000fa40: 6565 7328 636f 6c28 2261 2229 292e 6361  ees(col("a")).ca
-0000fa50: 7374 2849 6e74 6567 6572 5479 7065 2829  st(IntegerType()
-0000fa60: 292e 616c 6961 7328 2244 4547 5245 4553  ).alias("DEGREES
-0000fa70: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-0000fa80: 2020 2020 2020 5b52 6f77 2844 4547 5245        [Row(DEGRE
-0000fa90: 4553 3d36 3029 2c20 526f 7728 4445 4752  ES=60), Row(DEGR
-0000faa0: 4545 533d 3138 3029 2c20 526f 7728 4445  EES=180), Row(DE
-0000fab0: 4752 4545 533d 3534 3029 5d0a 2020 2020  GREES=540)].    
-0000fac0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0000fad0: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
-0000fae0: 6567 7265 6573 2229 0a20 2020 2072 6574  egrees").    ret
-0000faf0: 7572 6e20 6275 696c 7469 6e28 2264 6567  urn builtin("deg
-0000fb00: 7265 6573 2229 2863 290a 0a0a 6465 6620  rees")(c)...def 
-0000fb10: 7261 6469 616e 7328 653a 2043 6f6c 756d  radians(e: Colum
-0000fb20: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0000fb30: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
-0000fb40: 7274 7320 6465 6772 6565 7320 746f 2072  rts degrees to r
-0000fb50: 6164 6961 6e73 2e0a 0a20 2020 2045 7861  adians...    Exa
-0000fb60: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
-0000fb70: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0000fb80: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0000fb90: 6d65 285b 5b31 2e31 3131 5d2c 205b 322e  me([[1.111], [2.
-0000fba0: 3232 325d 2c20 5b33 2e33 3333 5d5d 2c20  222], [3.333]], 
-0000fbb0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-0000fbc0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000fbd0: 6563 7428 7261 6469 616e 7328 636f 6c28  ect(radians(col(
-0000fbe0: 2261 2229 292e 6361 7374 2822 6e75 6d62  "a")).cast("numb
-0000fbf0: 6572 2833 382c 2035 2922 292e 616c 6961  er(38, 5)").alia
-0000fc00: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-0000fc10: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0000fc20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000fc30: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-0000fc40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000fc50: 2d2d 0a20 2020 2020 2020 207c 302e 3031  --.        |0.01
-0000fc60: 3933 3920 2020 7c0a 2020 2020 2020 2020  939   |.        
-0000fc70: 7c30 2e30 3338 3738 2020 207c 0a20 2020  |0.03878   |.   
-0000fc80: 2020 2020 207c 302e 3035 3831 3720 2020       |0.05817   
-0000fc90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000fca0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0000fcb0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0000fcc0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0000fcd0: 6f6c 5f69 665f 7374 7228 652c 2022 7261  ol_if_str(e, "ra
-0000fce0: 6469 616e 7322 290a 2020 2020 7265 7475  dians").    retu
-0000fcf0: 726e 2062 7569 6c74 696e 2822 7261 6469  rn builtin("radi
-0000fd00: 616e 7322 2928 6329 0a0a 0a64 6566 206d  ans")(c)...def m
-0000fd10: 6435 2865 3a20 436f 6c75 6d6e 4f72 4e61  d5(e: ColumnOrNa
-0000fd20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000fd30: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0000fd40: 6e73 2061 2033 322d 6368 6172 6163 7465  ns a 32-characte
-0000fd50: 7220 6865 782d 656e 636f 6465 6420 7374  r hex-encoded st
-0000fd60: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
-0000fd70: 7468 6520 3132 382d 6269 7420 4d44 3520  the 128-bit MD5 
-0000fd80: 6d65 7373 6167 6520 6469 6765 7374 2e0a  message digest..
-0000fd90: 0a20 2020 2020 4578 616d 706c 653a 3a0a  .     Example::.
-0000fda0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000fdb0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000fdc0: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
-0000fdd0: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
-0000fde0: 636f 6c22 5d29 2e73 656c 6563 7428 6d64  col"]).select(md
-0000fdf0: 3528 2263 6f6c 2229 290a 2020 2020 2020  5("col")).      
-0000fe00: 2020 3e3e 3e20 6466 2e63 6f6c 6c65 6374    >>> df.collect
-0000fe10: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0000fe20: 4d44 3528 2243 4f4c 2229 3d27 3063 6331  MD5("COL")='0cc1
-0000fe30: 3735 6239 6330 6631 6236 6138 3331 6333  75b9c0f1b6a831c3
-0000fe40: 3939 6532 3639 3737 3236 3631 2729 2c20  99e269772661'), 
-0000fe50: 526f 7728 4d44 3528 2243 4f4c 2229 3d27  Row(MD5("COL")='
-0000fe60: 3932 6562 3566 6665 6536 6165 3266 6563  92eb5ffee6ae2fec
-0000fe70: 3361 6437 3163 3737 3735 3331 3537 3866  3ad71c777531578f
-0000fe80: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-0000fe90: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0000fea0: 7472 2865 2c20 226d 6435 2229 0a20 2020  tr(e, "md5").   
-0000feb0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0000fec0: 226d 6435 2229 2863 290a 0a0a 6465 6620  "md5")(c)...def 
-0000fed0: 7368 6131 2865 3a20 436f 6c75 6d6e 4f72  sha1(e: ColumnOr
-0000fee0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0000fef0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0000ff00: 6120 3430 2d63 6861 7261 6374 6572 2068  a 40-character h
-0000ff10: 6578 2d65 6e63 6f64 6564 2073 7472 696e  ex-encoded strin
-0000ff20: 6720 636f 6e74 6169 6e69 6e67 2074 6865  g containing the
-0000ff30: 2031 3630 2d62 6974 2053 4841 2d31 206d   160-bit SHA-1 m
-0000ff40: 6573 7361 6765 2064 6967 6573 742e 0a0a  essage digest...
-0000ff50: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0000ff60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000ff70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000ff80: 7461 6672 616d 6528 5b22 6122 2c20 2262  taframe(["a", "b
-0000ff90: 225d 2c20 7363 6865 6d61 3d5b 2263 6f6c  "], schema=["col
-0000ffa0: 225d 292e 7365 6c65 6374 2873 6861 3128  "]).select(sha1(
-0000ffb0: 2263 6f6c 2229 290a 2020 2020 2020 2020  "col")).        
-0000ffc0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
-0000ffd0: 0a20 2020 2020 2020 205b 526f 7728 5348  .        [Row(SH
-0000ffe0: 4131 2822 434f 4c22 293d 2738 3666 3765  A1("COL")='86f7e
-0000fff0: 3433 3766 6161 3561 3766 6365 3135 6431  437faa5a7fce15d1
-00010000: 6464 6362 3965 6165 6165 6133 3737 3636  ddcb9eaeaea37766
-00010010: 3762 3827 292c 2052 6f77 2853 4841 3128  7b8'), Row(SHA1(
-00010020: 2243 4f4c 2229 3d27 6539 6437 3166 3565  "COL")='e9d71f5e
-00010030: 6537 6339 3264 3664 6339 6539 3266 6664  e7c92d6dc9e92ffd
-00010040: 6164 3137 6238 6264 3439 3431 3866 3938  ad17b8bd49418f98
-00010050: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-00010060: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00010070: 7472 2865 2c20 2273 6861 3122 290a 2020  tr(e, "sha1").  
-00010080: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00010090: 2822 7368 6131 2229 2863 290a 0a0a 6465  ("sha1")(c)...de
-000100a0: 6620 7368 6132 2865 3a20 436f 6c75 6d6e  f sha2(e: Column
-000100b0: 4f72 4e61 6d65 2c20 6e75 6d5f 6269 7473  OrName, num_bits
-000100c0: 3a20 696e 7429 202d 3e20 436f 6c75 6d6e  : int) -> Column
-000100d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-000100e0: 2061 2068 6578 2d65 6e63 6f64 6564 2073   a hex-encoded s
-000100f0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
-00010100: 2074 6865 204e 2d62 6974 2053 4841 2d32   the N-bit SHA-2
-00010110: 206d 6573 7361 6765 2064 6967 6573 742c   message digest,
-00010120: 0a20 2020 2077 6865 7265 204e 2069 7320  .    where N is 
-00010130: 7468 6520 7370 6563 6966 6965 6420 6f75  the specified ou
-00010140: 7470 7574 2064 6967 6573 7420 7369 7a65  tput digest size
-00010150: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00010160: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00010170: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00010180: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
-00010190: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
-000101a0: 636f 6c22 5d29 2e73 656c 6563 7428 7368  col"]).select(sh
-000101b0: 6132 2822 636f 6c22 2c20 3235 3629 290a  a2("col", 256)).
-000101c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
-000101d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000101e0: 205b 526f 7728 5348 4132 2822 434f 4c22   [Row(SHA2("COL"
-000101f0: 2c20 3235 3629 3d27 6361 3937 3831 3132  , 256)='ca978112
-00010200: 6361 3162 6264 6361 6661 6332 3331 6233  ca1bbdcafac231b3
-00010210: 3961 3233 6463 3464 6137 3836 6566 6638  9a23dc4da786eff8
-00010220: 3134 3763 3465 3732 6239 3830 3737 3835  147c4e72b9807785
-00010230: 6166 6565 3438 6262 2729 2c20 526f 7728  afee48bb'), Row(
-00010240: 5348 4132 2822 434f 4c22 2c20 3235 3629  SHA2("COL", 256)
-00010250: 3d27 3365 3233 6538 3136 3030 3339 3539  ='3e23e816003959
-00010260: 3461 3333 3839 3466 3635 3634 6531 6231  4a33894f6564e1b1
-00010270: 3334 3862 6264 3761 3030 3838 6434 3263  348bbd7a0088d42c
-00010280: 3461 6362 3733 6565 6165 6435 3963 3030  4acb73eeaed59c00
-00010290: 3964 2729 5d0a 2020 2020 2222 220a 2020  9d')].    """.  
-000102a0: 2020 7065 726d 6974 7465 645f 7661 6c75    permitted_valu
-000102b0: 6573 203d 205b 302c 2032 3234 2c20 3235  es = [0, 224, 25
-000102c0: 362c 2033 3834 2c20 3531 325d 0a20 2020  6, 384, 512].   
-000102d0: 2069 6620 6e75 6d5f 6269 7473 206e 6f74   if num_bits not
-000102e0: 2069 6e20 7065 726d 6974 7465 645f 7661   in permitted_va
-000102f0: 6c75 6573 3a0a 2020 2020 2020 2020 7261  lues:.        ra
-00010300: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00010310: 2020 2020 2020 2020 2020 2020 6622 6e75              f"nu
-00010320: 6d5f 6269 7473 207b 6e75 6d5f 6269 7473  m_bits {num_bits
-00010330: 7d20 6973 206e 6f74 2069 6e20 7468 6520  } is not in the 
-00010340: 7065 726d 6974 7465 6420 7661 6c75 6573  permitted values
-00010350: 207b 7065 726d 6974 7465 645f 7661 6c75   {permitted_valu
-00010360: 6573 7d22 0a20 2020 2020 2020 2029 0a20  es}".        ). 
-00010370: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00010380: 665f 7374 7228 652c 2022 7368 6132 2229  f_str(e, "sha2")
-00010390: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-000103a0: 7469 6e28 2273 6861 3222 2928 632c 206e  tin("sha2")(c, n
-000103b0: 756d 5f62 6974 7329 0a0a 0a64 6566 2068  um_bits)...def h
-000103c0: 6173 6828 2a63 6f6c 733a 2043 6f6c 756d  ash(*cols: Colum
-000103d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000103e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000103f0: 5265 7475 726e 7320 6120 7369 676e 6564  Returns a signed
-00010400: 2036 342d 6269 7420 6861 7368 2076 616c   64-bit hash val
-00010410: 7565 2e20 4e6f 7465 2074 6861 7420 4841  ue. Note that HA
-00010420: 5348 206e 6576 6572 2072 6574 7572 6e73  SH never returns
-00010430: 204e 554c 4c2c 2065 7665 6e20 666f 7220   NULL, even for 
-00010440: 4e55 4c4c 2069 6e70 7574 732e 0a0a 2020  NULL inputs...  
-00010450: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
-00010460: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00010470: 2064 6563 696d 616c 0a20 2020 2020 2020   decimal.       
-00010480: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00010490: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000104a0: 6d65 285b 5b31 302c 2022 3130 222c 2064  me([[10, "10", d
-000104b0: 6563 696d 616c 2e44 6563 696d 616c 2831  ecimal.Decimal(1
-000104c0: 3029 2c20 3130 2e30 5d5d 2c20 7363 6865  0), 10.0]], sche
-000104d0: 6d61 3d5b 2261 222c 2022 6222 2c20 2263  ma=["a", "b", "c
-000104e0: 222c 2022 6422 5d29 0a20 2020 2020 2020  ", "d"]).       
-000104f0: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
-00010500: 6173 6828 2261 2229 2e61 6c69 6173 2822  ash("a").alias("
-00010510: 6861 7368 5f61 2229 2c20 6861 7368 2822  hash_a"), hash("
-00010520: 6222 292e 616c 6961 7328 2268 6173 685f  b").alias("hash_
-00010530: 6222 292c 2068 6173 6828 2263 2229 2e61  b"), hash("c").a
-00010540: 6c69 6173 2822 6861 7368 5f63 2229 2c20  lias("hash_c"), 
-00010550: 6861 7368 2822 6422 292e 616c 6961 7328  hash("d").alias(
-00010560: 2268 6173 685f 6422 2929 2e63 6f6c 6c65  "hash_d")).colle
-00010570: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00010580: 7728 4841 5348 5f41 3d31 3539 3936 3237  w(HASH_A=1599627
-00010590: 3730 3638 3232 3936 3330 3638 2c20 4841  706822963068, HA
-000105a0: 5348 5f42 3d33 3632 3234 3934 3938 3034  SH_B=36224949804
-000105b0: 3430 3130 3839 3834 2c20 4841 5348 5f43  40108984, HASH_C
-000105c0: 3d31 3539 3936 3237 3730 3638 3232 3936  =159962770682296
-000105d0: 3330 3638 2c20 4841 5348 5f44 3d31 3539  3068, HASH_D=159
-000105e0: 3936 3237 3730 3638 3232 3936 3330 3638  9627706822963068
-000105f0: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
-00010600: 662e 7365 6c65 6374 2868 6173 6828 6c69  f.select(hash(li
-00010610: 7428 4e6f 6e65 2929 2e61 6c69 6173 2822  t(None)).alias("
-00010620: 6f6e 6522 292c 2068 6173 6828 6c69 7428  one"), hash(lit(
-00010630: 4e6f 6e65 292c 206c 6974 284e 6f6e 6529  None), lit(None)
-00010640: 292e 616c 6961 7328 2274 776f 2229 2c20  ).alias("two"), 
-00010650: 6861 7368 286c 6974 284e 6f6e 6529 2c20  hash(lit(None), 
-00010660: 6c69 7428 4e6f 6e65 292c 206c 6974 284e  lit(None), lit(N
-00010670: 6f6e 6529 292e 616c 6961 7328 2274 6872  one)).alias("thr
-00010680: 6565 2229 292e 636f 6c6c 6563 7428 290a  ee")).collect().
-00010690: 2020 2020 2020 2020 5b52 6f77 284f 4e45          [Row(ONE
-000106a0: 3d38 3831 3739 3735 3730 3233 3933 3631  =881797570239361
-000106b0: 3933 3638 2c20 5457 4f3d 3935 3339 3633  9368, TWO=953963
-000106c0: 3235 3833 3531 3130 3431 3630 2c20 5448  258351104160, TH
-000106d0: 5245 453d 3239 3431 3934 3833 3633 3834  REE=294194836384
-000106e0: 3536 3834 3431 3229 5d0a 2020 2020 2222  5684412)].    ""
-000106f0: 220a 2020 2020 636f 6c75 6d6e 7320 3d20  ".    columns = 
-00010700: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
-00010710: 632c 2022 6861 7368 2229 2066 6f72 2063  c, "hash") for c
-00010720: 2069 6e20 636f 6c73 5d0a 2020 2020 7265   in cols].    re
-00010730: 7475 726e 2062 7569 6c74 696e 2822 6861  turn builtin("ha
-00010740: 7368 2229 2863 6f6c 756d 6e73 290a 0a0a  sh")(columns)...
-00010750: 6465 6620 6173 6369 6928 653a 2043 6f6c  def ascii(e: Col
-00010760: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00010770: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00010780: 7572 6e73 2074 6865 2041 5343 4949 2063  urns the ASCII c
-00010790: 6f64 6520 666f 7220 7468 6520 6669 7273  ode for the firs
-000107a0: 7420 6368 6172 6163 7465 7220 6f66 2061  t character of a
-000107b0: 2073 7472 696e 672e 2049 6620 7468 6520   string. If the 
-000107c0: 7374 7269 6e67 2069 7320 656d 7074 792c  string is empty,
-000107d0: 0a20 2020 2061 2076 616c 7565 206f 6620  .    a value of 
-000107e0: 3020 6973 2072 6574 7572 6e65 642e 0a0a  0 is returned...
-000107f0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00010800: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00010810: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00010820: 6174 6166 7261 6d65 285b 2721 272c 2027  ataframe(['!', '
-00010830: 4127 2c20 2761 272c 2027 272c 2027 6263  A', 'a', '', 'bc
-00010840: 6427 2c20 4e6f 6e65 5d2c 2073 6368 656d  d', None], schem
-00010850: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
-00010860: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-00010870: 662e 612c 2061 7363 6969 2864 662e 6129  f.a, ascii(df.a)
-00010880: 2e61 735f 2827 6173 6369 6927 2929 2e63  .as_('ascii')).c
-00010890: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000108a0: 205b 526f 7728 413d 2721 272c 2041 5343   [Row(A='!', ASC
-000108b0: 4949 3d33 3329 2c20 526f 7728 413d 2741  II=33), Row(A='A
-000108c0: 272c 2041 5343 4949 3d36 3529 2c20 526f  ', ASCII=65), Ro
-000108d0: 7728 413d 2761 272c 2041 5343 4949 3d39  w(A='a', ASCII=9
-000108e0: 3729 2c20 526f 7728 413d 2727 2c20 4153  7), Row(A='', AS
-000108f0: 4349 493d 3029 2c20 526f 7728 413d 2762  CII=0), Row(A='b
-00010900: 6364 272c 2041 5343 4949 3d39 3829 2c20  cd', ASCII=98), 
-00010910: 526f 7728 413d 4e6f 6e65 2c20 4153 4349  Row(A=None, ASCI
-00010920: 493d 4e6f 6e65 295d 0a20 2020 2022 2222  I=None)].    """
-00010930: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00010940: 5f69 665f 7374 7228 652c 2022 6173 6369  _if_str(e, "asci
-00010950: 6922 290a 2020 2020 7265 7475 726e 2062  i").    return b
-00010960: 7569 6c74 696e 2822 6173 6369 6922 2928  uiltin("ascii")(
-00010970: 6329 0a0a 0a64 6566 2069 6e69 7463 6170  c)...def initcap
-00010980: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00010990: 2c20 6465 6c69 6d69 7465 7273 3a20 436f  , delimiters: Co
-000109a0: 6c75 6d6e 4f72 4e61 6d65 203d 204e 6f6e  lumnOrName = Non
-000109b0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-000109c0: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-000109d0: 7320 7468 6520 696e 7075 7420 7374 7269  s the input stri
-000109e0: 6e67 2077 6974 6820 7468 6520 6669 7273  ng with the firs
-000109f0: 7420 6c65 7474 6572 206f 6620 6561 6368  t letter of each
-00010a00: 2077 6f72 6420 696e 2075 7070 6572 6361   word in upperca
-00010a10: 7365 0a20 2020 2061 6e64 2074 6865 2073  se.    and the s
-00010a20: 7562 7365 7175 656e 7420 6c65 7474 6572  ubsequent letter
-00010a30: 7320 696e 206c 6f77 6572 6361 7365 2e0a  s in lowercase..
-00010a40: 0a20 2020 2060 6064 656c 696d 6974 6572  .    ``delimiter
-00010a50: 7360 6020 6973 2061 6e20 6f70 7469 6f6e  s`` is an option
-00010a60: 616c 2061 7267 756d 656e 7420 7370 6563  al argument spec
-00010a70: 6966 7969 6e67 2061 2073 7472 696e 6720  ifying a string 
-00010a80: 6f66 206f 6e65 206f 7220 6d6f 7265 0a20  of one or more. 
-00010a90: 2020 2063 6861 7261 6374 6572 7320 7468     characters th
-00010aa0: 6174 2060 6069 6e69 7463 6170 6060 2075  at ``initcap`` u
-00010ab0: 7365 7320 6173 2073 6570 6172 6174 6f72  ses as separator
-00010ac0: 7320 666f 7220 776f 7264 7320 696e 2074  s for words in t
-00010ad0: 6865 2069 6e70 7574 2065 7870 7265 7373  he input express
-00010ae0: 696f 6e2e 0a0a 2020 2020 4966 2060 6064  ion...    If ``d
-00010af0: 656c 696d 6974 6572 7360 6020 6973 206e  elimiters`` is n
-00010b00: 6f74 2073 7065 6369 6669 6564 2c20 616e  ot specified, an
-00010b10: 7920 6f66 2074 6865 2066 6f6c 6c6f 7769  y of the followi
-00010b20: 6e67 2063 6861 7261 6374 6572 7320 696e  ng characters in
-00010b30: 2074 6865 0a20 2020 2069 6e70 7574 2065   the.    input e
-00010b40: 7870 7265 7373 696f 6e73 2061 7265 2074  xpressions are t
-00010b50: 7265 6174 6564 2061 7320 776f 7264 2073  reated as word s
-00010b60: 6570 6172 6174 6f72 733a 0a0a 2020 2020  eparators:..    
-00010b70: 2020 2020 6060 3c77 6869 7465 7370 6163      ``<whitespac
-00010b80: 653e 2021 203f 2040 2022 205e 2023 2024  e> ! ? @ " ^ # $
-00010b90: 2026 207e 205f 202c 202e 203a 203b 202b   & ~ _ , . : ; +
-00010ba0: 202d 202a 2025 202f 207c 205c 5c20 5b20   - * % / | \\ [ 
-00010bb0: 5d20 2820 2920 7b20 7d20 3c20 3e60 600a  ] ( ) { } < >``.
-00010bc0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00010bd0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00010be0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00010bf0: 5f64 6174 6166 7261 6d65 285b 2274 6865  _dataframe(["the
-00010c00: 2073 6b79 2069 7320 626c 7565 222c 2022   sky is blue", "
-00010c10: 5745 2043 414e 2048 414e 444c 4520 5448  WE CAN HANDLE TH
-00010c20: 4953 222c 2022 c384 c3a4 c396 c3b6 c39f  IS", "..........
-00010c30: c39c c3bc 222c 204e 6f6e 655d 2c20 7363  ....", None], sc
-00010c40: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00010c50: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00010c60: 7428 696e 6974 6361 7028 6466 5b22 6122  t(initcap(df["a"
-00010c70: 5d29 2e61 6c69 6173 2822 696e 6974 6361  ]).alias("initca
-00010c80: 7022 2929 2e63 6f6c 6c65 6374 2829 0a20  p")).collect(). 
-00010c90: 2020 2020 2020 205b 526f 7728 494e 4954         [Row(INIT
-00010ca0: 4341 503d 2754 6865 2053 6b79 2049 7320  CAP='The Sky Is 
-00010cb0: 426c 7565 2729 2c20 526f 7728 494e 4954  Blue'), Row(INIT
-00010cc0: 4341 503d 2757 6520 4361 6e20 4861 6e64  CAP='We Can Hand
-00010cd0: 6c65 2054 6869 7327 292c 2052 6f77 2849  le This'), Row(I
-00010ce0: 4e49 5443 4150 3d27 c384 c3a4 c3b6 c3b6  NITCAP='........
-00010cf0: c39f c3bc c3bc 2729 2c20 526f 7728 494e  ......'), Row(IN
-00010d00: 4954 4341 503d 4e6f 6e65 295d 0a20 2020  ITCAP=None)].   
-00010d10: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00010d20: 6374 2869 6e69 7463 6170 2864 665b 2261  ct(initcap(df["a
-00010d30: 225d 2c20 6c69 7428 2727 2929 2e61 6c69  "], lit('')).ali
-00010d40: 6173 2822 696e 6974 6361 7022 2929 2e63  as("initcap")).c
-00010d50: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00010d60: 205b 526f 7728 494e 4954 4341 503d 2754   [Row(INITCAP='T
-00010d70: 6865 2073 6b79 2069 7320 626c 7565 2729  he sky is blue')
-00010d80: 2c20 526f 7728 494e 4954 4341 503d 2757  , Row(INITCAP='W
-00010d90: 6520 6361 6e20 6861 6e64 6c65 2074 6869  e can handle thi
-00010da0: 7327 292c 2052 6f77 2849 4e49 5443 4150  s'), Row(INITCAP
-00010db0: 3d27 c384 c3a4 c3b6 c3b6 c39f c3bc c3bc  ='..............
-00010dc0: 2729 2c20 526f 7728 494e 4954 4341 503d  '), Row(INITCAP=
-00010dd0: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
-00010de0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00010df0: 665f 7374 7228 652c 2022 696e 6974 6361  f_str(e, "initca
-00010e00: 7022 290a 2020 2020 6966 2064 656c 696d  p").    if delim
-00010e10: 6974 6572 7320 6973 204e 6f6e 653a 0a20  iters is None:. 
-00010e20: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
-00010e30: 696c 7469 6e28 2269 6e69 7463 6170 2229  iltin("initcap")
-00010e40: 2863 290a 2020 2020 6465 6c69 6d69 7465  (c).    delimite
-00010e50: 725f 636f 6c20 3d20 5f74 6f5f 636f 6c5f  r_col = _to_col_
-00010e60: 6966 5f73 7472 2864 656c 696d 6974 6572  if_str(delimiter
-00010e70: 732c 2022 696e 6974 6361 7022 290a 2020  s, "initcap").  
-00010e80: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00010e90: 2822 696e 6974 6361 7022 2928 632c 2064  ("initcap")(c, d
-00010ea0: 656c 696d 6974 6572 5f63 6f6c 290a 0a0a  elimiter_col)...
-00010eb0: 6465 6620 6c65 6e67 7468 2865 3a20 436f  def length(e: Co
-00010ec0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00010ed0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00010ee0: 2020 2052 6574 7572 6e73 2074 6865 206c     Returns the l
-00010ef0: 656e 6774 6820 6f66 2061 6e20 696e 7075  ength of an inpu
-00010f00: 7420 7374 7269 6e67 206f 7220 6269 6e61  t string or bina
-00010f10: 7279 2076 616c 7565 2e20 466f 7220 7374  ry value. For st
-00010f20: 7269 6e67 732c 0a20 2020 2074 6865 206c  rings,.    the l
-00010f30: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
-00010f40: 6265 7220 6f66 2063 6861 7261 6374 6572  ber of character
-00010f50: 732c 2061 6e64 2055 5446 2d38 2063 6861  s, and UTF-8 cha
-00010f60: 7261 6374 6572 7320 6172 6520 636f 756e  racters are coun
-00010f70: 7465 6420 6173 2061 0a20 2020 2073 696e  ted as a.    sin
-00010f80: 676c 6520 6368 6172 6163 7465 722e 2046  gle character. F
-00010f90: 6f72 2062 696e 6172 792c 2074 6865 206c  or binary, the l
-00010fa0: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
-00010fb0: 6265 7220 6f66 2062 7974 6573 2e0a 0a20  ber of bytes... 
-00010fc0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00010fd0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00010fe0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00010ff0: 7461 6672 616d 6528 5b22 7468 6520 736b  taframe(["the sk
-00011000: 7920 6973 2062 6c75 6522 2c20 2257 4520  y is blue", "WE 
-00011010: 4341 4e20 4841 4e44 4c45 2054 4849 5322  CAN HANDLE THIS"
-00011020: 2c20 22c3 84c3 a4c3 96c3 b6c3 9fc3 9cc3  , ".............
-00011030: bc22 2c20 4e6f 6e65 5d2c 2073 6368 656d  .", None], schem
-00011040: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00011050: 203e 3e3e 2064 662e 7365 6c65 6374 286c   >>> df.select(l
-00011060: 656e 6774 6828 6466 5b22 6122 5d29 2e61  ength(df["a"]).a
-00011070: 6c69 6173 2822 6c65 6e67 7468 2229 292e  lias("length")).
-00011080: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00011090: 2020 5b52 6f77 284c 454e 4754 483d 3135    [Row(LENGTH=15
-000110a0: 292c 2052 6f77 284c 454e 4754 483d 3138  ), Row(LENGTH=18
-000110b0: 292c 2052 6f77 284c 454e 4754 483d 3729  ), Row(LENGTH=7)
-000110c0: 2c20 526f 7728 4c45 4e47 5448 3d4e 6f6e  , Row(LENGTH=Non
-000110d0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-000110e0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000110f0: 7472 2865 2c20 226c 656e 6774 6822 290a  tr(e, "length").
-00011100: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00011110: 696e 2822 6c65 6e67 7468 2229 2863 290a  in("length")(c).
-00011120: 0a0a 6465 6620 6c6f 7765 7228 653a 2043  ..def lower(e: C
-00011130: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00011140: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00011150: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-00011160: 696e 7075 7420 7374 7269 6e67 2077 6974  input string wit
-00011170: 6820 616c 6c20 6368 6172 6163 7465 7273  h all characters
-00011180: 2063 6f6e 7665 7274 6564 2074 6f20 6c6f   converted to lo
-00011190: 7765 7263 6173 652e 0a0a 2020 2020 4578  wercase...    Ex
-000111a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000111b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000111c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000111d0: 6d65 285b 2761 6263 272c 2027 4162 6327  me(['abc', 'Abc'
-000111e0: 2c20 2761 4243 272c 2027 416e 66c3 bc68  , 'aBC', 'Anf..h
-000111f0: 7275 6e67 737a 6569 6368 656e 272c 2027  rungszeichen', '
-00011200: 3134 2e39 3520 e282 ac27 5d2c 2073 6368  14.95 ...'], sch
-00011210: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00011220: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00011230: 286c 6f77 6572 2863 6f6c 2822 6122 2929  (lower(col("a"))
-00011240: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00011250: 2020 2020 5b52 6f77 284c 4f57 4552 2822      [Row(LOWER("
-00011260: 4122 293d 2761 6263 2729 2c20 526f 7728  A")='abc'), Row(
-00011270: 4c4f 5745 5228 2241 2229 3d27 6162 6327  LOWER("A")='abc'
-00011280: 292c 2052 6f77 284c 4f57 4552 2822 4122  ), Row(LOWER("A"
-00011290: 293d 2761 6263 2729 2c20 526f 7728 4c4f  )='abc'), Row(LO
-000112a0: 5745 5228 2241 2229 3d27 616e 66c3 bc68  WER("A")='anf..h
-000112b0: 7275 6e67 737a 6569 6368 656e 2729 2c20  rungszeichen'), 
-000112c0: 526f 7728 4c4f 5745 5228 2241 2229 3d27  Row(LOWER("A")='
-000112d0: 3134 2e39 3520 e282 ac27 295d 0a20 2020  14.95 ...')].   
-000112e0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-000112f0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00011300: 6c6f 7765 7222 290a 2020 2020 7265 7475  lower").    retu
-00011310: 726e 2062 7569 6c74 696e 2822 6c6f 7765  rn builtin("lowe
-00011320: 7222 2928 6329 0a0a 0a64 6566 206c 7061  r")(c)...def lpa
-00011330: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
-00011340: 652c 206c 656e 3a20 556e 696f 6e5b 436f  e, len: Union[Co
-00011350: 6c75 6d6e 2c20 696e 745d 2c20 7061 643a  lumn, int], pad:
-00011360: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00011370: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00011380: 220a 2020 2020 4c65 6674 2d70 6164 7320  ".    Left-pads 
-00011390: 6120 7374 7269 6e67 2077 6974 6820 6368  a string with ch
-000113a0: 6172 6163 7465 7273 2066 726f 6d20 616e  aracters from an
-000113b0: 6f74 6865 7220 7374 7269 6e67 2c20 6f72  other string, or
-000113c0: 206c 6566 742d 7061 6473 2061 0a20 2020   left-pads a.   
-000113d0: 2062 696e 6172 7920 7661 6c75 6520 7769   binary value wi
-000113e0: 7468 2062 7974 6573 2066 726f 6d20 616e  th bytes from an
-000113f0: 6f74 6865 7220 6269 6e61 7279 2076 616c  other binary val
-00011400: 7565 2e0a 0a20 2020 2045 7861 6d70 6c65  ue...    Example
-00011410: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00011420: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00011430: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-00011440: 7320 696d 706f 7274 206c 6974 0a20 2020  s import lit.   
-00011450: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00011460: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00011470: 6166 7261 6d65 285b 5b22 6122 5d2c 205b  aframe([["a"], [
-00011480: 2262 225d 2c20 5b22 6322 5d5d 2c20 7363  "b"], ["c"]], sc
-00011490: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-000114a0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000114b0: 7428 6c70 6164 2863 6f6c 2822 6122 292c  t(lpad(col("a"),
-000114c0: 2033 2c20 6c69 7428 226b 2229 292e 616c   3, lit("k")).al
-000114d0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-000114e0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-000114f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00011500: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-00011510: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00011520: 2d2d 2d2d 0a20 2020 2020 2020 207c 6b6b  ----.        |kk
-00011530: 6120 2020 2020 2020 7c0a 2020 2020 2020  a       |.      
-00011540: 2020 7c6b 6b62 2020 2020 2020 207c 0a20    |kkb       |. 
-00011550: 2020 2020 2020 207c 6b6b 6320 2020 2020         |kkc     
-00011560: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00011570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00011580: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00011590: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-000115a0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-000115b0: 6c70 6164 2229 0a20 2020 2070 203d 205f  lpad").    p = _
-000115c0: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
-000115d0: 642c 2022 6c70 6164 2229 0a20 2020 2072  d, "lpad").    r
-000115e0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
-000115f0: 7061 6422 2928 632c 206c 6974 286c 656e  pad")(c, lit(len
-00011600: 292c 2070 290a 0a0a 6465 6620 6c74 7269  ), p)...def ltri
-00011610: 6d28 653a 2043 6f6c 756d 6e4f 724e 616d  m(e: ColumnOrNam
-00011620: 652c 2074 7269 6d5f 7374 7269 6e67 3a20  e, trim_string: 
-00011630: 4f70 7469 6f6e 616c 5b43 6f6c 756d 6e4f  Optional[ColumnO
-00011640: 724e 616d 655d 203d 204e 6f6e 6529 202d  rName] = None) -
-00011650: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00011660: 220a 2020 2020 5265 6d6f 7665 7320 6c65  ".    Removes le
-00011670: 6164 696e 6720 6368 6172 6163 7465 7273  ading characters
-00011680: 2c20 696e 636c 7564 696e 6720 7768 6974  , including whit
-00011690: 6573 7061 6365 2c20 6672 6f6d 2061 2073  espace, from a s
-000116a0: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
-000116b0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-000116c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-000116d0: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
-000116e0: 696f 6e73 2069 6d70 6f72 7420 6c69 740a  ions import lit.
-000116f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00011700: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00011710: 6461 7461 6672 616d 6528 5b5b 2261 7373  dataframe([["ass
-00011720: 7322 5d2c 205b 2262 7373 7322 5d2c 205b  s"], ["bsss"], [
-00011730: 2263 7373 7322 5d5d 2c20 7363 6865 6d61  "csss"]], schema
-00011740: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00011750: 3e3e 3e20 6466 2e73 656c 6563 7428 7274  >>> df.select(rt
-00011760: 7269 6d28 636f 6c28 2261 2229 2c20 7472  rim(col("a"), tr
-00011770: 696d 5f73 7472 696e 673d 6c69 7428 2273  im_string=lit("s
-00011780: 7373 2229 292e 616c 6961 7328 2272 6573  ss")).alias("res
-00011790: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-000117a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000117b0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-000117c0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-000117d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-000117e0: 2020 2020 207c 6120 2020 2020 2020 2020       |a         
-000117f0: 7c0a 2020 2020 2020 2020 7c62 2020 2020  |.        |b    
-00011800: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00011810: 6320 2020 2020 2020 2020 7c0a 2020 2020  c         |.    
-00011820: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00011830: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00011840: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00011850: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00011860: 7374 7228 652c 2022 6c74 7269 6d22 290a  str(e, "ltrim").
-00011870: 2020 2020 7420 3d20 5f74 6f5f 636f 6c5f      t = _to_col_
-00011880: 6966 5f73 7472 2874 7269 6d5f 7374 7269  if_str(trim_stri
-00011890: 6e67 2c20 226c 7472 696d 2229 2069 6620  ng, "ltrim") if 
-000118a0: 7472 696d 5f73 7472 696e 6720 6973 206e  trim_string is n
-000118b0: 6f74 204e 6f6e 6520 656c 7365 204e 6f6e  ot None else Non
-000118c0: 650a 2020 2020 7265 7475 726e 2062 7569  e.    return bui
-000118d0: 6c74 696e 2822 6c74 7269 6d22 2928 632c  ltin("ltrim")(c,
-000118e0: 2074 2920 6966 2074 2069 7320 6e6f 7420   t) if t is not 
-000118f0: 4e6f 6e65 2065 6c73 6520 6275 696c 7469  None else builti
-00011900: 6e28 226c 7472 696d 2229 2863 290a 0a0a  n("ltrim")(c)...
-00011910: 6465 6620 7270 6164 2865 3a20 436f 6c75  def rpad(e: Colu
-00011920: 6d6e 4f72 4e61 6d65 2c20 6c65 6e3a 2055  mnOrName, len: U
-00011930: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
-00011940: 5d2c 2070 6164 3a20 436f 6c75 6d6e 4f72  ], pad: ColumnOr
-00011950: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00011960: 0a20 2020 2022 2222 5269 6768 742d 7061  .    """Right-pa
-00011970: 6473 2061 2073 7472 696e 6720 7769 7468  ds a string with
-00011980: 2063 6861 7261 6374 6572 7320 6672 6f6d   characters from
-00011990: 2061 6e6f 7468 6572 2073 7472 696e 672c   another string,
-000119a0: 206f 7220 7269 6768 742d 7061 6473 2061   or right-pads a
-000119b0: 0a20 2020 2062 696e 6172 7920 7661 6c75  .    binary valu
-000119c0: 6520 7769 7468 2062 7974 6573 2066 726f  e with bytes fro
-000119d0: 6d20 616e 6f74 6865 7220 6269 6e61 7279  m another binary
-000119e0: 2076 616c 7565 2e20 5768 656e 2063 616c   value. When cal
-000119f0: 6c65 642c 2060 6560 2069 7320 7061 6464  led, `e` is padd
-00011a00: 6564 2074 6f20 6c65 6e67 7468 2060 6c65  ed to length `le
-00011a10: 6e60 0a20 2020 2077 6974 6820 6368 6172  n`.    with char
-00011a20: 6163 7465 7273 2f62 7974 6573 2066 726f  acters/bytes fro
-00011a30: 6d20 6070 6164 602e 0a0a 2020 2020 4578  m `pad`...    Ex
-00011a40: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00011a50: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00011a60: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-00011a70: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
-00011a80: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-00011a90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00011aa0: 655f 6461 7461 6672 616d 6528 5b5b 2261  e_dataframe([["a
-00011ab0: 225d 2c20 5b22 6222 5d2c 205b 2263 225d  "], ["b"], ["c"]
-00011ac0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00011ad0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00011ae0: 7365 6c65 6374 2872 7061 6428 636f 6c28  select(rpad(col(
-00011af0: 2261 2229 2c20 332c 206c 6974 2822 6b22  "a"), 3, lit("k"
-00011b00: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
-00011b10: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-00011b20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00011b30: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-00011b40: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-00011b50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00011b60: 2020 7c61 6b6b 2020 2020 2020 207c 0a20    |akk       |. 
-00011b70: 2020 2020 2020 207c 626b 6b20 2020 2020         |bkk     
-00011b80: 2020 7c0a 2020 2020 2020 2020 7c63 6b6b    |.        |ckk
-00011b90: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00011ba0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00011bb0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00011bc0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
-00011bd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00011be0: 2865 2c20 2272 7061 6422 290a 2020 2020  (e, "rpad").    
-00011bf0: 7020 3d20 5f74 6f5f 636f 6c5f 6966 5f73  p = _to_col_if_s
-00011c00: 7472 2870 6164 2c20 2272 7061 6422 290a  tr(pad, "rpad").
-00011c10: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00011c20: 696e 2822 7270 6164 2229 2863 2c20 6c69  in("rpad")(c, li
-00011c30: 7428 6c65 6e29 2c20 7029 0a0a 0a64 6566  t(len), p)...def
-00011c40: 2072 7472 696d 2865 3a20 436f 6c75 6d6e   rtrim(e: Column
-00011c50: 4f72 4e61 6d65 2c20 7472 696d 5f73 7472  OrName, trim_str
-00011c60: 696e 673a 204f 7074 696f 6e61 6c5b 436f  ing: Optional[Co
-00011c70: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
-00011c80: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
-00011c90: 2020 2022 2222 5265 6d6f 7665 7320 7472     """Removes tr
-00011ca0: 6169 6c69 6e67 2063 6861 7261 6374 6572  ailing character
-00011cb0: 732c 2069 6e63 6c75 6469 6e67 2077 6869  s, including whi
-00011cc0: 7465 7370 6163 652c 2066 726f 6d20 6120  tespace, from a 
-00011cd0: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
-00011ce0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00011cf0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00011d00: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-00011d10: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
-00011d20: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00011d30: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00011d40: 5f64 6174 6166 7261 6d65 285b 5b22 6173  _dataframe([["as
-00011d50: 7373 225d 2c20 5b22 6273 7373 225d 2c20  ss"], ["bsss"], 
-00011d60: 5b22 6373 7373 225d 5d2c 2073 6368 656d  ["csss"]], schem
-00011d70: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00011d80: 203e 3e3e 2064 662e 7365 6c65 6374 2872   >>> df.select(r
-00011d90: 7472 696d 2863 6f6c 2822 6122 292c 2074  trim(col("a"), t
-00011da0: 7269 6d5f 7374 7269 6e67 3d6c 6974 2822  rim_string=lit("
-00011db0: 7373 7322 2929 2e61 6c69 6173 2822 7265  sss")).alias("re
-00011dc0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00011dd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00011de0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00011df0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00011e00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00011e10: 2020 2020 2020 7c61 2020 2020 2020 2020        |a        
-00011e20: 207c 0a20 2020 2020 2020 207c 6220 2020   |.        |b   
-00011e30: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00011e40: 7c63 2020 2020 2020 2020 207c 0a20 2020  |c         |.   
-00011e50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00011e60: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00011e70: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00011e80: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00011e90: 5f73 7472 2865 2c20 2272 7472 696d 2229  _str(e, "rtrim")
-00011ea0: 0a20 2020 2074 203d 205f 746f 5f63 6f6c  .    t = _to_col
-00011eb0: 5f69 665f 7374 7228 7472 696d 5f73 7472  _if_str(trim_str
-00011ec0: 696e 672c 2022 7274 7269 6d22 2920 6966  ing, "rtrim") if
-00011ed0: 2074 7269 6d5f 7374 7269 6e67 2069 7320   trim_string is 
-00011ee0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
-00011ef0: 6e65 0a20 2020 2072 6574 7572 6e20 6275  ne.    return bu
-00011f00: 696c 7469 6e28 2272 7472 696d 2229 2863  iltin("rtrim")(c
-00011f10: 2c20 7429 2069 6620 7420 6973 206e 6f74  , t) if t is not
-00011f20: 204e 6f6e 6520 656c 7365 2062 7569 6c74   None else built
-00011f30: 696e 2822 7274 7269 6d22 2928 6329 0a0a  in("rtrim")(c)..
-00011f40: 0a64 6566 2072 6570 6561 7428 733a 2043  .def repeat(s: C
-00011f50: 6f6c 756d 6e4f 724e 616d 652c 206e 3a20  olumnOrName, n: 
-00011f60: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
-00011f70: 745d 2920 2d3e 2043 6f6c 756d 6e3a 0a20  t]) -> Column:. 
-00011f80: 2020 2022 2222 4275 696c 6473 2061 2073     """Builds a s
-00011f90: 7472 696e 6720 6279 2072 6570 6561 7469  tring by repeati
-00011fa0: 6e67 2074 6865 2069 6e70 7574 2066 6f72  ng the input for
-00011fb0: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
-00011fc0: 756d 6265 7220 6f66 2074 696d 6573 2e0a  umber of times..
-00011fd0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00011fe0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00011ff0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00012000: 6461 7461 6672 616d 6528 5b5b 2261 225d  dataframe([["a"]
-00012010: 2c20 5b22 6222 5d2c 205b 2263 225d 5d2c  , ["b"], ["c"]],
-00012020: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00012030: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00012040: 6c65 6374 2872 6570 6561 7428 636f 6c28  lect(repeat(col(
-00012050: 2261 2229 2c20 3329 2e61 6c69 6173 2822  "a"), 3).alias("
-00012060: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00012070: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00012080: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00012090: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-000120a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000120b0: 2020 2020 2020 2020 7c61 6161 2020 2020          |aaa    
-000120c0: 2020 207c 0a20 2020 2020 2020 207c 6262     |.        |bb
-000120d0: 6220 2020 2020 2020 7c0a 2020 2020 2020  b       |.      
-000120e0: 2020 7c63 6363 2020 2020 2020 207c 0a20    |ccc       |. 
-000120f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00012100: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00012110: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00012120: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00012130: 6966 5f73 7472 2873 2c20 2272 6570 6561  if_str(s, "repea
-00012140: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
-00012150: 7569 6c74 696e 2822 7265 7065 6174 2229  uiltin("repeat")
-00012160: 2863 2c20 6c69 7428 6e29 290a 0a0a 6465  (c, lit(n))...de
-00012170: 6620 7265 7665 7273 6528 636f 6c3a 2043  f reverse(col: C
-00012180: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00012190: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-000121a0: 6576 6572 7365 7320 7468 6520 6f72 6465  everses the orde
-000121b0: 7220 6f66 2063 6861 7261 6374 6572 7320  r of characters 
-000121c0: 696e 2061 2073 7472 696e 672c 206f 7220  in a string, or 
-000121d0: 6f66 2062 7974 6573 2069 6e20 6120 6269  of bytes in a bi
-000121e0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
-000121f0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00012200: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00012210: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00012220: 6672 616d 6528 5b5b 2248 656c 6c6f 225d  frame([["Hello"]
-00012230: 2c20 5b22 6162 6322 5d5d 2c20 7363 6865  , ["abc"]], sche
-00012240: 6d61 3d5b 2263 6f6c 3122 5d29 0a20 2020  ma=["col1"]).   
-00012250: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00012260: 6374 2872 6576 6572 7365 2863 6f6c 2822  ct(reverse(col("
-00012270: 636f 6c31 2229 2929 2e73 686f 7728 290a  col1"))).show().
-00012280: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00012290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000122a0: 2020 2020 2020 2020 7c22 5245 5645 5253          |"REVERS
-000122b0: 4528 2222 434f 4c31 2222 2922 2020 7c0a  E(""COL1"")"  |.
-000122c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000122d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000122e0: 2020 2020 2020 2020 7c6f 6c6c 6548 2020          |olleH  
-000122f0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00012300: 2020 2020 2020 2020 7c63 6261 2020 2020          |cba    
-00012310: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00012320: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00012330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-00012340: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00012350: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-00012360: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
-00012370: 5f73 7472 2863 6f6c 2c20 2272 6576 6572  _str(col, "rever
-00012380: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
-00012390: 6275 696c 7469 6e28 2272 6576 6572 7365  builtin("reverse
-000123a0: 2229 2863 6f6c 290a 0a0a 6465 6620 736f  ")(col)...def so
-000123b0: 756e 6465 7828 653a 2043 6f6c 756d 6e4f  undex(e: ColumnO
-000123c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-000123d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-000123e0: 2061 2073 7472 696e 6720 7468 6174 2063   a string that c
-000123f0: 6f6e 7461 696e 7320 6120 7068 6f6e 6574  ontains a phonet
-00012400: 6963 2072 6570 7265 7365 6e74 6174 696f  ic representatio
-00012410: 6e20 6f66 2074 6865 2069 6e70 7574 2073  n of the input s
-00012420: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
-00012430: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00012440: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00012450: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00012460: 5b22 4d61 7273 6861 222c 2022 4d61 7263  ["Marsha", "Marc
-00012470: 6961 225d 2c20 7363 6865 6d61 3d5b 2256  ia"], schema=["V
-00012480: 225d 292e 7365 6c65 6374 2873 6f75 6e64  "]).select(sound
-00012490: 6578 2863 6f6c 2822 5622 2929 290a 2020  ex(col("V"))).  
-000124a0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
-000124b0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000124c0: 526f 7728 534f 554e 4445 5828 2256 2229  Row(SOUNDEX("V")
-000124d0: 3d27 4d36 3230 2729 2c20 526f 7728 534f  ='M620'), Row(SO
-000124e0: 554e 4445 5828 2256 2229 3d27 4d36 3230  UNDEX("V")='M620
-000124f0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-00012500: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00012510: 7472 2865 2c20 2273 6f75 6e64 6578 2229  tr(e, "soundex")
-00012520: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00012530: 7469 6e28 2273 6f75 6e64 6578 2229 2863  tin("soundex")(c
-00012540: 290a 0a0a 6465 6620 7472 696d 2865 3a20  )...def trim(e: 
-00012550: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7472  ColumnOrName, tr
-00012560: 696d 5f73 7472 696e 673a 204f 7074 696f  im_string: Optio
-00012570: 6e61 6c5b 436f 6c75 6d6e 4f72 4e61 6d65  nal[ColumnOrName
-00012580: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
-00012590: 756d 6e3a 0a20 2020 2022 2222 5265 6d6f  umn:.    """Remo
-000125a0: 7665 7320 6c65 6164 696e 6720 616e 6420  ves leading and 
-000125b0: 7472 6169 6c69 6e67 2063 6861 7261 6374  trailing charact
-000125c0: 6572 7320 6672 6f6d 2061 2073 7472 696e  ers from a strin
-000125d0: 672e 2050 6572 2064 6566 6175 6c74 206f  g. Per default o
-000125e0: 6e6c 7920 7768 6974 6573 7061 6365 2027  nly whitespace '
-000125f0: 2027 2063 6861 7261 6374 6572 7320 6172   ' characters ar
-00012600: 6520 7265 6d6f 7665 642e 0a0a 2020 2020  e removed...    
-00012610: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00012620: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00012630: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00012640: 7261 6d65 285b 2768 656c 6c6f 272c 2027  rame(['hello', '
-00012650: 2077 6f72 6c64 272c 2027 2020 2021 2020   world', '   !  
-00012660: 2027 5d2c 2073 6368 656d 613d 5b22 6122   '], schema=["a"
-00012670: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00012680: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
-00012690: 2020 2020 5b52 6f77 2841 3d27 6865 6c6c      [Row(A='hell
-000126a0: 6f27 292c 2052 6f77 2841 3d27 2077 6f72  o'), Row(A=' wor
-000126b0: 6c64 2729 2c20 526f 7728 413d 2720 2020  ld'), Row(A='   
-000126c0: 2120 2020 2729 5d0a 2020 2020 2020 2020  !   ')].        
-000126d0: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-000126e0: 696d 2863 6f6c 2822 6122 2929 292e 636f  im(col("a"))).co
-000126f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00012700: 5b52 6f77 2854 5249 4d28 2241 2229 3d27  [Row(TRIM("A")='
-00012710: 6865 6c6c 6f27 292c 2052 6f77 2854 5249  hello'), Row(TRI
-00012720: 4d28 2241 2229 3d27 776f 726c 6427 292c  M("A")='world'),
-00012730: 2052 6f77 2854 5249 4d28 2241 2229 3d27   Row(TRIM("A")='
-00012740: 2127 295d 0a0a 2020 2020 4578 616d 706c  !')]..    Exampl
-00012750: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00012760: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00012770: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00012780: 2745 5552 2031 322e 3936 272c 2027 372e  'EUR 12.96', '7.
-00012790: 3839 5553 4427 2c20 2735 2e39 3945 275d  89USD', '5.99E']
-000127a0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-000127b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000127c0: 656c 6563 7428 7472 696d 2863 6f6c 2822  elect(trim(col("
-000127d0: 6122 292c 206c 6974 2822 4555 5255 5344  a"), lit("EURUSD
-000127e0: 2022 2929 2e61 735f 2822 616e 7322 2929   ")).as_("ans"))
-000127f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00012800: 2020 205b 526f 7728 414e 533d 2731 322e     [Row(ANS='12.
-00012810: 3936 2729 2c20 526f 7728 414e 533d 2737  96'), Row(ANS='7
-00012820: 2e38 3927 292c 2052 6f77 2841 4e53 3d27  .89'), Row(ANS='
-00012830: 352e 3939 2729 5d0a 0a20 2020 2045 7861  5.99')]..    Exa
-00012840: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00012850: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00012860: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00012870: 6528 5b27 6162 6331 3220 3435 6120 3739  e(['abc12 45a 79
-00012880: 6263 2127 5d2c 2073 6368 656d 613d 5b22  bc!'], schema=["
-00012890: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-000128a0: 2064 662e 7365 6c65 6374 2874 7269 6d28   df.select(trim(
-000128b0: 636f 6c28 2261 2229 2c20 6c69 7428 2261  col("a"), lit("a
-000128c0: 6263 2122 2929 2e61 735f 2822 616e 7322  bc!")).as_("ans"
-000128d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-000128e0: 2020 2020 205b 526f 7728 414e 533d 2731       [Row(ANS='1
-000128f0: 3220 3435 6120 3739 2729 5d0a 0a20 2020  2 45a 79')]..   
-00012900: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00012910: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00012920: 7472 696d 2229 0a20 2020 2074 203d 205f  trim").    t = _
-00012930: 746f 5f63 6f6c 5f69 665f 7374 7228 7472  to_col_if_str(tr
-00012940: 696d 5f73 7472 696e 672c 2022 7472 696d  im_string, "trim
-00012950: 2229 2069 6620 7472 696d 5f73 7472 696e  ") if trim_strin
-00012960: 6720 6973 206e 6f74 204e 6f6e 6520 656c  g is not None el
-00012970: 7365 204e 6f6e 650a 2020 2020 7265 7475  se None.    retu
-00012980: 726e 2062 7569 6c74 696e 2822 7472 696d  rn builtin("trim
-00012990: 2229 2863 2c20 7429 2069 6620 7420 6973  ")(c, t) if t is
-000129a0: 206e 6f74 204e 6f6e 6520 656c 7365 2062   not None else b
-000129b0: 7569 6c74 696e 2822 7472 696d 2229 2863  uiltin("trim")(c
-000129c0: 290a 0a0a 6465 6620 7570 7065 7228 653a  )...def upper(e:
-000129d0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000129e0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000129f0: 2252 6574 7572 6e73 2074 6865 2069 6e70  "Returns the inp
-00012a00: 7574 2073 7472 696e 6720 7769 7468 2061  ut string with a
-00012a10: 6c6c 2063 6861 7261 6374 6572 7320 636f  ll characters co
-00012a20: 6e76 6572 7465 6420 746f 2075 7070 6572  nverted to upper
-00012a30: 6361 7365 2e0a 2020 2020 2020 2055 6e69  case..       Uni
-00012a40: 636f 6465 2063 6861 7261 6374 6572 7320  code characters 
-00012a50: 6172 6520 7375 7070 6f72 7465 642e 0a0a  are supported...
-00012a60: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00012a70: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00012a80: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00012a90: 6174 6166 7261 6d65 285b 2761 6263 272c  ataframe(['abc',
-00012aa0: 2027 4162 6327 2c20 2761 4243 272c 2027   'Abc', 'aBC', '
-00012ab0: 416e 66c3 bc68 7275 6e67 737a 6569 6368  Anf..hrungszeich
-00012ac0: 656e 272c 2027 3134 2e39 3520 e282 ac27  en', '14.95 ...'
-00012ad0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00012ae0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00012af0: 7365 6c65 6374 2875 7070 6572 2863 6f6c  select(upper(col
-00012b00: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00012b10: 290a 2020 2020 2020 2020 5b52 6f77 2855  ).        [Row(U
-00012b20: 5050 4552 2822 4122 293d 2741 4243 2729  PPER("A")='ABC')
-00012b30: 2c20 526f 7728 5550 5045 5228 2241 2229  , Row(UPPER("A")
-00012b40: 3d27 4142 4327 292c 2052 6f77 2855 5050  ='ABC'), Row(UPP
-00012b50: 4552 2822 4122 293d 2741 4243 2729 2c20  ER("A")='ABC'), 
-00012b60: 526f 7728 5550 5045 5228 2241 2229 3d27  Row(UPPER("A")='
-00012b70: 414e 46c3 9c48 5255 4e47 535a 4549 4348  ANF..HRUNGSZEICH
-00012b80: 454e 2729 2c20 526f 7728 5550 5045 5228  EN'), Row(UPPER(
-00012b90: 2241 2229 3d27 3134 2e39 3520 e282 ac27  "A")='14.95 ...'
-00012ba0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-00012bb0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00012bc0: 7228 652c 2022 7570 7065 7222 290a 2020  r(e, "upper").  
-00012bd0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00012be0: 2822 7570 7065 7222 2928 6329 0a0a 0a64  ("upper")(c)...d
-00012bf0: 6566 2073 7472 746f 6b5f 746f 5f61 7272  ef strtok_to_arr
-00012c00: 6179 280a 2020 2020 7465 7874 3a20 436f  ay(.    text: Co
-00012c10: 6c75 6d6e 4f72 4e61 6d65 2c20 6465 6c69  lumnOrName, deli
-00012c20: 6d69 7465 723a 204f 7074 696f 6e61 6c5b  miter: Optional[
-00012c30: 436f 6c75 6d6e 4f72 4e61 6d65 5d20 3d20  ColumnOrName] = 
-00012c40: 4e6f 6e65 0a29 202d 3e20 436f 6c75 6d6e  None.) -> Column
-00012c50: 3a0a 2020 2020 2222 220a 2020 2020 546f  :.    """.    To
-00012c60: 6b65 6e69 7a65 7320 7468 6520 6769 7665  kenizes the give
-00012c70: 6e20 7374 7269 6e67 2075 7369 6e67 2074  n string using t
-00012c80: 6865 2067 6976 656e 2073 6574 206f 6620  he given set of 
-00012c90: 6465 6c69 6d69 7465 7273 2061 6e64 2072  delimiters and r
-00012ca0: 6574 7572 6e73 2074 6865 2074 6f6b 656e  eturns the token
-00012cb0: 7320 6173 2061 6e20 6172 7261 792e 0a0a  s as an array...
-00012cc0: 2020 2020 4966 2065 6974 6865 7220 7061      If either pa
-00012cd0: 7261 6d65 7465 7220 6973 2061 204e 554c  rameter is a NUL
-00012ce0: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
-00012cf0: 7572 6e65 642e 2041 6e20 656d 7074 7920  urned. An empty 
-00012d00: 6172 7261 7920 6973 2072 6574 7572 6e65  array is returne
-00012d10: 6420 6966 2074 6f6b 656e 697a 6174 696f  d if tokenizatio
-00012d20: 6e20 7072 6f64 7563 6573 206e 6f20 746f  n produces no to
-00012d30: 6b65 6e73 2e0a 0a20 2020 2045 7861 6d70  kens...    Examp
-00012d40: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00012d50: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00012d60: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00012d70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00012d80: 5b5b 2261 2e62 2e63 222c 2022 2e22 5d2c  [["a.b.c", "."],
-00012d90: 205b 2231 2c32 2e33 222c 2022 2c22 5d5d   ["1,2.3", ","]]
-00012da0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00012db0: 2020 7363 6865 6d61 3d5b 2274 6578 7422    schema=["text"
-00012dc0: 2c20 2264 656c 696d 6974 6572 225d 2c0a  , "delimiter"],.
-00012dd0: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
-00012de0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00012df0: 6563 7428 7374 7274 6f6b 5f74 6f5f 6172  ect(strtok_to_ar
-00012e00: 7261 7928 2274 6578 7422 2c20 2264 656c  ray("text", "del
-00012e10: 696d 6974 6572 2229 2e61 6c69 6173 2822  imiter").alias("
-00012e20: 5449 4d45 5f46 524f 4d5f 5041 5254 5322  TIME_FROM_PARTS"
-00012e30: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00012e40: 2020 2020 205b 526f 7728 5449 4d45 5f46       [Row(TIME_F
-00012e50: 524f 4d5f 5041 5254 533d 275b 5c5c 6e20  ROM_PARTS='[\\n 
-00012e60: 2022 6122 2c5c 5c6e 2020 2262 222c 5c5c   "a",\\n  "b",\\
-00012e70: 6e20 2022 6322 5c5c 6e5d 2729 2c20 526f  n  "c"\\n]'), Ro
-00012e80: 7728 5449 4d45 5f46 524f 4d5f 5041 5254  w(TIME_FROM_PART
-00012e90: 533d 275b 5c5c 6e20 2022 3122 2c5c 5c6e  S='[\\n  "1",\\n
-00012ea0: 2020 2232 2e33 225c 5c6e 5d27 295d 0a20    "2.3"\\n]')]. 
-00012eb0: 2020 2022 2222 0a20 2020 2074 203d 205f     """.    t = _
-00012ec0: 746f 5f63 6f6c 5f69 665f 7374 7228 7465  to_col_if_str(te
-00012ed0: 7874 2c20 2273 7472 746f 6b5f 746f 5f61  xt, "strtok_to_a
-00012ee0: 7272 6179 2229 0a20 2020 2064 203d 2028  rray").    d = (
-00012ef0: 0a20 2020 2020 2020 205f 746f 5f63 6f6c  .        _to_col
-00012f00: 5f69 665f 7374 7228 6465 6c69 6d69 7465  _if_str(delimite
-00012f10: 722c 2022 7374 7274 6f6b 5f74 6f5f 6172  r, "strtok_to_ar
-00012f20: 7261 7922 290a 2020 2020 2020 2020 6966  ray").        if
-00012f30: 2028 6465 6c69 6d69 7465 7220 6973 206e   (delimiter is n
-00012f40: 6f74 204e 6f6e 6529 0a20 2020 2020 2020  ot None).       
-00012f50: 2065 6c73 6520 4e6f 6e65 0a20 2020 2029   else None.    )
-00012f60: 0a20 2020 2072 6574 7572 6e20 280a 2020  .    return (.  
-00012f70: 2020 2020 2020 6275 696c 7469 6e28 2273        builtin("s
-00012f80: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
-00012f90: 2874 2c20 6429 0a20 2020 2020 2020 2069  (t, d).        i
-00012fa0: 6620 2864 656c 696d 6974 6572 2069 7320  f (delimiter is 
-00012fb0: 6e6f 7420 4e6f 6e65 290a 2020 2020 2020  not None).      
-00012fc0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
-00012fd0: 7374 7274 6f6b 5f74 6f5f 6172 7261 7922  strtok_to_array"
-00012fe0: 2928 7429 0a20 2020 2029 0a0a 0a64 6566  )(t).    )...def
-00012ff0: 2073 7472 7563 7428 2a63 6f6c 733a 2043   struct(*cols: C
-00013000: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00013010: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00013020: 2020 2020 5265 7475 726e 7320 616e 204f      Returns an O
-00013030: 424a 4543 5420 636f 6e73 7472 7563 7465  BJECT constructe
-00013040: 6420 7769 7468 2074 6865 2067 6976 656e  d with the given
-00013050: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2045   columns...    E
-00013060: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00013070: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00013080: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-00013090: 6374 696f 6e73 2069 6d70 6f72 7420 7374  ctions import st
-000130a0: 7275 6374 0a20 2020 2020 2020 203e 3e3e  ruct.        >>>
-000130b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000130c0: 6561 7465 4461 7461 4672 616d 6528 5b28  eateDataFrame([(
-000130d0: 2242 6f62 222c 2038 3029 2c20 2822 416c  "Bob", 80), ("Al
-000130e0: 6963 6522 2c20 4e6f 6e65 295d 2c20 5b22  ice", None)], ["
-000130f0: 6e61 6d65 222c 2022 6167 6522 5d29 0a20  name", "age"]). 
-00013100: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-00013110: 2064 662e 7365 6c65 6374 2873 7472 7563   df.select(struc
-00013120: 7428 2261 6765 222c 2022 6e61 6d65 2229  t("age", "name")
-00013130: 2e61 6c69 6173 2822 7374 7275 6374 2229  .alias("struct")
-00013140: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00013150: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00013160: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00013170: 2253 5452 5543 5422 2020 2020 2020 2020  "STRUCT"        
-00013180: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00013190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000131a0: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
-000131b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000131c0: 0a20 2020 2020 2020 207c 2020 2261 6765  .        |  "age
-000131d0: 223a 2038 302c 2020 2020 2020 207c 0a20  ": 80,       |. 
-000131e0: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-000131f0: 3a20 2242 6f62 2220 2020 207c 0a20 2020  : "Bob"    |.   
-00013200: 2020 2020 207c 7d20 2020 2020 2020 2020       |}         
-00013210: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00013220: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
-00013230: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00013240: 207c 2020 2261 6765 223a 206e 756c 6c2c   |  "age": null,
-00013250: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00013260: 2020 226e 616d 6522 3a20 2241 6c69 6365    "name": "Alice
-00013270: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
-00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013290: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000132a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000132b0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-000132c0: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
-000132d0: 2020 6465 6620 666c 6174 7465 6e5f 636f    def flatten_co
-000132e0: 6c5f 6c69 7374 286f 626a 293a 0a20 2020  l_list(obj):.   
-000132f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00013300: 6365 286f 626a 2c20 7374 7229 206f 7220  ce(obj, str) or 
-00013310: 6973 696e 7374 616e 6365 286f 626a 2c20  isinstance(obj, 
-00013320: 436f 6c75 6d6e 293a 0a20 2020 2020 2020  Column):.       
-00013330: 2020 2020 2072 6574 7572 6e20 5b6f 626a       return [obj
-00013340: 5d0a 2020 2020 2020 2020 656c 6966 2068  ].        elif h
-00013350: 6173 6174 7472 286f 626a 2c20 225f 5f69  asattr(obj, "__i
-00013360: 7465 725f 5f22 293a 0a20 2020 2020 2020  ter__"):.       
-00013370: 2020 2020 2061 6363 203d 205b 5d0a 2020       acc = [].  
-00013380: 2020 2020 2020 2020 2020 666f 7220 696e            for in
-00013390: 6e65 724f 626a 2069 6e20 6f62 6a3a 0a20  nerObj in obj:. 
-000133a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000133b0: 6363 203d 2061 6363 202b 2066 6c61 7474  cc = acc + flatt
-000133c0: 656e 5f63 6f6c 5f6c 6973 7428 696e 6e65  en_col_list(inne
-000133d0: 724f 626a 290a 2020 2020 2020 2020 2020  rObj).          
-000133e0: 2020 7265 7475 726e 2061 6363 0a0a 2020    return acc..  
-000133f0: 2020 6e65 775f 636f 6c73 203d 205b 5d0a    new_cols = [].
-00013400: 2020 2020 666f 7220 6320 696e 2066 6c61      for c in fla
-00013410: 7474 656e 5f63 6f6c 5f6c 6973 7428 636f  tten_col_list(co
-00013420: 6c73 293a 0a20 2020 2020 2020 2023 2066  ls):.        # f
-00013430: 6972 7374 2069 6e73 6572 7420 6669 656c  irst insert fiel
-00013440: 645f 6e61 6d65 0a20 2020 2020 2020 2069  d_name.        i
-00013450: 6620 6973 696e 7374 616e 6365 2863 2c20  f isinstance(c, 
-00013460: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-00013470: 2020 6e65 775f 636f 6c73 2e61 7070 656e    new_cols.appen
-00013480: 6428 6c69 7428 6329 290a 2020 2020 2020  d(lit(c)).      
-00013490: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000134a0: 2020 2020 6e61 6d65 203d 2063 2e5f 6578      name = c._ex
-000134b0: 7072 6573 7369 6f6e 2e6e 616d 650a 2020  pression.name.  
-000134c0: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
-000134d0: 206e 616d 655b 313a 5d20 6966 206e 616d   name[1:] if nam
-000134e0: 652e 7374 6172 7473 7769 7468 2827 2227  e.startswith('"'
-000134f0: 2920 656c 7365 206e 616d 650a 2020 2020  ) else name.    
-00013500: 2020 2020 2020 2020 6e61 6d65 203d 206e          name = n
-00013510: 616d 655b 3a2d 315d 2069 6620 6e61 6d65  ame[:-1] if name
-00013520: 2e65 6e64 7377 6974 6828 2722 2729 2065  .endswith('"') e
-00013530: 6c73 6520 6e61 6d65 0a20 2020 2020 2020  lse name.       
-00013540: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
-00013550: 7065 6e64 286c 6974 286e 616d 6529 290a  pend(lit(name)).
-00013560: 2020 2020 2020 2020 2320 6e65 7874 2069          # next i
-00013570: 6e73 6572 7420 6669 656c 6420 7661 6c75  nsert field valu
-00013580: 650a 2020 2020 2020 2020 6320 3d20 5f74  e.        c = _t
-00013590: 6f5f 636f 6c5f 6966 5f73 7472 2863 2c20  o_col_if_str(c, 
-000135a0: 2273 7472 7563 7422 290a 2020 2020 2020  "struct").      
-000135b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000135c0: 632c 2043 6f6c 756d 6e29 2061 6e64 2069  c, Column) and i
-000135d0: 7369 6e73 7461 6e63 6528 632e 5f65 7870  sinstance(c._exp
-000135e0: 7265 7373 696f 6e2c 2041 6c69 6173 293a  ression, Alias):
-000135f0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-00013600: 5f63 6f6c 732e 6170 7065 6e64 2863 6f6c  _cols.append(col
-00013610: 2863 2e5f 6578 7072 6573 7369 6f6e 2e63  (c._expression.c
-00013620: 6869 6c64 7265 6e5b 305d 2929 0a20 2020  hildren[0])).   
-00013630: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00013640: 2020 2020 2020 206e 6577 5f63 6f6c 732e         new_cols.
-00013650: 6170 7065 6e64 2863 290a 2020 2020 7265  append(c).    re
-00013660: 7475 726e 206f 626a 6563 745f 636f 6e73  turn object_cons
-00013670: 7472 7563 745f 6b65 6570 5f6e 756c 6c28  truct_keep_null(
-00013680: 2a6e 6577 5f63 6f6c 7329 0a0a 0a64 6566  *new_cols)...def
-00013690: 206c 6f67 280a 2020 2020 6261 7365 3a20   log(.    base: 
-000136a0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-000136b0: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
-000136c0: 2078 3a20 556e 696f 6e5b 436f 6c75 6d6e   x: Union[Column
-000136d0: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
-000136e0: 6174 5d0a 2920 2d3e 2043 6f6c 756d 6e3a  at].) -> Column:
-000136f0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00013700: 7572 6e73 2074 6865 206c 6f67 6172 6974  urns the logarit
-00013710: 686d 206f 6620 6120 6e75 6d65 7269 6320  hm of a numeric 
-00013720: 6578 7072 6573 7369 6f6e 2e0a 0a20 2020  expression...   
-00013730: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00013740: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00013750: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00013760: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
-00013770: 6567 6572 5479 7065 0a20 2020 2020 2020  egerType.       
-00013780: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00013790: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000137a0: 6d65 285b 312c 2031 305d 2c20 7363 6865  me([1, 10], sche
-000137b0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-000137c0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000137d0: 6c6f 6728 3130 2c20 6466 5b22 6122 5d29  log(10, df["a"])
-000137e0: 2e63 6173 7428 496e 7465 6765 7254 7970  .cast(IntegerTyp
-000137f0: 6528 2929 2e61 6c69 6173 2822 6c6f 6722  e()).alias("log"
-00013800: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00013810: 2020 2020 205b 526f 7728 4c4f 473d 3029       [Row(LOG=0)
-00013820: 2c20 526f 7728 4c4f 473d 3129 5d0a 2020  , Row(LOG=1)].  
-00013830: 2020 2222 220a 2020 2020 6220 3d20 6c69    """.    b = li
-00013840: 7428 6261 7365 2920 6966 2069 7369 6e73  t(base) if isins
-00013850: 7461 6e63 6528 6261 7365 2c20 2869 6e74  tance(base, (int
-00013860: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
-00013870: 746f 5f63 6f6c 5f69 665f 7374 7228 6261  to_col_if_str(ba
-00013880: 7365 2c20 226c 6f67 2229 0a20 2020 2061  se, "log").    a
-00013890: 7267 203d 206c 6974 2878 2920 6966 2069  rg = lit(x) if i
-000138a0: 7369 6e73 7461 6e63 6528 782c 2028 696e  sinstance(x, (in
-000138b0: 742c 2066 6c6f 6174 2929 2065 6c73 6520  t, float)) else 
-000138c0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2878  _to_col_if_str(x
-000138d0: 2c20 226c 6f67 2229 0a20 2020 2072 6574  , "log").    ret
-000138e0: 7572 6e20 6275 696c 7469 6e28 226c 6f67  urn builtin("log
-000138f0: 2229 2862 2c20 6172 6729 0a0a 0a64 6566  ")(b, arg)...def
-00013900: 2070 6f77 280a 2020 2020 6c65 6674 3a20   pow(.    left: 
-00013910: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-00013920: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
-00013930: 2072 6967 6874 3a20 556e 696f 6e5b 436f   right: Union[Co
-00013940: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
-00013950: 2066 6c6f 6174 5d0a 2920 2d3e 2043 6f6c   float].) -> Col
-00013960: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00013970: 726e 7320 6120 6e75 6d62 6572 2028 6c65  rns a number (le
-00013980: 6674 2920 7261 6973 6564 2074 6f20 7468  ft) raised to th
-00013990: 6520 7370 6563 6966 6965 6420 706f 7765  e specified powe
-000139a0: 7220 2872 6967 6874 292e 0a0a 2020 2020  r (right)...    
-000139b0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-000139c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000139d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000139e0: 616d 6528 5b5b 322c 2033 5d2c 205b 332c  ame([[2, 3], [3,
-000139f0: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2278   4]], schema=["x
-00013a00: 222c 2022 7922 5d29 0a20 2020 2020 2020  ", "y"]).       
-00013a10: 203e 3e3e 2064 662e 7365 6c65 6374 2870   >>> df.select(p
-00013a20: 6f77 2863 6f6c 2822 7822 292c 2063 6f6c  ow(col("x"), col
-00013a30: 2822 7922 2929 2e61 6c69 6173 2822 7265  ("y")).alias("re
-00013a40: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00013a50: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00013a60: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00013a70: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00013a80: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00013a90: 2020 2020 2020 7c38 2e30 2020 2020 2020        |8.0      
-00013aa0: 207c 0a20 2020 2020 2020 207c 3831 2e30   |.        |81.0
-00013ab0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00013ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00013ad0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00013ae0: 0a20 2020 2022 2222 0a20 2020 206e 756d  .    """.    num
-00013af0: 6265 7220 3d20 280a 2020 2020 2020 2020  ber = (.        
-00013b00: 6c69 7428 6c65 6674 2920 6966 2069 7369  lit(left) if isi
-00013b10: 6e73 7461 6e63 6528 6c65 6674 2c20 2869  nstance(left, (i
-00013b20: 6e74 2c20 666c 6f61 7429 2920 656c 7365  nt, float)) else
-00013b30: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00013b40: 6c65 6674 2c20 2270 6f77 2229 0a20 2020  left, "pow").   
-00013b50: 2029 0a20 2020 2070 6f77 6572 203d 2028   ).    power = (
-00013b60: 0a20 2020 2020 2020 206c 6974 2872 6967  .        lit(rig
-00013b70: 6874 2920 6966 2069 7369 6e73 7461 6e63  ht) if isinstanc
-00013b80: 6528 7269 6768 742c 2028 696e 742c 2066  e(right, (int, f
-00013b90: 6c6f 6174 2929 2065 6c73 6520 5f74 6f5f  loat)) else _to_
-00013ba0: 636f 6c5f 6966 5f73 7472 2872 6967 6874  col_if_str(right
-00013bb0: 2c20 2270 6f77 2229 0a20 2020 2029 0a20  , "pow").    ). 
-00013bc0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00013bd0: 6e28 2270 6f77 2229 286e 756d 6265 722c  n("pow")(number,
-00013be0: 2070 6f77 6572 290a 0a0a 6465 6620 726f   power)...def ro
-00013bf0: 756e 6428 653a 2043 6f6c 756d 6e4f 724e  und(e: ColumnOrN
-00013c00: 616d 652c 2073 6361 6c65 3a20 556e 696f  ame, scale: Unio
-00013c10: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-00013c20: 696e 742c 2066 6c6f 6174 5d20 3d20 3029  int, float] = 0)
-00013c30: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00013c40: 2222 2252 6574 7572 6e73 2072 6f75 6e64  """Returns round
-00013c50: 6564 2076 616c 7565 7320 6672 6f6d 2074  ed values from t
-00013c60: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
-00013c70: 756d 6e2e 0a0a 2020 2020 4578 616d 706c  umn...    Exampl
-00013c80: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00013c90: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00013ca0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00013cb0: 5b31 2e31 315d 2c20 5b32 2e32 325d 2c20  [1.11], [2.22], 
-00013cc0: 5b33 2e33 335d 5d2c 2073 6368 656d 613d  [3.33]], schema=
-00013cd0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-00013ce0: 3e3e 2064 662e 7365 6c65 6374 2872 6f75  >> df.select(rou
-00013cf0: 6e64 2863 6f6c 2822 6122 2929 2e61 6c69  nd(col("a")).ali
-00013d00: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-00013d10: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00013d20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00013d30: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-00013d40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00013d50: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e30  ---.        |1.0
-00013d60: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00013d70: 207c 322e 3020 2020 2020 2020 7c0a 2020   |2.0       |.  
-00013d80: 2020 2020 2020 7c33 2e30 2020 2020 2020        |3.0      
-00013d90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00013da0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00013db0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00013dc0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00013dd0: 636f 6c5f 6966 5f73 7472 2865 2c20 2272  col_if_str(e, "r
-00013de0: 6f75 6e64 2229 0a20 2020 2073 6361 6c65  ound").    scale
-00013df0: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
-00013e00: 206c 6974 2873 6361 6c65 290a 2020 2020   lit(scale).    
-00013e10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00013e20: 6528 7363 616c 652c 2028 696e 742c 2066  e(scale, (int, f
-00013e30: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
-00013e40: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
-00013e50: 7472 2873 6361 6c65 2c20 2272 6f75 6e64  tr(scale, "round
-00013e60: 2229 0a20 2020 2029 0a20 2020 2072 6574  ").    ).    ret
-00013e70: 7572 6e20 6275 696c 7469 6e28 2272 6f75  urn builtin("rou
-00013e80: 6e64 2229 2863 2c20 7363 616c 655f 636f  nd")(c, scale_co
-00013e90: 6c29 0a0a 0a64 6566 2073 706c 6974 280a  l)...def split(.
-00013ea0: 2020 2020 7374 723a 2043 6f6c 756d 6e4f      str: ColumnO
-00013eb0: 724e 616d 652c 0a20 2020 2070 6174 7465  rName,.    patte
-00013ec0: 726e 3a20 436f 6c75 6d6e 4f72 4e61 6d65  rn: ColumnOrName
-00013ed0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-00013ee0: 2020 2022 2222 5370 6c69 7473 2061 2067     """Splits a g
-00013ef0: 6976 656e 2073 7472 696e 6720 7769 7468  iven string with
-00013f00: 2061 2067 6976 656e 2073 6570 6172 6174   a given separat
-00013f10: 6f72 2061 6e64 2072 6574 7572 6e73 2074  or and returns t
-00013f20: 6865 2072 6573 756c 7420 696e 2061 6e20  he result in an 
-00013f30: 6172 7261 790a 2020 2020 6f66 2073 7472  array.    of str
-00013f40: 696e 6773 2e20 546f 2073 7065 6369 6679  ings. To specify
-00013f50: 2061 2073 7472 696e 6720 7365 7061 7261   a string separa
-00013f60: 746f 722c 2075 7365 2074 6865 203a 6675  tor, use the :fu
-00013f70: 6e63 3a60 6c69 7428 2960 2066 756e 6374  nc:`lit()` funct
-00013f80: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
-00013f90: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00013fa0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00013fb0: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-00013fc0: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-00013fd0: 5b22 6d61 6e79 2d6d 616e 792d 776f 7264  ["many-many-word
-00013fe0: 7322 2c20 222d 225d 2c20 5b22 6865 6c6c  s", "-"], ["hell
-00013ff0: 6f2d 2d68 656c 6c6f 222c 2022 2d2d 225d  o--hello", "--"]
-00014000: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-00014010: 2020 2073 6368 656d 613d 5b22 5622 2c20     schema=["V", 
-00014020: 2244 225d 2c0a 2020 2020 2020 2020 2e2e  "D"],.        ..
-00014030: 2e20 292e 7365 6c65 6374 2873 706c 6974  . ).select(split
-00014040: 2863 6f6c 2822 5622 292c 2063 6f6c 2822  (col("V"), col("
-00014050: 4422 2929 290a 2020 2020 2020 2020 3e3e  D"))).        >>
-00014060: 3e20 6466 2e73 686f 7728 290a 2020 2020  > df.show().    
-00014070: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00014080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00014090: 2020 2020 2020 7c22 5350 4c49 5428 2222        |"SPLIT(""
-000140a0: 5622 222c 2022 2244 2222 2922 2020 7c0a  V"", ""D"")"  |.
-000140b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000140c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000140d0: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
-000140e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140f0: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
-00014100: 6d61 6e79 222c 2020 2020 2020 2020 2020  many",          
-00014110: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00014120: 2022 6d61 6e79 222c 2020 2020 2020 2020   "many",        
-00014130: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00014140: 7c20 2022 776f 7264 7322 2020 2020 2020  |  "words"      
-00014150: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00014160: 2020 7c5d 2020 2020 2020 2020 2020 2020    |]            
-00014170: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00014180: 2020 2020 7c5b 2020 2020 2020 2020 2020      |[          
-00014190: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-000141a0: 2020 2020 2020 7c20 2022 6865 6c6c 6f22        |  "hello"
-000141b0: 2c20 2020 2020 2020 2020 2020 2020 7c0a  ,             |.
-000141c0: 2020 2020 2020 2020 7c20 2022 6865 6c6c          |  "hell
-000141d0: 6f22 2020 2020 2020 2020 2020 2020 2020  o"              
-000141e0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-000141f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014200: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00014210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00014220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-00014230: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-00014240: 220a 2020 2020 7320 3d20 5f74 6f5f 636f  ".    s = _to_co
-00014250: 6c5f 6966 5f73 7472 2873 7472 2c20 2273  l_if_str(str, "s
-00014260: 706c 6974 2229 0a20 2020 2070 203d 205f  plit").    p = _
-00014270: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
-00014280: 7474 6572 6e2c 2022 7370 6c69 7422 290a  ttern, "split").
-00014290: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000142a0: 696e 2822 7370 6c69 7422 2928 732c 2070  in("split")(s, p
-000142b0: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
-000142c0: 6728 0a20 2020 2073 7472 3a20 436f 6c75  g(.    str: Colu
-000142d0: 6d6e 4f72 4e61 6d65 2c20 706f 733a 2055  mnOrName, pos: U
-000142e0: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
-000142f0: 5d2c 206c 656e 3a20 556e 696f 6e5b 436f  ], len: Union[Co
-00014300: 6c75 6d6e 2c20 696e 745d 0a29 202d 3e20  lumn, int].) -> 
-00014310: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00014320: 6574 7572 6e73 2074 6865 2070 6f72 7469  eturns the porti
-00014330: 6f6e 206f 6620 7468 6520 7374 7269 6e67  on of the string
-00014340: 206f 7220 6269 6e61 7279 2076 616c 7565   or binary value
-00014350: 2073 7472 2c20 7374 6172 7469 6e67 2066   str, starting f
-00014360: 726f 6d20 7468 650a 2020 2020 6368 6172  rom the.    char
-00014370: 6163 7465 722f 6279 7465 2073 7065 6369  acter/byte speci
-00014380: 6669 6564 2062 7920 706f 732c 2077 6974  fied by pos, wit
-00014390: 6820 6c69 6d69 7465 6420 6c65 6e67 7468  h limited length
-000143a0: 2e20 5468 6520 6c65 6e67 7468 2073 686f  . The length sho
-000143b0: 756c 6420 6265 2067 7265 6174 6572 0a20  uld be greater. 
-000143c0: 2020 2074 6861 6e20 6f72 2065 7175 616c     than or equal
-000143d0: 2074 6f20 7a65 726f 2e20 4966 2074 6865   to zero. If the
-000143e0: 206c 656e 6774 6820 6973 2061 206e 6567   length is a neg
-000143f0: 6174 6976 6520 6e75 6d62 6572 2c20 7468  ative number, th
-00014400: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-00014410: 6e73 2061 6e0a 2020 2020 656d 7074 7920  ns an.    empty 
-00014420: 7374 7269 6e67 2e0a 0a20 2020 204e 6f74  string...    Not
-00014430: 653a 0a20 2020 2020 2020 2046 6f72 2060  e:.        For `
-00014440: 6070 6f73 6060 2c20 3120 6973 2074 6865  `pos``, 1 is the
-00014450: 2066 6972 7374 2063 6861 7261 6374 6572   first character
-00014460: 206f 6620 7468 6520 7374 7269 6e67 2069   of the string i
-00014470: 6e20 536e 6f77 666c 616b 6520 6461 7461  n Snowflake data
-00014480: 6261 7365 2e0a 0a20 2020 203a 6675 6e63  base...    :func
-00014490: 3a60 7375 6273 7472 6020 6973 2061 6e20  :`substr` is an 
-000144a0: 616c 6961 7320 6f66 203a 6675 6e63 3a60  alias of :func:`
-000144b0: 7375 6273 7472 696e 6760 2e0a 0a20 2020  substring`...   
-000144c0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-000144d0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000144e0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000144f0: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00014500: 2e20 2020 2020 5b22 6162 6322 2c20 2264  .     ["abc", "d
-00014510: 6566 225d 2c0a 2020 2020 2020 2020 2e2e  ef"],.        ..
-00014520: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
-00014530: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
-00014540: 292e 7365 6c65 6374 2873 7562 7374 7269  ).select(substri
-00014550: 6e67 2863 6f6c 2822 5322 292c 2031 2c20  ng(col("S"), 1, 
-00014560: 3129 290a 2020 2020 2020 2020 3e3e 3e20  1)).        >>> 
-00014570: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
-00014580: 2020 2020 205b 526f 7728 5355 4253 5452       [Row(SUBSTR
-00014590: 494e 4728 2253 222c 2031 2c20 3129 3d27  ING("S", 1, 1)='
-000145a0: 6127 292c 2052 6f77 2853 5542 5354 5249  a'), Row(SUBSTRI
-000145b0: 4e47 2822 5322 2c20 312c 2031 293d 2764  NG("S", 1, 1)='d
-000145c0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-000145d0: 7320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  s = _to_col_if_s
-000145e0: 7472 2873 7472 2c20 2273 7562 7374 7269  tr(str, "substri
-000145f0: 6e67 2229 0a20 2020 2070 203d 2070 6f73  ng").    p = pos
-00014600: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-00014610: 6f73 2c20 436f 6c75 6d6e 2920 656c 7365  os, Column) else
-00014620: 206c 6974 2870 6f73 290a 2020 2020 6c65   lit(pos).    le
-00014630: 6e67 7468 203d 206c 656e 2069 6620 6973  ngth = len if is
-00014640: 696e 7374 616e 6365 286c 656e 2c20 436f  instance(len, Co
-00014650: 6c75 6d6e 2920 656c 7365 206c 6974 286c  lumn) else lit(l
-00014660: 656e 290a 2020 2020 7265 7475 726e 2062  en).    return b
-00014670: 7569 6c74 696e 2822 7375 6273 7472 696e  uiltin("substrin
-00014680: 6722 2928 732c 2070 2c20 6c65 6e67 7468  g")(s, p, length
-00014690: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
-000146a0: 675f 696e 6465 7828 0a20 2020 2074 6578  g_index(.    tex
-000146b0: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
-000146c0: 2064 656c 696d 3a20 436f 6c75 6d6e 4f72   delim: ColumnOr
-000146d0: 4c69 7465 7261 6c53 7472 2c20 636f 756e  LiteralStr, coun
-000146e0: 743a 2069 6e74 0a29 202d 3e20 436f 6c75  t: int.) -> Colu
-000146f0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00014700: 5265 7475 726e 7320 7468 6520 7375 6273  Returns the subs
-00014710: 7472 696e 6720 6672 6f6d 2073 7472 696e  tring from strin
-00014720: 6720 6060 7465 7874 6060 2062 6566 6f72  g ``text`` befor
-00014730: 6520 6060 636f 756e 7460 6020 6f63 6375  e ``count`` occu
-00014740: 7272 656e 6365 7320 6f66 2074 6865 2064  rrences of the d
-00014750: 656c 696d 6974 6572 2060 6064 656c 696d  elimiter ``delim
-00014760: 6060 2e0a 2020 2020 4966 2060 6063 6f75  ``..    If ``cou
-00014770: 6e74 6060 2069 7320 706f 7369 7469 7665  nt`` is positive
-00014780: 2c20 6576 6572 7974 6869 6e67 2074 6f20  , everything to 
-00014790: 7468 6520 6c65 6674 206f 6620 7468 6520  the left of the 
-000147a0: 6669 6e61 6c20 6465 6c69 6d69 7465 7220  final delimiter 
-000147b0: 2863 6f75 6e74 696e 6720 6672 6f6d 206c  (counting from l
-000147c0: 6566 7429 2069 730a 2020 2020 7265 7475  eft) is.    retu
-000147d0: 726e 6564 2e20 4966 2060 6063 6f75 6e74  rned. If ``count
-000147e0: 6060 2069 7320 6e65 6761 7469 7665 2c20  `` is negative, 
-000147f0: 6576 6572 7974 6869 6e67 2074 6f20 7468  everything to th
-00014800: 6520 7269 6768 7420 6f66 2074 6865 2066  e right of the f
-00014810: 696e 616c 2064 656c 696d 6974 6572 2028  inal delimiter (
-00014820: 636f 756e 7469 6e67 2066 726f 6d20 7468  counting from th
-00014830: 650a 2020 2020 7269 6768 7429 2069 7320  e.    right) is 
-00014840: 7265 7475 726e 6564 2e20 4966 2060 6063  returned. If ``c
-00014850: 6f75 6e74 6060 2069 7320 7a65 726f 2c20  ount`` is zero, 
-00014860: 7265 7475 726e 7320 656d 7074 7920 7374  returns empty st
-00014870: 7269 6e67 2e0a 0a20 2020 2045 7861 6d70  ring...    Examp
-00014880: 6c65 2031 3a3a 0a20 2020 2020 2020 203e  le 1::.        >
-00014890: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000148a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000148b0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-000148c0: 2020 5b22 612e 622e 632e 6422 5d2c 0a20    ["a.b.c.d"],. 
-000148d0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-000148e0: 6368 656d 613d 5b22 5322 5d2c 0a20 2020  chema=["S"],.   
-000148f0: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
-00014900: 7428 7375 6273 7472 696e 675f 696e 6465  t(substring_inde
-00014910: 7828 636f 6c28 2253 2229 2c20 222e 222c  x(col("S"), ".",
-00014920: 2032 292e 616c 6961 7328 2272 6573 756c   2).alias("resul
-00014930: 7422 2929 0a20 2020 2020 2020 203e 3e3e  t")).        >>>
-00014940: 2064 662e 7368 6f77 2829 0a20 2020 2020   df.show().     
-00014950: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00014960: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-00014970: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-00014980: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00014990: 2020 7c61 2e62 2020 2020 2020 207c 0a20    |a.b       |. 
-000149a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000149b0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-000149c0: 4e4b 4c49 4e45 3e0a 0a20 2020 2045 7861  NKLINE>..    Exa
-000149d0: 6d70 6c65 2032 3a3a 0a20 2020 2020 2020  mple 2::.       
-000149e0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000149f0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00014a00: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
-00014a10: 2020 2020 5b5b 2261 2e62 2e63 2e64 222c      [["a.b.c.d",
-00014a20: 2022 2e22 5d5d 2c0a 2020 2020 2020 2020   "."]],.        
-00014a30: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-00014a40: 2253 222c 2022 6465 6c69 6d69 7465 7222  "S", "delimiter"
-00014a50: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
-00014a60: 2e73 656c 6563 7428 7375 6273 7472 696e  .select(substrin
-00014a70: 675f 696e 6465 7828 636f 6c28 2253 2229  g_index(col("S")
-00014a80: 2c20 636f 6c28 2264 656c 696d 6974 6572  , col("delimiter
-00014a90: 2229 2c20 3229 2e61 6c69 6173 2822 7265  "), 2).alias("re
-00014aa0: 7375 6c74 2229 290a 2020 2020 2020 2020  sult")).        
-00014ab0: 3e3e 3e20 6466 2e73 686f 7728 290a 2020  >>> df.show().  
-00014ac0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00014ad0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-00014ae0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-00014af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00014b00: 2020 2020 207c 612e 6220 2020 2020 2020       |a.b       
-00014b10: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00014b20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00014b30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00014b40: 2222 0a20 2020 2073 203d 205f 746f 5f63  "".    s = _to_c
-00014b50: 6f6c 5f69 665f 7374 7228 7465 7874 2c20  ol_if_str(text, 
-00014b60: 2273 7562 7374 7269 6e67 5f69 6e64 6578  "substring_index
-00014b70: 2229 0a20 2020 2073 7472 746f 6b5f 6172  ").    strtok_ar
-00014b80: 7261 7920 3d20 6275 696c 7469 6e28 2273  ray = builtin("s
-00014b90: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
-00014ba0: 2873 2c20 6465 6c69 6d29 0a20 2020 2072  (s, delim).    r
-00014bb0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-00014bc0: 7272 6179 5f74 6f5f 7374 7269 6e67 2229  rray_to_string")
-00014bd0: 280a 2020 2020 2020 2020 6275 696c 7469  (.        builti
-00014be0: 6e28 2261 7272 6179 5f73 6c69 6365 2229  n("array_slice")
-00014bf0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
-00014c00: 7274 6f6b 5f61 7272 6179 2c0a 2020 2020  rtok_array,.    
-00014c10: 2020 2020 2020 2020 3020 6966 2063 6f75          0 if cou
-00014c20: 6e74 203e 3d20 3020 656c 7365 2062 7569  nt >= 0 else bui
-00014c30: 6c74 696e 2822 6172 7261 795f 7369 7a65  ltin("array_size
-00014c40: 2229 2873 7472 746f 6b5f 6172 7261 7929  ")(strtok_array)
-00014c50: 202b 2063 6f75 6e74 2c0a 2020 2020 2020   + count,.      
-00014c60: 2020 2020 2020 636f 756e 7420 6966 2063        count if c
-00014c70: 6f75 6e74 203e 3d20 3020 656c 7365 2062  ount >= 0 else b
-00014c80: 7569 6c74 696e 2822 6172 7261 795f 7369  uiltin("array_si
-00014c90: 7a65 2229 2873 7472 746f 6b5f 6172 7261  ze")(strtok_arra
-00014ca0: 7929 2c0a 2020 2020 2020 2020 292c 0a20  y),.        ),. 
-00014cb0: 2020 2020 2020 2064 656c 696d 2c0a 2020         delim,.  
-00014cc0: 2020 290a 0a0a 6465 6620 7265 6765 7870    )...def regexp
-00014cd0: 5f63 6f75 6e74 280a 2020 2020 7375 626a  _count(.    subj
-00014ce0: 6563 743a 2043 6f6c 756d 6e4f 724e 616d  ect: ColumnOrNam
-00014cf0: 652c 0a20 2020 2070 6174 7465 726e 3a20  e,.    pattern: 
-00014d00: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
-00014d10: 7472 2c0a 2020 2020 706f 7369 7469 6f6e  tr,.    position
-00014d20: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
-00014d30: 696e 745d 203d 2031 2c0a 2020 2020 2a70  int] = 1,.    *p
-00014d40: 6172 616d 6574 6572 733a 2043 6f6c 756d  arameters: Colum
-00014d50: 6e4f 724c 6974 6572 616c 2c0a 2920 2d3e  nOrLiteral,.) ->
-00014d60: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00014d70: 5265 7475 726e 7320 7468 6520 6e75 6d62  Returns the numb
-00014d80: 6572 206f 6620 7469 6d65 7320 7468 6174  er of times that
-00014d90: 2061 2070 6174 7465 726e 206f 6363 7572   a pattern occur
-00014da0: 7320 696e 2074 6865 2073 7562 6a65 6374  s in the subject
-00014db0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00014dc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00014dd0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-00014de0: 7365 6c65 6374 202a 2066 726f 6d20 7661  select * from va
-00014df0: 6c75 6573 2827 6170 706c 6527 292c 2827  lues('apple'),('
-00014e00: 6261 6e61 6e61 2729 2c28 2770 6561 6368  banana'),('peach
-00014e10: 2729 2061 7320 5428 6129 2229 0a20 2020  ') as T(a)").   
-00014e20: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00014e30: 6374 2872 6567 6578 705f 636f 756e 7428  ct(regexp_count(
-00014e40: 636f 6c28 2261 2229 2c20 2261 2229 2e61  col("a"), "a").a
-00014e50: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00014e60: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00014e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00014e80: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00014e90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00014ea0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
-00014eb0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00014ec0: 2020 207c 3320 2020 2020 2020 2020 7c0a     |3         |.
-00014ed0: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
-00014ee0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00014ef0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00014f00: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00014f10: 2020 2222 220a 2020 2020 7371 6c5f 6675    """.    sql_fu
-00014f20: 6e63 5f6e 616d 6520 3d20 2272 6567 6578  nc_name = "regex
-00014f30: 705f 636f 756e 7422 0a20 2020 2073 7562  p_count".    sub
-00014f40: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00014f50: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
-00014f60: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
-00014f70: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
-00014f80: 0a20 2020 2070 6f73 203d 206c 6974 2870  .    pos = lit(p
-00014f90: 6f73 6974 696f 6e29 0a0a 2020 2020 7061  osition)..    pa
-00014fa0: 7261 6d73 203d 205b 6c69 7428 7029 2066  rams = [lit(p) f
-00014fb0: 6f72 2070 2069 6e20 7061 7261 6d65 7465  or p in paramete
-00014fc0: 7273 5d0a 2020 2020 7265 7475 726e 2062  rs].    return b
-00014fd0: 7569 6c74 696e 2873 716c 5f66 756e 635f  uiltin(sql_func_
-00014fe0: 6e61 6d65 2928 7375 622c 2070 6174 2c20  name)(sub, pat, 
-00014ff0: 706f 732c 202a 7061 7261 6d73 290a 0a0a  pos, *params)...
-00015000: 6465 6620 7265 6765 7870 5f65 7874 7261  def regexp_extra
-00015010: 6374 280a 2020 2020 7661 6c75 653a 2043  ct(.    value: C
-00015020: 6f6c 756d 6e4f 724c 6974 6572 616c 5374  olumnOrLiteralSt
-00015030: 722c 2072 6567 6578 703a 2043 6f6c 756d  r, regexp: Colum
-00015040: 6e4f 724c 6974 6572 616c 5374 722c 2069  nOrLiteralStr, i
-00015050: 6478 3a20 696e 740a 2920 2d3e 2043 6f6c  dx: int.) -> Col
-00015060: 756d 6e3a 0a20 2020 2072 2222 220a 2020  umn:.    r""".  
-00015070: 2020 4578 7472 6163 7420 6120 7370 6563    Extract a spec
-00015080: 6966 6963 2067 726f 7570 206d 6174 6368  ific group match
-00015090: 6564 2062 7920 6120 7265 6765 782c 2066  ed by a regex, f
-000150a0: 726f 6d20 7468 6520 7370 6563 6966 6965  rom the specifie
-000150b0: 6420 7374 7269 6e67 2063 6f6c 756d 6e2e  d string column.
-000150c0: 0a20 2020 2049 6620 7468 6520 7265 6765  .    If the rege
-000150d0: 7820 6469 6420 6e6f 7420 6d61 7463 682c  x did not match,
-000150e0: 206f 7220 7468 6520 7370 6563 6966 6965   or the specifie
-000150f0: 6420 6772 6f75 7020 6469 6420 6e6f 7420  d group did not 
-00015100: 6d61 7463 682c 0a20 2020 2061 6e20 656d  match,.    an em
-00015110: 7074 7920 7374 7269 6e67 2069 7320 7265  pty string is re
-00015120: 7475 726e 6564 2e0a 0a20 2020 2045 7861  turned...    Exa
-00015130: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00015140: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00015150: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-00015160: 7469 6f6e 7320 696d 706f 7274 2072 6567  tions import reg
-00015170: 6578 705f 6578 7472 6163 740a 2020 2020  exp_extract.    
-00015180: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00015190: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
-000151a0: 7261 6d65 285b 5b22 6964 5f32 305f 3330  rame([["id_20_30
-000151b0: 222c 2031 305d 2c20 5b22 6964 5f34 305f  ", 10], ["id_40_
-000151c0: 3530 222c 2033 305d 5d2c 205b 2269 6422  50", 30]], ["id"
-000151d0: 2c20 2261 6765 225d 290a 2020 2020 2020  , "age"]).      
-000151e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000151f0: 7265 6765 7870 5f65 7874 7261 6374 2822  regexp_extract("
-00015200: 6964 222c 2072 2228 5c64 2b29 222c 2031  id", r"(\d+)", 1
-00015210: 292e 616c 6961 7328 2252 4553 2229 292e  ).alias("RES")).
-00015220: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00015230: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015240: 207c 2252 4553 2220 207c 0a20 2020 2020   |"RES"  |.     
-00015250: 2020 202d 2d2d 2d2d 2d2d 2d2d 0a20 2020     ---------.   
-00015260: 2020 2020 207c 3230 2020 2020 207c 0a20       |20     |. 
-00015270: 2020 2020 2020 207c 3430 2020 2020 207c         |40     |
-00015280: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00015290: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-000152a0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-000152b0: 2020 2076 616c 7565 203d 205f 746f 5f63     value = _to_c
-000152c0: 6f6c 5f69 665f 7374 7228 7661 6c75 652c  ol_if_str(value,
-000152d0: 2022 7265 6765 7870 5f65 7874 7261 6374   "regexp_extract
-000152e0: 2229 0a20 2020 2072 6567 6578 7020 3d20  ").    regexp = 
-000152f0: 5f74 6f5f 636f 6c5f 6966 5f6c 6974 2872  _to_col_if_lit(r
-00015300: 6567 6578 702c 2022 7265 6765 7870 5f65  egexp, "regexp_e
-00015310: 7874 7261 6374 2229 0a20 2020 2069 6478  xtract").    idx
-00015320: 203d 205f 746f 5f63 6f6c 5f69 665f 6c69   = _to_col_if_li
-00015330: 7428 6964 782c 2022 7265 6765 7870 5f65  t(idx, "regexp_e
-00015340: 7874 7261 6374 2229 0a20 2020 2072 6574  xtract").    ret
-00015350: 7572 6e20 636f 616c 6573 6365 280a 2020  urn coalesce(.  
-00015360: 2020 2020 2020 6361 6c6c 5f62 7569 6c74        call_built
-00015370: 696e 2822 7265 6765 7870 5f73 7562 7374  in("regexp_subst
-00015380: 7222 2c20 7661 6c75 652c 2072 6567 6578  r", value, regex
-00015390: 702c 206c 6974 2831 292c 206c 6974 2831  p, lit(1), lit(1
-000153a0: 292c 206c 6974 2822 6522 292c 2069 6478  ), lit("e"), idx
-000153b0: 292c 0a20 2020 2020 2020 206c 6974 2822  ),.        lit("
-000153c0: 2229 2c0a 2020 2020 290a 0a0a 6465 6620  "),.    )...def 
-000153d0: 7265 6765 7870 5f72 6570 6c61 6365 280a  regexp_replace(.
-000153e0: 2020 2020 7375 626a 6563 743a 2043 6f6c      subject: Col
-000153f0: 756d 6e4f 724e 616d 652c 0a20 2020 2070  umnOrName,.    p
-00015400: 6174 7465 726e 3a20 436f 6c75 6d6e 4f72  attern: ColumnOr
-00015410: 4c69 7465 7261 6c53 7472 2c0a 2020 2020  LiteralStr,.    
-00015420: 7265 706c 6163 656d 656e 743a 2043 6f6c  replacement: Col
-00015430: 756d 6e4f 724c 6974 6572 616c 5374 7220  umnOrLiteralStr 
-00015440: 3d20 2222 2c0a 2020 2020 706f 7369 7469  = "",.    positi
-00015450: 6f6e 3a20 556e 696f 6e5b 436f 6c75 6d6e  on: Union[Column
-00015460: 2c20 696e 745d 203d 2031 2c0a 2020 2020  , int] = 1,.    
-00015470: 6f63 6375 7272 656e 6365 733a 2055 6e69  occurrences: Uni
-00015480: 6f6e 5b43 6f6c 756d 6e2c 2069 6e74 5d20  on[Column, int] 
-00015490: 3d20 302c 0a20 2020 202a 7061 7261 6d65  = 0,.    *parame
-000154a0: 7465 7273 3a20 436f 6c75 6d6e 4f72 4c69  ters: ColumnOrLi
-000154b0: 7465 7261 6c2c 0a29 202d 3e20 436f 6c75  teral,.) -> Colu
-000154c0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-000154d0: 6e73 2074 6865 2073 7562 6a65 6374 2077  ns the subject w
-000154e0: 6974 6820 7468 6520 7370 6563 6966 6965  ith the specifie
-000154f0: 6420 7061 7474 6572 6e20 286f 7220 616c  d pattern (or al
-00015500: 6c20 6f63 6375 7272 656e 6365 7320 6f66  l occurrences of
-00015510: 2074 6865 2070 6174 7465 726e 2920 6569   the pattern) ei
-00015520: 7468 6572 2072 656d 6f76 6564 206f 7220  ther removed or 
-00015530: 7265 706c 6163 6564 2062 7920 6120 7265  replaced by a re
-00015540: 706c 6163 656d 656e 7420 7374 7269 6e67  placement string
-00015550: 2e0a 2020 2020 4966 206e 6f20 6d61 7463  ..    If no matc
-00015560: 6865 7320 6172 6520 666f 756e 642c 2072  hes are found, r
-00015570: 6574 7572 6e73 2074 6865 206f 7269 6769  eturns the origi
-00015580: 6e61 6c20 7375 626a 6563 742e 0a0a 2020  nal subject...  
-00015590: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-000155a0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-000155b0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000155c0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
-000155d0: 2e2e 2020 2020 205b 5b22 4974 2077 6173  ..     [["It was
-000155e0: 2074 6865 2062 6573 7420 6f66 2074 696d   the best of tim
-000155f0: 6573 2c20 6974 2077 6173 2074 6865 2077  es, it was the w
-00015600: 6f72 7374 206f 6620 7469 6d65 7322 5d5d  orst of times"]]
-00015610: 2c20 7363 6865 6d61 3d5b 2261 225d 0a20  , schema=["a"]. 
-00015620: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00015630: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00015640: 6374 2872 6567 6578 705f 7265 706c 6163  ct(regexp_replac
-00015650: 6528 636f 6c28 2261 2229 2c20 6c69 7428  e(col("a"), lit(
-00015660: 2228 2029 7b31 2c7d 2229 2c20 6c69 7428  "( ){1,}"), lit(
-00015670: 2222 2929 2e61 6c69 6173 2822 7265 7375  "")).alias("resu
-00015680: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00015690: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000156a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000156b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000156c0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-000156d0: 4c54 2220 2020 2020 2020 2020 2020 2020  LT"             
-000156e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156f0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00015700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00015730: 2020 2020 7c49 7477 6173 7468 6562 6573      |Itwasthebes
-00015740: 746f 6674 696d 6573 2c69 7477 6173 7468  toftimes,itwasth
-00015750: 6577 6f72 7374 6f66 7469 6d65 7320 207c  eworstoftimes  |
-00015760: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00015770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015790: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-000157a0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-000157b0: 220a 2020 2020 7371 6c5f 6675 6e63 5f6e  ".    sql_func_n
-000157c0: 616d 6520 3d20 2272 6567 6578 705f 7265  ame = "regexp_re
-000157d0: 706c 6163 6522 0a20 2020 2073 7562 203d  place".    sub =
-000157e0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-000157f0: 7375 626a 6563 742c 2073 716c 5f66 756e  subject, sql_fun
-00015800: 635f 6e61 6d65 290a 2020 2020 7061 7420  c_name).    pat 
-00015810: 3d20 6c69 7428 7061 7474 6572 6e29 0a20  = lit(pattern). 
-00015820: 2020 2072 6570 203d 206c 6974 2872 6570     rep = lit(rep
-00015830: 6c61 6365 6d65 6e74 290a 2020 2020 706f  lacement).    po
-00015840: 7320 3d20 6c69 7428 706f 7369 7469 6f6e  s = lit(position
-00015850: 290a 2020 2020 6f63 6320 3d20 6c69 7428  ).    occ = lit(
-00015860: 6f63 6375 7272 656e 6365 7329 0a0a 2020  occurrences)..  
-00015870: 2020 7061 7261 6d73 203d 205b 6c69 7428    params = [lit(
-00015880: 7029 2066 6f72 2070 2069 6e20 7061 7261  p) for p in para
-00015890: 6d65 7465 7273 5d0a 2020 2020 7265 7475  meters].    retu
-000158a0: 726e 2062 7569 6c74 696e 2873 716c 5f66  rn builtin(sql_f
-000158b0: 756e 635f 6e61 6d65 2928 7375 622c 2070  unc_name)(sub, p
-000158c0: 6174 2c20 7265 702c 2070 6f73 2c20 6f63  at, rep, pos, oc
-000158d0: 632c 202a 7061 7261 6d73 290a 0a0a 6465  c, *params)...de
-000158e0: 6620 7265 706c 6163 6528 0a20 2020 2073  f replace(.    s
-000158f0: 7562 6a65 6374 3a20 436f 6c75 6d6e 4f72  ubject: ColumnOr
-00015900: 4e61 6d65 2c0a 2020 2020 7061 7474 6572  Name,.    patter
-00015910: 6e3a 2043 6f6c 756d 6e4f 724c 6974 6572  n: ColumnOrLiter
-00015920: 616c 5374 722c 0a20 2020 2072 6570 6c61  alStr,.    repla
-00015930: 6365 6d65 6e74 3a20 436f 6c75 6d6e 4f72  cement: ColumnOr
-00015940: 4c69 7465 7261 6c53 7472 203d 2022 222c  LiteralStr = "",
-00015950: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-00015960: 2020 2222 220a 2020 2020 5265 6d6f 7665    """.    Remove
-00015970: 7320 616c 6c20 6f63 6375 7272 656e 6365  s all occurrence
-00015980: 7320 6f66 2061 2073 7065 6369 6669 6564  s of a specified
-00015990: 2073 7562 6a65 6374 2061 6e64 206f 7074   subject and opt
-000159a0: 696f 6e61 6c6c 7920 7265 706c 6163 6573  ionally replaces
-000159b0: 2074 6865 6d20 7769 7468 2072 6570 6c61   them with repla
-000159c0: 6365 6d65 6e74 2e0a 0a20 2020 2045 7861  cement...    Exa
-000159d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-000159e0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000159f0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00015a00: 6528 5b5b 2261 7070 6c65 225d 2c20 5b22  e([["apple"], ["
-00015a10: 6170 706c 6520 7069 6522 5d2c 205b 2261  apple pie"], ["a
-00015a20: 7070 6c65 206a 7569 6365 225d 5d2c 2073  pple juice"]], s
-00015a30: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00015a40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00015a50: 6374 2872 6570 6c61 6365 2863 6f6c 2822  ct(replace(col("
-00015a60: 6122 292c 2022 6170 706c 6522 2c20 226f  a"), "apple", "o
-00015a70: 7261 6e67 6522 292e 616c 6961 7328 2272  range").alias("r
-00015a80: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00015a90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00015aa0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015ab0: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
-00015ac0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00015ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00015ae0: 2020 207c 6f72 616e 6765 2020 2020 2020     |orange      
-00015af0: 2020 7c0a 2020 2020 2020 2020 7c6f 7261    |.        |ora
-00015b00: 6e67 6520 7069 6520 2020 207c 0a20 2020  nge pie    |.   
-00015b10: 2020 2020 207c 6f72 616e 6765 206a 7569       |orange jui
-00015b20: 6365 2020 7c0a 2020 2020 2020 2020 2d2d  ce  |.        --
-00015b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00015b40: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-00015b50: 453e 0a20 2020 2022 2222 0a20 2020 2073  E>.    """.    s
-00015b60: 716c 5f66 756e 635f 6e61 6d65 203d 2022  ql_func_name = "
-00015b70: 7265 706c 6163 6522 0a20 2020 2073 7562  replace".    sub
-00015b80: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00015b90: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
-00015ba0: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
-00015bb0: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
-00015bc0: 0a20 2020 2072 6570 203d 206c 6974 2872  .    rep = lit(r
-00015bd0: 6570 6c61 6365 6d65 6e74 290a 2020 2020  eplacement).    
-00015be0: 7265 7475 726e 2062 7569 6c74 696e 2873  return builtin(s
-00015bf0: 716c 5f66 756e 635f 6e61 6d65 2928 7375  ql_func_name)(su
-00015c00: 622c 2070 6174 2c20 7265 7029 0a0a 0a64  b, pat, rep)...d
-00015c10: 6566 2063 6861 7269 6e64 6578 280a 2020  ef charindex(.  
-00015c20: 2020 7461 7267 6574 5f65 7870 723a 2043    target_expr: C
-00015c30: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
-00015c40: 2073 6f75 7263 655f 6578 7072 3a20 436f   source_expr: Co
-00015c50: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
-00015c60: 706f 7369 7469 6f6e 3a20 4f70 7469 6f6e  position: Option
-00015c70: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e2c  al[Union[Column,
-00015c80: 2069 6e74 5d5d 203d 204e 6f6e 652c 0a29   int]] = None,.)
-00015c90: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00015ca0: 2222 2253 6561 7263 6865 7320 666f 7220  """Searches for 
-00015cb0: 6060 7461 7267 6574 5f65 7870 7260 6020  ``target_expr`` 
-00015cc0: 696e 2060 6073 6f75 7263 655f 6578 7072  in ``source_expr
-00015cd0: 6060 2061 6e64 2c20 6966 2073 7563 6365  `` and, if succe
-00015ce0: 7373 6675 6c2c 0a20 2020 2072 6574 7572  ssful,.    retur
-00015cf0: 6e73 2074 6865 2070 6f73 6974 696f 6e20  ns the position 
-00015d00: 2831 2d62 6173 6564 2920 6f66 2074 6865  (1-based) of the
-00015d10: 2060 6074 6172 6765 745f 6578 7072 6060   ``target_expr``
-00015d20: 2069 6e20 6060 736f 7572 6365 5f65 7870   in ``source_exp
-00015d30: 7260 602e 0a0a 2020 2020 4172 6773 3a0a  r``...    Args:.
-00015d40: 2020 2020 2020 2020 7461 7267 6574 5f65          target_e
-00015d50: 7870 723a 2041 2073 7472 696e 6720 6f72  xpr: A string or
-00015d60: 2062 696e 6172 7920 6578 7072 6573 7369   binary expressi
-00015d70: 6f6e 2072 6570 7265 7365 6e74 696e 6720  on representing 
-00015d80: 7468 6520 7661 6c75 6520 746f 206c 6f6f  the value to loo
-00015d90: 6b20 666f 722e 0a20 2020 2020 2020 2073  k for..        s
-00015da0: 6f75 7263 655f 6578 7072 3a20 4120 7374  ource_expr: A st
-00015db0: 7269 6e67 206f 7220 6269 6e61 7279 2065  ring or binary e
-00015dc0: 7870 7265 7373 696f 6e20 7265 7072 6573  xpression repres
-00015dd0: 656e 7469 6e67 2074 6865 2076 616c 7565  enting the value
-00015de0: 2074 6f20 7365 6172 6368 2e0a 2020 2020   to search..    
-00015df0: 2020 2020 706f 7369 7469 6f6e 3a20 4120      position: A 
-00015e00: 6e75 6d62 6572 2069 6e64 6963 6174 696f  number indicatio
-00015e10: 6e20 7468 6520 706f 7369 7469 6f6e 2028  n the position (
-00015e20: 312d 6261 7365 6429 2066 726f 6d20 7768  1-based) from wh
-00015e30: 6572 6520 746f 2073 7461 7274 2074 6865  ere to start the
-00015e40: 2073 6561 7263 682e 2044 6566 6175 6c74   search. Default
-00015e50: 7320 746f 204e 6f6e 652e 0a0a 2020 2020  s to None...    
-00015e60: 4578 616d 706c 6573 3a3a 0a20 2020 2020  Examples::.     
-00015e70: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00015e80: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00015e90: 7261 6d65 285b 2262 616e 616e 6122 5d2c  rame(["banana"],
-00015ea0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-00015eb0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00015ec0: 6c65 6374 2863 6861 7269 6e64 6578 286c  lect(charindex(l
-00015ed0: 6974 2822 616e 2229 2c20 6466 2e61 2c20  it("an"), df.a, 
-00015ee0: 3129 2e61 735f 2822 7265 7375 6c74 2229  1).as_("result")
-00015ef0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00015f00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00015f10: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00015f20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00015f30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00015f40: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
-00015f50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00015f60: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00015f70: 4c49 4e45 3e0a 0a20 2020 2020 2020 203e  LINE>..        >
-00015f80: 3e3e 2064 662e 7365 6c65 6374 2863 6861  >> df.select(cha
-00015f90: 7269 6e64 6578 286c 6974 2822 616e 2229  rindex(lit("an")
-00015fa0: 2c20 6466 2e61 2c20 3329 2e61 735f 2822  , df.a, 3).as_("
-00015fb0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00015fc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00015fd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00015fe0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-00015ff0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00016000: 2020 2020 2020 2020 7c34 2020 2020 2020          |4      
-00016010: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00016020: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00016030: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00016040: 2020 2222 220a 2020 2020 7420 3d20 5f74    """.    t = _t
-00016050: 6f5f 636f 6c5f 6966 5f73 7472 2874 6172  o_col_if_str(tar
-00016060: 6765 745f 6578 7072 2c20 2263 6861 7269  get_expr, "chari
-00016070: 6e64 6578 2229 0a20 2020 2073 203d 205f  ndex").    s = _
-00016080: 746f 5f63 6f6c 5f69 665f 7374 7228 736f  to_col_if_str(so
-00016090: 7572 6365 5f65 7870 722c 2022 6368 6172  urce_expr, "char
-000160a0: 696e 6465 7822 290a 2020 2020 7265 7475  index").    retu
-000160b0: 726e 2028 0a20 2020 2020 2020 2062 7569  rn (.        bui
-000160c0: 6c74 696e 2822 6368 6172 696e 6465 7822  ltin("charindex"
-000160d0: 2928 742c 2073 2c20 6c69 7428 706f 7369  )(t, s, lit(posi
-000160e0: 7469 6f6e 2929 0a20 2020 2020 2020 2069  tion)).        i
-000160f0: 6620 706f 7369 7469 6f6e 2069 7320 6e6f  f position is no
-00016100: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
-00016110: 6c73 6520 6275 696c 7469 6e28 2263 6861  lse builtin("cha
-00016120: 7269 6e64 6578 2229 2874 2c20 7329 0a20  rindex")(t, s). 
-00016130: 2020 2029 0a0a 0a64 6566 2063 6f6c 6c61     )...def colla
-00016140: 7465 2865 3a20 436f 6c75 6d6e 2c20 636f  te(e: Column, co
-00016150: 6c6c 6174 696f 6e5f 7370 6563 3a20 7374  llation_spec: st
-00016160: 7229 202d 3e20 436f 6c75 6d6e 3a0a 2020  r) -> Column:.  
-00016170: 2020 2222 2252 6574 7572 6e73 2061 2063    """Returns a c
-00016180: 6f70 7920 6f66 2074 6865 206f 7269 6769  opy of the origi
-00016190: 6e61 6c20 3a63 6c61 7373 3a60 436f 6c75  nal :class:`Colu
-000161a0: 6d6e 6020 7769 7468 2074 6865 2073 7065  mn` with the spe
-000161b0: 6369 6669 6564 2060 6063 6f6c 6c61 7469  cified ``collati
-000161c0: 6f6e 5f73 7065 6360 600a 2020 2020 7072  on_spec``.    pr
-000161d0: 6f70 6572 7479 2c20 7261 7468 6572 2074  operty, rather t
-000161e0: 6861 6e20 7468 6520 6f72 6967 696e 616c  han the original
-000161f0: 2063 6f6c 6c61 7469 6f6e 2073 7065 6369   collation speci
-00016200: 6669 6361 7469 6f6e 2070 726f 7065 7274  fication propert
-00016210: 792e 0a0a 2020 2020 466f 7220 6465 7461  y...    For deta
-00016220: 696c 732c 2073 6565 2074 6865 2053 6e6f  ils, see the Sno
-00016230: 7766 6c61 6b65 2064 6f63 756d 656e 7461  wflake documenta
-00016240: 7469 6f6e 206f 6e0a 2020 2020 6063 6f6c  tion on.    `col
-00016250: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
-00016260: 7469 6f6e 7320 3c68 7474 7073 3a2f 2f64  tions <https://d
-00016270: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
-00016280: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
-00016290: 6365 2f63 6f6c 6c61 7469 6f6e 2e68 746d  ce/collation.htm
-000162a0: 6c23 6c61 6265 6c2d 636f 6c6c 6174 696f  l#label-collatio
-000162b0: 6e2d 7370 6563 6966 6963 6174 696f 6e3e  n-specification>
-000162c0: 605f 2e0a 0a20 2020 2045 7861 6d70 6c65  `_...    Example
-000162d0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-000162e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000162f0: 7465 5f64 6174 6166 7261 6d65 285b 27c3  te_dataframe(['.
-00016300: b127 5d2c 2073 6368 656d 613d 5b27 7627  .'], schema=['v'
-00016310: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00016320: 662e 7365 6c65 6374 2864 662e 7620 3d3d  f.select(df.v ==
-00016330: 206c 6974 2827 c391 2729 2c20 636f 6c6c   lit('..'), coll
-00016340: 6174 6528 6466 2e76 2c20 2773 702d 7570  ate(df.v, 'sp-up
-00016350: 7065 7227 2920 3d3d 206c 6974 2827 c391  per') == lit('..
-00016360: 2729 292e 7368 6f77 2829 0a20 2020 2020  ')).show().     
-00016370: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00016380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000163a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000163b0: 2020 2020 2020 7c22 2822 2256 2222 203d        |"(""V"" =
-000163c0: 2027 c391 2729 2220 207c 2228 434f 4c4c   '..')"  |"(COLL
-000163d0: 4154 4528 2222 5622 222c 2027 5350 2d55  ATE(""V"", 'SP-U
-000163e0: 5050 4552 2729 203d 2027 c391 2729 2220  PPER') = '..')" 
-000163f0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00016400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016430: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c46  -----.        |F
-00016440: 616c 7365 2020 2020 2020 2020 2020 2020  alse            
-00016450: 7c54 7275 6520 2020 2020 2020 2020 2020  |True           
-00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016470: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00016480: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00016490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000164a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000164b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000164c0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-000164d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-000164e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-000164f0: 2c20 2263 6f6c 6c61 7465 2229 0a20 2020  , "collate").   
-00016500: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00016510: 2263 6f6c 6c61 7465 2229 2863 2c20 636f  "collate")(c, co
-00016520: 6c6c 6174 696f 6e5f 7370 6563 290a 0a0a  llation_spec)...
-00016530: 6465 6620 636f 6c6c 6174 696f 6e28 653a  def collation(e:
-00016540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00016550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00016560: 2252 6574 7572 6e73 2074 6865 2063 6f6c  "Returns the col
-00016570: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
-00016580: 7469 6f6e 206f 6620 6578 7072 2e0a 0a20  tion of expr... 
-00016590: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-000165a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000165b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000165c0: 6166 7261 6d65 285b 27c3 b127 5d2c 2073  aframe(['..'], s
-000165d0: 6368 656d 613d 5b27 7627 5d29 0a20 2020  chema=['v']).   
-000165e0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-000165f0: 6374 2863 6f6c 6c61 7469 6f6e 2863 6f6c  ct(collation(col
-00016600: 6c61 7465 2864 662e 762c 2027 7370 2d75  late(df.v, 'sp-u
-00016610: 7070 6572 2729 2929 2e73 686f 7728 290a  pper'))).show().
-00016620: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016650: 2d2d 2d0a 2020 2020 2020 2020 7c22 434f  ---.        |"CO
-00016660: 4c4c 4154 494f 4e28 434f 4c4c 4154 4528  LLATION(COLLATE(
-00016670: 2222 5622 222c 2027 5350 2d55 5050 4552  ""V"", 'SP-UPPER
-00016680: 2729 2922 2020 7c0a 2020 2020 2020 2020  '))"  |.        
-00016690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000166a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000166b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000166c0: 2020 2020 7c73 702d 7570 7065 7220 2020      |sp-upper   
-000166d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166e0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-000166f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016720: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00016730: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00016740: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00016750: 6966 5f73 7472 2865 2c20 2263 6f6c 6c61  if_str(e, "colla
-00016760: 7469 6f6e 2229 0a20 2020 2072 6574 7572  tion").    retur
-00016770: 6e20 6275 696c 7469 6e28 2263 6f6c 6c61  n builtin("colla
-00016780: 7469 6f6e 2229 2863 290a 0a0a 6465 6620  tion")(c)...def 
-00016790: 636f 6e63 6174 282a 636f 6c73 3a20 436f  concat(*cols: Co
-000167a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-000167b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
-000167c0: 6e63 6174 656e 6174 6573 206f 6e65 206f  ncatenates one o
-000167d0: 7220 6d6f 7265 2073 7472 696e 6773 2c20  r more strings, 
-000167e0: 6f72 2063 6f6e 6361 7465 6e61 7465 7320  or concatenates 
-000167f0: 6f6e 6520 6f72 206d 6f72 6520 6269 6e61  one or more bina
-00016800: 7279 2076 616c 7565 732e 2049 6620 616e  ry values. If an
-00016810: 7920 6f66 2074 6865 2076 616c 7565 7320  y of the values 
-00016820: 6973 206e 756c 6c2c 2074 6865 2072 6573  is null, the res
-00016830: 756c 7420 6973 2061 6c73 6f20 6e75 6c6c  ult is also null
-00016840: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00016850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00016860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00016870: 5f64 6174 6166 7261 6d65 285b 5b27 4865  _dataframe([['He
-00016880: 6c6c 6f27 2c20 2757 6f72 6c64 275d 5d2c  llo', 'World']],
-00016890: 2073 6368 656d 613d 5b27 6127 2c20 2762   schema=['a', 'b
-000168a0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-000168b0: 6466 2e73 656c 6563 7428 636f 6e63 6174  df.select(concat
-000168c0: 2864 662e 612c 2064 662e 6229 292e 7368  (df.a, df.b)).sh
-000168d0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-000168e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000168f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00016900: 7c22 434f 4e43 4154 2822 2241 2222 2c20  |"CONCAT(""A"", 
-00016910: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
-00016920: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00016930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00016940: 2020 2020 2020 7c48 656c 6c6f 576f 726c        |HelloWorl
-00016950: 6420 2020 2020 2020 2020 2020 2020 207c  d              |
-00016960: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00016970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016980: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00016990: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-000169a0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
-000169b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-000169c0: 2c20 2263 6f6e 6361 7422 2920 666f 7220  , "concat") for 
-000169d0: 6320 696e 2063 6f6c 735d 0a20 2020 2072  c in cols].    r
-000169e0: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
-000169f0: 6f6e 6361 7422 2928 2a63 6f6c 756d 6e73  oncat")(*columns
-00016a00: 290a 0a0a 6465 6620 636f 6e63 6174 5f77  )...def concat_w
-00016a10: 7328 2a63 6f6c 733a 2043 6f6c 756d 6e4f  s(*cols: ColumnO
-00016a20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00016a30: 3a0a 2020 2020 2222 2243 6f6e 6361 7465  :.    """Concate
-00016a40: 6e61 7465 7320 7477 6f20 6f72 206d 6f72  nates two or mor
-00016a50: 6520 7374 7269 6e67 732c 206f 7220 636f  e strings, or co
-00016a60: 6e63 6174 656e 6174 6573 2074 776f 206f  ncatenates two o
-00016a70: 7220 6d6f 7265 2062 696e 6172 7920 7661  r more binary va
-00016a80: 6c75 6573 2e20 4966 2061 6e79 206f 6620  lues. If any of 
-00016a90: 7468 6520 7661 6c75 6573 2069 7320 6e75  the values is nu
-00016aa0: 6c6c 2c20 7468 6520 7265 7375 6c74 2069  ll, the result i
-00016ab0: 7320 616c 736f 206e 756c 6c2e 0a20 2020  s also null..   
-00016ac0: 2054 6865 2043 4f4e 4341 545f 5753 206f   The CONCAT_WS o
-00016ad0: 7065 7261 746f 7220 7265 7175 6972 6573  perator requires
-00016ae0: 2061 7420 6c65 6173 7420 7477 6f20 6172   at least two ar
-00016af0: 6775 6d65 6e74 732c 2061 6e64 2075 7365  guments, and use
-00016b00: 7320 7468 6520 6669 7273 7420 6172 6775  s the first argu
-00016b10: 6d65 6e74 2074 6f20 7365 7061 7261 7465  ment to separate
-00016b20: 2061 6c6c 2066 6f6c 6c6f 7769 6e67 2061   all following a
-00016b30: 7267 756d 656e 7473 2e0a 0a20 2020 2045  rguments...    E
-00016b40: 7861 6d70 6c65 733a 3a0a 2020 2020 2020  xamples::.      
-00016b50: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00016b60: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-00016b70: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
-00016b80: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
-00016b90: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00016ba0: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
-00016bb0: 4865 6c6c 6f27 2c20 2757 6f72 6c64 275d  Hello', 'World']
-00016bc0: 5d2c 2073 6368 656d 613d 5b27 6127 2c20  ], schema=['a', 
-00016bd0: 2762 275d 290a 2020 2020 2020 2020 3e3e  'b']).        >>
-00016be0: 3e20 6466 2e73 656c 6563 7428 636f 6e63  > df.select(conc
-00016bf0: 6174 5f77 7328 6c69 7428 272c 2729 2c20  at_ws(lit(','), 
-00016c00: 6466 2e61 2c20 6466 2e62 2929 2e73 686f  df.a, df.b)).sho
-00016c10: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0000aa80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000aa90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000aaa0: 2253 5452 5322 2020 7c22 4b45 5922 2020  "STRS"  |"KEY"  
+0000aab0: 2020 2020 2020 7c22 5641 4c55 4522 2020        |"VALUE"  
+0000aac0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0000aad0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0000aae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000aaf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000ab00: 2020 207c 436f 6666 6565 2020 7c53 616e     |Coffee  |San
+0000ab10: 6b61 6b75 2020 2020 2020 7c22 5472 6961  kaku      |"Tria
+0000ab20: 6e67 6c65 2220 2020 2020 207c 0a20 2020  ngle"      |.   
+0000ab30: 2020 2020 207c 4b69 6d75 7261 2020 7c41       |Kimura  |A
+0000ab40: 7368 6920 4761 7261 6d69 2020 7c22 5369  shi Garami  |"Si
+0000ab50: 6e67 6c65 204c 6567 2058 2220 207c 0a20  ngle Leg X"  |. 
+0000ab60: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000ab70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ab80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ab90: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0000aba0: 494e 453e 0a0a 2020 2020 2020 2020 3e3e  INE>..        >>
+0000abb0: 3e20 6466 2e73 656c 6563 7428 6578 706c  > df.select(expl
+0000abc0: 6f64 6528 636f 6c28 226c 6973 7473 2229  ode(col("lists")
+0000abd0: 292e 616c 6961 7328 2275 6e6f 2229 292e  ).alias("uno")).
+0000abe0: 736f 7274 2863 6f6c 2822 756e 6f22 2929  sort(col("uno"))
+0000abf0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0000ac00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000ac10: 2020 7c22 554e 4f22 2020 7c0a 2020 2020    |"UNO"  |.    
+0000ac20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a 2020      ---------.  
+0000ac30: 2020 2020 2020 7c31 2020 2020 2020 7c0a        |1      |.
+0000ac40: 2020 2020 2020 2020 7c32 2020 2020 2020          |2      
+0000ac50: 7c0a 2020 2020 2020 2020 7c33 2020 2020  |.        |3    
+0000ac60: 2020 7c0a 2020 2020 2020 2020 7c31 3120    |.        |11 
+0000ac70: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
+0000ac80: 3220 2020 2020 7c0a 2020 2020 2020 2020  2     |.        
+0000ac90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000aca0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20    <BLANKLINE>.. 
+0000acb0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000acc0: 6c65 6374 2865 7870 6c6f 6465 2827 6d61  lect(explode('ma
+0000acd0: 7073 2729 2e61 735f 2822 7072 696d 6f22  ps').as_("primo"
+0000ace0: 2c20 2273 6563 756e 646f 2229 292e 736f  , "secundo")).so
+0000acf0: 7274 2863 6f6c 2822 7072 696d 6f22 2929  rt(col("primo"))
+0000ad00: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0000ad10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ad20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ad30: 0a20 2020 2020 2020 207c 2250 5249 4d4f  .        |"PRIMO
+0000ad40: 2220 2020 2020 207c 2253 4543 554e 444f  "      |"SECUNDO
+0000ad50: 2220 2020 2020 2020 7c0a 2020 2020 2020  "       |.      
+0000ad60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0000ad70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ad80: 2d2d 0a20 2020 2020 2020 207c 4173 6869  --.        |Ashi
+0000ad90: 2047 6172 616d 6920 207c 2253 696e 676c   Garami  |"Singl
+0000ada0: 6520 4c65 6720 5822 2020 7c0a 2020 2020  e Leg X"  |.    
+0000adb0: 2020 2020 7c53 616e 6b61 6b75 2020 2020      |Sankaku    
+0000adc0: 2020 7c22 5472 6961 6e67 6c65 2220 2020    |"Triangle"   
+0000add0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0000ade0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000adf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0000ae00: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+0000ae10: 3e0a 2020 2020 2222 220a 2020 2020 636f  >.    """.    co
+0000ae20: 6c20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  l = _to_col_if_s
+0000ae30: 7472 2863 6f6c 2c20 2265 7870 6c6f 6465  tr(col, "explode
+0000ae40: 2229 0a20 2020 2066 756e 635f 6361 6c6c  ").    func_call
+0000ae50: 203d 205f 4578 706c 6f64 6546 756e 6374   = _ExplodeFunct
+0000ae60: 696f 6e43 616c 6c28 636f 6c2c 206c 6974  ionCall(col, lit
+0000ae70: 2846 616c 7365 2929 0a20 2020 2066 756e  (False)).    fun
+0000ae80: 635f 6361 6c6c 2e5f 7365 745f 6170 695f  c_call._set_api_
+0000ae90: 6361 6c6c 5f73 6f75 7263 6528 2266 756e  call_source("fun
+0000aea0: 6374 696f 6e73 2e65 7870 6c6f 6465 2229  ctions.explode")
+0000aeb0: 0a20 2020 2072 6574 7572 6e20 6675 6e63  .    return func
+0000aec0: 5f63 616c 6c0a 0a0a 6465 6620 6578 706c  _call...def expl
+0000aed0: 6f64 655f 6f75 7465 7228 636f 6c3a 2043  ode_outer(col: C
+0000aee0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0000aef0: 5461 626c 6546 756e 6374 696f 6e43 616c  TableFunctionCal
+0000af00: 6c3a 0a20 2020 2022 2222 466c 6174 7465  l:.    """Flatte
+0000af10: 6e73 2061 2067 6976 656e 2061 7272 6179  ns a given array
+0000af20: 206f 7220 6d61 7020 7479 7065 2063 6f6c   or map type col
+0000af30: 756d 6e20 696e 746f 2069 6e64 6976 6964  umn into individ
+0000af40: 7561 6c20 726f 7773 2e20 556e 6c69 6b65  ual rows. Unlike
+0000af50: 203a 6675 6e63 3a60 6578 706c 6f64 6560   :func:`explode`
+0000af60: 2c0a 2020 2020 6966 2061 7272 6179 206f  ,.    if array o
+0000af70: 7220 6d61 7020 6973 2065 6d70 7479 2c20  r map is empty, 
+0000af80: 6e75 6c6c 206f 7220 656d 7074 792c 2074  null or empty, t
+0000af90: 6865 6e20 6e75 6c6c 2076 616c 7565 7320  hen null values 
+0000afa0: 6172 6520 7072 6f64 7563 6564 2e20 5468  are produced. Th
+0000afb0: 6520 6465 6661 756c 7420 636f 6c75 6d6e  e default column
+0000afc0: 0a20 2020 206e 616d 6520 666f 7220 7468  .    name for th
+0000afd0: 6520 6f75 7470 7574 2063 6f6c 756d 6e20  e output column 
+0000afe0: 696e 2063 6173 6520 6f66 2061 7272 6179  in case of array
+0000aff0: 2069 6e70 7574 2063 6f6c 756d 6e20 6973   input column is
+0000b000: 2060 6056 414c 5545 6060 2c20 616e 6420   ``VALUE``, and 
+0000b010: 6973 2060 604b 4559 6060 2061 6e64 0a20  is ``KEY`` and. 
+0000b020: 2020 2060 6056 414c 5545 6060 2069 6e20     ``VALUE`` in 
+0000b030: 6361 7365 206f 6620 6d61 7020 696e 7075  case of map inpu
+0000b040: 7420 636f 6c75 6d6e 2e0a 0a20 2020 2041  t column...    A
+0000b050: 7267 733a 0a20 2020 2020 2020 2063 6f6c  rgs:.        col
+0000b060: 3a20 436f 6c75 6d6e 206f 626a 6563 7420  : Column object 
+0000b070: 6f72 2073 7472 696e 6720 6e61 6d65 206f  or string name o
+0000b080: 6620 7468 6520 6465 7369 7265 6420 636f  f the desired co
+0000b090: 6c75 6d6e 0a0a 2020 2020 4578 616d 706c  lumn..    Exampl
+0000b0a0: 6573 3a3a 0a20 2020 2020 2020 203e 3e3e  es::.        >>>
+0000b0b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0000b0c0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0000b0d0: 5b31 2c20 5b31 2c20 322c 2033 5d2c 207b  [1, [1, 2, 3], {
+0000b0e0: 2241 7368 6920 4761 7261 6d69 223a 2022  "Ashi Garami": "
+0000b0f0: 5369 6e67 6c65 204c 6567 2058 227d 5d2c  Single Leg X"}],
+0000b100: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b120: 2020 2020 2020 2020 2020 2020 5b32 2c20              [2, 
+0000b130: 5b31 312c 2032 325d 2c20 7b22 5361 6e6b  [11, 22], {"Sank
+0000b140: 616b 7522 3a20 2254 7269 616e 676c 6522  aku": "Triangle"
+0000b150: 7d5d 2c0a 2020 2020 2020 2020 2e2e 2e20  }],.        ... 
+0000b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b170: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0000b180: 332c 205b 5d2c 207b 7d5d 5d2c 0a20 2020  3, [], {}]],.   
+0000b190: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0000b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1b0: 2020 2020 2020 2020 7363 6865 6d61 3d5b          schema=[
+0000b1c0: 2269 6478 222c 2022 6c69 7374 7322 2c20  "idx", "lists", 
+0000b1d0: 226d 6170 7322 5d29 0a20 2020 2020 2020  "maps"]).       
+0000b1e0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+0000b1f0: 662e 6964 782c 2065 7870 6c6f 6465 5f6f  f.idx, explode_o
+0000b200: 7574 6572 2864 662e 6c69 7374 7329 292e  uter(df.lists)).
+0000b210: 736f 7274 2863 6f6c 2822 6964 7822 2929  sort(col("idx"))
+0000b220: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0000b230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b240: 2d2d 2d0a 2020 2020 2020 2020 7c22 4944  ---.        |"ID
+0000b250: 5822 2020 7c22 5641 4c55 4522 2020 7c0a  X"  |"VALUE"  |.
+0000b260: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000b270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000b280: 2020 2020 7c31 2020 2020 2020 7c31 2020      |1      |1  
+0000b290: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000b2a0: 7c31 2020 2020 2020 7c32 2020 2020 2020  |1      |2      
+0000b2b0: 2020 7c0a 2020 2020 2020 2020 7c31 2020    |.        |1  
+0000b2c0: 2020 2020 7c33 2020 2020 2020 2020 7c0a      |3        |.
+0000b2d0: 2020 2020 2020 2020 7c32 2020 2020 2020          |2      
+0000b2e0: 7c31 3120 2020 2020 2020 7c0a 2020 2020  |11       |.    
+0000b2f0: 2020 2020 7c32 2020 2020 2020 7c32 3220      |2      |22 
+0000b300: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000b310: 7c33 2020 2020 2020 7c4e 554c 4c20 2020  |3      |NULL   
+0000b320: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000b330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0000b340: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0000b350: 4e45 3e0a 0a20 2020 2020 2020 203e 3e3e  NE>..        >>>
+0000b360: 2064 662e 7365 6c65 6374 2864 662e 6964   df.select(df.id
+0000b370: 782c 2065 7870 6c6f 6465 5f6f 7574 6572  x, explode_outer
+0000b380: 2864 662e 6d61 7073 2929 2e73 6f72 7428  (df.maps)).sort(
+0000b390: 636f 6c28 2269 6478 2229 292e 7368 6f77  col("idx")).show
+0000b3a0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0000b3b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b3c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b3d0: 2d2d 2d0a 2020 2020 2020 2020 7c22 4944  ---.        |"ID
+0000b3e0: 5822 2020 7c22 4b45 5922 2020 2020 2020  X"  |"KEY"      
+0000b3f0: 2020 7c22 5641 4c55 4522 2020 2020 2020    |"VALUE"      
+0000b400: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0000b410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b430: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+0000b440: 2020 2020 2020 7c41 7368 6920 4761 7261        |Ashi Gara
+0000b450: 6d69 2020 7c22 5369 6e67 6c65 204c 6567  mi  |"Single Leg
+0000b460: 2058 2220 207c 0a20 2020 2020 2020 207c   X"  |.        |
+0000b470: 3220 2020 2020 207c 5361 6e6b 616b 7520  2      |Sankaku 
+0000b480: 2020 2020 207c 2254 7269 616e 676c 6522       |"Triangle"
+0000b490: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000b4a0: 7c33 2020 2020 2020 7c4e 554c 4c20 2020  |3      |NULL   
+0000b4b0: 2020 2020 2020 7c4e 554c 4c20 2020 2020        |NULL     
+0000b4c0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0000b4d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0000b4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b4f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000b500: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20    <BLANKLINE>.. 
+0000b510: 2020 2053 6565 2041 6c73 6f3a 0a20 2020     See Also:.   
+0000b520: 2020 2020 203a 6675 6e63 3a60 6578 706c       :func:`expl
+0000b530: 6f64 6560 0a20 2020 2022 2222 0a20 2020  ode`.    """.   
+0000b540: 2063 6f6c 203d 205f 746f 5f63 6f6c 5f69   col = _to_col_i
+0000b550: 665f 7374 7228 636f 6c2c 2022 6578 706c  f_str(col, "expl
+0000b560: 6f64 655f 6f75 7465 7222 290a 2020 2020  ode_outer").    
+0000b570: 6675 6e63 5f63 616c 6c20 3d20 5f45 7870  func_call = _Exp
+0000b580: 6c6f 6465 4675 6e63 7469 6f6e 4361 6c6c  lodeFunctionCall
+0000b590: 2863 6f6c 2c20 6c69 7428 5472 7565 2929  (col, lit(True))
+0000b5a0: 0a20 2020 2066 756e 635f 6361 6c6c 2e5f  .    func_call._
+0000b5b0: 7365 745f 6170 695f 6361 6c6c 5f73 6f75  set_api_call_sou
+0000b5c0: 7263 6528 2266 756e 6374 696f 6e73 2e65  rce("functions.e
+0000b5d0: 7870 6c6f 6465 5f6f 7574 6572 2229 0a20  xplode_outer"). 
+0000b5e0: 2020 2072 6574 7572 6e20 6675 6e63 5f63     return func_c
+0000b5f0: 616c 6c0a 0a0a 6465 6620 6772 6f75 7069  all...def groupi
+0000b600: 6e67 282a 636f 6c73 3a20 436f 6c75 6d6e  ng(*cols: Column
+0000b610: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0000b620: 6e3a 0a20 2020 2022 2222 0a20 2020 2044  n:.    """.    D
+0000b630: 6573 6372 6962 6573 2077 6869 6368 206f  escribes which o
+0000b640: 6620 6120 6c69 7374 206f 6620 6578 7072  f a list of expr
+0000b650: 6573 7369 6f6e 7320 6172 6520 6772 6f75  essions are grou
+0000b660: 7065 6420 696e 2061 2072 6f77 2070 726f  ped in a row pro
+0000b670: 6475 6365 6420 6279 2061 2047 524f 5550  duced by a GROUP
+0000b680: 2042 5920 7175 6572 792e 0a0a 2020 2020   BY query...    
+0000b690: 3a66 756e 633a 6067 726f 7570 696e 675f  :func:`grouping_
+0000b6a0: 6964 6020 6973 2061 6e20 616c 6961 7320  id` is an alias 
+0000b6b0: 6f66 203a 6675 6e63 3a60 6772 6f75 7069  of :func:`groupi
+0000b6c0: 6e67 602e 0a0a 2020 2020 4578 616d 706c  ng`...    Exampl
+0000b6d0: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0000b6e0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000b6f0: 6e6f 7770 6172 6b20 696d 706f 7274 2047  nowpark import G
+0000b700: 726f 7570 696e 6753 6574 730a 2020 2020  roupingSets.    
+0000b710: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000b720: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0000b730: 6672 616d 6528 5b5b 312c 2032 2c20 335d  frame([[1, 2, 3]
+0000b740: 2c20 5b34 2c20 352c 2036 5d5d 2c73 6368  , [4, 5, 6]],sch
+0000b750: 656d 613d 5b22 6122 2c20 2262 222c 2022  ema=["a", "b", "
+0000b760: 6322 5d29 0a20 2020 2020 2020 203e 3e3e  c"]).        >>>
+0000b770: 2067 726f 7570 696e 675f 7365 7473 203d   grouping_sets =
+0000b780: 2047 726f 7570 696e 6753 6574 7328 5b63   GroupingSets([c
+0000b790: 6f6c 2822 6122 295d 2c20 5b63 6f6c 2822  ol("a")], [col("
+0000b7a0: 6222 295d 2c20 5b63 6f6c 2822 6122 292c  b")], [col("a"),
+0000b7b0: 2063 6f6c 2822 6222 295d 290a 2020 2020   col("b")]).    
+0000b7c0: 2020 2020 3e3e 3e20 6466 2e67 726f 7570      >>> df.group
+0000b7d0: 5f62 795f 6772 6f75 7069 6e67 5f73 6574  _by_grouping_set
+0000b7e0: 7328 6772 6f75 7069 6e67 5f73 6574 7329  s(grouping_sets)
+0000b7f0: 2e61 6767 285b 636f 756e 7428 2263 2229  .agg([count("c")
+0000b800: 2c20 6772 6f75 7069 6e67 2822 6122 292c  , grouping("a"),
+0000b810: 2067 726f 7570 696e 6728 2262 2229 2c20   grouping("b"), 
+0000b820: 6772 6f75 7069 6e67 2822 6122 2c20 2262  grouping("a", "b
+0000b830: 2229 5d29 2e63 6f6c 6c65 6374 2829 0a20  ")]).collect(). 
+0000b840: 2020 2020 2020 205b 526f 7728 413d 312c         [Row(A=1,
+0000b850: 2042 3d32 2c20 434f 554e 5428 4329 3d31   B=2, COUNT(C)=1
+0000b860: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
+0000b870: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
+0000b880: 4752 4f55 5049 4e47 2841 2c20 4229 3d30  GROUPING(A, B)=0
+0000b890: 292c 205c 0a52 6f77 2841 3d34 2c20 423d  ), \.Row(A=4, B=
+0000b8a0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
+0000b8b0: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b8c0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000b8d0: 5550 494e 4728 412c 2042 293d 3029 2c20  UPING(A, B)=0), 
+0000b8e0: 5c0a 526f 7728 413d 312c 2042 3d4e 6f6e  \.Row(A=1, B=Non
+0000b8f0: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
+0000b900: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b910: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
+0000b920: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
+0000b930: 5c0a 526f 7728 413d 342c 2042 3d4e 6f6e  \.Row(A=4, B=Non
+0000b940: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
+0000b950: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b960: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
+0000b970: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
+0000b980: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
+0000b990: 322c 2043 4f55 4e54 2843 293d 312c 2047  2, COUNT(C)=1, G
+0000b9a0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
+0000b9b0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000b9c0: 5550 494e 4728 412c 2042 293d 3229 2c20  UPING(A, B)=2), 
+0000b9d0: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
+0000b9e0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
+0000b9f0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
+0000ba00: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000ba10: 5550 494e 4728 412c 2042 293d 3229 5d0a  UPING(A, B)=2)].
+0000ba20: 2020 2020 2222 220a 2020 2020 636f 6c75      """.    colu
+0000ba30: 6d6e 7320 3d20 5b5f 746f 5f63 6f6c 5f69  mns = [_to_col_i
+0000ba40: 665f 7374 7228 632c 2022 6772 6f75 7069  f_str(c, "groupi
+0000ba50: 6e67 2229 2066 6f72 2063 2069 6e20 636f  ng") for c in co
+0000ba60: 6c73 5d0a 2020 2020 7265 7475 726e 2062  ls].    return b
+0000ba70: 7569 6c74 696e 2822 6772 6f75 7069 6e67  uiltin("grouping
+0000ba80: 2229 282a 636f 6c75 6d6e 7329 0a0a 0a67  ")(*columns)...g
+0000ba90: 726f 7570 696e 675f 6964 203d 2067 726f  rouping_id = gro
+0000baa0: 7570 696e 670a 0a0a 6465 6620 636f 616c  uping...def coal
+0000bab0: 6573 6365 282a 653a 2043 6f6c 756d 6e4f  esce(*e: ColumnO
+0000bac0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000bad0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0000bae0: 2074 6865 2066 6972 7374 206e 6f6e 2d4e   the first non-N
+0000baf0: 554c 4c20 6578 7072 6573 7369 6f6e 2061  ULL expression a
+0000bb00: 6d6f 6e67 2069 7473 2061 7267 756d 656e  mong its argumen
+0000bb10: 7473 2c20 6f72 204e 554c 4c20 6966 2061  ts, or NULL if a
+0000bb20: 6c6c 2069 7473 0a20 2020 2061 7267 756d  ll its.    argum
+0000bb30: 656e 7473 2061 7265 204e 554c 4c2e 0a0a  ents are NULL...
+0000bb40: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0000bb50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000bb60: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0000bb70: 6174 6166 7261 6d65 285b 5b31 2c20 322c  ataframe([[1, 2,
+0000bb80: 2033 5d2c 205b 4e6f 6e65 2c20 322c 2033   3], [None, 2, 3
+0000bb90: 5d2c 205b 4e6f 6e65 2c20 4e6f 6e65 2c20  ], [None, None, 
+0000bba0: 335d 2c20 5b4e 6f6e 652c 204e 6f6e 652c  3], [None, None,
+0000bbb0: 204e 6f6e 655d 5d2c 2073 6368 656d 613d   None]], schema=
+0000bbc0: 5b27 6127 2c20 2762 272c 2027 6327 5d29  ['a', 'b', 'c'])
+0000bbd0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000bbe0: 7365 6c65 6374 2864 662e 612c 2064 662e  select(df.a, df.
+0000bbf0: 622c 2064 662e 632c 2063 6f61 6c65 7363  b, df.c, coalesc
+0000bc00: 6528 6466 2e61 2c20 6466 2e62 2c20 6466  e(df.a, df.b, df
+0000bc10: 2e63 292e 6173 5f28 2243 4f41 4c45 5343  .c).as_("COALESC
+0000bc20: 4522 2929 2e73 686f 7728 290a 2020 2020  E")).show().    
+0000bc30: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000bc40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000bc50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000bc60: 7c22 4122 2020 207c 2242 2220 2020 7c22  |"A"   |"B"   |"
+0000bc70: 4322 2020 207c 2243 4f41 4c45 5343 4522  C"   |"COALESCE"
+0000bc80: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000bc90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000bca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0000bcb0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
+0000bcc0: 3220 2020 2020 7c33 2020 2020 207c 3120  2     |3     |1 
+0000bcd0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0000bce0: 2020 2020 7c4e 554c 4c20 207c 3220 2020      |NULL  |2   
+0000bcf0: 2020 7c33 2020 2020 207c 3220 2020 2020    |3     |2     
+0000bd00: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000bd10: 7c4e 554c 4c20 207c 4e55 4c4c 2020 7c33  |NULL  |NULL  |3
+0000bd20: 2020 2020 207c 3320 2020 2020 2020 2020       |3         
+0000bd30: 2020 7c0a 2020 2020 2020 2020 7c4e 554c    |.        |NUL
+0000bd40: 4c20 207c 4e55 4c4c 2020 7c4e 554c 4c20  L  |NULL  |NULL 
+0000bd50: 207c 4e55 4c4c 2020 2020 2020 2020 7c0a   |NULL        |.
+0000bd60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000bd70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000bd80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000bd90: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0000bda0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000bdb0: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
+0000bdc0: 6578 2c20 2263 6f61 6c65 7363 6522 2920  ex, "coalesce") 
+0000bdd0: 666f 7220 6578 2069 6e20 655d 0a20 2020  for ex in e].   
+0000bde0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0000bdf0: 2263 6f61 6c65 7363 6522 2928 2a63 290a  "coalesce")(*c).
+0000be00: 0a0a 6465 6620 6571 7561 6c5f 6e61 6e28  ..def equal_nan(
+0000be10: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0000be20: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000be30: 2222 220a 2020 2020 5265 7475 726e 2074  """.    Return t
+0000be40: 7275 6520 6966 2074 6865 2076 616c 7565  rue if the value
+0000be50: 2069 6e20 7468 6520 636f 6c75 6d6e 2069   in the column i
+0000be60: 7320 6e6f 7420 6120 6e75 6d62 6572 2028  s not a number (
+0000be70: 4e61 4e29 2e0a 0a20 2020 2045 7861 6d70  NaN)...    Examp
+0000be80: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0000be90: 3e20 696d 706f 7274 206d 6174 680a 2020  > import math.  
+0000bea0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000beb0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000bec0: 7461 6672 616d 6528 5b31 2e31 2c20 6d61  taframe([1.1, ma
+0000bed0: 7468 2e6e 616e 2c20 322e 335d 2c20 7363  th.nan, 2.3], sc
+0000bee0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0000bef0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0000bf00: 7428 6571 7561 6c5f 6e61 6e28 6466 5b22  t(equal_nan(df["
+0000bf10: 6122 5d29 2e61 6c69 6173 2822 6571 7561  a"]).alias("equa
+0000bf20: 6c5f 6e61 6e22 2929 2e63 6f6c 6c65 6374  l_nan")).collect
+0000bf30: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0000bf40: 4551 5541 4c5f 4e41 4e3d 4661 6c73 6529  EQUAL_NAN=False)
+0000bf50: 2c20 526f 7728 4551 5541 4c5f 4e41 4e3d  , Row(EQUAL_NAN=
+0000bf60: 5472 7565 292c 2052 6f77 2845 5155 414c  True), Row(EQUAL
+0000bf70: 5f4e 414e 3d46 616c 7365 295d 0a20 2020  _NAN=False)].   
+0000bf80: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0000bf90: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+0000bfa0: 6571 7561 6c5f 6e61 6e22 290a 2020 2020  equal_nan").    
+0000bfb0: 7265 7475 726e 2063 2e65 7175 616c 5f6e  return c.equal_n
+0000bfc0: 616e 2829 0a0a 0a64 6566 2069 735f 6e75  an()...def is_nu
+0000bfd0: 6c6c 2865 3a20 436f 6c75 6d6e 4f72 4e61  ll(e: ColumnOrNa
+0000bfe0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000bff0: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+0000c000: 6e20 7472 7565 2069 6620 7468 6520 7661  n true if the va
+0000c010: 6c75 6520 696e 2074 6865 2063 6f6c 756d  lue in the colum
+0000c020: 6e20 6973 206e 756c 6c2e 0a0a 2020 2020  n is null...    
+0000c030: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000c040: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0000c050: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0000c060: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0000c070: 6973 5f6e 756c 6c0a 2020 2020 2020 2020  is_null.        
+0000c080: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0000c090: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0000c0a0: 6528 5b31 2e32 2c20 666c 6f61 7428 226e  e([1.2, float("n
+0000c0b0: 616e 2229 2c20 4e6f 6e65 2c20 312e 305d  an"), None, 1.0]
+0000c0c0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0000c0d0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000c0e0: 656c 6563 7428 6973 5f6e 756c 6c28 2261  elect(is_null("a
+0000c0f0: 2229 2e61 735f 2822 6122 2929 2e63 6f6c  ").as_("a")).col
+0000c100: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0000c110: 526f 7728 413d 4661 6c73 6529 2c20 526f  Row(A=False), Ro
+0000c120: 7728 413d 4661 6c73 6529 2c20 526f 7728  w(A=False), Row(
+0000c130: 413d 5472 7565 292c 2052 6f77 2841 3d46  A=True), Row(A=F
+0000c140: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
+0000c150: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000c160: 665f 7374 7228 652c 2022 6973 5f6e 756c  f_str(e, "is_nul
+0000c170: 6c22 290a 2020 2020 7265 7475 726e 2063  l").    return c
+0000c180: 2e69 735f 6e75 6c6c 2829 0a0a 0a64 6566  .is_null()...def
+0000c190: 206e 6567 6174 6528 653a 2043 6f6c 756d   negate(e: Colum
+0000c1a0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0000c1b0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0000c1c0: 6e73 2074 6865 206e 6567 6174 696f 6e20  ns the negation 
+0000c1d0: 6f66 2074 6865 2076 616c 7565 2069 6e20  of the value in 
+0000c1e0: 7468 6520 636f 6c75 6d6e 2028 6571 7569  the column (equi
+0000c1f0: 7661 6c65 6e74 2074 6f20 6120 756e 6172  valent to a unar
+0000c200: 7920 6d69 6e75 7329 2e0a 0a20 2020 2045  y minus)...    E
+0000c210: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0000c220: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000c230: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000c240: 616d 6528 5b5b 315d 5d2c 2073 6368 656d  ame([[1]], schem
+0000c250: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+0000c260: 203e 3e3e 2064 662e 7365 6c65 6374 286e   >>> df.select(n
+0000c270: 6567 6174 6528 636f 6c28 2261 2229 2e61  egate(col("a").a
+0000c280: 6c69 6173 2822 7265 7375 6c74 2229 2929  lias("result")))
+0000c290: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0000c2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0000c2b0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0000c2c0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000c2d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000c2e0: 2d31 2020 2020 2020 2020 7c0a 2020 2020  -1        |.    
+0000c2f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000c300: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0000c310: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
+0000c320: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000c330: 5f73 7472 2865 2c20 226e 6567 6174 6522  _str(e, "negate"
+0000c340: 290a 2020 2020 7265 7475 726e 202d 630a  ).    return -c.
+0000c350: 0a0a 6465 6620 6e6f 745f 2865 3a20 436f  ..def not_(e: Co
+0000c360: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000c370: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0000c380: 7475 726e 7320 7468 6520 696e 7665 7273  turns the invers
+0000c390: 6520 6f66 2061 2062 6f6f 6c65 616e 2065  e of a boolean e
+0000c3a0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
+0000c3b0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000c3c0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0000c3d0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0000c3e0: 7261 6d65 285b 5b54 7275 655d 5d2c 2073  rame([[True]], s
+0000c3f0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0000c400: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0000c410: 6374 286e 6f74 5f28 636f 6c28 2261 2229  ct(not_(col("a")
+0000c420: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0000c430: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0000c440: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000c450: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0000c460: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000c470: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000c480: 207c 4661 6c73 6520 2020 2020 7c0a 2020   |False     |.  
+0000c490: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000c4a0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0000c4b0: 4b4c 494e 453e 0a20 2020 2022 2222 0a0a  KLINE>.    """..
+0000c4c0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0000c4d0: 6966 5f73 7472 2865 2c20 226e 6f74 5f22  if_str(e, "not_"
+0000c4e0: 290a 2020 2020 7265 7475 726e 207e 630a  ).    return ~c.
+0000c4f0: 0a0a 6465 6620 7261 6e64 6f6d 2873 6565  ..def random(see
+0000c500: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
+0000c510: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
+0000c520: 6d6e 3a0a 2020 2020 2222 2245 6163 6820  mn:.    """Each 
+0000c530: 6361 6c6c 2072 6574 7572 6e73 2061 2070  call returns a p
+0000c540: 7365 7564 6f2d 7261 6e64 6f6d 2036 342d  seudo-random 64-
+0000c550: 6269 7420 696e 7465 6765 722e 0a0a 2020  bit integer...  
+0000c560: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000c570: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000c580: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+0000c590: 2031 2229 0a20 2020 2020 2020 203e 3e3e   1").        >>>
+0000c5a0: 2064 6620 3d20 6466 2e73 656c 6563 7428   df = df.select(
+0000c5b0: 7261 6e64 6f6d 2831 3233 292e 616c 6961  random(123).alia
+0000c5c0: 7328 2272 6573 756c 7422 2929 0a20 2020  s("result")).   
+0000c5d0: 2022 2222 0a20 2020 2073 203d 2073 6565   """.    s = see
+0000c5e0: 6420 6966 2073 6565 6420 6973 206e 6f74  d if seed is not
+0000c5f0: 204e 6f6e 6520 656c 7365 2072 616e 6469   None else randi
+0000c600: 6e74 282d 2832 2a2a 3633 292c 2032 2a2a  nt(-(2**63), 2**
+0000c610: 3633 202d 2031 290a 2020 2020 7265 7475  63 - 1).    retu
+0000c620: 726e 2062 7569 6c74 696e 2822 7261 6e64  rn builtin("rand
+0000c630: 6f6d 2229 284c 6974 6572 616c 2873 2929  om")(Literal(s))
+0000c640: 0a0a 0a64 6566 2075 6e69 666f 726d 280a  ...def uniform(.
+0000c650: 2020 2020 6d69 6e5f 3a20 556e 696f 6e5b      min_: Union[
+0000c660: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+0000c670: 742c 2066 6c6f 6174 5d2c 0a20 2020 206d  t, float],.    m
+0000c680: 6178 5f3a 2055 6e69 6f6e 5b43 6f6c 756d  ax_: Union[Colum
+0000c690: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
+0000c6a0: 6f61 745d 2c0a 2020 2020 6765 6e3a 2055  oat],.    gen: U
+0000c6b0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+0000c6c0: 652c 2069 6e74 2c20 666c 6f61 745d 2c0a  e, int, float],.
+0000c6d0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0000c6e0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+0000c6f0: 2061 2075 6e69 666f 726d 6c79 2072 616e   a uniformly ran
+0000c700: 646f 6d20 6e75 6d62 6572 2e0a 0a20 2020  dom number...   
+0000c710: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000c720: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0000c730: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+0000c740: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0000c750: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0000c760: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+0000c770: 2020 5b5b 315d 5d2c 0a20 2020 2020 2020    [[1]],.       
+0000c780: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+0000c790: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
+0000c7a0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+0000c7b0: 2064 662e 7365 6c65 6374 2875 6e69 666f   df.select(unifo
+0000c7c0: 726d 2831 2c20 3130 302c 2063 6f6c 2822  rm(1, 100, col("
+0000c7d0: 6122 2929 2e61 6c69 6173 2822 554e 4946  a")).alias("UNIF
+0000c7e0: 4f52 4d22 2929 2e63 6f6c 6c65 6374 2829  ORM")).collect()
+0000c7f0: 0a20 2020 2020 2020 205b 526f 7728 554e  .        [Row(UN
+0000c800: 4946 4f52 4d3d 3632 295d 0a20 2020 2022  IFORM=62)].    "
+0000c810: 2222 0a0a 2020 2020 6465 6620 636f 6e76  ""..    def conv
+0000c820: 6572 745f 6c69 6d69 745f 746f 5f63 6f6c  ert_limit_to_col
+0000c830: 286c 696d 6974 293a 0a20 2020 2020 2020  (limit):.       
+0000c840: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+0000c850: 696d 6974 2c20 696e 7429 3a0a 2020 2020  imit, int):.    
+0000c860: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000c870: 6974 286c 696d 6974 290a 2020 2020 2020  it(limit).      
+0000c880: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0000c890: 6528 6c69 6d69 742c 2066 6c6f 6174 293a  e(limit, float):
+0000c8a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000c8b0: 7572 6e20 6c69 7428 6c69 6d69 7429 2e63  urn lit(limit).c
+0000c8c0: 6173 7428 466c 6f61 7454 7970 6528 2929  ast(FloatType())
+0000c8d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000c8e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286c  _to_col_if_str(l
+0000c8f0: 696d 6974 2c20 2275 6e69 666f 726d 2229  imit, "uniform")
+0000c900: 0a0a 2020 2020 6d69 6e5f 636f 6c20 3d20  ..    min_col = 
+0000c910: 636f 6e76 6572 745f 6c69 6d69 745f 746f  convert_limit_to
+0000c920: 5f63 6f6c 286d 696e 5f29 0a20 2020 206d  _col(min_).    m
+0000c930: 6178 5f63 6f6c 203d 2063 6f6e 7665 7274  ax_col = convert
+0000c940: 5f6c 696d 6974 5f74 6f5f 636f 6c28 6d61  _limit_to_col(ma
+0000c950: 785f 290a 2020 2020 6765 6e5f 636f 6c20  x_).    gen_col 
+0000c960: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
+0000c970: 6765 6e29 2069 6620 6973 696e 7374 616e  gen) if isinstan
+0000c980: 6365 2867 656e 2c20 2869 6e74 2c20 666c  ce(gen, (int, fl
+0000c990: 6f61 7429 2920 656c 7365 205f 746f 5f63  oat)) else _to_c
+0000c9a0: 6f6c 5f69 665f 7374 7228 6765 6e2c 2022  ol_if_str(gen, "
+0000c9b0: 756e 6966 6f72 6d22 290a 2020 2020 290a  uniform").    ).
+0000c9c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000c9d0: 696e 2822 756e 6966 6f72 6d22 2928 6d69  in("uniform")(mi
+0000c9e0: 6e5f 636f 6c2c 206d 6178 5f63 6f6c 2c20  n_col, max_col, 
+0000c9f0: 6765 6e5f 636f 6c29 0a0a 0a64 6566 2073  gen_col)...def s
+0000ca00: 6571 3128 7369 676e 3a20 696e 7420 3d20  eq1(sign: int = 
+0000ca10: 3029 202d 3e20 436f 6c75 6d6e 3a0a 2020  0) -> Column:.  
+0000ca20: 2020 2222 2252 6574 7572 6e73 2061 2073    """Returns a s
+0000ca30: 6571 7565 6e63 6520 6f66 206d 6f6e 6f74  equence of monot
+0000ca40: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+0000ca50: 696e 6720 696e 7465 6765 7273 2c20 7769  ing integers, wi
+0000ca60: 7468 2077 7261 702d 6172 6f75 6e64 0a20  th wrap-around. 
+0000ca70: 2020 2077 6869 6368 2068 6170 7065 6e73     which happens
+0000ca80: 2061 6674 6572 206c 6172 6765 7374 2072   after largest r
+0000ca90: 6570 7265 7365 6e74 6162 6c65 2069 6e74  epresentable int
+0000caa0: 6567 6572 206f 6620 696e 7465 6765 7220  eger of integer 
+0000cab0: 7769 6474 6820 3120 6279 7465 2e0a 0a20  width 1 byte... 
+0000cac0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0000cad0: 2073 6967 6e3a 2057 6865 6e20 302c 2074   sign: When 0, t
+0000cae0: 6865 2073 6571 7565 6e63 6520 636f 6e74  he sequence cont
+0000caf0: 696e 7565 7320 6174 2030 2061 6674 6572  inues at 0 after
+0000cb00: 2077 7261 702d 6172 6f75 6e64 2e20 5768   wrap-around. Wh
+0000cb10: 656e 2031 2c20 7468 6520 7365 7175 656e  en 1, the sequen
+0000cb20: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
+0000cb30: 6f6e 7469 6e75 6573 2061 7420 736d 616c  ontinues at smal
+0000cb40: 6c65 7374 2072 6570 7265 7365 6e74 6162  lest representab
+0000cb50: 6c65 2031 2062 7974 6520 696e 7465 6765  le 1 byte intege
+0000cb60: 722e 2044 6566 6175 6c74 7320 746f 2030  r. Defaults to 0
+0000cb70: 2e0a 0a20 2020 2053 6565 2041 6c73 6f3a  ...    See Also:
+0000cb80: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
+0000cb90: 3a60 5365 7373 696f 6e2e 6765 6e65 7261  :`Session.genera
+0000cba0: 746f 7260 2c20 7768 6963 6820 6361 6e20  tor`, which can 
+0000cbb0: 6265 2075 7365 6420 746f 2067 656e 6572  be used to gener
+0000cbc0: 6174 6520 696e 2074 616e 6465 6d20 7769  ate in tandem wi
+0000cbd0: 7468 2060 7365 7131 6020 746f 0a20 2020  th `seq1` to.   
+0000cbe0: 2020 2020 2020 2020 2067 656e 6572 6174           generat
+0000cbf0: 6520 7365 7175 656e 6365 732e 0a0a 2020  e sequences...  
+0000cc00: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000cc10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000cc20: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
+0000cc30: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
+0000cc40: 3d33 290a 2020 2020 2020 2020 3e3e 3e20  =3).        >>> 
+0000cc50: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+0000cc60: 2020 2020 205b 526f 7728 5345 5131 2830       [Row(SEQ1(0
+0000cc70: 293d 3029 2c20 526f 7728 5345 5131 2830  )=0), Row(SEQ1(0
+0000cc80: 293d 3129 2c20 526f 7728 5345 5131 2830  )=1), Row(SEQ1(0
+0000cc90: 293d 3229 5d0a 2020 2020 2222 220a 2020  )=2)].    """.  
+0000cca0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000ccb0: 2822 7365 7131 2229 284c 6974 6572 616c  ("seq1")(Literal
+0000ccc0: 2873 6967 6e29 290a 0a0a 6465 6620 7365  (sign))...def se
+0000ccd0: 7132 2873 6967 6e3a 2069 6e74 203d 2030  q2(sign: int = 0
+0000cce0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0000ccf0: 2022 2222 5265 7475 726e 7320 6120 7365   """Returns a se
+0000cd00: 7175 656e 6365 206f 6620 6d6f 6e6f 746f  quence of monoto
+0000cd10: 6e69 6361 6c6c 7920 696e 6372 6561 7369  nically increasi
+0000cd20: 6e67 2069 6e74 6567 6572 732c 2077 6974  ng integers, wit
+0000cd30: 6820 7772 6170 2d61 726f 756e 640a 2020  h wrap-around.  
+0000cd40: 2020 7768 6963 6820 6861 7070 656e 7320    which happens 
+0000cd50: 6166 7465 7220 6c61 7267 6573 7420 7265  after largest re
+0000cd60: 7072 6573 656e 7461 626c 6520 696e 7465  presentable inte
+0000cd70: 6765 7220 6f66 2069 6e74 6567 6572 2077  ger of integer w
+0000cd80: 6964 7468 2032 2062 7974 652e 0a0a 2020  idth 2 byte...  
+0000cd90: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0000cda0: 7369 676e 3a20 5768 656e 2030 2c20 7468  sign: When 0, th
+0000cdb0: 6520 7365 7175 656e 6365 2063 6f6e 7469  e sequence conti
+0000cdc0: 6e75 6573 2061 7420 3020 6166 7465 7220  nues at 0 after 
+0000cdd0: 7772 6170 2d61 726f 756e 642e 2057 6865  wrap-around. Whe
+0000cde0: 6e20 312c 2074 6865 2073 6571 7565 6e63  n 1, the sequenc
+0000cdf0: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
+0000ce00: 6e74 696e 7565 7320 6174 2073 6d61 6c6c  ntinues at small
+0000ce10: 6573 7420 7265 7072 6573 656e 7461 626c  est representabl
+0000ce20: 6520 3220 6279 7465 2069 6e74 6567 6572  e 2 byte integer
+0000ce30: 2e20 4465 6661 756c 7473 2074 6f20 302e  . Defaults to 0.
+0000ce40: 0a0a 2020 2020 5365 6520 416c 736f 3a0a  ..    See Also:.
+0000ce50: 2020 2020 2020 2020 2d20 3a6d 6574 683a          - :meth:
+0000ce60: 6053 6573 7369 6f6e 2e67 656e 6572 6174  `Session.generat
+0000ce70: 6f72 602c 2077 6869 6368 2063 616e 2062  or`, which can b
+0000ce80: 6520 7573 6564 2074 6f20 6765 6e65 7261  e used to genera
+0000ce90: 7465 2069 6e20 7461 6e64 656d 2077 6974  te in tandem wit
+0000cea0: 6820 6073 6571 3260 2074 6f0a 2020 2020  h `seq2` to.    
+0000ceb0: 2020 2020 2020 2020 6765 6e65 7261 7465          generate
+0000cec0: 2073 6571 7565 6e63 6573 2e0a 0a20 2020   sequences...   
+0000ced0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000cee0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0000cef0: 696f 6e2e 6765 6e65 7261 746f 7228 7365  ion.generator(se
+0000cf00: 7132 2830 292c 2072 6f77 636f 756e 743d  q2(0), rowcount=
+0000cf10: 3329 0a20 2020 2020 2020 203e 3e3e 2064  3).        >>> d
+0000cf20: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+0000cf30: 2020 2020 5b52 6f77 2853 4551 3228 3029      [Row(SEQ2(0)
+0000cf40: 3d30 292c 2052 6f77 2853 4551 3228 3029  =0), Row(SEQ2(0)
+0000cf50: 3d31 292c 2052 6f77 2853 4551 3228 3029  =1), Row(SEQ2(0)
+0000cf60: 3d32 295d 0a20 2020 2022 2222 0a20 2020  =2)].    """.   
+0000cf70: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0000cf80: 2273 6571 3222 2928 4c69 7465 7261 6c28  "seq2")(Literal(
+0000cf90: 7369 676e 2929 0a0a 0a64 6566 2073 6571  sign))...def seq
+0000cfa0: 3428 7369 676e 3a20 696e 7420 3d20 3029  4(sign: int = 0)
+0000cfb0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000cfc0: 2222 2252 6574 7572 6e73 2061 2073 6571  """Returns a seq
+0000cfd0: 7565 6e63 6520 6f66 206d 6f6e 6f74 6f6e  uence of monoton
+0000cfe0: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
+0000cff0: 6720 696e 7465 6765 7273 2c20 7769 7468  g integers, with
+0000d000: 2077 7261 702d 6172 6f75 6e64 0a20 2020   wrap-around.   
+0000d010: 2077 6869 6368 2068 6170 7065 6e73 2061   which happens a
+0000d020: 6674 6572 206c 6172 6765 7374 2072 6570  fter largest rep
+0000d030: 7265 7365 6e74 6162 6c65 2069 6e74 6567  resentable integ
+0000d040: 6572 206f 6620 696e 7465 6765 7220 7769  er of integer wi
+0000d050: 6474 6820 3420 6279 7465 2e0a 0a20 2020  dth 4 byte...   
+0000d060: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
+0000d070: 6967 6e3a 2057 6865 6e20 302c 2074 6865  ign: When 0, the
+0000d080: 2073 6571 7565 6e63 6520 636f 6e74 696e   sequence contin
+0000d090: 7565 7320 6174 2030 2061 6674 6572 2077  ues at 0 after w
+0000d0a0: 7261 702d 6172 6f75 6e64 2e20 5768 656e  rap-around. When
+0000d0b0: 2031 2c20 7468 6520 7365 7175 656e 6365   1, the sequence
+0000d0c0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0000d0d0: 7469 6e75 6573 2061 7420 736d 616c 6c65  tinues at smalle
+0000d0e0: 7374 2072 6570 7265 7365 6e74 6162 6c65  st representable
+0000d0f0: 2034 2062 7974 6520 696e 7465 6765 722e   4 byte integer.
+0000d100: 2044 6566 6175 6c74 7320 746f 2030 2e0a   Defaults to 0..
+0000d110: 0a20 2020 2053 6565 2041 6c73 6f3a 0a20  .    See Also:. 
+0000d120: 2020 2020 2020 202d 203a 6d65 7468 3a60         - :meth:`
+0000d130: 5365 7373 696f 6e2e 6765 6e65 7261 746f  Session.generato
+0000d140: 7260 2c20 7768 6963 6820 6361 6e20 6265  r`, which can be
+0000d150: 2075 7365 6420 746f 2067 656e 6572 6174   used to generat
+0000d160: 6520 696e 2074 616e 6465 6d20 7769 7468  e in tandem with
+0000d170: 2060 7365 7134 6020 746f 0a20 2020 2020   `seq4` to.     
+0000d180: 2020 2020 2020 2067 656e 6572 6174 6520         generate 
+0000d190: 7365 7175 656e 6365 732e 0a0a 2020 2020  sequences...    
+0000d1a0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0000d1b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000d1c0: 6f6e 2e67 656e 6572 6174 6f72 2873 6571  on.generator(seq
+0000d1d0: 3428 3029 2c20 726f 7763 6f75 6e74 3d33  4(0), rowcount=3
+0000d1e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0000d1f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0000d200: 2020 205b 526f 7728 5345 5134 2830 293d     [Row(SEQ4(0)=
+0000d210: 3029 2c20 526f 7728 5345 5134 2830 293d  0), Row(SEQ4(0)=
+0000d220: 3129 2c20 526f 7728 5345 5134 2830 293d  1), Row(SEQ4(0)=
+0000d230: 3229 5d0a 2020 2020 2222 220a 2020 2020  2)].    """.    
+0000d240: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000d250: 7365 7134 2229 284c 6974 6572 616c 2873  seq4")(Literal(s
+0000d260: 6967 6e29 290a 0a0a 6465 6620 7365 7138  ign))...def seq8
+0000d270: 2873 6967 6e3a 2069 6e74 203d 2030 2920  (sign: int = 0) 
+0000d280: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0000d290: 2222 5265 7475 726e 7320 6120 7365 7175  ""Returns a sequ
+0000d2a0: 656e 6365 206f 6620 6d6f 6e6f 746f 6e69  ence of monotoni
+0000d2b0: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
+0000d2c0: 2069 6e74 6567 6572 732c 2077 6974 6820   integers, with 
+0000d2d0: 7772 6170 2d61 726f 756e 640a 2020 2020  wrap-around.    
+0000d2e0: 7768 6963 6820 6861 7070 656e 7320 6166  which happens af
+0000d2f0: 7465 7220 6c61 7267 6573 7420 7265 7072  ter largest repr
+0000d300: 6573 656e 7461 626c 6520 696e 7465 6765  esentable intege
+0000d310: 7220 6f66 2069 6e74 6567 6572 2077 6964  r of integer wid
+0000d320: 7468 2038 2062 7974 652e 0a0a 2020 2020  th 8 byte...    
+0000d330: 4172 6773 3a0a 2020 2020 2020 2020 7369  Args:.        si
+0000d340: 676e 3a20 5768 656e 2030 2c20 7468 6520  gn: When 0, the 
+0000d350: 7365 7175 656e 6365 2063 6f6e 7469 6e75  sequence continu
+0000d360: 6573 2061 7420 3020 6166 7465 7220 7772  es at 0 after wr
+0000d370: 6170 2d61 726f 756e 642e 2057 6865 6e20  ap-around. When 
+0000d380: 312c 2074 6865 2073 6571 7565 6e63 650a  1, the sequence.
+0000d390: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000d3a0: 696e 7565 7320 6174 2073 6d61 6c6c 6573  inues at smalles
+0000d3b0: 7420 7265 7072 6573 656e 7461 626c 6520  t representable 
+0000d3c0: 3820 6279 7465 2069 6e74 6567 6572 2e20  8 byte integer. 
+0000d3d0: 4465 6661 756c 7473 2074 6f20 302e 0a0a  Defaults to 0...
+0000d3e0: 2020 2020 5365 6520 416c 736f 3a0a 2020      See Also:.  
+0000d3f0: 2020 2020 2020 2d20 3a6d 6574 683a 6053        - :meth:`S
+0000d400: 6573 7369 6f6e 2e67 656e 6572 6174 6f72  ession.generator
+0000d410: 602c 2077 6869 6368 2063 616e 2062 6520  `, which can be 
+0000d420: 7573 6564 2074 6f20 6765 6e65 7261 7465  used to generate
+0000d430: 2069 6e20 7461 6e64 656d 2077 6974 6820   in tandem with 
+0000d440: 6073 6571 3860 2074 6f0a 2020 2020 2020  `seq8` to.      
+0000d450: 2020 2020 2020 6765 6e65 7261 7465 2073        generate s
+0000d460: 6571 7565 6e63 6573 2e0a 0a20 2020 2045  equences...    E
+0000d470: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0000d480: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000d490: 6e2e 6765 6e65 7261 746f 7228 7365 7138  n.generator(seq8
+0000d4a0: 2830 292c 2072 6f77 636f 756e 743d 3329  (0), rowcount=3)
+0000d4b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000d4c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0000d4d0: 2020 5b52 6f77 2853 4551 3828 3029 3d30    [Row(SEQ8(0)=0
+0000d4e0: 292c 2052 6f77 2853 4551 3828 3029 3d31  ), Row(SEQ8(0)=1
+0000d4f0: 292c 2052 6f77 2853 4551 3828 3029 3d32  ), Row(SEQ8(0)=2
+0000d500: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+0000d510: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
+0000d520: 6571 3822 2928 4c69 7465 7261 6c28 7369  eq8")(Literal(si
+0000d530: 676e 2929 0a0a 0a64 6566 2074 6f5f 6465  gn))...def to_de
+0000d540: 6369 6d61 6c28 653a 2043 6f6c 756d 6e4f  cimal(e: ColumnO
+0000d550: 724e 616d 652c 2070 7265 6369 7369 6f6e  rName, precision
+0000d560: 3a20 696e 742c 2073 6361 6c65 3a20 696e  : int, scale: in
+0000d570: 7429 202d 3e20 436f 6c75 6d6e 3a0a 2020  t) -> Column:.  
+0000d580: 2020 2222 2243 6f6e 7665 7274 7320 616e    """Converts an
+0000d590: 2069 6e70 7574 2065 7870 7265 7373 696f   input expressio
+0000d5a0: 6e20 746f 2061 2064 6563 696d 616c 2e0a  n to a decimal..
+0000d5b0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000d5c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000d5d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0000d5e0: 6174 6166 7261 6d65 285b 2731 3227 2c20  ataframe(['12', 
+0000d5f0: 2731 312e 3327 2c20 272d 3930 2e31 3233  '11.3', '-90.123
+0000d600: 3435 275d 2c20 7363 6865 6d61 3d5b 2761  45'], schema=['a
+0000d610: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+0000d620: 6466 2e73 656c 6563 7428 746f 5f64 6563  df.select(to_dec
+0000d630: 696d 616c 2863 6f6c 2827 6127 292c 2033  imal(col('a'), 3
+0000d640: 382c 2030 292e 6173 5f28 2761 6e73 2729  8, 0).as_('ans')
+0000d650: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0000d660: 2020 2020 5b52 6f77 2841 4e53 3d31 3229      [Row(ANS=12)
+0000d670: 2c20 526f 7728 414e 533d 3131 292c 2052  , Row(ANS=11), R
+0000d680: 6f77 2841 4e53 3d2d 3930 295d 0a0a 2020  ow(ANS=-90)]..  
+0000d690: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0000d6a0: 6563 7428 746f 5f64 6563 696d 616c 2863  ect(to_decimal(c
+0000d6b0: 6f6c 2827 6127 292c 2033 382c 2032 292e  ol('a'), 38, 2).
+0000d6c0: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
+0000d6d0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0000d6e0: 6f77 2841 4e53 3d44 6563 696d 616c 2827  ow(ANS=Decimal('
+0000d6f0: 3132 2e30 3027 2929 2c20 526f 7728 414e  12.00')), Row(AN
+0000d700: 533d 4465 6369 6d61 6c28 2731 312e 3330  S=Decimal('11.30
+0000d710: 2729 292c 2052 6f77 2841 4e53 3d44 6563  ')), Row(ANS=Dec
+0000d720: 696d 616c 2827 2d39 302e 3132 2729 295d  imal('-90.12'))]
+0000d730: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000d740: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000d750: 652c 2022 746f 5f64 6563 696d 616c 2229  e, "to_decimal")
+0000d760: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000d770: 7469 6e28 2274 6f5f 6465 6369 6d61 6c22  tin("to_decimal"
+0000d780: 2928 632c 206c 6974 2870 7265 6369 7369  )(c, lit(precisi
+0000d790: 6f6e 292c 206c 6974 2873 6361 6c65 2929  on), lit(scale))
+0000d7a0: 0a0a 0a64 6566 2064 6976 3028 0a20 2020  ...def div0(.   
+0000d7b0: 2064 6976 6964 656e 643a 2055 6e69 6f6e   dividend: Union
+0000d7c0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+0000d7d0: 6e74 2c20 666c 6f61 745d 2c20 6469 7669  nt, float], divi
+0000d7e0: 736f 723a 2055 6e69 6f6e 5b43 6f6c 756d  sor: Union[Colum
+0000d7f0: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
+0000d800: 6f61 745d 0a29 202d 3e20 436f 6c75 6d6e  oat].) -> Column
+0000d810: 3a0a 2020 2020 2222 220a 2020 2020 5065  :.    """.    Pe
+0000d820: 7266 6f72 6d73 2064 6976 6973 696f 6e20  rforms division 
+0000d830: 6c69 6b65 2074 6865 2064 6976 6973 696f  like the divisio
+0000d840: 6e20 6f70 6572 6174 6f72 2028 2f29 2c0a  n operator (/),.
+0000d850: 2020 2020 6275 7420 7265 7475 726e 7320      but returns 
+0000d860: 3020 7768 656e 2074 6865 2064 6976 6973  0 when the divis
+0000d870: 6f72 2069 7320 3020 2872 6174 6865 7220  or is 0 (rather 
+0000d880: 7468 616e 2072 6570 6f72 7469 6e67 2061  than reporting a
+0000d890: 6e20 6572 726f 7229 2e0a 0a20 2020 2045  n error)...    E
+0000d8a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0000d8b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000d8c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000d8d0: 616d 6528 5b31 5d2c 2073 6368 656d 613d  ame([1], schema=
+0000d8e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+0000d8f0: 3e3e 2064 662e 7365 6c65 6374 2864 6976  >> df.select(div
+0000d900: 3028 6466 5b22 6122 5d2c 2031 292e 616c  0(df["a"], 1).al
+0000d910: 6961 7328 2264 6976 6964 6564 5f62 795f  ias("divided_by_
+0000d920: 6f6e 6522 292c 2064 6976 3028 6466 5b22  one"), div0(df["
+0000d930: 6122 5d2c 2030 292e 616c 6961 7328 2264  a"], 0).alias("d
+0000d940: 6976 6964 6564 5f62 795f 7a65 726f 2229  ivided_by_zero")
+0000d950: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0000d960: 2020 2020 5b52 6f77 2844 4956 4944 4544      [Row(DIVIDED
+0000d970: 5f42 595f 4f4e 453d 4465 6369 6d61 6c28  _BY_ONE=Decimal(
+0000d980: 2731 2e30 3030 3030 3027 292c 2044 4956  '1.000000'), DIV
+0000d990: 4944 4544 5f42 595f 5a45 524f 3d44 6563  IDED_BY_ZERO=Dec
+0000d9a0: 696d 616c 2827 302e 3030 3030 3030 2729  imal('0.000000')
+0000d9b0: 295d 0a20 2020 2022 2222 0a20 2020 2064  )].    """.    d
+0000d9c0: 6976 6964 656e 645f 636f 6c20 3d20 280a  ividend_col = (.
+0000d9d0: 2020 2020 2020 2020 6c69 7428 6469 7669          lit(divi
+0000d9e0: 6465 6e64 290a 2020 2020 2020 2020 6966  dend).        if
+0000d9f0: 2069 7369 6e73 7461 6e63 6528 6469 7669   isinstance(divi
+0000da00: 6465 6e64 2c20 2869 6e74 2c20 666c 6f61  dend, (int, floa
+0000da10: 7429 290a 2020 2020 2020 2020 656c 7365  t)).        else
+0000da20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000da30: 6469 7669 6465 6e64 2c20 2264 6976 3022  dividend, "div0"
+0000da40: 290a 2020 2020 290a 2020 2020 6469 7669  ).    ).    divi
+0000da50: 736f 725f 636f 6c20 3d20 280a 2020 2020  sor_col = (.    
+0000da60: 2020 2020 6c69 7428 6469 7669 736f 7229      lit(divisor)
+0000da70: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0000da80: 7374 616e 6365 2864 6976 6973 6f72 2c20  stance(divisor, 
+0000da90: 2869 6e74 2c20 666c 6f61 7429 290a 2020  (int, float)).  
+0000daa0: 2020 2020 2020 656c 7365 205f 746f 5f63        else _to_c
+0000dab0: 6f6c 5f69 665f 7374 7228 6469 7669 736f  ol_if_str(diviso
+0000dac0: 722c 2022 6469 7630 2229 0a20 2020 2029  r, "div0").    )
+0000dad0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000dae0: 7469 6e28 2264 6976 3022 2928 6469 7669  tin("div0")(divi
+0000daf0: 6465 6e64 5f63 6f6c 2c20 6469 7669 736f  dend_col, diviso
+0000db00: 725f 636f 6c29 0a0a 0a64 6566 2073 7172  r_col)...def sqr
+0000db10: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
+0000db20: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0000db30: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+0000db40: 2073 7175 6172 652d 726f 6f74 206f 6620   square-root of 
+0000db50: 6120 6e6f 6e2d 6e65 6761 7469 7665 206e  a non-negative n
+0000db60: 756d 6572 6963 2065 7870 7265 7373 696f  umeric expressio
+0000db70: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+0000db80: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0000db90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000dba0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+0000dbb0: 2020 2020 202e 2e2e 2020 2020 205b 342c       ...     [4,
+0000dbc0: 2039 5d2c 0a20 2020 2020 2020 202e 2e2e   9],.        ...
+0000dbd0: 2020 2020 2073 6368 656d 613d 5b22 4e22       schema=["N"
+0000dbe0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+0000dbf0: 2e73 656c 6563 7428 7371 7274 2863 6f6c  .select(sqrt(col
+0000dc00: 2822 4e22 2929 290a 2020 2020 2020 2020  ("N"))).        
+0000dc10: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+0000dc20: 0a20 2020 2020 2020 205b 526f 7728 5351  .        [Row(SQ
+0000dc30: 5254 2822 4e22 293d 322e 3029 2c20 526f  RT("N")=2.0), Ro
+0000dc40: 7728 5351 5254 2822 4e22 293d 332e 3029  w(SQRT("N")=3.0)
+0000dc50: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+0000dc60: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000dc70: 2865 2c20 2273 7172 7422 290a 2020 2020  (e, "sqrt").    
+0000dc80: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000dc90: 7371 7274 2229 2863 290a 0a0a 6465 6620  sqrt")(c)...def 
+0000dca0: 6162 7328 653a 2043 6f6c 756d 6e4f 724e  abs(e: ColumnOrN
+0000dcb0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0000dcc0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+0000dcd0: 6865 2061 6273 6f6c 7574 6520 7661 6c75  he absolute valu
+0000dce0: 6520 6f66 2061 206e 756d 6572 6963 2065  e of a numeric e
+0000dcf0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
+0000dd00: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0000dd10: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000dd20: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000dd30: 616d 6528 5b5b 2d31 5d5d 2c20 7363 6865  ame([[-1]], sche
+0000dd40: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0000dd50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0000dd60: 6162 7328 636f 6c28 2261 2229 292e 616c  abs(col("a")).al
+0000dd70: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+0000dd80: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0000dd90: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000dda0: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+0000ddb0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000ddc0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
+0000ddd0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0000dde0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000ddf0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000de00: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0000de10: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000de20: 7228 652c 2022 6162 7322 290a 2020 2020  r(e, "abs").    
+0000de30: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000de40: 6162 7322 2928 6329 0a0a 0a64 6566 2061  abs")(c)...def a
+0000de50: 636f 7328 653a 2043 6f6c 756d 6e4f 724e  cos(e: ColumnOrN
+0000de60: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0000de70: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
+0000de80: 7468 6520 696e 7665 7273 6520 636f 7369  the inverse cosi
+0000de90: 6e65 2028 6172 6320 636f 7369 6e65 2920  ne (arc cosine) 
+0000dea0: 6f66 2069 7473 2069 6e70 7574 3b0a 2020  of its input;.  
+0000deb0: 2020 7468 6520 7265 7375 6c74 2069 7320    the result is 
+0000dec0: 6120 6e75 6d62 6572 2069 6e20 7468 6520  a number in the 
+0000ded0: 696e 7465 7276 616c 205b 2d70 692c 2070  interval [-pi, p
+0000dee0: 695d 2e0a 0a20 2020 2045 7861 6d70 6c65  i]...    Example
+0000def0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+0000df00: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+0000df10: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+0000df20: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
+0000df30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000df40: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0000df50: 6461 7461 6672 616d 6528 5b5b 302e 355d  dataframe([[0.5]
+0000df60: 5d2c 2073 6368 656d 613d 5b22 6465 6722  ], schema=["deg"
+0000df70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000df80: 662e 7365 6c65 6374 2861 636f 7328 636f  f.select(acos(co
+0000df90: 6c28 2264 6567 2229 292e 6361 7374 2844  l("deg")).cast(D
+0000dfa0: 6563 696d 616c 5479 7065 2873 6361 6c65  ecimalType(scale
+0000dfb0: 3d33 2929 2e61 6c69 6173 2822 7265 7375  =3)).alias("resu
+0000dfc0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0000dfd0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000dfe0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0000dff0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0000e000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000e010: 2020 2020 7c31 2e30 3437 2020 2020 207c      |1.047     |
+0000e020: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000e030: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0000e040: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0000e050: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0000e060: 6c5f 6966 5f73 7472 2865 2c20 2261 636f  l_if_str(e, "aco
+0000e070: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
+0000e080: 7569 6c74 696e 2822 6163 6f73 2229 2863  uiltin("acos")(c
+0000e090: 290a 0a0a 6465 6620 6173 696e 2865 3a20  )...def asin(e: 
+0000e0a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0000e0b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0000e0c0: 436f 6d70 7574 6573 2074 6865 2069 6e76  Computes the inv
+0000e0d0: 6572 7365 2073 696e 6520 2861 7263 2073  erse sine (arc s
+0000e0e0: 696e 6529 206f 6620 6974 7320 696e 7075  ine) of its inpu
+0000e0f0: 743b 0a20 2020 2074 6865 2072 6573 756c  t;.    the resul
+0000e100: 7420 6973 2061 206e 756d 6265 7220 696e  t is a number in
+0000e110: 2074 6865 2069 6e74 6572 7661 6c20 5b2d   the interval [-
+0000e120: 7069 2c20 7069 5d2e 0a0a 2020 2020 4578  pi, pi]...    Ex
+0000e130: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0000e140: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0000e150: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+0000e160: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
+0000e170: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+0000e180: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0000e190: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0000e1a0: 5b31 5d5d 2c20 7363 6865 6d61 3d5b 2264  [1]], schema=["d
+0000e1b0: 6567 225d 290a 2020 2020 2020 2020 3e3e  eg"]).        >>
+0000e1c0: 3e20 6466 2e73 656c 6563 7428 6173 696e  > df.select(asin
+0000e1d0: 2863 6f6c 2822 6465 6722 2929 2e63 6173  (col("deg")).cas
+0000e1e0: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
+0000e1f0: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
+0000e200: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0000e210: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000e220: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0000e230: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0000e240: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000e250: 2020 2020 2020 207c 312e 3537 3120 2020         |1.571   
+0000e260: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000e270: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000e280: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0000e290: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0000e2a0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+0000e2b0: 6173 696e 2229 0a20 2020 2072 6574 7572  asin").    retur
+0000e2c0: 6e20 6275 696c 7469 6e28 2261 7369 6e22  n builtin("asin"
+0000e2d0: 2928 6329 0a0a 0a64 6566 2061 7461 6e28  )(c)...def atan(
+0000e2e0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0000e2f0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000e300: 2222 2243 6f6d 7075 7465 7320 7468 6520  """Computes the 
+0000e310: 696e 7665 7273 6520 7461 6e67 656e 7420  inverse tangent 
+0000e320: 2861 7263 2074 616e 6765 6e74 2920 6f66  (arc tangent) of
+0000e330: 2069 7473 2069 6e70 7574 3b0a 2020 2020   its input;.    
+0000e340: 7468 6520 7265 7375 6c74 2069 7320 6120  the result is a 
+0000e350: 6e75 6d62 6572 2069 6e20 7468 6520 696e  number in the in
+0000e360: 7465 7276 616c 205b 2d70 692c 2070 695d  terval [-pi, pi]
+0000e370: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000e380: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0000e390: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0000e3a0: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+0000e3b0: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
+0000e3c0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000e3d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000e3e0: 7461 6672 616d 6528 5b5b 315d 5d2c 2073  taframe([[1]], s
+0000e3f0: 6368 656d 613d 5b22 6465 6722 5d29 0a20  chema=["deg"]). 
+0000e400: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000e410: 6c65 6374 2861 7461 6e28 636f 6c28 2264  lect(atan(col("d
+0000e420: 6567 2229 292e 6361 7374 2844 6563 696d  eg")).cast(Decim
+0000e430: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
+0000e440: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0000e450: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0000e460: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0000e470: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0000e480: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000e490: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000e4a0: 7c30 2e37 3835 2020 2020 207c 0a20 2020  |0.785     |.   
+0000e4b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000e4c0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0000e4d0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0000e4e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000e4f0: 5f73 7472 2865 2c20 2261 7461 6e22 290a  _str(e, "atan").
+0000e500: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000e510: 696e 2822 6174 616e 2229 2863 290a 0a0a  in("atan")(c)...
+0000e520: 6465 6620 6174 616e 3228 793a 2043 6f6c  def atan2(y: Col
+0000e530: 756d 6e4f 724e 616d 652c 2078 3a20 436f  umnOrName, x: Co
+0000e540: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000e550: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+0000e560: 6d70 7574 6573 2074 6865 2069 6e76 6572  mputes the inver
+0000e570: 7365 2074 616e 6765 6e74 2028 6172 6320  se tangent (arc 
+0000e580: 7461 6e67 656e 7429 206f 6620 6974 7320  tangent) of its 
+0000e590: 696e 7075 743b 0a20 2020 2074 6865 2072  input;.    the r
+0000e5a0: 6573 756c 7420 6973 2061 206e 756d 6265  esult is a numbe
+0000e5b0: 7220 696e 2074 6865 2069 6e74 6572 7661  r in the interva
+0000e5c0: 6c20 5b2d 7069 2c20 7069 5d2e 0a0a 2020  l [-pi, pi]...  
+0000e5d0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000e5e0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0000e5f0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0000e600: 7479 7065 7320 696d 706f 7274 2044 6563  types import Dec
+0000e610: 696d 616c 5479 7065 0a20 2020 2020 2020  imalType.       
+0000e620: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000e630: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0000e640: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
+0000e650: 656d 613d 5b22 7822 2c20 2279 225d 290a  ema=["x", "y"]).
+0000e660: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000e670: 656c 6563 7428 6174 616e 3228 6466 2e78  elect(atan2(df.x
+0000e680: 2c20 6466 2e79 292e 6361 7374 2844 6563  , df.y).cast(Dec
+0000e690: 696d 616c 5479 7065 2873 6361 6c65 3d33  imalType(scale=3
+0000e6a0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+0000e6b0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0000e6c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0000e6d0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0000e6e0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0000e6f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000e700: 2020 7c30 2e34 3634 2020 2020 207c 0a20    |0.464     |. 
+0000e710: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000e720: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0000e730: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0000e740: 2020 2020 795f 636f 6c20 3d20 5f74 6f5f      y_col = _to_
+0000e750: 636f 6c5f 6966 5f73 7472 2879 2c20 2261  col_if_str(y, "a
+0000e760: 7461 6e32 2229 0a20 2020 2078 5f63 6f6c  tan2").    x_col
+0000e770: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000e780: 7228 782c 2022 6174 616e 3222 290a 2020  r(x, "atan2").  
+0000e790: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000e7a0: 2822 6174 616e 3222 2928 795f 636f 6c2c  ("atan2")(y_col,
+0000e7b0: 2078 5f63 6f6c 290a 0a0a 6465 6620 6365   x_col)...def ce
+0000e7c0: 696c 2865 3a20 436f 6c75 6d6e 4f72 4e61  il(e: ColumnOrNa
+0000e7d0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000e7e0: 2020 2022 2222 5265 7475 726e 7320 7661     """Returns va
+0000e7f0: 6c75 6573 2066 726f 6d20 7468 6520 7370  lues from the sp
+0000e800: 6563 6966 6965 6420 636f 6c75 6d6e 2072  ecified column r
+0000e810: 6f75 6e64 6564 2074 6f20 7468 6520 6e65  ounded to the ne
+0000e820: 6172 6573 7420 6571 7561 6c20 6f72 206c  arest equal or l
+0000e830: 6172 6765 720a 2020 2020 696e 7465 6765  arger.    intege
+0000e840: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
+0000e850: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0000e860: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000e870: 7465 5f64 6174 6166 7261 6d65 285b 3133  te_dataframe([13
+0000e880: 352e 3133 352c 202d 3937 352e 3937 355d  5.135, -975.975]
+0000e890: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0000e8a0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000e8b0: 656c 6563 7428 6365 696c 2864 665b 2261  elect(ceil(df["a
+0000e8c0: 225d 292e 616c 6961 7328 2263 6569 6c22  "]).alias("ceil"
+0000e8d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0000e8e0: 2020 2020 205b 526f 7728 4345 494c 3d31       [Row(CEIL=1
+0000e8f0: 3336 2e30 292c 2052 6f77 2843 4549 4c3d  36.0), Row(CEIL=
+0000e900: 2d39 3735 2e30 295d 0a20 2020 2022 2222  -975.0)].    """
+0000e910: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0000e920: 5f69 665f 7374 7228 652c 2022 6365 696c  _if_str(e, "ceil
+0000e930: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0000e940: 696c 7469 6e28 2263 6569 6c22 2928 6329  iltin("ceil")(c)
+0000e950: 0a0a 0a64 6566 2063 6f73 2865 3a20 436f  ...def cos(e: Co
+0000e960: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000e970: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+0000e980: 6d70 7574 6573 2074 6865 2063 6f73 696e  mputes the cosin
+0000e990: 6520 6f66 2069 7473 2061 7267 756d 656e  e of its argumen
+0000e9a0: 743b 2074 6865 2061 7267 756d 656e 7420  t; the argument 
+0000e9b0: 7368 6f75 6c64 2062 6520 6578 7072 6573  should be expres
+0000e9c0: 7365 6420 696e 2072 6164 6961 6e73 2e0a  sed in radians..
+0000e9d0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+0000e9e0: 2020 2020 2020 3e3e 3e20 6672 6f6d 206d        >>> from m
+0000e9f0: 6174 6820 696d 706f 7274 2070 690a 2020  ath import pi.  
+0000ea00: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000ea10: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000ea20: 7461 6672 616d 6528 5b5b 7069 5d5d 2c20  taframe([[pi]], 
+0000ea30: 7363 6865 6d61 3d5b 2264 6567 225d 290a  schema=["deg"]).
+0000ea40: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000ea50: 656c 6563 7428 636f 7328 636f 6c28 2264  elect(cos(col("d
+0000ea60: 6567 2229 292e 616c 6961 7328 2272 6573  eg")).alias("res
+0000ea70: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0000ea80: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000ea90: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0000eaa0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0000eab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0000eac0: 2020 2020 207c 2d31 2e30 2020 2020 2020       |-1.0      
+0000ead0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000eae0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0000eaf0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0000eb00: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0000eb10: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
+0000eb20: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
+0000eb30: 7569 6c74 696e 2822 636f 7322 2928 6329  uiltin("cos")(c)
+0000eb40: 0a0a 0a64 6566 2063 6f73 6828 653a 2043  ...def cosh(e: C
+0000eb50: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0000eb60: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0000eb70: 6f6d 7075 7465 7320 7468 6520 6879 7065  omputes the hype
+0000eb80: 7262 6f6c 6963 2063 6f73 696e 6520 6f66  rbolic cosine of
+0000eb90: 2069 7473 2061 7267 756d 656e 742e 0a0a   its argument...
+0000eba0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+0000ebb0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0000ebc0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0000ebd0: 2e74 7970 6573 2069 6d70 6f72 7420 4465  .types import De
+0000ebe0: 6369 6d61 6c54 7970 650a 2020 2020 2020  cimalType.      
+0000ebf0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000ec00: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000ec10: 616d 6528 5b5b 305d 5d2c 2073 6368 656d  ame([[0]], schem
+0000ec20: 613d 5b22 6465 6722 5d29 0a20 2020 2020  a=["deg"]).     
+0000ec30: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0000ec40: 2863 6f73 6828 636f 6c28 2264 6567 2229  (cosh(col("deg")
+0000ec50: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0000ec60: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0000ec70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000ec80: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0000ec90: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000eca0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000ecb0: 207c 312e 3020 2020 2020 2020 7c0a 2020   |1.0       |.  
+0000ecc0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000ecd0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0000ece0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0000ecf0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000ed00: 665f 7374 7228 652c 2022 636f 7368 2229  f_str(e, "cosh")
+0000ed10: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000ed20: 7469 6e28 2263 6f73 6822 2928 6329 0a0a  tin("cosh")(c)..
+0000ed30: 0a64 6566 2065 7870 2865 3a20 436f 6c75  .def exp(e: Colu
+0000ed40: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0000ed50: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0000ed60: 2043 6f6d 7075 7465 7320 4575 6c65 7227   Computes Euler'
+0000ed70: 7320 6e75 6d62 6572 2065 2072 6169 7365  s number e raise
+0000ed80: 6420 746f 2061 2066 6c6f 6174 696e 672d  d to a floating-
+0000ed90: 706f 696e 7420 7661 6c75 652e 0a0a 2020  point value...  
+0000eda0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0000edb0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+0000edc0: 6d61 7468 0a20 2020 2020 2020 203e 3e3e  math.        >>>
+0000edd0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+0000ede0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+0000edf0: 6d70 6f72 7420 496e 7465 6765 7254 7970  mport IntegerTyp
+0000ee00: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0000ee10: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000ee20: 655f 6461 7461 6672 616d 6528 5b30 2e30  e_dataframe([0.0
+0000ee30: 2c20 6d61 7468 2e6c 6f67 2831 3029 5d2c  , math.log(10)],
+0000ee40: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0000ee50: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000ee60: 6c65 6374 2865 7870 2864 665b 2261 225d  lect(exp(df["a"]
+0000ee70: 292e 6361 7374 2849 6e74 6567 6572 5479  ).cast(IntegerTy
+0000ee80: 7065 2829 292e 616c 6961 7328 2265 7870  pe()).alias("exp
+0000ee90: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+0000eea0: 2020 2020 2020 5b52 6f77 2845 5850 3d31        [Row(EXP=1
+0000eeb0: 292c 2052 6f77 2845 5850 3d31 3029 5d0a  ), Row(EXP=10)].
+0000eec0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000eed0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0000eee0: 2c20 2265 7870 2229 0a20 2020 2072 6574  , "exp").    ret
+0000eef0: 7572 6e20 6275 696c 7469 6e28 2265 7870  urn builtin("exp
+0000ef00: 2229 2863 290a 0a0a 6465 6620 6661 6374  ")(c)...def fact
+0000ef10: 6f72 6961 6c28 653a 2043 6f6c 756d 6e4f  orial(e: ColumnO
+0000ef20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000ef30: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
+0000ef40: 6d70 7574 6573 2074 6865 2066 6163 746f  mputes the facto
+0000ef50: 7269 616c 206f 6620 6974 7320 696e 7075  rial of its inpu
+0000ef60: 742e 2054 6865 2069 6e70 7574 2061 7267  t. The input arg
+0000ef70: 756d 656e 7420 6d75 7374 2062 6520 616e  ument must be an
+0000ef80: 2069 6e74 6567 6572 0a20 2020 2065 7870   integer.    exp
+0000ef90: 7265 7373 696f 6e20 696e 2074 6865 2072  ression in the r
+0000efa0: 616e 6765 206f 6620 3020 746f 2033 332e  ange of 0 to 33.
+0000efb0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0000efc0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000efd0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000efe0: 5f64 6174 6166 7261 6d65 285b 302c 2031  _dataframe([0, 1
+0000eff0: 2c20 352c 2031 305d 2c20 7363 6865 6d61  , 5, 10], schema
+0000f000: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+0000f010: 3e3e 3e20 6466 2e73 656c 6563 7428 6661  >>> df.select(fa
+0000f020: 6374 6f72 6961 6c28 6466 5b22 6122 5d29  ctorial(df["a"])
+0000f030: 2e61 6c69 6173 2822 6661 6374 6f72 6961  .alias("factoria
+0000f040: 6c22 2929 2e63 6f6c 6c65 6374 2829 0a20  l")).collect(). 
+0000f050: 2020 2020 2020 205b 526f 7728 4641 4354         [Row(FACT
+0000f060: 4f52 4941 4c3d 3129 2c20 526f 7728 4641  ORIAL=1), Row(FA
+0000f070: 4354 4f52 4941 4c3d 3129 2c20 526f 7728  CTORIAL=1), Row(
+0000f080: 4641 4354 4f52 4941 4c3d 3132 3029 2c20  FACTORIAL=120), 
+0000f090: 526f 7728 4641 4354 4f52 4941 4c3d 3336  Row(FACTORIAL=36
+0000f0a0: 3238 3830 3029 5d0a 2020 2020 2222 220a  28800)].    """.
+0000f0b0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0000f0c0: 6966 5f73 7472 2865 2c20 2266 6163 746f  if_str(e, "facto
+0000f0d0: 7269 616c 2229 0a20 2020 2072 6574 7572  rial").    retur
+0000f0e0: 6e20 6275 696c 7469 6e28 2266 6163 746f  n builtin("facto
+0000f0f0: 7269 616c 2229 2863 290a 0a0a 6465 6620  rial")(c)...def 
+0000f100: 666c 6f6f 7228 653a 2043 6f6c 756d 6e4f  floor(e: ColumnO
+0000f110: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000f120: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0000f130: 7475 726e 7320 7661 6c75 6573 2066 726f  turns values fro
+0000f140: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
+0000f150: 636f 6c75 6d6e 2072 6f75 6e64 6564 2074  column rounded t
+0000f160: 6f20 7468 6520 6e65 6172 6573 7420 6571  o the nearest eq
+0000f170: 7561 6c20 6f72 0a20 2020 2073 6d61 6c6c  ual or.    small
+0000f180: 6572 2069 6e74 6567 6572 2e0a 0a20 2020  er integer...   
+0000f190: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+0000f1a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000f1b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000f1c0: 6166 7261 6d65 285b 3133 352e 3133 352c  aframe([135.135,
+0000f1d0: 202d 3937 352e 3937 355d 2c20 7363 6865   -975.975], sche
+0000f1e0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0000f1f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0000f200: 666c 6f6f 7228 6466 5b22 6122 5d29 2e61  floor(df["a"]).a
+0000f210: 6c69 6173 2822 666c 6f6f 7222 2929 2e63  lias("floor")).c
+0000f220: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0000f230: 205b 526f 7728 464c 4f4f 523d 3133 352e   [Row(FLOOR=135.
+0000f240: 3029 2c20 526f 7728 464c 4f4f 523d 2d39  0), Row(FLOOR=-9
+0000f250: 3736 2e30 295d 0a20 2020 2022 2222 0a20  76.0)].    """. 
+0000f260: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000f270: 665f 7374 7228 652c 2022 666c 6f6f 7222  f_str(e, "floor"
+0000f280: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0000f290: 6c74 696e 2822 666c 6f6f 7222 2928 6329  ltin("floor")(c)
+0000f2a0: 0a0a 0a64 6566 2066 6f72 6d61 745f 6e75  ...def format_nu
+0000f2b0: 6d62 6572 2863 6f6c 3a20 436f 6c75 6d6e  mber(col: Column
+0000f2c0: 4f72 4e61 6d65 2c20 643a 2055 6e69 6f6e  OrName, d: Union
+0000f2d0: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 3a0a  [Column, int]):.
+0000f2e0: 2020 2020 2222 2246 6f72 6d61 7420 6e75      """Format nu
+0000f2f0: 6d62 6572 7320 746f 2061 2073 7065 6369  mbers to a speci
+0000f300: 6669 6320 6e75 6d62 6572 206f 6620 6465  fic number of de
+0000f310: 6369 6d61 6c20 706c 6163 6573 2077 6974  cimal places wit
+0000f320: 6820 4841 4c46 5f54 4f5f 4556 454e 2072  h HALF_TO_EVEN r
+0000f330: 6f75 6e64 696e 672e 0a0a 2020 2020 4e6f  ounding...    No
+0000f340: 7465 3a0a 2020 2020 2020 2020 312e 2054  te:.        1. T
+0000f350: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
+0000f360: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+0000f370: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
+0000f380: 6520 6064 6174 6120 7479 7065 7320 666f  e `data types fo
+0000f390: 7220 6120 6669 7865 642d 706f 696e 7420  r a fixed-point 
+0000f3a0: 6e75 6d62 6572 0a20 2020 2020 2020 203c  number.        <
+0000f3b0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+0000f3c0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+0000f3d0: 6c2d 7265 6665 7265 6e63 652f 6461 7461  l-reference/data
+0000f3e0: 2d74 7970 6573 2d6e 756d 6572 6963 2e68  -types-numeric.h
+0000f3f0: 746d 6c23 6c61 6265 6c2d 6461 7461 2d74  tml#label-data-t
+0000f400: 7970 6573 2d66 6f72 2d66 6978 6564 2d70  ypes-for-fixed-p
+0000f410: 6f69 6e74 2d6e 756d 6265 7273 3e60 5f2e  oint-numbers>`_.
+0000f420: 0a0a 2020 2020 2020 2020 322e 2044 6174  ..        2. Dat
+0000f430: 6120 7479 7065 7320 666f 7220 666c 6f61  a types for floa
+0000f440: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
+0000f450: 7273 2028 652e 672e 2046 4c4f 4154 2920  rs (e.g. FLOAT) 
+0000f460: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
+0000f470: 6420 7769 7468 2074 6869 7320 6172 6775  d with this argu
+0000f480: 6d65 6e74 2e0a 0a20 2020 2020 2020 2033  ment...        3
+0000f490: 2e20 4966 2074 6865 2065 7870 7265 7373  . If the express
+0000f4a0: 696f 6e20 6461 7461 2074 7970 6520 6973  ion data type is
+0000f4b0: 206e 6f74 2073 7570 706f 7274 6564 2c20   not supported, 
+0000f4c0: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+0000f4d0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
+0000f4e0: 7920 6361 7374 2074 6f20 6465 6369 6d61  y cast to decima
+0000f4f0: 6c20 6265 666f 7265 2063 616c 6c69 6e67  l before calling
+0000f500: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000f510: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0000f520: 2069 6d70 6f72 7420 6465 6369 6d61 6c0a   import decimal.
+0000f530: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000f540: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000f550: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+0000f560: 7320 696d 706f 7274 2066 6f72 6d61 745f  s import format_
+0000f570: 6e75 6d62 6572 0a20 2020 2020 2020 2020  number.         
+0000f580: 2020 203e 3e3e 2064 6174 6120 3d20 5b28     >>> data = [(
+0000f590: 312c 2064 6563 696d 616c 2e44 6563 696d  1, decimal.Decim
+0000f5a0: 616c 2833 2e31 3431 3539 2929 2c20 2832  al(3.14159)), (2
+0000f5b0: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
+0000f5c0: 6c28 322e 3731 3832 3829 292c 2028 332c  l(2.71828)), (3,
+0000f5d0: 2064 6563 696d 616c 2e44 6563 696d 616c   decimal.Decimal
+0000f5e0: 2831 2e34 3134 3231 2929 5d0a 2020 2020  (1.41421))].    
+0000f5f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000f600: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
+0000f610: 6174 6146 7261 6d65 2864 6174 612c 205b  ataFrame(data, [
+0000f620: 2269 6422 2c20 2276 616c 7565 225d 290a  "id", "value"]).
+0000f630: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000f640: 6466 2e73 656c 6563 7428 2269 6422 2c66  df.select("id",f
+0000f650: 6f72 6d61 745f 6e75 6d62 6572 2822 7661  ormat_number("va
+0000f660: 6c75 6522 2c32 292e 616c 6961 7328 2276  lue",2).alias("v
+0000f670: 616c 7565 2229 292e 7368 6f77 2829 0a20  alue")).show(). 
+0000f680: 2020 2020 2020 2020 2020 202d 2d2d 2d2d             -----
+0000f690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0000f6a0: 2020 2020 2020 2020 2020 7c22 4944 2220            |"ID" 
+0000f6b0: 207c 2256 414c 5545 2220 207c 0a20 2020   |"VALUE"  |.   
+0000f6c0: 2020 2020 2020 2020 202d 2d2d 2d2d 2d2d           -------
+0000f6d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000f6e0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
+0000f6f0: 332e 3134 2020 2020 207c 0a20 2020 2020  3.14     |.     
+0000f700: 2020 2020 2020 207c 3220 2020 2020 7c32         |2     |2
+0000f710: 2e37 3220 2020 2020 7c0a 2020 2020 2020  .72     |.      
+0000f720: 2020 2020 2020 7c33 2020 2020 207c 312e        |3     |1.
+0000f730: 3431 2020 2020 207c 0a20 2020 2020 2020  41     |.       
+0000f740: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000f750: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000f760: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0000f770: 2020 2020 2222 220a 2020 2020 636f 6c20      """.    col 
+0000f780: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000f790: 2863 6f6c 2c20 2266 6f72 6d61 745f 6e75  (col, "format_nu
+0000f7a0: 6d62 6572 2229 0a20 2020 2072 6574 7572  mber").    retur
+0000f7b0: 6e20 6272 6f75 6e64 2863 6f6c 2c20 6429  n bround(col, d)
+0000f7c0: 2e63 6173 7428 5374 7269 6e67 5479 7065  .cast(StringType
+0000f7d0: 2829 290a 0a0a 6465 6620 7369 6e28 653a  ())...def sin(e:
+0000f7e0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0000f7f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0000f800: 2243 6f6d 7075 7465 7320 7468 6520 7369  "Computes the si
+0000f810: 6e65 206f 6620 6974 7320 6172 6775 6d65  ne of its argume
+0000f820: 6e74 3b20 7468 6520 6172 6775 6d65 6e74  nt; the argument
+0000f830: 2073 686f 756c 6420 6265 2065 7870 7265   should be expre
+0000f840: 7373 6564 2069 6e20 7261 6469 616e 732e  ssed in radians.
+0000f850: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0000f860: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0000f870: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0000f880: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0000f890: 2044 6563 696d 616c 5479 7065 0a20 2020   DecimalType.   
+0000f8a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000f8b0: 7373 696f 6e2e 6765 6e65 7261 746f 7228  ssion.generator(
+0000f8c0: 7365 7131 2830 292c 2072 6f77 636f 756e  seq1(0), rowcoun
+0000f8d0: 743d 3329 2e73 656c 6563 7428 7369 6e28  t=3).select(sin(
+0000f8e0: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
+0000f8f0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000f900: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
+0000f910: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+0000f920: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
+0000f930: 2853 494e 2853 4551 3128 3029 2920 4153  (SIN(SEQ1(0)) AS
+0000f940: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
+0000f950: 4465 6369 6d61 6c28 2730 2e30 3030 3027  Decimal('0.0000'
+0000f960: 2929 2c20 526f 7728 4341 5354 2028 5349  )), Row(CAST (SI
+0000f970: 4e28 5345 5131 2830 2929 2041 5320 4e55  N(SEQ1(0)) AS NU
+0000f980: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+0000f990: 696d 616c 2827 302e 3834 3135 2729 292c  imal('0.8415')),
+0000f9a0: 2052 6f77 2843 4153 5420 2853 494e 2853   Row(CAST (SIN(S
+0000f9b0: 4551 3128 3029 2920 4153 204e 554d 4245  EQ1(0)) AS NUMBE
+0000f9c0: 5228 3338 2c20 3429 293d 4465 6369 6d61  R(38, 4))=Decima
+0000f9d0: 6c28 2730 2e39 3039 3327 2929 5d0a 2020  l('0.9093'))].  
+0000f9e0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0000f9f0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0000fa00: 2273 696e 2229 0a20 2020 2072 6574 7572  "sin").    retur
+0000fa10: 6e20 6275 696c 7469 6e28 2273 696e 2229  n builtin("sin")
+0000fa20: 2863 290a 0a0a 6465 6620 7369 6e68 2865  (c)...def sinh(e
+0000fa30: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0000fa40: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0000fa50: 2222 436f 6d70 7574 6573 2074 6865 2068  ""Computes the h
+0000fa60: 7970 6572 626f 6c69 6320 7369 6e65 206f  yperbolic sine o
+0000fa70: 6620 6974 7320 6172 6775 6d65 6e74 2e0a  f its argument..
+0000fa80: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000fa90: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0000faa0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0000fab0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+0000fac0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
+0000fad0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000fae0: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
+0000faf0: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
+0000fb00: 3d33 292e 7365 6c65 6374 2873 696e 6828  =3).select(sinh(
+0000fb10: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
+0000fb20: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000fb30: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
+0000fb40: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+0000fb50: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
+0000fb60: 2853 494e 4828 5345 5131 2830 2929 2041  (SINH(SEQ1(0)) A
+0000fb70: 5320 4e55 4d42 4552 2833 382c 2034 2929  S NUMBER(38, 4))
+0000fb80: 3d44 6563 696d 616c 2827 302e 3030 3030  =Decimal('0.0000
+0000fb90: 2729 292c 2052 6f77 2843 4153 5420 2853  ')), Row(CAST (S
+0000fba0: 494e 4828 5345 5131 2830 2929 2041 5320  INH(SEQ1(0)) AS 
+0000fbb0: 4e55 4d42 4552 2833 382c 2034 2929 3d44  NUMBER(38, 4))=D
+0000fbc0: 6563 696d 616c 2827 312e 3137 3532 2729  ecimal('1.1752')
+0000fbd0: 292c 2052 6f77 2843 4153 5420 2853 494e  ), Row(CAST (SIN
+0000fbe0: 4828 5345 5131 2830 2929 2041 5320 4e55  H(SEQ1(0)) AS NU
+0000fbf0: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+0000fc00: 696d 616c 2827 332e 3632 3639 2729 295d  imal('3.6269'))]
+0000fc10: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000fc20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000fc30: 652c 2022 7369 6e68 2229 0a20 2020 2072  e, "sinh").    r
+0000fc40: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
+0000fc50: 696e 6822 2928 6329 0a0a 0a64 6566 2074  inh")(c)...def t
+0000fc60: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
+0000fc70: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000fc80: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
+0000fc90: 6865 2074 616e 6765 6e74 206f 6620 6974  he tangent of it
+0000fca0: 7320 6172 6775 6d65 6e74 3b20 7468 6520  s argument; the 
+0000fcb0: 6172 6775 6d65 6e74 2073 686f 756c 6420  argument should 
+0000fcc0: 6265 2065 7870 7265 7373 6564 2069 6e20  be expressed in 
+0000fcd0: 7261 6469 616e 732e 0a0a 2020 2020 4578  radians...    Ex
+0000fce0: 616d 706c 653a 3a0a 2020 2020 2020 203e  ample::.       >
+0000fcf0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0000fd00: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0000fd10: 2069 6d70 6f72 7420 4465 6369 6d61 6c54   import DecimalT
+0000fd20: 7970 650a 2020 2020 2020 203e 3e3e 2064  ype.       >>> d
+0000fd30: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000fd40: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
+0000fd50: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
+0000fd60: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
+0000fd70: 2020 2e2e 2e20 2020 2020 7461 6e28 636f    ...     tan(co
+0000fd80: 6c28 224e 2229 292e 6361 7374 2844 6563  l("N")).cast(Dec
+0000fd90: 696d 616c 5479 7065 2873 6361 6c65 3d34  imalType(scale=4
+0000fda0: 2929 0a20 2020 2020 2020 2e2e 2e20 290a  )).       ... ).
+0000fdb0: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
+0000fdc0: 6c6c 6563 7428 290a 2020 2020 2020 205b  llect().       [
+0000fdd0: 526f 7728 4341 5354 2028 5441 4e28 224e  Row(CAST (TAN("N
+0000fde0: 2229 2041 5320 4e55 4d42 4552 2833 382c  ") AS NUMBER(38,
+0000fdf0: 2034 2929 3d44 6563 696d 616c 2827 302e   4))=Decimal('0.
+0000fe00: 3030 3030 2729 292c 2052 6f77 2843 4153  0000')), Row(CAS
+0000fe10: 5420 2854 414e 2822 4e22 2920 4153 204e  T (TAN("N") AS N
+0000fe20: 554d 4245 5228 3338 2c20 3429 293d 4465  UMBER(38, 4))=De
+0000fe30: 6369 6d61 6c28 2731 2e35 3537 3427 2929  cimal('1.5574'))
+0000fe40: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+0000fe50: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000fe60: 2865 2c20 2274 616e 2229 0a20 2020 2072  (e, "tan").    r
+0000fe70: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+0000fe80: 616e 2229 2863 290a 0a0a 6465 6620 7461  an")(c)...def ta
+0000fe90: 6e68 2865 3a20 436f 6c75 6d6e 4f72 4e61  nh(e: ColumnOrNa
+0000fea0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000feb0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
+0000fec0: 6865 2068 7970 6572 626f 6c69 6320 7461  he hyperbolic ta
+0000fed0: 6e67 656e 7420 6f66 2069 7473 2061 7267  ngent of its arg
+0000fee0: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
+0000fef0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+0000ff00: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+0000ff10: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+0000ff20: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
+0000ff30: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+0000ff40: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000ff50: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
+0000ff60: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
+0000ff70: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
+0000ff80: 2020 202e 2e2e 2020 2020 2074 616e 6828     ...     tanh(
+0000ff90: 636f 6c28 224e 2229 2e63 6173 7428 4465  col("N").cast(De
+0000ffa0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000ffb0: 3429 2929 0a20 2020 2020 2020 202e 2e2e  4))).        ...
+0000ffc0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+0000ffd0: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+0000ffe0: 2020 2020 5b52 6f77 2854 414e 4828 2043      [Row(TANH( C
+0000fff0: 4153 5420 2822 4e22 2041 5320 4e55 4d42  AST ("N" AS NUMB
+00010000: 4552 2833 382c 2034 2929 293d 302e 3029  ER(38, 4)))=0.0)
+00010010: 2c20 526f 7728 5441 4e48 2820 4341 5354  , Row(TANH( CAST
+00010020: 2028 224e 2220 4153 204e 554d 4245 5228   ("N" AS NUMBER(
+00010030: 3338 2c20 3429 2929 3d30 2e37 3631 3539  38, 4)))=0.76159
+00010040: 3431 3535 3935 3537 3634 3929 5d0a 2020  41559557649)].  
+00010050: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00010060: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00010070: 2274 616e 6822 290a 2020 2020 7265 7475  "tanh").    retu
+00010080: 726e 2062 7569 6c74 696e 2822 7461 6e68  rn builtin("tanh
+00010090: 2229 2863 290a 0a0a 6465 6620 6465 6772  ")(c)...def degr
+000100a0: 6565 7328 653a 2043 6f6c 756d 6e4f 724e  ees(e: ColumnOrN
+000100b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+000100c0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+000100d0: 6572 7473 2072 6164 6961 6e73 2074 6f20  erts radians to 
+000100e0: 6465 6772 6565 732e 0a0a 2020 2020 4578  degrees...    Ex
+000100f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00010100: 203e 3e3e 2069 6d70 6f72 7420 6d61 7468   >>> import math
+00010110: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00010120: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00010130: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00010140: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
+00010150: 7275 6374 4669 656c 642c 2044 6f75 626c  ructField, Doubl
+00010160: 6554 7970 652c 2049 6e74 6567 6572 5479  eType, IntegerTy
+00010170: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+00010180: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00010190: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+000101a0: 2020 2020 2020 2e2e 2e20 2020 2020 5b6d        ...     [m
+000101b0: 6174 682e 7069 202f 2033 2c20 6d61 7468  ath.pi / 3, math
+000101c0: 2e70 692c 2033 202a 206d 6174 682e 7069  .pi, 3 * math.pi
+000101d0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+000101e0: 2020 2073 6368 656d 613d 5374 7275 6374     schema=Struct
+000101f0: 5479 7065 285b 5374 7275 6374 4669 656c  Type([StructFiel
+00010200: 6428 2261 222c 2044 6f75 626c 6554 7970  d("a", DoubleTyp
+00010210: 6528 2929 5d29 2c0a 2020 2020 2020 2020  e())]),.        
+00010220: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+00010230: 3e20 6466 2e73 656c 6563 7428 6465 6772  > df.select(degr
+00010240: 6565 7328 636f 6c28 2261 2229 292e 6361  ees(col("a")).ca
+00010250: 7374 2849 6e74 6567 6572 5479 7065 2829  st(IntegerType()
+00010260: 292e 616c 6961 7328 2244 4547 5245 4553  ).alias("DEGREES
+00010270: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00010280: 2020 2020 2020 5b52 6f77 2844 4547 5245        [Row(DEGRE
+00010290: 4553 3d36 3029 2c20 526f 7728 4445 4752  ES=60), Row(DEGR
+000102a0: 4545 533d 3138 3029 2c20 526f 7728 4445  EES=180), Row(DE
+000102b0: 4752 4545 533d 3534 3029 5d0a 2020 2020  GREES=540)].    
+000102c0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+000102d0: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
+000102e0: 6567 7265 6573 2229 0a20 2020 2072 6574  egrees").    ret
+000102f0: 7572 6e20 6275 696c 7469 6e28 2264 6567  urn builtin("deg
+00010300: 7265 6573 2229 2863 290a 0a0a 6465 6620  rees")(c)...def 
+00010310: 7261 6469 616e 7328 653a 2043 6f6c 756d  radians(e: Colum
+00010320: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00010330: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
+00010340: 7274 7320 6465 6772 6565 7320 746f 2072  rts degrees to r
+00010350: 6164 6961 6e73 2e0a 0a20 2020 2045 7861  adians...    Exa
+00010360: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
+00010370: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00010380: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00010390: 6d65 285b 5b31 2e31 3131 5d2c 205b 322e  me([[1.111], [2.
+000103a0: 3232 325d 2c20 5b33 2e33 3333 5d5d 2c20  222], [3.333]], 
+000103b0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+000103c0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000103d0: 6563 7428 7261 6469 616e 7328 636f 6c28  ect(radians(col(
+000103e0: 2261 2229 292e 6361 7374 2822 6e75 6d62  "a")).cast("numb
+000103f0: 6572 2833 382c 2035 2922 292e 616c 6961  er(38, 5)").alia
+00010400: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00010410: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00010420: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00010430: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00010440: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00010450: 2d2d 0a20 2020 2020 2020 207c 302e 3031  --.        |0.01
+00010460: 3933 3920 2020 7c0a 2020 2020 2020 2020  939   |.        
+00010470: 7c30 2e30 3338 3738 2020 207c 0a20 2020  |0.03878   |.   
+00010480: 2020 2020 207c 302e 3035 3831 3720 2020       |0.05817   
+00010490: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000104a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+000104b0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+000104c0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+000104d0: 6f6c 5f69 665f 7374 7228 652c 2022 7261  ol_if_str(e, "ra
+000104e0: 6469 616e 7322 290a 2020 2020 7265 7475  dians").    retu
+000104f0: 726e 2062 7569 6c74 696e 2822 7261 6469  rn builtin("radi
+00010500: 616e 7322 2928 6329 0a0a 0a64 6566 206d  ans")(c)...def m
+00010510: 6435 2865 3a20 436f 6c75 6d6e 4f72 4e61  d5(e: ColumnOrNa
+00010520: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00010530: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+00010540: 6e73 2061 2033 322d 6368 6172 6163 7465  ns a 32-characte
+00010550: 7220 6865 782d 656e 636f 6465 6420 7374  r hex-encoded st
+00010560: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
+00010570: 7468 6520 3132 382d 6269 7420 4d44 3520  the 128-bit MD5 
+00010580: 6d65 7373 6167 6520 6469 6765 7374 2e0a  message digest..
+00010590: 0a20 2020 2020 4578 616d 706c 653a 3a0a  .     Example::.
+000105a0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000105b0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000105c0: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
+000105d0: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
+000105e0: 636f 6c22 5d29 2e73 656c 6563 7428 6d64  col"]).select(md
+000105f0: 3528 2263 6f6c 2229 290a 2020 2020 2020  5("col")).      
+00010600: 2020 3e3e 3e20 6466 2e63 6f6c 6c65 6374    >>> df.collect
+00010610: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00010620: 4d44 3528 2243 4f4c 2229 3d27 3063 6331  MD5("COL")='0cc1
+00010630: 3735 6239 6330 6631 6236 6138 3331 6333  75b9c0f1b6a831c3
+00010640: 3939 6532 3639 3737 3236 3631 2729 2c20  99e269772661'), 
+00010650: 526f 7728 4d44 3528 2243 4f4c 2229 3d27  Row(MD5("COL")='
+00010660: 3932 6562 3566 6665 6536 6165 3266 6563  92eb5ffee6ae2fec
+00010670: 3361 6437 3163 3737 3735 3331 3537 3866  3ad71c777531578f
+00010680: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00010690: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000106a0: 7472 2865 2c20 226d 6435 2229 0a20 2020  tr(e, "md5").   
+000106b0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000106c0: 226d 6435 2229 2863 290a 0a0a 6465 6620  "md5")(c)...def 
+000106d0: 7368 6131 2865 3a20 436f 6c75 6d6e 4f72  sha1(e: ColumnOr
+000106e0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+000106f0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00010700: 6120 3430 2d63 6861 7261 6374 6572 2068  a 40-character h
+00010710: 6578 2d65 6e63 6f64 6564 2073 7472 696e  ex-encoded strin
+00010720: 6720 636f 6e74 6169 6e69 6e67 2074 6865  g containing the
+00010730: 2031 3630 2d62 6974 2053 4841 2d31 206d   160-bit SHA-1 m
+00010740: 6573 7361 6765 2064 6967 6573 742e 0a0a  essage digest...
+00010750: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+00010760: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00010770: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00010780: 7461 6672 616d 6528 5b22 6122 2c20 2262  taframe(["a", "b
+00010790: 225d 2c20 7363 6865 6d61 3d5b 2263 6f6c  "], schema=["col
+000107a0: 225d 292e 7365 6c65 6374 2873 6861 3128  "]).select(sha1(
+000107b0: 2263 6f6c 2229 290a 2020 2020 2020 2020  "col")).        
+000107c0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+000107d0: 0a20 2020 2020 2020 205b 526f 7728 5348  .        [Row(SH
+000107e0: 4131 2822 434f 4c22 293d 2738 3666 3765  A1("COL")='86f7e
+000107f0: 3433 3766 6161 3561 3766 6365 3135 6431  437faa5a7fce15d1
+00010800: 6464 6362 3965 6165 6165 6133 3737 3636  ddcb9eaeaea37766
+00010810: 3762 3827 292c 2052 6f77 2853 4841 3128  7b8'), Row(SHA1(
+00010820: 2243 4f4c 2229 3d27 6539 6437 3166 3565  "COL")='e9d71f5e
+00010830: 6537 6339 3264 3664 6339 6539 3266 6664  e7c92d6dc9e92ffd
+00010840: 6164 3137 6238 6264 3439 3431 3866 3938  ad17b8bd49418f98
+00010850: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00010860: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00010870: 7472 2865 2c20 2273 6861 3122 290a 2020  tr(e, "sha1").  
+00010880: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00010890: 2822 7368 6131 2229 2863 290a 0a0a 6465  ("sha1")(c)...de
+000108a0: 6620 7368 6132 2865 3a20 436f 6c75 6d6e  f sha2(e: Column
+000108b0: 4f72 4e61 6d65 2c20 6e75 6d5f 6269 7473  OrName, num_bits
+000108c0: 3a20 696e 7429 202d 3e20 436f 6c75 6d6e  : int) -> Column
+000108d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+000108e0: 2061 2068 6578 2d65 6e63 6f64 6564 2073   a hex-encoded s
+000108f0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
+00010900: 2074 6865 204e 2d62 6974 2053 4841 2d32   the N-bit SHA-2
+00010910: 206d 6573 7361 6765 2064 6967 6573 742c   message digest,
+00010920: 0a20 2020 2077 6865 7265 204e 2069 7320  .    where N is 
+00010930: 7468 6520 7370 6563 6966 6965 6420 6f75  the specified ou
+00010940: 7470 7574 2064 6967 6573 7420 7369 7a65  tput digest size
+00010950: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00010960: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00010970: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00010980: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
+00010990: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
+000109a0: 636f 6c22 5d29 2e73 656c 6563 7428 7368  col"]).select(sh
+000109b0: 6132 2822 636f 6c22 2c20 3235 3629 290a  a2("col", 256)).
+000109c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
+000109d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000109e0: 205b 526f 7728 5348 4132 2822 434f 4c22   [Row(SHA2("COL"
+000109f0: 2c20 3235 3629 3d27 6361 3937 3831 3132  , 256)='ca978112
+00010a00: 6361 3162 6264 6361 6661 6332 3331 6233  ca1bbdcafac231b3
+00010a10: 3961 3233 6463 3464 6137 3836 6566 6638  9a23dc4da786eff8
+00010a20: 3134 3763 3465 3732 6239 3830 3737 3835  147c4e72b9807785
+00010a30: 6166 6565 3438 6262 2729 2c20 526f 7728  afee48bb'), Row(
+00010a40: 5348 4132 2822 434f 4c22 2c20 3235 3629  SHA2("COL", 256)
+00010a50: 3d27 3365 3233 6538 3136 3030 3339 3539  ='3e23e816003959
+00010a60: 3461 3333 3839 3466 3635 3634 6531 6231  4a33894f6564e1b1
+00010a70: 3334 3862 6264 3761 3030 3838 6434 3263  348bbd7a0088d42c
+00010a80: 3461 6362 3733 6565 6165 6435 3963 3030  4acb73eeaed59c00
+00010a90: 3964 2729 5d0a 2020 2020 2222 220a 2020  9d')].    """.  
+00010aa0: 2020 7065 726d 6974 7465 645f 7661 6c75    permitted_valu
+00010ab0: 6573 203d 205b 302c 2032 3234 2c20 3235  es = [0, 224, 25
+00010ac0: 362c 2033 3834 2c20 3531 325d 0a20 2020  6, 384, 512].   
+00010ad0: 2069 6620 6e75 6d5f 6269 7473 206e 6f74   if num_bits not
+00010ae0: 2069 6e20 7065 726d 6974 7465 645f 7661   in permitted_va
+00010af0: 6c75 6573 3a0a 2020 2020 2020 2020 7261  lues:.        ra
+00010b00: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00010b10: 2020 2020 2020 2020 2020 2020 6622 6e75              f"nu
+00010b20: 6d5f 6269 7473 207b 6e75 6d5f 6269 7473  m_bits {num_bits
+00010b30: 7d20 6973 206e 6f74 2069 6e20 7468 6520  } is not in the 
+00010b40: 7065 726d 6974 7465 6420 7661 6c75 6573  permitted values
+00010b50: 207b 7065 726d 6974 7465 645f 7661 6c75   {permitted_valu
+00010b60: 6573 7d22 0a20 2020 2020 2020 2029 0a20  es}".        ). 
+00010b70: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00010b80: 665f 7374 7228 652c 2022 7368 6132 2229  f_str(e, "sha2")
+00010b90: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00010ba0: 7469 6e28 2273 6861 3222 2928 632c 206e  tin("sha2")(c, n
+00010bb0: 756d 5f62 6974 7329 0a0a 0a64 6566 2068  um_bits)...def h
+00010bc0: 6173 6828 2a63 6f6c 733a 2043 6f6c 756d  ash(*cols: Colum
+00010bd0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00010be0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00010bf0: 5265 7475 726e 7320 6120 7369 676e 6564  Returns a signed
+00010c00: 2036 342d 6269 7420 6861 7368 2076 616c   64-bit hash val
+00010c10: 7565 2e20 4e6f 7465 2074 6861 7420 4841  ue. Note that HA
+00010c20: 5348 206e 6576 6572 2072 6574 7572 6e73  SH never returns
+00010c30: 204e 554c 4c2c 2065 7665 6e20 666f 7220   NULL, even for 
+00010c40: 4e55 4c4c 2069 6e70 7574 732e 0a0a 2020  NULL inputs...  
+00010c50: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
+00010c60: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00010c70: 2064 6563 696d 616c 0a20 2020 2020 2020   decimal.       
+00010c80: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00010c90: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00010ca0: 6d65 285b 5b31 302c 2022 3130 222c 2064  me([[10, "10", d
+00010cb0: 6563 696d 616c 2e44 6563 696d 616c 2831  ecimal.Decimal(1
+00010cc0: 3029 2c20 3130 2e30 5d5d 2c20 7363 6865  0), 10.0]], sche
+00010cd0: 6d61 3d5b 2261 222c 2022 6222 2c20 2263  ma=["a", "b", "c
+00010ce0: 222c 2022 6422 5d29 0a20 2020 2020 2020  ", "d"]).       
+00010cf0: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
+00010d00: 6173 6828 2261 2229 2e61 6c69 6173 2822  ash("a").alias("
+00010d10: 6861 7368 5f61 2229 2c20 6861 7368 2822  hash_a"), hash("
+00010d20: 6222 292e 616c 6961 7328 2268 6173 685f  b").alias("hash_
+00010d30: 6222 292c 2068 6173 6828 2263 2229 2e61  b"), hash("c").a
+00010d40: 6c69 6173 2822 6861 7368 5f63 2229 2c20  lias("hash_c"), 
+00010d50: 6861 7368 2822 6422 292e 616c 6961 7328  hash("d").alias(
+00010d60: 2268 6173 685f 6422 2929 2e63 6f6c 6c65  "hash_d")).colle
+00010d70: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00010d80: 7728 4841 5348 5f41 3d31 3539 3936 3237  w(HASH_A=1599627
+00010d90: 3730 3638 3232 3936 3330 3638 2c20 4841  706822963068, HA
+00010da0: 5348 5f42 3d33 3632 3234 3934 3938 3034  SH_B=36224949804
+00010db0: 3430 3130 3839 3834 2c20 4841 5348 5f43  40108984, HASH_C
+00010dc0: 3d31 3539 3936 3237 3730 3638 3232 3936  =159962770682296
+00010dd0: 3330 3638 2c20 4841 5348 5f44 3d31 3539  3068, HASH_D=159
+00010de0: 3936 3237 3730 3638 3232 3936 3330 3638  9627706822963068
+00010df0: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
+00010e00: 662e 7365 6c65 6374 2868 6173 6828 6c69  f.select(hash(li
+00010e10: 7428 4e6f 6e65 2929 2e61 6c69 6173 2822  t(None)).alias("
+00010e20: 6f6e 6522 292c 2068 6173 6828 6c69 7428  one"), hash(lit(
+00010e30: 4e6f 6e65 292c 206c 6974 284e 6f6e 6529  None), lit(None)
+00010e40: 292e 616c 6961 7328 2274 776f 2229 2c20  ).alias("two"), 
+00010e50: 6861 7368 286c 6974 284e 6f6e 6529 2c20  hash(lit(None), 
+00010e60: 6c69 7428 4e6f 6e65 292c 206c 6974 284e  lit(None), lit(N
+00010e70: 6f6e 6529 292e 616c 6961 7328 2274 6872  one)).alias("thr
+00010e80: 6565 2229 292e 636f 6c6c 6563 7428 290a  ee")).collect().
+00010e90: 2020 2020 2020 2020 5b52 6f77 284f 4e45          [Row(ONE
+00010ea0: 3d38 3831 3739 3735 3730 3233 3933 3631  =881797570239361
+00010eb0: 3933 3638 2c20 5457 4f3d 3935 3339 3633  9368, TWO=953963
+00010ec0: 3235 3833 3531 3130 3431 3630 2c20 5448  258351104160, TH
+00010ed0: 5245 453d 3239 3431 3934 3833 3633 3834  REE=294194836384
+00010ee0: 3536 3834 3431 3229 5d0a 2020 2020 2222  5684412)].    ""
+00010ef0: 220a 2020 2020 636f 6c75 6d6e 7320 3d20  ".    columns = 
+00010f00: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
+00010f10: 632c 2022 6861 7368 2229 2066 6f72 2063  c, "hash") for c
+00010f20: 2069 6e20 636f 6c73 5d0a 2020 2020 7265   in cols].    re
+00010f30: 7475 726e 2062 7569 6c74 696e 2822 6861  turn builtin("ha
+00010f40: 7368 2229 2863 6f6c 756d 6e73 290a 0a0a  sh")(columns)...
+00010f50: 6465 6620 6173 6369 6928 653a 2043 6f6c  def ascii(e: Col
+00010f60: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00010f70: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00010f80: 7572 6e73 2074 6865 2041 5343 4949 2063  urns the ASCII c
+00010f90: 6f64 6520 666f 7220 7468 6520 6669 7273  ode for the firs
+00010fa0: 7420 6368 6172 6163 7465 7220 6f66 2061  t character of a
+00010fb0: 2073 7472 696e 672e 2049 6620 7468 6520   string. If the 
+00010fc0: 7374 7269 6e67 2069 7320 656d 7074 792c  string is empty,
+00010fd0: 0a20 2020 2061 2076 616c 7565 206f 6620  .    a value of 
+00010fe0: 3020 6973 2072 6574 7572 6e65 642e 0a0a  0 is returned...
+00010ff0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00011000: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00011010: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00011020: 6174 6166 7261 6d65 285b 2721 272c 2027  ataframe(['!', '
+00011030: 4127 2c20 2761 272c 2027 272c 2027 6263  A', 'a', '', 'bc
+00011040: 6427 2c20 4e6f 6e65 5d2c 2073 6368 656d  d', None], schem
+00011050: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
+00011060: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+00011070: 662e 612c 2061 7363 6969 2864 662e 6129  f.a, ascii(df.a)
+00011080: 2e61 735f 2827 6173 6369 6927 2929 2e63  .as_('ascii')).c
+00011090: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000110a0: 205b 526f 7728 413d 2721 272c 2041 5343   [Row(A='!', ASC
+000110b0: 4949 3d33 3329 2c20 526f 7728 413d 2741  II=33), Row(A='A
+000110c0: 272c 2041 5343 4949 3d36 3529 2c20 526f  ', ASCII=65), Ro
+000110d0: 7728 413d 2761 272c 2041 5343 4949 3d39  w(A='a', ASCII=9
+000110e0: 3729 2c20 526f 7728 413d 2727 2c20 4153  7), Row(A='', AS
+000110f0: 4349 493d 3029 2c20 526f 7728 413d 2762  CII=0), Row(A='b
+00011100: 6364 272c 2041 5343 4949 3d39 3829 2c20  cd', ASCII=98), 
+00011110: 526f 7728 413d 4e6f 6e65 2c20 4153 4349  Row(A=None, ASCI
+00011120: 493d 4e6f 6e65 295d 0a20 2020 2022 2222  I=None)].    """
+00011130: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00011140: 5f69 665f 7374 7228 652c 2022 6173 6369  _if_str(e, "asci
+00011150: 6922 290a 2020 2020 7265 7475 726e 2062  i").    return b
+00011160: 7569 6c74 696e 2822 6173 6369 6922 2928  uiltin("ascii")(
+00011170: 6329 0a0a 0a64 6566 2069 6e69 7463 6170  c)...def initcap
+00011180: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00011190: 2c20 6465 6c69 6d69 7465 7273 3a20 436f  , delimiters: Co
+000111a0: 6c75 6d6e 4f72 4e61 6d65 203d 204e 6f6e  lumnOrName = Non
+000111b0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+000111c0: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+000111d0: 7320 7468 6520 696e 7075 7420 7374 7269  s the input stri
+000111e0: 6e67 2077 6974 6820 7468 6520 6669 7273  ng with the firs
+000111f0: 7420 6c65 7474 6572 206f 6620 6561 6368  t letter of each
+00011200: 2077 6f72 6420 696e 2075 7070 6572 6361   word in upperca
+00011210: 7365 0a20 2020 2061 6e64 2074 6865 2073  se.    and the s
+00011220: 7562 7365 7175 656e 7420 6c65 7474 6572  ubsequent letter
+00011230: 7320 696e 206c 6f77 6572 6361 7365 2e0a  s in lowercase..
+00011240: 0a20 2020 2060 6064 656c 696d 6974 6572  .    ``delimiter
+00011250: 7360 6020 6973 2061 6e20 6f70 7469 6f6e  s`` is an option
+00011260: 616c 2061 7267 756d 656e 7420 7370 6563  al argument spec
+00011270: 6966 7969 6e67 2061 2073 7472 696e 6720  ifying a string 
+00011280: 6f66 206f 6e65 206f 7220 6d6f 7265 0a20  of one or more. 
+00011290: 2020 2063 6861 7261 6374 6572 7320 7468     characters th
+000112a0: 6174 2060 6069 6e69 7463 6170 6060 2075  at ``initcap`` u
+000112b0: 7365 7320 6173 2073 6570 6172 6174 6f72  ses as separator
+000112c0: 7320 666f 7220 776f 7264 7320 696e 2074  s for words in t
+000112d0: 6865 2069 6e70 7574 2065 7870 7265 7373  he input express
+000112e0: 696f 6e2e 0a0a 2020 2020 4966 2060 6064  ion...    If ``d
+000112f0: 656c 696d 6974 6572 7360 6020 6973 206e  elimiters`` is n
+00011300: 6f74 2073 7065 6369 6669 6564 2c20 616e  ot specified, an
+00011310: 7920 6f66 2074 6865 2066 6f6c 6c6f 7769  y of the followi
+00011320: 6e67 2063 6861 7261 6374 6572 7320 696e  ng characters in
+00011330: 2074 6865 0a20 2020 2069 6e70 7574 2065   the.    input e
+00011340: 7870 7265 7373 696f 6e73 2061 7265 2074  xpressions are t
+00011350: 7265 6174 6564 2061 7320 776f 7264 2073  reated as word s
+00011360: 6570 6172 6174 6f72 733a 0a0a 2020 2020  eparators:..    
+00011370: 2020 2020 6060 3c77 6869 7465 7370 6163      ``<whitespac
+00011380: 653e 2021 203f 2040 2022 205e 2023 2024  e> ! ? @ " ^ # $
+00011390: 2026 207e 205f 202c 202e 203a 203b 202b   & ~ _ , . : ; +
+000113a0: 202d 202a 2025 202f 207c 205c 5c20 5b20   - * % / | \\ [ 
+000113b0: 5d20 2820 2920 7b20 7d20 3c20 3e60 600a  ] ( ) { } < >``.
+000113c0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+000113d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000113e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000113f0: 5f64 6174 6166 7261 6d65 285b 2274 6865  _dataframe(["the
+00011400: 2073 6b79 2069 7320 626c 7565 222c 2022   sky is blue", "
+00011410: 5745 2043 414e 2048 414e 444c 4520 5448  WE CAN HANDLE TH
+00011420: 4953 222c 2022 c384 c3a4 c396 c3b6 c39f  IS", "..........
+00011430: c39c c3bc 222c 204e 6f6e 655d 2c20 7363  ....", None], sc
+00011440: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00011450: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00011460: 7428 696e 6974 6361 7028 6466 5b22 6122  t(initcap(df["a"
+00011470: 5d29 2e61 6c69 6173 2822 696e 6974 6361  ]).alias("initca
+00011480: 7022 2929 2e63 6f6c 6c65 6374 2829 0a20  p")).collect(). 
+00011490: 2020 2020 2020 205b 526f 7728 494e 4954         [Row(INIT
+000114a0: 4341 503d 2754 6865 2053 6b79 2049 7320  CAP='The Sky Is 
+000114b0: 426c 7565 2729 2c20 526f 7728 494e 4954  Blue'), Row(INIT
+000114c0: 4341 503d 2757 6520 4361 6e20 4861 6e64  CAP='We Can Hand
+000114d0: 6c65 2054 6869 7327 292c 2052 6f77 2849  le This'), Row(I
+000114e0: 4e49 5443 4150 3d27 c384 c3a4 c3b6 c3b6  NITCAP='........
+000114f0: c39f c3bc c3bc 2729 2c20 526f 7728 494e  ......'), Row(IN
+00011500: 4954 4341 503d 4e6f 6e65 295d 0a20 2020  ITCAP=None)].   
+00011510: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00011520: 6374 2869 6e69 7463 6170 2864 665b 2261  ct(initcap(df["a
+00011530: 225d 2c20 6c69 7428 2727 2929 2e61 6c69  "], lit('')).ali
+00011540: 6173 2822 696e 6974 6361 7022 2929 2e63  as("initcap")).c
+00011550: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00011560: 205b 526f 7728 494e 4954 4341 503d 2754   [Row(INITCAP='T
+00011570: 6865 2073 6b79 2069 7320 626c 7565 2729  he sky is blue')
+00011580: 2c20 526f 7728 494e 4954 4341 503d 2757  , Row(INITCAP='W
+00011590: 6520 6361 6e20 6861 6e64 6c65 2074 6869  e can handle thi
+000115a0: 7327 292c 2052 6f77 2849 4e49 5443 4150  s'), Row(INITCAP
+000115b0: 3d27 c384 c3a4 c3b6 c3b6 c39f c3bc c3bc  ='..............
+000115c0: 2729 2c20 526f 7728 494e 4954 4341 503d  '), Row(INITCAP=
+000115d0: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
+000115e0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+000115f0: 665f 7374 7228 652c 2022 696e 6974 6361  f_str(e, "initca
+00011600: 7022 290a 2020 2020 6966 2064 656c 696d  p").    if delim
+00011610: 6974 6572 7320 6973 204e 6f6e 653a 0a20  iters is None:. 
+00011620: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
+00011630: 696c 7469 6e28 2269 6e69 7463 6170 2229  iltin("initcap")
+00011640: 2863 290a 2020 2020 6465 6c69 6d69 7465  (c).    delimite
+00011650: 725f 636f 6c20 3d20 5f74 6f5f 636f 6c5f  r_col = _to_col_
+00011660: 6966 5f73 7472 2864 656c 696d 6974 6572  if_str(delimiter
+00011670: 732c 2022 696e 6974 6361 7022 290a 2020  s, "initcap").  
+00011680: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00011690: 2822 696e 6974 6361 7022 2928 632c 2064  ("initcap")(c, d
+000116a0: 656c 696d 6974 6572 5f63 6f6c 290a 0a0a  elimiter_col)...
+000116b0: 6465 6620 6c65 6e67 7468 2865 3a20 436f  def length(e: Co
+000116c0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000116d0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000116e0: 2020 2052 6574 7572 6e73 2074 6865 206c     Returns the l
+000116f0: 656e 6774 6820 6f66 2061 6e20 696e 7075  ength of an inpu
+00011700: 7420 7374 7269 6e67 206f 7220 6269 6e61  t string or bina
+00011710: 7279 2076 616c 7565 2e20 466f 7220 7374  ry value. For st
+00011720: 7269 6e67 732c 0a20 2020 2074 6865 206c  rings,.    the l
+00011730: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
+00011740: 6265 7220 6f66 2063 6861 7261 6374 6572  ber of character
+00011750: 732c 2061 6e64 2055 5446 2d38 2063 6861  s, and UTF-8 cha
+00011760: 7261 6374 6572 7320 6172 6520 636f 756e  racters are coun
+00011770: 7465 6420 6173 2061 0a20 2020 2073 696e  ted as a.    sin
+00011780: 676c 6520 6368 6172 6163 7465 722e 2046  gle character. F
+00011790: 6f72 2062 696e 6172 792c 2074 6865 206c  or binary, the l
+000117a0: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
+000117b0: 6265 7220 6f66 2062 7974 6573 2e0a 0a20  ber of bytes... 
+000117c0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+000117d0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000117e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000117f0: 7461 6672 616d 6528 5b22 7468 6520 736b  taframe(["the sk
+00011800: 7920 6973 2062 6c75 6522 2c20 2257 4520  y is blue", "WE 
+00011810: 4341 4e20 4841 4e44 4c45 2054 4849 5322  CAN HANDLE THIS"
+00011820: 2c20 22c3 84c3 a4c3 96c3 b6c3 9fc3 9cc3  , ".............
+00011830: bc22 2c20 4e6f 6e65 5d2c 2073 6368 656d  .", None], schem
+00011840: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00011850: 203e 3e3e 2064 662e 7365 6c65 6374 286c   >>> df.select(l
+00011860: 656e 6774 6828 6466 5b22 6122 5d29 2e61  ength(df["a"]).a
+00011870: 6c69 6173 2822 6c65 6e67 7468 2229 292e  lias("length")).
+00011880: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00011890: 2020 5b52 6f77 284c 454e 4754 483d 3135    [Row(LENGTH=15
+000118a0: 292c 2052 6f77 284c 454e 4754 483d 3138  ), Row(LENGTH=18
+000118b0: 292c 2052 6f77 284c 454e 4754 483d 3729  ), Row(LENGTH=7)
+000118c0: 2c20 526f 7728 4c45 4e47 5448 3d4e 6f6e  , Row(LENGTH=Non
+000118d0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+000118e0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000118f0: 7472 2865 2c20 226c 656e 6774 6822 290a  tr(e, "length").
+00011900: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00011910: 696e 2822 6c65 6e67 7468 2229 2863 290a  in("length")(c).
+00011920: 0a0a 6465 6620 6c6f 7765 7228 653a 2043  ..def lower(e: C
+00011930: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00011940: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00011950: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00011960: 696e 7075 7420 7374 7269 6e67 2077 6974  input string wit
+00011970: 6820 616c 6c20 6368 6172 6163 7465 7273  h all characters
+00011980: 2063 6f6e 7665 7274 6564 2074 6f20 6c6f   converted to lo
+00011990: 7765 7263 6173 652e 0a0a 2020 2020 4578  wercase...    Ex
+000119a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000119b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000119c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000119d0: 6d65 285b 2761 6263 272c 2027 4162 6327  me(['abc', 'Abc'
+000119e0: 2c20 2761 4243 272c 2027 416e 66c3 bc68  , 'aBC', 'Anf..h
+000119f0: 7275 6e67 737a 6569 6368 656e 272c 2027  rungszeichen', '
+00011a00: 3134 2e39 3520 e282 ac27 5d2c 2073 6368  14.95 ...'], sch
+00011a10: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00011a20: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00011a30: 286c 6f77 6572 2863 6f6c 2822 6122 2929  (lower(col("a"))
+00011a40: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00011a50: 2020 2020 5b52 6f77 284c 4f57 4552 2822      [Row(LOWER("
+00011a60: 4122 293d 2761 6263 2729 2c20 526f 7728  A")='abc'), Row(
+00011a70: 4c4f 5745 5228 2241 2229 3d27 6162 6327  LOWER("A")='abc'
+00011a80: 292c 2052 6f77 284c 4f57 4552 2822 4122  ), Row(LOWER("A"
+00011a90: 293d 2761 6263 2729 2c20 526f 7728 4c4f  )='abc'), Row(LO
+00011aa0: 5745 5228 2241 2229 3d27 616e 66c3 bc68  WER("A")='anf..h
+00011ab0: 7275 6e67 737a 6569 6368 656e 2729 2c20  rungszeichen'), 
+00011ac0: 526f 7728 4c4f 5745 5228 2241 2229 3d27  Row(LOWER("A")='
+00011ad0: 3134 2e39 3520 e282 ac27 295d 0a20 2020  14.95 ...')].   
+00011ae0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00011af0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00011b00: 6c6f 7765 7222 290a 2020 2020 7265 7475  lower").    retu
+00011b10: 726e 2062 7569 6c74 696e 2822 6c6f 7765  rn builtin("lowe
+00011b20: 7222 2928 6329 0a0a 0a64 6566 206c 7061  r")(c)...def lpa
+00011b30: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
+00011b40: 652c 206c 656e 3a20 556e 696f 6e5b 436f  e, len: Union[Co
+00011b50: 6c75 6d6e 2c20 696e 745d 2c20 7061 643a  lumn, int], pad:
+00011b60: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00011b70: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00011b80: 220a 2020 2020 4c65 6674 2d70 6164 7320  ".    Left-pads 
+00011b90: 6120 7374 7269 6e67 2077 6974 6820 6368  a string with ch
+00011ba0: 6172 6163 7465 7273 2066 726f 6d20 616e  aracters from an
+00011bb0: 6f74 6865 7220 7374 7269 6e67 2c20 6f72  other string, or
+00011bc0: 206c 6566 742d 7061 6473 2061 0a20 2020   left-pads a.   
+00011bd0: 2062 696e 6172 7920 7661 6c75 6520 7769   binary value wi
+00011be0: 7468 2062 7974 6573 2066 726f 6d20 616e  th bytes from an
+00011bf0: 6f74 6865 7220 6269 6e61 7279 2076 616c  other binary val
+00011c00: 7565 2e0a 0a20 2020 2045 7861 6d70 6c65  ue...    Example
+00011c10: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00011c20: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00011c30: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+00011c40: 7320 696d 706f 7274 206c 6974 0a20 2020  s import lit.   
+00011c50: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00011c60: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00011c70: 6166 7261 6d65 285b 5b22 6122 5d2c 205b  aframe([["a"], [
+00011c80: 2262 225d 2c20 5b22 6322 5d5d 2c20 7363  "b"], ["c"]], sc
+00011c90: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00011ca0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00011cb0: 7428 6c70 6164 2863 6f6c 2822 6122 292c  t(lpad(col("a"),
+00011cc0: 2033 2c20 6c69 7428 226b 2229 292e 616c   3, lit("k")).al
+00011cd0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00011ce0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00011cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00011d00: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+00011d10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011d20: 2d2d 2d2d 0a20 2020 2020 2020 207c 6b6b  ----.        |kk
+00011d30: 6120 2020 2020 2020 7c0a 2020 2020 2020  a       |.      
+00011d40: 2020 7c6b 6b62 2020 2020 2020 207c 0a20    |kkb       |. 
+00011d50: 2020 2020 2020 207c 6b6b 6320 2020 2020         |kkc     
+00011d60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00011d70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00011d80: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00011d90: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00011da0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00011db0: 6c70 6164 2229 0a20 2020 2070 203d 205f  lpad").    p = _
+00011dc0: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
+00011dd0: 642c 2022 6c70 6164 2229 0a20 2020 2072  d, "lpad").    r
+00011de0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
+00011df0: 7061 6422 2928 632c 206c 6974 286c 656e  pad")(c, lit(len
+00011e00: 292c 2070 290a 0a0a 6465 6620 6c74 7269  ), p)...def ltri
+00011e10: 6d28 653a 2043 6f6c 756d 6e4f 724e 616d  m(e: ColumnOrNam
+00011e20: 652c 2074 7269 6d5f 7374 7269 6e67 3a20  e, trim_string: 
+00011e30: 4f70 7469 6f6e 616c 5b43 6f6c 756d 6e4f  Optional[ColumnO
+00011e40: 724e 616d 655d 203d 204e 6f6e 6529 202d  rName] = None) -
+00011e50: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00011e60: 220a 2020 2020 5265 6d6f 7665 7320 6c65  ".    Removes le
+00011e70: 6164 696e 6720 6368 6172 6163 7465 7273  ading characters
+00011e80: 2c20 696e 636c 7564 696e 6720 7768 6974  , including whit
+00011e90: 6573 7061 6365 2c20 6672 6f6d 2061 2073  espace, from a s
+00011ea0: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
+00011eb0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00011ec0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00011ed0: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+00011ee0: 696f 6e73 2069 6d70 6f72 7420 6c69 740a  ions import lit.
+00011ef0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00011f00: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00011f10: 6461 7461 6672 616d 6528 5b5b 2261 7373  dataframe([["ass
+00011f20: 7322 5d2c 205b 2262 7373 7322 5d2c 205b  s"], ["bsss"], [
+00011f30: 2263 7373 7322 5d5d 2c20 7363 6865 6d61  "csss"]], schema
+00011f40: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00011f50: 3e3e 3e20 6466 2e73 656c 6563 7428 7274  >>> df.select(rt
+00011f60: 7269 6d28 636f 6c28 2261 2229 2c20 7472  rim(col("a"), tr
+00011f70: 696d 5f73 7472 696e 673d 6c69 7428 2273  im_string=lit("s
+00011f80: 7373 2229 292e 616c 6961 7328 2272 6573  ss")).alias("res
+00011f90: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+00011fa0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00011fb0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00011fc0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00011fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00011fe0: 2020 2020 207c 6120 2020 2020 2020 2020       |a         
+00011ff0: 7c0a 2020 2020 2020 2020 7c62 2020 2020  |.        |b    
+00012000: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00012010: 6320 2020 2020 2020 2020 7c0a 2020 2020  c         |.    
+00012020: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00012030: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00012040: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00012050: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00012060: 7374 7228 652c 2022 6c74 7269 6d22 290a  str(e, "ltrim").
+00012070: 2020 2020 7420 3d20 5f74 6f5f 636f 6c5f      t = _to_col_
+00012080: 6966 5f73 7472 2874 7269 6d5f 7374 7269  if_str(trim_stri
+00012090: 6e67 2c20 226c 7472 696d 2229 2069 6620  ng, "ltrim") if 
+000120a0: 7472 696d 5f73 7472 696e 6720 6973 206e  trim_string is n
+000120b0: 6f74 204e 6f6e 6520 656c 7365 204e 6f6e  ot None else Non
+000120c0: 650a 2020 2020 7265 7475 726e 2062 7569  e.    return bui
+000120d0: 6c74 696e 2822 6c74 7269 6d22 2928 632c  ltin("ltrim")(c,
+000120e0: 2074 2920 6966 2074 2069 7320 6e6f 7420   t) if t is not 
+000120f0: 4e6f 6e65 2065 6c73 6520 6275 696c 7469  None else builti
+00012100: 6e28 226c 7472 696d 2229 2863 290a 0a0a  n("ltrim")(c)...
+00012110: 6465 6620 7270 6164 2865 3a20 436f 6c75  def rpad(e: Colu
+00012120: 6d6e 4f72 4e61 6d65 2c20 6c65 6e3a 2055  mnOrName, len: U
+00012130: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
+00012140: 5d2c 2070 6164 3a20 436f 6c75 6d6e 4f72  ], pad: ColumnOr
+00012150: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00012160: 0a20 2020 2022 2222 5269 6768 742d 7061  .    """Right-pa
+00012170: 6473 2061 2073 7472 696e 6720 7769 7468  ds a string with
+00012180: 2063 6861 7261 6374 6572 7320 6672 6f6d   characters from
+00012190: 2061 6e6f 7468 6572 2073 7472 696e 672c   another string,
+000121a0: 206f 7220 7269 6768 742d 7061 6473 2061   or right-pads a
+000121b0: 0a20 2020 2062 696e 6172 7920 7661 6c75  .    binary valu
+000121c0: 6520 7769 7468 2062 7974 6573 2066 726f  e with bytes fro
+000121d0: 6d20 616e 6f74 6865 7220 6269 6e61 7279  m another binary
+000121e0: 2076 616c 7565 2e20 5768 656e 2063 616c   value. When cal
+000121f0: 6c65 642c 2060 6560 2069 7320 7061 6464  led, `e` is padd
+00012200: 6564 2074 6f20 6c65 6e67 7468 2060 6c65  ed to length `le
+00012210: 6e60 0a20 2020 2077 6974 6820 6368 6172  n`.    with char
+00012220: 6163 7465 7273 2f62 7974 6573 2066 726f  acters/bytes fro
+00012230: 6d20 6070 6164 602e 0a0a 2020 2020 4578  m `pad`...    Ex
+00012240: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00012250: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00012260: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+00012270: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
+00012280: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
+00012290: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+000122a0: 655f 6461 7461 6672 616d 6528 5b5b 2261  e_dataframe([["a
+000122b0: 225d 2c20 5b22 6222 5d2c 205b 2263 225d  "], ["b"], ["c"]
+000122c0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+000122d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000122e0: 7365 6c65 6374 2872 7061 6428 636f 6c28  select(rpad(col(
+000122f0: 2261 2229 2c20 332c 206c 6974 2822 6b22  "a"), 3, lit("k"
+00012300: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+00012310: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00012320: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00012330: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00012340: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00012350: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00012360: 2020 7c61 6b6b 2020 2020 2020 207c 0a20    |akk       |. 
+00012370: 2020 2020 2020 207c 626b 6b20 2020 2020         |bkk     
+00012380: 2020 7c0a 2020 2020 2020 2020 7c63 6b6b    |.        |ckk
+00012390: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+000123a0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+000123b0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+000123c0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
+000123d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000123e0: 2865 2c20 2272 7061 6422 290a 2020 2020  (e, "rpad").    
+000123f0: 7020 3d20 5f74 6f5f 636f 6c5f 6966 5f73  p = _to_col_if_s
+00012400: 7472 2870 6164 2c20 2272 7061 6422 290a  tr(pad, "rpad").
+00012410: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00012420: 696e 2822 7270 6164 2229 2863 2c20 6c69  in("rpad")(c, li
+00012430: 7428 6c65 6e29 2c20 7029 0a0a 0a64 6566  t(len), p)...def
+00012440: 2072 7472 696d 2865 3a20 436f 6c75 6d6e   rtrim(e: Column
+00012450: 4f72 4e61 6d65 2c20 7472 696d 5f73 7472  OrName, trim_str
+00012460: 696e 673a 204f 7074 696f 6e61 6c5b 436f  ing: Optional[Co
+00012470: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
+00012480: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00012490: 2020 2022 2222 5265 6d6f 7665 7320 7472     """Removes tr
+000124a0: 6169 6c69 6e67 2063 6861 7261 6374 6572  ailing character
+000124b0: 732c 2069 6e63 6c75 6469 6e67 2077 6869  s, including whi
+000124c0: 7465 7370 6163 652c 2066 726f 6d20 6120  tespace, from a 
+000124d0: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
+000124e0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000124f0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00012500: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+00012510: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
+00012520: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00012530: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00012540: 5f64 6174 6166 7261 6d65 285b 5b22 6173  _dataframe([["as
+00012550: 7373 225d 2c20 5b22 6273 7373 225d 2c20  ss"], ["bsss"], 
+00012560: 5b22 6373 7373 225d 5d2c 2073 6368 656d  ["csss"]], schem
+00012570: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00012580: 203e 3e3e 2064 662e 7365 6c65 6374 2872   >>> df.select(r
+00012590: 7472 696d 2863 6f6c 2822 6122 292c 2074  trim(col("a"), t
+000125a0: 7269 6d5f 7374 7269 6e67 3d6c 6974 2822  rim_string=lit("
+000125b0: 7373 7322 2929 2e61 6c69 6173 2822 7265  sss")).alias("re
+000125c0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+000125d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000125e0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+000125f0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00012600: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00012610: 2020 2020 2020 7c61 2020 2020 2020 2020        |a        
+00012620: 207c 0a20 2020 2020 2020 207c 6220 2020   |.        |b   
+00012630: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00012640: 7c63 2020 2020 2020 2020 207c 0a20 2020  |c         |.   
+00012650: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00012660: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00012670: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00012680: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00012690: 5f73 7472 2865 2c20 2272 7472 696d 2229  _str(e, "rtrim")
+000126a0: 0a20 2020 2074 203d 205f 746f 5f63 6f6c  .    t = _to_col
+000126b0: 5f69 665f 7374 7228 7472 696d 5f73 7472  _if_str(trim_str
+000126c0: 696e 672c 2022 7274 7269 6d22 2920 6966  ing, "rtrim") if
+000126d0: 2074 7269 6d5f 7374 7269 6e67 2069 7320   trim_string is 
+000126e0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
+000126f0: 6e65 0a20 2020 2072 6574 7572 6e20 6275  ne.    return bu
+00012700: 696c 7469 6e28 2272 7472 696d 2229 2863  iltin("rtrim")(c
+00012710: 2c20 7429 2069 6620 7420 6973 206e 6f74  , t) if t is not
+00012720: 204e 6f6e 6520 656c 7365 2062 7569 6c74   None else built
+00012730: 696e 2822 7274 7269 6d22 2928 6329 0a0a  in("rtrim")(c)..
+00012740: 0a64 6566 2072 6570 6561 7428 733a 2043  .def repeat(s: C
+00012750: 6f6c 756d 6e4f 724e 616d 652c 206e 3a20  olumnOrName, n: 
+00012760: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
+00012770: 745d 2920 2d3e 2043 6f6c 756d 6e3a 0a20  t]) -> Column:. 
+00012780: 2020 2022 2222 4275 696c 6473 2061 2073     """Builds a s
+00012790: 7472 696e 6720 6279 2072 6570 6561 7469  tring by repeati
+000127a0: 6e67 2074 6865 2069 6e70 7574 2066 6f72  ng the input for
+000127b0: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
+000127c0: 756d 6265 7220 6f66 2074 696d 6573 2e0a  umber of times..
+000127d0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+000127e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000127f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00012800: 6461 7461 6672 616d 6528 5b5b 2261 225d  dataframe([["a"]
+00012810: 2c20 5b22 6222 5d2c 205b 2263 225d 5d2c  , ["b"], ["c"]],
+00012820: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00012830: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00012840: 6c65 6374 2872 6570 6561 7428 636f 6c28  lect(repeat(col(
+00012850: 2261 2229 2c20 3329 2e61 6c69 6173 2822  "a"), 3).alias("
+00012860: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00012870: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00012880: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00012890: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000128a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000128b0: 2020 2020 2020 2020 7c61 6161 2020 2020          |aaa    
+000128c0: 2020 207c 0a20 2020 2020 2020 207c 6262     |.        |bb
+000128d0: 6220 2020 2020 2020 7c0a 2020 2020 2020  b       |.      
+000128e0: 2020 7c63 6363 2020 2020 2020 207c 0a20    |ccc       |. 
+000128f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00012900: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00012910: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00012920: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00012930: 6966 5f73 7472 2873 2c20 2272 6570 6561  if_str(s, "repea
+00012940: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+00012950: 7569 6c74 696e 2822 7265 7065 6174 2229  uiltin("repeat")
+00012960: 2863 2c20 6c69 7428 6e29 290a 0a0a 6465  (c, lit(n))...de
+00012970: 6620 7265 7665 7273 6528 636f 6c3a 2043  f reverse(col: C
+00012980: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00012990: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+000129a0: 6576 6572 7365 7320 7468 6520 6f72 6465  everses the orde
+000129b0: 7220 6f66 2063 6861 7261 6374 6572 7320  r of characters 
+000129c0: 696e 2061 2073 7472 696e 672c 206f 7220  in a string, or 
+000129d0: 6f66 2062 7974 6573 2069 6e20 6120 6269  of bytes in a bi
+000129e0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
+000129f0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00012a00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00012a10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00012a20: 6672 616d 6528 5b5b 2248 656c 6c6f 225d  frame([["Hello"]
+00012a30: 2c20 5b22 6162 6322 5d5d 2c20 7363 6865  , ["abc"]], sche
+00012a40: 6d61 3d5b 2263 6f6c 3122 5d29 0a20 2020  ma=["col1"]).   
+00012a50: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00012a60: 6374 2872 6576 6572 7365 2863 6f6c 2822  ct(reverse(col("
+00012a70: 636f 6c31 2229 2929 2e73 686f 7728 290a  col1"))).show().
+00012a80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00012aa0: 2020 2020 2020 2020 7c22 5245 5645 5253          |"REVERS
+00012ab0: 4528 2222 434f 4c31 2222 2922 2020 7c0a  E(""COL1"")"  |.
+00012ac0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00012ae0: 2020 2020 2020 2020 7c6f 6c6c 6548 2020          |olleH  
+00012af0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00012b00: 2020 2020 2020 2020 7c63 6261 2020 2020          |cba    
+00012b10: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00012b20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00012b40: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+00012b50: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+00012b60: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
+00012b70: 5f73 7472 2863 6f6c 2c20 2272 6576 6572  _str(col, "rever
+00012b80: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
+00012b90: 6275 696c 7469 6e28 2272 6576 6572 7365  builtin("reverse
+00012ba0: 2229 2863 6f6c 290a 0a0a 6465 6620 736f  ")(col)...def so
+00012bb0: 756e 6465 7828 653a 2043 6f6c 756d 6e4f  undex(e: ColumnO
+00012bc0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00012bd0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+00012be0: 2061 2073 7472 696e 6720 7468 6174 2063   a string that c
+00012bf0: 6f6e 7461 696e 7320 6120 7068 6f6e 6574  ontains a phonet
+00012c00: 6963 2072 6570 7265 7365 6e74 6174 696f  ic representatio
+00012c10: 6e20 6f66 2074 6865 2069 6e70 7574 2073  n of the input s
+00012c20: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
+00012c30: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00012c40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00012c50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00012c60: 5b22 4d61 7273 6861 222c 2022 4d61 7263  ["Marsha", "Marc
+00012c70: 6961 225d 2c20 7363 6865 6d61 3d5b 2256  ia"], schema=["V
+00012c80: 225d 292e 7365 6c65 6374 2873 6f75 6e64  "]).select(sound
+00012c90: 6578 2863 6f6c 2822 5622 2929 290a 2020  ex(col("V"))).  
+00012ca0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+00012cb0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00012cc0: 526f 7728 534f 554e 4445 5828 2256 2229  Row(SOUNDEX("V")
+00012cd0: 3d27 4d36 3230 2729 2c20 526f 7728 534f  ='M620'), Row(SO
+00012ce0: 554e 4445 5828 2256 2229 3d27 4d36 3230  UNDEX("V")='M620
+00012cf0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00012d00: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00012d10: 7472 2865 2c20 2273 6f75 6e64 6578 2229  tr(e, "soundex")
+00012d20: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00012d30: 7469 6e28 2273 6f75 6e64 6578 2229 2863  tin("soundex")(c
+00012d40: 290a 0a0a 6465 6620 7472 696d 2865 3a20  )...def trim(e: 
+00012d50: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7472  ColumnOrName, tr
+00012d60: 696d 5f73 7472 696e 673a 204f 7074 696f  im_string: Optio
+00012d70: 6e61 6c5b 436f 6c75 6d6e 4f72 4e61 6d65  nal[ColumnOrName
+00012d80: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
+00012d90: 756d 6e3a 0a20 2020 2022 2222 5265 6d6f  umn:.    """Remo
+00012da0: 7665 7320 6c65 6164 696e 6720 616e 6420  ves leading and 
+00012db0: 7472 6169 6c69 6e67 2063 6861 7261 6374  trailing charact
+00012dc0: 6572 7320 6672 6f6d 2061 2073 7472 696e  ers from a strin
+00012dd0: 672e 2050 6572 2064 6566 6175 6c74 206f  g. Per default o
+00012de0: 6e6c 7920 7768 6974 6573 7061 6365 2027  nly whitespace '
+00012df0: 2027 2063 6861 7261 6374 6572 7320 6172   ' characters ar
+00012e00: 6520 7265 6d6f 7665 642e 0a0a 2020 2020  e removed...    
+00012e10: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00012e20: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00012e30: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00012e40: 7261 6d65 285b 2768 656c 6c6f 272c 2027  rame(['hello', '
+00012e50: 2077 6f72 6c64 272c 2027 2020 2021 2020   world', '   !  
+00012e60: 2027 5d2c 2073 6368 656d 613d 5b22 6122   '], schema=["a"
+00012e70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00012e80: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+00012e90: 2020 2020 5b52 6f77 2841 3d27 6865 6c6c      [Row(A='hell
+00012ea0: 6f27 292c 2052 6f77 2841 3d27 2077 6f72  o'), Row(A=' wor
+00012eb0: 6c64 2729 2c20 526f 7728 413d 2720 2020  ld'), Row(A='   
+00012ec0: 2120 2020 2729 5d0a 2020 2020 2020 2020  !   ')].        
+00012ed0: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+00012ee0: 696d 2863 6f6c 2822 6122 2929 292e 636f  im(col("a"))).co
+00012ef0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00012f00: 5b52 6f77 2854 5249 4d28 2241 2229 3d27  [Row(TRIM("A")='
+00012f10: 6865 6c6c 6f27 292c 2052 6f77 2854 5249  hello'), Row(TRI
+00012f20: 4d28 2241 2229 3d27 776f 726c 6427 292c  M("A")='world'),
+00012f30: 2052 6f77 2854 5249 4d28 2241 2229 3d27   Row(TRIM("A")='
+00012f40: 2127 295d 0a0a 2020 2020 4578 616d 706c  !')]..    Exampl
+00012f50: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00012f60: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00012f70: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00012f80: 2745 5552 2031 322e 3936 272c 2027 372e  'EUR 12.96', '7.
+00012f90: 3839 5553 4427 2c20 2735 2e39 3945 275d  89USD', '5.99E']
+00012fa0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00012fb0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00012fc0: 656c 6563 7428 7472 696d 2863 6f6c 2822  elect(trim(col("
+00012fd0: 6122 292c 206c 6974 2822 4555 5255 5344  a"), lit("EURUSD
+00012fe0: 2022 2929 2e61 735f 2822 616e 7322 2929   ")).as_("ans"))
+00012ff0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00013000: 2020 205b 526f 7728 414e 533d 2731 322e     [Row(ANS='12.
+00013010: 3936 2729 2c20 526f 7728 414e 533d 2737  96'), Row(ANS='7
+00013020: 2e38 3927 292c 2052 6f77 2841 4e53 3d27  .89'), Row(ANS='
+00013030: 352e 3939 2729 5d0a 0a20 2020 2045 7861  5.99')]..    Exa
+00013040: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00013050: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00013060: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00013070: 6528 5b27 6162 6331 3220 3435 6120 3739  e(['abc12 45a 79
+00013080: 6263 2127 5d2c 2073 6368 656d 613d 5b22  bc!'], schema=["
+00013090: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+000130a0: 2064 662e 7365 6c65 6374 2874 7269 6d28   df.select(trim(
+000130b0: 636f 6c28 2261 2229 2c20 6c69 7428 2261  col("a"), lit("a
+000130c0: 6263 2122 2929 2e61 735f 2822 616e 7322  bc!")).as_("ans"
+000130d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000130e0: 2020 2020 205b 526f 7728 414e 533d 2731       [Row(ANS='1
+000130f0: 3220 3435 6120 3739 2729 5d0a 0a20 2020  2 45a 79')]..   
+00013100: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00013110: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00013120: 7472 696d 2229 0a20 2020 2074 203d 205f  trim").    t = _
+00013130: 746f 5f63 6f6c 5f69 665f 7374 7228 7472  to_col_if_str(tr
+00013140: 696d 5f73 7472 696e 672c 2022 7472 696d  im_string, "trim
+00013150: 2229 2069 6620 7472 696d 5f73 7472 696e  ") if trim_strin
+00013160: 6720 6973 206e 6f74 204e 6f6e 6520 656c  g is not None el
+00013170: 7365 204e 6f6e 650a 2020 2020 7265 7475  se None.    retu
+00013180: 726e 2062 7569 6c74 696e 2822 7472 696d  rn builtin("trim
+00013190: 2229 2863 2c20 7429 2069 6620 7420 6973  ")(c, t) if t is
+000131a0: 206e 6f74 204e 6f6e 6520 656c 7365 2062   not None else b
+000131b0: 7569 6c74 696e 2822 7472 696d 2229 2863  uiltin("trim")(c
+000131c0: 290a 0a0a 6465 6620 7570 7065 7228 653a  )...def upper(e:
+000131d0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000131e0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000131f0: 2252 6574 7572 6e73 2074 6865 2069 6e70  "Returns the inp
+00013200: 7574 2073 7472 696e 6720 7769 7468 2061  ut string with a
+00013210: 6c6c 2063 6861 7261 6374 6572 7320 636f  ll characters co
+00013220: 6e76 6572 7465 6420 746f 2075 7070 6572  nverted to upper
+00013230: 6361 7365 2e0a 2020 2020 2020 2055 6e69  case..       Uni
+00013240: 636f 6465 2063 6861 7261 6374 6572 7320  code characters 
+00013250: 6172 6520 7375 7070 6f72 7465 642e 0a0a  are supported...
+00013260: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00013270: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00013280: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00013290: 6174 6166 7261 6d65 285b 2761 6263 272c  ataframe(['abc',
+000132a0: 2027 4162 6327 2c20 2761 4243 272c 2027   'Abc', 'aBC', '
+000132b0: 416e 66c3 bc68 7275 6e67 737a 6569 6368  Anf..hrungszeich
+000132c0: 656e 272c 2027 3134 2e39 3520 e282 ac27  en', '14.95 ...'
+000132d0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+000132e0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000132f0: 7365 6c65 6374 2875 7070 6572 2863 6f6c  select(upper(col
+00013300: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00013310: 290a 2020 2020 2020 2020 5b52 6f77 2855  ).        [Row(U
+00013320: 5050 4552 2822 4122 293d 2741 4243 2729  PPER("A")='ABC')
+00013330: 2c20 526f 7728 5550 5045 5228 2241 2229  , Row(UPPER("A")
+00013340: 3d27 4142 4327 292c 2052 6f77 2855 5050  ='ABC'), Row(UPP
+00013350: 4552 2822 4122 293d 2741 4243 2729 2c20  ER("A")='ABC'), 
+00013360: 526f 7728 5550 5045 5228 2241 2229 3d27  Row(UPPER("A")='
+00013370: 414e 46c3 9c48 5255 4e47 535a 4549 4348  ANF..HRUNGSZEICH
+00013380: 454e 2729 2c20 526f 7728 5550 5045 5228  EN'), Row(UPPER(
+00013390: 2241 2229 3d27 3134 2e39 3520 e282 ac27  "A")='14.95 ...'
+000133a0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+000133b0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+000133c0: 7228 652c 2022 7570 7065 7222 290a 2020  r(e, "upper").  
+000133d0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000133e0: 2822 7570 7065 7222 2928 6329 0a0a 0a64  ("upper")(c)...d
+000133f0: 6566 2073 7472 746f 6b5f 746f 5f61 7272  ef strtok_to_arr
+00013400: 6179 280a 2020 2020 7465 7874 3a20 436f  ay(.    text: Co
+00013410: 6c75 6d6e 4f72 4e61 6d65 2c20 6465 6c69  lumnOrName, deli
+00013420: 6d69 7465 723a 204f 7074 696f 6e61 6c5b  miter: Optional[
+00013430: 436f 6c75 6d6e 4f72 4e61 6d65 5d20 3d20  ColumnOrName] = 
+00013440: 4e6f 6e65 0a29 202d 3e20 436f 6c75 6d6e  None.) -> Column
+00013450: 3a0a 2020 2020 2222 220a 2020 2020 546f  :.    """.    To
+00013460: 6b65 6e69 7a65 7320 7468 6520 6769 7665  kenizes the give
+00013470: 6e20 7374 7269 6e67 2075 7369 6e67 2074  n string using t
+00013480: 6865 2067 6976 656e 2073 6574 206f 6620  he given set of 
+00013490: 6465 6c69 6d69 7465 7273 2061 6e64 2072  delimiters and r
+000134a0: 6574 7572 6e73 2074 6865 2074 6f6b 656e  eturns the token
+000134b0: 7320 6173 2061 6e20 6172 7261 792e 0a0a  s as an array...
+000134c0: 2020 2020 4966 2065 6974 6865 7220 7061      If either pa
+000134d0: 7261 6d65 7465 7220 6973 2061 204e 554c  rameter is a NUL
+000134e0: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
+000134f0: 7572 6e65 642e 2041 6e20 656d 7074 7920  urned. An empty 
+00013500: 6172 7261 7920 6973 2072 6574 7572 6e65  array is returne
+00013510: 6420 6966 2074 6f6b 656e 697a 6174 696f  d if tokenizatio
+00013520: 6e20 7072 6f64 7563 6573 206e 6f20 746f  n produces no to
+00013530: 6b65 6e73 2e0a 0a20 2020 2045 7861 6d70  kens...    Examp
+00013540: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00013550: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00013560: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00013570: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00013580: 5b5b 2261 2e62 2e63 222c 2022 2e22 5d2c  [["a.b.c", "."],
+00013590: 205b 2231 2c32 2e33 222c 2022 2c22 5d5d   ["1,2.3", ","]]
+000135a0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+000135b0: 2020 7363 6865 6d61 3d5b 2274 6578 7422    schema=["text"
+000135c0: 2c20 2264 656c 696d 6974 6572 225d 2c0a  , "delimiter"],.
+000135d0: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+000135e0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000135f0: 6563 7428 7374 7274 6f6b 5f74 6f5f 6172  ect(strtok_to_ar
+00013600: 7261 7928 2274 6578 7422 2c20 2264 656c  ray("text", "del
+00013610: 696d 6974 6572 2229 2e61 6c69 6173 2822  imiter").alias("
+00013620: 5449 4d45 5f46 524f 4d5f 5041 5254 5322  TIME_FROM_PARTS"
+00013630: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00013640: 2020 2020 205b 526f 7728 5449 4d45 5f46       [Row(TIME_F
+00013650: 524f 4d5f 5041 5254 533d 275b 5c5c 6e20  ROM_PARTS='[\\n 
+00013660: 2022 6122 2c5c 5c6e 2020 2262 222c 5c5c   "a",\\n  "b",\\
+00013670: 6e20 2022 6322 5c5c 6e5d 2729 2c20 526f  n  "c"\\n]'), Ro
+00013680: 7728 5449 4d45 5f46 524f 4d5f 5041 5254  w(TIME_FROM_PART
+00013690: 533d 275b 5c5c 6e20 2022 3122 2c5c 5c6e  S='[\\n  "1",\\n
+000136a0: 2020 2232 2e33 225c 5c6e 5d27 295d 0a20    "2.3"\\n]')]. 
+000136b0: 2020 2022 2222 0a20 2020 2074 203d 205f     """.    t = _
+000136c0: 746f 5f63 6f6c 5f69 665f 7374 7228 7465  to_col_if_str(te
+000136d0: 7874 2c20 2273 7472 746f 6b5f 746f 5f61  xt, "strtok_to_a
+000136e0: 7272 6179 2229 0a20 2020 2064 203d 2028  rray").    d = (
+000136f0: 0a20 2020 2020 2020 205f 746f 5f63 6f6c  .        _to_col
+00013700: 5f69 665f 7374 7228 6465 6c69 6d69 7465  _if_str(delimite
+00013710: 722c 2022 7374 7274 6f6b 5f74 6f5f 6172  r, "strtok_to_ar
+00013720: 7261 7922 290a 2020 2020 2020 2020 6966  ray").        if
+00013730: 2028 6465 6c69 6d69 7465 7220 6973 206e   (delimiter is n
+00013740: 6f74 204e 6f6e 6529 0a20 2020 2020 2020  ot None).       
+00013750: 2065 6c73 6520 4e6f 6e65 0a20 2020 2029   else None.    )
+00013760: 0a20 2020 2072 6574 7572 6e20 280a 2020  .    return (.  
+00013770: 2020 2020 2020 6275 696c 7469 6e28 2273        builtin("s
+00013780: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
+00013790: 2874 2c20 6429 0a20 2020 2020 2020 2069  (t, d).        i
+000137a0: 6620 2864 656c 696d 6974 6572 2069 7320  f (delimiter is 
+000137b0: 6e6f 7420 4e6f 6e65 290a 2020 2020 2020  not None).      
+000137c0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
+000137d0: 7374 7274 6f6b 5f74 6f5f 6172 7261 7922  strtok_to_array"
+000137e0: 2928 7429 0a20 2020 2029 0a0a 0a64 6566  )(t).    )...def
+000137f0: 2073 7472 7563 7428 2a63 6f6c 733a 2043   struct(*cols: C
+00013800: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00013810: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00013820: 2020 2020 5265 7475 726e 7320 616e 204f      Returns an O
+00013830: 424a 4543 5420 636f 6e73 7472 7563 7465  BJECT constructe
+00013840: 6420 7769 7468 2074 6865 2067 6976 656e  d with the given
+00013850: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2045   columns...    E
+00013860: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00013870: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00013880: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+00013890: 6374 696f 6e73 2069 6d70 6f72 7420 7374  ctions import st
+000138a0: 7275 6374 0a20 2020 2020 2020 203e 3e3e  ruct.        >>>
+000138b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000138c0: 6561 7465 4461 7461 4672 616d 6528 5b28  eateDataFrame([(
+000138d0: 2242 6f62 222c 2038 3029 2c20 2822 416c  "Bob", 80), ("Al
+000138e0: 6963 6522 2c20 4e6f 6e65 295d 2c20 5b22  ice", None)], ["
+000138f0: 6e61 6d65 222c 2022 6167 6522 5d29 0a20  name", "age"]). 
+00013900: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00013910: 2064 662e 7365 6c65 6374 2873 7472 7563   df.select(struc
+00013920: 7428 2261 6765 222c 2022 6e61 6d65 2229  t("age", "name")
+00013930: 2e61 6c69 6173 2822 7374 7275 6374 2229  .alias("struct")
+00013940: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00013950: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00013960: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00013970: 2253 5452 5543 5422 2020 2020 2020 2020  "STRUCT"        
+00013980: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00013990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000139a0: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
+000139b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000139c0: 0a20 2020 2020 2020 207c 2020 2261 6765  .        |  "age
+000139d0: 223a 2038 302c 2020 2020 2020 207c 0a20  ": 80,       |. 
+000139e0: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
+000139f0: 3a20 2242 6f62 2220 2020 207c 0a20 2020  : "Bob"    |.   
+00013a00: 2020 2020 207c 7d20 2020 2020 2020 2020       |}         
+00013a10: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00013a20: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
+00013a30: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00013a40: 207c 2020 2261 6765 223a 206e 756c 6c2c   |  "age": null,
+00013a50: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00013a60: 2020 226e 616d 6522 3a20 2241 6c69 6365    "name": "Alice
+00013a70: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+00013a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00013aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00013ab0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00013ac0: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
+00013ad0: 2020 6465 6620 666c 6174 7465 6e5f 636f    def flatten_co
+00013ae0: 6c5f 6c69 7374 286f 626a 293a 0a20 2020  l_list(obj):.   
+00013af0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00013b00: 6365 286f 626a 2c20 7374 7229 206f 7220  ce(obj, str) or 
+00013b10: 6973 696e 7374 616e 6365 286f 626a 2c20  isinstance(obj, 
+00013b20: 436f 6c75 6d6e 293a 0a20 2020 2020 2020  Column):.       
+00013b30: 2020 2020 2072 6574 7572 6e20 5b6f 626a       return [obj
+00013b40: 5d0a 2020 2020 2020 2020 656c 6966 2068  ].        elif h
+00013b50: 6173 6174 7472 286f 626a 2c20 225f 5f69  asattr(obj, "__i
+00013b60: 7465 725f 5f22 293a 0a20 2020 2020 2020  ter__"):.       
+00013b70: 2020 2020 2061 6363 203d 205b 5d0a 2020       acc = [].  
+00013b80: 2020 2020 2020 2020 2020 666f 7220 696e            for in
+00013b90: 6e65 724f 626a 2069 6e20 6f62 6a3a 0a20  nerObj in obj:. 
+00013ba0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00013bb0: 6363 203d 2061 6363 202b 2066 6c61 7474  cc = acc + flatt
+00013bc0: 656e 5f63 6f6c 5f6c 6973 7428 696e 6e65  en_col_list(inne
+00013bd0: 724f 626a 290a 2020 2020 2020 2020 2020  rObj).          
+00013be0: 2020 7265 7475 726e 2061 6363 0a0a 2020    return acc..  
+00013bf0: 2020 6e65 775f 636f 6c73 203d 205b 5d0a    new_cols = [].
+00013c00: 2020 2020 666f 7220 6320 696e 2066 6c61      for c in fla
+00013c10: 7474 656e 5f63 6f6c 5f6c 6973 7428 636f  tten_col_list(co
+00013c20: 6c73 293a 0a20 2020 2020 2020 2023 2066  ls):.        # f
+00013c30: 6972 7374 2069 6e73 6572 7420 6669 656c  irst insert fiel
+00013c40: 645f 6e61 6d65 0a20 2020 2020 2020 2069  d_name.        i
+00013c50: 6620 6973 696e 7374 616e 6365 2863 2c20  f isinstance(c, 
+00013c60: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+00013c70: 2020 6e65 775f 636f 6c73 2e61 7070 656e    new_cols.appen
+00013c80: 6428 6c69 7428 6329 290a 2020 2020 2020  d(lit(c)).      
+00013c90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00013ca0: 2020 2020 6e61 6d65 203d 2063 2e5f 6578      name = c._ex
+00013cb0: 7072 6573 7369 6f6e 2e6e 616d 650a 2020  pression.name.  
+00013cc0: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
+00013cd0: 206e 616d 655b 313a 5d20 6966 206e 616d   name[1:] if nam
+00013ce0: 652e 7374 6172 7473 7769 7468 2827 2227  e.startswith('"'
+00013cf0: 2920 656c 7365 206e 616d 650a 2020 2020  ) else name.    
+00013d00: 2020 2020 2020 2020 6e61 6d65 203d 206e          name = n
+00013d10: 616d 655b 3a2d 315d 2069 6620 6e61 6d65  ame[:-1] if name
+00013d20: 2e65 6e64 7377 6974 6828 2722 2729 2065  .endswith('"') e
+00013d30: 6c73 6520 6e61 6d65 0a20 2020 2020 2020  lse name.       
+00013d40: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
+00013d50: 7065 6e64 286c 6974 286e 616d 6529 290a  pend(lit(name)).
+00013d60: 2020 2020 2020 2020 2320 6e65 7874 2069          # next i
+00013d70: 6e73 6572 7420 6669 656c 6420 7661 6c75  nsert field valu
+00013d80: 650a 2020 2020 2020 2020 6320 3d20 5f74  e.        c = _t
+00013d90: 6f5f 636f 6c5f 6966 5f73 7472 2863 2c20  o_col_if_str(c, 
+00013da0: 2273 7472 7563 7422 290a 2020 2020 2020  "struct").      
+00013db0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00013dc0: 632c 2043 6f6c 756d 6e29 2061 6e64 2069  c, Column) and i
+00013dd0: 7369 6e73 7461 6e63 6528 632e 5f65 7870  sinstance(c._exp
+00013de0: 7265 7373 696f 6e2c 2041 6c69 6173 293a  ression, Alias):
+00013df0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00013e00: 5f63 6f6c 732e 6170 7065 6e64 2863 6f6c  _cols.append(col
+00013e10: 2863 2e5f 6578 7072 6573 7369 6f6e 2e63  (c._expression.c
+00013e20: 6869 6c64 7265 6e5b 305d 2929 0a20 2020  hildren[0])).   
+00013e30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00013e40: 2020 2020 2020 206e 6577 5f63 6f6c 732e         new_cols.
+00013e50: 6170 7065 6e64 2863 290a 2020 2020 7265  append(c).    re
+00013e60: 7475 726e 206f 626a 6563 745f 636f 6e73  turn object_cons
+00013e70: 7472 7563 745f 6b65 6570 5f6e 756c 6c28  truct_keep_null(
+00013e80: 2a6e 6577 5f63 6f6c 7329 0a0a 0a64 6566  *new_cols)...def
+00013e90: 206c 6f67 280a 2020 2020 6261 7365 3a20   log(.    base: 
+00013ea0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00013eb0: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
+00013ec0: 2078 3a20 556e 696f 6e5b 436f 6c75 6d6e   x: Union[Column
+00013ed0: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
+00013ee0: 6174 5d0a 2920 2d3e 2043 6f6c 756d 6e3a  at].) -> Column:
+00013ef0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00013f00: 7572 6e73 2074 6865 206c 6f67 6172 6974  urns the logarit
+00013f10: 686d 206f 6620 6120 6e75 6d65 7269 6320  hm of a numeric 
+00013f20: 6578 7072 6573 7369 6f6e 2e0a 0a20 2020  expression...   
+00013f30: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00013f40: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00013f50: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00013f60: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
+00013f70: 6567 6572 5479 7065 0a20 2020 2020 2020  egerType.       
+00013f80: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00013f90: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00013fa0: 6d65 285b 312c 2031 305d 2c20 7363 6865  me([1, 10], sche
+00013fb0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+00013fc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00013fd0: 6c6f 6728 3130 2c20 6466 5b22 6122 5d29  log(10, df["a"])
+00013fe0: 2e63 6173 7428 496e 7465 6765 7254 7970  .cast(IntegerTyp
+00013ff0: 6528 2929 2e61 6c69 6173 2822 6c6f 6722  e()).alias("log"
+00014000: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00014010: 2020 2020 205b 526f 7728 4c4f 473d 3029       [Row(LOG=0)
+00014020: 2c20 526f 7728 4c4f 473d 3129 5d0a 2020  , Row(LOG=1)].  
+00014030: 2020 2222 220a 2020 2020 6220 3d20 6c69    """.    b = li
+00014040: 7428 6261 7365 2920 6966 2069 7369 6e73  t(base) if isins
+00014050: 7461 6e63 6528 6261 7365 2c20 2869 6e74  tance(base, (int
+00014060: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
+00014070: 746f 5f63 6f6c 5f69 665f 7374 7228 6261  to_col_if_str(ba
+00014080: 7365 2c20 226c 6f67 2229 0a20 2020 2061  se, "log").    a
+00014090: 7267 203d 206c 6974 2878 2920 6966 2069  rg = lit(x) if i
+000140a0: 7369 6e73 7461 6e63 6528 782c 2028 696e  sinstance(x, (in
+000140b0: 742c 2066 6c6f 6174 2929 2065 6c73 6520  t, float)) else 
+000140c0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2878  _to_col_if_str(x
+000140d0: 2c20 226c 6f67 2229 0a20 2020 2072 6574  , "log").    ret
+000140e0: 7572 6e20 6275 696c 7469 6e28 226c 6f67  urn builtin("log
+000140f0: 2229 2862 2c20 6172 6729 0a0a 0a64 6566  ")(b, arg)...def
+00014100: 2070 6f77 280a 2020 2020 6c65 6674 3a20   pow(.    left: 
+00014110: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00014120: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
+00014130: 2072 6967 6874 3a20 556e 696f 6e5b 436f   right: Union[Co
+00014140: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
+00014150: 2066 6c6f 6174 5d0a 2920 2d3e 2043 6f6c   float].) -> Col
+00014160: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00014170: 726e 7320 6120 6e75 6d62 6572 2028 6c65  rns a number (le
+00014180: 6674 2920 7261 6973 6564 2074 6f20 7468  ft) raised to th
+00014190: 6520 7370 6563 6966 6965 6420 706f 7765  e specified powe
+000141a0: 7220 2872 6967 6874 292e 0a0a 2020 2020  r (right)...    
+000141b0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+000141c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000141d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000141e0: 616d 6528 5b5b 322c 2033 5d2c 205b 332c  ame([[2, 3], [3,
+000141f0: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2278   4]], schema=["x
+00014200: 222c 2022 7922 5d29 0a20 2020 2020 2020  ", "y"]).       
+00014210: 203e 3e3e 2064 662e 7365 6c65 6374 2870   >>> df.select(p
+00014220: 6f77 2863 6f6c 2822 7822 292c 2063 6f6c  ow(col("x"), col
+00014230: 2822 7922 2929 2e61 6c69 6173 2822 7265  ("y")).alias("re
+00014240: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00014250: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00014260: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00014270: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00014280: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00014290: 2020 2020 2020 7c38 2e30 2020 2020 2020        |8.0      
+000142a0: 207c 0a20 2020 2020 2020 207c 3831 2e30   |.        |81.0
+000142b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+000142c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000142d0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+000142e0: 0a20 2020 2022 2222 0a20 2020 206e 756d  .    """.    num
+000142f0: 6265 7220 3d20 280a 2020 2020 2020 2020  ber = (.        
+00014300: 6c69 7428 6c65 6674 2920 6966 2069 7369  lit(left) if isi
+00014310: 6e73 7461 6e63 6528 6c65 6674 2c20 2869  nstance(left, (i
+00014320: 6e74 2c20 666c 6f61 7429 2920 656c 7365  nt, float)) else
+00014330: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00014340: 6c65 6674 2c20 2270 6f77 2229 0a20 2020  left, "pow").   
+00014350: 2029 0a20 2020 2070 6f77 6572 203d 2028   ).    power = (
+00014360: 0a20 2020 2020 2020 206c 6974 2872 6967  .        lit(rig
+00014370: 6874 2920 6966 2069 7369 6e73 7461 6e63  ht) if isinstanc
+00014380: 6528 7269 6768 742c 2028 696e 742c 2066  e(right, (int, f
+00014390: 6c6f 6174 2929 2065 6c73 6520 5f74 6f5f  loat)) else _to_
+000143a0: 636f 6c5f 6966 5f73 7472 2872 6967 6874  col_if_str(right
+000143b0: 2c20 2270 6f77 2229 0a20 2020 2029 0a20  , "pow").    ). 
+000143c0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000143d0: 6e28 2270 6f77 2229 286e 756d 6265 722c  n("pow")(number,
+000143e0: 2070 6f77 6572 290a 0a0a 6465 6620 726f   power)...def ro
+000143f0: 756e 6428 653a 2043 6f6c 756d 6e4f 724e  und(e: ColumnOrN
+00014400: 616d 652c 2073 6361 6c65 3a20 556e 696f  ame, scale: Unio
+00014410: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00014420: 696e 742c 2066 6c6f 6174 5d20 3d20 3029  int, float] = 0)
+00014430: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00014440: 2222 2252 6574 7572 6e73 2072 6f75 6e64  """Returns round
+00014450: 6564 2076 616c 7565 7320 6672 6f6d 2074  ed values from t
+00014460: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
+00014470: 756d 6e2e 0a0a 2020 2020 4578 616d 706c  umn...    Exampl
+00014480: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00014490: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000144a0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000144b0: 5b31 2e31 315d 2c20 5b32 2e32 325d 2c20  [1.11], [2.22], 
+000144c0: 5b33 2e33 335d 5d2c 2073 6368 656d 613d  [3.33]], schema=
+000144d0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+000144e0: 3e3e 2064 662e 7365 6c65 6374 2872 6f75  >> df.select(rou
+000144f0: 6e64 2863 6f6c 2822 6122 2929 2e61 6c69  nd(col("a")).ali
+00014500: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+00014510: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00014520: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00014530: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+00014540: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00014550: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e30  ---.        |1.0
+00014560: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00014570: 207c 322e 3020 2020 2020 2020 7c0a 2020   |2.0       |.  
+00014580: 2020 2020 2020 7c33 2e30 2020 2020 2020        |3.0      
+00014590: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000145a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000145b0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+000145c0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+000145d0: 636f 6c5f 6966 5f73 7472 2865 2c20 2272  col_if_str(e, "r
+000145e0: 6f75 6e64 2229 0a20 2020 2073 6361 6c65  ound").    scale
+000145f0: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
+00014600: 206c 6974 2873 6361 6c65 290a 2020 2020   lit(scale).    
+00014610: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00014620: 6528 7363 616c 652c 2028 696e 742c 2066  e(scale, (int, f
+00014630: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
+00014640: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+00014650: 7472 2873 6361 6c65 2c20 2272 6f75 6e64  tr(scale, "round
+00014660: 2229 0a20 2020 2029 0a20 2020 2072 6574  ").    ).    ret
+00014670: 7572 6e20 6275 696c 7469 6e28 2272 6f75  urn builtin("rou
+00014680: 6e64 2229 2863 2c20 7363 616c 655f 636f  nd")(c, scale_co
+00014690: 6c29 0a0a 0a64 6566 2073 706c 6974 280a  l)...def split(.
+000146a0: 2020 2020 7374 723a 2043 6f6c 756d 6e4f      str: ColumnO
+000146b0: 724e 616d 652c 0a20 2020 2070 6174 7465  rName,.    patte
+000146c0: 726e 3a20 436f 6c75 6d6e 4f72 4e61 6d65  rn: ColumnOrName
+000146d0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+000146e0: 2020 2022 2222 5370 6c69 7473 2061 2067     """Splits a g
+000146f0: 6976 656e 2073 7472 696e 6720 7769 7468  iven string with
+00014700: 2061 2067 6976 656e 2073 6570 6172 6174   a given separat
+00014710: 6f72 2061 6e64 2072 6574 7572 6e73 2074  or and returns t
+00014720: 6865 2072 6573 756c 7420 696e 2061 6e20  he result in an 
+00014730: 6172 7261 790a 2020 2020 6f66 2073 7472  array.    of str
+00014740: 696e 6773 2e20 546f 2073 7065 6369 6679  ings. To specify
+00014750: 2061 2073 7472 696e 6720 7365 7061 7261   a string separa
+00014760: 746f 722c 2075 7365 2074 6865 203a 6675  tor, use the :fu
+00014770: 6e63 3a60 6c69 7428 2960 2066 756e 6374  nc:`lit()` funct
+00014780: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
+00014790: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+000147a0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000147b0: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
+000147c0: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
+000147d0: 5b22 6d61 6e79 2d6d 616e 792d 776f 7264  ["many-many-word
+000147e0: 7322 2c20 222d 225d 2c20 5b22 6865 6c6c  s", "-"], ["hell
+000147f0: 6f2d 2d68 656c 6c6f 222c 2022 2d2d 225d  o--hello", "--"]
+00014800: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00014810: 2020 2073 6368 656d 613d 5b22 5622 2c20     schema=["V", 
+00014820: 2244 225d 2c0a 2020 2020 2020 2020 2e2e  "D"],.        ..
+00014830: 2e20 292e 7365 6c65 6374 2873 706c 6974  . ).select(split
+00014840: 2863 6f6c 2822 5622 292c 2063 6f6c 2822  (col("V"), col("
+00014850: 4422 2929 290a 2020 2020 2020 2020 3e3e  D"))).        >>
+00014860: 3e20 6466 2e73 686f 7728 290a 2020 2020  > df.show().    
+00014870: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00014880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00014890: 2020 2020 2020 7c22 5350 4c49 5428 2222        |"SPLIT(""
+000148a0: 5622 222c 2022 2244 2222 2922 2020 7c0a  V"", ""D"")"  |.
+000148b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000148c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000148d0: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
+000148e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000148f0: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+00014900: 6d61 6e79 222c 2020 2020 2020 2020 2020  many",          
+00014910: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00014920: 2022 6d61 6e79 222c 2020 2020 2020 2020   "many",        
+00014930: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00014940: 7c20 2022 776f 7264 7322 2020 2020 2020  |  "words"      
+00014950: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00014960: 2020 7c5d 2020 2020 2020 2020 2020 2020    |]            
+00014970: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00014980: 2020 2020 7c5b 2020 2020 2020 2020 2020      |[          
+00014990: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+000149a0: 2020 2020 2020 7c20 2022 6865 6c6c 6f22        |  "hello"
+000149b0: 2c20 2020 2020 2020 2020 2020 2020 7c0a  ,             |.
+000149c0: 2020 2020 2020 2020 7c20 2022 6865 6c6c          |  "hell
+000149d0: 6f22 2020 2020 2020 2020 2020 2020 2020  o"              
+000149e0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+000149f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a00: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00014a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00014a20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00014a30: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00014a40: 220a 2020 2020 7320 3d20 5f74 6f5f 636f  ".    s = _to_co
+00014a50: 6c5f 6966 5f73 7472 2873 7472 2c20 2273  l_if_str(str, "s
+00014a60: 706c 6974 2229 0a20 2020 2070 203d 205f  plit").    p = _
+00014a70: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
+00014a80: 7474 6572 6e2c 2022 7370 6c69 7422 290a  ttern, "split").
+00014a90: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00014aa0: 696e 2822 7370 6c69 7422 2928 732c 2070  in("split")(s, p
+00014ab0: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
+00014ac0: 6728 0a20 2020 2073 7472 3a20 436f 6c75  g(.    str: Colu
+00014ad0: 6d6e 4f72 4e61 6d65 2c20 706f 733a 2055  mnOrName, pos: U
+00014ae0: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
+00014af0: 5d2c 206c 656e 3a20 556e 696f 6e5b 436f  ], len: Union[Co
+00014b00: 6c75 6d6e 2c20 696e 745d 0a29 202d 3e20  lumn, int].) -> 
+00014b10: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00014b20: 6574 7572 6e73 2074 6865 2070 6f72 7469  eturns the porti
+00014b30: 6f6e 206f 6620 7468 6520 7374 7269 6e67  on of the string
+00014b40: 206f 7220 6269 6e61 7279 2076 616c 7565   or binary value
+00014b50: 2073 7472 2c20 7374 6172 7469 6e67 2066   str, starting f
+00014b60: 726f 6d20 7468 650a 2020 2020 6368 6172  rom the.    char
+00014b70: 6163 7465 722f 6279 7465 2073 7065 6369  acter/byte speci
+00014b80: 6669 6564 2062 7920 706f 732c 2077 6974  fied by pos, wit
+00014b90: 6820 6c69 6d69 7465 6420 6c65 6e67 7468  h limited length
+00014ba0: 2e20 5468 6520 6c65 6e67 7468 2073 686f  . The length sho
+00014bb0: 756c 6420 6265 2067 7265 6174 6572 0a20  uld be greater. 
+00014bc0: 2020 2074 6861 6e20 6f72 2065 7175 616c     than or equal
+00014bd0: 2074 6f20 7a65 726f 2e20 4966 2074 6865   to zero. If the
+00014be0: 206c 656e 6774 6820 6973 2061 206e 6567   length is a neg
+00014bf0: 6174 6976 6520 6e75 6d62 6572 2c20 7468  ative number, th
+00014c00: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+00014c10: 6e73 2061 6e0a 2020 2020 656d 7074 7920  ns an.    empty 
+00014c20: 7374 7269 6e67 2e0a 0a20 2020 204e 6f74  string...    Not
+00014c30: 653a 0a20 2020 2020 2020 2046 6f72 2060  e:.        For `
+00014c40: 6070 6f73 6060 2c20 3120 6973 2074 6865  `pos``, 1 is the
+00014c50: 2066 6972 7374 2063 6861 7261 6374 6572   first character
+00014c60: 206f 6620 7468 6520 7374 7269 6e67 2069   of the string i
+00014c70: 6e20 536e 6f77 666c 616b 6520 6461 7461  n Snowflake data
+00014c80: 6261 7365 2e0a 0a20 2020 203a 6675 6e63  base...    :func
+00014c90: 3a60 7375 6273 7472 6020 6973 2061 6e20  :`substr` is an 
+00014ca0: 616c 6961 7320 6f66 203a 6675 6e63 3a60  alias of :func:`
+00014cb0: 7375 6273 7472 696e 6760 2e0a 0a20 2020  substring`...   
+00014cc0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00014cd0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00014ce0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00014cf0: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00014d00: 2e20 2020 2020 5b22 6162 6322 2c20 2264  .     ["abc", "d
+00014d10: 6566 225d 2c0a 2020 2020 2020 2020 2e2e  ef"],.        ..
+00014d20: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
+00014d30: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
+00014d40: 292e 7365 6c65 6374 2873 7562 7374 7269  ).select(substri
+00014d50: 6e67 2863 6f6c 2822 5322 292c 2031 2c20  ng(col("S"), 1, 
+00014d60: 3129 290a 2020 2020 2020 2020 3e3e 3e20  1)).        >>> 
+00014d70: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+00014d80: 2020 2020 205b 526f 7728 5355 4253 5452       [Row(SUBSTR
+00014d90: 494e 4728 2253 222c 2031 2c20 3129 3d27  ING("S", 1, 1)='
+00014da0: 6127 292c 2052 6f77 2853 5542 5354 5249  a'), Row(SUBSTRI
+00014db0: 4e47 2822 5322 2c20 312c 2031 293d 2764  NG("S", 1, 1)='d
+00014dc0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00014dd0: 7320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  s = _to_col_if_s
+00014de0: 7472 2873 7472 2c20 2273 7562 7374 7269  tr(str, "substri
+00014df0: 6e67 2229 0a20 2020 2070 203d 2070 6f73  ng").    p = pos
+00014e00: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
+00014e10: 6f73 2c20 436f 6c75 6d6e 2920 656c 7365  os, Column) else
+00014e20: 206c 6974 2870 6f73 290a 2020 2020 6c65   lit(pos).    le
+00014e30: 6e67 7468 203d 206c 656e 2069 6620 6973  ngth = len if is
+00014e40: 696e 7374 616e 6365 286c 656e 2c20 436f  instance(len, Co
+00014e50: 6c75 6d6e 2920 656c 7365 206c 6974 286c  lumn) else lit(l
+00014e60: 656e 290a 2020 2020 7265 7475 726e 2062  en).    return b
+00014e70: 7569 6c74 696e 2822 7375 6273 7472 696e  uiltin("substrin
+00014e80: 6722 2928 732c 2070 2c20 6c65 6e67 7468  g")(s, p, length
+00014e90: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
+00014ea0: 675f 696e 6465 7828 0a20 2020 2074 6578  g_index(.    tex
+00014eb0: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
+00014ec0: 2064 656c 696d 3a20 436f 6c75 6d6e 4f72   delim: ColumnOr
+00014ed0: 4c69 7465 7261 6c53 7472 2c20 636f 756e  LiteralStr, coun
+00014ee0: 743a 2069 6e74 0a29 202d 3e20 436f 6c75  t: int.) -> Colu
+00014ef0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00014f00: 5265 7475 726e 7320 7468 6520 7375 6273  Returns the subs
+00014f10: 7472 696e 6720 6672 6f6d 2073 7472 696e  tring from strin
+00014f20: 6720 6060 7465 7874 6060 2062 6566 6f72  g ``text`` befor
+00014f30: 6520 6060 636f 756e 7460 6020 6f63 6375  e ``count`` occu
+00014f40: 7272 656e 6365 7320 6f66 2074 6865 2064  rrences of the d
+00014f50: 656c 696d 6974 6572 2060 6064 656c 696d  elimiter ``delim
+00014f60: 6060 2e0a 2020 2020 4966 2060 6063 6f75  ``..    If ``cou
+00014f70: 6e74 6060 2069 7320 706f 7369 7469 7665  nt`` is positive
+00014f80: 2c20 6576 6572 7974 6869 6e67 2074 6f20  , everything to 
+00014f90: 7468 6520 6c65 6674 206f 6620 7468 6520  the left of the 
+00014fa0: 6669 6e61 6c20 6465 6c69 6d69 7465 7220  final delimiter 
+00014fb0: 2863 6f75 6e74 696e 6720 6672 6f6d 206c  (counting from l
+00014fc0: 6566 7429 2069 730a 2020 2020 7265 7475  eft) is.    retu
+00014fd0: 726e 6564 2e20 4966 2060 6063 6f75 6e74  rned. If ``count
+00014fe0: 6060 2069 7320 6e65 6761 7469 7665 2c20  `` is negative, 
+00014ff0: 6576 6572 7974 6869 6e67 2074 6f20 7468  everything to th
+00015000: 6520 7269 6768 7420 6f66 2074 6865 2066  e right of the f
+00015010: 696e 616c 2064 656c 696d 6974 6572 2028  inal delimiter (
+00015020: 636f 756e 7469 6e67 2066 726f 6d20 7468  counting from th
+00015030: 650a 2020 2020 7269 6768 7429 2069 7320  e.    right) is 
+00015040: 7265 7475 726e 6564 2e20 4966 2060 6063  returned. If ``c
+00015050: 6f75 6e74 6060 2069 7320 7a65 726f 2c20  ount`` is zero, 
+00015060: 7265 7475 726e 7320 656d 7074 7920 7374  returns empty st
+00015070: 7269 6e67 2e0a 0a20 2020 2045 7861 6d70  ring...    Examp
+00015080: 6c65 2031 3a3a 0a20 2020 2020 2020 203e  le 1::.        >
+00015090: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000150a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000150b0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+000150c0: 2020 5b22 612e 622e 632e 6422 5d2c 0a20    ["a.b.c.d"],. 
+000150d0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+000150e0: 6368 656d 613d 5b22 5322 5d2c 0a20 2020  chema=["S"],.   
+000150f0: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
+00015100: 7428 7375 6273 7472 696e 675f 696e 6465  t(substring_inde
+00015110: 7828 636f 6c28 2253 2229 2c20 222e 222c  x(col("S"), ".",
+00015120: 2032 292e 616c 6961 7328 2272 6573 756c   2).alias("resul
+00015130: 7422 2929 0a20 2020 2020 2020 203e 3e3e  t")).        >>>
+00015140: 2064 662e 7368 6f77 2829 0a20 2020 2020   df.show().     
+00015150: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00015160: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00015170: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00015180: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00015190: 2020 7c61 2e62 2020 2020 2020 207c 0a20    |a.b       |. 
+000151a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000151b0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+000151c0: 4e4b 4c49 4e45 3e0a 0a20 2020 2045 7861  NKLINE>..    Exa
+000151d0: 6d70 6c65 2032 3a3a 0a20 2020 2020 2020  mple 2::.       
+000151e0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000151f0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00015200: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+00015210: 2020 2020 5b5b 2261 2e62 2e63 2e64 222c      [["a.b.c.d",
+00015220: 2022 2e22 5d5d 2c0a 2020 2020 2020 2020   "."]],.        
+00015230: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+00015240: 2253 222c 2022 6465 6c69 6d69 7465 7222  "S", "delimiter"
+00015250: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+00015260: 2e73 656c 6563 7428 7375 6273 7472 696e  .select(substrin
+00015270: 675f 696e 6465 7828 636f 6c28 2253 2229  g_index(col("S")
+00015280: 2c20 636f 6c28 2264 656c 696d 6974 6572  , col("delimiter
+00015290: 2229 2c20 3229 2e61 6c69 6173 2822 7265  "), 2).alias("re
+000152a0: 7375 6c74 2229 290a 2020 2020 2020 2020  sult")).        
+000152b0: 3e3e 3e20 6466 2e73 686f 7728 290a 2020  >>> df.show().  
+000152c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000152d0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+000152e0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+000152f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00015300: 2020 2020 207c 612e 6220 2020 2020 2020       |a.b       
+00015310: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00015320: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00015330: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00015340: 2222 0a20 2020 2073 203d 205f 746f 5f63  "".    s = _to_c
+00015350: 6f6c 5f69 665f 7374 7228 7465 7874 2c20  ol_if_str(text, 
+00015360: 2273 7562 7374 7269 6e67 5f69 6e64 6578  "substring_index
+00015370: 2229 0a20 2020 2073 7472 746f 6b5f 6172  ").    strtok_ar
+00015380: 7261 7920 3d20 6275 696c 7469 6e28 2273  ray = builtin("s
+00015390: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
+000153a0: 2873 2c20 6465 6c69 6d29 0a20 2020 2072  (s, delim).    r
+000153b0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+000153c0: 7272 6179 5f74 6f5f 7374 7269 6e67 2229  rray_to_string")
+000153d0: 280a 2020 2020 2020 2020 6275 696c 7469  (.        builti
+000153e0: 6e28 2261 7272 6179 5f73 6c69 6365 2229  n("array_slice")
+000153f0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+00015400: 7274 6f6b 5f61 7272 6179 2c0a 2020 2020  rtok_array,.    
+00015410: 2020 2020 2020 2020 3020 6966 2063 6f75          0 if cou
+00015420: 6e74 203e 3d20 3020 656c 7365 2062 7569  nt >= 0 else bui
+00015430: 6c74 696e 2822 6172 7261 795f 7369 7a65  ltin("array_size
+00015440: 2229 2873 7472 746f 6b5f 6172 7261 7929  ")(strtok_array)
+00015450: 202b 2063 6f75 6e74 2c0a 2020 2020 2020   + count,.      
+00015460: 2020 2020 2020 636f 756e 7420 6966 2063        count if c
+00015470: 6f75 6e74 203e 3d20 3020 656c 7365 2062  ount >= 0 else b
+00015480: 7569 6c74 696e 2822 6172 7261 795f 7369  uiltin("array_si
+00015490: 7a65 2229 2873 7472 746f 6b5f 6172 7261  ze")(strtok_arra
+000154a0: 7929 2c0a 2020 2020 2020 2020 292c 0a20  y),.        ),. 
+000154b0: 2020 2020 2020 2064 656c 696d 2c0a 2020         delim,.  
+000154c0: 2020 290a 0a0a 6465 6620 7265 6765 7870    )...def regexp
+000154d0: 5f63 6f75 6e74 280a 2020 2020 7375 626a  _count(.    subj
+000154e0: 6563 743a 2043 6f6c 756d 6e4f 724e 616d  ect: ColumnOrNam
+000154f0: 652c 0a20 2020 2070 6174 7465 726e 3a20  e,.    pattern: 
+00015500: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
+00015510: 7472 2c0a 2020 2020 706f 7369 7469 6f6e  tr,.    position
+00015520: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
+00015530: 696e 745d 203d 2031 2c0a 2020 2020 2a70  int] = 1,.    *p
+00015540: 6172 616d 6574 6572 733a 2043 6f6c 756d  arameters: Colum
+00015550: 6e4f 724c 6974 6572 616c 2c0a 2920 2d3e  nOrLiteral,.) ->
+00015560: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00015570: 5265 7475 726e 7320 7468 6520 6e75 6d62  Returns the numb
+00015580: 6572 206f 6620 7469 6d65 7320 7468 6174  er of times that
+00015590: 2061 2070 6174 7465 726e 206f 6363 7572   a pattern occur
+000155a0: 7320 696e 2074 6865 2073 7562 6a65 6374  s in the subject
+000155b0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000155c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+000155d0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+000155e0: 7365 6c65 6374 202a 2066 726f 6d20 7661  select * from va
+000155f0: 6c75 6573 2827 6170 706c 6527 292c 2827  lues('apple'),('
+00015600: 6261 6e61 6e61 2729 2c28 2770 6561 6368  banana'),('peach
+00015610: 2729 2061 7320 5428 6129 2229 0a20 2020  ') as T(a)").   
+00015620: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00015630: 6374 2872 6567 6578 705f 636f 756e 7428  ct(regexp_count(
+00015640: 636f 6c28 2261 2229 2c20 2261 2229 2e61  col("a"), "a").a
+00015650: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00015660: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00015670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00015680: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00015690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000156a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+000156b0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+000156c0: 2020 207c 3320 2020 2020 2020 2020 7c0a     |3         |.
+000156d0: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
+000156e0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+000156f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00015700: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00015710: 2020 2222 220a 2020 2020 7371 6c5f 6675    """.    sql_fu
+00015720: 6e63 5f6e 616d 6520 3d20 2272 6567 6578  nc_name = "regex
+00015730: 705f 636f 756e 7422 0a20 2020 2073 7562  p_count".    sub
+00015740: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00015750: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
+00015760: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
+00015770: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
+00015780: 0a20 2020 2070 6f73 203d 206c 6974 2870  .    pos = lit(p
+00015790: 6f73 6974 696f 6e29 0a0a 2020 2020 7061  osition)..    pa
+000157a0: 7261 6d73 203d 205b 6c69 7428 7029 2066  rams = [lit(p) f
+000157b0: 6f72 2070 2069 6e20 7061 7261 6d65 7465  or p in paramete
+000157c0: 7273 5d0a 2020 2020 7265 7475 726e 2062  rs].    return b
+000157d0: 7569 6c74 696e 2873 716c 5f66 756e 635f  uiltin(sql_func_
+000157e0: 6e61 6d65 2928 7375 622c 2070 6174 2c20  name)(sub, pat, 
+000157f0: 706f 732c 202a 7061 7261 6d73 290a 0a0a  pos, *params)...
+00015800: 6465 6620 7265 6765 7870 5f65 7874 7261  def regexp_extra
+00015810: 6374 280a 2020 2020 7661 6c75 653a 2043  ct(.    value: C
+00015820: 6f6c 756d 6e4f 724c 6974 6572 616c 5374  olumnOrLiteralSt
+00015830: 722c 2072 6567 6578 703a 2043 6f6c 756d  r, regexp: Colum
+00015840: 6e4f 724c 6974 6572 616c 5374 722c 2069  nOrLiteralStr, i
+00015850: 6478 3a20 696e 740a 2920 2d3e 2043 6f6c  dx: int.) -> Col
+00015860: 756d 6e3a 0a20 2020 2072 2222 220a 2020  umn:.    r""".  
+00015870: 2020 4578 7472 6163 7420 6120 7370 6563    Extract a spec
+00015880: 6966 6963 2067 726f 7570 206d 6174 6368  ific group match
+00015890: 6564 2062 7920 6120 7265 6765 782c 2066  ed by a regex, f
+000158a0: 726f 6d20 7468 6520 7370 6563 6966 6965  rom the specifie
+000158b0: 6420 7374 7269 6e67 2063 6f6c 756d 6e2e  d string column.
+000158c0: 0a20 2020 2049 6620 7468 6520 7265 6765  .    If the rege
+000158d0: 7820 6469 6420 6e6f 7420 6d61 7463 682c  x did not match,
+000158e0: 206f 7220 7468 6520 7370 6563 6966 6965   or the specifie
+000158f0: 6420 6772 6f75 7020 6469 6420 6e6f 7420  d group did not 
+00015900: 6d61 7463 682c 0a20 2020 2061 6e20 656d  match,.    an em
+00015910: 7074 7920 7374 7269 6e67 2069 7320 7265  pty string is re
+00015920: 7475 726e 6564 2e0a 0a20 2020 2045 7861  turned...    Exa
+00015930: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00015940: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00015950: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+00015960: 7469 6f6e 7320 696d 706f 7274 2072 6567  tions import reg
+00015970: 6578 705f 6578 7472 6163 740a 2020 2020  exp_extract.    
+00015980: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00015990: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+000159a0: 7261 6d65 285b 5b22 6964 5f32 305f 3330  rame([["id_20_30
+000159b0: 222c 2031 305d 2c20 5b22 6964 5f34 305f  ", 10], ["id_40_
+000159c0: 3530 222c 2033 305d 5d2c 205b 2269 6422  50", 30]], ["id"
+000159d0: 2c20 2261 6765 225d 290a 2020 2020 2020  , "age"]).      
+000159e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000159f0: 7265 6765 7870 5f65 7874 7261 6374 2822  regexp_extract("
+00015a00: 6964 222c 2072 2228 5c64 2b29 222c 2031  id", r"(\d+)", 1
+00015a10: 292e 616c 6961 7328 2252 4553 2229 292e  ).alias("RES")).
+00015a20: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00015a30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015a40: 207c 2252 4553 2220 207c 0a20 2020 2020   |"RES"  |.     
+00015a50: 2020 202d 2d2d 2d2d 2d2d 2d2d 0a20 2020     ---------.   
+00015a60: 2020 2020 207c 3230 2020 2020 207c 0a20       |20     |. 
+00015a70: 2020 2020 2020 207c 3430 2020 2020 207c         |40     |
+00015a80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015a90: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00015aa0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00015ab0: 2020 2076 616c 7565 203d 205f 746f 5f63     value = _to_c
+00015ac0: 6f6c 5f69 665f 7374 7228 7661 6c75 652c  ol_if_str(value,
+00015ad0: 2022 7265 6765 7870 5f65 7874 7261 6374   "regexp_extract
+00015ae0: 2229 0a20 2020 2072 6567 6578 7020 3d20  ").    regexp = 
+00015af0: 5f74 6f5f 636f 6c5f 6966 5f6c 6974 2872  _to_col_if_lit(r
+00015b00: 6567 6578 702c 2022 7265 6765 7870 5f65  egexp, "regexp_e
+00015b10: 7874 7261 6374 2229 0a20 2020 2069 6478  xtract").    idx
+00015b20: 203d 205f 746f 5f63 6f6c 5f69 665f 6c69   = _to_col_if_li
+00015b30: 7428 6964 782c 2022 7265 6765 7870 5f65  t(idx, "regexp_e
+00015b40: 7874 7261 6374 2229 0a20 2020 2072 6574  xtract").    ret
+00015b50: 7572 6e20 636f 616c 6573 6365 280a 2020  urn coalesce(.  
+00015b60: 2020 2020 2020 6361 6c6c 5f62 7569 6c74        call_built
+00015b70: 696e 2822 7265 6765 7870 5f73 7562 7374  in("regexp_subst
+00015b80: 7222 2c20 7661 6c75 652c 2072 6567 6578  r", value, regex
+00015b90: 702c 206c 6974 2831 292c 206c 6974 2831  p, lit(1), lit(1
+00015ba0: 292c 206c 6974 2822 6522 292c 2069 6478  ), lit("e"), idx
+00015bb0: 292c 0a20 2020 2020 2020 206c 6974 2822  ),.        lit("
+00015bc0: 2229 2c0a 2020 2020 290a 0a0a 6465 6620  "),.    )...def 
+00015bd0: 7265 6765 7870 5f72 6570 6c61 6365 280a  regexp_replace(.
+00015be0: 2020 2020 7375 626a 6563 743a 2043 6f6c      subject: Col
+00015bf0: 756d 6e4f 724e 616d 652c 0a20 2020 2070  umnOrName,.    p
+00015c00: 6174 7465 726e 3a20 436f 6c75 6d6e 4f72  attern: ColumnOr
+00015c10: 4c69 7465 7261 6c53 7472 2c0a 2020 2020  LiteralStr,.    
+00015c20: 7265 706c 6163 656d 656e 743a 2043 6f6c  replacement: Col
+00015c30: 756d 6e4f 724c 6974 6572 616c 5374 7220  umnOrLiteralStr 
+00015c40: 3d20 2222 2c0a 2020 2020 706f 7369 7469  = "",.    positi
+00015c50: 6f6e 3a20 556e 696f 6e5b 436f 6c75 6d6e  on: Union[Column
+00015c60: 2c20 696e 745d 203d 2031 2c0a 2020 2020  , int] = 1,.    
+00015c70: 6f63 6375 7272 656e 6365 733a 2055 6e69  occurrences: Uni
+00015c80: 6f6e 5b43 6f6c 756d 6e2c 2069 6e74 5d20  on[Column, int] 
+00015c90: 3d20 302c 0a20 2020 202a 7061 7261 6d65  = 0,.    *parame
+00015ca0: 7465 7273 3a20 436f 6c75 6d6e 4f72 4c69  ters: ColumnOrLi
+00015cb0: 7465 7261 6c2c 0a29 202d 3e20 436f 6c75  teral,.) -> Colu
+00015cc0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00015cd0: 6e73 2074 6865 2073 7562 6a65 6374 2077  ns the subject w
+00015ce0: 6974 6820 7468 6520 7370 6563 6966 6965  ith the specifie
+00015cf0: 6420 7061 7474 6572 6e20 286f 7220 616c  d pattern (or al
+00015d00: 6c20 6f63 6375 7272 656e 6365 7320 6f66  l occurrences of
+00015d10: 2074 6865 2070 6174 7465 726e 2920 6569   the pattern) ei
+00015d20: 7468 6572 2072 656d 6f76 6564 206f 7220  ther removed or 
+00015d30: 7265 706c 6163 6564 2062 7920 6120 7265  replaced by a re
+00015d40: 706c 6163 656d 656e 7420 7374 7269 6e67  placement string
+00015d50: 2e0a 2020 2020 4966 206e 6f20 6d61 7463  ..    If no matc
+00015d60: 6865 7320 6172 6520 666f 756e 642c 2072  hes are found, r
+00015d70: 6574 7572 6e73 2074 6865 206f 7269 6769  eturns the origi
+00015d80: 6e61 6c20 7375 626a 6563 742e 0a0a 2020  nal subject...  
+00015d90: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00015da0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00015db0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00015dc0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+00015dd0: 2e2e 2020 2020 205b 5b22 4974 2077 6173  ..     [["It was
+00015de0: 2074 6865 2062 6573 7420 6f66 2074 696d   the best of tim
+00015df0: 6573 2c20 6974 2077 6173 2074 6865 2077  es, it was the w
+00015e00: 6f72 7374 206f 6620 7469 6d65 7322 5d5d  orst of times"]]
+00015e10: 2c20 7363 6865 6d61 3d5b 2261 225d 0a20  , schema=["a"]. 
+00015e20: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00015e30: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00015e40: 6374 2872 6567 6578 705f 7265 706c 6163  ct(regexp_replac
+00015e50: 6528 636f 6c28 2261 2229 2c20 6c69 7428  e(col("a"), lit(
+00015e60: 2228 2029 7b31 2c7d 2229 2c20 6c69 7428  "( ){1,}"), lit(
+00015e70: 2222 2929 2e61 6c69 6173 2822 7265 7375  "")).alias("resu
+00015e80: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00015e90: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00015ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ec0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00015ed0: 4c54 2220 2020 2020 2020 2020 2020 2020  LT"             
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00015f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00015f30: 2020 2020 7c49 7477 6173 7468 6562 6573      |Itwasthebes
+00015f40: 746f 6674 696d 6573 2c69 7477 6173 7468  toftimes,itwasth
+00015f50: 6577 6f72 7374 6f66 7469 6d65 7320 207c  eworstoftimes  |
+00015f60: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00015fa0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00015fb0: 220a 2020 2020 7371 6c5f 6675 6e63 5f6e  ".    sql_func_n
+00015fc0: 616d 6520 3d20 2272 6567 6578 705f 7265  ame = "regexp_re
+00015fd0: 706c 6163 6522 0a20 2020 2073 7562 203d  place".    sub =
+00015fe0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00015ff0: 7375 626a 6563 742c 2073 716c 5f66 756e  subject, sql_fun
+00016000: 635f 6e61 6d65 290a 2020 2020 7061 7420  c_name).    pat 
+00016010: 3d20 6c69 7428 7061 7474 6572 6e29 0a20  = lit(pattern). 
+00016020: 2020 2072 6570 203d 206c 6974 2872 6570     rep = lit(rep
+00016030: 6c61 6365 6d65 6e74 290a 2020 2020 706f  lacement).    po
+00016040: 7320 3d20 6c69 7428 706f 7369 7469 6f6e  s = lit(position
+00016050: 290a 2020 2020 6f63 6320 3d20 6c69 7428  ).    occ = lit(
+00016060: 6f63 6375 7272 656e 6365 7329 0a0a 2020  occurrences)..  
+00016070: 2020 7061 7261 6d73 203d 205b 6c69 7428    params = [lit(
+00016080: 7029 2066 6f72 2070 2069 6e20 7061 7261  p) for p in para
+00016090: 6d65 7465 7273 5d0a 2020 2020 7265 7475  meters].    retu
+000160a0: 726e 2062 7569 6c74 696e 2873 716c 5f66  rn builtin(sql_f
+000160b0: 756e 635f 6e61 6d65 2928 7375 622c 2070  unc_name)(sub, p
+000160c0: 6174 2c20 7265 702c 2070 6f73 2c20 6f63  at, rep, pos, oc
+000160d0: 632c 202a 7061 7261 6d73 290a 0a0a 6465  c, *params)...de
+000160e0: 6620 7265 706c 6163 6528 0a20 2020 2073  f replace(.    s
+000160f0: 7562 6a65 6374 3a20 436f 6c75 6d6e 4f72  ubject: ColumnOr
+00016100: 4e61 6d65 2c0a 2020 2020 7061 7474 6572  Name,.    patter
+00016110: 6e3a 2043 6f6c 756d 6e4f 724c 6974 6572  n: ColumnOrLiter
+00016120: 616c 5374 722c 0a20 2020 2072 6570 6c61  alStr,.    repla
+00016130: 6365 6d65 6e74 3a20 436f 6c75 6d6e 4f72  cement: ColumnOr
+00016140: 4c69 7465 7261 6c53 7472 203d 2022 222c  LiteralStr = "",
+00016150: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
+00016160: 2020 2222 220a 2020 2020 5265 6d6f 7665    """.    Remove
+00016170: 7320 616c 6c20 6f63 6375 7272 656e 6365  s all occurrence
+00016180: 7320 6f66 2061 2073 7065 6369 6669 6564  s of a specified
+00016190: 2073 7562 6a65 6374 2061 6e64 206f 7074   subject and opt
+000161a0: 696f 6e61 6c6c 7920 7265 706c 6163 6573  ionally replaces
+000161b0: 2074 6865 6d20 7769 7468 2072 6570 6c61   them with repla
+000161c0: 6365 6d65 6e74 2e0a 0a20 2020 2045 7861  cement...    Exa
+000161d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000161e0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000161f0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00016200: 6528 5b5b 2261 7070 6c65 225d 2c20 5b22  e([["apple"], ["
+00016210: 6170 706c 6520 7069 6522 5d2c 205b 2261  apple pie"], ["a
+00016220: 7070 6c65 206a 7569 6365 225d 5d2c 2073  pple juice"]], s
+00016230: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00016240: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00016250: 6374 2872 6570 6c61 6365 2863 6f6c 2822  ct(replace(col("
+00016260: 6122 292c 2022 6170 706c 6522 2c20 226f  a"), "apple", "o
+00016270: 7261 6e67 6522 292e 616c 6961 7328 2272  range").alias("r
+00016280: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00016290: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000162a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000162b0: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
+000162c0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000162d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000162e0: 2020 207c 6f72 616e 6765 2020 2020 2020     |orange      
+000162f0: 2020 7c0a 2020 2020 2020 2020 7c6f 7261    |.        |ora
+00016300: 6e67 6520 7069 6520 2020 207c 0a20 2020  nge pie    |.   
+00016310: 2020 2020 207c 6f72 616e 6765 206a 7569       |orange jui
+00016320: 6365 2020 7c0a 2020 2020 2020 2020 2d2d  ce  |.        --
+00016330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00016340: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00016350: 453e 0a20 2020 2022 2222 0a20 2020 2073  E>.    """.    s
+00016360: 716c 5f66 756e 635f 6e61 6d65 203d 2022  ql_func_name = "
+00016370: 7265 706c 6163 6522 0a20 2020 2073 7562  replace".    sub
+00016380: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00016390: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
+000163a0: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
+000163b0: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
+000163c0: 0a20 2020 2072 6570 203d 206c 6974 2872  .    rep = lit(r
+000163d0: 6570 6c61 6365 6d65 6e74 290a 2020 2020  eplacement).    
+000163e0: 7265 7475 726e 2062 7569 6c74 696e 2873  return builtin(s
+000163f0: 716c 5f66 756e 635f 6e61 6d65 2928 7375  ql_func_name)(su
+00016400: 622c 2070 6174 2c20 7265 7029 0a0a 0a64  b, pat, rep)...d
+00016410: 6566 2063 6861 7269 6e64 6578 280a 2020  ef charindex(.  
+00016420: 2020 7461 7267 6574 5f65 7870 723a 2043    target_expr: C
+00016430: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
+00016440: 2073 6f75 7263 655f 6578 7072 3a20 436f   source_expr: Co
+00016450: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
+00016460: 706f 7369 7469 6f6e 3a20 4f70 7469 6f6e  position: Option
+00016470: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e2c  al[Union[Column,
+00016480: 2069 6e74 5d5d 203d 204e 6f6e 652c 0a29   int]] = None,.)
+00016490: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+000164a0: 2222 2253 6561 7263 6865 7320 666f 7220  """Searches for 
+000164b0: 6060 7461 7267 6574 5f65 7870 7260 6020  ``target_expr`` 
+000164c0: 696e 2060 6073 6f75 7263 655f 6578 7072  in ``source_expr
+000164d0: 6060 2061 6e64 2c20 6966 2073 7563 6365  `` and, if succe
+000164e0: 7373 6675 6c2c 0a20 2020 2072 6574 7572  ssful,.    retur
+000164f0: 6e73 2074 6865 2070 6f73 6974 696f 6e20  ns the position 
+00016500: 2831 2d62 6173 6564 2920 6f66 2074 6865  (1-based) of the
+00016510: 2060 6074 6172 6765 745f 6578 7072 6060   ``target_expr``
+00016520: 2069 6e20 6060 736f 7572 6365 5f65 7870   in ``source_exp
+00016530: 7260 602e 0a0a 2020 2020 4172 6773 3a0a  r``...    Args:.
+00016540: 2020 2020 2020 2020 7461 7267 6574 5f65          target_e
+00016550: 7870 723a 2041 2073 7472 696e 6720 6f72  xpr: A string or
+00016560: 2062 696e 6172 7920 6578 7072 6573 7369   binary expressi
+00016570: 6f6e 2072 6570 7265 7365 6e74 696e 6720  on representing 
+00016580: 7468 6520 7661 6c75 6520 746f 206c 6f6f  the value to loo
+00016590: 6b20 666f 722e 0a20 2020 2020 2020 2073  k for..        s
+000165a0: 6f75 7263 655f 6578 7072 3a20 4120 7374  ource_expr: A st
+000165b0: 7269 6e67 206f 7220 6269 6e61 7279 2065  ring or binary e
+000165c0: 7870 7265 7373 696f 6e20 7265 7072 6573  xpression repres
+000165d0: 656e 7469 6e67 2074 6865 2076 616c 7565  enting the value
+000165e0: 2074 6f20 7365 6172 6368 2e0a 2020 2020   to search..    
+000165f0: 2020 2020 706f 7369 7469 6f6e 3a20 4120      position: A 
+00016600: 6e75 6d62 6572 2069 6e64 6963 6174 696f  number indicatio
+00016610: 6e20 7468 6520 706f 7369 7469 6f6e 2028  n the position (
+00016620: 312d 6261 7365 6429 2066 726f 6d20 7768  1-based) from wh
+00016630: 6572 6520 746f 2073 7461 7274 2074 6865  ere to start the
+00016640: 2073 6561 7263 682e 2044 6566 6175 6c74   search. Default
+00016650: 7320 746f 204e 6f6e 652e 0a0a 2020 2020  s to None...    
+00016660: 4578 616d 706c 6573 3a3a 0a20 2020 2020  Examples::.     
+00016670: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00016680: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00016690: 7261 6d65 285b 2262 616e 616e 6122 5d2c  rame(["banana"],
+000166a0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
+000166b0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+000166c0: 6c65 6374 2863 6861 7269 6e64 6578 286c  lect(charindex(l
+000166d0: 6974 2822 616e 2229 2c20 6466 2e61 2c20  it("an"), df.a, 
+000166e0: 3129 2e61 735f 2822 7265 7375 6c74 2229  1).as_("result")
+000166f0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00016700: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00016710: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00016720: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00016730: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016740: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
+00016750: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00016760: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00016770: 4c49 4e45 3e0a 0a20 2020 2020 2020 203e  LINE>..        >
+00016780: 3e3e 2064 662e 7365 6c65 6374 2863 6861  >> df.select(cha
+00016790: 7269 6e64 6578 286c 6974 2822 616e 2229  rindex(lit("an")
+000167a0: 2c20 6466 2e61 2c20 3329 2e61 735f 2822  , df.a, 3).as_("
+000167b0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+000167c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000167d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+000167e0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000167f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00016800: 2020 2020 2020 2020 7c34 2020 2020 2020          |4      
+00016810: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00016820: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00016830: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00016840: 2020 2222 220a 2020 2020 7420 3d20 5f74    """.    t = _t
+00016850: 6f5f 636f 6c5f 6966 5f73 7472 2874 6172  o_col_if_str(tar
+00016860: 6765 745f 6578 7072 2c20 2263 6861 7269  get_expr, "chari
+00016870: 6e64 6578 2229 0a20 2020 2073 203d 205f  ndex").    s = _
+00016880: 746f 5f63 6f6c 5f69 665f 7374 7228 736f  to_col_if_str(so
+00016890: 7572 6365 5f65 7870 722c 2022 6368 6172  urce_expr, "char
+000168a0: 696e 6465 7822 290a 2020 2020 7265 7475  index").    retu
+000168b0: 726e 2028 0a20 2020 2020 2020 2062 7569  rn (.        bui
+000168c0: 6c74 696e 2822 6368 6172 696e 6465 7822  ltin("charindex"
+000168d0: 2928 742c 2073 2c20 6c69 7428 706f 7369  )(t, s, lit(posi
+000168e0: 7469 6f6e 2929 0a20 2020 2020 2020 2069  tion)).        i
+000168f0: 6620 706f 7369 7469 6f6e 2069 7320 6e6f  f position is no
+00016900: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
+00016910: 6c73 6520 6275 696c 7469 6e28 2263 6861  lse builtin("cha
+00016920: 7269 6e64 6578 2229 2874 2c20 7329 0a20  rindex")(t, s). 
+00016930: 2020 2029 0a0a 0a64 6566 2063 6f6c 6c61     )...def colla
+00016940: 7465 2865 3a20 436f 6c75 6d6e 2c20 636f  te(e: Column, co
+00016950: 6c6c 6174 696f 6e5f 7370 6563 3a20 7374  llation_spec: st
+00016960: 7229 202d 3e20 436f 6c75 6d6e 3a0a 2020  r) -> Column:.  
+00016970: 2020 2222 2252 6574 7572 6e73 2061 2063    """Returns a c
+00016980: 6f70 7920 6f66 2074 6865 206f 7269 6769  opy of the origi
+00016990: 6e61 6c20 3a63 6c61 7373 3a60 436f 6c75  nal :class:`Colu
+000169a0: 6d6e 6020 7769 7468 2074 6865 2073 7065  mn` with the spe
+000169b0: 6369 6669 6564 2060 6063 6f6c 6c61 7469  cified ``collati
+000169c0: 6f6e 5f73 7065 6360 600a 2020 2020 7072  on_spec``.    pr
+000169d0: 6f70 6572 7479 2c20 7261 7468 6572 2074  operty, rather t
+000169e0: 6861 6e20 7468 6520 6f72 6967 696e 616c  han the original
+000169f0: 2063 6f6c 6c61 7469 6f6e 2073 7065 6369   collation speci
+00016a00: 6669 6361 7469 6f6e 2070 726f 7065 7274  fication propert
+00016a10: 792e 0a0a 2020 2020 466f 7220 6465 7461  y...    For deta
+00016a20: 696c 732c 2073 6565 2074 6865 2053 6e6f  ils, see the Sno
+00016a30: 7766 6c61 6b65 2064 6f63 756d 656e 7461  wflake documenta
+00016a40: 7469 6f6e 206f 6e0a 2020 2020 6063 6f6c  tion on.    `col
+00016a50: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
+00016a60: 7469 6f6e 7320 3c68 7474 7073 3a2f 2f64  tions <https://d
+00016a70: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
+00016a80: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
+00016a90: 6365 2f63 6f6c 6c61 7469 6f6e 2e68 746d  ce/collation.htm
+00016aa0: 6c23 6c61 6265 6c2d 636f 6c6c 6174 696f  l#label-collatio
+00016ab0: 6e2d 7370 6563 6966 6963 6174 696f 6e3e  n-specification>
+00016ac0: 605f 2e0a 0a20 2020 2045 7861 6d70 6c65  `_...    Example
+00016ad0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+00016ae0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00016af0: 7465 5f64 6174 6166 7261 6d65 285b 27c3  te_dataframe(['.
+00016b00: b127 5d2c 2073 6368 656d 613d 5b27 7627  .'], schema=['v'
+00016b10: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00016b20: 662e 7365 6c65 6374 2864 662e 7620 3d3d  f.select(df.v ==
+00016b30: 206c 6974 2827 c391 2729 2c20 636f 6c6c   lit('..'), coll
+00016b40: 6174 6528 6466 2e76 2c20 2773 702d 7570  ate(df.v, 'sp-up
+00016b50: 7065 7227 2920 3d3d 206c 6974 2827 c391  per') == lit('..
+00016b60: 2729 292e 7368 6f77 2829 0a20 2020 2020  ')).show().     
+00016b70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00016b80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00016bb0: 2020 2020 2020 7c22 2822 2256 2222 203d        |"(""V"" =
+00016bc0: 2027 c391 2729 2220 207c 2228 434f 4c4c   '..')"  |"(COLL
+00016bd0: 4154 4528 2222 5622 222c 2027 5350 2d55  ATE(""V"", 'SP-U
+00016be0: 5050 4552 2729 203d 2027 c391 2729 2220  PPER') = '..')" 
+00016bf0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00016c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00016c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00016c40: 2020 2020 2020 207c 2243 4f4e 4341 545f         |"CONCAT_
-00016c50: 5753 2827 2c27 2c20 2222 4122 222c 2022  WS(',', ""A"", "
-00016c60: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
-00016c70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00016c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016c90: 2d2d 2d2d 0a20 2020 2020 2020 207c 4865  ----.        |He
-00016ca0: 6c6c 6f2c 576f 726c 6420 2020 2020 2020  llo,World       
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00016cc0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00016cf0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
-00016d00: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00016d10: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00016d20: 6461 7461 6672 616d 6528 5b5b 2748 656c  dataframe([['Hel
-00016d30: 6c6f 272c 2027 576f 726c 6427 2c20 272c  lo', 'World', ',
-00016d40: 275d 5d2c 2073 6368 656d 613d 5b27 6127  ']], schema=['a'
-00016d50: 2c20 2762 272c 2027 7365 7027 5d29 0a20  , 'b', 'sep']). 
-00016d60: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00016d70: 6c65 6374 2863 6f6e 6361 745f 7773 2827  lect(concat_ws('
-00016d80: 7365 7027 2c20 6466 2e61 2c20 6466 2e62  sep', df.a, df.b
-00016d90: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00016da0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00016db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016dc0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00016dd0: 207c 2243 4f4e 4341 545f 5753 2822 2253   |"CONCAT_WS(""S
-00016de0: 4550 2222 2c20 2222 4122 222c 2022 2242  EP"", ""A"", ""B
-00016df0: 2222 2922 2020 7c0a 2020 2020 2020 2020  "")"  |.        
-00016e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016e20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00016e30: 4865 6c6c 6f2c 576f 726c 6420 2020 2020  Hello,World     
-00016e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00016e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016e80: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00016e90: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00016ea0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
-00016eb0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-00016ec0: 2c20 2263 6f6e 6361 745f 7773 2229 2066  , "concat_ws") f
-00016ed0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
-00016ee0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00016ef0: 2822 636f 6e63 6174 5f77 7322 2928 2a63  ("concat_ws")(*c
-00016f00: 6f6c 756d 6e73 290a 0a0a 6465 6620 7472  olumns)...def tr
-00016f10: 616e 736c 6174 6528 0a20 2020 2073 7263  anslate(.    src
-00016f20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
-00016f30: 2020 2020 736f 7572 6365 5f61 6c70 6861      source_alpha
-00016f40: 6265 743a 2043 6f6c 756d 6e4f 724e 616d  bet: ColumnOrNam
-00016f50: 652c 0a20 2020 2074 6172 6765 745f 616c  e,.    target_al
-00016f60: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
-00016f70: 4e61 6d65 2c0a 2920 2d3e 2043 6f6c 756d  Name,.) -> Colum
-00016f80: 6e3a 0a20 2020 2022 2222 5472 616e 736c  n:.    """Transl
-00016f90: 6174 6573 2073 7263 2066 726f 6d20 7468  ates src from th
-00016fa0: 6520 6368 6172 6163 7465 7273 2069 6e20  e characters in 
-00016fb0: 736f 7572 6365 5f61 6c70 6861 6265 7420  source_alphabet 
-00016fc0: 746f 2074 6865 2063 6861 7261 6374 6572  to the character
-00016fd0: 7320 696e 0a20 2020 2074 6172 6765 745f  s in.    target_
-00016fe0: 616c 7068 6162 6574 2e20 4561 6368 2063  alphabet. Each c
-00016ff0: 6861 7261 6374 6572 206d 6174 6368 696e  haracter matchin
-00017000: 6720 6120 6368 6172 6163 7465 7220 6174  g a character at
-00017010: 2070 6f73 6974 696f 6e20 6920 696e 2074   position i in t
-00017020: 6865 2073 6f75 7263 655f 616c 7068 6162  he source_alphab
-00017030: 6574 2069 7320 7265 706c 6163 6564 0a20  et is replaced. 
-00017040: 2020 2077 6974 6820 7468 6520 6368 6172     with the char
-00017050: 6163 7465 7220 6174 2070 6f73 6974 696f  acter at positio
-00017060: 6e20 6920 696e 2074 6865 2074 6172 6765  n i in the targe
-00017070: 745f 616c 7068 6162 6574 2e20 4966 2074  t_alphabet. If t
-00017080: 6172 6765 745f 616c 7068 6162 6574 2069  arget_alphabet i
-00017090: 7320 7368 6f72 7465 722c 2061 6e64 2074  s shorter, and t
-000170a0: 6865 7265 2069 7320 6e6f 2063 6f72 7265  here is no corre
-000170b0: 7370 6f6e 6469 6e67 0a20 2020 2063 6861  sponding.    cha
-000170c0: 7261 6374 6572 2074 6865 2063 6861 7261  racter the chara
-000170d0: 6374 6572 2069 7320 6f6d 6974 7465 642e  cter is omitted.
-000170e0: 2074 6172 6765 745f 616c 7068 6162 6574   target_alphabet
-000170f0: 2063 616e 206e 6f74 2062 6520 6c6f 6e67   can not be long
-00017100: 6572 2074 6861 6e20 736f 7572 6365 5f61  er than source_a
-00017110: 6c70 6861 6265 742e 0a0a 2020 2020 4578  lphabet...    Ex
-00017120: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00017130: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00017140: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00017150: 6d65 285b 2261 6263 6465 6622 2c20 2261  me(["abcdef", "a
-00017160: 6262 6122 5d2c 2073 6368 656d 613d 5b22  bba"], schema=["
-00017170: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00017180: 2064 662e 7365 6c65 6374 2874 7261 6e73   df.select(trans
-00017190: 6c61 7465 2863 6f6c 2822 6122 292c 206c  late(col("a"), l
-000171a0: 6974 2822 6162 6322 292c 206c 6974 2822  it("abc"), lit("
-000171b0: 4142 4322 2929 2e61 735f 2822 616e 7322  ABC")).as_("ans"
-000171c0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-000171d0: 2020 2020 205b 526f 7728 414e 533d 2741       [Row(ANS='A
-000171e0: 4243 6465 6627 292c 2052 6f77 2841 4e53  BCdef'), Row(ANS
-000171f0: 3d27 4142 4241 2729 5d0a 0a20 2020 2020  ='ABBA')]..     
-00017200: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00017210: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00017220: 7261 6d65 285b 2266 696c 6520 7769 7468  rame(["file with
-00017230: 2073 7061 6365 732e 7478 7422 2c20 225c   spaces.txt", "\
-00017240: 5c74 7465 7374 225d 2c20 7363 6865 6d61  \ttest"], schema
-00017250: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00017260: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-00017270: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
-00017280: 2c20 6c69 7428 2220 5c5c 7422 292c 206c  , lit(" \\t"), l
-00017290: 6974 2822 5f22 2929 2e61 735f 2822 616e  it("_")).as_("an
-000172a0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-000172b0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-000172c0: 2766 696c 655f 7769 7468 5f73 7061 6365  'file_with_space
-000172d0: 732e 7478 7427 292c 2052 6f77 2841 4e53  s.txt'), Row(ANS
-000172e0: 3d27 7465 7374 2729 5d0a 0a20 2020 2022  ='test')]..    "
-000172f0: 2222 0a20 2020 2073 6f75 7263 6520 3d20  "".    source = 
-00017300: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2873  _to_col_if_str(s
-00017310: 7263 2c20 2274 7261 6e73 6c61 7465 2229  rc, "translate")
-00017320: 0a20 2020 2073 6f75 7263 655f 616c 7068  .    source_alph
-00017330: 6162 6574 203d 205f 746f 5f63 6f6c 5f69  abet = _to_col_i
-00017340: 665f 7374 7228 736f 7572 6365 5f61 6c70  f_str(source_alp
-00017350: 6861 6265 742c 2022 7472 616e 736c 6174  habet, "translat
-00017360: 6522 290a 2020 2020 7461 7267 6574 5f61  e").    target_a
-00017370: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
-00017380: 6c5f 6966 5f73 7472 2874 6172 6765 745f  l_if_str(target_
-00017390: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
-000173a0: 6c61 7465 2229 0a20 2020 2072 6574 7572  late").    retur
-000173b0: 6e20 6275 696c 7469 6e28 2274 7261 6e73  n builtin("trans
-000173c0: 6c61 7465 2229 2873 6f75 7263 652c 2073  late")(source, s
-000173d0: 6f75 7263 655f 616c 7068 6162 6574 2c20  ource_alphabet, 
-000173e0: 7461 7267 6574 5f61 6c70 6861 6265 7429  target_alphabet)
-000173f0: 0a0a 0a64 6566 2063 6f6e 7461 696e 7328  ...def contains(
-00017400: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
-00017410: 652c 2073 7472 696e 673a 2043 6f6c 756d  e, string: Colum
-00017420: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00017430: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00017440: 6e73 2069 6620 6063 6f6c 6020 636f 6e74  ns if `col` cont
-00017450: 6169 6e73 2060 7374 7269 6e67 6020 666f  ains `string` fo
-00017460: 7220 6561 6368 2072 6f77 2e20 5365 6520  r each row. See 
-00017470: 6043 4f4e 5441 494e 5320 3c68 7474 7073  `CONTAINS <https
-00017480: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
-00017490: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
-000174a0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
-000174b0: 2f63 6f6e 7461 696e 733e 600a 0a20 2020  /contains>`..   
-000174c0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-000174d0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000174e0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000174f0: 616d 6528 5b5b 312c 325d 2c20 5b33 2c34  ame([[1,2], [3,4
-00017500: 5d2c 205b 352c 355d 205d 2c20 7363 6865  ], [5,5] ], sche
-00017510: 6d61 3d5b 2261 222c 2262 225d 290a 2020  ma=["a","b"]).  
-00017520: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00017530: 6563 7428 636f 6e74 6169 6e73 2863 6f6c  ect(contains(col
-00017540: 2822 6122 292c 2063 6f6c 2822 6222 2929  ("a"), col("b"))
-00017550: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-00017560: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00017570: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00017580: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00017590: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000175a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000175b0: 7c46 616c 7365 2020 2020 207c 0a20 2020  |False     |.   
-000175c0: 2020 2020 207c 4661 6c73 6520 2020 2020       |False     
-000175d0: 7c0a 2020 2020 2020 2020 7c54 7275 6520  |.        |True 
-000175e0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-000175f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00017600: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00017610: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00017620: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-00017630: 6f6c 2c20 2263 6f6e 7461 696e 7322 290a  ol, "contains").
-00017640: 2020 2020 7320 3d20 5f74 6f5f 636f 6c5f      s = _to_col_
-00017650: 6966 5f73 7472 2873 7472 696e 672c 2022  if_str(string, "
-00017660: 636f 6e74 6169 6e73 2229 0a20 2020 2072  contains").    r
-00017670: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
-00017680: 6f6e 7461 696e 7322 2928 632c 2073 290a  ontains")(c, s).
-00017690: 0a0a 6465 6620 7374 6172 7473 7769 7468  ..def startswith
-000176a0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-000176b0: 6d65 2c20 7374 723a 2043 6f6c 756d 6e4f  me, str: ColumnO
-000176c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-000176d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-000176e0: 2074 7275 6520 6966 2063 6f6c 2073 7461   true if col sta
-000176f0: 7274 7320 7769 7468 2073 7472 2e0a 0a20  rts with str... 
-00017700: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00017710: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00017720: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00017730: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-00017740: 2e2e 2e20 2020 2020 5b5b 2261 6263 222c  ...     [["abc",
-00017750: 2022 6122 5d2c 205b 2261 6263 222c 2022   "a"], ["abc", "
-00017760: 7322 5d5d 2c0a 2020 2020 2020 2020 2e2e  s"]],.        ..
-00017770: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
-00017780: 222c 2022 5022 5d2c 0a20 2020 2020 2020  ", "P"],.       
-00017790: 202e 2e2e 2029 2e73 656c 6563 7428 7374   ... ).select(st
-000177a0: 6172 7473 7769 7468 2863 6f6c 2822 5322  artswith(col("S"
-000177b0: 292c 2063 6f6c 2822 5022 2929 290a 2020  ), col("P"))).  
-000177c0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
-000177d0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000177e0: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
-000177f0: 5322 2c20 2250 2229 3d54 7275 6529 2c20  S", "P")=True), 
-00017800: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
-00017810: 5322 2c20 2250 2229 3d46 616c 7365 295d  S", "P")=False)]
-00017820: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00017830: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00017840: 636f 6c2c 2022 7374 6172 7473 7769 7468  col, "startswith
-00017850: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
-00017860: 6f6c 5f69 665f 7374 7228 7374 722c 2022  ol_if_str(str, "
-00017870: 7374 6172 7473 7769 7468 2229 0a20 2020  startswith").   
-00017880: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00017890: 2273 7461 7274 7377 6974 6822 2928 632c  "startswith")(c,
-000178a0: 2073 290a 0a0a 6465 6620 656e 6473 7769   s)...def endswi
-000178b0: 7468 2863 6f6c 3a20 436f 6c75 6d6e 4f72  th(col: ColumnOr
-000178c0: 4e61 6d65 2c20 7374 723a 2043 6f6c 756d  Name, str: Colum
-000178d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000178e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000178f0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
-00017900: 636f 6c20 656e 6473 2077 6974 6820 7374  col ends with st
-00017910: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
-00017920: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00017930: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00017940: 7465 5f64 6174 6166 7261 6d65 285b 2261  te_dataframe(["a
-00017950: 7070 6c65 222c 2022 6261 6e61 6e61 222c  pple", "banana",
-00017960: 2022 7065 6163 6822 5d2c 2073 6368 656d   "peach"], schem
-00017970: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00017980: 203e 3e3e 2064 662e 7365 6c65 6374 2865   >>> df.select(e
-00017990: 6e64 7377 6974 6828 6466 5b22 6122 5d2c  ndswith(df["a"],
-000179a0: 206c 6974 2822 616e 6122 2929 2e61 6c69   lit("ana")).ali
-000179b0: 6173 2822 656e 6473 7769 7468 2229 292e  as("endswith")).
-000179c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000179d0: 2020 5b52 6f77 2845 4e44 5357 4954 483d    [Row(ENDSWITH=
-000179e0: 4661 6c73 6529 2c20 526f 7728 454e 4453  False), Row(ENDS
-000179f0: 5749 5448 3d54 7275 6529 2c20 526f 7728  WITH=True), Row(
-00017a00: 454e 4453 5749 5448 3d46 616c 7365 295d  ENDSWITH=False)]
-00017a10: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00017a20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00017a30: 636f 6c2c 2022 656e 6473 7769 7468 2229  col, "endswith")
-00017a40: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
-00017a50: 5f69 665f 7374 7228 7374 722c 2022 656e  _if_str(str, "en
-00017a60: 6473 7769 7468 2229 0a20 2020 2072 6574  dswith").    ret
-00017a70: 7572 6e20 6275 696c 7469 6e28 2265 6e64  urn builtin("end
-00017a80: 7377 6974 6822 2928 632c 2073 290a 0a0a  swith")(c, s)...
-00017a90: 6465 6620 696e 7365 7274 280a 2020 2020  def insert(.    
-00017aa0: 6261 7365 5f65 7870 723a 2043 6f6c 756d  base_expr: Colum
-00017ab0: 6e4f 724e 616d 652c 0a20 2020 2070 6f73  nOrName,.    pos
-00017ac0: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
-00017ad0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 206c  umn, int],.    l
-00017ae0: 656e 6774 683a 2055 6e69 6f6e 5b43 6f6c  ength: Union[Col
-00017af0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 2069  umn, int],.    i
-00017b00: 6e73 6572 745f 6578 7072 3a20 436f 6c75  nsert_expr: Colu
-00017b10: 6d6e 4f72 4e61 6d65 2c0a 2920 2d3e 2043  mnOrName,.) -> C
-00017b20: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00017b30: 2020 2052 6570 6c61 6365 7320 6120 7375     Replaces a su
-00017b40: 6273 7472 696e 6720 6f66 2074 6865 2073  bstring of the s
-00017b50: 7065 6369 6669 6564 206c 656e 6774 682c  pecified length,
-00017b60: 2073 7461 7274 696e 6720 6174 2074 6865   starting at the
-00017b70: 2073 7065 6369 6669 6564 2070 6f73 6974   specified posit
-00017b80: 696f 6e2c 0a20 2020 2077 6974 6820 6120  ion,.    with a 
-00017b90: 6e65 7720 7374 7269 6e67 206f 7220 6269  new string or bi
-00017ba0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
-00017bb0: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
-00017bc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00017bd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00017be0: 6166 7261 6d65 285b 2261 6263 225d 2c20  aframe(["abc"], 
-00017bf0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00017c00: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00017c10: 6563 7428 696e 7365 7274 2864 665b 2261  ect(insert(df["a
-00017c20: 225d 2c20 312c 2032 2c20 6c69 7428 225a  "], 1, 2, lit("Z
-00017c30: 2229 292e 616c 6961 7328 2269 6e73 6572  ")).alias("inser
-00017c40: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
-00017c50: 2020 2020 2020 205b 526f 7728 494e 5345         [Row(INSE
-00017c60: 5254 3d27 5a63 2729 5d0a 2020 2020 2222  RT='Zc')].    ""
-00017c70: 220a 2020 2020 6220 3d20 5f74 6f5f 636f  ".    b = _to_co
-00017c80: 6c5f 6966 5f73 7472 2862 6173 655f 6578  l_if_str(base_ex
-00017c90: 7072 2c20 2269 6e73 6572 7422 290a 2020  pr, "insert").  
-00017ca0: 2020 6920 3d20 5f74 6f5f 636f 6c5f 6966    i = _to_col_if
-00017cb0: 5f73 7472 2869 6e73 6572 745f 6578 7072  _str(insert_expr
-00017cc0: 2c20 2269 6e73 6572 7422 290a 2020 2020  , "insert").    
-00017cd0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00017ce0: 696e 7365 7274 2229 2862 2c20 6c69 7428  insert")(b, lit(
-00017cf0: 706f 7369 7469 6f6e 292c 206c 6974 286c  position), lit(l
-00017d00: 656e 6774 6829 2c20 6929 0a0a 0a64 6566  ength), i)...def
-00017d10: 206c 6566 7428 7374 725f 6578 7072 3a20   left(str_expr: 
-00017d20: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6c65  ColumnOrName, le
-00017d30: 6e67 7468 3a20 556e 696f 6e5b 436f 6c75  ngth: Union[Colu
-00017d40: 6d6e 2c20 696e 745d 2920 2d3e 2043 6f6c  mn, int]) -> Col
-00017d50: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00017d60: 726e 7320 6120 6c65 6674 206d 6f73 7420  rns a left most 
-00017d70: 7375 6273 7472 696e 6720 6f66 2060 6073  substring of ``s
-00017d80: 7472 5f65 7870 7260 602e 0a0a 2020 2020  tr_expr``...    
-00017d90: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00017da0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00017db0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00017dc0: 7261 6d65 285b 5b22 6162 6322 5d2c 205b  rame([["abc"], [
-00017dd0: 2264 6566 225d 5d2c 2073 6368 656d 613d  "def"]], schema=
-00017de0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-00017df0: 3e3e 2064 662e 7365 6c65 6374 286c 6566  >> df.select(lef
-00017e00: 7428 636f 6c28 2261 2229 2c20 3229 2e61  t(col("a"), 2).a
-00017e10: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00017e20: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00017e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00017e40: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00017e50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017e60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c61  -----.        |a
-00017e70: 6220 2020 2020 2020 207c 0a20 2020 2020  b        |.     
-00017e80: 2020 207c 6465 2020 2020 2020 2020 7c0a     |de        |.
-00017e90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017ea0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00017eb0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00017ec0: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
-00017ed0: 5f69 665f 7374 7228 7374 725f 6578 7072  _if_str(str_expr
-00017ee0: 2c20 226c 6566 7422 290a 2020 2020 7265  , "left").    re
-00017ef0: 7475 726e 2062 7569 6c74 696e 2822 6c65  turn builtin("le
-00017f00: 6674 2229 2873 2c20 6c69 7428 6c65 6e67  ft")(s, lit(leng
-00017f10: 7468 2929 0a0a 0a64 6566 2072 6967 6874  th))...def right
-00017f20: 2873 7472 5f65 7870 723a 2043 6f6c 756d  (str_expr: Colum
-00017f30: 6e4f 724e 616d 652c 206c 656e 6774 683a  nOrName, length:
-00017f40: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
-00017f50: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
-00017f60: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-00017f70: 2072 6967 6874 206d 6f73 7420 7375 6273   right most subs
-00017f80: 7472 696e 6720 6f66 2060 6073 7472 5f65  tring of ``str_e
-00017f90: 7870 7260 602e 0a0a 2020 2020 4578 616d  xpr``...    Exam
-00017fa0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00017fb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00017fc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00017fd0: 285b 5b22 6162 6322 5d2c 205b 2264 6566  ([["abc"], ["def
-00017fe0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
-00017ff0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00018000: 662e 7365 6c65 6374 2872 6967 6874 2863  f.select(right(c
-00018010: 6f6c 2822 6122 292c 2032 292e 616c 6961  ol("a"), 2).alia
-00018020: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-00018030: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00018040: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00018050: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-00018060: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00018070: 2d2d 0a20 2020 2020 2020 207c 6263 2020  --.        |bc  
-00018080: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00018090: 7c65 6620 2020 2020 2020 207c 0a20 2020  |ef        |.   
-000180a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000180b0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-000180c0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-000180d0: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
-000180e0: 5f73 7472 2873 7472 5f65 7870 722c 2022  _str(str_expr, "
-000180f0: 7269 6768 7422 290a 2020 2020 7265 7475  right").    retu
-00018100: 726e 2062 7569 6c74 696e 2822 7269 6768  rn builtin("righ
-00018110: 7422 2928 732c 206c 6974 286c 656e 6774  t")(s, lit(lengt
-00018120: 6829 290a 0a0a 6465 6620 6368 6172 2863  h))...def char(c
-00018130: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
-00018140: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00018150: 2022 2222 436f 6e76 6572 7473 2061 2055   """Converts a U
-00018160: 6e69 636f 6465 2063 6f64 6520 706f 696e  nicode code poin
-00018170: 7420 2869 6e63 6c75 6469 6e67 2037 2d62  t (including 7-b
-00018180: 6974 2041 5343 4949 2920 696e 746f 2074  it ASCII) into t
-00018190: 6865 2063 6861 7261 6374 6572 2074 6861  he character tha
-000181a0: 740a 2020 2020 6d61 7463 6865 7320 7468  t.    matches th
-000181b0: 6520 696e 7075 7420 556e 6963 6f64 652e  e input Unicode.
-000181c0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-000181d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000181e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000181f0: 5f64 6174 6166 7261 6d65 285b 3833 2c20  _dataframe([83, 
-00018200: 3333 2c20 3136 392c 2038 3336 342c 204e  33, 169, 8364, N
-00018210: 6f6e 655d 2c20 7363 6865 6d61 3d5b 2761  one], schema=['a
-00018220: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-00018230: 6466 2e73 656c 6563 7428 6466 2e61 2c20  df.select(df.a, 
-00018240: 6368 6172 2864 662e 6129 2e61 735f 2827  char(df.a).as_('
-00018250: 6368 6172 2729 292e 736f 7274 2864 662e  char')).sort(df.
-00018260: 6129 2e73 686f 7728 290a 2020 2020 2020  a).show().      
-00018270: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00018280: 2d2d 2d0a 2020 2020 2020 2020 7c22 4122  ---.        |"A"
-00018290: 2020 207c 2243 4841 5222 2020 7c0a 2020     |"CHAR"  |.  
-000182a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000182b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000182c0: 7c4e 554c 4c20 207c 4e55 4c4c 2020 2020  |NULL  |NULL    
-000182d0: 7c0a 2020 2020 2020 2020 7c33 3320 2020  |.        |33   
-000182e0: 207c 2120 2020 2020 2020 7c0a 2020 2020   |!       |.    
-000182f0: 2020 2020 7c38 3320 2020 207c 5320 2020      |83    |S   
-00018300: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
-00018310: 3639 2020 207c c2a9 2020 2020 2020 207c  69   |..       |
-00018320: 0a20 2020 2020 2020 207c 3833 3634 2020  .        |8364  
-00018330: 7ce2 82ac 2020 2020 2020 207c 0a20 2020  |...       |.   
-00018340: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00018350: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00018360: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00018370: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00018380: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-00018390: 6368 6172 2229 0a20 2020 2072 6574 7572  char").    retur
-000183a0: 6e20 6275 696c 7469 6e28 2263 6861 7222  n builtin("char"
-000183b0: 2928 6329 0a0a 0a64 6566 2074 6f5f 6368  )(c)...def to_ch
-000183c0: 6172 2863 3a20 436f 6c75 6d6e 4f72 4e61  ar(c: ColumnOrNa
-000183d0: 6d65 2c20 666f 726d 6174 3a20 4f70 7469  me, format: Opti
-000183e0: 6f6e 616c 5b43 6f6c 756d 6e4f 724c 6974  onal[ColumnOrLit
-000183f0: 6572 616c 5374 725d 203d 204e 6f6e 6529  eralStr] = None)
-00018400: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00018410: 2222 2243 6f6e 7665 7274 7320 6120 556e  """Converts a Un
-00018420: 6963 6f64 6520 636f 6465 2070 6f69 6e74  icode code point
-00018430: 2028 696e 636c 7564 696e 6720 372d 6269   (including 7-bi
-00018440: 7420 4153 4349 4929 2069 6e74 6f20 7468  t ASCII) into th
-00018450: 6520 6368 6172 6163 7465 7220 7468 6174  e character that
-00018460: 0a20 2020 206d 6174 6368 6573 2074 6865  .    matches the
-00018470: 2069 6e70 7574 2055 6e69 636f 6465 2e0a   input Unicode..
-00018480: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00018490: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000184a0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000184b0: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
-000184c0: 332c 2034 5d2c 2073 6368 656d 613d 5b27  3, 4], schema=['
-000184d0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-000184e0: 2064 662e 7365 6c65 6374 2874 6f5f 6368   df.select(to_ch
-000184f0: 6172 2863 6f6c 2827 6127 2929 2e61 735f  ar(col('a')).as_
-00018500: 2827 616e 7327 2929 2e63 6f6c 6c65 6374  ('ans')).collect
-00018510: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00018520: 414e 533d 2731 2729 2c20 526f 7728 414e  ANS='1'), Row(AN
-00018530: 533d 2732 2729 2c20 526f 7728 414e 533d  S='2'), Row(ANS=
-00018540: 2733 2729 2c20 526f 7728 414e 533d 2734  '3'), Row(ANS='4
-00018550: 2729 5d0a 0a20 2020 2045 7861 6d70 6c65  ')]..    Example
-00018560: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00018570: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00018580: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00018590: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000185a0: 6461 7461 6672 616d 6528 5b64 6174 6574  dataframe([datet
-000185b0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-000185c0: 332c 2034 2c20 3136 292c 2064 6174 6574  3, 4, 16), datet
-000185d0: 696d 652e 6461 7465 7469 6d65 2832 3031  ime.datetime(201
-000185e0: 372c 2034 2c20 332c 2032 2c20 3539 2c20  7, 4, 3, 2, 59, 
-000185f0: 3337 2c20 3135 3329 5d2c 2073 6368 656d  37, 153)], schem
-00018600: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
-00018610: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
-00018620: 6f5f 6368 6172 2863 6f6c 2827 6127 2929  o_char(col('a'))
-00018630: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
-00018640: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00018650: 526f 7728 414e 533d 2732 3032 332d 3034  Row(ANS='2023-04
-00018660: 2d31 3620 3030 3a30 303a 3030 2e30 3030  -16 00:00:00.000
-00018670: 2729 2c20 526f 7728 414e 533d 2732 3031  '), Row(ANS='201
-00018680: 372d 3034 2d30 3320 3032 3a35 393a 3337  7-04-03 02:59:37
-00018690: 2e30 3030 2729 5d0a 0a20 2020 2022 2222  .000')]..    """
-000186a0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000186b0: 5f69 665f 7374 7228 632c 2022 746f 5f63  _if_str(c, "to_c
-000186c0: 6861 7222 290a 2020 2020 7265 7475 726e  har").    return
-000186d0: 2028 0a20 2020 2020 2020 2062 7569 6c74   (.        built
-000186e0: 696e 2822 746f 5f63 6861 7222 2928 632c  in("to_char")(c,
-000186f0: 206c 6974 2866 6f72 6d61 7429 290a 2020   lit(format)).  
-00018700: 2020 2020 2020 6966 2066 6f72 6d61 7420        if format 
-00018710: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-00018720: 2020 2020 656c 7365 2062 7569 6c74 696e      else builtin
-00018730: 2822 746f 5f63 6861 7222 2928 6329 0a20  ("to_char")(c). 
-00018740: 2020 2029 0a0a 0a64 6566 2074 6f5f 7469     )...def to_ti
-00018750: 6d65 2865 3a20 436f 6c75 6d6e 4f72 4e61  me(e: ColumnOrNa
-00018760: 6d65 2c20 666d 743a 204f 7074 696f 6e61  me, fmt: Optiona
-00018770: 6c5b 2243 6f6c 756d 6e22 5d20 3d20 4e6f  l["Column"] = No
-00018780: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
-00018790: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
-000187a0: 6e20 696e 7075 7420 6578 7072 6573 7369  n input expressi
-000187b0: 6f6e 2069 6e74 6f20 7468 6520 636f 7272  on into the corr
-000187c0: 6573 706f 6e64 696e 6720 7469 6d65 2e0a  esponding time..
-000187d0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-000187e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000187f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00018800: 6461 7461 6672 616d 6528 5b27 3034 3a31  dataframe(['04:1
-00018810: 353a 3239 2e39 3939 275d 2c20 7363 6865  5:29.999'], sche
-00018820: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
-00018830: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00018840: 746f 5f74 696d 6528 636f 6c28 2261 2229  to_time(col("a")
-00018850: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00018860: 2020 2020 205b 526f 7728 544f 5f54 494d       [Row(TO_TIM
-00018870: 4528 2241 2229 3d64 6174 6574 696d 652e  E("A")=datetime.
-00018880: 7469 6d65 2834 2c20 3135 2c20 3239 2c20  time(4, 15, 29, 
-00018890: 3939 3930 3030 2929 5d0a 2020 2020 2222  999000))].    ""
-000188a0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-000188b0: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
-000188c0: 7469 6d65 2229 0a20 2020 2072 6574 7572  time").    retur
-000188d0: 6e20 6275 696c 7469 6e28 2274 6f5f 7469  n builtin("to_ti
-000188e0: 6d65 2229 2863 2c20 666d 7429 2069 6620  me")(c, fmt) if 
-000188f0: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
-00018900: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
-00018910: 5f74 696d 6522 2928 6329 0a0a 0a64 6566  _time")(c)...def
-00018920: 2074 6f5f 7469 6d65 7374 616d 7028 653a   to_timestamp(e:
-00018930: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
-00018940: 6d74 3a20 4f70 7469 6f6e 616c 5b22 436f  mt: Optional["Co
-00018950: 6c75 6d6e 225d 203d 204e 6f6e 6529 202d  lumn"] = None) -
-00018960: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00018970: 2243 6f6e 7665 7274 7320 616e 2069 6e70  "Converts an inp
-00018980: 7574 2065 7870 7265 7373 696f 6e20 696e  ut expression in
-00018990: 746f 2074 6865 2063 6f72 7265 7370 6f6e  to the correspon
-000189a0: 6469 6e67 2074 696d 6573 7461 6d70 2e0a  ding timestamp..
-000189b0: 0a20 2020 2050 6572 2064 6566 6175 6c74  .    Per default
-000189c0: 2066 6d74 2069 7320 7365 7420 746f 2061   fmt is set to a
-000189d0: 7574 6f2c 2077 6869 6368 206d 616b 6573  uto, which makes
-000189e0: 2053 6e6f 7766 6c61 6b65 2064 6574 6563   Snowflake detec
-000189f0: 7420 7468 6520 666f 726d 6174 2061 7574  t the format aut
-00018a00: 6f6d 6174 6963 616c 6c79 2e20 5769 7468  omatically. With
-00018a10: 2060 746f 5f74 696d 6573 7461 6d70 6020   `to_timestamp` 
-00018a20: 7374 7269 6e67 730a 2020 2020 6361 6e20  strings.    can 
-00018a30: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
-00018a40: 7469 6d65 7374 616d 7073 2e20 5468 6520  timestamps. The 
-00018a50: 666f 726d 6174 2068 6173 2074 6f20 6265  format has to be
-00018a60: 2073 7065 6369 6669 6564 2061 6363 6f72   specified accor
-00018a70: 6469 6e67 2074 6f20 7468 6520 7275 6c65  ding to the rule
-00018a80: 7320 7365 7420 666f 7274 6820 696e 0a20  s set forth in. 
-00018a90: 2020 203c 6874 7470 733a 2f2f 646f 6373     <https://docs
-00018aa0: 2e73 6e6f 7766 6c61 6b65 2e63 6f6d 2f65  .snowflake.com/e
-00018ab0: 6e2f 7371 6c2d 7265 6665 7265 6e63 652f  n/sql-reference/
-00018ac0: 6675 6e63 7469 6f6e 732d 636f 6e76 6572  functions-conver
-00018ad0: 7369 6f6e 2364 6174 652d 616e 642d 7469  sion#date-and-ti
-00018ae0: 6d65 2d66 6f72 6d61 7473 2d69 6e2d 636f  me-formats-in-co
-00018af0: 6e76 6572 7369 6f6e 2d66 756e 6374 696f  nversion-functio
-00018b00: 6e73 3e0a 0a20 2020 2045 7861 6d70 6c65  ns>..    Example
-00018b10: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-00018b20: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00018b30: 7465 5f64 6174 6166 7261 6d65 285b 2732  te_dataframe(['2
-00018b40: 3031 392d 3031 2d33 3120 3031 3a30 323a  019-01-31 01:02:
-00018b50: 3033 2e30 3034 275d 2c20 7363 6865 6d61  03.004'], schema
-00018b60: 3d5b 2761 275d 290a 2020 2020 2020 2020  =['a']).        
-00018b70: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
-00018b80: 5f74 696d 6573 7461 6d70 2863 6f6c 2822  _timestamp(col("
-00018b90: 6122 2929 2e61 735f 2822 616e 7322 2929  a")).as_("ans"))
-00018ba0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00018bb0: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
-00018bc0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00018bd0: 3139 2c20 312c 2033 312c 2031 2c20 322c  19, 1, 31, 1, 2,
-00018be0: 2033 2c20 3430 3030 2929 5d0a 2020 2020   3, 4000))].    
-00018bf0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00018c00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00018c10: 6672 616d 6528 5b22 3230 3230 2d30 352d  frame(["2020-05-
-00018c20: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
-00018c30: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
-00018c40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00018c50: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
-00018c60: 616d 7028 636f 6c28 2261 2229 2c20 6c69  amp(col("a"), li
-00018c70: 7428 2259 5959 592d 4d4d 2d44 4420 4848  t("YYYY-MM-DD HH
-00018c80: 3234 3a4d 493a 5353 2e46 4633 2229 292e  24:MI:SS.FF3")).
-00018c90: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
-00018ca0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00018cb0: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
-00018cc0: 6461 7465 7469 6d65 2832 3032 302c 2035  datetime(2020, 5
-00018cd0: 2c20 312c 2031 332c 2031 312c 2032 3029  , 1, 13, 11, 20)
-00018ce0: 295d 0a0a 2020 2020 416e 6f74 6865 7220  )]..    Another 
-00018cf0: 6f70 7469 6f6e 2069 7320 746f 2063 6f6e  option is to con
-00018d00: 7665 7274 2064 6174 6573 2069 6e74 6f20  vert dates into 
-00018d10: 7469 6d65 7374 616d 7073 0a0a 2020 2020  timestamps..    
-00018d20: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-00018d30: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-00018d40: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
-00018d50: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00018d60: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
-00018d70: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00018d80: 6528 3230 3232 2c20 3132 2c20 3235 2c20  e(2022, 12, 25, 
-00018d90: 3133 2c20 3539 2c20 3338 2c20 3436 3729  13, 59, 38, 467)
-00018da0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00018db0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00018dc0: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
-00018dd0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
-00018de0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00018df0: 205b 526f 7728 544f 5f54 494d 4553 5441   [Row(TO_TIMESTA
-00018e00: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
-00018e10: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
-00018e20: 3132 2c20 3235 2c20 3133 2c20 3539 2c20  12, 25, 13, 59, 
-00018e30: 3338 2c20 3436 3729 295d 0a20 2020 2020  38, 467))].     
-00018e40: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00018e50: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
-00018e60: 616d 6528 5b64 6174 6574 696d 652e 6461  ame([datetime.da
-00018e70: 7465 2832 3032 332c 2033 2c20 3129 5d2c  te(2023, 3, 1)],
-00018e80: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00018e90: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00018ea0: 6c65 6374 2874 6f5f 7469 6d65 7374 616d  lect(to_timestam
-00018eb0: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
-00018ec0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00018ed0: 526f 7728 544f 5f54 494d 4553 5441 4d50  Row(TO_TIMESTAMP
-00018ee0: 2822 4122 293d 6461 7465 7469 6d65 2e64  ("A")=datetime.d
-00018ef0: 6174 6574 696d 6528 3230 3233 2c20 332c  atetime(2023, 3,
-00018f00: 2031 2c20 302c 2030 2929 5d0a 0a20 2020   1, 0, 0))]..   
-00018f10: 2049 6e74 6567 6572 7320 6361 6e20 6265   Integers can be
-00018f20: 2063 6f6e 7665 7274 6564 2069 6e74 6f20   converted into 
-00018f30: 6120 7469 6d65 7374 616d 7020 6173 2077  a timestamp as w
-00018f40: 656c 6c2c 2062 7920 7072 6f76 6964 696e  ell, by providin
-00018f50: 6720 6f70 7469 6f6e 616c 6c79 2061 2073  g optionally a s
-00018f60: 6361 6c65 2061 7320 616e 2069 6e74 6567  cale as an integ
-00018f70: 6572 2061 7320 6c69 6e65 6420 6f75 7420  er as lined out 
-00018f80: 696e 0a20 2020 203c 6874 7470 733a 2f2f  in.    <https://
-00018f90: 646f 6373 2e73 6e6f 7766 6c61 6b65 2e63  docs.snowflake.c
-00018fa0: 6f6d 2f65 6e2f 7371 6c2d 7265 6665 7265  om/en/sql-refere
-00018fb0: 6e63 652f 6675 6e63 7469 6f6e 732f 746f  nce/functions/to
-00018fc0: 5f74 696d 6573 7461 6d70 2375 7361 6765  _timestamp#usage
-00018fd0: 2d6e 6f74 6573 3e2e 2043 7572 7265 6e74  -notes>. Current
-00018fe0: 6c79 2053 6e6f 7770 6172 6b20 646f 6573  ly Snowpark does
-00018ff0: 2073 7570 706f 7274 0a20 2020 2069 6e74   support.    int
-00019000: 6567 6572 7320 696e 2074 6865 2072 616e  egers in the ran
-00019010: 6765 206f 6620 616e 2038 2d62 7974 6520  ge of an 8-byte 
-00019020: 7369 676e 6564 2069 6e74 6567 6572 206f  signed integer o
-00019030: 6e6c 792e 0a0a 2020 2020 4578 616d 706c  nly...    Exampl
-00019040: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00019050: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00019060: 6174 6544 6174 6146 7261 6d65 285b 3230  ateDataFrame([20
-00019070: 2c20 3331 3533 3630 3030 3030 305d 2c20  , 31536000000], 
-00019080: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
-00019090: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000190a0: 6563 7428 746f 5f74 696d 6573 7461 6d70  ect(to_timestamp
-000190b0: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
-000190c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000190d0: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
-000190e0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-000190f0: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
-00019100: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
-00019110: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
-00019120: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-00019130: 7465 7469 6d65 2832 3936 392c 2035 2c20  tetime(2969, 5, 
-00019140: 332c 2030 2c20 3029 295d 0a20 2020 2020  3, 0, 0))].     
-00019150: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00019160: 2874 6f5f 7469 6d65 7374 616d 7028 636f  (to_timestamp(co
-00019170: 6c28 2261 2229 2c20 6c69 7428 3929 2929  l("a"), lit(9)))
-00019180: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00019190: 2020 205b 526f 7728 544f 5f54 494d 4553     [Row(TO_TIMES
-000191a0: 5441 4d50 2822 4122 2c20 3929 3d64 6174  TAMP("A", 9)=dat
-000191b0: 6574 696d 652e 6461 7465 7469 6d65 2831  etime.datetime(1
-000191c0: 3937 302c 2031 2c20 312c 2030 2c20 3029  970, 1, 1, 0, 0)
-000191d0: 292c 2052 6f77 2854 4f5f 5449 4d45 5354  ), Row(TO_TIMEST
-000191e0: 414d 5028 2241 222c 2039 293d 6461 7465  AMP("A", 9)=date
-000191f0: 7469 6d65 2e64 6174 6574 696d 6528 3139  time.datetime(19
-00019200: 3730 2c20 312c 2031 2c20 302c 2030 2c20  70, 1, 1, 0, 0, 
-00019210: 3331 2c20 3533 3630 3030 2929 5d0a 0a20  31, 536000))].. 
-00019220: 2020 204c 6172 6765 7220 6e75 6d62 6572     Larger number
-00019230: 7320 7374 6f72 6564 2069 6e20 6120 7374  s stored in a st
-00019240: 7269 6e67 2063 616e 2062 6520 616c 736f  ring can be also
-00019250: 2063 6f6e 7665 7274 6564 2076 6961 2074   converted via t
-00019260: 6869 7320 6170 7072 6f61 6368 0a0a 2020  his approach..  
-00019270: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-00019280: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00019290: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
-000192a0: 7261 6d65 285b 2732 3027 2c20 2733 3135  rame(['20', '315
-000192b0: 3336 3030 3030 3030 272c 2027 3331 3533  36000000', '3153
-000192c0: 3630 3030 3030 3030 3030 272c 2027 3331  6000000000', '31
-000192d0: 3533 3630 3030 3030 3030 3030 3030 3027  536000000000000'
-000192e0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
-000192f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00019300: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
-00019310: 616d 7028 636f 6c28 2261 2229 292e 6173  amp(col("a")).as
-00019320: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
-00019330: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00019340: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
-00019350: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
-00019360: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
-00019370: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
-00019380: 6461 7465 7469 6d65 2831 3937 312c 2031  datetime(1971, 1
-00019390: 2c20 312c 2030 2c20 3029 292c 2052 6f77  , 1, 0, 0)), Row
-000193a0: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
-000193b0: 7465 7469 6d65 2831 3937 312c 2031 2c20  tetime(1971, 1, 
-000193c0: 312c 2030 2c20 3029 292c 2052 6f77 2841  1, 0, 0)), Row(A
-000193d0: 4e53 3d64 6174 6574 696d 652e 6461 7465  NS=datetime.date
-000193e0: 7469 6d65 2831 3937 312c 2031 2c20 312c  time(1971, 1, 1,
-000193f0: 2030 2c20 3029 295d 0a20 2020 2022 2222   0, 0))].    """
-00019400: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00019410: 5f69 665f 7374 7228 652c 2022 746f 5f74  _if_str(e, "to_t
-00019420: 696d 6573 7461 6d70 2229 0a20 2020 2072  imestamp").    r
-00019430: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
-00019440: 6275 696c 7469 6e28 2274 6f5f 7469 6d65  builtin("to_time
-00019450: 7374 616d 7022 2928 632c 2066 6d74 290a  stamp")(c, fmt).
-00019460: 2020 2020 2020 2020 6966 2066 6d74 2069          if fmt i
-00019470: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-00019480: 2020 2065 6c73 6520 6275 696c 7469 6e28     else builtin(
-00019490: 2274 6f5f 7469 6d65 7374 616d 7022 2928  "to_timestamp")(
-000194a0: 6329 0a20 2020 2029 0a0a 0a64 6566 2074  c).    )...def t
-000194b0: 6f5f 6461 7465 2865 3a20 436f 6c75 6d6e  o_date(e: Column
-000194c0: 4f72 4e61 6d65 2c20 666d 743a 204f 7074  OrName, fmt: Opt
-000194d0: 696f 6e61 6c5b 2243 6f6c 756d 6e22 5d20  ional["Column"] 
-000194e0: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
-000194f0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
-00019500: 7473 2061 6e20 696e 7075 7420 6578 7072  ts an input expr
-00019510: 6573 7369 6f6e 2069 6e74 6f20 6120 6461  ession into a da
-00019520: 7465 2e0a 0a20 2020 2045 7861 6d70 6c65  te...    Example
-00019530: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00019540: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00019550: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
-00019560: 3230 3133 2d30 352d 3137 272c 2027 3230  2013-05-17', '20
-00019570: 3133 2d30 352d 3137 275d 2c20 7363 6865  13-05-17'], sche
-00019580: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
-00019590: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000195a0: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
-000195b0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
-000195c0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000195d0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
-000195e0: 652e 6461 7465 2832 3031 332c 2035 2c20  e.date(2013, 5, 
-000195f0: 3137 2929 2c20 526f 7728 414e 533d 6461  17)), Row(ANS=da
-00019600: 7465 7469 6d65 2e64 6174 6528 3230 3133  tetime.date(2013
-00019610: 2c20 352c 2031 3729 295d 0a0a 2020 2020  , 5, 17))]..    
-00019620: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00019630: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00019640: 6672 616d 6528 5b27 3331 3533 3630 3030  frame(['31536000
-00019650: 3030 3030 3030 272c 2027 3731 3533 3630  000000', '715360
-00019660: 3034 3030 3030 3030 275d 2c20 7363 6865  04000000'], sche
-00019670: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
-00019680: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00019690: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
-000196a0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
-000196b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000196c0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
-000196d0: 652e 6461 7465 2831 3937 312c 2031 2c20  e.date(1971, 1, 
-000196e0: 3129 292c 2052 6f77 2841 4e53 3d64 6174  1)), Row(ANS=dat
-000196f0: 6574 696d 652e 6461 7465 2831 3937 322c  etime.date(1972,
-00019700: 2034 2c20 3729 295d 0a0a 2020 2020 2222   4, 7))]..    ""
-00019710: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00019720: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
-00019730: 6461 7465 2229 0a20 2020 2072 6574 7572  date").    retur
-00019740: 6e20 6275 696c 7469 6e28 2274 6f5f 6461  n builtin("to_da
-00019750: 7465 2229 2863 2c20 666d 7429 2069 6620  te")(c, fmt) if 
-00019760: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
-00019770: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
-00019780: 5f64 6174 6522 2928 6329 0a0a 0a64 6566  _date")(c)...def
-00019790: 2063 7572 7265 6e74 5f74 696d 6573 7461   current_timesta
-000197a0: 6d70 2829 202d 3e20 436f 6c75 6d6e 3a0a  mp() -> Column:.
-000197b0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-000197c0: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
-000197d0: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
-000197e0: 7465 6d2e 0a0a 2020 2020 4578 616d 706c  tem...    Exampl
-000197f0: 653a 0a20 2020 2020 2020 203e 3e3e 2069  e:.        >>> i
-00019800: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-00019810: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-00019820: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
-00019830: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
-00019840: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
-00019850: 5f74 696d 6573 7461 6d70 2829 292e 636f  _timestamp()).co
-00019860: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00019870: 3e3e 3e20 6173 7365 7274 2069 7369 6e73  >>> assert isins
-00019880: 7461 6e63 6528 7265 7375 6c74 5b30 5d5b  tance(result[0][
-00019890: 2243 5552 5245 4e54 5f54 494d 4553 5441  "CURRENT_TIMESTA
-000198a0: 4d50 2829 225d 2c20 6461 7465 7469 6d65  MP()"], datetime
-000198b0: 2e64 6174 6574 696d 6529 0a20 2020 2022  .datetime).    "
-000198c0: 2222 0a0a 2020 2020 7265 7475 726e 2062  ""..    return b
-000198d0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
-000198e0: 7469 6d65 7374 616d 7022 2928 290a 0a0a  timestamp")()...
-000198f0: 6465 6620 6375 7272 656e 745f 6461 7465  def current_date
-00019900: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00019910: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00019920: 2063 7572 7265 6e74 2064 6174 6520 666f   current date fo
-00019930: 7220 7468 6520 7379 7374 656d 2e0a 0a20  r the system... 
-00019940: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00019950: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00019960: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00019970: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
-00019980: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00019990: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
-000199a0: 7428 6375 7272 656e 745f 6461 7465 2829  t(current_date()
-000199b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-000199c0: 2020 2020 3e3e 3e20 6173 7365 7274 2069      >>> assert i
-000199d0: 7369 6e73 7461 6e63 6528 7265 7375 6c74  sinstance(result
-000199e0: 5b30 5d5b 2243 5552 5245 4e54 5f44 4154  [0]["CURRENT_DAT
-000199f0: 4528 2922 5d2c 2064 6174 6574 696d 652e  E()"], datetime.
-00019a00: 6461 7465 290a 2020 2020 2222 220a 2020  date).    """.  
-00019a10: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00019a20: 2822 6375 7272 656e 745f 6461 7465 2229  ("current_date")
-00019a30: 2829 0a0a 0a64 6566 2063 7572 7265 6e74  ()...def current
-00019a40: 5f74 696d 6528 2920 2d3e 2043 6f6c 756d  _time() -> Colum
-00019a50: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00019a60: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
-00019a70: 6d65 2066 6f72 2074 6865 2073 7973 7465  me for the syste
-00019a80: 6d2e 0a0a 2020 2020 4578 616d 706c 653a  m...    Example:
-00019a90: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00019aa0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-00019ab0: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
-00019ac0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00019ad0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
-00019ae0: 7365 6c65 6374 2863 7572 7265 6e74 5f74  select(current_t
-00019af0: 696d 6528 2929 2e63 6f6c 6c65 6374 2829  ime()).collect()
-00019b00: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
-00019b10: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
-00019b20: 6573 756c 745b 305d 5b22 4355 5252 454e  esult[0]["CURREN
-00019b30: 545f 5449 4d45 2829 225d 2c20 6461 7465  T_TIME()"], date
-00019b40: 7469 6d65 2e74 696d 6529 0a20 2020 2022  time.time).    "
-00019b50: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00019b60: 696c 7469 6e28 2263 7572 7265 6e74 5f74  iltin("current_t
-00019b70: 696d 6522 2928 290a 0a0a 6465 6620 686f  ime")()...def ho
-00019b80: 7572 2865 3a20 436f 6c75 6d6e 4f72 4e61  ur(e: ColumnOrNa
-00019b90: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00019ba0: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
-00019bb0: 6374 7320 7468 6520 686f 7572 2066 726f  cts the hour fro
-00019bc0: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
-00019bd0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
-00019be0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00019bf0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00019c00: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-00019c10: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00019c20: 7465 5f64 6174 6166 7261 6d65 285b 0a20  te_dataframe([. 
-00019c30: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-00019c40: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00019c50: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-00019c60: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
-00019c70: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-00019c80: 483a 254d 3a25 532e 2566 2229 2c0a 2020  H:%M:%S.%f"),.  
-00019c90: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
-00019ca0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
-00019cb0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
-00019cc0: 382d 3231 2030 313a 3330 3a30 352e 3030  8-21 01:30:05.00
-00019cd0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
-00019ce0: 3a25 4d3a 2553 2e25 6622 290a 2020 2020  :%M:%S.%f").    
-00019cf0: 2020 2020 2e2e 2e20 5d2c 2073 6368 656d      ... ], schem
-00019d00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00019d10: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
-00019d20: 6f75 7228 2261 2229 292e 636f 6c6c 6563  our("a")).collec
-00019d30: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00019d40: 2848 4f55 5228 2241 2229 3d31 3329 2c20  (HOUR("A")=13), 
-00019d50: 526f 7728 484f 5552 2822 4122 293d 3129  Row(HOUR("A")=1)
-00019d60: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-00019d70: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00019d80: 2865 2c20 2268 6f75 7222 290a 2020 2020  (e, "hour").    
-00019d90: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00019da0: 686f 7572 2229 2863 290a 0a0a 6465 6620  hour")(c)...def 
-00019db0: 6c61 7374 5f64 6179 2865 3a20 436f 6c75  last_day(e: Colu
-00019dc0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00019dd0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00019de0: 2052 6574 7572 6e73 2074 6865 206c 6173   Returns the las
-00019df0: 7420 6461 7920 6f66 2074 6865 2073 7065  t day of the spe
-00019e00: 6369 6669 6564 2064 6174 6520 7061 7274  cified date part
-00019e10: 2066 6f72 2061 2064 6174 6520 6f72 2074   for a date or t
-00019e20: 696d 6573 7461 6d70 2e0a 2020 2020 436f  imestamp..    Co
-00019e30: 6d6d 6f6e 6c79 2075 7365 6420 746f 2072  mmonly used to r
-00019e40: 6574 7572 6e20 7468 6520 6c61 7374 2064  eturn the last d
-00019e50: 6179 206f 6620 7468 6520 6d6f 6e74 6820  ay of the month 
-00019e60: 666f 7220 6120 6461 7465 206f 7220 7469  for a date or ti
-00019e70: 6d65 7374 616d 702e 0a0a 2020 2020 4578  mestamp...    Ex
-00019e80: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00019e90: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
-00019ea0: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
-00019eb0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00019ec0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00019ed0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00019ee0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-00019ef0: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
-00019f00: 302d 3035 2d30 3120 3133 3a31 313a 3230  0-05-01 13:11:20
-00019f10: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
-00019f20: 2025 483a 254d 3a25 532e 2566 2229 2c0a   %H:%M:%S.%f"),.
-00019f30: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00019f40: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00019f50: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-00019f60: 2d30 382d 3231 2030 313a 3330 3a30 352e  -08-21 01:30:05.
-00019f70: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-00019f80: 2548 3a25 4d3a 2553 2e25 6622 290a 2020  %H:%M:%S.%f").  
-00019f90: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
-00019fa0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00019fb0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00019fc0: 286c 6173 745f 6461 7928 2261 2229 292e  (last_day("a")).
-00019fd0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00019fe0: 2020 5b52 6f77 284c 4153 545f 4441 5928    [Row(LAST_DAY(
-00019ff0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-0001a000: 7465 2832 3032 302c 2035 2c20 3331 2929  te(2020, 5, 31))
-0001a010: 2c20 526f 7728 4c41 5354 5f44 4159 2822  , Row(LAST_DAY("
-0001a020: 4122 293d 6461 7465 7469 6d65 2e64 6174  A")=datetime.dat
-0001a030: 6528 3230 3230 2c20 382c 2033 3129 295d  e(2020, 8, 31))]
-0001a040: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0001a050: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001a060: 652c 2022 6c61 7374 5f64 6179 2229 0a20  e, "last_day"). 
-0001a070: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0001a080: 6e28 226c 6173 745f 6461 7922 2928 6329  n("last_day")(c)
-0001a090: 0a0a 0a64 6566 206d 696e 7574 6528 653a  ...def minute(e:
-0001a0a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0001a0b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0001a0c0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
-0001a0d0: 6865 206d 696e 7574 6520 6672 6f6d 2061  he minute from a
-0001a0e0: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
-0001a0f0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
-0001a100: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001a110: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001a120: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001a130: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0001a140: 6461 7461 6672 616d 6528 5b0a 2020 2020  dataframe([.    
-0001a150: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
-0001a160: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
-0001a170: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
-0001a180: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
-0001a190: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
-0001a1a0: 4d3a 2553 2e25 6622 292c 0a20 2020 2020  M:%S.%f"),.     
-0001a1b0: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-0001a1c0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-0001a1d0: 7074 696d 6528 2232 3032 302d 3038 2d32  ptime("2020-08-2
-0001a1e0: 3120 3031 3a33 303a 3035 2e30 3030 222c  1 01:30:05.000",
-0001a1f0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-0001a200: 3a25 532e 2566 2229 0a20 2020 2020 2020  :%S.%f").       
-0001a210: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
-0001a220: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-0001a230: 3e20 6466 2e73 656c 6563 7428 6d69 6e75  > df.select(minu
-0001a240: 7465 2822 6122 2929 2e63 6f6c 6c65 6374  te("a")).collect
-0001a250: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001a260: 4d49 4e55 5445 2822 4122 293d 3131 292c  MINUTE("A")=11),
-0001a270: 2052 6f77 284d 494e 5554 4528 2241 2229   Row(MINUTE("A")
-0001a280: 3d33 3029 5d0a 2020 2020 2222 220a 2020  =30)].    """.  
-0001a290: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0001a2a0: 5f73 7472 2865 2c20 226d 696e 7574 6522  _str(e, "minute"
-0001a2b0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0001a2c0: 6c74 696e 2822 6d69 6e75 7465 2229 2863  ltin("minute")(c
-0001a2d0: 290a 0a0a 6465 6620 6e65 7874 5f64 6179  )...def next_day
-0001a2e0: 2864 6174 653a 2043 6f6c 756d 6e4f 724e  (date: ColumnOrN
-0001a2f0: 616d 652c 2064 6179 5f6f 665f 7765 656b  ame, day_of_week
-0001a300: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
-0001a310: 6c29 202d 3e20 436f 6c75 6d6e 3a0a 2020  l) -> Column:.  
-0001a320: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-0001a330: 7320 7468 6520 6461 7465 206f 6620 7468  s the date of th
-0001a340: 6520 6669 7273 7420 7370 6563 6966 6965  e first specifie
-0001a350: 6420 444f 5720 2864 6179 206f 6620 7765  d DOW (day of we
-0001a360: 656b 2920 7468 6174 206f 6363 7572 7320  ek) that occurs 
-0001a370: 6166 7465 7220 7468 6520 696e 7075 7420  after the input 
-0001a380: 6461 7465 2e0a 0a20 2020 2045 7861 6d70  date...    Examp
-0001a390: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0001a3a0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
-0001a3b0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0001a3c0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001a3d0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
-0001a3e0: 2020 2020 2020 2e2e 2e20 2020 2020 2864        ...     (d
-0001a3f0: 6174 6574 696d 652e 6461 7465 2e66 726f  atetime.date.fro
-0001a400: 6d69 736f 666f 726d 6174 2822 3230 3230  misoformat("2020
-0001a410: 2d30 382d 3031 2229 2c20 226d 6f22 292c  -08-01"), "mo"),
-0001a420: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0001a430: 2028 6461 7465 7469 6d65 2e64 6174 652e   (datetime.date.
-0001a440: 6672 6f6d 6973 6f66 6f72 6d61 7428 2232  fromisoformat("2
-0001a450: 3032 302d 3132 2d30 3122 292c 2022 7765  020-12-01"), "we
-0001a460: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-0001a470: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-0001a480: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-0001a490: 3e20 6466 2e73 656c 6563 7428 6e65 7874  > df.select(next
-0001a4a0: 5f64 6179 2822 6122 2c20 636f 6c28 2262  _day("a", col("b
-0001a4b0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-0001a4c0: 2020 2020 2020 205b 526f 7728 4e45 5854         [Row(NEXT
-0001a4d0: 5f44 4159 2822 4122 2c20 2242 2229 3d64  _DAY("A", "B")=d
-0001a4e0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-0001a4f0: 302c 2038 2c20 3329 292c 2052 6f77 284e  0, 8, 3)), Row(N
-0001a500: 4558 545f 4441 5928 2241 222c 2022 4222  EXT_DAY("A", "B"
-0001a510: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
-0001a520: 3230 3230 2c20 3132 2c20 3229 295d 0a20  2020, 12, 2))]. 
-0001a530: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001a540: 6c65 6374 286e 6578 745f 6461 7928 2261  lect(next_day("a
-0001a550: 222c 2022 6672 2229 292e 636f 6c6c 6563  ", "fr")).collec
-0001a560: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0001a570: 284e 4558 545f 4441 5928 2241 222c 2027  (NEXT_DAY("A", '
-0001a580: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
-0001a590: 7465 2832 3032 302c 2038 2c20 3729 292c  te(2020, 8, 7)),
-0001a5a0: 2052 6f77 284e 4558 545f 4441 5928 2241   Row(NEXT_DAY("A
-0001a5b0: 222c 2027 4652 2729 3d64 6174 6574 696d  ", 'FR')=datetim
-0001a5c0: 652e 6461 7465 2832 3032 302c 2031 322c  e.date(2020, 12,
-0001a5d0: 2034 2929 5d0a 2020 2020 2222 220a 2020   4))].    """.  
-0001a5e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0001a5f0: 5f73 7472 2864 6174 652c 2022 6e65 7874  _str(date, "next
-0001a600: 5f64 6179 2229 0a20 2020 2072 6574 7572  _day").    retur
-0001a610: 6e20 6275 696c 7469 6e28 226e 6578 745f  n builtin("next_
-0001a620: 6461 7922 2928 632c 2043 6f6c 756d 6e2e  day")(c, Column.
-0001a630: 5f74 6f5f 6578 7072 2864 6179 5f6f 665f  _to_expr(day_of_
-0001a640: 7765 656b 2929 0a0a 0a64 6566 2070 7265  week))...def pre
-0001a650: 7669 6f75 735f 6461 7928 6461 7465 3a20  vious_day(date: 
-0001a660: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6461  ColumnOrName, da
-0001a670: 795f 6f66 5f77 6565 6b3a 2043 6f6c 756d  y_of_week: Colum
-0001a680: 6e4f 724c 6974 6572 616c 2920 2d3e 2043  nOrLiteral) -> C
-0001a690: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0001a6a0: 2020 2052 6574 7572 6e73 2074 6865 2064     Returns the d
-0001a6b0: 6174 6520 6f66 2074 6865 2066 6972 7374  ate of the first
-0001a6c0: 2073 7065 6369 6669 6564 2044 4f57 2028   specified DOW (
-0001a6d0: 6461 7920 6f66 2077 6565 6b29 2074 6861  day of week) tha
-0001a6e0: 7420 6f63 6375 7273 2062 6566 6f72 6520  t occurs before 
-0001a6f0: 7468 6520 696e 7075 7420 6461 7465 2e0a  the input date..
-0001a700: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0001a710: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0001a720: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
-0001a730: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001a740: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0001a750: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
-0001a760: 2e2e 2e20 2020 2020 2864 6174 6574 696d  ...     (datetim
-0001a770: 652e 6461 7465 2e66 726f 6d69 736f 666f  e.date.fromisofo
-0001a780: 726d 6174 2822 3230 3230 2d30 382d 3031  rmat("2020-08-01
-0001a790: 2229 2c20 226d 6f22 292c 0a20 2020 2020  "), "mo"),.     
-0001a7a0: 2020 202e 2e2e 2020 2020 2028 6461 7465     ...     (date
-0001a7b0: 7469 6d65 2e64 6174 652e 6672 6f6d 6973  time.date.fromis
-0001a7c0: 6f66 6f72 6d61 7428 2232 3032 302d 3132  oformat("2020-12
-0001a7d0: 2d30 3122 292c 2022 7765 2229 2c0a 2020  -01"), "we"),.  
-0001a7e0: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
-0001a7f0: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-0001a800: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0001a810: 656c 6563 7428 7072 6576 696f 7573 5f64  elect(previous_d
-0001a820: 6179 2822 6122 2c20 636f 6c28 2262 2229  ay("a", col("b")
-0001a830: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0001a840: 2020 2020 205b 526f 7728 5052 4556 494f       [Row(PREVIO
-0001a850: 5553 5f44 4159 2822 4122 2c20 2242 2229  US_DAY("A", "B")
-0001a860: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
-0001a870: 3032 302c 2037 2c20 3237 2929 2c20 526f  020, 7, 27)), Ro
-0001a880: 7728 5052 4556 494f 5553 5f44 4159 2822  w(PREVIOUS_DAY("
-0001a890: 4122 2c20 2242 2229 3d64 6174 6574 696d  A", "B")=datetim
-0001a8a0: 652e 6461 7465 2832 3032 302c 2031 312c  e.date(2020, 11,
-0001a8b0: 2032 3529 295d 0a20 2020 2020 2020 203e   25))].        >
-0001a8c0: 3e3e 2064 662e 7365 6c65 6374 2870 7265  >> df.select(pre
-0001a8d0: 7669 6f75 735f 6461 7928 2261 222c 2022  vious_day("a", "
-0001a8e0: 6672 2229 292e 636f 6c6c 6563 7428 290a  fr")).collect().
-0001a8f0: 2020 2020 2020 2020 5b52 6f77 2850 5245          [Row(PRE
-0001a900: 5649 4f55 535f 4441 5928 2241 222c 2027  VIOUS_DAY("A", '
-0001a910: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
-0001a920: 7465 2832 3032 302c 2037 2c20 3331 2929  te(2020, 7, 31))
-0001a930: 2c20 526f 7728 5052 4556 494f 5553 5f44  , Row(PREVIOUS_D
-0001a940: 4159 2822 4122 2c20 2746 5227 293d 6461  AY("A", 'FR')=da
-0001a950: 7465 7469 6d65 2e64 6174 6528 3230 3230  tetime.date(2020
-0001a960: 2c20 3131 2c20 3237 2929 5d0a 2020 2020  , 11, 27))].    
-0001a970: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0001a980: 636f 6c5f 6966 5f73 7472 2864 6174 652c  col_if_str(date,
-0001a990: 2022 7072 6576 696f 7573 5f64 6179 2229   "previous_day")
-0001a9a0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001a9b0: 7469 6e28 2270 7265 7669 6f75 735f 6461  tin("previous_da
-0001a9c0: 7922 2928 632c 2043 6f6c 756d 6e2e 5f74  y")(c, Column._t
-0001a9d0: 6f5f 6578 7072 2864 6179 5f6f 665f 7765  o_expr(day_of_we
-0001a9e0: 656b 2929 0a0a 0a64 6566 2073 6563 6f6e  ek))...def secon
-0001a9f0: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
-0001aa00: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0001aa10: 2020 2222 220a 2020 2020 4578 7472 6163    """.    Extrac
-0001aa20: 7473 2074 6865 2073 6563 6f6e 6420 6672  ts the second fr
-0001aa30: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
-0001aa40: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
-0001aa50: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001aa60: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
-0001aa70: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
-0001aa80: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001aa90: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
-0001aaa0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001aab0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-0001aac0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-0001aad0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
-0001aae0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-0001aaf0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
-0001ab00: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-0001ab10: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0001ab20: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-0001ab30: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
-0001ab40: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-0001ab50: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
-0001ab60: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
-0001ab70: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0001ab80: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001ab90: 7365 636f 6e64 2822 6122 2929 2e63 6f6c  second("a")).col
-0001aba0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0001abb0: 526f 7728 5345 434f 4e44 2822 4122 293d  Row(SECOND("A")=
-0001abc0: 3230 292c 2052 6f77 2853 4543 4f4e 4428  20), Row(SECOND(
-0001abd0: 2241 2229 3d35 295d 0a20 2020 2022 2222  "A")=5)].    """
-0001abe0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0001abf0: 5f69 665f 7374 7228 652c 2022 7365 636f  _if_str(e, "seco
-0001ac00: 6e64 2229 0a20 2020 2072 6574 7572 6e20  nd").    return 
-0001ac10: 6275 696c 7469 6e28 2273 6563 6f6e 6422  builtin("second"
-0001ac20: 2928 6329 0a0a 0a64 6566 206d 6f6e 7468  )(c)...def month
-0001ac30: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0001ac40: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001ac50: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
-0001ac60: 7320 7468 6520 6d6f 6e74 6820 6672 6f6d  s the month from
-0001ac70: 2061 2064 6174 6520 6f72 2074 696d 6573   a date or times
-0001ac80: 7461 6d70 2e0a 0a20 2020 2045 7861 6d70  tamp...    Examp
-0001ac90: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0001aca0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
-0001acb0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0001acc0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001acd0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
-0001ace0: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
-0001acf0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
-0001ad00: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
-0001ad10: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
-0001ad20: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
-0001ad30: 3a25 4d3a 2553 2e25 6622 292c 0a20 2020  :%M:%S.%f"),.   
-0001ad40: 2020 2020 202e 2e2e 2020 2020 2064 6174       ...     dat
-0001ad50: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
-0001ad60: 7472 7074 696d 6528 2232 3032 302d 3038  trptime("2020-08
-0001ad70: 2d32 3120 3031 3a33 303a 3035 2e30 3030  -21 01:30:05.000
-0001ad80: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
-0001ad90: 254d 3a25 532e 2566 2229 0a20 2020 2020  %M:%S.%f").     
-0001ada0: 2020 202e 2e2e 205d 2c20 7363 6865 6d61     ... ], schema
-0001adb0: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-0001adc0: 3e3e 3e20 6466 2e73 656c 6563 7428 6d6f  >>> df.select(mo
-0001add0: 6e74 6828 2261 2229 292e 636f 6c6c 6563  nth("a")).collec
-0001ade0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0001adf0: 284d 4f4e 5448 2822 4122 293d 3529 2c20  (MONTH("A")=5), 
-0001ae00: 526f 7728 4d4f 4e54 4828 2241 2229 3d38  Row(MONTH("A")=8
-0001ae10: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0001ae20: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0001ae30: 7228 652c 2022 6d6f 6e74 6822 290a 2020  r(e, "month").  
-0001ae40: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001ae50: 2822 6d6f 6e74 6822 2928 6329 0a0a 0a64  ("month")(c)...d
-0001ae60: 6566 206d 6f6e 7468 6e61 6d65 2865 3a20  ef monthname(e: 
-0001ae70: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0001ae80: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0001ae90: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
-0001aea0: 6520 7468 7265 652d 6c65 7474 6572 206d  e three-letter m
-0001aeb0: 6f6e 7468 206e 616d 6520 6672 6f6d 2074  onth name from t
-0001aec0: 6865 2073 7065 6369 6669 6564 2064 6174  he specified dat
-0001aed0: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
-0001aee0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0001aef0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0001af00: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
-0001af10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001af20: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0001af30: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
-0001af40: 2e2e 2e20 2020 2020 6461 7465 7469 6d65  ...     datetime
-0001af50: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
-0001af60: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
-0001af70: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
-0001af80: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-0001af90: 2e25 6622 292c 0a20 2020 2020 2020 202e  .%f"),.        .
-0001afa0: 2e2e 2020 2020 2064 6174 6574 696d 652e  ..     datetime.
-0001afb0: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-0001afc0: 6528 2232 3032 302d 3038 2d32 3120 3031  e("2020-08-21 01
-0001afd0: 3a33 303a 3035 2e30 3030 222c 2022 2559  :30:05.000", "%Y
-0001afe0: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-0001aff0: 2566 2229 0a20 2020 2020 2020 202e 2e2e  %f").        ...
-0001b000: 205d 2c20 7363 6865 6d61 3d5b 2261 225d   ], schema=["a"]
-0001b010: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0001b020: 2e73 656c 6563 7428 6d6f 6e74 686e 616d  .select(monthnam
-0001b030: 6528 2261 2229 292e 636f 6c6c 6563 7428  e("a")).collect(
-0001b040: 290a 2020 2020 2020 2020 5b52 6f77 284d  ).        [Row(M
-0001b050: 4f4e 5448 4e41 4d45 2822 4122 293d 274d  ONTHNAME("A")='M
-0001b060: 6179 2729 2c20 526f 7728 4d4f 4e54 484e  ay'), Row(MONTHN
-0001b070: 414d 4528 2241 2229 3d27 4175 6727 295d  AME("A")='Aug')]
-0001b080: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0001b090: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001b0a0: 652c 2022 6d6f 6e74 686e 616d 6522 290a  e, "monthname").
-0001b0b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001b0c0: 696e 2822 6d6f 6e74 686e 616d 6522 2928  in("monthname")(
-0001b0d0: 6329 0a0a 0a64 6566 2071 7561 7274 6572  c)...def quarter
-0001b0e0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0001b0f0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001b100: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
-0001b110: 7320 7468 6520 7175 6172 7465 7220 6672  s the quarter fr
-0001b120: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
-0001b130: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
-0001b140: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001b150: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
-0001b160: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
-0001b170: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001b180: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
-0001b190: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001b1a0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-0001b1b0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-0001b1c0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
-0001b1d0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-0001b1e0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
-0001b1f0: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-0001b200: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0001b210: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-0001b220: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
-0001b230: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-0001b240: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
-0001b250: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
-0001b260: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0001b270: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001b280: 7175 6172 7465 7228 2261 2229 292e 636f  quarter("a")).co
-0001b290: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001b2a0: 5b52 6f77 2851 5541 5254 4552 2822 4122  [Row(QUARTER("A"
-0001b2b0: 293d 3229 2c20 526f 7728 5155 4152 5445  )=2), Row(QUARTE
-0001b2c0: 5228 2241 2229 3d33 295d 0a20 2020 2022  R("A")=3)].    "
-0001b2d0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001b2e0: 6f6c 5f69 665f 7374 7228 652c 2022 7175  ol_if_str(e, "qu
-0001b2f0: 6172 7465 7222 290a 2020 2020 7265 7475  arter").    retu
-0001b300: 726e 2062 7569 6c74 696e 2822 7175 6172  rn builtin("quar
-0001b310: 7465 7222 2928 6329 0a0a 0a64 6566 2079  ter")(c)...def y
-0001b320: 6561 7228 653a 2043 6f6c 756d 6e4f 724e  ear(e: ColumnOrN
-0001b330: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001b340: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
-0001b350: 6163 7473 2074 6865 2079 6561 7220 6672  acts the year fr
-0001b360: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
-0001b370: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
-0001b380: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0001b390: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
-0001b3a0: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
-0001b3b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001b3c0: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
-0001b3d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001b3e0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-0001b3f0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-0001b400: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
-0001b410: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-0001b420: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
-0001b430: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-0001b440: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0001b450: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-0001b460: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
-0001b470: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-0001b480: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
-0001b490: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
-0001b4a0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0001b4b0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001b4c0: 7965 6172 2822 6122 2929 2e63 6f6c 6c65  year("a")).colle
-0001b4d0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0001b4e0: 7728 5945 4152 2822 4122 293d 3230 3230  w(YEAR("A")=2020
-0001b4f0: 292c 2052 6f77 2859 4541 5228 2241 2229  ), Row(YEAR("A")
-0001b500: 3d32 3032 3029 5d0a 2020 2020 2222 220a  =2020)].    """.
-0001b510: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0001b520: 6966 5f73 7472 2865 2c20 2279 6561 7222  if_str(e, "year"
-0001b530: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0001b540: 6c74 696e 2822 7965 6172 2229 2863 290a  ltin("year")(c).
-0001b550: 0a0a 6465 6620 7379 7364 6174 6528 2920  ..def sysdate() 
-0001b560: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0001b570: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-0001b580: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
-0001b590: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
-0001b5a0: 7465 6d2c 2062 7574 2069 6e20 7468 6520  tem, but in the 
-0001b5b0: 5554 4320 7469 6d65 207a 6f6e 652e 0a0a  UTC time zone...
-0001b5c0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0001b5d0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001b5e0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001b5f0: 6174 6166 7261 6d65 285b 315d 2c20 7363  ataframe([1], sc
-0001b600: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0001b610: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0001b620: 7428 7379 7364 6174 6528 2929 2e63 6f6c  t(sysdate()).col
-0001b630: 6c65 6374 2829 2069 7320 6e6f 7420 4e6f  lect() is not No
-0001b640: 6e65 0a20 2020 2020 2020 2054 7275 650a  ne.        True.
-0001b650: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
-0001b660: 726e 2062 7569 6c74 696e 2822 7379 7364  rn builtin("sysd
-0001b670: 6174 6522 2928 290a 0a0a 6465 6620 6d6f  ate")()...def mo
-0001b680: 6e74 6873 5f62 6574 7765 656e 2864 6174  nths_between(dat
-0001b690: 6531 3a20 436f 6c75 6d6e 4f72 4e61 6d65  e1: ColumnOrName
-0001b6a0: 2c20 6461 7465 323a 2043 6f6c 756d 6e4f  , date2: ColumnO
-0001b6b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0001b6c0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0001b6d0: 7475 726e 7320 7468 6520 6e75 6d62 6572  turns the number
-0001b6e0: 206f 6620 6d6f 6e74 6873 2062 6574 7765   of months betwe
-0001b6f0: 656e 2074 776f 2044 4154 4520 6f72 2054  en two DATE or T
-0001b700: 494d 4553 5441 4d50 2076 616c 7565 732e  IMESTAMP values.
-0001b710: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0001b720: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001b730: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-0001b740: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0001b750: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0001b760: 6166 7261 6d65 285b 5b0a 2020 2020 2020  aframe([[.      
-0001b770: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-0001b780: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-0001b790: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
-0001b7a0: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
-0001b7b0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-0001b7c0: 2553 2e25 6622 292c 0a20 2020 2020 2020  %S.%f"),.       
-0001b7d0: 202e 2e2e 2020 2020 2064 6174 6574 696d   ...     datetim
-0001b7e0: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
-0001b7f0: 696d 6528 2232 3032 302d 3038 2d32 3120  ime("2020-08-21 
-0001b800: 3031 3a33 303a 3035 2e30 3030 222c 2022  01:30:05.000", "
-0001b810: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
-0001b820: 532e 2566 2229 0a20 2020 2020 2020 202e  S.%f").        .
-0001b830: 2e2e 205d 5d2c 2073 6368 656d 613d 5b22  .. ]], schema=["
-0001b840: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
-0001b850: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001b860: 6d6f 6e74 6873 5f62 6574 7765 656e 2822  months_between("
-0001b870: 6122 2c20 2262 2229 292e 636f 6c6c 6563  a", "b")).collec
-0001b880: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0001b890: 284d 4f4e 5448 535f 4245 5457 4545 4e28  (MONTHS_BETWEEN(
-0001b8a0: 2241 222c 2022 4222 293d 4465 6369 6d61  "A", "B")=Decima
-0001b8b0: 6c28 272d 332e 3632 3934 3532 2729 295d  l('-3.629452'))]
-0001b8c0: 0a20 2020 2022 2222 0a20 2020 2063 3120  .    """.    c1 
-0001b8d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001b8e0: 2864 6174 6531 2c20 226d 6f6e 7468 735f  (date1, "months_
-0001b8f0: 6265 7477 6565 6e22 290a 2020 2020 6332  between").    c2
-0001b900: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0001b910: 7228 6461 7465 322c 2022 6d6f 6e74 6873  r(date2, "months
-0001b920: 5f62 6574 7765 656e 2229 0a20 2020 2072  _between").    r
-0001b930: 6574 7572 6e20 6275 696c 7469 6e28 226d  eturn builtin("m
-0001b940: 6f6e 7468 735f 6265 7477 6565 6e22 2928  onths_between")(
-0001b950: 6331 2c20 6332 290a 0a0a 6465 6620 746f  c1, c2)...def to
-0001b960: 5f67 656f 6772 6170 6879 2865 3a20 436f  _geography(e: Co
-0001b970: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0001b980: 6f6c 756d 6e3a 0a20 2020 2022 2222 5061  olumn:.    """Pa
-0001b990: 7273 6573 2061 6e20 696e 7075 7420 616e  rses an input an
-0001b9a0: 6420 7265 7475 726e 7320 6120 7661 6c75  d returns a valu
-0001b9b0: 6520 6f66 2074 7970 6520 4745 4f47 5241  e of type GEOGRA
-0001b9c0: 5048 592e 2053 7570 706f 7274 6564 2069  PHY. Supported i
-0001b9d0: 6e70 7574 7320 6172 6520 7374 7269 6e67  nputs are string
-0001b9e0: 7320 696e 0a0a 2020 2020 2020 2020 2d20  s in..        - 
-0001b9f0: 574b 5420 2877 656c 6c2d 6b6e 6f77 6e20  WKT (well-known 
-0001ba00: 7465 7874 292e 0a20 2020 2020 2020 202d  text)..        -
-0001ba10: 2057 4b42 2028 7765 6c6c 2d6b 6e6f 776e   WKB (well-known
-0001ba20: 2062 696e 6172 7929 2069 6e20 6865 7861   binary) in hexa
-0001ba30: 6465 6369 6d61 6c20 666f 726d 6174 2028  decimal format (
-0001ba40: 7769 7468 6f75 7420 6120 6c65 6164 696e  without a leadin
-0001ba50: 6720 3078 292e 0a20 2020 2020 2020 202d  g 0x)..        -
-0001ba60: 2045 574b 5420 2865 7874 656e 6465 6420   EWKT (extended 
-0001ba70: 7765 6c6c 2d6b 6e6f 776e 2074 6578 7429  well-known text)
-0001ba80: 2e0a 2020 2020 2020 2020 2d20 4557 4b42  ..        - EWKB
-0001ba90: 2028 6578 7465 6e64 6564 2077 656c 6c2d   (extended well-
-0001baa0: 6b6e 6f77 6e20 6269 6e61 7279 2920 696e  known binary) in
-0001bab0: 2068 6578 6164 6563 696d 616c 2066 6f72   hexadecimal for
-0001bac0: 6d61 7420 2877 6974 686f 7574 2061 206c  mat (without a l
-0001bad0: 6561 6469 6e67 2030 7829 2e0a 2020 2020  eading 0x)..    
-0001bae0: 2020 2020 2d20 4765 6f4a 534f 4e2e 0a0a      - GeoJSON...
-0001baf0: 2020 2020 666f 726d 6174 2e0a 0a20 2020      format...   
-0001bb00: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0001bb10: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0001bb20: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0001bb30: 7261 6d65 285b 2750 4f49 4e54 282d 3132  rame(['POINT(-12
-0001bb40: 322e 3335 2033 372e 3535 2927 2c20 2750  2.35 37.55)', 'P
-0001bb50: 4f49 4e54 2832 302e 3932 2034 332e 3333  OINT(20.92 43.33
-0001bb60: 2927 5d2c 2073 6368 656d 613d 5b27 6127  )'], schema=['a'
-0001bb70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0001bb80: 662e 7365 6c65 6374 2874 6f5f 6765 6f67  f.select(to_geog
-0001bb90: 7261 7068 7928 636f 6c28 2261 2229 2929  raphy(col("a")))
-0001bba0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001bbb0: 2020 205b 526f 7728 544f 5f47 454f 4752     [Row(TO_GEOGR
-0001bbc0: 4150 4859 2822 4122 293d 277b 5c5c 6e20  APHY("A")='{\\n 
-0001bbd0: 2022 636f 6f72 6469 6e61 7465 7322 3a20   "coordinates": 
-0001bbe0: 5b5c 5c6e 2020 2020 2d31 3232 2e33 352c  [\\n    -122.35,
-0001bbf0: 5c5c 6e20 2020 2033 372e 3535 5c5c 6e20  \\n    37.55\\n 
-0001bc00: 205d 2c5c 5c6e 2020 2274 7970 6522 3a20   ],\\n  "type": 
-0001bc10: 2250 6f69 6e74 225c 5c6e 7d27 292c 2052  "Point"\\n}'), R
-0001bc20: 6f77 2854 4f5f 4745 4f47 5241 5048 5928  ow(TO_GEOGRAPHY(
-0001bc30: 2241 2229 3d27 7b5c 5c6e 2020 2263 6f6f  "A")='{\\n  "coo
-0001bc40: 7264 696e 6174 6573 223a 205b 5c5c 6e20  rdinates": [\\n 
-0001bc50: 2020 2032 302e 3932 2c5c 5c6e 2020 2020     20.92,\\n    
-0001bc60: 3433 2e33 335c 5c6e 2020 5d2c 5c5c 6e20  43.33\\n  ],\\n 
-0001bc70: 2022 7479 7065 223a 2022 506f 696e 7422   "type": "Point"
-0001bc80: 5c5c 6e7d 2729 5d0a 0a20 2020 2042 6573  \\n}')]..    Bes
-0001bc90: 6964 6573 2073 7472 696e 6773 2c20 6269  ides strings, bi
-0001bca0: 6e61 7279 2072 6570 7265 7365 6e74 6174  nary representat
-0001bcb0: 696f 6e20 696e 2057 4b42 2061 6e64 2045  ion in WKB and E
-0001bcc0: 574b 4220 666f 726d 6174 2063 616e 2062  WKB format can b
-0001bcd0: 6520 7061 7273 6564 2c20 6f72 206f 626a  e parsed, or obj
-0001bce0: 6563 7473 2061 6468 6572 696e 6720 746f  ects adhering to
-0001bcf0: 2047 656f 4a53 4f4e 2066 6f72 6d61 742e   GeoJSON format.
-0001bd00: 0a20 2020 2046 6f72 2061 6c6c 2073 7570  .    For all sup
-0001bd10: 706f 7274 6564 2066 6f72 6d61 7473 2063  ported formats c
-0001bd20: 6f6e 6665 7220 6874 7470 733a 2f2f 646f  onfer https://do
-0001bd30: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
-0001bd40: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
-0001bd50: 652f 6461 7461 2d74 7970 6573 2d67 656f  e/data-types-geo
-0001bd60: 7370 6174 6961 6c23 7375 7070 6f72 7465  spatial#supporte
-0001bd70: 642d 6765 6f73 7061 7469 616c 2d6f 626a  d-geospatial-obj
-0001bd80: 6563 742d 7479 7065 732e 0a20 2020 2022  ect-types..    "
-0001bd90: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001bda0: 6f6c 5f69 665f 7374 7228 652c 2022 746f  ol_if_str(e, "to
-0001bdb0: 5f67 656f 6772 6170 6879 2229 0a20 2020  _geography").   
-0001bdc0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0001bdd0: 2274 6f5f 6765 6f67 7261 7068 7922 2928  "to_geography")(
-0001bde0: 6329 0a0a 0a64 6566 2061 7272 6179 735f  c)...def arrays_
-0001bdf0: 6f76 6572 6c61 7028 6172 7261 7931 3a20  overlap(array1: 
-0001be00: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6172  ColumnOrName, ar
-0001be10: 7261 7932 3a20 436f 6c75 6d6e 4f72 4e61  ray2: ColumnOrNa
-0001be20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0001be30: 2020 2022 2222 436f 6d70 6172 6573 2077     """Compares w
-0001be40: 6865 7468 6572 2074 776f 2041 5252 4159  hether two ARRAY
-0001be50: 7320 6861 7665 2061 7420 6c65 6173 7420  s have at least 
-0001be60: 6f6e 6520 656c 656d 656e 7420 696e 2063  one element in c
-0001be70: 6f6d 6d6f 6e2e 2052 6574 7572 6e73 2054  ommon. Returns T
-0001be80: 5255 450a 2020 2020 6966 2074 6865 7265  RUE.    if there
-0001be90: 2069 7320 6174 206c 6561 7374 206f 6e65   is at least one
-0001bea0: 2065 6c65 6d65 6e74 2069 6e20 636f 6d6d   element in comm
-0001beb0: 6f6e 3b20 6f74 6865 7277 6973 6520 7265  on; otherwise re
-0001bec0: 7475 726e 7320 4641 4c53 452e 2054 6865  turns FALSE. The
-0001bed0: 2066 756e 6374 696f 6e0a 2020 2020 6973   function.    is
-0001bee0: 204e 554c 4c2d 7361 6665 2c20 6d65 616e   NULL-safe, mean
-0001bef0: 696e 6720 6974 2074 7265 6174 7320 4e55  ing it treats NU
-0001bf00: 4c4c 7320 6173 206b 6e6f 776e 2076 616c  LLs as known val
-0001bf10: 7565 7320 666f 7220 636f 6d70 6172 696e  ues for comparin
-0001bf20: 6720 6571 7561 6c69 7479 2e0a 0a20 2020  g equality...   
-0001bf30: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0001bf40: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0001bf50: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
-0001bf60: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
-0001bf70: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0001bf80: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0001bf90: 616d 6528 5b52 6f77 285b 312c 2032 5d2c  ame([Row([1, 2],
-0001bfa0: 205b 312c 2033 5d29 2c20 526f 7728 5b31   [1, 3]), Row([1
-0001bfb0: 2c20 325d 2c20 5b33 2c20 345d 295d 2c20  , 2], [3, 4])], 
-0001bfc0: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
-0001bfd0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0001bfe0: 662e 7365 6c65 6374 2861 7272 6179 735f  f.select(arrays_
-0001bff0: 6f76 6572 6c61 7028 2261 222c 2022 6222  overlap("a", "b"
-0001c000: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-0001c010: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0001c020: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0001c030: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0001c040: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001c050: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001c060: 207c 5472 7565 2020 2020 2020 7c0a 2020   |True      |.  
-0001c070: 2020 2020 2020 7c46 616c 7365 2020 2020        |False    
-0001c080: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001c090: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001c0a0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0001c0b0: 2222 220a 2020 2020 6131 203d 205f 746f  """.    a1 = _to
-0001c0c0: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
-0001c0d0: 7931 2c20 2261 7272 6179 735f 6f76 6572  y1, "arrays_over
-0001c0e0: 6c61 7022 290a 2020 2020 6132 203d 205f  lap").    a2 = _
-0001c0f0: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
-0001c100: 7261 7932 2c20 2261 7272 6179 735f 6f76  ray2, "arrays_ov
-0001c110: 6572 6c61 7022 290a 2020 2020 7265 7475  erlap").    retu
-0001c120: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
-0001c130: 7973 5f6f 7665 726c 6170 2229 2861 312c  ys_overlap")(a1,
-0001c140: 2061 3229 0a0a 0a64 6566 2061 7272 6179   a2)...def array
-0001c150: 5f64 6973 7469 6e63 7428 636f 6c3a 2043  _distinct(col: C
-0001c160: 6f6c 756d 6e4f 724e 616d 6529 3a0a 2020  olumnOrName):.  
-0001c170: 2020 2222 2254 6865 2066 756e 6374 696f    """The functio
-0001c180: 6e20 6578 636c 7564 6573 2061 6e79 2064  n excludes any d
-0001c190: 7570 6c69 6361 7465 2065 6c65 6d65 6e74  uplicate element
-0001c1a0: 7320 7468 6174 2061 7265 2070 7265 7365  s that are prese
-0001c1b0: 6e74 2069 6e20 7468 6520 696e 7075 7420  nt in the input 
-0001c1c0: 4152 5241 592e 0a20 2020 2054 6865 2066  ARRAY..    The f
-0001c1d0: 756e 6374 696f 6e20 6973 206e 6f74 2067  unction is not g
-0001c1e0: 7561 7261 6e74 6565 6420 746f 2072 6574  uaranteed to ret
-0001c1f0: 7572 6e20 7468 6520 656c 656d 656e 7473  urn the elements
-0001c200: 2069 6e20 7468 6520 4152 5241 5920 696e   in the ARRAY in
-0001c210: 2061 2073 7065 6369 6669 6320 6f72 6465   a specific orde
-0001c220: 722e 0a20 2020 2054 6865 2066 756e 6374  r..    The funct
-0001c230: 696f 6e20 6973 204e 554c 4c20 7361 6665  ion is NULL safe
-0001c240: 2c20 7768 6963 6820 6d65 616e 7320 7468  , which means th
-0001c250: 6174 2069 7420 7472 6561 7473 204e 554c  at it treats NUL
-0001c260: 4c73 2061 7320 6b6e 6f77 6e20 7661 6c75  Ls as known valu
-0001c270: 6573 2077 6865 6e20 6964 656e 7469 6679  es when identify
-0001c280: 696e 6720 6475 706c 6963 6174 6520 656c  ing duplicate el
-0001c290: 656d 656e 7473 2e0a 0a20 2020 2041 7267  ements...    Arg
-0001c2a0: 733a 0a20 2020 2020 2020 2063 6f6c 3a20  s:.        col: 
-0001c2b0: 5468 6520 6172 7261 7920 636f 6c75 6d6e  The array column
-0001c2c0: 0a0a 2020 2020 5265 7475 726e 733a 0a20  ..    Returns:. 
-0001c2d0: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
-0001c2e0: 206e 6577 2041 5252 4159 2074 6861 7420   new ARRAY that 
-0001c2f0: 636f 6e74 6169 6e73 206f 6e6c 7920 7468  contains only th
-0001c300: 6520 6469 7374 696e 6374 2065 6c65 6d65  e distinct eleme
-0001c310: 6e74 7320 6672 6f6d 2074 6865 2069 6e70  nts from the inp
-0001c320: 7574 2041 5252 4159 2e0a 0a20 2020 2045  ut ARRAY...    E
-0001c330: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0001c340: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0001c350: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-0001c360: 6e63 7469 6f6e 7320 696d 706f 7274 2061  nctions import a
-0001c370: 7272 6179 5f63 6f6e 7374 7275 6374 2c61  rray_construct,a
-0001c380: 7272 6179 5f64 6973 7469 6e63 742c 6c69  rray_distinct,li
-0001c390: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-0001c3a0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001c3b0: 6544 6174 6146 7261 6d65 285b 5b22 3122  eDataFrame([["1"
-0001c3c0: 5d5d 2c20 5b22 4122 5d29 0a20 2020 2020  ]], ["A"]).     
-0001c3d0: 2020 203e 3e3e 2064 6620 3d20 6466 2e77     >>> df = df.w
-0001c3e0: 6974 6843 6f6c 756d 6e28 2261 7272 6179  ithColumn("array
-0001c3f0: 222c 2061 7272 6179 5f63 6f6e 7374 7275  ", array_constru
-0001c400: 6374 286c 6974 2831 292c 206c 6974 2831  ct(lit(1), lit(1
-0001c410: 292c 206c 6974 2831 292c 206c 6974 2832  ), lit(1), lit(2
-0001c420: 292c 206c 6974 2833 292c 206c 6974 2832  ), lit(3), lit(2
-0001c430: 292c 206c 6974 2832 2929 290a 2020 2020  ), lit(2))).    
-0001c440: 2020 2020 3e3e 3e20 6466 2e77 6974 6843      >>> df.withC
-0001c450: 6f6c 756d 6e28 2261 7272 6179 5f64 222c  olumn("array_d",
-0001c460: 2061 7272 6179 5f64 6973 7469 6e63 7428   array_distinct(
-0001c470: 2241 5252 4159 2229 292e 7368 6f77 2829  "ARRAY")).show()
-0001c480: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001c4a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0001c4b0: 2241 2220 207c 2241 5252 4159 2220 207c  "A"  |"ARRAY"  |
-0001c4c0: 2241 5252 4159 5f44 2220 207c 0a20 2020  "ARRAY_D"  |.   
-0001c4d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0001c4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001c4f0: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
-0001c500: 207c 5b20 2020 2020 2020 207c 5b20 2020   |[        |[   
-0001c510: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0001c520: 207c 2020 2020 207c 2020 312c 2020 2020   |     |  1,    
-0001c530: 207c 2020 312c 2020 2020 2020 207c 0a20   |  1,       |. 
-0001c540: 2020 2020 2020 207c 2020 2020 207c 2020         |     |  
-0001c550: 312c 2020 2020 207c 2020 322c 2020 2020  1,     |  2,    
-0001c560: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-0001c570: 2020 207c 2020 312c 2020 2020 207c 2020     |  1,     |  
-0001c580: 3320 2020 2020 2020 207c 0a20 2020 2020  3        |.     
-0001c590: 2020 207c 2020 2020 207c 2020 322c 2020     |     |  2,  
-0001c5a0: 2020 207c 5d20 2020 2020 2020 2020 207c     |]          |
-0001c5b0: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-0001c5c0: 2020 332c 2020 2020 207c 2020 2020 2020    3,     |      
-0001c5d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0001c5e0: 2020 2020 207c 2020 322c 2020 2020 207c       |  2,     |
-0001c5f0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0001c600: 2020 2020 207c 2020 2020 207c 2020 3220       |     |  2 
-0001c610: 2020 2020 207c 2020 2020 2020 2020 2020       |          
-0001c620: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
-0001c630: 207c 5d20 2020 2020 2020 207c 2020 2020   |]        |    
-0001c640: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0001c650: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001c660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0001c670: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0001c680: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0001c690: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-0001c6a0: 7374 7228 636f 6c2c 2022 6172 7261 795f  str(col, "array_
-0001c6b0: 6469 7374 696e 6374 2229 0a20 2020 2072  distinct").    r
-0001c6c0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-0001c6d0: 7272 6179 5f64 6973 7469 6e63 7422 2928  rray_distinct")(
-0001c6e0: 636f 6c29 0a0a 0a64 6566 2061 7272 6179  col)...def array
-0001c6f0: 5f69 6e74 6572 7365 6374 696f 6e28 6172  _intersection(ar
-0001c700: 7261 7931 3a20 436f 6c75 6d6e 4f72 4e61  ray1: ColumnOrNa
-0001c710: 6d65 2c20 6172 7261 7932 3a20 436f 6c75  me, array2: Colu
-0001c720: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001c730: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-0001c740: 726e 7320 616e 2061 7272 6179 2074 6861  rns an array tha
-0001c750: 7420 636f 6e74 6169 6e73 2074 6865 206d  t contains the m
-0001c760: 6174 6368 696e 6720 656c 656d 656e 7473  atching elements
-0001c770: 2069 6e20 7468 6520 7477 6f20 696e 7075   in the two inpu
-0001c780: 7420 6172 7261 7973 2e0a 0a20 2020 2054  t arrays...    T
-0001c790: 6865 2066 756e 6374 696f 6e20 6973 204e  he function is N
-0001c7a0: 554c 4c2d 7361 6665 2c20 6d65 616e 696e  ULL-safe, meanin
-0001c7b0: 6720 6974 2074 7265 6174 7320 4e55 4c4c  g it treats NULL
-0001c7c0: 7320 6173 206b 6e6f 776e 2076 616c 7565  s as known value
-0001c7d0: 7320 666f 7220 636f 6d70 6172 696e 6720  s for comparing 
-0001c7e0: 6571 7561 6c69 7479 2e0a 0a20 2020 2041  equality...    A
-0001c7f0: 7267 733a 0a20 2020 2020 2020 2061 7272  rgs:.        arr
-0001c800: 6179 313a 2041 6e20 4152 5241 5920 7468  ay1: An ARRAY th
-0001c810: 6174 2063 6f6e 7461 696e 7320 656c 656d  at contains elem
-0001c820: 656e 7473 2074 6f20 6265 2063 6f6d 7061  ents to be compa
-0001c830: 7265 642e 0a20 2020 2020 2020 2061 7272  red..        arr
-0001c840: 6179 323a 2041 6e20 4152 5241 5920 7468  ay2: An ARRAY th
-0001c850: 6174 2063 6f6e 7461 696e 7320 656c 656d  at contains elem
-0001c860: 656e 7473 2074 6f20 6265 2063 6f6d 7061  ents to be compa
-0001c870: 7265 642e 0a0a 2020 2020 4578 616d 706c  red...    Exampl
-0001c880: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0001c890: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0001c8a0: 6e6f 7770 6172 6b20 696d 706f 7274 2052  nowpark import R
-0001c8b0: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
-0001c8c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0001c8d0: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
-0001c8e0: 7728 5b31 2c20 325d 2c20 5b31 2c20 335d  w([1, 2], [1, 3]
-0001c8f0: 295d 2c20 7363 6865 6d61 3d5b 2261 222c  )], schema=["a",
-0001c900: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
-0001c910: 3e3e 2064 662e 7365 6c65 6374 2861 7272  >> df.select(arr
-0001c920: 6179 5f69 6e74 6572 7365 6374 696f 6e28  ay_intersection(
-0001c930: 2261 222c 2022 6222 292e 616c 6961 7328  "a", "b").alias(
-0001c940: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0001c950: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0001c960: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0001c970: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0001c980: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001c990: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
-0001c9a0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0001c9b0: 2031 2020 2020 2020 207c 0a20 2020 2020   1       |.     
-0001c9c0: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
-0001c9d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001c9e0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0001c9f0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0001ca00: 0a20 2020 2061 3120 3d20 5f74 6f5f 636f  .    a1 = _to_co
-0001ca10: 6c5f 6966 5f73 7472 2861 7272 6179 312c  l_if_str(array1,
-0001ca20: 2022 6172 7261 795f 696e 7465 7273 6563   "array_intersec
-0001ca30: 7469 6f6e 2229 0a20 2020 2061 3220 3d20  tion").    a2 = 
-0001ca40: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-0001ca50: 7272 6179 322c 2022 6172 7261 795f 696e  rray2, "array_in
-0001ca60: 7465 7273 6563 7469 6f6e 2229 0a20 2020  tersection").   
-0001ca70: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0001ca80: 2261 7272 6179 5f69 6e74 6572 7365 6374  "array_intersect
-0001ca90: 696f 6e22 2928 6131 2c20 6132 290a 0a0a  ion")(a1, a2)...
-0001caa0: 6465 6620 6172 7261 795f 6765 6e65 7261  def array_genera
-0001cab0: 7465 5f72 616e 6765 280a 2020 2020 7374  te_range(.    st
-0001cac0: 6172 743a 2043 6f6c 756d 6e4f 724e 616d  art: ColumnOrNam
-0001cad0: 652c 2073 746f 703a 2043 6f6c 756d 6e4f  e, stop: ColumnO
-0001cae0: 724e 616d 652c 2073 7465 703a 204f 7074  rName, step: Opt
-0001caf0: 696f 6e61 6c5b 436f 6c75 6d6e 4f72 4e61  ional[ColumnOrNa
-0001cb00: 6d65 5d20 3d20 4e6f 6e65 0a29 202d 3e20  me] = None.) -> 
-0001cb10: 436f 6c75 6d6e 3a0a 2020 2020 2222 2247  Column:.    """G
-0001cb20: 656e 6572 6174 6520 6120 7261 6e67 6520  enerate a range 
-0001cb30: 6f66 2069 6e74 6567 6572 7320 6672 6f6d  of integers from
-0001cb40: 2060 7374 6172 7460 2074 6f20 6073 746f   `start` to `sto
-0001cb50: 7060 2c20 696e 6372 656d 656e 7469 6e67  p`, incrementing
-0001cb60: 2062 7920 6073 7465 7060 2e0a 2020 2020   by `step`..    
-0001cb70: 4966 2060 7374 6570 6020 6973 206e 6f74  If `step` is not
-0001cb80: 2073 6574 2c20 696e 6372 656d 656e 7469   set, incrementi
-0001cb90: 6e67 2062 7920 312e 0a0a 2020 2020 4172  ng by 1...    Ar
-0001cba0: 6773 3a0a 2020 2020 2020 2020 7374 6172  gs:.        star
-0001cbb0: 743a 2074 6865 2063 6f6c 756d 6e20 7468  t: the column th
-0001cbc0: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
-0001cbd0: 696e 7465 6765 7220 746f 2073 7461 7274  integer to start
-0001cbe0: 2077 6974 6820 2869 6e63 6c75 7369 7665   with (inclusive
-0001cbf0: 292e 0a20 2020 2020 2020 2073 746f 703a  )..        stop:
-0001cc00: 2074 6865 2063 6f6c 756d 6e20 7468 6174   the column that
-0001cc10: 2063 6f6e 7461 696e 7320 7468 6520 696e   contains the in
-0001cc20: 7465 6765 7220 746f 2073 746f 7020 2865  teger to stop (e
-0001cc30: 7863 6c75 7369 7665 292e 0a20 2020 2020  xclusive)..     
-0001cc40: 2020 2073 7465 703a 2074 6865 2063 6f6c     step: the col
-0001cc50: 756d 6e20 7468 6174 2063 6f6e 7461 696e  umn that contain
-0001cc60: 7320 7468 6520 696e 7465 6765 7220 746f  s the integer to
-0001cc70: 2069 6e63 7265 6d65 6e74 2e0a 0a20 2020   increment...   
-0001cc80: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0001cc90: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0001cca0: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
-0001ccb0: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
-0001ccc0: 2020 3e3e 3e20 6466 3120 3d20 7365 7373    >>> df1 = sess
-0001ccd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0001cce0: 7261 6d65 285b 282d 322c 2032 295d 2c20  rame([(-2, 2)], 
-0001ccf0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
-0001cd00: 2020 2020 3e3e 3e20 6466 312e 7365 6c65      >>> df1.sele
-0001cd10: 6374 2861 7272 6179 5f67 656e 6572 6174  ct(array_generat
-0001cd20: 655f 7261 6e67 6528 2261 222c 2022 6222  e_range("a", "b"
-0001cd30: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-0001cd40: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0001cd50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0001cd60: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0001cd70: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001cd80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001cd90: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
-0001cda0: 2020 2020 2020 7c20 202d 322c 2020 2020        |  -2,    
-0001cdb0: 207c 0a20 2020 2020 2020 207c 2020 2d31   |.        |  -1
-0001cdc0: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-0001cdd0: 7c20 2030 2c20 2020 2020 207c 0a20 2020  |  0,      |.   
-0001cde0: 2020 2020 207c 2020 3120 2020 2020 2020       |  1       
-0001cdf0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-0001ce00: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0001ce10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001ce20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0001ce30: 2020 2020 2020 2020 3e3e 3e20 6466 3220          >>> df2 
-0001ce40: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0001ce50: 5f64 6174 6166 7261 6d65 285b 2834 2c20  _dataframe([(4, 
-0001ce60: 2d34 2c20 2d32 295d 2c20 5b22 6122 2c20  -4, -2)], ["a", 
-0001ce70: 2262 222c 2022 6322 5d29 0a20 2020 2020  "b", "c"]).     
-0001ce80: 2020 203e 3e3e 2064 6632 2e73 656c 6563     >>> df2.selec
-0001ce90: 7428 6172 7261 795f 6765 6e65 7261 7465  t(array_generate
-0001cea0: 5f72 616e 6765 2822 6122 2c20 2262 222c  _range("a", "b",
-0001ceb0: 2022 6322 292e 616c 6961 7328 2272 6573   "c").alias("res
-0001cec0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0001ced0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001cee0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0001cef0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-0001cf00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001cf10: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
-0001cf20: 7c0a 2020 2020 2020 2020 7c20 2034 2c20  |.        |  4, 
-0001cf30: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0001cf40: 2020 322c 2020 2020 2020 7c0a 2020 2020    2,      |.    
-0001cf50: 2020 2020 7c20 2030 2c20 2020 2020 207c      |  0,      |
-0001cf60: 0a20 2020 2020 2020 207c 2020 2d32 2020  .        |  -2  
-0001cf70: 2020 2020 7c0a 2020 2020 2020 2020 7c5d      |.        |]
-0001cf80: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0001cf90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0001cfa0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0001cfb0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-0001cfc0: 7374 6172 745f 636f 6c20 3d20 5f74 6f5f  start_col = _to_
-0001cfd0: 636f 6c5f 6966 5f73 7472 2873 7461 7274  col_if_str(start
-0001cfe0: 2c20 2261 7272 6179 5f67 656e 6572 6174  , "array_generat
-0001cff0: 655f 7261 6e67 6522 290a 2020 2020 7374  e_range").    st
-0001d000: 6f70 5f63 6f6c 203d 205f 746f 5f63 6f6c  op_col = _to_col
-0001d010: 5f69 665f 7374 7228 7374 6f70 2c20 2261  _if_str(stop, "a
-0001d020: 7272 6179 5f67 656e 6572 6174 655f 7261  rray_generate_ra
-0001d030: 6e67 6522 290a 2020 2020 6966 2073 7465  nge").    if ste
-0001d040: 7020 6973 204e 6f6e 653a 0a20 2020 2020  p is None:.     
-0001d050: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0001d060: 6e28 2261 7272 6179 5f67 656e 6572 6174  n("array_generat
-0001d070: 655f 7261 6e67 6522 2928 7374 6172 745f  e_range")(start_
-0001d080: 636f 6c2c 2073 746f 705f 636f 6c29 0a20  col, stop_col). 
-0001d090: 2020 2073 7465 705f 636f 6c20 3d20 5f74     step_col = _t
-0001d0a0: 6f5f 636f 6c5f 6966 5f73 7472 2873 7465  o_col_if_str(ste
-0001d0b0: 702c 2022 6172 7261 795f 6765 6e65 7261  p, "array_genera
-0001d0c0: 7465 5f72 616e 6765 2229 0a20 2020 2072  te_range").    r
-0001d0d0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-0001d0e0: 7272 6179 5f67 656e 6572 6174 655f 7261  rray_generate_ra
-0001d0f0: 6e67 6522 2928 7374 6172 745f 636f 6c2c  nge")(start_col,
-0001d100: 2073 746f 705f 636f 6c2c 2073 7465 705f   stop_col, step_
-0001d110: 636f 6c29 0a0a 0a64 6566 2073 6571 7565  col)...def seque
-0001d120: 6e63 6528 0a20 2020 2073 7461 7274 3a20  nce(.    start: 
-0001d130: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7374  ColumnOrName, st
-0001d140: 6f70 3a20 436f 6c75 6d6e 4f72 4e61 6d65  op: ColumnOrName
-0001d150: 2c20 7374 6570 3a20 4f70 7469 6f6e 616c  , step: Optional
-0001d160: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
-0001d170: 204e 6f6e 650a 2920 2d3e 2043 6f6c 756d   None.) -> Colum
-0001d180: 6e3a 0a20 2020 2022 2222 4765 6e65 7261  n:.    """Genera
-0001d190: 7465 2061 2073 6571 7565 6e63 6520 6f66  te a sequence of
-0001d1a0: 2069 6e74 6567 6572 7320 6672 6f6d 2060   integers from `
-0001d1b0: 7374 6172 7460 2074 6f20 6073 746f 7060  start` to `stop`
-0001d1c0: 2c20 696e 6372 656d 656e 7469 6e67 2062  , incrementing b
-0001d1d0: 7920 6073 7465 7060 2e0a 2020 2020 4966  y `step`..    If
-0001d1e0: 2060 7374 6570 6020 6973 206e 6f74 2073   `step` is not s
-0001d1f0: 6574 2c20 696e 6372 656d 656e 7469 6e67  et, incrementing
-0001d200: 2062 7920 3120 6966 2073 7461 7274 2069   by 1 if start i
-0001d210: 7320 6c65 7373 2074 6861 6e20 6f72 2065  s less than or e
-0001d220: 7175 616c 2074 6f20 7374 6f70 2c20 6f74  qual to stop, ot
-0001d230: 6865 7277 6973 6520 2d31 2e0a 0a20 2020  herwise -1...   
-0001d240: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
-0001d250: 7461 7274 3a20 7468 6520 636f 6c75 6d6e  tart: the column
-0001d260: 2074 6861 7420 636f 6e74 6169 6e73 2074   that contains t
-0001d270: 6865 2069 6e74 6567 6572 2074 6f20 7374  he integer to st
-0001d280: 6172 7420 7769 7468 2028 696e 636c 7573  art with (inclus
-0001d290: 6976 6529 2e0a 2020 2020 2020 2020 7374  ive)..        st
-0001d2a0: 6f70 3a20 7468 6520 636f 6c75 6d6e 2074  op: the column t
-0001d2b0: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
-0001d2c0: 2069 6e74 6567 6572 2074 6f20 7374 6f70   integer to stop
-0001d2d0: 2028 696e 636c 7573 6976 6529 2e0a 2020   (inclusive)..  
-0001d2e0: 2020 2020 2020 7374 6570 3a20 7468 6520        step: the 
-0001d2f0: 636f 6c75 6d6e 2074 6861 7420 636f 6e74  column that cont
-0001d300: 6169 6e73 2074 6865 2069 6e74 6567 6572  ains the integer
-0001d310: 2074 6f20 696e 6372 656d 656e 742e 0a0a   to increment...
-0001d320: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0001d330: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0001d340: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0001d350: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
-0001d360: 2020 2020 203e 3e3e 2064 6631 203d 2073       >>> df1 = s
-0001d370: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001d380: 7461 6672 616d 6528 5b28 2d32 2c20 3229  taframe([(-2, 2)
-0001d390: 5d2c 205b 2261 222c 2022 6222 5d29 0a20  ], ["a", "b"]). 
-0001d3a0: 2020 2020 2020 203e 3e3e 2064 6631 2e73         >>> df1.s
-0001d3b0: 656c 6563 7428 7365 7175 656e 6365 2822  elect(sequence("
-0001d3c0: 6122 2c20 2262 2229 2e61 6c69 6173 2822  a", "b").alias("
-0001d3d0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-0001d3e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001d3f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-0001d400: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-0001d410: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0001d420: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
-0001d430: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-0001d440: 2d32 2c20 2020 2020 7c0a 2020 2020 2020  -2,     |.      
-0001d450: 2020 7c20 202d 312c 2020 2020 207c 0a20    |  -1,     |. 
-0001d460: 2020 2020 2020 207c 2020 302c 2020 2020         |  0,    
-0001d470: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
-0001d480: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-0001d490: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
-0001d4a0: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
-0001d4b0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001d4c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001d4d0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0001d4e0: 2020 2020 3e3e 3e20 6466 3220 3d20 7365      >>> df2 = se
-0001d4f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0001d500: 6166 7261 6d65 285b 2834 2c20 2d34 2c20  aframe([(4, -4, 
-0001d510: 2d32 295d 2c20 5b22 6122 2c20 2262 222c  -2)], ["a", "b",
-0001d520: 2022 6322 5d29 0a20 2020 2020 2020 203e   "c"]).        >
-0001d530: 3e3e 2064 6632 2e73 656c 6563 7428 7365  >> df2.select(se
-0001d540: 7175 656e 6365 2822 6122 2c20 2262 222c  quence("a", "b",
-0001d550: 2022 6322 292e 616c 6961 7328 2272 6573   "c").alias("res
-0001d560: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0001d570: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001d580: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0001d590: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-0001d5a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001d5b0: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
-0001d5c0: 7c0a 2020 2020 2020 2020 7c20 2034 2c20  |.        |  4, 
-0001d5d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0001d5e0: 2020 322c 2020 2020 2020 7c0a 2020 2020    2,      |.    
-0001d5f0: 2020 2020 7c20 2030 2c20 2020 2020 207c      |  0,      |
-0001d600: 0a20 2020 2020 2020 207c 2020 2d32 2c20  .        |  -2, 
-0001d610: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0001d620: 202d 3420 2020 2020 207c 0a20 2020 2020   -4      |.     
-0001d630: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
-0001d640: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001d650: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0001d660: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0001d670: 0a20 2020 2073 7461 7274 5f63 6f6c 203d  .    start_col =
-0001d680: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001d690: 7374 6172 742c 2022 7365 7175 656e 6365  start, "sequence
-0001d6a0: 2229 0a20 2020 2073 746f 705f 636f 6c20  ").    stop_col 
-0001d6b0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001d6c0: 2873 746f 702c 2022 7365 7175 656e 6365  (stop, "sequence
-0001d6d0: 2229 0a20 2020 2069 6620 7374 6570 2069  ").    if step i
-0001d6e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0001d6f0: 7374 6570 203d 2069 6666 2862 7569 6c74  step = iff(built
-0001d700: 696e 2822 7369 676e 2229 2873 746f 705f  in("sign")(stop_
-0001d710: 636f 6c20 2d20 7374 6172 745f 636f 6c29  col - start_col)
-0001d720: 203e 2030 2c20 312c 202d 3129 0a20 2020   > 0, 1, -1).   
-0001d730: 2020 2020 2072 6574 7572 6e20 6275 696c       return buil
-0001d740: 7469 6e28 2261 7272 6179 5f67 656e 6572  tin("array_gener
-0001d750: 6174 655f 7261 6e67 6522 2928 7374 6172  ate_range")(star
-0001d760: 745f 636f 6c2c 2073 746f 705f 636f 6c20  t_col, stop_col 
-0001d770: 2b20 7374 6570 2c20 7374 6570 290a 2020  + step, step).  
-0001d780: 2020 7374 6570 5f63 6f6c 203d 205f 746f    step_col = _to
-0001d790: 5f63 6f6c 5f69 665f 7374 7228 7374 6570  _col_if_str(step
-0001d7a0: 2c20 2273 6571 7565 6e63 6522 290a 2020  , "sequence").  
-0001d7b0: 2020 7374 6570 5f73 6967 6e20 3d20 6966    step_sign = if
-0001d7c0: 6628 6275 696c 7469 6e28 2273 6967 6e22  f(builtin("sign"
-0001d7d0: 2928 7374 6570 5f63 6f6c 2920 3e20 302c  )(step_col) > 0,
-0001d7e0: 2031 2c20 2d31 290a 2020 2020 7265 7475   1, -1).    retu
-0001d7f0: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
-0001d800: 795f 6765 6e65 7261 7465 5f72 616e 6765  y_generate_range
-0001d810: 2229 2873 7461 7274 5f63 6f6c 2c20 7374  ")(start_col, st
-0001d820: 6f70 5f63 6f6c 202b 2073 7465 705f 7369  op_col + step_si
-0001d830: 676e 2c20 7374 6570 5f63 6f6c 290a 0a0a  gn, step_col)...
-0001d840: 6465 6620 6461 7465 5f61 6464 2863 6f6c  def date_add(col
-0001d850: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0001d860: 6e75 6d5f 6f66 5f64 6179 733a 2055 6e69  num_of_days: Uni
-0001d870: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-0001d880: 2069 6e74 5d29 3a0a 2020 2020 2222 220a   int]):.    """.
-0001d890: 2020 2020 4164 6473 2061 206e 756d 6265      Adds a numbe
-0001d8a0: 7220 6f66 2064 6179 7320 746f 2061 2064  r of days to a d
-0001d8b0: 6174 6520 636f 6c75 6d6e 2e0a 0a20 2020  ate column...   
-0001d8c0: 2041 7267 733a 0a20 2020 2020 2020 2063   Args:.        c
-0001d8d0: 6f6c 3a20 5468 6520 636f 6c75 6d6e 2074  ol: The column t
-0001d8e0: 6f20 6164 6420 746f 2e0a 2020 2020 2020  o add to..      
-0001d8f0: 2020 6e75 6d5f 6f66 5f64 6179 733a 2054    num_of_days: T
-0001d900: 6865 206e 756d 6265 7220 6f66 2064 6179  he number of day
-0001d910: 7320 746f 2061 6464 2e0a 0a20 2020 2045  s to add...    E
-0001d920: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0001d930: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0001d940: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-0001d950: 6e63 7469 6f6e 7320 696d 706f 7274 2064  nctions import d
-0001d960: 6174 655f 6164 642c 2074 6f5f 6461 7465  ate_add, to_date
-0001d970: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0001d980: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0001d990: 4461 7461 4672 616d 6528 5b28 2231 3937  DataFrame([("197
-0001d9a0: 362d 3031 2d30 3622 295d 2c20 5b22 6461  6-01-06")], ["da
-0001d9b0: 7465 225d 290a 2020 2020 2020 2020 3e3e  te"]).        >>
-0001d9c0: 3e20 6466 203d 2064 662e 7769 7468 436f  > df = df.withCo
-0001d9d0: 6c75 6d6e 2822 6461 7465 222c 2074 6f5f  lumn("date", to_
-0001d9e0: 6461 7465 2822 6461 7465 2229 290a 2020  date("date")).  
-0001d9f0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-0001da00: 6466 2e77 6974 6843 6f6c 756d 6e28 2264  df.withColumn("d
-0001da10: 6174 6522 2c20 6461 7465 5f61 6464 2822  ate", date_add("
-0001da20: 6461 7465 222c 2034 2929 2e73 686f 7728  date", 4)).show(
-0001da30: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0001da40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001da50: 207c 2244 4154 4522 2020 2020 2020 7c0a   |"DATE"      |.
-0001da60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001da70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0001da80: 3139 3736 2d30 312d 3130 2020 7c0a 2020  1976-01-10  |.  
-0001da90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001daa0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0001dab0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0001dac0: 0a20 2020 2023 2043 6f6e 7665 7274 2074  .    # Convert t
-0001dad0: 6865 2069 6e70 7574 2074 6f20 6120 636f  he input to a co
-0001dae0: 6c75 6d6e 2069 6620 6974 2069 7320 6120  lumn if it is a 
-0001daf0: 7374 7269 6e67 0a20 2020 2063 6f6c 203d  string.    col =
-0001db00: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001db10: 636f 6c2c 2022 6461 7465 5f61 6464 2229  col, "date_add")
-0001db20: 0a20 2020 206e 756d 5f6f 665f 6461 7973  .    num_of_days
-0001db30: 203d 2028 0a20 2020 2020 2020 206c 6974   = (.        lit
-0001db40: 286e 756d 5f6f 665f 6461 7973 290a 2020  (num_of_days).  
-0001db50: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001db60: 6e63 6528 6e75 6d5f 6f66 5f64 6179 732c  nce(num_of_days,
-0001db70: 2069 6e74 290a 2020 2020 2020 2020 656c   int).        el
-0001db80: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
-0001db90: 7228 6e75 6d5f 6f66 5f64 6179 732c 2022  r(num_of_days, "
-0001dba0: 6461 7465 5f61 6464 2229 0a20 2020 2029  date_add").    )
-0001dbb0: 0a20 2020 2023 2052 6574 7572 6e20 7468  .    # Return th
-0001dbc0: 6520 6461 7465 6164 6420 6675 6e63 7469  e dateadd functi
-0001dbd0: 6f6e 2077 6974 6820 7468 6520 636f 6c75  on with the colu
-0001dbe0: 6d6e 2061 6e64 206e 756d 6265 7220 6f66  mn and number of
-0001dbf0: 2064 6179 730a 2020 2020 7265 7475 726e   days.    return
-0001dc00: 2064 6174 6561 6464 2822 6461 7922 2c20   dateadd("day", 
-0001dc10: 6e75 6d5f 6f66 5f64 6179 732c 2063 6f6c  num_of_days, col
-0001dc20: 290a 0a0a 6465 6620 6461 7465 5f73 7562  )...def date_sub
-0001dc30: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-0001dc40: 6d65 2c20 6e75 6d5f 6f66 5f64 6179 733a  me, num_of_days:
-0001dc50: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
-0001dc60: 616d 652c 2069 6e74 5d29 3a0a 2020 2020  ame, int]):.    
-0001dc70: 2222 220a 2020 2020 5375 6274 7261 6374  """.    Subtract
-0001dc80: 7320 6120 6e75 6d62 6572 206f 6620 6461  s a number of da
-0001dc90: 7973 2066 726f 6d20 6120 6461 7465 2063  ys from a date c
-0001dca0: 6f6c 756d 6e2e 0a0a 2020 2020 4172 6773  olumn...    Args
-0001dcb0: 3a0a 2020 2020 2020 2020 636f 6c3a 2054  :.        col: T
-0001dcc0: 6865 2063 6f6c 756d 6e20 746f 2073 7562  he column to sub
-0001dcd0: 7472 6163 7420 6672 6f6d 2e0a 2020 2020  tract from..    
-0001dce0: 2020 2020 6e75 6d5f 6f66 5f64 6179 733a      num_of_days:
-0001dcf0: 2054 6865 206e 756d 6265 7220 6f66 2064   The number of d
-0001dd00: 6179 7320 746f 2073 7562 7472 6163 742e  ays to subtract.
-0001dd10: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0001dd20: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0001dd30: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0001dd40: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
-0001dd50: 6d70 6f72 7420 6461 7465 5f73 7562 2c20  mport date_sub, 
-0001dd60: 746f 5f64 6174 650a 2020 2020 2020 2020  to_date.        
-0001dd70: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0001dd80: 2e63 7265 6174 6544 6174 6146 7261 6d65  .createDataFrame
-0001dd90: 285b 2822 3139 3736 2d30 312d 3036 2229  ([("1976-01-06")
-0001dda0: 5d2c 205b 2264 6174 6522 5d29 0a20 2020  ], ["date"]).   
-0001ddb0: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
-0001ddc0: 2e77 6974 6843 6f6c 756d 6e28 2264 6174  .withColumn("dat
-0001ddd0: 6522 2c20 746f 5f64 6174 6528 2264 6174  e", to_date("dat
-0001dde0: 6522 2929 0a20 2020 2020 2020 203e 3e3e  e")).        >>>
-0001ddf0: 2064 662e 7769 7468 436f 6c75 6d6e 2822   df.withColumn("
-0001de00: 6461 7465 222c 2064 6174 655f 7375 6228  date", date_sub(
-0001de10: 2264 6174 6522 2c20 3229 292e 7368 6f77  "date", 2)).show
-0001de20: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0001de30: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001de40: 2020 7c22 4441 5445 2220 2020 2020 207c    |"DATE"      |
-0001de50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001de60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001de70: 7c31 3937 362d 3031 2d30 3420 207c 0a20  |1976-01-04  |. 
-0001de80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001de90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0001dea0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0001deb0: 220a 2020 2020 2320 436f 6e76 6572 7420  ".    # Convert 
-0001dec0: 7468 6520 696e 7075 7420 7061 7261 6d65  the input parame
-0001ded0: 7465 7273 2074 6f20 7468 6520 6170 7072  ters to the appr
-0001dee0: 6f70 7269 6174 6520 7479 7065 0a20 2020  opriate type.   
-0001def0: 2063 6f6c 203d 205f 746f 5f63 6f6c 5f69   col = _to_col_i
-0001df00: 665f 7374 7228 636f 6c2c 2022 6461 7465  f_str(col, "date
-0001df10: 5f73 7562 2229 0a20 2020 206e 756d 5f6f  _sub").    num_o
-0001df20: 665f 6461 7973 203d 2028 0a20 2020 2020  f_days = (.     
-0001df30: 2020 206c 6974 286e 756d 5f6f 665f 6461     lit(num_of_da
-0001df40: 7973 290a 2020 2020 2020 2020 6966 2069  ys).        if i
-0001df50: 7369 6e73 7461 6e63 6528 6e75 6d5f 6f66  sinstance(num_of
-0001df60: 5f64 6179 732c 2069 6e74 290a 2020 2020  _days, int).    
-0001df70: 2020 2020 656c 7365 205f 746f 5f63 6f6c      else _to_col
-0001df80: 5f69 665f 7374 7228 6e75 6d5f 6f66 5f64  _if_str(num_of_d
-0001df90: 6179 732c 2022 6461 7465 5f73 7562 2229  ays, "date_sub")
-0001dfa0: 0a20 2020 2029 0a20 2020 2023 2052 6574  .    ).    # Ret
-0001dfb0: 7572 6e20 7468 6520 6461 7465 2063 6f6c  urn the date col
-0001dfc0: 756d 6e20 7769 7468 2074 6865 206e 756d  umn with the num
-0001dfd0: 6265 7220 6f66 2064 6179 7320 7375 6274  ber of days subt
-0001dfe0: 7261 6374 6564 0a20 2020 2072 6574 7572  racted.    retur
-0001dff0: 6e20 6461 7465 6164 6428 2264 6179 222c  n dateadd("day",
-0001e000: 202d 3120 2a20 6e75 6d5f 6f66 5f64 6179   -1 * num_of_day
-0001e010: 732c 2063 6f6c 290a 0a0a 6465 6620 6461  s, col)...def da
-0001e020: 7465 6469 6666 2870 6172 743a 2073 7472  tediff(part: str
-0001e030: 2c20 636f 6c31 3a20 436f 6c75 6d6e 4f72  , col1: ColumnOr
-0001e040: 4e61 6d65 2c20 636f 6c32 3a20 436f 6c75  Name, col2: Colu
-0001e050: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001e060: 756d 6e3a 0a20 2020 2022 2222 4361 6c63  umn:.    """Calc
-0001e070: 756c 6174 6573 2074 6865 2064 6966 6665  ulates the diffe
-0001e080: 7265 6e63 6520 6265 7477 6565 6e20 7477  rence between tw
-0001e090: 6f20 6461 7465 2c20 7469 6d65 2c20 6f72  o date, time, or
-0001e0a0: 2074 696d 6573 7461 6d70 2063 6f6c 756d   timestamp colum
-0001e0b0: 6e73 2062 6173 6564 206f 6e20 7468 6520  ns based on the 
-0001e0c0: 6461 7465 206f 7220 7469 6d65 2070 6172  date or time par
-0001e0d0: 7420 7265 7175 6573 7465 642e 0a0a 2020  t requested...  
-0001e0e0: 2020 6053 7570 706f 7274 6564 2064 6174    `Supported dat
-0001e0f0: 6520 616e 6420 7469 6d65 2070 6172 7473  e and time parts
-0001e100: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-0001e110: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-0001e120: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
-0001e130: 6e63 7469 6f6e 732d 6461 7465 2d74 696d  nctions-date-tim
-0001e140: 652e 6874 6d6c 236c 6162 656c 2d73 7570  e.html#label-sup
-0001e150: 706f 7274 6564 2d64 6174 652d 7469 6d65  ported-date-time
-0001e160: 2d70 6172 7473 3e60 5f0a 0a20 2020 2045  -parts>`_..    E
-0001e170: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0001e180: 2020 3e3e 3e20 2320 7965 6172 2064 6966    >>> # year dif
-0001e190: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
-0001e1a0: 7477 6f20 6461 7465 2063 6f6c 756d 6e73  two date columns
-0001e1b0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001e1c0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-0001e1d0: 2020 2020 203e 3e3e 2064 6174 655f 6466       >>> date_df
-0001e1e0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001e1f0: 655f 6461 7461 6672 616d 6528 5b5b 6461  e_dataframe([[da
-0001e200: 7465 7469 6d65 2e64 6174 6528 3230 3230  tetime.date(2020
-0001e210: 2c20 312c 2031 292c 2064 6174 6574 696d  , 1, 1), datetim
-0001e220: 652e 6461 7465 2832 3032 312c 2031 2c20  e.date(2021, 1, 
-0001e230: 3129 5d5d 2c20 7363 6865 6d61 3d5b 2264  1)]], schema=["d
-0001e240: 6174 655f 636f 6c31 222c 2022 6461 7465  ate_col1", "date
-0001e250: 5f63 6f6c 3222 5d29 0a20 2020 2020 2020  _col2"]).       
-0001e260: 203e 3e3e 2064 6174 655f 6466 2e73 656c   >>> date_df.sel
-0001e270: 6563 7428 6461 7465 6469 6666 2822 7965  ect(datediff("ye
-0001e280: 6172 222c 2063 6f6c 2822 6461 7465 5f63  ar", col("date_c
-0001e290: 6f6c 3122 292c 2063 6f6c 2822 6461 7465  ol1"), col("date
-0001e2a0: 5f63 6f6c 3222 2929 2e61 6c69 6173 2822  _col2")).alias("
-0001e2b0: 7965 6172 5f64 6966 6622 2929 2e73 686f  year_diff")).sho
-0001e2c0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0001e2d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001e2e0: 2020 2020 7c22 5945 4152 5f44 4946 4622      |"YEAR_DIFF"
-0001e2f0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001e300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001e310: 2020 2020 7c31 2020 2020 2020 2020 2020      |1          
-0001e320: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001e330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001e340: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0001e350: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-0001e360: 2020 2070 6172 743a 2054 6865 2074 696d     part: The tim
-0001e370: 6520 7061 7274 2074 6f20 7573 6520 666f  e part to use fo
-0001e380: 7220 6361 6c63 756c 6174 696e 6720 7468  r calculating th
-0001e390: 6520 6469 6666 6572 656e 6365 0a20 2020  e difference.   
-0001e3a0: 2020 2020 2063 6f6c 313a 2054 6865 2066       col1: The f
-0001e3b0: 6972 7374 2074 696d 6573 7461 6d70 2063  irst timestamp c
-0001e3c0: 6f6c 756d 6e20 6f72 206d 696e 7565 6e64  olumn or minuend
-0001e3d0: 2069 6e20 7468 6520 6461 7465 6469 6666   in the datediff
-0001e3e0: 0a20 2020 2020 2020 2063 6f6c 323a 2054  .        col2: T
-0001e3f0: 6865 2073 6563 6f6e 6420 7469 6d65 7374  he second timest
-0001e400: 616d 7020 636f 6c75 6d6e 206f 7220 7468  amp column or th
-0001e410: 6520 7375 6274 7261 6865 6e64 2069 6e20  e subtrahend in 
-0001e420: 7468 6520 6461 7465 6469 6666 0a20 2020  the datediff.   
-0001e430: 2022 2222 0a20 2020 2069 6620 6e6f 7420   """.    if not 
-0001e440: 6973 696e 7374 616e 6365 2870 6172 742c  isinstance(part,
-0001e450: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
-0001e460: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001e470: 2270 6172 7420 6d75 7374 2062 6520 6120  "part must be a 
-0001e480: 7374 7269 6e67 2229 0a20 2020 2063 3120  string").    c1 
-0001e490: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001e4a0: 2863 6f6c 312c 2022 6461 7465 6469 6666  (col1, "datediff
-0001e4b0: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
-0001e4c0: 636f 6c5f 6966 5f73 7472 2863 6f6c 322c  col_if_str(col2,
-0001e4d0: 2022 6461 7465 6469 6666 2229 0a20 2020   "datediff").   
-0001e4e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0001e4f0: 2264 6174 6564 6966 6622 2928 7061 7274  "datediff")(part
-0001e500: 2c20 6331 2c20 6332 290a 0a0a 6465 6620  , c1, c2)...def 
-0001e510: 6461 7964 6966 6628 636f 6c31 3a20 436f  daydiff(col1: Co
-0001e520: 6c75 6d6e 4f72 4e61 6d65 2c20 636f 6c32  lumnOrName, col2
-0001e530: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0001e540: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0001e550: 2222 4361 6c63 756c 6174 6573 2074 6865  ""Calculates the
-0001e560: 2064 6966 6665 7265 6e63 6520 6265 7477   difference betw
-0001e570: 6565 6e20 7477 6f20 6461 7465 732c 206f  een two dates, o
-0001e580: 7220 7469 6d65 7374 616d 7020 636f 6c75  r timestamp colu
-0001e590: 6d6e 7320 6261 7365 6420 696e 2064 6179  mns based in day
-0001e5a0: 732e 0a20 2020 2054 6865 2072 6573 756c  s..    The resul
-0001e5b0: 7420 7769 6c6c 2072 6566 6c65 6374 2074  t will reflect t
-0001e5c0: 6865 2064 6966 6665 7265 6e63 6520 6265  he difference be
-0001e5d0: 7477 6565 6e20 636f 6c32 202d 2063 6f6c  tween col2 - col
-0001e5e0: 310a 0a20 2020 2045 7861 6d70 6c65 3a3a  1..    Example::
-0001e5f0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0001e600: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0001e610: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
-0001e620: 6d70 6f72 7420 6461 7964 6966 662c 2074  mport daydiff, t
-0001e630: 6f5f 6461 7465 0a20 2020 2020 2020 203e  o_date.        >
-0001e640: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001e650: 6372 6561 7465 4461 7461 4672 616d 6528  createDataFrame(
-0001e660: 5b28 2232 3031 352d 3034 2d30 3822 2c20  [("2015-04-08", 
-0001e670: 2232 3031 352d 3035 2d31 3022 295d 2c20  "2015-05-10")], 
-0001e680: 5b22 6431 222c 2022 6432 225d 290a 2020  ["d1", "d2"]).  
-0001e690: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-0001e6a0: 6466 2e73 656c 6563 7428 6461 7964 6966  df.select(daydif
-0001e6b0: 6628 746f 5f64 6174 6528 6466 2e64 3229  f(to_date(df.d2)
-0001e6c0: 2c20 746f 5f64 6174 6528 6466 2e64 3129  , to_date(df.d1)
-0001e6d0: 292e 616c 6961 7328 2264 6966 6622 2929  ).alias("diff"))
-0001e6e0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0001e6f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001e700: 2020 207c 2244 4946 4622 2020 7c0a 2020     |"DIFF"  |.  
-0001e710: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001e720: 0a20 2020 2020 2020 207c 3332 2020 2020  .        |32    
-0001e730: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001e740: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0001e750: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0001e760: 2222 0a20 2020 2063 6f6c 3120 3d20 5f74  "".    col1 = _t
-0001e770: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-0001e780: 312c 2022 6461 7964 6966 6622 290a 2020  1, "daydiff").  
-0001e790: 2020 636f 6c32 203d 205f 746f 5f63 6f6c    col2 = _to_col
-0001e7a0: 5f69 665f 7374 7228 636f 6c32 2c20 2264  _if_str(col2, "d
-0001e7b0: 6179 6469 6666 2229 0a20 2020 2072 6574  aydiff").    ret
-0001e7c0: 7572 6e20 6275 696c 7469 6e28 2264 6174  urn builtin("dat
-0001e7d0: 6564 6966 6622 2928 6c69 7428 2264 6179  ediff")(lit("day
-0001e7e0: 2229 2c20 636f 6c32 2c20 636f 6c31 290a  "), col2, col1).
-0001e7f0: 0a0a 6465 6620 7472 756e 6328 653a 2043  ..def trunc(e: C
-0001e800: 6f6c 756d 6e4f 724e 616d 652c 2073 6361  olumnOrName, sca
-0001e810: 6c65 3a20 556e 696f 6e5b 436f 6c75 6d6e  le: Union[Column
-0001e820: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
-0001e830: 6174 5d20 3d20 3029 202d 3e20 436f 6c75  at] = 0) -> Colu
-0001e840: 6d6e 3a0a 2020 2020 2222 2252 6f75 6e64  mn:.    """Round
-0001e850: 7320 7468 6520 696e 7075 7420 6578 7072  s the input expr
-0001e860: 6573 7369 6f6e 2064 6f77 6e20 746f 2074  ession down to t
-0001e870: 6865 206e 6561 7265 7374 2028 6f72 2065  he nearest (or e
-0001e880: 7175 616c 2920 696e 7465 6765 7220 636c  qual) integer cl
-0001e890: 6f73 6572 2074 6f20 7a65 726f 2c0a 2020  oser to zero,.  
-0001e8a0: 2020 6f72 2074 6f20 7468 6520 6e65 6172    or to the near
-0001e8b0: 6573 7420 6571 7561 6c20 6f72 2073 6d61  est equal or sma
-0001e8c0: 6c6c 6572 2076 616c 7565 2077 6974 6820  ller value with 
-0001e8d0: 7468 6520 7370 6563 6966 6965 6420 6e75  the specified nu
-0001e8e0: 6d62 6572 206f 660a 2020 2020 706c 6163  mber of.    plac
-0001e8f0: 6573 2061 6674 6572 2074 6865 2064 6563  es after the dec
-0001e900: 696d 616c 2070 6f69 6e74 2e0a 0a20 2020  imal point...   
-0001e910: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0001e920: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001e930: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
-0001e940: 7261 6d65 285b 2d31 2e30 2c20 2d30 2e39  rame([-1.0, -0.9
-0001e950: 2c20 2d2e 352c 202d 2e32 2c20 302e 302c  , -.5, -.2, 0.0,
-0001e960: 2030 2e32 2c20 302e 352c 2030 2e39 2c20   0.2, 0.5, 0.9, 
-0001e970: 312e 312c 2033 2e31 3431 3539 5d2c 2073  1.1, 3.14159], s
-0001e980: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0001e990: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001e9a0: 6374 2874 7275 6e63 2863 6f6c 2822 6122  ct(trunc(col("a"
-0001e9b0: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
-0001e9c0: 2020 2020 2020 5b52 6f77 2854 5255 4e43        [Row(TRUNC
-0001e9d0: 2822 4122 2c20 3029 3d2d 312e 3029 2c20  ("A", 0)=-1.0), 
-0001e9e0: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
-0001e9f0: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
-0001ea00: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
-0001ea10: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
-0001ea20: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
-0001ea30: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
-0001ea40: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
-0001ea50: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
-0001ea60: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
-0001ea70: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
-0001ea80: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
-0001ea90: 4328 2241 222c 2030 293d 312e 3029 2c20  C("A", 0)=1.0), 
-0001eaa0: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
-0001eab0: 293d 332e 3029 5d0a 0a20 2020 2020 2020  )=3.0)]..       
-0001eac0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001ead0: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
-0001eae0: 6528 5b2d 312e 3332 332c 2034 2e35 3637  e([-1.323, 4.567
-0001eaf0: 2c20 302e 3031 3233 5d2c 2073 6368 656d  , 0.0123], schem
-0001eb00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-0001eb10: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
-0001eb20: 7275 6e63 2863 6f6c 2822 6122 292c 206c  runc(col("a"), l
-0001eb30: 6974 2830 2929 292e 636f 6c6c 6563 7428  it(0))).collect(
-0001eb40: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
-0001eb50: 5255 4e43 2822 4122 2c20 3029 3d2d 312e  RUNC("A", 0)=-1.
-0001eb60: 3029 2c20 526f 7728 5452 554e 4328 2241  0), Row(TRUNC("A
-0001eb70: 222c 2030 293d 342e 3029 2c20 526f 7728  ", 0)=4.0), Row(
-0001eb80: 5452 554e 4328 2241 222c 2030 293d 302e  TRUNC("A", 0)=0.
-0001eb90: 3029 5d0a 2020 2020 2020 2020 3e3e 3e20  0)].        >>> 
-0001eba0: 6466 2e73 656c 6563 7428 7472 756e 6328  df.select(trunc(
-0001ebb0: 636f 6c28 2261 2229 2c20 6c69 7428 3129  col("a"), lit(1)
-0001ebc0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0001ebd0: 2020 2020 205b 526f 7728 5452 554e 4328       [Row(TRUNC(
-0001ebe0: 2241 222c 2031 293d 2d31 2e33 292c 2052  "A", 1)=-1.3), R
-0001ebf0: 6f77 2854 5255 4e43 2822 4122 2c20 3129  ow(TRUNC("A", 1)
-0001ec00: 3d34 2e35 292c 2052 6f77 2854 5255 4e43  =4.5), Row(TRUNC
-0001ec10: 2822 4122 2c20 3129 3d30 2e30 295d 0a20  ("A", 1)=0.0)]. 
-0001ec20: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001ec30: 6c65 6374 2874 7275 6e63 2863 6f6c 2822  lect(trunc(col("
-0001ec40: 6122 292c 206c 6974 2832 2929 292e 636f  a"), lit(2))).co
-0001ec50: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001ec60: 5b52 6f77 2854 5255 4e43 2822 4122 2c20  [Row(TRUNC("A", 
-0001ec70: 3229 3d2d 312e 3332 292c 2052 6f77 2854  2)=-1.32), Row(T
-0001ec80: 5255 4e43 2822 4122 2c20 3229 3d34 2e35  RUNC("A", 2)=4.5
-0001ec90: 3629 2c20 526f 7728 5452 554e 4328 2241  6), Row(TRUNC("A
-0001eca0: 222c 2032 293d 302e 3031 295d 0a0a 2020  ", 2)=0.01)]..  
-0001ecb0: 2020 4e6f 7465 2074 6861 7420 7468 6520    Note that the 
-0001ecc0: 6675 6e63 7469 6f6e 2060 6074 7275 6e63  function ``trunc
-0001ecd0: 6060 2069 7320 6f76 6572 6c6f 6164 6564  `` is overloaded
-0001ece0: 2077 6974 6820 6060 6461 7465 5f74 7275   with ``date_tru
-0001ecf0: 6e63 6060 2066 6f72 2064 6174 6574 696d  nc`` for datetim
-0001ed00: 6520 7479 7065 732e 2049 7420 616c 6c6f  e types. It allo
-0001ed10: 7773 2074 6f20 726f 756e 6420 6461 7465  ws to round date
-0001ed20: 7469 6d65 0a20 2020 206f 626a 6563 7473  time.    objects
-0001ed30: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0001ed40: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
-0001ed50: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
-0001ed60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0001ed70: 6573 7369 6f6e 2e63 7265 6174 6544 6174  ession.createDat
-0001ed80: 6146 7261 6d65 285b 6461 7465 7469 6d65  aFrame([datetime
-0001ed90: 2e64 6174 6528 3230 3232 2c20 3132 2c20  .date(2022, 12, 
-0001eda0: 3235 292c 2064 6174 6574 696d 652e 6461  25), datetime.da
-0001edb0: 7465 2832 3032 322c 2031 2c20 3130 292c  te(2022, 1, 10),
-0001edc0: 2064 6174 6574 696d 652e 6461 7465 2832   datetime.date(2
-0001edd0: 3032 322c 2037 2c20 3729 5d2c 2073 6368  022, 7, 7)], sch
-0001ede0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-0001edf0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001ee00: 2874 7275 6e63 2863 6f6c 2822 6122 292c  (trunc(col("a"),
-0001ee10: 206c 6974 2822 5155 4152 5445 5222 2929   lit("QUARTER"))
-0001ee20: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0001ee30: 2020 2020 5b52 6f77 2854 5255 4e43 2822      [Row(TRUNC("
-0001ee40: 4122 2c20 2751 5541 5254 4552 2729 3d64  A", 'QUARTER')=d
-0001ee50: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-0001ee60: 322c 2031 302c 2031 2929 2c20 526f 7728  2, 10, 1)), Row(
-0001ee70: 5452 554e 4328 2241 222c 2027 5155 4152  TRUNC("A", 'QUAR
-0001ee80: 5445 5227 293d 6461 7465 7469 6d65 2e64  TER')=datetime.d
-0001ee90: 6174 6528 3230 3232 2c20 312c 2031 2929  ate(2022, 1, 1))
-0001eea0: 2c20 526f 7728 5452 554e 4328 2241 222c  , Row(TRUNC("A",
-0001eeb0: 2027 5155 4152 5445 5227 293d 6461 7465   'QUARTER')=date
-0001eec0: 7469 6d65 2e64 6174 6528 3230 3232 2c20  time.date(2022, 
-0001eed0: 372c 2031 2929 5d0a 0a20 2020 2020 2020  7, 1))]..       
-0001eee0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0001eef0: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
-0001ef00: 6528 5b64 6174 6574 696d 652e 6461 7465  e([datetime.date
-0001ef10: 7469 6d65 2832 3032 322c 2031 322c 2032  time(2022, 12, 2
-0001ef20: 352c 2031 332c 2035 392c 2033 382c 2034  5, 13, 59, 38, 4
-0001ef30: 3637 295d 2c20 7363 6865 6d61 3d5b 2261  67)], schema=["a
-0001ef40: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-0001ef50: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
-0001ef60: 2020 2020 205b 526f 7728 413d 6461 7465       [Row(A=date
-0001ef70: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-0001ef80: 3232 2c20 3132 2c20 3235 2c20 3133 2c20  22, 12, 25, 13, 
-0001ef90: 3539 2c20 3338 2c20 3436 3729 295d 0a20  59, 38, 467))]. 
-0001efa0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001efb0: 6c65 6374 2874 7275 6e63 2863 6f6c 2822  lect(trunc(col("
-0001efc0: 6122 292c 206c 6974 2822 4d49 4e55 5445  a"), lit("MINUTE
-0001efd0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-0001efe0: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
-0001eff0: 4328 2241 222c 2027 4d49 4e55 5445 2729  C("A", 'MINUTE')
-0001f000: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-0001f010: 6d65 2832 3032 322c 2031 322c 2032 352c  me(2022, 12, 25,
-0001f020: 2031 332c 2035 3929 295d 0a0a 2020 2020   13, 59))]..    
-0001f030: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0001f040: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
-0001f050: 7275 6e63 2229 0a20 2020 2073 6361 6c65  runc").    scale
-0001f060: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
-0001f070: 206c 6974 2873 6361 6c65 290a 2020 2020   lit(scale).    
-0001f080: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001f090: 6528 7363 616c 652c 2028 696e 742c 2066  e(scale, (int, f
-0001f0a0: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
-0001f0b0: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
-0001f0c0: 7472 2873 6361 6c65 2c20 2274 7275 6e63  tr(scale, "trunc
-0001f0d0: 2229 0a20 2020 2029 0a20 2020 2072 6574  ").    ).    ret
-0001f0e0: 7572 6e20 6275 696c 7469 6e28 2274 7275  urn builtin("tru
-0001f0f0: 6e63 2229 2863 2c20 7363 616c 655f 636f  nc")(c, scale_co
-0001f100: 6c29 0a0a 0a64 6566 2064 6174 6561 6464  l)...def dateadd
-0001f110: 2870 6172 743a 2073 7472 2c20 636f 6c31  (part: str, col1
-0001f120: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0001f130: 636f 6c32 3a20 436f 6c75 6d6e 4f72 4e61  col2: ColumnOrNa
-0001f140: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0001f150: 2020 2022 2222 4164 6473 2074 6865 2073     """Adds the s
-0001f160: 7065 6369 6669 6564 2076 616c 7565 2066  pecified value f
-0001f170: 6f72 2074 6865 2073 7065 6369 6669 6564  or the specified
-0001f180: 2064 6174 6520 6f72 2074 696d 6520 7061   date or time pa
-0001f190: 7274 2074 6f20 6461 7465 206f 7220 7469  rt to date or ti
-0001f1a0: 6d65 2065 7870 722e 0a0a 2020 2020 6053  me expr...    `S
-0001f1b0: 7570 706f 7274 6564 2064 6174 6520 616e  upported date an
-0001f1c0: 6420 7469 6d65 2070 6172 7473 203c 6874  d time parts <ht
-0001f1d0: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
-0001f1e0: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
-0001f1f0: 7265 6665 7265 6e63 652f 6675 6e63 7469  reference/functi
-0001f200: 6f6e 732d 6461 7465 2d74 696d 652e 6874  ons-date-time.ht
-0001f210: 6d6c 236c 6162 656c 2d73 7570 706f 7274  ml#label-support
-0001f220: 6564 2d64 6174 652d 7469 6d65 2d70 6172  ed-date-time-par
-0001f230: 7473 3e60 5f0a 0a20 2020 2045 7861 6d70  ts>`_..    Examp
-0001f240: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0001f250: 3e20 2320 6164 6420 6f6e 6520 7965 6172  > # add one year
-0001f260: 206f 6e20 6461 7465 730a 2020 2020 2020   on dates.      
-0001f270: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-0001f280: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
-0001f290: 3e20 6461 7465 5f64 6620 3d20 7365 7373  > date_df = sess
-0001f2a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0001f2b0: 7261 6d65 285b 5b64 6174 6574 696d 652e  rame([[datetime.
-0001f2c0: 6461 7465 2832 3032 302c 2031 2c20 3129  date(2020, 1, 1)
-0001f2d0: 5d5d 2c20 7363 6865 6d61 3d5b 2264 6174  ]], schema=["dat
-0001f2e0: 655f 636f 6c22 5d29 0a20 2020 2020 2020  e_col"]).       
-0001f2f0: 203e 3e3e 2064 6174 655f 6466 2e73 656c   >>> date_df.sel
-0001f300: 6563 7428 6461 7465 6164 6428 2279 6561  ect(dateadd("yea
-0001f310: 7222 2c20 6c69 7428 3129 2c20 636f 6c28  r", lit(1), col(
-0001f320: 2264 6174 655f 636f 6c22 2929 2e61 6c69  "date_col")).ali
-0001f330: 6173 2822 7965 6172 5f61 6464 6564 2229  as("year_added")
-0001f340: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0001f350: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001f360: 2d0a 2020 2020 2020 2020 7c22 5945 4152  -.        |"YEAR
-0001f370: 5f41 4444 4544 2220 207c 0a20 2020 2020  _ADDED"  |.     
-0001f380: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0001f390: 2d2d 2d0a 2020 2020 2020 2020 7c32 3032  ---.        |202
-0001f3a0: 312d 3031 2d30 3120 2020 207c 0a20 2020  1-01-01    |.   
-0001f3b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0001f3c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0001f3d0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2020  LANKLINE>.      
-0001f3e0: 2020 3e3e 3e20 6461 7465 5f64 662e 7365    >>> date_df.se
-0001f3f0: 6c65 6374 2864 6174 6561 6464 2822 6d6f  lect(dateadd("mo
-0001f400: 6e74 6822 2c20 6c69 7428 3129 2c20 636f  nth", lit(1), co
-0001f410: 6c28 2264 6174 655f 636f 6c22 2929 2e61  l("date_col")).a
-0001f420: 6c69 6173 2822 6d6f 6e74 685f 6164 6465  lias("month_adde
-0001f430: 6422 2929 2e73 686f 7728 290a 2020 2020  d")).show().    
-0001f440: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001f450: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-0001f460: 4d4f 4e54 485f 4144 4445 4422 2020 7c0a  MONTH_ADDED"  |.
-0001f470: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001f480: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001f490: 2020 7c32 3032 302d 3032 2d30 3120 2020    |2020-02-01   
-0001f4a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001f4b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0001f4c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-0001f4d0: 3e0a 2020 2020 2020 2020 3e3e 3e20 6461  >.        >>> da
-0001f4e0: 7465 5f64 662e 7365 6c65 6374 2864 6174  te_df.select(dat
-0001f4f0: 6561 6464 2822 6461 7922 2c20 6c69 7428  eadd("day", lit(
-0001f500: 3129 2c20 636f 6c28 2264 6174 655f 636f  1), col("date_co
-0001f510: 6c22 2929 2e61 6c69 6173 2822 6461 795f  l")).alias("day_
-0001f520: 6164 6465 6422 2929 2e73 686f 7728 290a  added")).show().
-0001f530: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001f540: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001f550: 7c22 4441 595f 4144 4445 4422 2020 7c0a  |"DAY_ADDED"  |.
-0001f560: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001f570: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001f580: 7c32 3032 302d 3031 2d30 3220 2020 7c0a  |2020-01-02   |.
-0001f590: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001f5a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001f5b0: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
-0001f5c0: 2041 7267 733a 0a20 2020 2020 2020 2070   Args:.        p
-0001f5d0: 6172 743a 2054 6865 2074 696d 6520 7061  art: The time pa
-0001f5e0: 7274 2074 6f20 7573 6520 666f 7220 7468  rt to use for th
-0001f5f0: 6520 6164 6469 7469 6f6e 0a20 2020 2020  e addition.     
-0001f600: 2020 2063 6f6c 313a 2054 6865 2066 6972     col1: The fir
-0001f610: 7374 2074 696d 6573 7461 6d70 2063 6f6c  st timestamp col
-0001f620: 756d 6e20 6f72 2061 6464 656e 6420 696e  umn or addend in
-0001f630: 2074 6865 2064 6174 6561 6464 0a20 2020   the dateadd.   
-0001f640: 2020 2020 2063 6f6c 323a 2054 6865 2073       col2: The s
-0001f650: 6563 6f6e 6420 7469 6d65 7374 616d 7020  econd timestamp 
-0001f660: 636f 6c75 6d6e 206f 7220 7468 6520 6164  column or the ad
-0001f670: 6465 6e64 2069 6e20 7468 6520 6461 7465  dend in the date
-0001f680: 6164 640a 2020 2020 2222 220a 2020 2020  add.    """.    
-0001f690: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0001f6a0: 6528 7061 7274 2c20 7374 7229 3a0a 2020  e(part, str):.  
-0001f6b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001f6c0: 6545 7272 6f72 2822 7061 7274 206d 7573  eError("part mus
-0001f6d0: 7420 6265 2061 2073 7472 696e 6722 290a  t be a string").
-0001f6e0: 2020 2020 6331 203d 205f 746f 5f63 6f6c      c1 = _to_col
-0001f6f0: 5f69 665f 7374 7228 636f 6c31 2c20 2264  _if_str(col1, "d
-0001f700: 6174 6561 6464 2229 0a20 2020 2063 3220  ateadd").    c2 
-0001f710: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001f720: 2863 6f6c 322c 2022 6461 7465 6164 6422  (col2, "dateadd"
-0001f730: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0001f740: 6c74 696e 2822 6461 7465 6164 6422 2928  ltin("dateadd")(
-0001f750: 7061 7274 2c20 6331 2c20 6332 290a 0a0a  part, c1, c2)...
-0001f760: 6465 6620 6461 7465 5f70 6172 7428 7061  def date_part(pa
-0001f770: 7274 3a20 7374 722c 2065 3a20 436f 6c75  rt: str, e: Colu
-0001f780: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001f790: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0001f7a0: 2045 7874 7261 6374 7320 7468 6520 7370   Extracts the sp
-0001f7b0: 6563 6966 6965 6420 6461 7465 206f 7220  ecified date or 
-0001f7c0: 7469 6d65 2070 6172 7420 6672 6f6d 2061  time part from a
-0001f7d0: 2064 6174 652c 2074 696d 652c 206f 7220   date, time, or 
-0001f7e0: 7469 6d65 7374 616d 702e 2053 6565 0a20  timestamp. See. 
-0001f7f0: 2020 2060 4441 5445 5f50 4152 5420 3c68     `DATE_PART <h
-0001f800: 7474 7073 3a2f 2f64 6f63 732e 736e 6f77  ttps://docs.snow
-0001f810: 666c 616b 652e 636f 6d2f 656e 2f73 716c  flake.com/en/sql
-0001f820: 2d72 6566 6572 656e 6365 2f66 756e 6374  -reference/funct
-0001f830: 696f 6e73 2f64 6174 655f 7061 7274 2e68  ions/date_part.h
-0001f840: 746d 6c3e 605f 2066 6f72 2064 6574 6169  tml>`_ for detai
-0001f850: 6c73 2e0a 0a20 2020 2041 7267 733a 0a20  ls...    Args:. 
-0001f860: 2020 2020 2020 2070 6172 743a 2054 6865         part: The
-0001f870: 2074 696d 6520 7061 7274 2074 6f20 7573   time part to us
-0001f880: 6520 666f 7220 7468 6520 6164 6469 7469  e for the additi
-0001f890: 6f6e 2e0a 2020 2020 2020 2020 653a 2054  on..        e: T
-0001f8a0: 6865 2063 6f6c 756d 6e20 6578 7072 6573  he column expres
-0001f8b0: 7369 6f6e 206f 6620 6120 6461 7465 2c20  sion of a date, 
-0001f8c0: 7469 6d65 2c20 6f72 2074 696d 6573 7461  time, or timesta
-0001f8d0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
-0001f8e0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001f8f0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001f900: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001f910: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0001f920: 6461 7461 6672 616d 6528 5b5b 6461 7465  dataframe([[date
-0001f930: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-0001f940: 3233 2c20 312c 2031 2c20 312c 2031 2c20  23, 1, 1, 1, 1, 
-0001f950: 3129 5d5d 2c20 7363 6865 6d61 3d5b 2274  1)]], schema=["t
-0001f960: 735f 636f 6c22 5d29 0a20 2020 2020 2020  s_col"]).       
-0001f970: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-0001f980: 6174 655f 7061 7274 2822 7965 6172 222c  ate_part("year",
-0001f990: 2063 6f6c 2822 7473 5f63 6f6c 2229 292e   col("ts_col")).
-0001f9a0: 616c 6961 7328 2279 6561 7222 292c 2064  alias("year"), d
-0001f9b0: 6174 655f 7061 7274 2822 6570 6f63 685f  ate_part("epoch_
-0001f9c0: 7365 636f 6e64 222c 2063 6f6c 2822 7473  second", col("ts
-0001f9d0: 5f63 6f6c 2229 292e 616c 6961 7328 2265  _col")).alias("e
-0001f9e0: 706f 6368 5f73 6563 6f6e 6422 2929 2e73  poch_second")).s
-0001f9f0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0001fa00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001fa10: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001fa20: 2020 7c22 5945 4152 2220 207c 2245 504f    |"YEAR"  |"EPO
-0001fa30: 4348 5f53 4543 4f4e 4422 2020 7c0a 2020  CH_SECOND"  |.  
-0001fa40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001fa50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001fa60: 2d0a 2020 2020 2020 2020 7c32 3032 3320  -.        |2023 
-0001fa70: 2020 207c 3136 3732 3533 3438 3631 2020     |1672534861  
-0001fa80: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0001fa90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001faa0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001fab0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0001fac0: 2020 2222 220a 2020 2020 6966 206e 6f74    """.    if not
-0001fad0: 2069 7369 6e73 7461 6e63 6528 7061 7274   isinstance(part
-0001fae0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-0001faf0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0001fb00: 2822 7061 7274 206d 7573 7420 6265 2061  ("part must be a
-0001fb10: 2073 7472 696e 6722 290a 2020 2020 6320   string").    c 
-0001fb20: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001fb30: 2865 2c20 2264 6174 655f 7061 7274 2229  (e, "date_part")
-0001fb40: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001fb50: 7469 6e28 2264 6174 655f 7061 7274 2229  tin("date_part")
-0001fb60: 2870 6172 742c 2063 290a 0a0a 6465 6620  (part, c)...def 
-0001fb70: 6461 7465 5f66 726f 6d5f 7061 7274 7328  date_from_parts(
-0001fb80: 0a20 2020 2079 3a20 556e 696f 6e5b 436f  .    y: Union[Co
-0001fb90: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-0001fba0: 2c0a 2020 2020 6d3a 2055 6e69 6f6e 5b43  ,.    m: Union[C
-0001fbb0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-0001fbc0: 5d2c 0a20 2020 2064 3a20 556e 696f 6e5b  ],.    d: Union[
-0001fbd0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-0001fbe0: 745d 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  t],.) -> Column:
-0001fbf0: 0a20 2020 2022 2222 0a20 2020 2043 7265  .    """.    Cre
-0001fc00: 6174 6573 2061 2064 6174 6520 6672 6f6d  ates a date from
-0001fc10: 2069 6e64 6976 6964 7561 6c20 6e75 6d65   individual nume
-0001fc20: 7269 6320 636f 6d70 6f6e 656e 7473 2074  ric components t
-0001fc30: 6861 7420 7265 7072 6573 656e 7420 7468  hat represent th
-0001fc40: 6520 7965 6172 2c20 6d6f 6e74 682c 2061  e year, month, a
-0001fc50: 6e64 2064 6179 206f 6620 7468 6520 6d6f  nd day of the mo
-0001fc60: 6e74 682e 0a0a 2020 2020 4578 616d 706c  nth...    Exampl
-0001fc70: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0001fc80: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001fc90: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-0001fca0: 3230 3232 2c20 342c 2031 5d5d 2c20 7363  2022, 4, 1]], sc
-0001fcb0: 6865 6d61 3d5b 2279 6561 7222 2c20 226d  hema=["year", "m
-0001fcc0: 6f6e 7468 222c 2022 6461 7922 5d29 0a20  onth", "day"]). 
-0001fcd0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001fce0: 6c65 6374 2864 6174 655f 6672 6f6d 5f70  lect(date_from_p
-0001fcf0: 6172 7473 2822 7965 6172 222c 2022 6d6f  arts("year", "mo
-0001fd00: 6e74 6822 2c20 2264 6179 2229 292e 636f  nth", "day")).co
-0001fd10: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001fd20: 5b52 6f77 2844 4154 455f 4652 4f4d 5f50  [Row(DATE_FROM_P
-0001fd30: 4152 5453 2822 5945 4152 222c 2022 4d4f  ARTS("YEAR", "MO
-0001fd40: 4e54 4822 2c20 2244 4159 2229 3d64 6174  NTH", "DAY")=dat
-0001fd50: 6574 696d 652e 6461 7465 2832 3032 322c  etime.date(2022,
-0001fd60: 2034 2c20 3129 295d 0a20 2020 2020 2020   4, 1))].       
-0001fd70: 203e 3e3e 2073 6573 7369 6f6e 2e74 6162   >>> session.tab
-0001fd80: 6c65 2822 6475 616c 2229 2e73 656c 6563  le("dual").selec
-0001fd90: 7428 6461 7465 5f66 726f 6d5f 7061 7274  t(date_from_part
-0001fda0: 7328 3230 3232 2c20 342c 2031 2929 2e63  s(2022, 4, 1)).c
-0001fdb0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0001fdc0: 205b 526f 7728 4441 5445 5f46 524f 4d5f   [Row(DATE_FROM_
-0001fdd0: 5041 5254 5328 3230 3232 2c20 342c 2031  PARTS(2022, 4, 1
-0001fde0: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
-0001fdf0: 3230 3232 2c20 342c 2031 2929 5d0a 2020  2022, 4, 1))].  
-0001fe00: 2020 2222 220a 2020 2020 795f 636f 6c20    """.    y_col 
-0001fe10: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001fe20: 5f6f 725f 696e 7428 792c 2022 6461 7465  _or_int(y, "date
-0001fe30: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
-0001fe40: 2020 6d5f 636f 6c20 3d20 5f74 6f5f 636f    m_col = _to_co
-0001fe50: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
-0001fe60: 6d2c 2022 6461 7465 5f66 726f 6d5f 7061  m, "date_from_pa
-0001fe70: 7274 7322 290a 2020 2020 645f 636f 6c20  rts").    d_col 
-0001fe80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001fe90: 5f6f 725f 696e 7428 642c 2022 6461 7465  _or_int(d, "date
-0001fea0: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
-0001feb0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001fec0: 2822 6461 7465 5f66 726f 6d5f 7061 7274  ("date_from_part
-0001fed0: 7322 2928 795f 636f 6c2c 206d 5f63 6f6c  s")(y_col, m_col
-0001fee0: 2c20 645f 636f 6c29 0a0a 0a64 6566 2064  , d_col)...def d
-0001fef0: 6174 655f 7472 756e 6328 7061 7274 3a20  ate_trunc(part: 
-0001ff00: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6578  ColumnOrName, ex
-0001ff10: 7072 3a20 436f 6c75 6d6e 4f72 4e61 6d65  pr: ColumnOrName
-0001ff20: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001ff30: 2022 2222 0a20 2020 2054 7275 6e63 6174   """.    Truncat
-0001ff40: 6573 2061 2044 4154 452c 2054 494d 452c  es a DATE, TIME,
-0001ff50: 206f 7220 5449 4d45 5354 414d 5020 746f   or TIMESTAMP to
-0001ff60: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
-0001ff70: 7265 6369 7369 6f6e 2e0a 0a20 2020 204e  recision...    N
-0001ff80: 6f74 6520 7468 6174 2074 7275 6e63 6174  ote that truncat
-0001ff90: 696f 6e20 6973 206e 6f74 2074 6865 2073  ion is not the s
-0001ffa0: 616d 6520 6173 2065 7874 7261 6374 696f  ame as extractio
-0001ffb0: 6e2e 2046 6f72 2065 7861 6d70 6c65 3a0a  n. For example:.
-0001ffc0: 2020 2020 2d20 5472 756e 6361 7469 6e67      - Truncating
-0001ffd0: 2061 2074 696d 6573 7461 6d70 2064 6f77   a timestamp dow
-0001ffe0: 6e20 746f 2074 6865 2071 7561 7274 6572  n to the quarter
-0001fff0: 2072 6574 7572 6e73 2074 6865 2074 696d   returns the tim
-00020000: 6573 7461 6d70 2063 6f72 7265 7370 6f6e  estamp correspon
-00020010: 6469 6e67 2074 6f20 6d69 646e 6967 6874  ding to midnight
-00020020: 206f 6620 7468 6520 6669 7273 7420 6461   of the first da
-00020030: 7920 6f66 2074 6865 0a20 2020 2071 7561  y of the.    qua
-00020040: 7274 6572 2066 6f72 2074 6865 2069 6e70  rter for the inp
-00020050: 7574 2074 696d 6573 7461 6d70 2e0a 2020  ut timestamp..  
-00020060: 2020 2d20 4578 7472 6163 7469 6e67 2074    - Extracting t
-00020070: 6865 2071 7561 7274 6572 2064 6174 6520  he quarter date 
-00020080: 7061 7274 2066 726f 6d20 6120 7469 6d65  part from a time
-00020090: 7374 616d 7020 7265 7475 726e 7320 7468  stamp returns th
-000200a0: 6520 7175 6172 7465 7220 6e75 6d62 6572  e quarter number
-000200b0: 206f 6620 7468 6520 7965 6172 2069 6e20   of the year in 
-000200c0: 7468 6520 7469 6d65 7374 616d 702e 0a0a  the timestamp...
-000200d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-000200e0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-000200f0: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-00020100: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00020110: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00020120: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-00020130: 2020 2020 205b 5b64 6174 6574 696d 652e       [[datetime.
-00020140: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
-00020150: 6528 2232 3032 302d 3035 2d30 3120 3133  e("2020-05-01 13
-00020160: 3a31 313a 3230 2e30 3030 222c 2022 2559  :11:20.000", "%Y
-00020170: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-00020180: 2566 2229 5d5d 2c0a 2020 2020 2020 2020  %f")]],.        
-00020190: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-000201a0: 2261 225d 2c0a 2020 2020 2020 2020 2e2e  "a"],.        ..
-000201b0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-000201c0: 6466 2e73 656c 6563 7428 6461 7465 5f74  df.select(date_t
-000201d0: 7275 6e63 2822 5945 4152 222c 2022 6122  runc("YEAR", "a"
-000201e0: 292c 2064 6174 655f 7472 756e 6328 224d  ), date_trunc("M
-000201f0: 4f4e 5448 222c 2022 6122 292c 2064 6174  ONTH", "a"), dat
-00020200: 655f 7472 756e 6328 2244 4159 222c 2022  e_trunc("DAY", "
-00020210: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
-00020220: 2020 2020 2020 205b 526f 7728 4441 5445         [Row(DATE
-00020230: 5f54 5255 4e43 2822 5945 4152 222c 2022  _TRUNC("YEAR", "
-00020240: 4122 293d 6461 7465 7469 6d65 2e64 6174  A")=datetime.dat
-00020250: 6574 696d 6528 3230 3230 2c20 312c 2031  etime(2020, 1, 1
-00020260: 2c20 302c 2030 292c 2044 4154 455f 5452  , 0, 0), DATE_TR
-00020270: 554e 4328 224d 4f4e 5448 222c 2022 4122  UNC("MONTH", "A"
-00020280: 293d 6461 7465 7469 6d65 2e64 6174 6574  )=datetime.datet
-00020290: 696d 6528 3230 3230 2c20 352c 2031 2c20  ime(2020, 5, 1, 
-000202a0: 302c 2030 292c 2044 4154 455f 5452 554e  0, 0), DATE_TRUN
-000202b0: 4328 2244 4159 222c 2022 4122 293d 6461  C("DAY", "A")=da
-000202c0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-000202d0: 3230 3230 2c20 352c 2031 2c20 302c 2030  2020, 5, 1, 0, 0
-000202e0: 2929 5d0a 2020 2020 2020 2020 3e3e 3e20  ))].        >>> 
-000202f0: 6466 2e73 656c 6563 7428 6461 7465 5f74  df.select(date_t
-00020300: 7275 6e63 2822 484f 5552 222c 2022 6122  runc("HOUR", "a"
-00020310: 292c 2064 6174 655f 7472 756e 6328 224d  ), date_trunc("M
-00020320: 494e 5554 4522 2c20 2261 2229 2c20 6461  INUTE", "a"), da
-00020330: 7465 5f74 7275 6e63 2822 5345 434f 4e44  te_trunc("SECOND
-00020340: 222c 2022 6122 2929 2e63 6f6c 6c65 6374  ", "a")).collect
-00020350: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00020360: 4441 5445 5f54 5255 4e43 2822 484f 5552  DATE_TRUNC("HOUR
-00020370: 222c 2022 4122 293d 6461 7465 7469 6d65  ", "A")=datetime
-00020380: 2e64 6174 6574 696d 6528 3230 3230 2c20  .datetime(2020, 
-00020390: 352c 2031 2c20 3133 2c20 3029 2c20 4441  5, 1, 13, 0), DA
-000203a0: 5445 5f54 5255 4e43 2822 4d49 4e55 5445  TE_TRUNC("MINUTE
-000203b0: 222c 2022 4122 293d 6461 7465 7469 6d65  ", "A")=datetime
-000203c0: 2e64 6174 6574 696d 6528 3230 3230 2c20  .datetime(2020, 
-000203d0: 352c 2031 2c20 3133 2c20 3131 292c 2044  5, 1, 13, 11), D
-000203e0: 4154 455f 5452 554e 4328 2253 4543 4f4e  ATE_TRUNC("SECON
-000203f0: 4422 2c20 2241 2229 3d64 6174 6574 696d  D", "A")=datetim
-00020400: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
-00020410: 2035 2c20 312c 2031 332c 2031 312c 2032   5, 1, 13, 11, 2
-00020420: 3029 295d 0a20 2020 2020 2020 203e 3e3e  0))].        >>>
-00020430: 2064 662e 7365 6c65 6374 2864 6174 655f   df.select(date_
-00020440: 7472 756e 6328 2251 5541 5254 4552 222c  trunc("QUARTER",
-00020450: 2022 6122 2929 2e63 6f6c 6c65 6374 2829   "a")).collect()
-00020460: 0a20 2020 2020 2020 205b 526f 7728 4441  .        [Row(DA
-00020470: 5445 5f54 5255 4e43 2822 5155 4152 5445  TE_TRUNC("QUARTE
-00020480: 5222 2c20 2241 2229 3d64 6174 6574 696d  R", "A")=datetim
-00020490: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
-000204a0: 2034 2c20 312c 2030 2c20 3029 295d 0a20   4, 1, 0, 0))]. 
-000204b0: 2020 2022 2222 0a20 2020 2070 6172 745f     """.    part_
-000204c0: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
-000204d0: 5f73 7472 2870 6172 742c 2022 6461 7465  _str(part, "date
-000204e0: 5f74 7275 6e63 2229 0a20 2020 2065 7870  _trunc").    exp
-000204f0: 725f 636f 6c20 3d20 5f74 6f5f 636f 6c5f  r_col = _to_col_
-00020500: 6966 5f73 7472 2865 7870 722c 2022 6461  if_str(expr, "da
-00020510: 7465 5f74 7275 6e63 2229 0a20 2020 2072  te_trunc").    r
-00020520: 6574 7572 6e20 6275 696c 7469 6e28 2264  eturn builtin("d
-00020530: 6174 655f 7472 756e 6322 2928 7061 7274  ate_trunc")(part
-00020540: 5f63 6f6c 2c20 6578 7072 5f63 6f6c 290a  _col, expr_col).
-00020550: 0a0a 6465 6620 6461 796e 616d 6528 653a  ..def dayname(e:
-00020560: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00020570: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00020580: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
-00020590: 6865 2074 6872 6565 2d6c 6574 7465 7220  he three-letter 
-000205a0: 6461 792d 6f66 2d77 6565 6b20 6e61 6d65  day-of-week name
-000205b0: 2066 726f 6d20 7468 6520 7370 6563 6966   from the specif
-000205c0: 6965 6420 6461 7465 206f 7220 7469 6d65  ied date or time
-000205d0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
-000205e0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-000205f0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
-00020600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00020610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00020620: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-00020630: 2020 2020 202e 2e2e 2020 2020 205b 5b64       ...     [[d
-00020640: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00020650: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-00020660: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
-00020670: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-00020680: 483a 254d 3a25 532e 2566 2229 5d5d 2c0a  H:%M:%S.%f")]],.
-00020690: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-000206a0: 7363 6865 6d61 3d5b 2261 225d 2c0a 2020  schema=["a"],.  
-000206b0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
-000206c0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000206d0: 7428 6461 796e 616d 6528 2261 2229 292e  t(dayname("a")).
-000206e0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000206f0: 2020 5b52 6f77 2844 4159 4e41 4d45 2822    [Row(DAYNAME("
-00020700: 4122 293d 2746 7269 2729 5d0a 2020 2020  A")='Fri')].    
-00020710: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00020720: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
-00020730: 6179 6e61 6d65 2229 0a20 2020 2072 6574  ayname").    ret
-00020740: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
-00020750: 6e61 6d65 2229 2863 290a 0a0a 6465 6620  name")(c)...def 
-00020760: 6461 796f 666d 6f6e 7468 2865 3a20 436f  dayofmonth(e: Co
-00020770: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00020780: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00020790: 2020 2045 7874 7261 6374 7320 7468 6520     Extracts the 
-000207a0: 636f 7272 6573 706f 6e64 696e 6720 6461  corresponding da
-000207b0: 7920 286e 756d 6265 7229 206f 6620 7468  y (number) of th
-000207c0: 6520 6d6f 6e74 6820 6672 6f6d 2061 2064  e month from a d
-000207d0: 6174 6520 6f72 2074 696d 6573 7461 6d70  ate or timestamp
-000207e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000207f0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00020800: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-00020810: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00020820: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00020830: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-00020840: 2e2e 2e20 2020 2020 5b5b 6461 7465 7469  ...     [[dateti
-00020850: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-00020860: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
-00020870: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
-00020880: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00020890: 2553 2e25 6622 295d 5d2c 0a20 2020 2020  %S.%f")]],.     
-000208a0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-000208b0: 613d 5b22 6122 5d2c 0a20 2020 2020 2020  a=["a"],.       
-000208c0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-000208d0: 3e3e 2064 662e 7365 6c65 6374 2864 6179  >> df.select(day
-000208e0: 6f66 6d6f 6e74 6828 2261 2229 292e 636f  ofmonth("a")).co
-000208f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00020900: 5b52 6f77 2844 4159 4f46 4d4f 4e54 4828  [Row(DAYOFMONTH(
-00020910: 2241 2229 3d31 295d 0a20 2020 2022 2222  "A")=1)].    """
-00020920: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00020930: 5f69 665f 7374 7228 652c 2022 6461 796f  _if_str(e, "dayo
-00020940: 666d 6f6e 7468 2229 0a20 2020 2072 6574  fmonth").    ret
-00020950: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
-00020960: 6f66 6d6f 6e74 6822 2928 6329 0a0a 0a64  ofmonth")(c)...d
-00020970: 6566 2064 6179 6f66 7765 656b 2865 3a20  ef dayofweek(e: 
-00020980: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00020990: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000209a0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
-000209b0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
-000209c0: 6461 7920 286e 756d 6265 7229 206f 6620  day (number) of 
-000209d0: 7468 6520 7765 656b 2066 726f 6d20 6120  the week from a 
-000209e0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-000209f0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-00020a00: 3a0a 2020 2020 2020 2020 3e3e 3e20 696d  :.        >>> im
-00020a10: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
-00020a20: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00020a30: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00020a40: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
-00020a50: 202e 2e2e 2020 2020 205b 5b64 6174 6574   ...     [[datet
-00020a60: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-00020a70: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-00020a80: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-00020a90: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-00020aa0: 3a25 532e 2566 2229 5d5d 2c0a 2020 2020  :%S.%f")]],.    
-00020ab0: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-00020ac0: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
-00020ad0: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
-00020ae0: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
-00020af0: 796f 6677 6565 6b28 2261 2229 292e 636f  yofweek("a")).co
-00020b00: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00020b10: 5b52 6f77 2844 4159 4f46 5745 454b 2822  [Row(DAYOFWEEK("
-00020b20: 4122 293d 3529 5d0a 2020 2020 2222 220a  A")=5)].    """.
-00020b30: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00020b40: 6966 5f73 7472 2865 2c20 2264 6179 6f66  if_str(e, "dayof
-00020b50: 7765 656b 2229 0a20 2020 2072 6574 7572  week").    retur
-00020b60: 6e20 6275 696c 7469 6e28 2264 6179 6f66  n builtin("dayof
-00020b70: 7765 656b 2229 2863 290a 0a0a 6465 6620  week")(c)...def 
-00020b80: 6461 796f 6679 6561 7228 653a 2043 6f6c  dayofyear(e: Col
-00020b90: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00020ba0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00020bb0: 2020 4578 7472 6163 7473 2074 6865 2063    Extracts the c
-00020bc0: 6f72 7265 7370 6f6e 6469 6e67 2064 6179  orresponding day
-00020bd0: 2028 6e75 6d62 6572 2920 6f66 2074 6865   (number) of the
-00020be0: 2079 6561 7220 6672 6f6d 2061 2064 6174   year from a dat
-00020bf0: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
-00020c00: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00020c10: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00020c20: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-00020c30: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00020c40: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00020c50: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00020c60: 2e20 2020 2020 5b5b 6461 7465 7469 6d65  .     [[datetime
-00020c70: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
-00020c80: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
-00020c90: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
-00020ca0: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-00020cb0: 2e25 6622 295d 5d2c 0a20 2020 2020 2020  .%f")]],.       
-00020cc0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00020cd0: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
-00020ce0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-00020cf0: 2064 662e 7365 6c65 6374 2864 6179 6f66   df.select(dayof
-00020d00: 7965 6172 2822 6122 2929 2e63 6f6c 6c65  year("a")).colle
-00020d10: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00020d20: 7728 4441 594f 4659 4541 5228 2241 2229  w(DAYOFYEAR("A")
-00020d30: 3d31 3232 295d 0a20 2020 2022 2222 0a20  =122)].    """. 
-00020d40: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00020d50: 665f 7374 7228 652c 2022 6461 796f 6679  f_str(e, "dayofy
-00020d60: 6561 7222 290a 2020 2020 7265 7475 726e  ear").    return
-00020d70: 2062 7569 6c74 696e 2822 6461 796f 6679   builtin("dayofy
-00020d80: 6561 7222 2928 6329 0a0a 0a64 6566 2069  ear")(c)...def i
-00020d90: 735f 6172 7261 7928 636f 6c3a 2043 6f6c  s_array(col: Col
-00020da0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00020db0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00020dc0: 2020 5265 7475 726e 7320 7472 7565 2069    Returns true i
-00020dd0: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
-00020de0: 5641 5249 414e 5420 636f 6c75 6d6e 2063  VARIANT column c
-00020df0: 6f6e 7461 696e 7320 616e 2041 5252 4159  ontains an ARRAY
-00020e00: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
-00020e10: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
-00020e20: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00020e30: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00020e40: 6d65 285b 5b5b 2265 6c65 6d65 6e74 225d  me([[["element"]
-00020e50: 2c20 5472 7565 5d5d 2c20 7363 6865 6d61  , True]], schema
-00020e60: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
-00020e70: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00020e80: 6374 2869 735f 6172 7261 7928 6466 5b22  ct(is_array(df["
-00020e90: 6122 5d29 2e61 6c69 6173 2822 6973 5f61  a"]).alias("is_a
-00020ea0: 7272 6179 5f61 2229 2c20 6973 5f61 7272  rray_a"), is_arr
-00020eb0: 6179 2864 665b 2262 225d 292e 616c 6961  ay(df["b"]).alia
-00020ec0: 7328 2269 735f 6172 7261 795f 6222 2929  s("is_array_b"))
-00020ed0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00020ee0: 2020 205b 526f 7728 4953 5f41 5252 4159     [Row(IS_ARRAY
-00020ef0: 5f41 3d54 7275 652c 2049 535f 4152 5241  _A=True, IS_ARRA
-00020f00: 595f 423d 4661 6c73 6529 5d0a 2020 2020  Y_B=False)].    
-00020f10: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00020f20: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-00020f30: 2269 735f 6172 7261 7922 290a 2020 2020  "is_array").    
-00020f40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00020f50: 6973 5f61 7272 6179 2229 2863 290a 0a0a  is_array")(c)...
-00020f60: 6465 6620 6973 5f62 6f6f 6c65 616e 2863  def is_boolean(c
-00020f70: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
-00020f80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00020f90: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00020fa0: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
-00020fb0: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
-00020fc0: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
-00020fd0: 2062 6f6f 6c65 616e 2076 616c 7565 2e0a   boolean value..
-00020fe0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00020ff0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00021000: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00021010: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00021020: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
-00021030: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
-00021040: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00021050: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00021060: 7261 6d65 285b 5b54 7275 652c 2027 5827  rame([[True, 'X'
-00021070: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
-00021080: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
-00021090: 3e3e 2064 662e 7365 6c65 6374 2869 735f  >> df.select(is_
-000210a0: 626f 6f6c 6561 6e28 746f 5f76 6172 6961  boolean(to_varia
-000210b0: 6e74 2864 665b 2261 225d 2929 2e61 6c69  nt(df["a"])).ali
-000210c0: 6173 2822 626f 6f6c 6561 6e22 292c 2069  as("boolean"), i
-000210d0: 735f 626f 6f6c 6561 6e28 746f 5f76 6172  s_boolean(to_var
-000210e0: 6961 6e74 2864 665b 2262 225d 2929 2e61  iant(df["b"])).a
-000210f0: 6c69 6173 2822 7661 7263 6861 7222 2929  lias("varchar"))
-00021100: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00021110: 2020 205b 526f 7728 424f 4f4c 4541 4e3d     [Row(BOOLEAN=
-00021120: 5472 7565 2c20 5641 5243 4841 523d 4661  True, VARCHAR=Fa
-00021130: 6c73 6529 5d0a 2020 2020 2222 220a 2020  lse)].    """.  
-00021140: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00021150: 5f73 7472 2863 6f6c 2c20 2269 735f 626f  _str(col, "is_bo
-00021160: 6f6c 6561 6e22 290a 2020 2020 7265 7475  olean").    retu
-00021170: 726e 2062 7569 6c74 696e 2822 6973 5f62  rn builtin("is_b
-00021180: 6f6f 6c65 616e 2229 2863 290a 0a0a 6465  oolean")(c)...de
-00021190: 6620 6973 5f62 696e 6172 7928 636f 6c3a  f is_binary(col:
-000211a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000211b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000211c0: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
-000211d0: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
-000211e0: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
-000211f0: 6d6e 2063 6f6e 7461 696e 7320 6120 6269  mn contains a bi
-00021200: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
-00021210: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
-00021220: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00021230: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00021240: 2e74 7970 6573 2069 6d70 6f72 7420 5374  .types import St
-00021250: 7275 6374 4669 656c 642c 2056 6172 6961  ructField, Varia
-00021260: 6e74 5479 7065 0a20 2020 2020 2020 203e  ntType.        >
-00021270: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00021280: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00021290: 285b 5b62 2273 6e6f 7722 2c20 2273 6e6f  ([[b"snow", "sno
-000212a0: 7722 5d5d 2c20 7363 6865 6d61 3d5b 2261  w"]], schema=["a
-000212b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-000212c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
-000212d0: 735f 6269 6e61 7279 2874 6f5f 7661 7269  s_binary(to_vari
-000212e0: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
-000212f0: 6961 7328 2262 696e 6172 7922 292c 2069  ias("binary"), i
-00021300: 735f 6269 6e61 7279 2874 6f5f 7661 7269  s_binary(to_vari
-00021310: 616e 7428 6466 5b22 6222 5d29 292e 616c  ant(df["b"])).al
-00021320: 6961 7328 2276 6172 6368 6172 2229 292e  ias("varchar")).
-00021330: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00021340: 2020 5b52 6f77 2842 494e 4152 593d 5472    [Row(BINARY=Tr
-00021350: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
-00021360: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-00021370: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00021380: 7472 2863 6f6c 2c20 2269 735f 6269 6e61  tr(col, "is_bina
-00021390: 7279 2229 0a20 2020 2072 6574 7572 6e20  ry").    return 
-000213a0: 6275 696c 7469 6e28 2269 735f 6269 6e61  builtin("is_bina
-000213b0: 7279 2229 2863 290a 0a0a 6465 6620 6973  ry")(c)...def is
-000213c0: 5f63 6861 7228 636f 6c3a 2043 6f6c 756d  _char(col: Colum
-000213d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-000213e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000213f0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
-00021400: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
-00021410: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
-00021420: 7461 696e 7320 6120 7374 7269 6e67 2e0a  tains a string..
-00021430: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00021440: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00021450: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00021460: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00021470: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
-00021480: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
-00021490: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000214a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000214b0: 7261 6d65 285b 5b22 6162 6322 2c20 3132  rame([["abc", 12
-000214c0: 335d 5d2c 2073 6368 656d 613d 5b22 6122  3]], schema=["a"
-000214d0: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-000214e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6973  >>> df.select(is
-000214f0: 5f63 6861 7228 746f 5f76 6172 6961 6e74  _char(to_variant
-00021500: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
-00021510: 2822 7661 7263 6861 7222 292c 2069 735f  ("varchar"), is_
-00021520: 6368 6172 2874 6f5f 7661 7269 616e 7428  char(to_variant(
-00021530: 6466 5b22 6222 5d29 292e 616c 6961 7328  df["b"])).alias(
-00021540: 2269 6e74 2229 292e 636f 6c6c 6563 7428  "int")).collect(
-00021550: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-00021560: 4152 4348 4152 3d54 7275 652c 2049 4e54  ARCHAR=True, INT
-00021570: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
-00021580: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00021590: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
-000215a0: 5f63 6861 7222 290a 2020 2020 7265 7475  _char").    retu
-000215b0: 726e 2062 7569 6c74 696e 2822 6973 5f63  rn builtin("is_c
-000215c0: 6861 7222 2928 6329 0a0a 0a69 735f 7661  har")(c)...is_va
-000215d0: 7263 6861 7220 3d20 6973 5f63 6861 720a  rchar = is_char.
-000215e0: 0a0a 6465 6620 6973 5f64 6174 6528 636f  ..def is_date(co
-000215f0: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
-00021600: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00021610: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00021620: 7472 7565 2069 6620 7468 6520 7370 6563  true if the spec
-00021630: 6966 6965 6420 5641 5249 414e 5420 636f  ified VARIANT co
-00021640: 6c75 6d6e 2063 6f6e 7461 696e 7320 6120  lumn contains a 
-00021650: 6461 7465 2076 616c 7565 2e0a 0a20 2020  date value...   
-00021660: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
-00021670: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-00021680: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
-00021690: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-000216a0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-000216b0: 6573 2069 6d70 6f72 7420 5374 7275 6374  es import Struct
-000216c0: 4669 656c 642c 2056 6172 6961 6e74 5479  Field, VariantTy
-000216d0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-000216e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000216f0: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
-00021700: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-00021710: 332c 2033 2c20 3229 2c20 3132 335d 5d2c  3, 3, 2), 123]],
-00021720: 2073 6368 656d 613d 5b22 6122 2c20 2262   schema=["a", "b
-00021730: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00021740: 6466 2e73 656c 6563 7428 6973 5f64 6174  df.select(is_dat
-00021750: 6528 746f 5f76 6172 6961 6e74 2864 665b  e(to_variant(df[
-00021760: 2261 225d 2929 2e61 6c69 6173 2822 6461  "a"])).alias("da
-00021770: 7465 2229 2c20 6973 5f64 6174 6528 746f  te"), is_date(to
-00021780: 5f76 6172 6961 6e74 2864 665b 2262 225d  _variant(df["b"]
-00021790: 2929 2e61 6c69 6173 2822 696e 7422 2929  )).alias("int"))
-000217a0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000217b0: 2020 205b 526f 7728 4441 5445 3d54 7275     [Row(DATE=Tru
-000217c0: 652c 2049 4e54 3d46 616c 7365 295d 0a20  e, INT=False)]. 
-000217d0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-000217e0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-000217f0: 6c2c 2022 6973 5f64 6174 6522 290a 2020  l, "is_date").  
-00021800: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00021810: 2822 6973 5f64 6174 6522 2928 6329 0a0a  ("is_date")(c)..
-00021820: 0a69 735f 6461 7465 5f76 616c 7565 203d  .is_date_value =
-00021830: 2069 735f 6461 7465 0a0a 0a64 6566 2069   is_date...def i
-00021840: 735f 6465 6369 6d61 6c28 636f 6c3a 2043  s_decimal(col: C
-00021850: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00021860: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00021870: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
-00021880: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
-00021890: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
-000218a0: 2063 6f6e 7461 696e 7320 6120 6669 7865   contains a fixe
-000218b0: 642d 706f 696e 7420 6465 6369 6d61 6c20  d-point decimal 
-000218c0: 7661 6c75 6520 6f72 2069 6e74 6567 6572  value or integer
-000218d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
-000218e0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-000218f0: 6d70 6f72 7420 6465 6369 6d61 6c0a 2020  mport decimal.  
-00021900: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00021910: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00021920: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
-00021930: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
-00021940: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
-00021950: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00021960: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00021970: 6528 5b5b 6465 6369 6d61 6c2e 4465 6369  e([[decimal.Deci
-00021980: 6d61 6c28 3129 2c20 2258 225d 5d2c 2073  mal(1), "X"]], s
-00021990: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
-000219a0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000219b0: 2e73 656c 6563 7428 6973 5f64 6563 696d  .select(is_decim
-000219c0: 616c 2874 6f5f 7661 7269 616e 7428 6466  al(to_variant(df
-000219d0: 5b22 6122 5d29 292e 616c 6961 7328 2264  ["a"])).alias("d
-000219e0: 6563 696d 616c 2229 2c20 6973 5f64 6563  ecimal"), is_dec
-000219f0: 696d 616c 2874 6f5f 7661 7269 616e 7428  imal(to_variant(
-00021a00: 6466 5b22 6222 5d29 292e 616c 6961 7328  df["b"])).alias(
-00021a10: 2276 6172 6368 6172 2229 292e 636f 6c6c  "varchar")).coll
-00021a20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00021a30: 6f77 2844 4543 494d 414c 3d54 7275 652c  ow(DECIMAL=True,
-00021a40: 2056 4152 4348 4152 3d46 616c 7365 295d   VARCHAR=False)]
-00021a50: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00021a60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00021a70: 636f 6c2c 2022 6973 5f64 6563 696d 616c  col, "is_decimal
-00021a80: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00021a90: 696c 7469 6e28 2269 735f 6465 6369 6d61  iltin("is_decima
-00021aa0: 6c22 2928 6329 0a0a 0a64 6566 2069 735f  l")(c)...def is_
-00021ab0: 646f 7562 6c65 2863 6f6c 3a20 436f 6c75  double(col: Colu
-00021ac0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00021ad0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00021ae0: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
-00021af0: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
-00021b00: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
-00021b10: 6e74 6169 6e73 2061 2066 6c6f 6174 696e  ntains a floatin
-00021b20: 672d 706f 696e 7420 7661 6c75 652c 2066  g-point value, f
-00021b30: 6978 6564 2d70 6f69 6e74 2064 6563 696d  ixed-point decim
-00021b40: 616c 2c20 6f72 2069 6e74 6567 6572 2e0a  al, or integer..
-00021b50: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00021b60: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00021b70: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00021b80: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00021b90: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
-00021ba0: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
-00021bb0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00021bc0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00021bd0: 7261 6d65 285b 5b31 2e32 2c20 2258 225d  rame([[1.2, "X"]
-00021be0: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-00021bf0: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-00021c00: 3e20 6466 2e73 656c 6563 7428 6973 5f64  > df.select(is_d
-00021c10: 6f75 626c 6528 746f 5f76 6172 6961 6e74  ouble(to_variant
-00021c20: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
-00021c30: 2822 646f 7562 6c65 2229 2c20 6973 5f64  ("double"), is_d
-00021c40: 6f75 626c 6528 746f 5f76 6172 6961 6e74  ouble(to_variant
-00021c50: 2864 665b 2262 225d 2929 2e61 6c69 6173  (df["b"])).alias
-00021c60: 2822 7661 7263 6861 7222 2929 2e63 6f6c  ("varchar")).col
-00021c70: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00021c80: 526f 7728 444f 5542 4c45 3d54 7275 652c  Row(DOUBLE=True,
-00021c90: 2056 4152 4348 4152 3d46 616c 7365 295d   VARCHAR=False)]
-00021ca0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00021cb0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00021cc0: 636f 6c2c 2022 6973 5f64 6f75 626c 6522  col, "is_double"
-00021cd0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00021ce0: 6c74 696e 2822 6973 5f64 6f75 626c 6522  ltin("is_double"
-00021cf0: 2928 6329 0a0a 0a64 6566 2069 735f 7265  )(c)...def is_re
-00021d00: 616c 2863 6f6c 3a20 436f 6c75 6d6e 4f72  al(col: ColumnOr
-00021d10: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00021d20: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00021d30: 7572 6e73 2074 7275 6520 6966 2074 6865  urns true if the
-00021d40: 2073 7065 6369 6669 6564 2056 4152 4941   specified VARIA
-00021d50: 4e54 2063 6f6c 756d 6e20 636f 6e74 6169  NT column contai
-00021d60: 6e73 2061 2066 6c6f 6174 696e 672d 706f  ns a floating-po
-00021d70: 696e 7420 7661 6c75 652c 2066 6978 6564  int value, fixed
-00021d80: 2d70 6f69 6e74 2064 6563 696d 616c 2c20  -point decimal, 
-00021d90: 6f72 2069 6e74 6567 6572 2e0a 0a20 2020  or integer...   
-00021da0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00021db0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00021dc0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00021dd0: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00021de0: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
-00021df0: 7265 616c 0a20 2020 2020 2020 203e 3e3e  real.        >>>
-00021e00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00021e10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00021e20: 5b31 2e32 2c20 2258 225d 5d2c 2073 6368  [1.2, "X"]], sch
-00021e30: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-00021e40: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00021e50: 656c 6563 7428 6973 5f72 6561 6c28 746f  elect(is_real(to
-00021e60: 5f76 6172 6961 6e74 2822 6122 2929 2e61  _variant("a")).a
-00021e70: 735f 2822 6122 292c 2069 735f 7265 616c  s_("a"), is_real
-00021e80: 2874 6f5f 7661 7269 616e 7428 2262 2229  (to_variant("b")
-00021e90: 292e 6173 5f28 2262 2229 292e 636f 6c6c  ).as_("b")).coll
-00021ea0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00021eb0: 6f77 2841 3d54 7275 652c 2042 3d46 616c  ow(A=True, B=Fal
-00021ec0: 7365 295d 0a20 2020 2022 2222 0a20 2020  se)].    """.   
-00021ed0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00021ee0: 7374 7228 636f 6c2c 2022 6973 5f72 6561  str(col, "is_rea
-00021ef0: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
-00021f00: 7569 6c74 696e 2822 6973 5f72 6561 6c22  uiltin("is_real"
-00021f10: 2928 6329 0a0a 0a64 6566 2069 735f 696e  )(c)...def is_in
-00021f20: 7465 6765 7228 636f 6c3a 2043 6f6c 756d  teger(col: Colum
-00021f30: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00021f40: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00021f50: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
-00021f60: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
-00021f70: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
-00021f80: 7461 696e 7320 6120 696e 7465 6765 7220  tains a integer 
-00021f90: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
-00021fa0: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
-00021fb0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00021fc0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-00021fd0: 7320 696d 706f 7274 2053 7472 7563 7446  s import StructF
-00021fe0: 6965 6c64 2c20 5661 7269 616e 7454 7970  ield, VariantTyp
-00021ff0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00022000: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00022010: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
-00022020: 2022 5822 5d5d 2c20 7363 6865 6d61 3d5b   "X"]], schema=[
-00022030: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-00022040: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00022050: 2869 735f 696e 7465 6765 7228 746f 5f76  (is_integer(to_v
-00022060: 6172 6961 6e74 2864 665b 2261 225d 2929  ariant(df["a"]))
-00022070: 2e61 6c69 6173 2822 696e 7422 292c 2069  .alias("int"), i
-00022080: 735f 696e 7465 6765 7228 746f 5f76 6172  s_integer(to_var
-00022090: 6961 6e74 2864 665b 2262 225d 2929 2e61  iant(df["b"])).a
-000220a0: 6c69 6173 2822 7661 7263 6861 7222 2929  lias("varchar"))
-000220b0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000220c0: 2020 205b 526f 7728 494e 543d 5472 7565     [Row(INT=True
-000220d0: 2c20 5641 5243 4841 523d 4661 6c73 6529  , VARCHAR=False)
-000220e0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-000220f0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00022100: 2863 6f6c 2c20 2269 735f 696e 7465 6765  (col, "is_intege
-00022110: 7222 290a 2020 2020 7265 7475 726e 2062  r").    return b
-00022120: 7569 6c74 696e 2822 6973 5f69 6e74 6567  uiltin("is_integ
-00022130: 6572 2229 2863 290a 0a0a 6465 6620 6973  er")(c)...def is
-00022140: 5f6e 756c 6c5f 7661 6c75 6528 636f 6c3a  _null_value(col:
-00022150: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00022160: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00022170: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
-00022180: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
-00022190: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
-000221a0: 6d6e 2063 6f6e 7461 696e 7320 6120 4a53  mn contains a JS
-000221b0: 4f4e 206e 756c 6c20 7661 6c75 652e 0a0a  ON null value...
-000221c0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000221d0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-000221e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-000221f0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-00022200: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
-00022210: 6973 5f6e 756c 6c5f 7661 6c75 650a 2020  is_null_value.  
-00022220: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00022230: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00022240: 7461 6672 616d 6528 5b5b 7b22 6122 3a20  taframe([[{"a": 
-00022250: 2266 6f6f 227d 5d2c 205b 7b22 6122 3a20  "foo"}], [{"a": 
-00022260: 4e6f 6e65 7d5d 2c20 5b4e 6f6e 655d 5d2c  None}], [None]],
-00022270: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00022280: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00022290: 6c65 6374 2869 735f 6e75 6c6c 5f76 616c  lect(is_null_val
-000222a0: 7565 2874 6f5f 7661 7269 616e 7428 2261  ue(to_variant("a
-000222b0: 2229 5b22 6122 5d29 2e61 735f 2822 6122  ")["a"]).as_("a"
-000222c0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-000222d0: 2020 2020 205b 526f 7728 413d 4661 6c73       [Row(A=Fals
-000222e0: 6529 2c20 526f 7728 413d 5472 7565 292c  e), Row(A=True),
-000222f0: 2052 6f77 2841 3d4e 6f6e 6529 5d0a 2020   Row(A=None)].  
-00022300: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00022310: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-00022320: 2c20 2269 735f 6e75 6c6c 5f76 616c 7565  , "is_null_value
-00022330: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00022340: 696c 7469 6e28 2269 735f 6e75 6c6c 5f76  iltin("is_null_v
-00022350: 616c 7565 2229 2863 290a 0a0a 6465 6620  alue")(c)...def 
-00022360: 6973 5f6f 626a 6563 7428 636f 6c3a 2043  is_object(col: C
-00022370: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00022380: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00022390: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
-000223a0: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
-000223b0: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
-000223c0: 2063 6f6e 7461 696e 7320 616e 204f 424a   contains an OBJ
-000223d0: 4543 5420 7661 6c75 652e 0a0a 2020 2020  ECT value...    
-000223e0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000223f0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00022400: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-00022410: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-00022420: 746f 5f76 6172 6961 6e74 2c20 6973 5f6f  to_variant, is_o
-00022430: 626a 6563 740a 2020 2020 2020 2020 3e3e  bject.        >>
-00022440: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00022450: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00022460: 5b5b 5b31 2c20 325d 2c20 7b22 6122 3a20  [[[1, 2], {"a": 
-00022470: 2273 6e6f 7722 7d5d 5d2c 2073 6368 656d  "snow"}]], schem
-00022480: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
-00022490: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000224a0: 6563 7428 6973 5f6f 626a 6563 7428 746f  ect(is_object(to
-000224b0: 5f76 6172 6961 6e74 2822 6122 2929 2e61  _variant("a")).a
-000224c0: 735f 2822 6122 292c 2069 735f 6f62 6a65  s_("a"), is_obje
-000224d0: 6374 2874 6f5f 7661 7269 616e 7428 2262  ct(to_variant("b
-000224e0: 2229 292e 6173 5f28 2262 2229 292e 636f  ")).as_("b")).co
-000224f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00022500: 5b52 6f77 2841 3d46 616c 7365 2c20 423d  [Row(A=False, B=
-00022510: 5472 7565 295d 0a20 2020 2022 2222 0a20  True)].    """. 
+00016c30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c46  -----.        |F
+00016c40: 616c 7365 2020 2020 2020 2020 2020 2020  alse            
+00016c50: 7c54 7275 6520 2020 2020 2020 2020 2020  |True           
+00016c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c70: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00016c80: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00016c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00016cc0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00016cd0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00016ce0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+00016cf0: 2c20 2263 6f6c 6c61 7465 2229 0a20 2020  , "collate").   
+00016d00: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00016d10: 2263 6f6c 6c61 7465 2229 2863 2c20 636f  "collate")(c, co
+00016d20: 6c6c 6174 696f 6e5f 7370 6563 290a 0a0a  llation_spec)...
+00016d30: 6465 6620 636f 6c6c 6174 696f 6e28 653a  def collation(e:
+00016d40: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00016d50: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00016d60: 2252 6574 7572 6e73 2074 6865 2063 6f6c  "Returns the col
+00016d70: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
+00016d80: 7469 6f6e 206f 6620 6578 7072 2e0a 0a20  tion of expr... 
+00016d90: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00016da0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00016db0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00016dc0: 6166 7261 6d65 285b 27c3 b127 5d2c 2073  aframe(['..'], s
+00016dd0: 6368 656d 613d 5b27 7627 5d29 0a20 2020  chema=['v']).   
+00016de0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00016df0: 6374 2863 6f6c 6c61 7469 6f6e 2863 6f6c  ct(collation(col
+00016e00: 6c61 7465 2864 662e 762c 2027 7370 2d75  late(df.v, 'sp-u
+00016e10: 7070 6572 2729 2929 2e73 686f 7728 290a  pper'))).show().
+00016e20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00016e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e50: 2d2d 2d0a 2020 2020 2020 2020 7c22 434f  ---.        |"CO
+00016e60: 4c4c 4154 494f 4e28 434f 4c4c 4154 4528  LLATION(COLLATE(
+00016e70: 2222 5622 222c 2027 5350 2d55 5050 4552  ""V"", 'SP-UPPER
+00016e80: 2729 2922 2020 7c0a 2020 2020 2020 2020  '))"  |.        
+00016e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00016ec0: 2020 2020 7c73 702d 7570 7065 7220 2020      |sp-upper   
+00016ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ee0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00016ef0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00016f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016f20: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00016f30: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00016f40: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00016f50: 6966 5f73 7472 2865 2c20 2263 6f6c 6c61  if_str(e, "colla
+00016f60: 7469 6f6e 2229 0a20 2020 2072 6574 7572  tion").    retur
+00016f70: 6e20 6275 696c 7469 6e28 2263 6f6c 6c61  n builtin("colla
+00016f80: 7469 6f6e 2229 2863 290a 0a0a 6465 6620  tion")(c)...def 
+00016f90: 636f 6e63 6174 282a 636f 6c73 3a20 436f  concat(*cols: Co
+00016fa0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00016fb0: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+00016fc0: 6e63 6174 656e 6174 6573 206f 6e65 206f  ncatenates one o
+00016fd0: 7220 6d6f 7265 2073 7472 696e 6773 2c20  r more strings, 
+00016fe0: 6f72 2063 6f6e 6361 7465 6e61 7465 7320  or concatenates 
+00016ff0: 6f6e 6520 6f72 206d 6f72 6520 6269 6e61  one or more bina
+00017000: 7279 2076 616c 7565 732e 2049 6620 616e  ry values. If an
+00017010: 7920 6f66 2074 6865 2076 616c 7565 7320  y of the values 
+00017020: 6973 206e 756c 6c2c 2074 6865 2072 6573  is null, the res
+00017030: 756c 7420 6973 2061 6c73 6f20 6e75 6c6c  ult is also null
+00017040: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00017050: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00017060: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00017070: 5f64 6174 6166 7261 6d65 285b 5b27 4865  _dataframe([['He
+00017080: 6c6c 6f27 2c20 2757 6f72 6c64 275d 5d2c  llo', 'World']],
+00017090: 2073 6368 656d 613d 5b27 6127 2c20 2762   schema=['a', 'b
+000170a0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+000170b0: 6466 2e73 656c 6563 7428 636f 6e63 6174  df.select(concat
+000170c0: 2864 662e 612c 2064 662e 6229 292e 7368  (df.a, df.b)).sh
+000170d0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+000170e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000170f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00017100: 7c22 434f 4e43 4154 2822 2241 2222 2c20  |"CONCAT(""A"", 
+00017110: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
+00017120: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00017130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00017140: 2020 2020 2020 7c48 656c 6c6f 576f 726c        |HelloWorl
+00017150: 6420 2020 2020 2020 2020 2020 2020 207c  d              |
+00017160: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017180: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00017190: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+000171a0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
+000171b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000171c0: 2c20 2263 6f6e 6361 7422 2920 666f 7220  , "concat") for 
+000171d0: 6320 696e 2063 6f6c 735d 0a20 2020 2072  c in cols].    r
+000171e0: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+000171f0: 6f6e 6361 7422 2928 2a63 6f6c 756d 6e73  oncat")(*columns
+00017200: 290a 0a0a 6465 6620 636f 6e63 6174 5f77  )...def concat_w
+00017210: 7328 2a63 6f6c 733a 2043 6f6c 756d 6e4f  s(*cols: ColumnO
+00017220: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00017230: 3a0a 2020 2020 2222 2243 6f6e 6361 7465  :.    """Concate
+00017240: 6e61 7465 7320 7477 6f20 6f72 206d 6f72  nates two or mor
+00017250: 6520 7374 7269 6e67 732c 206f 7220 636f  e strings, or co
+00017260: 6e63 6174 656e 6174 6573 2074 776f 206f  ncatenates two o
+00017270: 7220 6d6f 7265 2062 696e 6172 7920 7661  r more binary va
+00017280: 6c75 6573 2e20 4966 2061 6e79 206f 6620  lues. If any of 
+00017290: 7468 6520 7661 6c75 6573 2069 7320 6e75  the values is nu
+000172a0: 6c6c 2c20 7468 6520 7265 7375 6c74 2069  ll, the result i
+000172b0: 7320 616c 736f 206e 756c 6c2e 0a20 2020  s also null..   
+000172c0: 2054 6865 2043 4f4e 4341 545f 5753 206f   The CONCAT_WS o
+000172d0: 7065 7261 746f 7220 7265 7175 6972 6573  perator requires
+000172e0: 2061 7420 6c65 6173 7420 7477 6f20 6172   at least two ar
+000172f0: 6775 6d65 6e74 732c 2061 6e64 2075 7365  guments, and use
+00017300: 7320 7468 6520 6669 7273 7420 6172 6775  s the first argu
+00017310: 6d65 6e74 2074 6f20 7365 7061 7261 7465  ment to separate
+00017320: 2061 6c6c 2066 6f6c 6c6f 7769 6e67 2061   all following a
+00017330: 7267 756d 656e 7473 2e0a 0a20 2020 2045  rguments...    E
+00017340: 7861 6d70 6c65 733a 3a0a 2020 2020 2020  xamples::.      
+00017350: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00017360: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+00017370: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
+00017380: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
+00017390: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000173a0: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
+000173b0: 4865 6c6c 6f27 2c20 2757 6f72 6c64 275d  Hello', 'World']
+000173c0: 5d2c 2073 6368 656d 613d 5b27 6127 2c20  ], schema=['a', 
+000173d0: 2762 275d 290a 2020 2020 2020 2020 3e3e  'b']).        >>
+000173e0: 3e20 6466 2e73 656c 6563 7428 636f 6e63  > df.select(conc
+000173f0: 6174 5f77 7328 6c69 7428 272c 2729 2c20  at_ws(lit(','), 
+00017400: 6466 2e61 2c20 6466 2e62 2929 2e73 686f  df.a, df.b)).sho
+00017410: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00017420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00017440: 2020 2020 2020 207c 2243 4f4e 4341 545f         |"CONCAT_
+00017450: 5753 2827 2c27 2c20 2222 4122 222c 2022  WS(',', ""A"", "
+00017460: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
+00017470: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00017480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017490: 2d2d 2d2d 0a20 2020 2020 2020 207c 4865  ----.        |He
+000174a0: 6c6c 6f2c 576f 726c 6420 2020 2020 2020  llo,World       
+000174b0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+000174c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000174d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000174e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000174f0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
+00017500: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00017510: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00017520: 6461 7461 6672 616d 6528 5b5b 2748 656c  dataframe([['Hel
+00017530: 6c6f 272c 2027 576f 726c 6427 2c20 272c  lo', 'World', ',
+00017540: 275d 5d2c 2073 6368 656d 613d 5b27 6127  ']], schema=['a'
+00017550: 2c20 2762 272c 2027 7365 7027 5d29 0a20  , 'b', 'sep']). 
+00017560: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00017570: 6c65 6374 2863 6f6e 6361 745f 7773 2827  lect(concat_ws('
+00017580: 7365 7027 2c20 6466 2e61 2c20 6466 2e62  sep', df.a, df.b
+00017590: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000175a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000175b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000175c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000175d0: 207c 2243 4f4e 4341 545f 5753 2822 2253   |"CONCAT_WS(""S
+000175e0: 4550 2222 2c20 2222 4122 222c 2022 2242  EP"", ""A"", ""B
+000175f0: 2222 2922 2020 7c0a 2020 2020 2020 2020  "")"  |.        
+00017600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017620: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00017630: 4865 6c6c 6f2c 576f 726c 6420 2020 2020  Hello,World     
+00017640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017650: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00017660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00017680: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00017690: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+000176a0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
+000176b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000176c0: 2c20 2263 6f6e 6361 745f 7773 2229 2066  , "concat_ws") f
+000176d0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
+000176e0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000176f0: 2822 636f 6e63 6174 5f77 7322 2928 2a63  ("concat_ws")(*c
+00017700: 6f6c 756d 6e73 290a 0a0a 6465 6620 7472  olumns)...def tr
+00017710: 616e 736c 6174 6528 0a20 2020 2073 7263  anslate(.    src
+00017720: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
+00017730: 2020 2020 736f 7572 6365 5f61 6c70 6861      source_alpha
+00017740: 6265 743a 2043 6f6c 756d 6e4f 724e 616d  bet: ColumnOrNam
+00017750: 652c 0a20 2020 2074 6172 6765 745f 616c  e,.    target_al
+00017760: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
+00017770: 4e61 6d65 2c0a 2920 2d3e 2043 6f6c 756d  Name,.) -> Colum
+00017780: 6e3a 0a20 2020 2022 2222 5472 616e 736c  n:.    """Transl
+00017790: 6174 6573 2073 7263 2066 726f 6d20 7468  ates src from th
+000177a0: 6520 6368 6172 6163 7465 7273 2069 6e20  e characters in 
+000177b0: 736f 7572 6365 5f61 6c70 6861 6265 7420  source_alphabet 
+000177c0: 746f 2074 6865 2063 6861 7261 6374 6572  to the character
+000177d0: 7320 696e 0a20 2020 2074 6172 6765 745f  s in.    target_
+000177e0: 616c 7068 6162 6574 2e20 4561 6368 2063  alphabet. Each c
+000177f0: 6861 7261 6374 6572 206d 6174 6368 696e  haracter matchin
+00017800: 6720 6120 6368 6172 6163 7465 7220 6174  g a character at
+00017810: 2070 6f73 6974 696f 6e20 6920 696e 2074   position i in t
+00017820: 6865 2073 6f75 7263 655f 616c 7068 6162  he source_alphab
+00017830: 6574 2069 7320 7265 706c 6163 6564 0a20  et is replaced. 
+00017840: 2020 2077 6974 6820 7468 6520 6368 6172     with the char
+00017850: 6163 7465 7220 6174 2070 6f73 6974 696f  acter at positio
+00017860: 6e20 6920 696e 2074 6865 2074 6172 6765  n i in the targe
+00017870: 745f 616c 7068 6162 6574 2e20 4966 2074  t_alphabet. If t
+00017880: 6172 6765 745f 616c 7068 6162 6574 2069  arget_alphabet i
+00017890: 7320 7368 6f72 7465 722c 2061 6e64 2074  s shorter, and t
+000178a0: 6865 7265 2069 7320 6e6f 2063 6f72 7265  here is no corre
+000178b0: 7370 6f6e 6469 6e67 0a20 2020 2063 6861  sponding.    cha
+000178c0: 7261 6374 6572 2074 6865 2063 6861 7261  racter the chara
+000178d0: 6374 6572 2069 7320 6f6d 6974 7465 642e  cter is omitted.
+000178e0: 2074 6172 6765 745f 616c 7068 6162 6574   target_alphabet
+000178f0: 2063 616e 206e 6f74 2062 6520 6c6f 6e67   can not be long
+00017900: 6572 2074 6861 6e20 736f 7572 6365 5f61  er than source_a
+00017910: 6c70 6861 6265 742e 0a0a 2020 2020 4578  lphabet...    Ex
+00017920: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00017930: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00017940: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00017950: 6d65 285b 2261 6263 6465 6622 2c20 2261  me(["abcdef", "a
+00017960: 6262 6122 5d2c 2073 6368 656d 613d 5b22  bba"], schema=["
+00017970: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00017980: 2064 662e 7365 6c65 6374 2874 7261 6e73   df.select(trans
+00017990: 6c61 7465 2863 6f6c 2822 6122 292c 206c  late(col("a"), l
+000179a0: 6974 2822 6162 6322 292c 206c 6974 2822  it("abc"), lit("
+000179b0: 4142 4322 2929 2e61 735f 2822 616e 7322  ABC")).as_("ans"
+000179c0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000179d0: 2020 2020 205b 526f 7728 414e 533d 2741       [Row(ANS='A
+000179e0: 4243 6465 6627 292c 2052 6f77 2841 4e53  BCdef'), Row(ANS
+000179f0: 3d27 4142 4241 2729 5d0a 0a20 2020 2020  ='ABBA')]..     
+00017a00: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00017a10: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00017a20: 7261 6d65 285b 2266 696c 6520 7769 7468  rame(["file with
+00017a30: 2073 7061 6365 732e 7478 7422 2c20 225c   spaces.txt", "\
+00017a40: 5c74 7465 7374 225d 2c20 7363 6865 6d61  \ttest"], schema
+00017a50: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00017a60: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+00017a70: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
+00017a80: 2c20 6c69 7428 2220 5c5c 7422 292c 206c  , lit(" \\t"), l
+00017a90: 6974 2822 5f22 2929 2e61 735f 2822 616e  it("_")).as_("an
+00017aa0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
+00017ab0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00017ac0: 2766 696c 655f 7769 7468 5f73 7061 6365  'file_with_space
+00017ad0: 732e 7478 7427 292c 2052 6f77 2841 4e53  s.txt'), Row(ANS
+00017ae0: 3d27 7465 7374 2729 5d0a 0a20 2020 2022  ='test')]..    "
+00017af0: 2222 0a20 2020 2073 6f75 7263 6520 3d20  "".    source = 
+00017b00: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2873  _to_col_if_str(s
+00017b10: 7263 2c20 2274 7261 6e73 6c61 7465 2229  rc, "translate")
+00017b20: 0a20 2020 2073 6f75 7263 655f 616c 7068  .    source_alph
+00017b30: 6162 6574 203d 205f 746f 5f63 6f6c 5f69  abet = _to_col_i
+00017b40: 665f 7374 7228 736f 7572 6365 5f61 6c70  f_str(source_alp
+00017b50: 6861 6265 742c 2022 7472 616e 736c 6174  habet, "translat
+00017b60: 6522 290a 2020 2020 7461 7267 6574 5f61  e").    target_a
+00017b70: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
+00017b80: 6c5f 6966 5f73 7472 2874 6172 6765 745f  l_if_str(target_
+00017b90: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
+00017ba0: 6c61 7465 2229 0a20 2020 2072 6574 7572  late").    retur
+00017bb0: 6e20 6275 696c 7469 6e28 2274 7261 6e73  n builtin("trans
+00017bc0: 6c61 7465 2229 2873 6f75 7263 652c 2073  late")(source, s
+00017bd0: 6f75 7263 655f 616c 7068 6162 6574 2c20  ource_alphabet, 
+00017be0: 7461 7267 6574 5f61 6c70 6861 6265 7429  target_alphabet)
+00017bf0: 0a0a 0a64 6566 2063 6f6e 7461 696e 7328  ...def contains(
+00017c00: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
+00017c10: 652c 2073 7472 696e 673a 2043 6f6c 756d  e, string: Colum
+00017c20: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00017c30: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00017c40: 6e73 2069 6620 6063 6f6c 6020 636f 6e74  ns if `col` cont
+00017c50: 6169 6e73 2060 7374 7269 6e67 6020 666f  ains `string` fo
+00017c60: 7220 6561 6368 2072 6f77 2e20 5365 6520  r each row. See 
+00017c70: 6043 4f4e 5441 494e 5320 3c68 7474 7073  `CONTAINS <https
+00017c80: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+00017c90: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+00017ca0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
+00017cb0: 2f63 6f6e 7461 696e 733e 600a 0a20 2020  /contains>`..   
+00017cc0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00017cd0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00017ce0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00017cf0: 616d 6528 5b5b 312c 325d 2c20 5b33 2c34  ame([[1,2], [3,4
+00017d00: 5d2c 205b 352c 355d 205d 2c20 7363 6865  ], [5,5] ], sche
+00017d10: 6d61 3d5b 2261 222c 2262 225d 290a 2020  ma=["a","b"]).  
+00017d20: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00017d30: 6563 7428 636f 6e74 6169 6e73 2863 6f6c  ect(contains(col
+00017d40: 2822 6122 292c 2063 6f6c 2822 6222 2929  ("a"), col("b"))
+00017d50: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+00017d60: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00017d70: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00017d80: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00017d90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00017da0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00017db0: 7c46 616c 7365 2020 2020 207c 0a20 2020  |False     |.   
+00017dc0: 2020 2020 207c 4661 6c73 6520 2020 2020       |False     
+00017dd0: 7c0a 2020 2020 2020 2020 7c54 7275 6520  |.        |True 
+00017de0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00017df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00017e00: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00017e10: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00017e20: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00017e30: 6f6c 2c20 2263 6f6e 7461 696e 7322 290a  ol, "contains").
+00017e40: 2020 2020 7320 3d20 5f74 6f5f 636f 6c5f      s = _to_col_
+00017e50: 6966 5f73 7472 2873 7472 696e 672c 2022  if_str(string, "
+00017e60: 636f 6e74 6169 6e73 2229 0a20 2020 2072  contains").    r
+00017e70: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+00017e80: 6f6e 7461 696e 7322 2928 632c 2073 290a  ontains")(c, s).
+00017e90: 0a0a 6465 6620 7374 6172 7473 7769 7468  ..def startswith
+00017ea0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+00017eb0: 6d65 2c20 7374 723a 2043 6f6c 756d 6e4f  me, str: ColumnO
+00017ec0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00017ed0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+00017ee0: 2074 7275 6520 6966 2063 6f6c 2073 7461   true if col sta
+00017ef0: 7274 7320 7769 7468 2073 7472 2e0a 0a20  rts with str... 
+00017f00: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00017f10: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00017f20: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00017f30: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00017f40: 2e2e 2e20 2020 2020 5b5b 2261 6263 222c  ...     [["abc",
+00017f50: 2022 6122 5d2c 205b 2261 6263 222c 2022   "a"], ["abc", "
+00017f60: 7322 5d5d 2c0a 2020 2020 2020 2020 2e2e  s"]],.        ..
+00017f70: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
+00017f80: 222c 2022 5022 5d2c 0a20 2020 2020 2020  ", "P"],.       
+00017f90: 202e 2e2e 2029 2e73 656c 6563 7428 7374   ... ).select(st
+00017fa0: 6172 7473 7769 7468 2863 6f6c 2822 5322  artswith(col("S"
+00017fb0: 292c 2063 6f6c 2822 5022 2929 290a 2020  ), col("P"))).  
+00017fc0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+00017fd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00017fe0: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
+00017ff0: 5322 2c20 2250 2229 3d54 7275 6529 2c20  S", "P")=True), 
+00018000: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
+00018010: 5322 2c20 2250 2229 3d46 616c 7365 295d  S", "P")=False)]
+00018020: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00018030: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00018040: 636f 6c2c 2022 7374 6172 7473 7769 7468  col, "startswith
+00018050: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
+00018060: 6f6c 5f69 665f 7374 7228 7374 722c 2022  ol_if_str(str, "
+00018070: 7374 6172 7473 7769 7468 2229 0a20 2020  startswith").   
+00018080: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00018090: 2273 7461 7274 7377 6974 6822 2928 632c  "startswith")(c,
+000180a0: 2073 290a 0a0a 6465 6620 656e 6473 7769   s)...def endswi
+000180b0: 7468 2863 6f6c 3a20 436f 6c75 6d6e 4f72  th(col: ColumnOr
+000180c0: 4e61 6d65 2c20 7374 723a 2043 6f6c 756d  Name, str: Colum
+000180d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000180e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000180f0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00018100: 636f 6c20 656e 6473 2077 6974 6820 7374  col ends with st
+00018110: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
+00018120: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00018130: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00018140: 7465 5f64 6174 6166 7261 6d65 285b 2261  te_dataframe(["a
+00018150: 7070 6c65 222c 2022 6261 6e61 6e61 222c  pple", "banana",
+00018160: 2022 7065 6163 6822 5d2c 2073 6368 656d   "peach"], schem
+00018170: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00018180: 203e 3e3e 2064 662e 7365 6c65 6374 2865   >>> df.select(e
+00018190: 6e64 7377 6974 6828 6466 5b22 6122 5d2c  ndswith(df["a"],
+000181a0: 206c 6974 2822 616e 6122 2929 2e61 6c69   lit("ana")).ali
+000181b0: 6173 2822 656e 6473 7769 7468 2229 292e  as("endswith")).
+000181c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000181d0: 2020 5b52 6f77 2845 4e44 5357 4954 483d    [Row(ENDSWITH=
+000181e0: 4661 6c73 6529 2c20 526f 7728 454e 4453  False), Row(ENDS
+000181f0: 5749 5448 3d54 7275 6529 2c20 526f 7728  WITH=True), Row(
+00018200: 454e 4453 5749 5448 3d46 616c 7365 295d  ENDSWITH=False)]
+00018210: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00018220: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00018230: 636f 6c2c 2022 656e 6473 7769 7468 2229  col, "endswith")
+00018240: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+00018250: 5f69 665f 7374 7228 7374 722c 2022 656e  _if_str(str, "en
+00018260: 6473 7769 7468 2229 0a20 2020 2072 6574  dswith").    ret
+00018270: 7572 6e20 6275 696c 7469 6e28 2265 6e64  urn builtin("end
+00018280: 7377 6974 6822 2928 632c 2073 290a 0a0a  swith")(c, s)...
+00018290: 6465 6620 696e 7365 7274 280a 2020 2020  def insert(.    
+000182a0: 6261 7365 5f65 7870 723a 2043 6f6c 756d  base_expr: Colum
+000182b0: 6e4f 724e 616d 652c 0a20 2020 2070 6f73  nOrName,.    pos
+000182c0: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
+000182d0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 206c  umn, int],.    l
+000182e0: 656e 6774 683a 2055 6e69 6f6e 5b43 6f6c  ength: Union[Col
+000182f0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 2069  umn, int],.    i
+00018300: 6e73 6572 745f 6578 7072 3a20 436f 6c75  nsert_expr: Colu
+00018310: 6d6e 4f72 4e61 6d65 2c0a 2920 2d3e 2043  mnOrName,.) -> C
+00018320: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00018330: 2020 2052 6570 6c61 6365 7320 6120 7375     Replaces a su
+00018340: 6273 7472 696e 6720 6f66 2074 6865 2073  bstring of the s
+00018350: 7065 6369 6669 6564 206c 656e 6774 682c  pecified length,
+00018360: 2073 7461 7274 696e 6720 6174 2074 6865   starting at the
+00018370: 2073 7065 6369 6669 6564 2070 6f73 6974   specified posit
+00018380: 696f 6e2c 0a20 2020 2077 6974 6820 6120  ion,.    with a 
+00018390: 6e65 7720 7374 7269 6e67 206f 7220 6269  new string or bi
+000183a0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
+000183b0: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+000183c0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000183d0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000183e0: 6166 7261 6d65 285b 2261 6263 225d 2c20  aframe(["abc"], 
+000183f0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00018400: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00018410: 6563 7428 696e 7365 7274 2864 665b 2261  ect(insert(df["a
+00018420: 225d 2c20 312c 2032 2c20 6c69 7428 225a  "], 1, 2, lit("Z
+00018430: 2229 292e 616c 6961 7328 2269 6e73 6572  ")).alias("inser
+00018440: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
+00018450: 2020 2020 2020 205b 526f 7728 494e 5345         [Row(INSE
+00018460: 5254 3d27 5a63 2729 5d0a 2020 2020 2222  RT='Zc')].    ""
+00018470: 220a 2020 2020 6220 3d20 5f74 6f5f 636f  ".    b = _to_co
+00018480: 6c5f 6966 5f73 7472 2862 6173 655f 6578  l_if_str(base_ex
+00018490: 7072 2c20 2269 6e73 6572 7422 290a 2020  pr, "insert").  
+000184a0: 2020 6920 3d20 5f74 6f5f 636f 6c5f 6966    i = _to_col_if
+000184b0: 5f73 7472 2869 6e73 6572 745f 6578 7072  _str(insert_expr
+000184c0: 2c20 2269 6e73 6572 7422 290a 2020 2020  , "insert").    
+000184d0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+000184e0: 696e 7365 7274 2229 2862 2c20 6c69 7428  insert")(b, lit(
+000184f0: 706f 7369 7469 6f6e 292c 206c 6974 286c  position), lit(l
+00018500: 656e 6774 6829 2c20 6929 0a0a 0a64 6566  ength), i)...def
+00018510: 206c 6566 7428 7374 725f 6578 7072 3a20   left(str_expr: 
+00018520: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6c65  ColumnOrName, le
+00018530: 6e67 7468 3a20 556e 696f 6e5b 436f 6c75  ngth: Union[Colu
+00018540: 6d6e 2c20 696e 745d 2920 2d3e 2043 6f6c  mn, int]) -> Col
+00018550: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00018560: 726e 7320 6120 6c65 6674 206d 6f73 7420  rns a left most 
+00018570: 7375 6273 7472 696e 6720 6f66 2060 6073  substring of ``s
+00018580: 7472 5f65 7870 7260 602e 0a0a 2020 2020  tr_expr``...    
+00018590: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000185a0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000185b0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000185c0: 7261 6d65 285b 5b22 6162 6322 5d2c 205b  rame([["abc"], [
+000185d0: 2264 6566 225d 5d2c 2073 6368 656d 613d  "def"]], schema=
+000185e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+000185f0: 3e3e 2064 662e 7365 6c65 6374 286c 6566  >> df.select(lef
+00018600: 7428 636f 6c28 2261 2229 2c20 3229 2e61  t(col("a"), 2).a
+00018610: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00018620: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00018630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00018640: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00018650: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00018660: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c61  -----.        |a
+00018670: 6220 2020 2020 2020 207c 0a20 2020 2020  b        |.     
+00018680: 2020 207c 6465 2020 2020 2020 2020 7c0a     |de        |.
+00018690: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000186a0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+000186b0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+000186c0: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+000186d0: 5f69 665f 7374 7228 7374 725f 6578 7072  _if_str(str_expr
+000186e0: 2c20 226c 6566 7422 290a 2020 2020 7265  , "left").    re
+000186f0: 7475 726e 2062 7569 6c74 696e 2822 6c65  turn builtin("le
+00018700: 6674 2229 2873 2c20 6c69 7428 6c65 6e67  ft")(s, lit(leng
+00018710: 7468 2929 0a0a 0a64 6566 2072 6967 6874  th))...def right
+00018720: 2873 7472 5f65 7870 723a 2043 6f6c 756d  (str_expr: Colum
+00018730: 6e4f 724e 616d 652c 206c 656e 6774 683a  nOrName, length:
+00018740: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
+00018750: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
+00018760: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+00018770: 2072 6967 6874 206d 6f73 7420 7375 6273   right most subs
+00018780: 7472 696e 6720 6f66 2060 6073 7472 5f65  tring of ``str_e
+00018790: 7870 7260 602e 0a0a 2020 2020 4578 616d  xpr``...    Exam
+000187a0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+000187b0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000187c0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000187d0: 285b 5b22 6162 6322 5d2c 205b 2264 6566  ([["abc"], ["def
+000187e0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
+000187f0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00018800: 662e 7365 6c65 6374 2872 6967 6874 2863  f.select(right(c
+00018810: 6f6c 2822 6122 292c 2032 292e 616c 6961  ol("a"), 2).alia
+00018820: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00018830: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00018840: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00018850: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00018860: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00018870: 2d2d 0a20 2020 2020 2020 207c 6263 2020  --.        |bc  
+00018880: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00018890: 7c65 6620 2020 2020 2020 207c 0a20 2020  |ef        |.   
+000188a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000188b0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+000188c0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+000188d0: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
+000188e0: 5f73 7472 2873 7472 5f65 7870 722c 2022  _str(str_expr, "
+000188f0: 7269 6768 7422 290a 2020 2020 7265 7475  right").    retu
+00018900: 726e 2062 7569 6c74 696e 2822 7269 6768  rn builtin("righ
+00018910: 7422 2928 732c 206c 6974 286c 656e 6774  t")(s, lit(lengt
+00018920: 6829 290a 0a0a 6465 6620 6368 6172 2863  h))...def char(c
+00018930: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+00018940: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00018950: 2022 2222 436f 6e76 6572 7473 2061 2055   """Converts a U
+00018960: 6e69 636f 6465 2063 6f64 6520 706f 696e  nicode code poin
+00018970: 7420 2869 6e63 6c75 6469 6e67 2037 2d62  t (including 7-b
+00018980: 6974 2041 5343 4949 2920 696e 746f 2074  it ASCII) into t
+00018990: 6865 2063 6861 7261 6374 6572 2074 6861  he character tha
+000189a0: 740a 2020 2020 6d61 7463 6865 7320 7468  t.    matches th
+000189b0: 6520 696e 7075 7420 556e 6963 6f64 652e  e input Unicode.
+000189c0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+000189d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000189e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000189f0: 5f64 6174 6166 7261 6d65 285b 3833 2c20  _dataframe([83, 
+00018a00: 3333 2c20 3136 392c 2038 3336 342c 204e  33, 169, 8364, N
+00018a10: 6f6e 655d 2c20 7363 6865 6d61 3d5b 2761  one], schema=['a
+00018a20: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00018a30: 6466 2e73 656c 6563 7428 6466 2e61 2c20  df.select(df.a, 
+00018a40: 6368 6172 2864 662e 6129 2e61 735f 2827  char(df.a).as_('
+00018a50: 6368 6172 2729 292e 736f 7274 2864 662e  char')).sort(df.
+00018a60: 6129 2e73 686f 7728 290a 2020 2020 2020  a).show().      
+00018a70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00018a80: 2d2d 2d0a 2020 2020 2020 2020 7c22 4122  ---.        |"A"
+00018a90: 2020 207c 2243 4841 5222 2020 7c0a 2020     |"CHAR"  |.  
+00018aa0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00018ab0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00018ac0: 7c4e 554c 4c20 207c 4e55 4c4c 2020 2020  |NULL  |NULL    
+00018ad0: 7c0a 2020 2020 2020 2020 7c33 3320 2020  |.        |33   
+00018ae0: 207c 2120 2020 2020 2020 7c0a 2020 2020   |!       |.    
+00018af0: 2020 2020 7c38 3320 2020 207c 5320 2020      |83    |S   
+00018b00: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
+00018b10: 3639 2020 207c c2a9 2020 2020 2020 207c  69   |..       |
+00018b20: 0a20 2020 2020 2020 207c 3833 3634 2020  .        |8364  
+00018b30: 7ce2 82ac 2020 2020 2020 207c 0a20 2020  |...       |.   
+00018b40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00018b50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00018b60: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00018b70: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00018b80: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+00018b90: 6368 6172 2229 0a20 2020 2072 6574 7572  char").    retur
+00018ba0: 6e20 6275 696c 7469 6e28 2263 6861 7222  n builtin("char"
+00018bb0: 2928 6329 0a0a 0a64 6566 2074 6f5f 6368  )(c)...def to_ch
+00018bc0: 6172 2863 3a20 436f 6c75 6d6e 4f72 4e61  ar(c: ColumnOrNa
+00018bd0: 6d65 2c20 666f 726d 6174 3a20 4f70 7469  me, format: Opti
+00018be0: 6f6e 616c 5b43 6f6c 756d 6e4f 724c 6974  onal[ColumnOrLit
+00018bf0: 6572 616c 5374 725d 203d 204e 6f6e 6529  eralStr] = None)
+00018c00: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00018c10: 2222 2243 6f6e 7665 7274 7320 6120 556e  """Converts a Un
+00018c20: 6963 6f64 6520 636f 6465 2070 6f69 6e74  icode code point
+00018c30: 2028 696e 636c 7564 696e 6720 372d 6269   (including 7-bi
+00018c40: 7420 4153 4349 4929 2069 6e74 6f20 7468  t ASCII) into th
+00018c50: 6520 6368 6172 6163 7465 7220 7468 6174  e character that
+00018c60: 0a20 2020 206d 6174 6368 6573 2074 6865  .    matches the
+00018c70: 2069 6e70 7574 2055 6e69 636f 6465 2e0a   input Unicode..
+00018c80: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00018c90: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00018ca0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00018cb0: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
+00018cc0: 332c 2034 5d2c 2073 6368 656d 613d 5b27  3, 4], schema=['
+00018cd0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
+00018ce0: 2064 662e 7365 6c65 6374 2874 6f5f 6368   df.select(to_ch
+00018cf0: 6172 2863 6f6c 2827 6127 2929 2e61 735f  ar(col('a')).as_
+00018d00: 2827 616e 7327 2929 2e63 6f6c 6c65 6374  ('ans')).collect
+00018d10: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00018d20: 414e 533d 2731 2729 2c20 526f 7728 414e  ANS='1'), Row(AN
+00018d30: 533d 2732 2729 2c20 526f 7728 414e 533d  S='2'), Row(ANS=
+00018d40: 2733 2729 2c20 526f 7728 414e 533d 2734  '3'), Row(ANS='4
+00018d50: 2729 5d0a 0a20 2020 2045 7861 6d70 6c65  ')]..    Example
+00018d60: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00018d70: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+00018d80: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00018d90: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00018da0: 6461 7461 6672 616d 6528 5b64 6174 6574  dataframe([datet
+00018db0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+00018dc0: 332c 2034 2c20 3136 292c 2064 6174 6574  3, 4, 16), datet
+00018dd0: 696d 652e 6461 7465 7469 6d65 2832 3031  ime.datetime(201
+00018de0: 372c 2034 2c20 332c 2032 2c20 3539 2c20  7, 4, 3, 2, 59, 
+00018df0: 3337 2c20 3135 3329 5d2c 2073 6368 656d  37, 153)], schem
+00018e00: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
+00018e10: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
+00018e20: 6f5f 6368 6172 2863 6f6c 2827 6127 2929  o_char(col('a'))
+00018e30: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
+00018e40: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00018e50: 526f 7728 414e 533d 2732 3032 332d 3034  Row(ANS='2023-04
+00018e60: 2d31 3620 3030 3a30 303a 3030 2e30 3030  -16 00:00:00.000
+00018e70: 2729 2c20 526f 7728 414e 533d 2732 3031  '), Row(ANS='201
+00018e80: 372d 3034 2d30 3320 3032 3a35 393a 3337  7-04-03 02:59:37
+00018e90: 2e30 3030 2729 5d0a 0a20 2020 2022 2222  .000')]..    """
+00018ea0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00018eb0: 5f69 665f 7374 7228 632c 2022 746f 5f63  _if_str(c, "to_c
+00018ec0: 6861 7222 290a 2020 2020 7265 7475 726e  har").    return
+00018ed0: 2028 0a20 2020 2020 2020 2062 7569 6c74   (.        built
+00018ee0: 696e 2822 746f 5f63 6861 7222 2928 632c  in("to_char")(c,
+00018ef0: 206c 6974 2866 6f72 6d61 7429 290a 2020   lit(format)).  
+00018f00: 2020 2020 2020 6966 2066 6f72 6d61 7420        if format 
+00018f10: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00018f20: 2020 2020 656c 7365 2062 7569 6c74 696e      else builtin
+00018f30: 2822 746f 5f63 6861 7222 2928 6329 0a20  ("to_char")(c). 
+00018f40: 2020 2029 0a0a 0a64 6566 2074 6f5f 7469     )...def to_ti
+00018f50: 6d65 2865 3a20 436f 6c75 6d6e 4f72 4e61  me(e: ColumnOrNa
+00018f60: 6d65 2c20 666d 743a 204f 7074 696f 6e61  me, fmt: Optiona
+00018f70: 6c5b 2243 6f6c 756d 6e22 5d20 3d20 4e6f  l["Column"] = No
+00018f80: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00018f90: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
+00018fa0: 6e20 696e 7075 7420 6578 7072 6573 7369  n input expressi
+00018fb0: 6f6e 2069 6e74 6f20 7468 6520 636f 7272  on into the corr
+00018fc0: 6573 706f 6e64 696e 6720 7469 6d65 2e0a  esponding time..
+00018fd0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00018fe0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00018ff0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00019000: 6461 7461 6672 616d 6528 5b27 3034 3a31  dataframe(['04:1
+00019010: 353a 3239 2e39 3939 275d 2c20 7363 6865  5:29.999'], sche
+00019020: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00019030: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00019040: 746f 5f74 696d 6528 636f 6c28 2261 2229  to_time(col("a")
+00019050: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00019060: 2020 2020 205b 526f 7728 544f 5f54 494d       [Row(TO_TIM
+00019070: 4528 2241 2229 3d64 6174 6574 696d 652e  E("A")=datetime.
+00019080: 7469 6d65 2834 2c20 3135 2c20 3239 2c20  time(4, 15, 29, 
+00019090: 3939 3930 3030 2929 5d0a 2020 2020 2222  999000))].    ""
+000190a0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+000190b0: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
+000190c0: 7469 6d65 2229 0a20 2020 2072 6574 7572  time").    retur
+000190d0: 6e20 6275 696c 7469 6e28 2274 6f5f 7469  n builtin("to_ti
+000190e0: 6d65 2229 2863 2c20 666d 7429 2069 6620  me")(c, fmt) if 
+000190f0: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
+00019100: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
+00019110: 5f74 696d 6522 2928 6329 0a0a 0a64 6566  _time")(c)...def
+00019120: 2074 6f5f 7469 6d65 7374 616d 7028 653a   to_timestamp(e:
+00019130: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
+00019140: 6d74 3a20 4f70 7469 6f6e 616c 5b22 436f  mt: Optional["Co
+00019150: 6c75 6d6e 225d 203d 204e 6f6e 6529 202d  lumn"] = None) -
+00019160: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00019170: 2243 6f6e 7665 7274 7320 616e 2069 6e70  "Converts an inp
+00019180: 7574 2065 7870 7265 7373 696f 6e20 696e  ut expression in
+00019190: 746f 2074 6865 2063 6f72 7265 7370 6f6e  to the correspon
+000191a0: 6469 6e67 2074 696d 6573 7461 6d70 2e0a  ding timestamp..
+000191b0: 0a20 2020 2050 6572 2064 6566 6175 6c74  .    Per default
+000191c0: 2066 6d74 2069 7320 7365 7420 746f 2061   fmt is set to a
+000191d0: 7574 6f2c 2077 6869 6368 206d 616b 6573  uto, which makes
+000191e0: 2053 6e6f 7766 6c61 6b65 2064 6574 6563   Snowflake detec
+000191f0: 7420 7468 6520 666f 726d 6174 2061 7574  t the format aut
+00019200: 6f6d 6174 6963 616c 6c79 2e20 5769 7468  omatically. With
+00019210: 2060 746f 5f74 696d 6573 7461 6d70 6020   `to_timestamp` 
+00019220: 7374 7269 6e67 730a 2020 2020 6361 6e20  strings.    can 
+00019230: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+00019240: 7469 6d65 7374 616d 7073 2e20 5468 6520  timestamps. The 
+00019250: 666f 726d 6174 2068 6173 2074 6f20 6265  format has to be
+00019260: 2073 7065 6369 6669 6564 2061 6363 6f72   specified accor
+00019270: 6469 6e67 2074 6f20 7468 6520 7275 6c65  ding to the rule
+00019280: 7320 7365 7420 666f 7274 6820 696e 0a20  s set forth in. 
+00019290: 2020 203c 6874 7470 733a 2f2f 646f 6373     <https://docs
+000192a0: 2e73 6e6f 7766 6c61 6b65 2e63 6f6d 2f65  .snowflake.com/e
+000192b0: 6e2f 7371 6c2d 7265 6665 7265 6e63 652f  n/sql-reference/
+000192c0: 6675 6e63 7469 6f6e 732d 636f 6e76 6572  functions-conver
+000192d0: 7369 6f6e 2364 6174 652d 616e 642d 7469  sion#date-and-ti
+000192e0: 6d65 2d66 6f72 6d61 7473 2d69 6e2d 636f  me-formats-in-co
+000192f0: 6e76 6572 7369 6f6e 2d66 756e 6374 696f  nversion-functio
+00019300: 6e73 3e0a 0a20 2020 2045 7861 6d70 6c65  ns>..    Example
+00019310: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+00019320: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00019330: 7465 5f64 6174 6166 7261 6d65 285b 2732  te_dataframe(['2
+00019340: 3031 392d 3031 2d33 3120 3031 3a30 323a  019-01-31 01:02:
+00019350: 3033 2e30 3034 275d 2c20 7363 6865 6d61  03.004'], schema
+00019360: 3d5b 2761 275d 290a 2020 2020 2020 2020  =['a']).        
+00019370: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
+00019380: 5f74 696d 6573 7461 6d70 2863 6f6c 2822  _timestamp(col("
+00019390: 6122 2929 2e61 735f 2822 616e 7322 2929  a")).as_("ans"))
+000193a0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000193b0: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
+000193c0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+000193d0: 3139 2c20 312c 2033 312c 2031 2c20 322c  19, 1, 31, 1, 2,
+000193e0: 2033 2c20 3430 3030 2929 5d0a 2020 2020   3, 4000))].    
+000193f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00019400: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00019410: 6672 616d 6528 5b22 3230 3230 2d30 352d  frame(["2020-05-
+00019420: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
+00019430: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+00019440: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00019450: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00019460: 616d 7028 636f 6c28 2261 2229 2c20 6c69  amp(col("a"), li
+00019470: 7428 2259 5959 592d 4d4d 2d44 4420 4848  t("YYYY-MM-DD HH
+00019480: 3234 3a4d 493a 5353 2e46 4633 2229 292e  24:MI:SS.FF3")).
+00019490: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
+000194a0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+000194b0: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
+000194c0: 6461 7465 7469 6d65 2832 3032 302c 2035  datetime(2020, 5
+000194d0: 2c20 312c 2031 332c 2031 312c 2032 3029  , 1, 13, 11, 20)
+000194e0: 295d 0a0a 2020 2020 416e 6f74 6865 7220  )]..    Another 
+000194f0: 6f70 7469 6f6e 2069 7320 746f 2063 6f6e  option is to con
+00019500: 7665 7274 2064 6174 6573 2069 6e74 6f20  vert dates into 
+00019510: 7469 6d65 7374 616d 7073 0a0a 2020 2020  timestamps..    
+00019520: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+00019530: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+00019540: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
+00019550: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00019560: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
+00019570: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00019580: 6528 3230 3232 2c20 3132 2c20 3235 2c20  e(2022, 12, 25, 
+00019590: 3133 2c20 3539 2c20 3338 2c20 3436 3729  13, 59, 38, 467)
+000195a0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+000195b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000195c0: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+000195d0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
+000195e0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000195f0: 205b 526f 7728 544f 5f54 494d 4553 5441   [Row(TO_TIMESTA
+00019600: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
+00019610: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
+00019620: 3132 2c20 3235 2c20 3133 2c20 3539 2c20  12, 25, 13, 59, 
+00019630: 3338 2c20 3436 3729 295d 0a20 2020 2020  38, 467))].     
+00019640: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00019650: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
+00019660: 616d 6528 5b64 6174 6574 696d 652e 6461  ame([datetime.da
+00019670: 7465 2832 3032 332c 2033 2c20 3129 5d2c  te(2023, 3, 1)],
+00019680: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00019690: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+000196a0: 6c65 6374 2874 6f5f 7469 6d65 7374 616d  lect(to_timestam
+000196b0: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
+000196c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000196d0: 526f 7728 544f 5f54 494d 4553 5441 4d50  Row(TO_TIMESTAMP
+000196e0: 2822 4122 293d 6461 7465 7469 6d65 2e64  ("A")=datetime.d
+000196f0: 6174 6574 696d 6528 3230 3233 2c20 332c  atetime(2023, 3,
+00019700: 2031 2c20 302c 2030 2929 5d0a 0a20 2020   1, 0, 0))]..   
+00019710: 2049 6e74 6567 6572 7320 6361 6e20 6265   Integers can be
+00019720: 2063 6f6e 7665 7274 6564 2069 6e74 6f20   converted into 
+00019730: 6120 7469 6d65 7374 616d 7020 6173 2077  a timestamp as w
+00019740: 656c 6c2c 2062 7920 7072 6f76 6964 696e  ell, by providin
+00019750: 6720 6f70 7469 6f6e 616c 6c79 2061 2073  g optionally a s
+00019760: 6361 6c65 2061 7320 616e 2069 6e74 6567  cale as an integ
+00019770: 6572 2061 7320 6c69 6e65 6420 6f75 7420  er as lined out 
+00019780: 696e 0a20 2020 203c 6874 7470 733a 2f2f  in.    <https://
+00019790: 646f 6373 2e73 6e6f 7766 6c61 6b65 2e63  docs.snowflake.c
+000197a0: 6f6d 2f65 6e2f 7371 6c2d 7265 6665 7265  om/en/sql-refere
+000197b0: 6e63 652f 6675 6e63 7469 6f6e 732f 746f  nce/functions/to
+000197c0: 5f74 696d 6573 7461 6d70 2375 7361 6765  _timestamp#usage
+000197d0: 2d6e 6f74 6573 3e2e 2043 7572 7265 6e74  -notes>. Current
+000197e0: 6c79 2053 6e6f 7770 6172 6b20 646f 6573  ly Snowpark does
+000197f0: 2073 7570 706f 7274 0a20 2020 2069 6e74   support.    int
+00019800: 6567 6572 7320 696e 2074 6865 2072 616e  egers in the ran
+00019810: 6765 206f 6620 616e 2038 2d62 7974 6520  ge of an 8-byte 
+00019820: 7369 676e 6564 2069 6e74 6567 6572 206f  signed integer o
+00019830: 6e6c 792e 0a0a 2020 2020 4578 616d 706c  nly...    Exampl
+00019840: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00019850: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00019860: 6174 6544 6174 6146 7261 6d65 285b 3230  ateDataFrame([20
+00019870: 2c20 3331 3533 3630 3030 3030 305d 2c20  , 31536000000], 
+00019880: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
+00019890: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000198a0: 6563 7428 746f 5f74 696d 6573 7461 6d70  ect(to_timestamp
+000198b0: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
+000198c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+000198d0: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
+000198e0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+000198f0: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
+00019900: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
+00019910: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
+00019920: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+00019930: 7465 7469 6d65 2832 3936 392c 2035 2c20  tetime(2969, 5, 
+00019940: 332c 2030 2c20 3029 295d 0a20 2020 2020  3, 0, 0))].     
+00019950: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00019960: 2874 6f5f 7469 6d65 7374 616d 7028 636f  (to_timestamp(co
+00019970: 6c28 2261 2229 2c20 6c69 7428 3929 2929  l("a"), lit(9)))
+00019980: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00019990: 2020 205b 526f 7728 544f 5f54 494d 4553     [Row(TO_TIMES
+000199a0: 5441 4d50 2822 4122 2c20 3929 3d64 6174  TAMP("A", 9)=dat
+000199b0: 6574 696d 652e 6461 7465 7469 6d65 2831  etime.datetime(1
+000199c0: 3937 302c 2031 2c20 312c 2030 2c20 3029  970, 1, 1, 0, 0)
+000199d0: 292c 2052 6f77 2854 4f5f 5449 4d45 5354  ), Row(TO_TIMEST
+000199e0: 414d 5028 2241 222c 2039 293d 6461 7465  AMP("A", 9)=date
+000199f0: 7469 6d65 2e64 6174 6574 696d 6528 3139  time.datetime(19
+00019a00: 3730 2c20 312c 2031 2c20 302c 2030 2c20  70, 1, 1, 0, 0, 
+00019a10: 3331 2c20 3533 3630 3030 2929 5d0a 0a20  31, 536000))].. 
+00019a20: 2020 204c 6172 6765 7220 6e75 6d62 6572     Larger number
+00019a30: 7320 7374 6f72 6564 2069 6e20 6120 7374  s stored in a st
+00019a40: 7269 6e67 2063 616e 2062 6520 616c 736f  ring can be also
+00019a50: 2063 6f6e 7665 7274 6564 2076 6961 2074   converted via t
+00019a60: 6869 7320 6170 7072 6f61 6368 0a0a 2020  his approach..  
+00019a70: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00019a80: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00019a90: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+00019aa0: 7261 6d65 285b 2732 3027 2c20 2733 3135  rame(['20', '315
+00019ab0: 3336 3030 3030 3030 272c 2027 3331 3533  36000000', '3153
+00019ac0: 3630 3030 3030 3030 3030 272c 2027 3331  6000000000', '31
+00019ad0: 3533 3630 3030 3030 3030 3030 3030 3027  536000000000000'
+00019ae0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+00019af0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00019b00: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00019b10: 616d 7028 636f 6c28 2261 2229 292e 6173  amp(col("a")).as
+00019b20: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
+00019b30: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00019b40: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
+00019b50: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
+00019b60: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
+00019b70: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
+00019b80: 6461 7465 7469 6d65 2831 3937 312c 2031  datetime(1971, 1
+00019b90: 2c20 312c 2030 2c20 3029 292c 2052 6f77  , 1, 0, 0)), Row
+00019ba0: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
+00019bb0: 7465 7469 6d65 2831 3937 312c 2031 2c20  tetime(1971, 1, 
+00019bc0: 312c 2030 2c20 3029 292c 2052 6f77 2841  1, 0, 0)), Row(A
+00019bd0: 4e53 3d64 6174 6574 696d 652e 6461 7465  NS=datetime.date
+00019be0: 7469 6d65 2831 3937 312c 2031 2c20 312c  time(1971, 1, 1,
+00019bf0: 2030 2c20 3029 295d 0a20 2020 2022 2222   0, 0))].    """
+00019c00: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00019c10: 5f69 665f 7374 7228 652c 2022 746f 5f74  _if_str(e, "to_t
+00019c20: 696d 6573 7461 6d70 2229 0a20 2020 2072  imestamp").    r
+00019c30: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+00019c40: 6275 696c 7469 6e28 2274 6f5f 7469 6d65  builtin("to_time
+00019c50: 7374 616d 7022 2928 632c 2066 6d74 290a  stamp")(c, fmt).
+00019c60: 2020 2020 2020 2020 6966 2066 6d74 2069          if fmt i
+00019c70: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+00019c80: 2020 2065 6c73 6520 6275 696c 7469 6e28     else builtin(
+00019c90: 2274 6f5f 7469 6d65 7374 616d 7022 2928  "to_timestamp")(
+00019ca0: 6329 0a20 2020 2029 0a0a 0a64 6566 2074  c).    )...def t
+00019cb0: 6f5f 6461 7465 2865 3a20 436f 6c75 6d6e  o_date(e: Column
+00019cc0: 4f72 4e61 6d65 2c20 666d 743a 204f 7074  OrName, fmt: Opt
+00019cd0: 696f 6e61 6c5b 2243 6f6c 756d 6e22 5d20  ional["Column"] 
+00019ce0: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
+00019cf0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
+00019d00: 7473 2061 6e20 696e 7075 7420 6578 7072  ts an input expr
+00019d10: 6573 7369 6f6e 2069 6e74 6f20 6120 6461  ession into a da
+00019d20: 7465 2e0a 0a20 2020 2045 7861 6d70 6c65  te...    Example
+00019d30: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00019d40: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00019d50: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
+00019d60: 3230 3133 2d30 352d 3137 272c 2027 3230  2013-05-17', '20
+00019d70: 3133 2d30 352d 3137 275d 2c20 7363 6865  13-05-17'], sche
+00019d80: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00019d90: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00019da0: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
+00019db0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
+00019dc0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00019dd0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
+00019de0: 652e 6461 7465 2832 3031 332c 2035 2c20  e.date(2013, 5, 
+00019df0: 3137 2929 2c20 526f 7728 414e 533d 6461  17)), Row(ANS=da
+00019e00: 7465 7469 6d65 2e64 6174 6528 3230 3133  tetime.date(2013
+00019e10: 2c20 352c 2031 3729 295d 0a0a 2020 2020  , 5, 17))]..    
+00019e20: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00019e30: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00019e40: 6672 616d 6528 5b27 3331 3533 3630 3030  frame(['31536000
+00019e50: 3030 3030 3030 272c 2027 3731 3533 3630  000000', '715360
+00019e60: 3034 3030 3030 3030 275d 2c20 7363 6865  04000000'], sche
+00019e70: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00019e80: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00019e90: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
+00019ea0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
+00019eb0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00019ec0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
+00019ed0: 652e 6461 7465 2831 3937 312c 2031 2c20  e.date(1971, 1, 
+00019ee0: 3129 292c 2052 6f77 2841 4e53 3d64 6174  1)), Row(ANS=dat
+00019ef0: 6574 696d 652e 6461 7465 2831 3937 322c  etime.date(1972,
+00019f00: 2034 2c20 3729 295d 0a0a 2020 2020 2222   4, 7))]..    ""
+00019f10: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00019f20: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
+00019f30: 6461 7465 2229 0a20 2020 2072 6574 7572  date").    retur
+00019f40: 6e20 6275 696c 7469 6e28 2274 6f5f 6461  n builtin("to_da
+00019f50: 7465 2229 2863 2c20 666d 7429 2069 6620  te")(c, fmt) if 
+00019f60: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
+00019f70: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
+00019f80: 5f64 6174 6522 2928 6329 0a0a 0a64 6566  _date")(c)...def
+00019f90: 2063 7572 7265 6e74 5f74 696d 6573 7461   current_timesta
+00019fa0: 6d70 2829 202d 3e20 436f 6c75 6d6e 3a0a  mp() -> Column:.
+00019fb0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00019fc0: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
+00019fd0: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
+00019fe0: 7465 6d2e 0a0a 2020 2020 4578 616d 706c  tem...    Exampl
+00019ff0: 653a 0a20 2020 2020 2020 203e 3e3e 2069  e:.        >>> i
+0001a000: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+0001a010: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+0001a020: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
+0001a030: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
+0001a040: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
+0001a050: 5f74 696d 6573 7461 6d70 2829 292e 636f  _timestamp()).co
+0001a060: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001a070: 3e3e 3e20 6173 7365 7274 2069 7369 6e73  >>> assert isins
+0001a080: 7461 6e63 6528 7265 7375 6c74 5b30 5d5b  tance(result[0][
+0001a090: 2243 5552 5245 4e54 5f54 494d 4553 5441  "CURRENT_TIMESTA
+0001a0a0: 4d50 2829 225d 2c20 6461 7465 7469 6d65  MP()"], datetime
+0001a0b0: 2e64 6174 6574 696d 6529 0a20 2020 2022  .datetime).    "
+0001a0c0: 2222 0a0a 2020 2020 7265 7475 726e 2062  ""..    return b
+0001a0d0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
+0001a0e0: 7469 6d65 7374 616d 7022 2928 290a 0a0a  timestamp")()...
+0001a0f0: 6465 6620 6375 7272 656e 745f 6461 7465  def current_date
+0001a100: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+0001a110: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+0001a120: 2063 7572 7265 6e74 2064 6174 6520 666f   current date fo
+0001a130: 7220 7468 6520 7379 7374 656d 2e0a 0a20  r the system... 
+0001a140: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+0001a150: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+0001a160: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+0001a170: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
+0001a180: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001a190: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
+0001a1a0: 7428 6375 7272 656e 745f 6461 7465 2829  t(current_date()
+0001a1b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0001a1c0: 2020 2020 3e3e 3e20 6173 7365 7274 2069      >>> assert i
+0001a1d0: 7369 6e73 7461 6e63 6528 7265 7375 6c74  sinstance(result
+0001a1e0: 5b30 5d5b 2243 5552 5245 4e54 5f44 4154  [0]["CURRENT_DAT
+0001a1f0: 4528 2922 5d2c 2064 6174 6574 696d 652e  E()"], datetime.
+0001a200: 6461 7465 290a 2020 2020 2222 220a 2020  date).    """.  
+0001a210: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001a220: 2822 6375 7272 656e 745f 6461 7465 2229  ("current_date")
+0001a230: 2829 0a0a 0a64 6566 2063 7572 7265 6e74  ()...def current
+0001a240: 5f74 696d 6528 2920 2d3e 2043 6f6c 756d  _time() -> Colum
+0001a250: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+0001a260: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
+0001a270: 6d65 2066 6f72 2074 6865 2073 7973 7465  me for the syste
+0001a280: 6d2e 0a0a 2020 2020 4578 616d 706c 653a  m...    Example:
+0001a290: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001a2a0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+0001a2b0: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
+0001a2c0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001a2d0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
+0001a2e0: 7365 6c65 6374 2863 7572 7265 6e74 5f74  select(current_t
+0001a2f0: 696d 6528 2929 2e63 6f6c 6c65 6374 2829  ime()).collect()
+0001a300: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
+0001a310: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+0001a320: 6573 756c 745b 305d 5b22 4355 5252 454e  esult[0]["CURREN
+0001a330: 545f 5449 4d45 2829 225d 2c20 6461 7465  T_TIME()"], date
+0001a340: 7469 6d65 2e74 696d 6529 0a20 2020 2022  time.time).    "
+0001a350: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+0001a360: 696c 7469 6e28 2263 7572 7265 6e74 5f74  iltin("current_t
+0001a370: 696d 6522 2928 290a 0a0a 6465 6620 686f  ime")()...def ho
+0001a380: 7572 2865 3a20 436f 6c75 6d6e 4f72 4e61  ur(e: ColumnOrNa
+0001a390: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0001a3a0: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
+0001a3b0: 6374 7320 7468 6520 686f 7572 2066 726f  cts the hour fro
+0001a3c0: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
+0001a3d0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+0001a3e0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+0001a3f0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+0001a400: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+0001a410: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0001a420: 7465 5f64 6174 6166 7261 6d65 285b 0a20  te_dataframe([. 
+0001a430: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001a440: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001a450: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001a460: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
+0001a470: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001a480: 483a 254d 3a25 532e 2566 2229 2c0a 2020  H:%M:%S.%f"),.  
+0001a490: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
+0001a4a0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+0001a4b0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+0001a4c0: 382d 3231 2030 313a 3330 3a30 352e 3030  8-21 01:30:05.00
+0001a4d0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+0001a4e0: 3a25 4d3a 2553 2e25 6622 290a 2020 2020  :%M:%S.%f").    
+0001a4f0: 2020 2020 2e2e 2e20 5d2c 2073 6368 656d      ... ], schem
+0001a500: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+0001a510: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
+0001a520: 6f75 7228 2261 2229 292e 636f 6c6c 6563  our("a")).collec
+0001a530: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001a540: 2848 4f55 5228 2241 2229 3d31 3329 2c20  (HOUR("A")=13), 
+0001a550: 526f 7728 484f 5552 2822 4122 293d 3129  Row(HOUR("A")=1)
+0001a560: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+0001a570: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001a580: 2865 2c20 2268 6f75 7222 290a 2020 2020  (e, "hour").    
+0001a590: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001a5a0: 686f 7572 2229 2863 290a 0a0a 6465 6620  hour")(c)...def 
+0001a5b0: 6c61 7374 5f64 6179 2865 3a20 436f 6c75  last_day(e: Colu
+0001a5c0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0001a5d0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0001a5e0: 2052 6574 7572 6e73 2074 6865 206c 6173   Returns the las
+0001a5f0: 7420 6461 7920 6f66 2074 6865 2073 7065  t day of the spe
+0001a600: 6369 6669 6564 2064 6174 6520 7061 7274  cified date part
+0001a610: 2066 6f72 2061 2064 6174 6520 6f72 2074   for a date or t
+0001a620: 696d 6573 7461 6d70 2e0a 2020 2020 436f  imestamp..    Co
+0001a630: 6d6d 6f6e 6c79 2075 7365 6420 746f 2072  mmonly used to r
+0001a640: 6574 7572 6e20 7468 6520 6c61 7374 2064  eturn the last d
+0001a650: 6179 206f 6620 7468 6520 6d6f 6e74 6820  ay of the month 
+0001a660: 666f 7220 6120 6461 7465 206f 7220 7469  for a date or ti
+0001a670: 6d65 7374 616d 702e 0a0a 2020 2020 4578  mestamp...    Ex
+0001a680: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0001a690: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+0001a6a0: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+0001a6b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0001a6c0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0001a6d0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001a6e0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+0001a6f0: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
+0001a700: 302d 3035 2d30 3120 3133 3a31 313a 3230  0-05-01 13:11:20
+0001a710: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
+0001a720: 2025 483a 254d 3a25 532e 2566 2229 2c0a   %H:%M:%S.%f"),.
+0001a730: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001a740: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001a750: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001a760: 2d30 382d 3231 2030 313a 3330 3a30 352e  -08-21 01:30:05.
+0001a770: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001a780: 2548 3a25 4d3a 2553 2e25 6622 290a 2020  %H:%M:%S.%f").  
+0001a790: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
+0001a7a0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0001a7b0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0001a7c0: 286c 6173 745f 6461 7928 2261 2229 292e  (last_day("a")).
+0001a7d0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0001a7e0: 2020 5b52 6f77 284c 4153 545f 4441 5928    [Row(LAST_DAY(
+0001a7f0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+0001a800: 7465 2832 3032 302c 2035 2c20 3331 2929  te(2020, 5, 31))
+0001a810: 2c20 526f 7728 4c41 5354 5f44 4159 2822  , Row(LAST_DAY("
+0001a820: 4122 293d 6461 7465 7469 6d65 2e64 6174  A")=datetime.dat
+0001a830: 6528 3230 3230 2c20 382c 2033 3129 295d  e(2020, 8, 31))]
+0001a840: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0001a850: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001a860: 652c 2022 6c61 7374 5f64 6179 2229 0a20  e, "last_day"). 
+0001a870: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0001a880: 6e28 226c 6173 745f 6461 7922 2928 6329  n("last_day")(c)
+0001a890: 0a0a 0a64 6566 206d 696e 7574 6528 653a  ...def minute(e:
+0001a8a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0001a8b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0001a8c0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+0001a8d0: 6865 206d 696e 7574 6520 6672 6f6d 2061  he minute from a
+0001a8e0: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
+0001a8f0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
+0001a900: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001a910: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001a920: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001a930: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0001a940: 6461 7461 6672 616d 6528 5b0a 2020 2020  dataframe([.    
+0001a950: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
+0001a960: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
+0001a970: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
+0001a980: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
+0001a990: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
+0001a9a0: 4d3a 2553 2e25 6622 292c 0a20 2020 2020  M:%S.%f"),.     
+0001a9b0: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
+0001a9c0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+0001a9d0: 7074 696d 6528 2232 3032 302d 3038 2d32  ptime("2020-08-2
+0001a9e0: 3120 3031 3a33 303a 3035 2e30 3030 222c  1 01:30:05.000",
+0001a9f0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+0001aa00: 3a25 532e 2566 2229 0a20 2020 2020 2020  :%S.%f").       
+0001aa10: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
+0001aa20: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+0001aa30: 3e20 6466 2e73 656c 6563 7428 6d69 6e75  > df.select(minu
+0001aa40: 7465 2822 6122 2929 2e63 6f6c 6c65 6374  te("a")).collect
+0001aa50: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0001aa60: 4d49 4e55 5445 2822 4122 293d 3131 292c  MINUTE("A")=11),
+0001aa70: 2052 6f77 284d 494e 5554 4528 2241 2229   Row(MINUTE("A")
+0001aa80: 3d33 3029 5d0a 2020 2020 2222 220a 2020  =30)].    """.  
+0001aa90: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0001aaa0: 5f73 7472 2865 2c20 226d 696e 7574 6522  _str(e, "minute"
+0001aab0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0001aac0: 6c74 696e 2822 6d69 6e75 7465 2229 2863  ltin("minute")(c
+0001aad0: 290a 0a0a 6465 6620 6e65 7874 5f64 6179  )...def next_day
+0001aae0: 2864 6174 653a 2043 6f6c 756d 6e4f 724e  (date: ColumnOrN
+0001aaf0: 616d 652c 2064 6179 5f6f 665f 7765 656b  ame, day_of_week
+0001ab00: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
+0001ab10: 6c29 202d 3e20 436f 6c75 6d6e 3a0a 2020  l) -> Column:.  
+0001ab20: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+0001ab30: 7320 7468 6520 6461 7465 206f 6620 7468  s the date of th
+0001ab40: 6520 6669 7273 7420 7370 6563 6966 6965  e first specifie
+0001ab50: 6420 444f 5720 2864 6179 206f 6620 7765  d DOW (day of we
+0001ab60: 656b 2920 7468 6174 206f 6363 7572 7320  ek) that occurs 
+0001ab70: 6166 7465 7220 7468 6520 696e 7075 7420  after the input 
+0001ab80: 6461 7465 2e0a 0a20 2020 2045 7861 6d70  date...    Examp
+0001ab90: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0001aba0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+0001abb0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0001abc0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001abd0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
+0001abe0: 2020 2020 2020 2e2e 2e20 2020 2020 2864        ...     (d
+0001abf0: 6174 6574 696d 652e 6461 7465 2e66 726f  atetime.date.fro
+0001ac00: 6d69 736f 666f 726d 6174 2822 3230 3230  misoformat("2020
+0001ac10: 2d30 382d 3031 2229 2c20 226d 6f22 292c  -08-01"), "mo"),
+0001ac20: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001ac30: 2028 6461 7465 7469 6d65 2e64 6174 652e   (datetime.date.
+0001ac40: 6672 6f6d 6973 6f66 6f72 6d61 7428 2232  fromisoformat("2
+0001ac50: 3032 302d 3132 2d30 3122 292c 2022 7765  020-12-01"), "we
+0001ac60: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
+0001ac70: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+0001ac80: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+0001ac90: 3e20 6466 2e73 656c 6563 7428 6e65 7874  > df.select(next
+0001aca0: 5f64 6179 2822 6122 2c20 636f 6c28 2262  _day("a", col("b
+0001acb0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+0001acc0: 2020 2020 2020 205b 526f 7728 4e45 5854         [Row(NEXT
+0001acd0: 5f44 4159 2822 4122 2c20 2242 2229 3d64  _DAY("A", "B")=d
+0001ace0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+0001acf0: 302c 2038 2c20 3329 292c 2052 6f77 284e  0, 8, 3)), Row(N
+0001ad00: 4558 545f 4441 5928 2241 222c 2022 4222  EXT_DAY("A", "B"
+0001ad10: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
+0001ad20: 3230 3230 2c20 3132 2c20 3229 295d 0a20  2020, 12, 2))]. 
+0001ad30: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001ad40: 6c65 6374 286e 6578 745f 6461 7928 2261  lect(next_day("a
+0001ad50: 222c 2022 6672 2229 292e 636f 6c6c 6563  ", "fr")).collec
+0001ad60: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001ad70: 284e 4558 545f 4441 5928 2241 222c 2027  (NEXT_DAY("A", '
+0001ad80: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
+0001ad90: 7465 2832 3032 302c 2038 2c20 3729 292c  te(2020, 8, 7)),
+0001ada0: 2052 6f77 284e 4558 545f 4441 5928 2241   Row(NEXT_DAY("A
+0001adb0: 222c 2027 4652 2729 3d64 6174 6574 696d  ", 'FR')=datetim
+0001adc0: 652e 6461 7465 2832 3032 302c 2031 322c  e.date(2020, 12,
+0001add0: 2034 2929 5d0a 2020 2020 2222 220a 2020   4))].    """.  
+0001ade0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0001adf0: 5f73 7472 2864 6174 652c 2022 6e65 7874  _str(date, "next
+0001ae00: 5f64 6179 2229 0a20 2020 2072 6574 7572  _day").    retur
+0001ae10: 6e20 6275 696c 7469 6e28 226e 6578 745f  n builtin("next_
+0001ae20: 6461 7922 2928 632c 2043 6f6c 756d 6e2e  day")(c, Column.
+0001ae30: 5f74 6f5f 6578 7072 2864 6179 5f6f 665f  _to_expr(day_of_
+0001ae40: 7765 656b 2929 0a0a 0a64 6566 2070 7265  week))...def pre
+0001ae50: 7669 6f75 735f 6461 7928 6461 7465 3a20  vious_day(date: 
+0001ae60: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6461  ColumnOrName, da
+0001ae70: 795f 6f66 5f77 6565 6b3a 2043 6f6c 756d  y_of_week: Colum
+0001ae80: 6e4f 724c 6974 6572 616c 2920 2d3e 2043  nOrLiteral) -> C
+0001ae90: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+0001aea0: 2020 2052 6574 7572 6e73 2074 6865 2064     Returns the d
+0001aeb0: 6174 6520 6f66 2074 6865 2066 6972 7374  ate of the first
+0001aec0: 2073 7065 6369 6669 6564 2044 4f57 2028   specified DOW (
+0001aed0: 6461 7920 6f66 2077 6565 6b29 2074 6861  day of week) tha
+0001aee0: 7420 6f63 6375 7273 2062 6566 6f72 6520  t occurs before 
+0001aef0: 7468 6520 696e 7075 7420 6461 7465 2e0a  the input date..
+0001af00: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0001af10: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0001af20: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+0001af30: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001af40: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001af50: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
+0001af60: 2e2e 2e20 2020 2020 2864 6174 6574 696d  ...     (datetim
+0001af70: 652e 6461 7465 2e66 726f 6d69 736f 666f  e.date.fromisofo
+0001af80: 726d 6174 2822 3230 3230 2d30 382d 3031  rmat("2020-08-01
+0001af90: 2229 2c20 226d 6f22 292c 0a20 2020 2020  "), "mo"),.     
+0001afa0: 2020 202e 2e2e 2020 2020 2028 6461 7465     ...     (date
+0001afb0: 7469 6d65 2e64 6174 652e 6672 6f6d 6973  time.date.fromis
+0001afc0: 6f66 6f72 6d61 7428 2232 3032 302d 3132  oformat("2020-12
+0001afd0: 2d30 3122 292c 2022 7765 2229 2c0a 2020  -01"), "we"),.  
+0001afe0: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
+0001aff0: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+0001b000: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0001b010: 656c 6563 7428 7072 6576 696f 7573 5f64  elect(previous_d
+0001b020: 6179 2822 6122 2c20 636f 6c28 2262 2229  ay("a", col("b")
+0001b030: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0001b040: 2020 2020 205b 526f 7728 5052 4556 494f       [Row(PREVIO
+0001b050: 5553 5f44 4159 2822 4122 2c20 2242 2229  US_DAY("A", "B")
+0001b060: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
+0001b070: 3032 302c 2037 2c20 3237 2929 2c20 526f  020, 7, 27)), Ro
+0001b080: 7728 5052 4556 494f 5553 5f44 4159 2822  w(PREVIOUS_DAY("
+0001b090: 4122 2c20 2242 2229 3d64 6174 6574 696d  A", "B")=datetim
+0001b0a0: 652e 6461 7465 2832 3032 302c 2031 312c  e.date(2020, 11,
+0001b0b0: 2032 3529 295d 0a20 2020 2020 2020 203e   25))].        >
+0001b0c0: 3e3e 2064 662e 7365 6c65 6374 2870 7265  >> df.select(pre
+0001b0d0: 7669 6f75 735f 6461 7928 2261 222c 2022  vious_day("a", "
+0001b0e0: 6672 2229 292e 636f 6c6c 6563 7428 290a  fr")).collect().
+0001b0f0: 2020 2020 2020 2020 5b52 6f77 2850 5245          [Row(PRE
+0001b100: 5649 4f55 535f 4441 5928 2241 222c 2027  VIOUS_DAY("A", '
+0001b110: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
+0001b120: 7465 2832 3032 302c 2037 2c20 3331 2929  te(2020, 7, 31))
+0001b130: 2c20 526f 7728 5052 4556 494f 5553 5f44  , Row(PREVIOUS_D
+0001b140: 4159 2822 4122 2c20 2746 5227 293d 6461  AY("A", 'FR')=da
+0001b150: 7465 7469 6d65 2e64 6174 6528 3230 3230  tetime.date(2020
+0001b160: 2c20 3131 2c20 3237 2929 5d0a 2020 2020  , 11, 27))].    
+0001b170: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0001b180: 636f 6c5f 6966 5f73 7472 2864 6174 652c  col_if_str(date,
+0001b190: 2022 7072 6576 696f 7573 5f64 6179 2229   "previous_day")
+0001b1a0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0001b1b0: 7469 6e28 2270 7265 7669 6f75 735f 6461  tin("previous_da
+0001b1c0: 7922 2928 632c 2043 6f6c 756d 6e2e 5f74  y")(c, Column._t
+0001b1d0: 6f5f 6578 7072 2864 6179 5f6f 665f 7765  o_expr(day_of_we
+0001b1e0: 656b 2929 0a0a 0a64 6566 2073 6563 6f6e  ek))...def secon
+0001b1f0: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
+0001b200: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0001b210: 2020 2222 220a 2020 2020 4578 7472 6163    """.    Extrac
+0001b220: 7473 2074 6865 2073 6563 6f6e 6420 6672  ts the second fr
+0001b230: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001b240: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001b250: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001b260: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001b270: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001b280: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001b290: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001b2a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001b2b0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001b2c0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001b2d0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001b2e0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001b2f0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001b300: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001b310: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001b320: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001b330: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001b340: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001b350: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001b360: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001b370: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001b380: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001b390: 7365 636f 6e64 2822 6122 2929 2e63 6f6c  second("a")).col
+0001b3a0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0001b3b0: 526f 7728 5345 434f 4e44 2822 4122 293d  Row(SECOND("A")=
+0001b3c0: 3230 292c 2052 6f77 2853 4543 4f4e 4428  20), Row(SECOND(
+0001b3d0: 2241 2229 3d35 295d 0a20 2020 2022 2222  "A")=5)].    """
+0001b3e0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0001b3f0: 5f69 665f 7374 7228 652c 2022 7365 636f  _if_str(e, "seco
+0001b400: 6e64 2229 0a20 2020 2072 6574 7572 6e20  nd").    return 
+0001b410: 6275 696c 7469 6e28 2273 6563 6f6e 6422  builtin("second"
+0001b420: 2928 6329 0a0a 0a64 6566 206d 6f6e 7468  )(c)...def month
+0001b430: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0001b440: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001b450: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+0001b460: 7320 7468 6520 6d6f 6e74 6820 6672 6f6d  s the month from
+0001b470: 2061 2064 6174 6520 6f72 2074 696d 6573   a date or times
+0001b480: 7461 6d70 2e0a 0a20 2020 2045 7861 6d70  tamp...    Examp
+0001b490: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0001b4a0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+0001b4b0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0001b4c0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001b4d0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
+0001b4e0: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
+0001b4f0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+0001b500: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+0001b510: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
+0001b520: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+0001b530: 3a25 4d3a 2553 2e25 6622 292c 0a20 2020  :%M:%S.%f"),.   
+0001b540: 2020 2020 202e 2e2e 2020 2020 2064 6174       ...     dat
+0001b550: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
+0001b560: 7472 7074 696d 6528 2232 3032 302d 3038  trptime("2020-08
+0001b570: 2d32 3120 3031 3a33 303a 3035 2e30 3030  -21 01:30:05.000
+0001b580: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
+0001b590: 254d 3a25 532e 2566 2229 0a20 2020 2020  %M:%S.%f").     
+0001b5a0: 2020 202e 2e2e 205d 2c20 7363 6865 6d61     ... ], schema
+0001b5b0: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+0001b5c0: 3e3e 3e20 6466 2e73 656c 6563 7428 6d6f  >>> df.select(mo
+0001b5d0: 6e74 6828 2261 2229 292e 636f 6c6c 6563  nth("a")).collec
+0001b5e0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001b5f0: 284d 4f4e 5448 2822 4122 293d 3529 2c20  (MONTH("A")=5), 
+0001b600: 526f 7728 4d4f 4e54 4828 2241 2229 3d38  Row(MONTH("A")=8
+0001b610: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0001b620: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001b630: 7228 652c 2022 6d6f 6e74 6822 290a 2020  r(e, "month").  
+0001b640: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001b650: 2822 6d6f 6e74 6822 2928 6329 0a0a 0a64  ("month")(c)...d
+0001b660: 6566 206d 6f6e 7468 6e61 6d65 2865 3a20  ef monthname(e: 
+0001b670: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0001b680: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0001b690: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
+0001b6a0: 6520 7468 7265 652d 6c65 7474 6572 206d  e three-letter m
+0001b6b0: 6f6e 7468 206e 616d 6520 6672 6f6d 2074  onth name from t
+0001b6c0: 6865 2073 7065 6369 6669 6564 2064 6174  he specified dat
+0001b6d0: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
+0001b6e0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0001b6f0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0001b700: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+0001b710: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001b720: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001b730: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
+0001b740: 2e2e 2e20 2020 2020 6461 7465 7469 6d65  ...     datetime
+0001b750: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
+0001b760: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
+0001b770: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
+0001b780: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+0001b790: 2e25 6622 292c 0a20 2020 2020 2020 202e  .%f"),.        .
+0001b7a0: 2e2e 2020 2020 2064 6174 6574 696d 652e  ..     datetime.
+0001b7b0: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
+0001b7c0: 6528 2232 3032 302d 3038 2d32 3120 3031  e("2020-08-21 01
+0001b7d0: 3a33 303a 3035 2e30 3030 222c 2022 2559  :30:05.000", "%Y
+0001b7e0: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
+0001b7f0: 2566 2229 0a20 2020 2020 2020 202e 2e2e  %f").        ...
+0001b800: 205d 2c20 7363 6865 6d61 3d5b 2261 225d   ], schema=["a"]
+0001b810: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0001b820: 2e73 656c 6563 7428 6d6f 6e74 686e 616d  .select(monthnam
+0001b830: 6528 2261 2229 292e 636f 6c6c 6563 7428  e("a")).collect(
+0001b840: 290a 2020 2020 2020 2020 5b52 6f77 284d  ).        [Row(M
+0001b850: 4f4e 5448 4e41 4d45 2822 4122 293d 274d  ONTHNAME("A")='M
+0001b860: 6179 2729 2c20 526f 7728 4d4f 4e54 484e  ay'), Row(MONTHN
+0001b870: 414d 4528 2241 2229 3d27 4175 6727 295d  AME("A")='Aug')]
+0001b880: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0001b890: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001b8a0: 652c 2022 6d6f 6e74 686e 616d 6522 290a  e, "monthname").
+0001b8b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001b8c0: 696e 2822 6d6f 6e74 686e 616d 6522 2928  in("monthname")(
+0001b8d0: 6329 0a0a 0a64 6566 2071 7561 7274 6572  c)...def quarter
+0001b8e0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0001b8f0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001b900: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+0001b910: 7320 7468 6520 7175 6172 7465 7220 6672  s the quarter fr
+0001b920: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001b930: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001b940: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001b950: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001b960: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001b970: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001b980: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001b990: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001b9a0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001b9b0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001b9c0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001b9d0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001b9e0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001b9f0: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001ba00: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001ba10: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001ba20: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001ba30: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001ba40: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001ba50: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001ba60: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001ba70: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001ba80: 7175 6172 7465 7228 2261 2229 292e 636f  quarter("a")).co
+0001ba90: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001baa0: 5b52 6f77 2851 5541 5254 4552 2822 4122  [Row(QUARTER("A"
+0001bab0: 293d 3229 2c20 526f 7728 5155 4152 5445  )=2), Row(QUARTE
+0001bac0: 5228 2241 2229 3d33 295d 0a20 2020 2022  R("A")=3)].    "
+0001bad0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001bae0: 6f6c 5f69 665f 7374 7228 652c 2022 7175  ol_if_str(e, "qu
+0001baf0: 6172 7465 7222 290a 2020 2020 7265 7475  arter").    retu
+0001bb00: 726e 2062 7569 6c74 696e 2822 7175 6172  rn builtin("quar
+0001bb10: 7465 7222 2928 6329 0a0a 0a64 6566 2079  ter")(c)...def y
+0001bb20: 6561 7228 653a 2043 6f6c 756d 6e4f 724e  ear(e: ColumnOrN
+0001bb30: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001bb40: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
+0001bb50: 6163 7473 2074 6865 2079 6561 7220 6672  acts the year fr
+0001bb60: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001bb70: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001bb80: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001bb90: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001bba0: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001bbb0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001bbc0: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001bbd0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001bbe0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001bbf0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001bc00: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001bc10: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001bc20: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001bc30: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001bc40: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001bc50: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001bc60: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001bc70: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001bc80: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001bc90: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001bca0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001bcb0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001bcc0: 7965 6172 2822 6122 2929 2e63 6f6c 6c65  year("a")).colle
+0001bcd0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0001bce0: 7728 5945 4152 2822 4122 293d 3230 3230  w(YEAR("A")=2020
+0001bcf0: 292c 2052 6f77 2859 4541 5228 2241 2229  ), Row(YEAR("A")
+0001bd00: 3d32 3032 3029 5d0a 2020 2020 2222 220a  =2020)].    """.
+0001bd10: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0001bd20: 6966 5f73 7472 2865 2c20 2279 6561 7222  if_str(e, "year"
+0001bd30: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0001bd40: 6c74 696e 2822 7965 6172 2229 2863 290a  ltin("year")(c).
+0001bd50: 0a0a 6465 6620 7379 7364 6174 6528 2920  ..def sysdate() 
+0001bd60: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0001bd70: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+0001bd80: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
+0001bd90: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
+0001bda0: 7465 6d2c 2062 7574 2069 6e20 7468 6520  tem, but in the 
+0001bdb0: 5554 4320 7469 6d65 207a 6f6e 652e 0a0a  UTC time zone...
+0001bdc0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0001bdd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0001bde0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0001bdf0: 6174 6166 7261 6d65 285b 315d 2c20 7363  ataframe([1], sc
+0001be00: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0001be10: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0001be20: 7428 7379 7364 6174 6528 2929 2e63 6f6c  t(sysdate()).col
+0001be30: 6c65 6374 2829 2069 7320 6e6f 7420 4e6f  lect() is not No
+0001be40: 6e65 0a20 2020 2020 2020 2054 7275 650a  ne.        True.
+0001be50: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+0001be60: 726e 2062 7569 6c74 696e 2822 7379 7364  rn builtin("sysd
+0001be70: 6174 6522 2928 290a 0a0a 6465 6620 6d6f  ate")()...def mo
+0001be80: 6e74 6873 5f62 6574 7765 656e 2864 6174  nths_between(dat
+0001be90: 6531 3a20 436f 6c75 6d6e 4f72 4e61 6d65  e1: ColumnOrName
+0001bea0: 2c20 6461 7465 323a 2043 6f6c 756d 6e4f  , date2: ColumnO
+0001beb0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0001bec0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0001bed0: 7475 726e 7320 7468 6520 6e75 6d62 6572  turns the number
+0001bee0: 206f 6620 6d6f 6e74 6873 2062 6574 7765   of months betwe
+0001bef0: 656e 2074 776f 2044 4154 4520 6f72 2054  en two DATE or T
+0001bf00: 494d 4553 5441 4d50 2076 616c 7565 732e  IMESTAMP values.
+0001bf10: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0001bf20: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001bf30: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+0001bf40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0001bf50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0001bf60: 6166 7261 6d65 285b 5b0a 2020 2020 2020  aframe([[.      
+0001bf70: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
+0001bf80: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
+0001bf90: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
+0001bfa0: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
+0001bfb0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+0001bfc0: 2553 2e25 6622 292c 0a20 2020 2020 2020  %S.%f"),.       
+0001bfd0: 202e 2e2e 2020 2020 2064 6174 6574 696d   ...     datetim
+0001bfe0: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
+0001bff0: 696d 6528 2232 3032 302d 3038 2d32 3120  ime("2020-08-21 
+0001c000: 3031 3a33 303a 3035 2e30 3030 222c 2022  01:30:05.000", "
+0001c010: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+0001c020: 532e 2566 2229 0a20 2020 2020 2020 202e  S.%f").        .
+0001c030: 2e2e 205d 5d2c 2073 6368 656d 613d 5b22  .. ]], schema=["
+0001c040: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+0001c050: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001c060: 6d6f 6e74 6873 5f62 6574 7765 656e 2822  months_between("
+0001c070: 6122 2c20 2262 2229 292e 636f 6c6c 6563  a", "b")).collec
+0001c080: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001c090: 284d 4f4e 5448 535f 4245 5457 4545 4e28  (MONTHS_BETWEEN(
+0001c0a0: 2241 222c 2022 4222 293d 4465 6369 6d61  "A", "B")=Decima
+0001c0b0: 6c28 272d 332e 3632 3934 3532 2729 295d  l('-3.629452'))]
+0001c0c0: 0a20 2020 2022 2222 0a20 2020 2063 3120  .    """.    c1 
+0001c0d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001c0e0: 2864 6174 6531 2c20 226d 6f6e 7468 735f  (date1, "months_
+0001c0f0: 6265 7477 6565 6e22 290a 2020 2020 6332  between").    c2
+0001c100: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001c110: 7228 6461 7465 322c 2022 6d6f 6e74 6873  r(date2, "months
+0001c120: 5f62 6574 7765 656e 2229 0a20 2020 2072  _between").    r
+0001c130: 6574 7572 6e20 6275 696c 7469 6e28 226d  eturn builtin("m
+0001c140: 6f6e 7468 735f 6265 7477 6565 6e22 2928  onths_between")(
+0001c150: 6331 2c20 6332 290a 0a0a 6465 6620 746f  c1, c2)...def to
+0001c160: 5f67 656f 6772 6170 6879 2865 3a20 436f  _geography(e: Co
+0001c170: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0001c180: 6f6c 756d 6e3a 0a20 2020 2022 2222 5061  olumn:.    """Pa
+0001c190: 7273 6573 2061 6e20 696e 7075 7420 616e  rses an input an
+0001c1a0: 6420 7265 7475 726e 7320 6120 7661 6c75  d returns a valu
+0001c1b0: 6520 6f66 2074 7970 6520 4745 4f47 5241  e of type GEOGRA
+0001c1c0: 5048 592e 2053 7570 706f 7274 6564 2069  PHY. Supported i
+0001c1d0: 6e70 7574 7320 6172 6520 7374 7269 6e67  nputs are string
+0001c1e0: 7320 696e 0a0a 2020 2020 2020 2020 2d20  s in..        - 
+0001c1f0: 574b 5420 2877 656c 6c2d 6b6e 6f77 6e20  WKT (well-known 
+0001c200: 7465 7874 292e 0a20 2020 2020 2020 202d  text)..        -
+0001c210: 2057 4b42 2028 7765 6c6c 2d6b 6e6f 776e   WKB (well-known
+0001c220: 2062 696e 6172 7929 2069 6e20 6865 7861   binary) in hexa
+0001c230: 6465 6369 6d61 6c20 666f 726d 6174 2028  decimal format (
+0001c240: 7769 7468 6f75 7420 6120 6c65 6164 696e  without a leadin
+0001c250: 6720 3078 292e 0a20 2020 2020 2020 202d  g 0x)..        -
+0001c260: 2045 574b 5420 2865 7874 656e 6465 6420   EWKT (extended 
+0001c270: 7765 6c6c 2d6b 6e6f 776e 2074 6578 7429  well-known text)
+0001c280: 2e0a 2020 2020 2020 2020 2d20 4557 4b42  ..        - EWKB
+0001c290: 2028 6578 7465 6e64 6564 2077 656c 6c2d   (extended well-
+0001c2a0: 6b6e 6f77 6e20 6269 6e61 7279 2920 696e  known binary) in
+0001c2b0: 2068 6578 6164 6563 696d 616c 2066 6f72   hexadecimal for
+0001c2c0: 6d61 7420 2877 6974 686f 7574 2061 206c  mat (without a l
+0001c2d0: 6561 6469 6e67 2030 7829 2e0a 2020 2020  eading 0x)..    
+0001c2e0: 2020 2020 2d20 4765 6f4a 534f 4e2e 0a0a      - GeoJSON...
+0001c2f0: 2020 2020 666f 726d 6174 2e0a 0a20 2020      format...   
+0001c300: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0001c310: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0001c320: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0001c330: 7261 6d65 285b 2750 4f49 4e54 282d 3132  rame(['POINT(-12
+0001c340: 322e 3335 2033 372e 3535 2927 2c20 2750  2.35 37.55)', 'P
+0001c350: 4f49 4e54 2832 302e 3932 2034 332e 3333  OINT(20.92 43.33
+0001c360: 2927 5d2c 2073 6368 656d 613d 5b27 6127  )'], schema=['a'
+0001c370: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0001c380: 662e 7365 6c65 6374 2874 6f5f 6765 6f67  f.select(to_geog
+0001c390: 7261 7068 7928 636f 6c28 2261 2229 2929  raphy(col("a")))
+0001c3a0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001c3b0: 2020 205b 526f 7728 544f 5f47 454f 4752     [Row(TO_GEOGR
+0001c3c0: 4150 4859 2822 4122 293d 277b 5c5c 6e20  APHY("A")='{\\n 
+0001c3d0: 2022 636f 6f72 6469 6e61 7465 7322 3a20   "coordinates": 
+0001c3e0: 5b5c 5c6e 2020 2020 2d31 3232 2e33 352c  [\\n    -122.35,
+0001c3f0: 5c5c 6e20 2020 2033 372e 3535 5c5c 6e20  \\n    37.55\\n 
+0001c400: 205d 2c5c 5c6e 2020 2274 7970 6522 3a20   ],\\n  "type": 
+0001c410: 2250 6f69 6e74 225c 5c6e 7d27 292c 2052  "Point"\\n}'), R
+0001c420: 6f77 2854 4f5f 4745 4f47 5241 5048 5928  ow(TO_GEOGRAPHY(
+0001c430: 2241 2229 3d27 7b5c 5c6e 2020 2263 6f6f  "A")='{\\n  "coo
+0001c440: 7264 696e 6174 6573 223a 205b 5c5c 6e20  rdinates": [\\n 
+0001c450: 2020 2032 302e 3932 2c5c 5c6e 2020 2020     20.92,\\n    
+0001c460: 3433 2e33 335c 5c6e 2020 5d2c 5c5c 6e20  43.33\\n  ],\\n 
+0001c470: 2022 7479 7065 223a 2022 506f 696e 7422   "type": "Point"
+0001c480: 5c5c 6e7d 2729 5d0a 0a20 2020 2042 6573  \\n}')]..    Bes
+0001c490: 6964 6573 2073 7472 696e 6773 2c20 6269  ides strings, bi
+0001c4a0: 6e61 7279 2072 6570 7265 7365 6e74 6174  nary representat
+0001c4b0: 696f 6e20 696e 2057 4b42 2061 6e64 2045  ion in WKB and E
+0001c4c0: 574b 4220 666f 726d 6174 2063 616e 2062  WKB format can b
+0001c4d0: 6520 7061 7273 6564 2c20 6f72 206f 626a  e parsed, or obj
+0001c4e0: 6563 7473 2061 6468 6572 696e 6720 746f  ects adhering to
+0001c4f0: 2047 656f 4a53 4f4e 2066 6f72 6d61 742e   GeoJSON format.
+0001c500: 0a20 2020 2046 6f72 2061 6c6c 2073 7570  .    For all sup
+0001c510: 706f 7274 6564 2066 6f72 6d61 7473 2063  ported formats c
+0001c520: 6f6e 6665 7220 6874 7470 733a 2f2f 646f  onfer https://do
+0001c530: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+0001c540: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+0001c550: 652f 6461 7461 2d74 7970 6573 2d67 656f  e/data-types-geo
+0001c560: 7370 6174 6961 6c23 7375 7070 6f72 7465  spatial#supporte
+0001c570: 642d 6765 6f73 7061 7469 616c 2d6f 626a  d-geospatial-obj
+0001c580: 6563 742d 7479 7065 732e 0a20 2020 2022  ect-types..    "
+0001c590: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001c5a0: 6f6c 5f69 665f 7374 7228 652c 2022 746f  ol_if_str(e, "to
+0001c5b0: 5f67 656f 6772 6170 6879 2229 0a20 2020  _geography").   
+0001c5c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0001c5d0: 2274 6f5f 6765 6f67 7261 7068 7922 2928  "to_geography")(
+0001c5e0: 6329 0a0a 0a64 6566 2074 6f5f 6765 6f6d  c)...def to_geom
+0001c5f0: 6574 7279 2865 3a20 436f 6c75 6d6e 4f72  etry(e: ColumnOr
+0001c600: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0001c610: 0a20 2020 2022 2222 5061 7273 6573 2061  .    """Parses a
+0001c620: 6e20 696e 7075 7420 616e 6420 7265 7475  n input and retu
+0001c630: 726e 7320 6120 7661 6c75 6520 6f66 2074  rns a value of t
+0001c640: 7970 6520 4745 4f4d 4554 5259 2e20 5375  ype GEOMETRY. Su
+0001c650: 7070 6f72 7465 6420 696e 7075 7473 2061  pported inputs a
+0001c660: 7265 2073 7472 696e 6773 2069 6e0a 0a20  re strings in.. 
+0001c670: 2020 2020 2020 202d 2057 4b54 2028 7765         - WKT (we
+0001c680: 6c6c 2d6b 6e6f 776e 2074 6578 7429 2e0a  ll-known text)..
+0001c690: 2020 2020 2020 2020 2d20 574b 4220 2877          - WKB (w
+0001c6a0: 656c 6c2d 6b6e 6f77 6e20 6269 6e61 7279  ell-known binary
+0001c6b0: 2920 696e 2068 6578 6164 6563 696d 616c  ) in hexadecimal
+0001c6c0: 2066 6f72 6d61 7420 2877 6974 686f 7574   format (without
+0001c6d0: 2061 206c 6561 6469 6e67 2030 7829 2e0a   a leading 0x)..
+0001c6e0: 2020 2020 2020 2020 2d20 4557 4b54 2028          - EWKT (
+0001c6f0: 6578 7465 6e64 6564 2077 656c 6c2d 6b6e  extended well-kn
+0001c700: 6f77 6e20 7465 7874 292e 0a20 2020 2020  own text)..     
+0001c710: 2020 202d 2045 574b 4220 2865 7874 656e     - EWKB (exten
+0001c720: 6465 6420 7765 6c6c 2d6b 6e6f 776e 2062  ded well-known b
+0001c730: 696e 6172 7929 2069 6e20 6865 7861 6465  inary) in hexade
+0001c740: 6369 6d61 6c20 666f 726d 6174 2028 7769  cimal format (wi
+0001c750: 7468 6f75 7420 6120 6c65 6164 696e 6720  thout a leading 
+0001c760: 3078 292e 0a20 2020 2020 2020 202d 2047  0x)..        - G
+0001c770: 656f 4a53 4f4e 2e0a 0a20 2020 2066 6f72  eoJSON...    for
+0001c780: 6d61 742e 0a0a 2020 2020 4578 616d 706c  mat...    Exampl
+0001c790: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0001c7a0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001c7b0: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
+0001c7c0: 504f 494e 5428 2d31 3232 2e33 3520 3337  POINT(-122.35 37
+0001c7d0: 2e35 3529 272c 2027 504f 494e 5428 3230  .55)', 'POINT(20
+0001c7e0: 2e39 3220 3433 2e33 3329 275d 2c20 7363  .92 43.33)'], sc
+0001c7f0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
+0001c800: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0001c810: 7428 746f 5f67 656f 6d65 7472 7928 636f  t(to_geometry(co
+0001c820: 6c28 2261 2229 2929 2e63 6f6c 6c65 6374  l("a"))).collect
+0001c830: 2873 7461 7465 6d65 6e74 5f70 6172 616d  (statement_param
+0001c840: 733d 7b22 4745 4f4d 4554 5259 5f4f 5554  s={"GEOMETRY_OUT
+0001c850: 5055 545f 464f 524d 4154 223a 2022 574b  PUT_FORMAT": "WK
+0001c860: 5422 7d29 0a20 2020 2020 2020 205b 526f  T"}).        [Ro
+0001c870: 7728 544f 5f47 454f 4d45 5452 5928 2241  w(TO_GEOMETRY("A
+0001c880: 2229 3d27 504f 494e 5428 2d31 3232 2e33  ")='POINT(-122.3
+0001c890: 3520 3337 2e35 3529 2729 2c20 526f 7728  5 37.55)'), Row(
+0001c8a0: 544f 5f47 454f 4d45 5452 5928 2241 2229  TO_GEOMETRY("A")
+0001c8b0: 3d27 504f 494e 5428 3230 2e39 3220 3433  ='POINT(20.92 43
+0001c8c0: 2e33 3329 2729 5d0a 0a20 2020 2042 6573  .33)')]..    Bes
+0001c8d0: 6964 6573 2073 7472 696e 6773 2c20 6269  ides strings, bi
+0001c8e0: 6e61 7279 2072 6570 7265 7365 6e74 6174  nary representat
+0001c8f0: 696f 6e20 696e 2057 4b42 2061 6e64 2045  ion in WKB and E
+0001c900: 574b 4220 666f 726d 6174 2063 616e 2062  WKB format can b
+0001c910: 6520 7061 7273 6564 2c20 6f72 206f 626a  e parsed, or obj
+0001c920: 6563 7473 2061 6468 6572 696e 6720 746f  ects adhering to
+0001c930: 2047 656f 4a53 4f4e 2066 6f72 6d61 742e   GeoJSON format.
+0001c940: 0a20 2020 2046 6f72 2061 6c6c 2073 7570  .    For all sup
+0001c950: 706f 7274 6564 2066 6f72 6d61 7473 2063  ported formats c
+0001c960: 6f6e 6665 7220 6874 7470 733a 2f2f 646f  onfer https://do
+0001c970: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+0001c980: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+0001c990: 652f 6461 7461 2d74 7970 6573 2d67 656f  e/data-types-geo
+0001c9a0: 7370 6174 6961 6c23 7375 7070 6f72 7465  spatial#supporte
+0001c9b0: 642d 6765 6f73 7061 7469 616c 2d6f 626a  d-geospatial-obj
+0001c9c0: 6563 742d 7479 7065 732e 0a20 2020 2022  ect-types..    "
+0001c9d0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001c9e0: 6f6c 5f69 665f 7374 7228 652c 2022 746f  ol_if_str(e, "to
+0001c9f0: 5f67 656f 6d65 7472 7922 290a 2020 2020  _geometry").    
+0001ca00: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001ca10: 746f 5f67 656f 6d65 7472 7922 2928 6329  to_geometry")(c)
+0001ca20: 0a0a 0a64 6566 2061 7272 6179 735f 6f76  ...def arrays_ov
+0001ca30: 6572 6c61 7028 6172 7261 7931 3a20 436f  erlap(array1: Co
+0001ca40: 6c75 6d6e 4f72 4e61 6d65 2c20 6172 7261  lumnOrName, arra
+0001ca50: 7932 3a20 436f 6c75 6d6e 4f72 4e61 6d65  y2: ColumnOrName
+0001ca60: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001ca70: 2022 2222 436f 6d70 6172 6573 2077 6865   """Compares whe
+0001ca80: 7468 6572 2074 776f 2041 5252 4159 7320  ther two ARRAYs 
+0001ca90: 6861 7665 2061 7420 6c65 6173 7420 6f6e  have at least on
+0001caa0: 6520 656c 656d 656e 7420 696e 2063 6f6d  e element in com
+0001cab0: 6d6f 6e2e 2052 6574 7572 6e73 2054 5255  mon. Returns TRU
+0001cac0: 450a 2020 2020 6966 2074 6865 7265 2069  E.    if there i
+0001cad0: 7320 6174 206c 6561 7374 206f 6e65 2065  s at least one e
+0001cae0: 6c65 6d65 6e74 2069 6e20 636f 6d6d 6f6e  lement in common
+0001caf0: 3b20 6f74 6865 7277 6973 6520 7265 7475  ; otherwise retu
+0001cb00: 726e 7320 4641 4c53 452e 2054 6865 2066  rns FALSE. The f
+0001cb10: 756e 6374 696f 6e0a 2020 2020 6973 204e  unction.    is N
+0001cb20: 554c 4c2d 7361 6665 2c20 6d65 616e 696e  ULL-safe, meanin
+0001cb30: 6720 6974 2074 7265 6174 7320 4e55 4c4c  g it treats NULL
+0001cb40: 7320 6173 206b 6e6f 776e 2076 616c 7565  s as known value
+0001cb50: 7320 666f 7220 636f 6d70 6172 696e 6720  s for comparing 
+0001cb60: 6571 7561 6c69 7479 2e0a 0a20 2020 2045  equality...    E
+0001cb70: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0001cb80: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0001cb90: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
+0001cba0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
+0001cbb0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0001cbc0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0001cbd0: 6528 5b52 6f77 285b 312c 2032 5d2c 205b  e([Row([1, 2], [
+0001cbe0: 312c 2033 5d29 2c20 526f 7728 5b31 2c20  1, 3]), Row([1, 
+0001cbf0: 325d 2c20 5b33 2c20 345d 295d 2c20 7363  2], [3, 4])], sc
+0001cc00: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
+0001cc10: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0001cc20: 7365 6c65 6374 2861 7272 6179 735f 6f76  select(arrays_ov
+0001cc30: 6572 6c61 7028 2261 222c 2022 6222 292e  erlap("a", "b").
+0001cc40: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0001cc50: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0001cc60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001cc70: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0001cc80: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0001cc90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001cca0: 5472 7565 2020 2020 2020 7c0a 2020 2020  True      |.    
+0001ccb0: 2020 2020 7c46 616c 7365 2020 2020 207c      |False     |
+0001ccc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001ccd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0001cce0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0001ccf0: 220a 2020 2020 6131 203d 205f 746f 5f63  ".    a1 = _to_c
+0001cd00: 6f6c 5f69 665f 7374 7228 6172 7261 7931  ol_if_str(array1
+0001cd10: 2c20 2261 7272 6179 735f 6f76 6572 6c61  , "arrays_overla
+0001cd20: 7022 290a 2020 2020 6132 203d 205f 746f  p").    a2 = _to
+0001cd30: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
+0001cd40: 7932 2c20 2261 7272 6179 735f 6f76 6572  y2, "arrays_over
+0001cd50: 6c61 7022 290a 2020 2020 7265 7475 726e  lap").    return
+0001cd60: 2062 7569 6c74 696e 2822 6172 7261 7973   builtin("arrays
+0001cd70: 5f6f 7665 726c 6170 2229 2861 312c 2061  _overlap")(a1, a
+0001cd80: 3229 0a0a 0a64 6566 2061 7272 6179 5f64  2)...def array_d
+0001cd90: 6973 7469 6e63 7428 636f 6c3a 2043 6f6c  istinct(col: Col
+0001cda0: 756d 6e4f 724e 616d 6529 3a0a 2020 2020  umnOrName):.    
+0001cdb0: 2222 2254 6865 2066 756e 6374 696f 6e20  """The function 
+0001cdc0: 6578 636c 7564 6573 2061 6e79 2064 7570  excludes any dup
+0001cdd0: 6c69 6361 7465 2065 6c65 6d65 6e74 7320  licate elements 
+0001cde0: 7468 6174 2061 7265 2070 7265 7365 6e74  that are present
+0001cdf0: 2069 6e20 7468 6520 696e 7075 7420 4152   in the input AR
+0001ce00: 5241 592e 0a20 2020 2054 6865 2066 756e  RAY..    The fun
+0001ce10: 6374 696f 6e20 6973 206e 6f74 2067 7561  ction is not gua
+0001ce20: 7261 6e74 6565 6420 746f 2072 6574 7572  ranteed to retur
+0001ce30: 6e20 7468 6520 656c 656d 656e 7473 2069  n the elements i
+0001ce40: 6e20 7468 6520 4152 5241 5920 696e 2061  n the ARRAY in a
+0001ce50: 2073 7065 6369 6669 6320 6f72 6465 722e   specific order.
+0001ce60: 0a20 2020 2054 6865 2066 756e 6374 696f  .    The functio
+0001ce70: 6e20 6973 204e 554c 4c20 7361 6665 2c20  n is NULL safe, 
+0001ce80: 7768 6963 6820 6d65 616e 7320 7468 6174  which means that
+0001ce90: 2069 7420 7472 6561 7473 204e 554c 4c73   it treats NULLs
+0001cea0: 2061 7320 6b6e 6f77 6e20 7661 6c75 6573   as known values
+0001ceb0: 2077 6865 6e20 6964 656e 7469 6679 696e   when identifyin
+0001cec0: 6720 6475 706c 6963 6174 6520 656c 656d  g duplicate elem
+0001ced0: 656e 7473 2e0a 0a20 2020 2041 7267 733a  ents...    Args:
+0001cee0: 0a20 2020 2020 2020 2063 6f6c 3a20 5468  .        col: Th
+0001cef0: 6520 6172 7261 7920 636f 6c75 6d6e 0a0a  e array column..
+0001cf00: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+0001cf10: 2020 2020 2052 6574 7572 6e73 2061 206e       Returns a n
+0001cf20: 6577 2041 5252 4159 2074 6861 7420 636f  ew ARRAY that co
+0001cf30: 6e74 6169 6e73 206f 6e6c 7920 7468 6520  ntains only the 
+0001cf40: 6469 7374 696e 6374 2065 6c65 6d65 6e74  distinct element
+0001cf50: 7320 6672 6f6d 2074 6865 2069 6e70 7574  s from the input
+0001cf60: 2041 5252 4159 2e0a 0a20 2020 2045 7861   ARRAY...    Exa
+0001cf70: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001cf80: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0001cf90: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+0001cfa0: 7469 6f6e 7320 696d 706f 7274 2061 7272  tions import arr
+0001cfb0: 6179 5f63 6f6e 7374 7275 6374 2c61 7272  ay_construct,arr
+0001cfc0: 6179 5f64 6973 7469 6e63 742c 6c69 740a  ay_distinct,lit.
+0001cfd0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001cfe0: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
+0001cff0: 6174 6146 7261 6d65 285b 5b22 3122 5d5d  ataFrame([["1"]]
+0001d000: 2c20 5b22 4122 5d29 0a20 2020 2020 2020  , ["A"]).       
+0001d010: 203e 3e3e 2064 6620 3d20 6466 2e77 6974   >>> df = df.wit
+0001d020: 6843 6f6c 756d 6e28 2261 7272 6179 222c  hColumn("array",
+0001d030: 2061 7272 6179 5f63 6f6e 7374 7275 6374   array_construct
+0001d040: 286c 6974 2831 292c 206c 6974 2831 292c  (lit(1), lit(1),
+0001d050: 206c 6974 2831 292c 206c 6974 2832 292c   lit(1), lit(2),
+0001d060: 206c 6974 2833 292c 206c 6974 2832 292c   lit(3), lit(2),
+0001d070: 206c 6974 2832 2929 290a 2020 2020 2020   lit(2))).      
+0001d080: 2020 3e3e 3e20 6466 2e77 6974 6843 6f6c    >>> df.withCol
+0001d090: 756d 6e28 2261 7272 6179 5f64 222c 2061  umn("array_d", a
+0001d0a0: 7272 6179 5f64 6973 7469 6e63 7428 2241  rray_distinct("A
+0001d0b0: 5252 4159 2229 292e 7368 6f77 2829 0a20  RRAY")).show(). 
+0001d0c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001d0d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d0e0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2241  ----.        |"A
+0001d0f0: 2220 207c 2241 5252 4159 2220 207c 2241  "  |"ARRAY"  |"A
+0001d100: 5252 4159 5f44 2220 207c 0a20 2020 2020  RRAY_D"  |.     
+0001d110: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0001d120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d130: 0a20 2020 2020 2020 207c 3120 2020 207c  .        |1    |
+0001d140: 5b20 2020 2020 2020 207c 5b20 2020 2020  [        |[     
+0001d150: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001d160: 2020 2020 207c 2020 312c 2020 2020 207c       |  1,     |
+0001d170: 2020 312c 2020 2020 2020 207c 0a20 2020    1,       |.   
+0001d180: 2020 2020 207c 2020 2020 207c 2020 312c       |     |  1,
+0001d190: 2020 2020 207c 2020 322c 2020 2020 2020       |  2,      
+0001d1a0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+0001d1b0: 207c 2020 312c 2020 2020 207c 2020 3320   |  1,     |  3 
+0001d1c0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0001d1d0: 207c 2020 2020 207c 2020 322c 2020 2020   |     |  2,    
+0001d1e0: 207c 5d20 2020 2020 2020 2020 207c 0a20   |]          |. 
+0001d1f0: 2020 2020 2020 207c 2020 2020 207c 2020         |     |  
+0001d200: 332c 2020 2020 207c 2020 2020 2020 2020  3,     |        
+0001d210: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0001d220: 2020 207c 2020 322c 2020 2020 207c 2020     |  2,     |  
+0001d230: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0001d240: 2020 207c 2020 2020 207c 2020 3220 2020     |     |  2   
+0001d250: 2020 207c 2020 2020 2020 2020 2020 207c     |           |
+0001d260: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
+0001d270: 5d20 2020 2020 2020 207c 2020 2020 2020  ]        |      
+0001d280: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0001d290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001d2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001d2b0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0001d2c0: 0a20 2020 2022 2222 0a20 2020 2063 6f6c  .    """.    col
+0001d2d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001d2e0: 7228 636f 6c2c 2022 6172 7261 795f 6469  r(col, "array_di
+0001d2f0: 7374 696e 6374 2229 0a20 2020 2072 6574  stinct").    ret
+0001d300: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
+0001d310: 6179 5f64 6973 7469 6e63 7422 2928 636f  ay_distinct")(co
+0001d320: 6c29 0a0a 0a64 6566 2061 7272 6179 5f69  l)...def array_i
+0001d330: 6e74 6572 7365 6374 696f 6e28 6172 7261  ntersection(arra
+0001d340: 7931 3a20 436f 6c75 6d6e 4f72 4e61 6d65  y1: ColumnOrName
+0001d350: 2c20 6172 7261 7932 3a20 436f 6c75 6d6e  , array2: Column
+0001d360: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0001d370: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+0001d380: 7320 616e 2061 7272 6179 2074 6861 7420  s an array that 
+0001d390: 636f 6e74 6169 6e73 2074 6865 206d 6174  contains the mat
+0001d3a0: 6368 696e 6720 656c 656d 656e 7473 2069  ching elements i
+0001d3b0: 6e20 7468 6520 7477 6f20 696e 7075 7420  n the two input 
+0001d3c0: 6172 7261 7973 2e0a 0a20 2020 2054 6865  arrays...    The
+0001d3d0: 2066 756e 6374 696f 6e20 6973 204e 554c   function is NUL
+0001d3e0: 4c2d 7361 6665 2c20 6d65 616e 696e 6720  L-safe, meaning 
+0001d3f0: 6974 2074 7265 6174 7320 4e55 4c4c 7320  it treats NULLs 
+0001d400: 6173 206b 6e6f 776e 2076 616c 7565 7320  as known values 
+0001d410: 666f 7220 636f 6d70 6172 696e 6720 6571  for comparing eq
+0001d420: 7561 6c69 7479 2e0a 0a20 2020 2041 7267  uality...    Arg
+0001d430: 733a 0a20 2020 2020 2020 2061 7272 6179  s:.        array
+0001d440: 313a 2041 6e20 4152 5241 5920 7468 6174  1: An ARRAY that
+0001d450: 2063 6f6e 7461 696e 7320 656c 656d 656e   contains elemen
+0001d460: 7473 2074 6f20 6265 2063 6f6d 7061 7265  ts to be compare
+0001d470: 642e 0a20 2020 2020 2020 2061 7272 6179  d..        array
+0001d480: 323a 2041 6e20 4152 5241 5920 7468 6174  2: An ARRAY that
+0001d490: 2063 6f6e 7461 696e 7320 656c 656d 656e   contains elemen
+0001d4a0: 7473 2074 6f20 6265 2063 6f6d 7061 7265  ts to be compare
+0001d4b0: 642e 0a0a 2020 2020 4578 616d 706c 653a  d...    Example:
+0001d4c0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+0001d4d0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0001d4e0: 7770 6172 6b20 696d 706f 7274 2052 6f77  wpark import Row
+0001d4f0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0001d500: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001d510: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
+0001d520: 5b31 2c20 325d 2c20 5b31 2c20 335d 295d  [1, 2], [1, 3])]
+0001d530: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+0001d540: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
+0001d550: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
+0001d560: 5f69 6e74 6572 7365 6374 696f 6e28 2261  _intersection("a
+0001d570: 222c 2022 6222 292e 616c 6961 7328 2272  ", "b").alias("r
+0001d580: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0001d590: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001d5a0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0001d5b0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0001d5c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0001d5d0: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+0001d5e0: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+0001d5f0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0001d600: 207c 5d20 2020 2020 2020 2020 7c0a 2020   |]         |.  
+0001d610: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001d620: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0001d630: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0001d640: 2020 2061 3120 3d20 5f74 6f5f 636f 6c5f     a1 = _to_col_
+0001d650: 6966 5f73 7472 2861 7272 6179 312c 2022  if_str(array1, "
+0001d660: 6172 7261 795f 696e 7465 7273 6563 7469  array_intersecti
+0001d670: 6f6e 2229 0a20 2020 2061 3220 3d20 5f74  on").    a2 = _t
+0001d680: 6f5f 636f 6c5f 6966 5f73 7472 2861 7272  o_col_if_str(arr
+0001d690: 6179 322c 2022 6172 7261 795f 696e 7465  ay2, "array_inte
+0001d6a0: 7273 6563 7469 6f6e 2229 0a20 2020 2072  rsection").    r
+0001d6b0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+0001d6c0: 7272 6179 5f69 6e74 6572 7365 6374 696f  rray_intersectio
+0001d6d0: 6e22 2928 6131 2c20 6132 290a 0a0a 6465  n")(a1, a2)...de
+0001d6e0: 6620 6172 7261 795f 6d69 6e28 6172 7261  f array_min(arra
+0001d6f0: 793a 2043 6f6c 756d 6e4f 724e 616d 6529  y: ColumnOrName)
+0001d700: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0001d710: 2222 2252 6574 7572 6e73 2073 6d61 6c6c  """Returns small
+0001d720: 6573 7420 6465 6669 6e65 6420 6e6f 6e2d  est defined non-
+0001d730: 4e55 4c4c 2065 6c65 6d65 6e74 2069 6e20  NULL element in 
+0001d740: 7468 6520 696e 7075 7420 6172 7261 792e  the input array.
+0001d750: 2049 6620 7468 6520 696e 7075 740a 2020   If the input.  
+0001d760: 2020 6172 7261 7920 6973 2065 6d70 7479    array is empty
+0001d770: 2c20 6f72 2074 6865 7265 2069 7320 6e6f  , or there is no
+0001d780: 2064 6566 696e 6564 2065 6c65 6d65 6e74   defined element
+0001d790: 2069 6e20 7468 6520 696e 7075 7420 6172   in the input ar
+0001d7a0: 7261 792c 2074 6865 6e20 7468 650a 2020  ray, then the.  
+0001d7b0: 2020 6675 6e63 7469 6f6e 2072 6574 7572    function retur
+0001d7c0: 6e73 204e 554c 4c2e 0a0a 2020 2020 4d75  ns NULL...    Mu
+0001d7d0: 7374 2065 6e61 626c 6520 7061 7261 6d65  st enable parame
+0001d7e0: 7465 7220 6045 4e41 424c 455f 4152 5241  ter `ENABLE_ARRA
+0001d7f0: 595f 4d49 4e5f 4d41 585f 4655 4e43 5449  Y_MIN_MAX_FUNCTI
+0001d800: 4f4e 5360 2069 6e20 796f 7572 2073 6573  ONS` in your ses
+0001d810: 7369 6f6e 2e0a 0a20 2020 2041 7267 733a  sion...    Args:
+0001d820: 0a20 2020 2020 2020 2061 7272 6179 3a20  .        array: 
+0001d830: 7468 6520 696e 7075 7420 6172 7261 790a  the input array.
+0001d840: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+0001d850: 2020 2020 2020 6120 5641 5249 414e 5420        a VARIANT 
+0001d860: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
+0001d870: 6d61 6c6c 6573 7420 6465 6669 6e65 6420  mallest defined 
+0001d880: 656c 656d 656e 7420 696e 2074 6865 2061  element in the a
+0001d890: 7272 6179 2c20 6f72 204e 554c 4c0a 2020  rray, or NULL.  
+0001d8a0: 2020 2222 220a 2020 2020 6172 7261 7920    """.    array 
+0001d8b0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001d8c0: 2861 7272 6179 2c20 2261 7272 6179 5f6d  (array, "array_m
+0001d8d0: 696e 2229 0a20 2020 2072 6574 7572 6e20  in").    return 
+0001d8e0: 6275 696c 7469 6e28 2261 7272 6179 5f6d  builtin("array_m
+0001d8f0: 696e 2229 2861 7272 6179 290a 0a0a 6465  in")(array)...de
+0001d900: 6620 6172 7261 795f 6d61 7828 6172 7261  f array_max(arra
+0001d910: 793a 2043 6f6c 756d 6e4f 724e 616d 6529  y: ColumnOrName)
+0001d920: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0001d930: 2222 2252 6574 7572 6e73 206c 6172 6765  """Returns large
+0001d940: 7374 2064 6566 696e 6564 206e 6f6e 2d4e  st defined non-N
+0001d950: 554c 4c20 656c 656d 656e 7420 696e 2074  ULL element in t
+0001d960: 6865 2069 6e70 7574 2061 7272 6179 2e20  he input array. 
+0001d970: 4966 2074 6865 2069 6e70 7574 0a20 2020  If the input.   
+0001d980: 2061 7272 6179 2069 7320 656d 7074 792c   array is empty,
+0001d990: 206f 7220 7468 6572 6520 6973 206e 6f20   or there is no 
+0001d9a0: 6465 6669 6e65 6420 656c 656d 656e 7420  defined element 
+0001d9b0: 696e 2074 6865 2069 6e70 7574 2061 7272  in the input arr
+0001d9c0: 6179 2c20 7468 656e 2074 6865 0a20 2020  ay, then the.   
+0001d9d0: 2066 756e 6374 696f 6e20 7265 7475 726e   function return
+0001d9e0: 7320 4e55 4c4c 2e0a 0a20 2020 204d 7573  s NULL...    Mus
+0001d9f0: 7420 656e 6162 6c65 2070 6172 616d 6574  t enable paramet
+0001da00: 6572 2060 454e 4142 4c45 5f41 5252 4159  er `ENABLE_ARRAY
+0001da10: 5f4d 494e 5f4d 4158 5f46 554e 4354 494f  _MIN_MAX_FUNCTIO
+0001da20: 4e53 6020 696e 2079 6f75 7220 7365 7373  NS` in your sess
+0001da30: 696f 6e2e 0a0a 2020 2020 4172 6773 3a0a  ion...    Args:.
+0001da40: 2020 2020 2020 2020 6172 7261 793a 2074          array: t
+0001da50: 6865 2069 6e70 7574 2061 7272 6179 0a0a  he input array..
+0001da60: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+0001da70: 2020 2020 2061 2056 4152 4941 4e54 2063       a VARIANT c
+0001da80: 6f6e 7461 696e 696e 6720 7468 6520 6c61  ontaining the la
+0001da90: 7267 6573 7420 6465 6669 6e65 6420 656c  rgest defined el
+0001daa0: 656d 656e 7420 696e 2074 6865 2061 7272  ement in the arr
+0001dab0: 6179 2c20 6f72 204e 554c 4c0a 2020 2020  ay, or NULL.    
+0001dac0: 2222 220a 2020 2020 6172 7261 7920 3d20  """.    array = 
+0001dad0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+0001dae0: 7272 6179 2c20 2261 7272 6179 5f6d 6178  rray, "array_max
+0001daf0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0001db00: 696c 7469 6e28 2261 7272 6179 5f6d 6178  iltin("array_max
+0001db10: 2229 2861 7272 6179 290a 0a0a 6465 6620  ")(array)...def 
+0001db20: 6172 7261 795f 736f 7274 280a 2020 2020  array_sort(.    
+0001db30: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
+0001db40: 616d 652c 0a20 2020 2073 6f72 745f 6173  ame,.    sort_as
+0001db50: 6365 6e64 696e 673a 204f 7074 696f 6e61  cending: Optiona
+0001db60: 6c5b 626f 6f6c 5d20 3d20 5472 7565 2c0a  l[bool] = True,.
+0001db70: 2020 2020 6e75 6c6c 735f 6669 7273 743a      nulls_first:
+0001db80: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0001db90: 3d20 4661 6c73 652c 0a29 202d 3e20 436f  = False,.) -> Co
+0001dba0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+0001dbb0: 7572 6e73 2072 6f77 7320 6f66 2061 7272  urns rows of arr
+0001dbc0: 6179 2063 6f6c 756d 6e20 696e 2073 6f72  ay column in sor
+0001dbd0: 7465 6420 6f72 6465 722e 2055 7365 7273  ted order. Users
+0001dbe0: 2063 616e 2063 686f 6f73 6520 7468 6520   can choose the 
+0001dbf0: 736f 7274 206f 7264 6572 2061 6e64 2064  sort order and d
+0001dc00: 6563 6964 6520 7768 6572 6520 746f 206b  ecide where to k
+0001dc10: 6565 7020 6e75 6c6c 2065 6c65 6d65 6e74  eep null element
+0001dc20: 732e 0a0a 2020 2020 4d75 7374 2065 6e61  s...    Must ena
+0001dc30: 626c 6520 7061 7261 6d65 7465 7220 6045  ble parameter `E
+0001dc40: 4e41 424c 455f 4152 5241 595f 534f 5254  NABLE_ARRAY_SORT
+0001dc50: 5f46 554e 4354 494f 4e60 2069 6e20 796f  _FUNCTION` in yo
+0001dc60: 7572 2073 6573 7369 6f6e 2e0a 0a20 2020  ur session...   
+0001dc70: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
+0001dc80: 7272 6179 3a20 6e61 6d65 206f 6620 7468  rray: name of th
+0001dc90: 6520 636f 6c75 6d6e 206f 7220 636f 6c75  e column or colu
+0001dca0: 6d6e 2065 6c65 6d65 6e74 2077 6869 6368  mn element which
+0001dcb0: 2064 6573 6372 6962 6573 2074 6865 2063   describes the c
+0001dcc0: 6f6c 756d 6e0a 2020 2020 2020 2020 736f  olumn.        so
+0001dcd0: 7274 5f61 7363 656e 6469 6e67 3a20 426f  rt_ascending: Bo
+0001dce0: 6f6c 6561 6e20 7468 6174 2064 6563 6964  olean that decid
+0001dcf0: 6573 2069 6620 6172 7261 7920 656c 656d  es if array elem
+0001dd00: 656e 7473 2061 7265 2073 6f72 7465 6420  ents are sorted 
+0001dd10: 696e 2061 7363 656e 6469 6e67 206f 7264  in ascending ord
+0001dd20: 6572 2e0a 2020 2020 2020 2020 2020 2020  er..            
+0001dd30: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
+0001dd40: 2e0a 2020 2020 2020 2020 6e75 6c6c 735f  ..        nulls_
+0001dd50: 6669 7273 743a 2042 6f6f 6c65 616e 2074  first: Boolean t
+0001dd60: 6861 7420 6465 6369 6465 7320 6966 2053  hat decides if S
+0001dd70: 514c 206e 756c 6c20 656c 656d 656e 7473  QL null elements
+0001dd80: 2077 696c 6c20 6265 2070 6c61 6365 6420   will be placed 
+0001dd90: 696e 2074 6865 2062 6567 696e 6e69 6e67  in the beginning
+0001dda0: 0a20 2020 2020 2020 2020 2020 206f 6620  .            of 
+0001ddb0: 7468 6520 6172 7261 792e 204e 6f74 6520  the array. Note 
+0001ddc0: 7468 6174 2074 6869 7320 646f 6573 206e  that this does n
+0001ddd0: 6f74 2061 6666 6563 7420 4a53 4f4e 206e  ot affect JSON n
+0001dde0: 756c 6c2e 2044 6566 6175 6c74 7320 746f  ull. Defaults to
+0001ddf0: 2046 616c 7365 2e0a 2020 2020 2222 220a   False..    """.
+0001de00: 2020 2020 6172 7261 7920 3d20 5f74 6f5f      array = _to_
+0001de10: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
+0001de20: 2c20 2261 7272 6179 5f73 6f72 7422 290a  , "array_sort").
+0001de30: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001de40: 696e 2822 6172 7261 795f 736f 7274 2229  in("array_sort")
+0001de50: 2861 7272 6179 2c20 6c69 7428 736f 7274  (array, lit(sort
+0001de60: 5f61 7363 656e 6469 6e67 292c 206c 6974  _ascending), lit
+0001de70: 286e 756c 6c73 5f66 6972 7374 2929 0a0a  (nulls_first))..
+0001de80: 0a64 6566 2061 7272 6179 5f67 656e 6572  .def array_gener
+0001de90: 6174 655f 7261 6e67 6528 0a20 2020 2073  ate_range(.    s
+0001dea0: 7461 7274 3a20 436f 6c75 6d6e 4f72 4e61  tart: ColumnOrNa
+0001deb0: 6d65 2c20 7374 6f70 3a20 436f 6c75 6d6e  me, stop: Column
+0001dec0: 4f72 4e61 6d65 2c20 7374 6570 3a20 4f70  OrName, step: Op
+0001ded0: 7469 6f6e 616c 5b43 6f6c 756d 6e4f 724e  tional[ColumnOrN
+0001dee0: 616d 655d 203d 204e 6f6e 650a 2920 2d3e  ame] = None.) ->
+0001def0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0001df00: 4765 6e65 7261 7465 2061 2072 616e 6765  Generate a range
+0001df10: 206f 6620 696e 7465 6765 7273 2066 726f   of integers fro
+0001df20: 6d20 6073 7461 7274 6020 746f 2060 7374  m `start` to `st
+0001df30: 6f70 602c 2069 6e63 7265 6d65 6e74 696e  op`, incrementin
+0001df40: 6720 6279 2060 7374 6570 602e 0a20 2020  g by `step`..   
+0001df50: 2049 6620 6073 7465 7060 2069 7320 6e6f   If `step` is no
+0001df60: 7420 7365 742c 2069 6e63 7265 6d65 6e74  t set, increment
+0001df70: 696e 6720 6279 2031 2e0a 0a20 2020 2041  ing by 1...    A
+0001df80: 7267 733a 0a20 2020 2020 2020 2073 7461  rgs:.        sta
+0001df90: 7274 3a20 7468 6520 636f 6c75 6d6e 2074  rt: the column t
+0001dfa0: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
+0001dfb0: 2069 6e74 6567 6572 2074 6f20 7374 6172   integer to star
+0001dfc0: 7420 7769 7468 2028 696e 636c 7573 6976  t with (inclusiv
+0001dfd0: 6529 2e0a 2020 2020 2020 2020 7374 6f70  e)..        stop
+0001dfe0: 3a20 7468 6520 636f 6c75 6d6e 2074 6861  : the column tha
+0001dff0: 7420 636f 6e74 6169 6e73 2074 6865 2069  t contains the i
+0001e000: 6e74 6567 6572 2074 6f20 7374 6f70 2028  nteger to stop (
+0001e010: 6578 636c 7573 6976 6529 2e0a 2020 2020  exclusive)..    
+0001e020: 2020 2020 7374 6570 3a20 7468 6520 636f      step: the co
+0001e030: 6c75 6d6e 2074 6861 7420 636f 6e74 6169  lumn that contai
+0001e040: 6e73 2074 6865 2069 6e74 6567 6572 2074  ns the integer t
+0001e050: 6f20 696e 6372 656d 656e 742e 0a0a 2020  o increment...  
+0001e060: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0001e070: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0001e080: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b20  wflake.snowpark 
+0001e090: 696d 706f 7274 2052 6f77 0a20 2020 2020  import Row.     
+0001e0a0: 2020 203e 3e3e 2064 6631 203d 2073 6573     >>> df1 = ses
+0001e0b0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001e0c0: 6672 616d 6528 5b28 2d32 2c20 3229 5d2c  frame([(-2, 2)],
+0001e0d0: 205b 2261 222c 2022 6222 5d29 0a20 2020   ["a", "b"]).   
+0001e0e0: 2020 2020 203e 3e3e 2064 6631 2e73 656c       >>> df1.sel
+0001e0f0: 6563 7428 6172 7261 795f 6765 6e65 7261  ect(array_genera
+0001e100: 7465 5f72 616e 6765 2822 6122 2c20 2262  te_range("a", "b
+0001e110: 2229 2e61 6c69 6173 2822 7265 7375 6c74  ").alias("result
+0001e120: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0001e130: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0001e140: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0001e150: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0001e160: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001e170: 2020 7c5b 2020 2020 2020 2020 207c 0a20    |[         |. 
+0001e180: 2020 2020 2020 207c 2020 2d32 2c20 2020         |  -2,   
+0001e190: 2020 7c0a 2020 2020 2020 2020 7c20 202d    |.        |  -
+0001e1a0: 312c 2020 2020 207c 0a20 2020 2020 2020  1,     |.       
+0001e1b0: 207c 2020 302c 2020 2020 2020 7c0a 2020   |  0,      |.  
+0001e1c0: 2020 2020 2020 7c20 2031 2020 2020 2020        |  1      
+0001e1d0: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+0001e1e0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0001e1f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001e200: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0001e210: 0a20 2020 2020 2020 203e 3e3e 2064 6632  .        >>> df2
+0001e220: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001e230: 655f 6461 7461 6672 616d 6528 5b28 342c  e_dataframe([(4,
+0001e240: 202d 342c 202d 3229 5d2c 205b 2261 222c   -4, -2)], ["a",
+0001e250: 2022 6222 2c20 2263 225d 290a 2020 2020   "b", "c"]).    
+0001e260: 2020 2020 3e3e 3e20 6466 322e 7365 6c65      >>> df2.sele
+0001e270: 6374 2861 7272 6179 5f67 656e 6572 6174  ct(array_generat
+0001e280: 655f 7261 6e67 6528 2261 222c 2022 6222  e_range("a", "b"
+0001e290: 2c20 2263 2229 2e61 6c69 6173 2822 7265  , "c").alias("re
+0001e2a0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+0001e2b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001e2c0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0001e2d0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+0001e2e0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0001e2f0: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
+0001e300: 207c 0a20 2020 2020 2020 207c 2020 342c   |.        |  4,
+0001e310: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0001e320: 7c20 2032 2c20 2020 2020 207c 0a20 2020  |  2,      |.   
+0001e330: 2020 2020 207c 2020 302c 2020 2020 2020       |  0,      
+0001e340: 7c0a 2020 2020 2020 2020 7c20 202d 3220  |.        |  -2 
+0001e350: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001e360: 5d20 2020 2020 2020 2020 7c0a 2020 2020  ]         |.    
+0001e370: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001e380: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0001e390: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0001e3a0: 2073 7461 7274 5f63 6f6c 203d 205f 746f   start_col = _to
+0001e3b0: 5f63 6f6c 5f69 665f 7374 7228 7374 6172  _col_if_str(star
+0001e3c0: 742c 2022 6172 7261 795f 6765 6e65 7261  t, "array_genera
+0001e3d0: 7465 5f72 616e 6765 2229 0a20 2020 2073  te_range").    s
+0001e3e0: 746f 705f 636f 6c20 3d20 5f74 6f5f 636f  top_col = _to_co
+0001e3f0: 6c5f 6966 5f73 7472 2873 746f 702c 2022  l_if_str(stop, "
+0001e400: 6172 7261 795f 6765 6e65 7261 7465 5f72  array_generate_r
+0001e410: 616e 6765 2229 0a20 2020 2069 6620 7374  ange").    if st
+0001e420: 6570 2069 7320 4e6f 6e65 3a0a 2020 2020  ep is None:.    
+0001e430: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001e440: 696e 2822 6172 7261 795f 6765 6e65 7261  in("array_genera
+0001e450: 7465 5f72 616e 6765 2229 2873 7461 7274  te_range")(start
+0001e460: 5f63 6f6c 2c20 7374 6f70 5f63 6f6c 290a  _col, stop_col).
+0001e470: 2020 2020 7374 6570 5f63 6f6c 203d 205f      step_col = _
+0001e480: 746f 5f63 6f6c 5f69 665f 7374 7228 7374  to_col_if_str(st
+0001e490: 6570 2c20 2261 7272 6179 5f67 656e 6572  ep, "array_gener
+0001e4a0: 6174 655f 7261 6e67 6522 290a 2020 2020  ate_range").    
+0001e4b0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0001e4c0: 6172 7261 795f 6765 6e65 7261 7465 5f72  array_generate_r
+0001e4d0: 616e 6765 2229 2873 7461 7274 5f63 6f6c  ange")(start_col
+0001e4e0: 2c20 7374 6f70 5f63 6f6c 2c20 7374 6570  , stop_col, step
+0001e4f0: 5f63 6f6c 290a 0a0a 6465 6620 7365 7175  _col)...def sequ
+0001e500: 656e 6365 280a 2020 2020 7374 6172 743a  ence(.    start:
+0001e510: 2043 6f6c 756d 6e4f 724e 616d 652c 2073   ColumnOrName, s
+0001e520: 746f 703a 2043 6f6c 756d 6e4f 724e 616d  top: ColumnOrNam
+0001e530: 652c 2073 7465 703a 204f 7074 696f 6e61  e, step: Optiona
+0001e540: 6c5b 436f 6c75 6d6e 4f72 4e61 6d65 5d20  l[ColumnOrName] 
+0001e550: 3d20 4e6f 6e65 0a29 202d 3e20 436f 6c75  = None.) -> Colu
+0001e560: 6d6e 3a0a 2020 2020 2222 2247 656e 6572  mn:.    """Gener
+0001e570: 6174 6520 6120 7365 7175 656e 6365 206f  ate a sequence o
+0001e580: 6620 696e 7465 6765 7273 2066 726f 6d20  f integers from 
+0001e590: 6073 7461 7274 6020 746f 2060 7374 6f70  `start` to `stop
+0001e5a0: 602c 2069 6e63 7265 6d65 6e74 696e 6720  `, incrementing 
+0001e5b0: 6279 2060 7374 6570 602e 0a20 2020 2049  by `step`..    I
+0001e5c0: 6620 6073 7465 7060 2069 7320 6e6f 7420  f `step` is not 
+0001e5d0: 7365 742c 2069 6e63 7265 6d65 6e74 696e  set, incrementin
+0001e5e0: 6720 6279 2031 2069 6620 7374 6172 7420  g by 1 if start 
+0001e5f0: 6973 206c 6573 7320 7468 616e 206f 7220  is less than or 
+0001e600: 6571 7561 6c20 746f 2073 746f 702c 206f  equal to stop, o
+0001e610: 7468 6572 7769 7365 202d 312e 0a0a 2020  therwise -1...  
+0001e620: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0001e630: 7374 6172 743a 2074 6865 2063 6f6c 756d  start: the colum
+0001e640: 6e20 7468 6174 2063 6f6e 7461 696e 7320  n that contains 
+0001e650: 7468 6520 696e 7465 6765 7220 746f 2073  the integer to s
+0001e660: 7461 7274 2077 6974 6820 2869 6e63 6c75  tart with (inclu
+0001e670: 7369 7665 292e 0a20 2020 2020 2020 2073  sive)..        s
+0001e680: 746f 703a 2074 6865 2063 6f6c 756d 6e20  top: the column 
+0001e690: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
+0001e6a0: 6520 696e 7465 6765 7220 746f 2073 746f  e integer to sto
+0001e6b0: 7020 2869 6e63 6c75 7369 7665 292e 0a20  p (inclusive).. 
+0001e6c0: 2020 2020 2020 2073 7465 703a 2074 6865         step: the
+0001e6d0: 2063 6f6c 756d 6e20 7468 6174 2063 6f6e   column that con
+0001e6e0: 7461 696e 7320 7468 6520 696e 7465 6765  tains the intege
+0001e6f0: 7220 746f 2069 6e63 7265 6d65 6e74 2e0a  r to increment..
+0001e700: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0001e710: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0001e720: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0001e730: 726b 2069 6d70 6f72 7420 526f 770a 2020  rk import Row.  
+0001e740: 2020 2020 2020 3e3e 3e20 6466 3120 3d20        >>> df1 = 
+0001e750: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0001e760: 6174 6166 7261 6d65 285b 282d 322c 2032  ataframe([(-2, 2
+0001e770: 295d 2c20 5b22 6122 2c20 2262 225d 290a  )], ["a", "b"]).
+0001e780: 2020 2020 2020 2020 3e3e 3e20 6466 312e          >>> df1.
+0001e790: 7365 6c65 6374 2873 6571 7565 6e63 6528  select(sequence(
+0001e7a0: 2261 222c 2022 6222 292e 616c 6961 7328  "a", "b").alias(
+0001e7b0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0001e7c0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0001e7d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001e7e0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+0001e7f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001e800: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
+0001e810: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0001e820: 202d 322c 2020 2020 207c 0a20 2020 2020   -2,     |.     
+0001e830: 2020 207c 2020 2d31 2c20 2020 2020 7c0a     |  -1,     |.
+0001e840: 2020 2020 2020 2020 7c20 2030 2c20 2020          |  0,   
+0001e850: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0001e860: 312c 2020 2020 2020 7c0a 2020 2020 2020  1,      |.      
+0001e870: 2020 7c20 2032 2020 2020 2020 207c 0a20    |  2       |. 
+0001e880: 2020 2020 2020 207c 5d20 2020 2020 2020         |]       
+0001e890: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001e8a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001e8b0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0001e8c0: 2020 2020 203e 3e3e 2064 6632 203d 2073       >>> df2 = s
+0001e8d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001e8e0: 7461 6672 616d 6528 5b28 342c 202d 342c  taframe([(4, -4,
+0001e8f0: 202d 3229 5d2c 205b 2261 222c 2022 6222   -2)], ["a", "b"
+0001e900: 2c20 2263 225d 290a 2020 2020 2020 2020  , "c"]).        
+0001e910: 3e3e 3e20 6466 322e 7365 6c65 6374 2873  >>> df2.select(s
+0001e920: 6571 7565 6e63 6528 2261 222c 2022 6222  equence("a", "b"
+0001e930: 2c20 2263 2229 2e61 6c69 6173 2822 7265  , "c").alias("re
+0001e940: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+0001e950: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001e960: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0001e970: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+0001e980: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0001e990: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
+0001e9a0: 207c 0a20 2020 2020 2020 207c 2020 342c   |.        |  4,
+0001e9b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0001e9c0: 7c20 2032 2c20 2020 2020 207c 0a20 2020  |  2,      |.   
+0001e9d0: 2020 2020 207c 2020 302c 2020 2020 2020       |  0,      
+0001e9e0: 7c0a 2020 2020 2020 2020 7c20 202d 322c  |.        |  -2,
+0001e9f0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001ea00: 2020 2d34 2020 2020 2020 7c0a 2020 2020    -4      |.    
+0001ea10: 2020 2020 7c5d 2020 2020 2020 2020 207c      |]         |
+0001ea20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001ea30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0001ea40: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0001ea50: 220a 2020 2020 7374 6172 745f 636f 6c20  ".    start_col 
+0001ea60: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001ea70: 2873 7461 7274 2c20 2273 6571 7565 6e63  (start, "sequenc
+0001ea80: 6522 290a 2020 2020 7374 6f70 5f63 6f6c  e").    stop_col
+0001ea90: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001eaa0: 7228 7374 6f70 2c20 2273 6571 7565 6e63  r(stop, "sequenc
+0001eab0: 6522 290a 2020 2020 6966 2073 7465 7020  e").    if step 
+0001eac0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0001ead0: 2073 7465 7020 3d20 6966 6628 6275 696c   step = iff(buil
+0001eae0: 7469 6e28 2273 6967 6e22 2928 7374 6f70  tin("sign")(stop
+0001eaf0: 5f63 6f6c 202d 2073 7461 7274 5f63 6f6c  _col - start_col
+0001eb00: 2920 3e20 302c 2031 2c20 2d31 290a 2020  ) > 0, 1, -1).  
+0001eb10: 2020 2020 2020 7265 7475 726e 2062 7569        return bui
+0001eb20: 6c74 696e 2822 6172 7261 795f 6765 6e65  ltin("array_gene
+0001eb30: 7261 7465 5f72 616e 6765 2229 2873 7461  rate_range")(sta
+0001eb40: 7274 5f63 6f6c 2c20 7374 6f70 5f63 6f6c  rt_col, stop_col
+0001eb50: 202b 2073 7465 702c 2073 7465 7029 0a20   + step, step). 
+0001eb60: 2020 2073 7465 705f 636f 6c20 3d20 5f74     step_col = _t
+0001eb70: 6f5f 636f 6c5f 6966 5f73 7472 2873 7465  o_col_if_str(ste
+0001eb80: 702c 2022 7365 7175 656e 6365 2229 0a20  p, "sequence"). 
+0001eb90: 2020 2073 7465 705f 7369 676e 203d 2069     step_sign = i
+0001eba0: 6666 2862 7569 6c74 696e 2822 7369 676e  ff(builtin("sign
+0001ebb0: 2229 2873 7465 705f 636f 6c29 203e 2030  ")(step_col) > 0
+0001ebc0: 2c20 312c 202d 3129 0a20 2020 2072 6574  , 1, -1).    ret
+0001ebd0: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
+0001ebe0: 6179 5f67 656e 6572 6174 655f 7261 6e67  ay_generate_rang
+0001ebf0: 6522 2928 7374 6172 745f 636f 6c2c 2073  e")(start_col, s
+0001ec00: 746f 705f 636f 6c20 2b20 7374 6570 5f73  top_col + step_s
+0001ec10: 6967 6e2c 2073 7465 705f 636f 6c29 0a0a  ign, step_col)..
+0001ec20: 0a64 6566 2064 6174 655f 6164 6428 636f  .def date_add(co
+0001ec30: 6c3a 2043 6f6c 756d 6e4f 724e 616d 652c  l: ColumnOrName,
+0001ec40: 206e 756d 5f6f 665f 6461 7973 3a20 556e   num_of_days: Un
+0001ec50: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+0001ec60: 2c20 696e 745d 293a 0a20 2020 2022 2222  , int]):.    """
+0001ec70: 0a20 2020 2041 6464 7320 6120 6e75 6d62  .    Adds a numb
+0001ec80: 6572 206f 6620 6461 7973 2074 6f20 6120  er of days to a 
+0001ec90: 6461 7465 2063 6f6c 756d 6e2e 0a0a 2020  date column...  
+0001eca0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0001ecb0: 636f 6c3a 2054 6865 2063 6f6c 756d 6e20  col: The column 
+0001ecc0: 746f 2061 6464 2074 6f2e 0a20 2020 2020  to add to..     
+0001ecd0: 2020 206e 756d 5f6f 665f 6461 7973 3a20     num_of_days: 
+0001ece0: 5468 6520 6e75 6d62 6572 206f 6620 6461  The number of da
+0001ecf0: 7973 2074 6f20 6164 642e 0a0a 2020 2020  ys to add...    
+0001ed00: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001ed10: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0001ed20: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0001ed30: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0001ed40: 6461 7465 5f61 6464 2c20 746f 5f64 6174  date_add, to_dat
+0001ed50: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0001ed60: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001ed70: 6544 6174 6146 7261 6d65 285b 2822 3139  eDataFrame([("19
+0001ed80: 3736 2d30 312d 3036 2229 5d2c 205b 2264  76-01-06")], ["d
+0001ed90: 6174 6522 5d29 0a20 2020 2020 2020 203e  ate"]).        >
+0001eda0: 3e3e 2064 6620 3d20 6466 2e77 6974 6843  >> df = df.withC
+0001edb0: 6f6c 756d 6e28 2264 6174 6522 2c20 746f  olumn("date", to
+0001edc0: 5f64 6174 6528 2264 6174 6522 2929 0a20  _date("date")). 
+0001edd0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+0001ede0: 2064 662e 7769 7468 436f 6c75 6d6e 2822   df.withColumn("
+0001edf0: 6461 7465 222c 2064 6174 655f 6164 6428  date", date_add(
+0001ee00: 2264 6174 6522 2c20 3429 292e 7368 6f77  "date", 4)).show
+0001ee10: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0001ee20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001ee30: 2020 7c22 4441 5445 2220 2020 2020 207c    |"DATE"      |
+0001ee40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001ee50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001ee60: 7c31 3937 362d 3031 2d31 3020 207c 0a20  |1976-01-10  |. 
+0001ee70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001ee80: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0001ee90: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0001eea0: 220a 2020 2020 2320 436f 6e76 6572 7420  ".    # Convert 
+0001eeb0: 7468 6520 696e 7075 7420 746f 2061 2063  the input to a c
+0001eec0: 6f6c 756d 6e20 6966 2069 7420 6973 2061  olumn if it is a
+0001eed0: 2073 7472 696e 670a 2020 2020 636f 6c20   string.    col 
+0001eee0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001eef0: 2863 6f6c 2c20 2264 6174 655f 6164 6422  (col, "date_add"
+0001ef00: 290a 2020 2020 6e75 6d5f 6f66 5f64 6179  ).    num_of_day
+0001ef10: 7320 3d20 280a 2020 2020 2020 2020 6c69  s = (.        li
+0001ef20: 7428 6e75 6d5f 6f66 5f64 6179 7329 0a20  t(num_of_days). 
+0001ef30: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001ef40: 616e 6365 286e 756d 5f6f 665f 6461 7973  ance(num_of_days
+0001ef50: 2c20 696e 7429 0a20 2020 2020 2020 2065  , int).        e
+0001ef60: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+0001ef70: 7472 286e 756d 5f6f 665f 6461 7973 2c20  tr(num_of_days, 
+0001ef80: 2264 6174 655f 6164 6422 290a 2020 2020  "date_add").    
+0001ef90: 290a 2020 2020 2320 5265 7475 726e 2074  ).    # Return t
+0001efa0: 6865 2064 6174 6561 6464 2066 756e 6374  he dateadd funct
+0001efb0: 696f 6e20 7769 7468 2074 6865 2063 6f6c  ion with the col
+0001efc0: 756d 6e20 616e 6420 6e75 6d62 6572 206f  umn and number o
+0001efd0: 6620 6461 7973 0a20 2020 2072 6574 7572  f days.    retur
+0001efe0: 6e20 6461 7465 6164 6428 2264 6179 222c  n dateadd("day",
+0001eff0: 206e 756d 5f6f 665f 6461 7973 2c20 636f   num_of_days, co
+0001f000: 6c29 0a0a 0a64 6566 2064 6174 655f 7375  l)...def date_su
+0001f010: 6228 636f 6c3a 2043 6f6c 756d 6e4f 724e  b(col: ColumnOrN
+0001f020: 616d 652c 206e 756d 5f6f 665f 6461 7973  ame, num_of_days
+0001f030: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+0001f040: 4e61 6d65 2c20 696e 745d 293a 0a20 2020  Name, int]):.   
+0001f050: 2022 2222 0a20 2020 2053 7562 7472 6163   """.    Subtrac
+0001f060: 7473 2061 206e 756d 6265 7220 6f66 2064  ts a number of d
+0001f070: 6179 7320 6672 6f6d 2061 2064 6174 6520  ays from a date 
+0001f080: 636f 6c75 6d6e 2e0a 0a20 2020 2041 7267  column...    Arg
+0001f090: 733a 0a20 2020 2020 2020 2063 6f6c 3a20  s:.        col: 
+0001f0a0: 5468 6520 636f 6c75 6d6e 2074 6f20 7375  The column to su
+0001f0b0: 6274 7261 6374 2066 726f 6d2e 0a20 2020  btract from..   
+0001f0c0: 2020 2020 206e 756d 5f6f 665f 6461 7973       num_of_days
+0001f0d0: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
+0001f0e0: 6461 7973 2074 6f20 7375 6274 7261 6374  days to subtract
+0001f0f0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0001f100: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+0001f110: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0001f120: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+0001f130: 696d 706f 7274 2064 6174 655f 7375 622c  import date_sub,
+0001f140: 2074 6f5f 6461 7465 0a20 2020 2020 2020   to_date.       
+0001f150: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0001f160: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
+0001f170: 6528 5b28 2231 3937 362d 3031 2d30 3622  e([("1976-01-06"
+0001f180: 295d 2c20 5b22 6461 7465 225d 290a 2020  )], ["date"]).  
+0001f190: 2020 2020 2020 3e3e 3e20 6466 203d 2064        >>> df = d
+0001f1a0: 662e 7769 7468 436f 6c75 6d6e 2822 6461  f.withColumn("da
+0001f1b0: 7465 222c 2074 6f5f 6461 7465 2822 6461  te", to_date("da
+0001f1c0: 7465 2229 290a 2020 2020 2020 2020 3e3e  te")).        >>
+0001f1d0: 3e20 6466 2e77 6974 6843 6f6c 756d 6e28  > df.withColumn(
+0001f1e0: 2264 6174 6522 2c20 6461 7465 5f73 7562  "date", date_sub
+0001f1f0: 2822 6461 7465 222c 2032 2929 2e73 686f  ("date", 2)).sho
+0001f200: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0001f210: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001f220: 2020 207c 2244 4154 4522 2020 2020 2020     |"DATE"      
+0001f230: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0001f240: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001f250: 207c 3139 3736 2d30 312d 3034 2020 7c0a   |1976-01-04  |.
+0001f260: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f270: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0001f280: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0001f290: 2222 0a20 2020 2023 2043 6f6e 7665 7274  "".    # Convert
+0001f2a0: 2074 6865 2069 6e70 7574 2070 6172 616d   the input param
+0001f2b0: 6574 6572 7320 746f 2074 6865 2061 7070  eters to the app
+0001f2c0: 726f 7072 6961 7465 2074 7970 650a 2020  ropriate type.  
+0001f2d0: 2020 636f 6c20 3d20 5f74 6f5f 636f 6c5f    col = _to_col_
+0001f2e0: 6966 5f73 7472 2863 6f6c 2c20 2264 6174  if_str(col, "dat
+0001f2f0: 655f 7375 6222 290a 2020 2020 6e75 6d5f  e_sub").    num_
+0001f300: 6f66 5f64 6179 7320 3d20 280a 2020 2020  of_days = (.    
+0001f310: 2020 2020 6c69 7428 6e75 6d5f 6f66 5f64      lit(num_of_d
+0001f320: 6179 7329 0a20 2020 2020 2020 2069 6620  ays).        if 
+0001f330: 6973 696e 7374 616e 6365 286e 756d 5f6f  isinstance(num_o
+0001f340: 665f 6461 7973 2c20 696e 7429 0a20 2020  f_days, int).   
+0001f350: 2020 2020 2065 6c73 6520 5f74 6f5f 636f       else _to_co
+0001f360: 6c5f 6966 5f73 7472 286e 756d 5f6f 665f  l_if_str(num_of_
+0001f370: 6461 7973 2c20 2264 6174 655f 7375 6222  days, "date_sub"
+0001f380: 290a 2020 2020 290a 2020 2020 2320 5265  ).    ).    # Re
+0001f390: 7475 726e 2074 6865 2064 6174 6520 636f  turn the date co
+0001f3a0: 6c75 6d6e 2077 6974 6820 7468 6520 6e75  lumn with the nu
+0001f3b0: 6d62 6572 206f 6620 6461 7973 2073 7562  mber of days sub
+0001f3c0: 7472 6163 7465 640a 2020 2020 7265 7475  tracted.    retu
+0001f3d0: 726e 2064 6174 6561 6464 2822 6461 7922  rn dateadd("day"
+0001f3e0: 2c20 2d31 202a 206e 756d 5f6f 665f 6461  , -1 * num_of_da
+0001f3f0: 7973 2c20 636f 6c29 0a0a 0a64 6566 2064  ys, col)...def d
+0001f400: 6174 6564 6966 6628 7061 7274 3a20 7374  atediff(part: st
+0001f410: 722c 2063 6f6c 313a 2043 6f6c 756d 6e4f  r, col1: ColumnO
+0001f420: 724e 616d 652c 2063 6f6c 323a 2043 6f6c  rName, col2: Col
+0001f430: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0001f440: 6c75 6d6e 3a0a 2020 2020 2222 2243 616c  lumn:.    """Cal
+0001f450: 6375 6c61 7465 7320 7468 6520 6469 6666  culates the diff
+0001f460: 6572 656e 6365 2062 6574 7765 656e 2074  erence between t
+0001f470: 776f 2064 6174 652c 2074 696d 652c 206f  wo date, time, o
+0001f480: 7220 7469 6d65 7374 616d 7020 636f 6c75  r timestamp colu
+0001f490: 6d6e 7320 6261 7365 6420 6f6e 2074 6865  mns based on the
+0001f4a0: 2064 6174 6520 6f72 2074 696d 6520 7061   date or time pa
+0001f4b0: 7274 2072 6571 7565 7374 6564 2e0a 0a20  rt requested... 
+0001f4c0: 2020 2060 5375 7070 6f72 7465 6420 6461     `Supported da
+0001f4d0: 7465 2061 6e64 2074 696d 6520 7061 7274  te and time part
+0001f4e0: 7320 3c68 7474 7073 3a2f 2f64 6f63 732e  s <https://docs.
+0001f4f0: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
+0001f500: 2f73 716c 2d72 6566 6572 656e 6365 2f66  /sql-reference/f
+0001f510: 756e 6374 696f 6e73 2d64 6174 652d 7469  unctions-date-ti
+0001f520: 6d65 2e68 746d 6c23 6c61 6265 6c2d 7375  me.html#label-su
+0001f530: 7070 6f72 7465 642d 6461 7465 2d74 696d  pported-date-tim
+0001f540: 652d 7061 7274 733e 605f 0a0a 2020 2020  e-parts>`_..    
+0001f550: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001f560: 2020 203e 3e3e 2023 2079 6561 7220 6469     >>> # year di
+0001f570: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
+0001f580: 2074 776f 2064 6174 6520 636f 6c75 6d6e   two date column
+0001f590: 730a 2020 2020 2020 2020 3e3e 3e20 696d  s.        >>> im
+0001f5a0: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
+0001f5b0: 2020 2020 2020 3e3e 3e20 6461 7465 5f64        >>> date_d
+0001f5c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0001f5d0: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
+0001f5e0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+0001f5f0: 302c 2031 2c20 3129 2c20 6461 7465 7469  0, 1, 1), dateti
+0001f600: 6d65 2e64 6174 6528 3230 3231 2c20 312c  me.date(2021, 1,
+0001f610: 2031 295d 5d2c 2073 6368 656d 613d 5b22   1)]], schema=["
+0001f620: 6461 7465 5f63 6f6c 3122 2c20 2264 6174  date_col1", "dat
+0001f630: 655f 636f 6c32 225d 290a 2020 2020 2020  e_col2"]).      
+0001f640: 2020 3e3e 3e20 6461 7465 5f64 662e 7365    >>> date_df.se
+0001f650: 6c65 6374 2864 6174 6564 6966 6628 2279  lect(datediff("y
+0001f660: 6561 7222 2c20 636f 6c28 2264 6174 655f  ear", col("date_
+0001f670: 636f 6c31 2229 2c20 636f 6c28 2264 6174  col1"), col("dat
+0001f680: 655f 636f 6c32 2229 292e 616c 6961 7328  e_col2")).alias(
+0001f690: 2279 6561 725f 6469 6666 2229 292e 7368  "year_diff")).sh
+0001f6a0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0001f6b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001f6c0: 2020 2020 207c 2259 4541 525f 4449 4646       |"YEAR_DIFF
+0001f6d0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0001f6e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001f6f0: 2020 2020 207c 3120 2020 2020 2020 2020       |1         
+0001f700: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0001f710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001f720: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0001f730: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+0001f740: 2020 2020 7061 7274 3a20 5468 6520 7469      part: The ti
+0001f750: 6d65 2070 6172 7420 746f 2075 7365 2066  me part to use f
+0001f760: 6f72 2063 616c 6375 6c61 7469 6e67 2074  or calculating t
+0001f770: 6865 2064 6966 6665 7265 6e63 650a 2020  he difference.  
+0001f780: 2020 2020 2020 636f 6c31 3a20 5468 6520        col1: The 
+0001f790: 6669 7273 7420 7469 6d65 7374 616d 7020  first timestamp 
+0001f7a0: 636f 6c75 6d6e 206f 7220 6d69 6e75 656e  column or minuen
+0001f7b0: 6420 696e 2074 6865 2064 6174 6564 6966  d in the datedif
+0001f7c0: 660a 2020 2020 2020 2020 636f 6c32 3a20  f.        col2: 
+0001f7d0: 5468 6520 7365 636f 6e64 2074 696d 6573  The second times
+0001f7e0: 7461 6d70 2063 6f6c 756d 6e20 6f72 2074  tamp column or t
+0001f7f0: 6865 2073 7562 7472 6168 656e 6420 696e  he subtrahend in
+0001f800: 2074 6865 2064 6174 6564 6966 660a 2020   the datediff.  
+0001f810: 2020 2222 220a 2020 2020 6966 206e 6f74    """.    if not
+0001f820: 2069 7369 6e73 7461 6e63 6528 7061 7274   isinstance(part
+0001f830: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+0001f840: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001f850: 2822 7061 7274 206d 7573 7420 6265 2061  ("part must be a
+0001f860: 2073 7472 696e 6722 290a 2020 2020 6331   string").    c1
+0001f870: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001f880: 7228 636f 6c31 2c20 2264 6174 6564 6966  r(col1, "datedif
+0001f890: 6622 290a 2020 2020 6332 203d 205f 746f  f").    c2 = _to
+0001f8a0: 5f63 6f6c 5f69 665f 7374 7228 636f 6c32  _col_if_str(col2
+0001f8b0: 2c20 2264 6174 6564 6966 6622 290a 2020  , "datediff").  
+0001f8c0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001f8d0: 2822 6461 7465 6469 6666 2229 2870 6172  ("datediff")(par
+0001f8e0: 742c 2063 312c 2063 3229 0a0a 0a64 6566  t, c1, c2)...def
+0001f8f0: 2064 6179 6469 6666 2863 6f6c 313a 2043   daydiff(col1: C
+0001f900: 6f6c 756d 6e4f 724e 616d 652c 2063 6f6c  olumnOrName, col
+0001f910: 323a 2043 6f6c 756d 6e4f 724e 616d 6529  2: ColumnOrName)
+0001f920: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0001f930: 2222 2243 616c 6375 6c61 7465 7320 7468  """Calculates th
+0001f940: 6520 6469 6666 6572 656e 6365 2062 6574  e difference bet
+0001f950: 7765 656e 2074 776f 2064 6174 6573 2c20  ween two dates, 
+0001f960: 6f72 2074 696d 6573 7461 6d70 2063 6f6c  or timestamp col
+0001f970: 756d 6e73 2062 6173 6564 2069 6e20 6461  umns based in da
+0001f980: 7973 2e0a 2020 2020 5468 6520 7265 7375  ys..    The resu
+0001f990: 6c74 2077 696c 6c20 7265 666c 6563 7420  lt will reflect 
+0001f9a0: 7468 6520 6469 6666 6572 656e 6365 2062  the difference b
+0001f9b0: 6574 7765 656e 2063 6f6c 3220 2d20 636f  etween col2 - co
+0001f9c0: 6c31 0a0a 2020 2020 4578 616d 706c 653a  l1..    Example:
+0001f9d0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+0001f9e0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0001f9f0: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+0001fa00: 696d 706f 7274 2064 6179 6469 6666 2c20  import daydiff, 
+0001fa10: 746f 5f64 6174 650a 2020 2020 2020 2020  to_date.        
+0001fa20: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0001fa30: 2e63 7265 6174 6544 6174 6146 7261 6d65  .createDataFrame
+0001fa40: 285b 2822 3230 3135 2d30 342d 3038 222c  ([("2015-04-08",
+0001fa50: 2022 3230 3135 2d30 352d 3130 2229 5d2c   "2015-05-10")],
+0001fa60: 205b 2264 3122 2c20 2264 3222 5d29 0a20   ["d1", "d2"]). 
+0001fa70: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+0001fa80: 2064 662e 7365 6c65 6374 2864 6179 6469   df.select(daydi
+0001fa90: 6666 2874 6f5f 6461 7465 2864 662e 6432  ff(to_date(df.d2
+0001faa0: 292c 2074 6f5f 6461 7465 2864 662e 6431  ), to_date(df.d1
+0001fab0: 2929 2e61 6c69 6173 2822 6469 6666 2229  )).alias("diff")
+0001fac0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0001fad0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0001fae0: 2020 2020 7c22 4449 4646 2220 207c 0a20      |"DIFF"  |. 
+0001faf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001fb00: 2d0a 2020 2020 2020 2020 7c33 3220 2020  -.        |32   
+0001fb10: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0001fb20: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001fb30: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0001fb40: 2222 220a 2020 2020 636f 6c31 203d 205f  """.    col1 = _
+0001fb50: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+0001fb60: 6c31 2c20 2264 6179 6469 6666 2229 0a20  l1, "daydiff"). 
+0001fb70: 2020 2063 6f6c 3220 3d20 5f74 6f5f 636f     col2 = _to_co
+0001fb80: 6c5f 6966 5f73 7472 2863 6f6c 322c 2022  l_if_str(col2, "
+0001fb90: 6461 7964 6966 6622 290a 2020 2020 7265  daydiff").    re
+0001fba0: 7475 726e 2062 7569 6c74 696e 2822 6461  turn builtin("da
+0001fbb0: 7465 6469 6666 2229 286c 6974 2822 6461  tediff")(lit("da
+0001fbc0: 7922 292c 2063 6f6c 322c 2063 6f6c 3129  y"), col2, col1)
+0001fbd0: 0a0a 0a64 6566 2074 7275 6e63 2865 3a20  ...def trunc(e: 
+0001fbe0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7363  ColumnOrName, sc
+0001fbf0: 616c 653a 2055 6e69 6f6e 5b43 6f6c 756d  ale: Union[Colum
+0001fc00: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
+0001fc10: 6f61 745d 203d 2030 2920 2d3e 2043 6f6c  oat] = 0) -> Col
+0001fc20: 756d 6e3a 0a20 2020 2022 2222 526f 756e  umn:.    """Roun
+0001fc30: 6473 2074 6865 2069 6e70 7574 2065 7870  ds the input exp
+0001fc40: 7265 7373 696f 6e20 646f 776e 2074 6f20  ression down to 
+0001fc50: 7468 6520 6e65 6172 6573 7420 286f 7220  the nearest (or 
+0001fc60: 6571 7561 6c29 2069 6e74 6567 6572 2063  equal) integer c
+0001fc70: 6c6f 7365 7220 746f 207a 6572 6f2c 0a20  loser to zero,. 
+0001fc80: 2020 206f 7220 746f 2074 6865 206e 6561     or to the nea
+0001fc90: 7265 7374 2065 7175 616c 206f 7220 736d  rest equal or sm
+0001fca0: 616c 6c65 7220 7661 6c75 6520 7769 7468  aller value with
+0001fcb0: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
+0001fcc0: 756d 6265 7220 6f66 0a20 2020 2070 6c61  umber of.    pla
+0001fcd0: 6365 7320 6166 7465 7220 7468 6520 6465  ces after the de
+0001fce0: 6369 6d61 6c20 706f 696e 742e 0a0a 2020  cimal point...  
+0001fcf0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0001fd00: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0001fd10: 7373 696f 6e2e 6372 6561 7465 4461 7461  ssion.createData
+0001fd20: 4672 616d 6528 5b2d 312e 302c 202d 302e  Frame([-1.0, -0.
+0001fd30: 392c 202d 2e35 2c20 2d2e 322c 2030 2e30  9, -.5, -.2, 0.0
+0001fd40: 2c20 302e 322c 2030 2e35 2c20 302e 392c  , 0.2, 0.5, 0.9,
+0001fd50: 2031 2e31 2c20 332e 3134 3135 395d 2c20   1.1, 3.14159], 
+0001fd60: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+0001fd70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0001fd80: 6563 7428 7472 756e 6328 636f 6c28 2261  ect(trunc(col("a
+0001fd90: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+0001fda0: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
+0001fdb0: 4328 2241 222c 2030 293d 2d31 2e30 292c  C("A", 0)=-1.0),
+0001fdc0: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
+0001fdd0: 3029 3d30 2e30 292c 2052 6f77 2854 5255  0)=0.0), Row(TRU
+0001fde0: 4e43 2822 4122 2c20 3029 3d30 2e30 292c  NC("A", 0)=0.0),
+0001fdf0: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
+0001fe00: 3029 3d30 2e30 292c 2052 6f77 2854 5255  0)=0.0), Row(TRU
+0001fe10: 4e43 2822 4122 2c20 3029 3d30 2e30 292c  NC("A", 0)=0.0),
+0001fe20: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
+0001fe30: 3029 3d30 2e30 292c 2052 6f77 2854 5255  0)=0.0), Row(TRU
+0001fe40: 4e43 2822 4122 2c20 3029 3d30 2e30 292c  NC("A", 0)=0.0),
+0001fe50: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
+0001fe60: 3029 3d30 2e30 292c 2052 6f77 2854 5255  0)=0.0), Row(TRU
+0001fe70: 4e43 2822 4122 2c20 3029 3d31 2e30 292c  NC("A", 0)=1.0),
+0001fe80: 2052 6f77 2854 5255 4e43 2822 4122 2c20   Row(TRUNC("A", 
+0001fe90: 3029 3d33 2e30 295d 0a0a 2020 2020 2020  0)=3.0)]..      
+0001fea0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0001feb0: 6f6e 2e63 7265 6174 6544 6174 6146 7261  on.createDataFra
+0001fec0: 6d65 285b 2d31 2e33 3233 2c20 342e 3536  me([-1.323, 4.56
+0001fed0: 372c 2030 2e30 3132 335d 2c20 7363 6865  7, 0.0123], sche
+0001fee0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001fef0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001ff00: 7472 756e 6328 636f 6c28 2261 2229 2c20  trunc(col("a"), 
+0001ff10: 6c69 7428 3029 2929 2e63 6f6c 6c65 6374  lit(0))).collect
+0001ff20: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0001ff30: 5452 554e 4328 2241 222c 2030 293d 2d31  TRUNC("A", 0)=-1
+0001ff40: 2e30 292c 2052 6f77 2854 5255 4e43 2822  .0), Row(TRUNC("
+0001ff50: 4122 2c20 3029 3d34 2e30 292c 2052 6f77  A", 0)=4.0), Row
+0001ff60: 2854 5255 4e43 2822 4122 2c20 3029 3d30  (TRUNC("A", 0)=0
+0001ff70: 2e30 295d 0a20 2020 2020 2020 203e 3e3e  .0)].        >>>
+0001ff80: 2064 662e 7365 6c65 6374 2874 7275 6e63   df.select(trunc
+0001ff90: 2863 6f6c 2822 6122 292c 206c 6974 2831  (col("a"), lit(1
+0001ffa0: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+0001ffb0: 2020 2020 2020 5b52 6f77 2854 5255 4e43        [Row(TRUNC
+0001ffc0: 2822 4122 2c20 3129 3d2d 312e 3329 2c20  ("A", 1)=-1.3), 
+0001ffd0: 526f 7728 5452 554e 4328 2241 222c 2031  Row(TRUNC("A", 1
+0001ffe0: 293d 342e 3529 2c20 526f 7728 5452 554e  )=4.5), Row(TRUN
+0001fff0: 4328 2241 222c 2031 293d 302e 3029 5d0a  C("A", 1)=0.0)].
+00020000: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00020010: 656c 6563 7428 7472 756e 6328 636f 6c28  elect(trunc(col(
+00020020: 2261 2229 2c20 6c69 7428 3229 2929 2e63  "a"), lit(2))).c
+00020030: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00020040: 205b 526f 7728 5452 554e 4328 2241 222c   [Row(TRUNC("A",
+00020050: 2032 293d 2d31 2e33 3229 2c20 526f 7728   2)=-1.32), Row(
+00020060: 5452 554e 4328 2241 222c 2032 293d 342e  TRUNC("A", 2)=4.
+00020070: 3536 292c 2052 6f77 2854 5255 4e43 2822  56), Row(TRUNC("
+00020080: 4122 2c20 3229 3d30 2e30 3129 5d0a 0a20  A", 2)=0.01)].. 
+00020090: 2020 204e 6f74 6520 7468 6174 2074 6865     Note that the
+000200a0: 2066 756e 6374 696f 6e20 6060 7472 756e   function ``trun
+000200b0: 6360 6020 6973 206f 7665 726c 6f61 6465  c`` is overloade
+000200c0: 6420 7769 7468 2060 6064 6174 655f 7472  d with ``date_tr
+000200d0: 756e 6360 6020 666f 7220 6461 7465 7469  unc`` for dateti
+000200e0: 6d65 2074 7970 6573 2e20 4974 2061 6c6c  me types. It all
+000200f0: 6f77 7320 746f 2072 6f75 6e64 2064 6174  ows to round dat
+00020100: 6574 696d 650a 2020 2020 6f62 6a65 6374  etime.    object
+00020110: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00020120: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
+00020130: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+00020140: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00020150: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
+00020160: 7461 4672 616d 6528 5b64 6174 6574 696d  taFrame([datetim
+00020170: 652e 6461 7465 2832 3032 322c 2031 322c  e.date(2022, 12,
+00020180: 2032 3529 2c20 6461 7465 7469 6d65 2e64   25), datetime.d
+00020190: 6174 6528 3230 3232 2c20 312c 2031 3029  ate(2022, 1, 10)
+000201a0: 2c20 6461 7465 7469 6d65 2e64 6174 6528  , datetime.date(
+000201b0: 3230 3232 2c20 372c 2037 295d 2c20 7363  2022, 7, 7)], sc
+000201c0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+000201d0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000201e0: 7428 7472 756e 6328 636f 6c28 2261 2229  t(trunc(col("a")
+000201f0: 2c20 6c69 7428 2251 5541 5254 4552 2229  , lit("QUARTER")
+00020200: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00020210: 2020 2020 205b 526f 7728 5452 554e 4328       [Row(TRUNC(
+00020220: 2241 222c 2027 5155 4152 5445 5227 293d  "A", 'QUARTER')=
+00020230: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
+00020240: 3232 2c20 3130 2c20 3129 292c 2052 6f77  22, 10, 1)), Row
+00020250: 2854 5255 4e43 2822 4122 2c20 2751 5541  (TRUNC("A", 'QUA
+00020260: 5254 4552 2729 3d64 6174 6574 696d 652e  RTER')=datetime.
+00020270: 6461 7465 2832 3032 322c 2031 2c20 3129  date(2022, 1, 1)
+00020280: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
+00020290: 2c20 2751 5541 5254 4552 2729 3d64 6174  , 'QUARTER')=dat
+000202a0: 6574 696d 652e 6461 7465 2832 3032 322c  etime.date(2022,
+000202b0: 2037 2c20 3129 295d 0a0a 2020 2020 2020   7, 1))]..      
+000202c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000202d0: 6f6e 2e63 7265 6174 6544 6174 6146 7261  on.createDataFra
+000202e0: 6d65 285b 6461 7465 7469 6d65 2e64 6174  me([datetime.dat
+000202f0: 6574 696d 6528 3230 3232 2c20 3132 2c20  etime(2022, 12, 
+00020300: 3235 2c20 3133 2c20 3539 2c20 3338 2c20  25, 13, 59, 38, 
+00020310: 3436 3729 5d2c 2073 6368 656d 613d 5b22  467)], schema=["
+00020320: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00020330: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+00020340: 2020 2020 2020 5b52 6f77 2841 3d64 6174        [Row(A=dat
+00020350: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00020360: 3032 322c 2031 322c 2032 352c 2031 332c  022, 12, 25, 13,
+00020370: 2035 392c 2033 382c 2034 3637 2929 5d0a   59, 38, 467))].
+00020380: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00020390: 656c 6563 7428 7472 756e 6328 636f 6c28  elect(trunc(col(
+000203a0: 2261 2229 2c20 6c69 7428 224d 494e 5554  "a"), lit("MINUT
+000203b0: 4522 2929 292e 636f 6c6c 6563 7428 290a  E"))).collect().
+000203c0: 2020 2020 2020 2020 5b52 6f77 2854 5255          [Row(TRU
+000203d0: 4e43 2822 4122 2c20 274d 494e 5554 4527  NC("A", 'MINUTE'
+000203e0: 293d 6461 7465 7469 6d65 2e64 6174 6574  )=datetime.datet
+000203f0: 696d 6528 3230 3232 2c20 3132 2c20 3235  ime(2022, 12, 25
+00020400: 2c20 3133 2c20 3539 2929 5d0a 0a20 2020  , 13, 59))]..   
+00020410: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00020420: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00020430: 7472 756e 6322 290a 2020 2020 7363 616c  trunc").    scal
+00020440: 655f 636f 6c20 3d20 280a 2020 2020 2020  e_col = (.      
+00020450: 2020 6c69 7428 7363 616c 6529 0a20 2020    lit(scale).   
+00020460: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00020470: 6365 2873 6361 6c65 2c20 2869 6e74 2c20  ce(scale, (int, 
+00020480: 666c 6f61 7429 290a 2020 2020 2020 2020  float)).        
+00020490: 656c 7365 205f 746f 5f63 6f6c 5f69 665f  else _to_col_if_
+000204a0: 7374 7228 7363 616c 652c 2022 7472 756e  str(scale, "trun
+000204b0: 6322 290a 2020 2020 290a 2020 2020 7265  c").    ).    re
+000204c0: 7475 726e 2062 7569 6c74 696e 2822 7472  turn builtin("tr
+000204d0: 756e 6322 2928 632c 2073 6361 6c65 5f63  unc")(c, scale_c
+000204e0: 6f6c 290a 0a0a 6465 6620 6461 7465 6164  ol)...def datead
+000204f0: 6428 7061 7274 3a20 7374 722c 2063 6f6c  d(part: str, col
+00020500: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
+00020510: 2063 6f6c 323a 2043 6f6c 756d 6e4f 724e   col2: ColumnOrN
+00020520: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00020530: 2020 2020 2222 2241 6464 7320 7468 6520      """Adds the 
+00020540: 7370 6563 6966 6965 6420 7661 6c75 6520  specified value 
+00020550: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
+00020560: 6420 6461 7465 206f 7220 7469 6d65 2070  d date or time p
+00020570: 6172 7420 746f 2064 6174 6520 6f72 2074  art to date or t
+00020580: 696d 6520 6578 7072 2e0a 0a20 2020 2060  ime expr...    `
+00020590: 5375 7070 6f72 7465 6420 6461 7465 2061  Supported date a
+000205a0: 6e64 2074 696d 6520 7061 7274 7320 3c68  nd time parts <h
+000205b0: 7474 7073 3a2f 2f64 6f63 732e 736e 6f77  ttps://docs.snow
+000205c0: 666c 616b 652e 636f 6d2f 656e 2f73 716c  flake.com/en/sql
+000205d0: 2d72 6566 6572 656e 6365 2f66 756e 6374  -reference/funct
+000205e0: 696f 6e73 2d64 6174 652d 7469 6d65 2e68  ions-date-time.h
+000205f0: 746d 6c23 6c61 6265 6c2d 7375 7070 6f72  tml#label-suppor
+00020600: 7465 642d 6461 7465 2d74 696d 652d 7061  ted-date-time-pa
+00020610: 7274 733e 605f 0a0a 2020 2020 4578 616d  rts>`_..    Exam
+00020620: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00020630: 3e3e 2023 2061 6464 206f 6e65 2079 6561  >> # add one yea
+00020640: 7220 6f6e 2064 6174 6573 0a20 2020 2020  r on dates.     
+00020650: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00020660: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+00020670: 3e3e 2064 6174 655f 6466 203d 2073 6573  >> date_df = ses
+00020680: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00020690: 6672 616d 6528 5b5b 6461 7465 7469 6d65  frame([[datetime
+000206a0: 2e64 6174 6528 3230 3230 2c20 312c 2031  .date(2020, 1, 1
+000206b0: 295d 5d2c 2073 6368 656d 613d 5b22 6461  )]], schema=["da
+000206c0: 7465 5f63 6f6c 225d 290a 2020 2020 2020  te_col"]).      
+000206d0: 2020 3e3e 3e20 6461 7465 5f64 662e 7365    >>> date_df.se
+000206e0: 6c65 6374 2864 6174 6561 6464 2822 7965  lect(dateadd("ye
+000206f0: 6172 222c 206c 6974 2831 292c 2063 6f6c  ar", lit(1), col
+00020700: 2822 6461 7465 5f63 6f6c 2229 292e 616c  ("date_col")).al
+00020710: 6961 7328 2279 6561 725f 6164 6465 6422  ias("year_added"
+00020720: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00020730: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00020740: 2d2d 0a20 2020 2020 2020 207c 2259 4541  --.        |"YEA
+00020750: 525f 4144 4445 4422 2020 7c0a 2020 2020  R_ADDED"  |.    
+00020760: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00020770: 2d2d 2d2d 0a20 2020 2020 2020 207c 3230  ----.        |20
+00020780: 3231 2d30 312d 3031 2020 2020 7c0a 2020  21-01-01    |.  
+00020790: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000207a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+000207b0: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
+000207c0: 2020 203e 3e3e 2064 6174 655f 6466 2e73     >>> date_df.s
+000207d0: 656c 6563 7428 6461 7465 6164 6428 226d  elect(dateadd("m
+000207e0: 6f6e 7468 222c 206c 6974 2831 292c 2063  onth", lit(1), c
+000207f0: 6f6c 2822 6461 7465 5f63 6f6c 2229 292e  ol("date_col")).
+00020800: 616c 6961 7328 226d 6f6e 7468 5f61 6464  alias("month_add
+00020810: 6564 2229 292e 7368 6f77 2829 0a20 2020  ed")).show().   
+00020820: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00020830: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00020840: 224d 4f4e 5448 5f41 4444 4544 2220 207c  "MONTH_ADDED"  |
+00020850: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00020860: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00020870: 2020 207c 3230 3230 2d30 322d 3031 2020     |2020-02-01  
+00020880: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00020890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+000208a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000208b0: 453e 0a20 2020 2020 2020 203e 3e3e 2064  E>.        >>> d
+000208c0: 6174 655f 6466 2e73 656c 6563 7428 6461  ate_df.select(da
+000208d0: 7465 6164 6428 2264 6179 222c 206c 6974  teadd("day", lit
+000208e0: 2831 292c 2063 6f6c 2822 6461 7465 5f63  (1), col("date_c
+000208f0: 6f6c 2229 292e 616c 6961 7328 2264 6179  ol")).alias("day
+00020900: 5f61 6464 6564 2229 292e 7368 6f77 2829  _added")).show()
+00020910: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00020920: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00020930: 207c 2244 4159 5f41 4444 4544 2220 207c   |"DAY_ADDED"  |
+00020940: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00020950: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00020960: 207c 3230 3230 2d30 312d 3032 2020 207c   |2020-01-02   |
+00020970: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00020980: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00020990: 203c 424c 414e 4b4c 494e 453e 0a0a 2020   <BLANKLINE>..  
+000209a0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+000209b0: 7061 7274 3a20 5468 6520 7469 6d65 2070  part: The time p
+000209c0: 6172 7420 746f 2075 7365 2066 6f72 2074  art to use for t
+000209d0: 6865 2061 6464 6974 696f 6e0a 2020 2020  he addition.    
+000209e0: 2020 2020 636f 6c31 3a20 5468 6520 6669      col1: The fi
+000209f0: 7273 7420 7469 6d65 7374 616d 7020 636f  rst timestamp co
+00020a00: 6c75 6d6e 206f 7220 6164 6465 6e64 2069  lumn or addend i
+00020a10: 6e20 7468 6520 6461 7465 6164 640a 2020  n the dateadd.  
+00020a20: 2020 2020 2020 636f 6c32 3a20 5468 6520        col2: The 
+00020a30: 7365 636f 6e64 2074 696d 6573 7461 6d70  second timestamp
+00020a40: 2063 6f6c 756d 6e20 6f72 2074 6865 2061   column or the a
+00020a50: 6464 656e 6420 696e 2074 6865 2064 6174  ddend in the dat
+00020a60: 6561 6464 0a20 2020 2022 2222 0a20 2020  eadd.    """.   
+00020a70: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00020a80: 6365 2870 6172 742c 2073 7472 293a 0a20  ce(part, str):. 
+00020a90: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00020aa0: 7565 4572 726f 7228 2270 6172 7420 6d75  ueError("part mu
+00020ab0: 7374 2062 6520 6120 7374 7269 6e67 2229  st be a string")
+00020ac0: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
+00020ad0: 6c5f 6966 5f73 7472 2863 6f6c 312c 2022  l_if_str(col1, "
+00020ae0: 6461 7465 6164 6422 290a 2020 2020 6332  dateadd").    c2
+00020af0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00020b00: 7228 636f 6c32 2c20 2264 6174 6561 6464  r(col2, "dateadd
+00020b10: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00020b20: 696c 7469 6e28 2264 6174 6561 6464 2229  iltin("dateadd")
+00020b30: 2870 6172 742c 2063 312c 2063 3229 0a0a  (part, c1, c2)..
+00020b40: 0a64 6566 2064 6174 655f 7061 7274 2870  .def date_part(p
+00020b50: 6172 743a 2073 7472 2c20 653a 2043 6f6c  art: str, e: Col
+00020b60: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00020b70: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00020b80: 2020 4578 7472 6163 7473 2074 6865 2073    Extracts the s
+00020b90: 7065 6369 6669 6564 2064 6174 6520 6f72  pecified date or
+00020ba0: 2074 696d 6520 7061 7274 2066 726f 6d20   time part from 
+00020bb0: 6120 6461 7465 2c20 7469 6d65 2c20 6f72  a date, time, or
+00020bc0: 2074 696d 6573 7461 6d70 2e20 5365 650a   timestamp. See.
+00020bd0: 2020 2020 6044 4154 455f 5041 5254 203c      `DATE_PART <
+00020be0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+00020bf0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+00020c00: 6c2d 7265 6665 7265 6e63 652f 6675 6e63  l-reference/func
+00020c10: 7469 6f6e 732f 6461 7465 5f70 6172 742e  tions/date_part.
+00020c20: 6874 6d6c 3e60 5f20 666f 7220 6465 7461  html>`_ for deta
+00020c30: 696c 732e 0a0a 2020 2020 4172 6773 3a0a  ils...    Args:.
+00020c40: 2020 2020 2020 2020 7061 7274 3a20 5468          part: Th
+00020c50: 6520 7469 6d65 2070 6172 7420 746f 2075  e time part to u
+00020c60: 7365 2066 6f72 2074 6865 2061 6464 6974  se for the addit
+00020c70: 696f 6e2e 0a20 2020 2020 2020 2065 3a20  ion..        e: 
+00020c80: 5468 6520 636f 6c75 6d6e 2065 7870 7265  The column expre
+00020c90: 7373 696f 6e20 6f66 2061 2064 6174 652c  ssion of a date,
+00020ca0: 2074 696d 652c 206f 7220 7469 6d65 7374   time, or timest
+00020cb0: 616d 702e 0a0a 2020 2020 4578 616d 706c  amp...    Exampl
+00020cc0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00020cd0: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+00020ce0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00020cf0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00020d00: 5f64 6174 6166 7261 6d65 285b 5b64 6174  _dataframe([[dat
+00020d10: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00020d20: 3032 332c 2031 2c20 312c 2031 2c20 312c  023, 1, 1, 1, 1,
+00020d30: 2031 295d 5d2c 2073 6368 656d 613d 5b22   1)]], schema=["
+00020d40: 7473 5f63 6f6c 225d 290a 2020 2020 2020  ts_col"]).      
+00020d50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00020d60: 6461 7465 5f70 6172 7428 2279 6561 7222  date_part("year"
+00020d70: 2c20 636f 6c28 2274 735f 636f 6c22 2929  , col("ts_col"))
+00020d80: 2e61 6c69 6173 2822 7965 6172 2229 2c20  .alias("year"), 
+00020d90: 6461 7465 5f70 6172 7428 2265 706f 6368  date_part("epoch
+00020da0: 5f73 6563 6f6e 6422 2c20 636f 6c28 2274  _second", col("t
+00020db0: 735f 636f 6c22 2929 2e61 6c69 6173 2822  s_col")).alias("
+00020dc0: 6570 6f63 685f 7365 636f 6e64 2229 292e  epoch_second")).
+00020dd0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00020de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00020df0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00020e00: 2020 207c 2259 4541 5222 2020 7c22 4550     |"YEAR"  |"EP
+00020e10: 4f43 485f 5345 434f 4e44 2220 207c 0a20  OCH_SECOND"  |. 
+00020e20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00020e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00020e40: 2d2d 0a20 2020 2020 2020 207c 3230 3233  --.        |2023
+00020e50: 2020 2020 7c31 3637 3235 3334 3836 3120      |1672534861 
+00020e60: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00020e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00020e80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00020e90: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00020ea0: 2020 2022 2222 0a20 2020 2069 6620 6e6f     """.    if no
+00020eb0: 7420 6973 696e 7374 616e 6365 2870 6172  t isinstance(par
+00020ec0: 742c 2073 7472 293a 0a20 2020 2020 2020  t, str):.       
+00020ed0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00020ee0: 7228 2270 6172 7420 6d75 7374 2062 6520  r("part must be 
+00020ef0: 6120 7374 7269 6e67 2229 0a20 2020 2063  a string").    c
+00020f00: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00020f10: 7228 652c 2022 6461 7465 5f70 6172 7422  r(e, "date_part"
+00020f20: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00020f30: 6c74 696e 2822 6461 7465 5f70 6172 7422  ltin("date_part"
+00020f40: 2928 7061 7274 2c20 6329 0a0a 0a64 6566  )(part, c)...def
+00020f50: 2064 6174 655f 6672 6f6d 5f70 6172 7473   date_from_parts
+00020f60: 280a 2020 2020 793a 2055 6e69 6f6e 5b43  (.    y: Union[C
+00020f70: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+00020f80: 5d2c 0a20 2020 206d 3a20 556e 696f 6e5b  ],.    m: Union[
+00020f90: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+00020fa0: 745d 2c0a 2020 2020 643a 2055 6e69 6f6e  t],.    d: Union
+00020fb0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00020fc0: 6e74 5d2c 0a29 202d 3e20 436f 6c75 6d6e  nt],.) -> Column
+00020fd0: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
+00020fe0: 6561 7465 7320 6120 6461 7465 2066 726f  eates a date fro
+00020ff0: 6d20 696e 6469 7669 6475 616c 206e 756d  m individual num
+00021000: 6572 6963 2063 6f6d 706f 6e65 6e74 7320  eric components 
+00021010: 7468 6174 2072 6570 7265 7365 6e74 2074  that represent t
+00021020: 6865 2079 6561 722c 206d 6f6e 7468 2c20  he year, month, 
+00021030: 616e 6420 6461 7920 6f66 2074 6865 206d  and day of the m
+00021040: 6f6e 7468 2e0a 0a20 2020 2045 7861 6d70  onth...    Examp
+00021050: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00021060: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00021070: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00021080: 5b32 3032 322c 2034 2c20 315d 5d2c 2073  [2022, 4, 1]], s
+00021090: 6368 656d 613d 5b22 7965 6172 222c 2022  chema=["year", "
+000210a0: 6d6f 6e74 6822 2c20 2264 6179 225d 290a  month", "day"]).
+000210b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000210c0: 656c 6563 7428 6461 7465 5f66 726f 6d5f  elect(date_from_
+000210d0: 7061 7274 7328 2279 6561 7222 2c20 226d  parts("year", "m
+000210e0: 6f6e 7468 222c 2022 6461 7922 2929 2e63  onth", "day")).c
+000210f0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00021100: 205b 526f 7728 4441 5445 5f46 524f 4d5f   [Row(DATE_FROM_
+00021110: 5041 5254 5328 2259 4541 5222 2c20 224d  PARTS("YEAR", "M
+00021120: 4f4e 5448 222c 2022 4441 5922 293d 6461  ONTH", "DAY")=da
+00021130: 7465 7469 6d65 2e64 6174 6528 3230 3232  tetime.date(2022
+00021140: 2c20 342c 2031 2929 5d0a 2020 2020 2020  , 4, 1))].      
+00021150: 2020 3e3e 3e20 7365 7373 696f 6e2e 7461    >>> session.ta
+00021160: 626c 6528 2264 7561 6c22 292e 7365 6c65  ble("dual").sele
+00021170: 6374 2864 6174 655f 6672 6f6d 5f70 6172  ct(date_from_par
+00021180: 7473 2832 3032 322c 2034 2c20 3129 292e  ts(2022, 4, 1)).
+00021190: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000211a0: 2020 5b52 6f77 2844 4154 455f 4652 4f4d    [Row(DATE_FROM
+000211b0: 5f50 4152 5453 2832 3032 322c 2034 2c20  _PARTS(2022, 4, 
+000211c0: 3129 3d64 6174 6574 696d 652e 6461 7465  1)=datetime.date
+000211d0: 2832 3032 322c 2034 2c20 3129 295d 0a20  (2022, 4, 1))]. 
+000211e0: 2020 2022 2222 0a20 2020 2079 5f63 6f6c     """.    y_col
+000211f0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00021200: 725f 6f72 5f69 6e74 2879 2c20 2264 6174  r_or_int(y, "dat
+00021210: 655f 6672 6f6d 5f70 6172 7473 2229 0a20  e_from_parts"). 
+00021220: 2020 206d 5f63 6f6c 203d 205f 746f 5f63     m_col = _to_c
+00021230: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
+00021240: 286d 2c20 2264 6174 655f 6672 6f6d 5f70  (m, "date_from_p
+00021250: 6172 7473 2229 0a20 2020 2064 5f63 6f6c  arts").    d_col
+00021260: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00021270: 725f 6f72 5f69 6e74 2864 2c20 2264 6174  r_or_int(d, "dat
+00021280: 655f 6672 6f6d 5f70 6172 7473 2229 0a20  e_from_parts"). 
+00021290: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000212a0: 6e28 2264 6174 655f 6672 6f6d 5f70 6172  n("date_from_par
+000212b0: 7473 2229 2879 5f63 6f6c 2c20 6d5f 636f  ts")(y_col, m_co
+000212c0: 6c2c 2064 5f63 6f6c 290a 0a0a 6465 6620  l, d_col)...def 
+000212d0: 6461 7465 5f74 7275 6e63 2870 6172 743a  date_trunc(part:
+000212e0: 2043 6f6c 756d 6e4f 724e 616d 652c 2065   ColumnOrName, e
+000212f0: 7870 723a 2043 6f6c 756d 6e4f 724e 616d  xpr: ColumnOrNam
+00021300: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00021310: 2020 2222 220a 2020 2020 5472 756e 6361    """.    Trunca
+00021320: 7465 7320 6120 4441 5445 2c20 5449 4d45  tes a DATE, TIME
+00021330: 2c20 6f72 2054 494d 4553 5441 4d50 2074  , or TIMESTAMP t
+00021340: 6f20 7468 6520 7370 6563 6966 6965 6420  o the specified 
+00021350: 7072 6563 6973 696f 6e2e 0a0a 2020 2020  precision...    
+00021360: 4e6f 7465 2074 6861 7420 7472 756e 6361  Note that trunca
+00021370: 7469 6f6e 2069 7320 6e6f 7420 7468 6520  tion is not the 
+00021380: 7361 6d65 2061 7320 6578 7472 6163 7469  same as extracti
+00021390: 6f6e 2e20 466f 7220 6578 616d 706c 653a  on. For example:
+000213a0: 0a20 2020 202d 2054 7275 6e63 6174 696e  .    - Truncatin
+000213b0: 6720 6120 7469 6d65 7374 616d 7020 646f  g a timestamp do
+000213c0: 776e 2074 6f20 7468 6520 7175 6172 7465  wn to the quarte
+000213d0: 7220 7265 7475 726e 7320 7468 6520 7469  r returns the ti
+000213e0: 6d65 7374 616d 7020 636f 7272 6573 706f  mestamp correspo
+000213f0: 6e64 696e 6720 746f 206d 6964 6e69 6768  nding to midnigh
+00021400: 7420 6f66 2074 6865 2066 6972 7374 2064  t of the first d
+00021410: 6179 206f 6620 7468 650a 2020 2020 7175  ay of the.    qu
+00021420: 6172 7465 7220 666f 7220 7468 6520 696e  arter for the in
+00021430: 7075 7420 7469 6d65 7374 616d 702e 0a20  put timestamp.. 
+00021440: 2020 202d 2045 7874 7261 6374 696e 6720     - Extracting 
+00021450: 7468 6520 7175 6172 7465 7220 6461 7465  the quarter date
+00021460: 2070 6172 7420 6672 6f6d 2061 2074 696d   part from a tim
+00021470: 6573 7461 6d70 2072 6574 7572 6e73 2074  estamp returns t
+00021480: 6865 2071 7561 7274 6572 206e 756d 6265  he quarter numbe
+00021490: 7220 6f66 2074 6865 2079 6561 7220 696e  r of the year in
+000214a0: 2074 6865 2074 696d 6573 7461 6d70 2e0a   the timestamp..
+000214b0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+000214c0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+000214d0: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
+000214e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000214f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00021500: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00021510: 2e20 2020 2020 5b5b 6461 7465 7469 6d65  .     [[datetime
+00021520: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
+00021530: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
+00021540: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
+00021550: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+00021560: 2e25 6622 295d 5d2c 0a20 2020 2020 2020  .%f")]],.       
+00021570: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00021580: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
+00021590: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+000215a0: 2064 662e 7365 6c65 6374 2864 6174 655f   df.select(date_
+000215b0: 7472 756e 6328 2259 4541 5222 2c20 2261  trunc("YEAR", "a
+000215c0: 2229 2c20 6461 7465 5f74 7275 6e63 2822  "), date_trunc("
+000215d0: 4d4f 4e54 4822 2c20 2261 2229 2c20 6461  MONTH", "a"), da
+000215e0: 7465 5f74 7275 6e63 2822 4441 5922 2c20  te_trunc("DAY", 
+000215f0: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
+00021600: 2020 2020 2020 2020 5b52 6f77 2844 4154          [Row(DAT
+00021610: 455f 5452 554e 4328 2259 4541 5222 2c20  E_TRUNC("YEAR", 
+00021620: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+00021630: 7465 7469 6d65 2832 3032 302c 2031 2c20  tetime(2020, 1, 
+00021640: 312c 2030 2c20 3029 2c20 4441 5445 5f54  1, 0, 0), DATE_T
+00021650: 5255 4e43 2822 4d4f 4e54 4822 2c20 2241  RUNC("MONTH", "A
+00021660: 2229 3d64 6174 6574 696d 652e 6461 7465  ")=datetime.date
+00021670: 7469 6d65 2832 3032 302c 2035 2c20 312c  time(2020, 5, 1,
+00021680: 2030 2c20 3029 2c20 4441 5445 5f54 5255   0, 0), DATE_TRU
+00021690: 4e43 2822 4441 5922 2c20 2241 2229 3d64  NC("DAY", "A")=d
+000216a0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000216b0: 2832 3032 302c 2035 2c20 312c 2030 2c20  (2020, 5, 1, 0, 
+000216c0: 3029 295d 0a20 2020 2020 2020 203e 3e3e  0))].        >>>
+000216d0: 2064 662e 7365 6c65 6374 2864 6174 655f   df.select(date_
+000216e0: 7472 756e 6328 2248 4f55 5222 2c20 2261  trunc("HOUR", "a
+000216f0: 2229 2c20 6461 7465 5f74 7275 6e63 2822  "), date_trunc("
+00021700: 4d49 4e55 5445 222c 2022 6122 292c 2064  MINUTE", "a"), d
+00021710: 6174 655f 7472 756e 6328 2253 4543 4f4e  ate_trunc("SECON
+00021720: 4422 2c20 2261 2229 292e 636f 6c6c 6563  D", "a")).collec
+00021730: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00021740: 2844 4154 455f 5452 554e 4328 2248 4f55  (DATE_TRUNC("HOU
+00021750: 5222 2c20 2241 2229 3d64 6174 6574 696d  R", "A")=datetim
+00021760: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
+00021770: 2035 2c20 312c 2031 332c 2030 292c 2044   5, 1, 13, 0), D
+00021780: 4154 455f 5452 554e 4328 224d 494e 5554  ATE_TRUNC("MINUT
+00021790: 4522 2c20 2241 2229 3d64 6174 6574 696d  E", "A")=datetim
+000217a0: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
+000217b0: 2035 2c20 312c 2031 332c 2031 3129 2c20   5, 1, 13, 11), 
+000217c0: 4441 5445 5f54 5255 4e43 2822 5345 434f  DATE_TRUNC("SECO
+000217d0: 4e44 222c 2022 4122 293d 6461 7465 7469  ND", "A")=dateti
+000217e0: 6d65 2e64 6174 6574 696d 6528 3230 3230  me.datetime(2020
+000217f0: 2c20 352c 2031 2c20 3133 2c20 3131 2c20  , 5, 1, 13, 11, 
+00021800: 3230 2929 5d0a 2020 2020 2020 2020 3e3e  20))].        >>
+00021810: 3e20 6466 2e73 656c 6563 7428 6461 7465  > df.select(date
+00021820: 5f74 7275 6e63 2822 5155 4152 5445 5222  _trunc("QUARTER"
+00021830: 2c20 2261 2229 292e 636f 6c6c 6563 7428  , "a")).collect(
+00021840: 290a 2020 2020 2020 2020 5b52 6f77 2844  ).        [Row(D
+00021850: 4154 455f 5452 554e 4328 2251 5541 5254  ATE_TRUNC("QUART
+00021860: 4552 222c 2022 4122 293d 6461 7465 7469  ER", "A")=dateti
+00021870: 6d65 2e64 6174 6574 696d 6528 3230 3230  me.datetime(2020
+00021880: 2c20 342c 2031 2c20 302c 2030 2929 5d0a  , 4, 1, 0, 0))].
+00021890: 2020 2020 2222 220a 2020 2020 7061 7274      """.    part
+000218a0: 5f63 6f6c 203d 205f 746f 5f63 6f6c 5f69  _col = _to_col_i
+000218b0: 665f 7374 7228 7061 7274 2c20 2264 6174  f_str(part, "dat
+000218c0: 655f 7472 756e 6322 290a 2020 2020 6578  e_trunc").    ex
+000218d0: 7072 5f63 6f6c 203d 205f 746f 5f63 6f6c  pr_col = _to_col
+000218e0: 5f69 665f 7374 7228 6578 7072 2c20 2264  _if_str(expr, "d
+000218f0: 6174 655f 7472 756e 6322 290a 2020 2020  ate_trunc").    
+00021900: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00021910: 6461 7465 5f74 7275 6e63 2229 2870 6172  date_trunc")(par
+00021920: 745f 636f 6c2c 2065 7870 725f 636f 6c29  t_col, expr_col)
+00021930: 0a0a 0a64 6566 2064 6179 6e61 6d65 2865  ...def dayname(e
+00021940: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00021950: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00021960: 2222 0a20 2020 2045 7874 7261 6374 7320  "".    Extracts 
+00021970: 7468 6520 7468 7265 652d 6c65 7474 6572  the three-letter
+00021980: 2064 6179 2d6f 662d 7765 656b 206e 616d   day-of-week nam
+00021990: 6520 6672 6f6d 2074 6865 2073 7065 6369  e from the speci
+000219a0: 6669 6564 2064 6174 6520 6f72 2074 696d  fied date or tim
+000219b0: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+000219c0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+000219d0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+000219e0: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+000219f0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00021a00: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00021a10: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+00021a20: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00021a30: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+00021a40: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+00021a50: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+00021a60: 2548 3a25 4d3a 2553 2e25 6622 295d 5d2c  %H:%M:%S.%f")]],
+00021a70: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00021a80: 2073 6368 656d 613d 5b22 6122 5d2c 0a20   schema=["a"],. 
+00021a90: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00021aa0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00021ab0: 6374 2864 6179 6e61 6d65 2822 6122 2929  ct(dayname("a"))
+00021ac0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00021ad0: 2020 205b 526f 7728 4441 594e 414d 4528     [Row(DAYNAME(
+00021ae0: 2241 2229 3d27 4672 6927 295d 0a20 2020  "A")='Fri')].   
+00021af0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00021b00: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00021b10: 6461 796e 616d 6522 290a 2020 2020 7265  dayname").    re
+00021b20: 7475 726e 2062 7569 6c74 696e 2822 6461  turn builtin("da
+00021b30: 796e 616d 6522 2928 6329 0a0a 0a64 6566  yname")(c)...def
+00021b40: 2064 6179 6f66 6d6f 6e74 6828 653a 2043   dayofmonth(e: C
+00021b50: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00021b60: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00021b70: 2020 2020 4578 7472 6163 7473 2074 6865      Extracts the
+00021b80: 2063 6f72 7265 7370 6f6e 6469 6e67 2064   corresponding d
+00021b90: 6179 2028 6e75 6d62 6572 2920 6f66 2074  ay (number) of t
+00021ba0: 6865 206d 6f6e 7468 2066 726f 6d20 6120  he month from a 
+00021bb0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
+00021bc0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
+00021bd0: 3a0a 2020 2020 2020 2020 3e3e 3e20 696d  :.        >>> im
+00021be0: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
+00021bf0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00021c00: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00021c10: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+00021c20: 202e 2e2e 2020 2020 205b 5b64 6174 6574   ...     [[datet
+00021c30: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+00021c40: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
+00021c50: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
+00021c60: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+00021c70: 3a25 532e 2566 2229 5d5d 2c0a 2020 2020  :%S.%f")]],.    
+00021c80: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+00021c90: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
+00021ca0: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+00021cb0: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
+00021cc0: 796f 666d 6f6e 7468 2822 6122 2929 2e63  yofmonth("a")).c
+00021cd0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00021ce0: 205b 526f 7728 4441 594f 464d 4f4e 5448   [Row(DAYOFMONTH
+00021cf0: 2822 4122 293d 3129 5d0a 2020 2020 2222  ("A")=1)].    ""
+00021d00: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00021d10: 6c5f 6966 5f73 7472 2865 2c20 2264 6179  l_if_str(e, "day
+00021d20: 6f66 6d6f 6e74 6822 290a 2020 2020 7265  ofmonth").    re
+00021d30: 7475 726e 2062 7569 6c74 696e 2822 6461  turn builtin("da
+00021d40: 796f 666d 6f6e 7468 2229 2863 290a 0a0a  yofmonth")(c)...
+00021d50: 6465 6620 6461 796f 6677 6565 6b28 653a  def dayofweek(e:
+00021d60: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00021d70: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00021d80: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+00021d90: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+00021da0: 2064 6179 2028 6e75 6d62 6572 2920 6f66   day (number) of
+00021db0: 2074 6865 2077 6565 6b20 6672 6f6d 2061   the week from a
+00021dc0: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
+00021dd0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
+00021de0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2069  ::.        >>> i
+00021df0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+00021e00: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00021e10: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00021e20: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
+00021e30: 2020 2e2e 2e20 2020 2020 5b5b 6461 7465    ...     [[date
+00021e40: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
+00021e50: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
+00021e60: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
+00021e70: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
+00021e80: 4d3a 2553 2e25 6622 295d 5d2c 0a20 2020  M:%S.%f")]],.   
+00021e90: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
+00021ea0: 656d 613d 5b22 6122 5d2c 0a20 2020 2020  ema=["a"],.     
+00021eb0: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
+00021ec0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+00021ed0: 6179 6f66 7765 656b 2822 6122 2929 2e63  ayofweek("a")).c
+00021ee0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00021ef0: 205b 526f 7728 4441 594f 4657 4545 4b28   [Row(DAYOFWEEK(
+00021f00: 2241 2229 3d35 295d 0a20 2020 2022 2222  "A")=5)].    """
+00021f10: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00021f20: 5f69 665f 7374 7228 652c 2022 6461 796f  _if_str(e, "dayo
+00021f30: 6677 6565 6b22 290a 2020 2020 7265 7475  fweek").    retu
+00021f40: 726e 2062 7569 6c74 696e 2822 6461 796f  rn builtin("dayo
+00021f50: 6677 6565 6b22 2928 6329 0a0a 0a64 6566  fweek")(c)...def
+00021f60: 2064 6179 6f66 7965 6172 2865 3a20 436f   dayofyear(e: Co
+00021f70: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00021f80: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00021f90: 2020 2045 7874 7261 6374 7320 7468 6520     Extracts the 
+00021fa0: 636f 7272 6573 706f 6e64 696e 6720 6461  corresponding da
+00021fb0: 7920 286e 756d 6265 7229 206f 6620 7468  y (number) of th
+00021fc0: 6520 7965 6172 2066 726f 6d20 6120 6461  e year from a da
+00021fd0: 7465 206f 7220 7469 6d65 7374 616d 702e  te or timestamp.
+00021fe0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00021ff0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00022000: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+00022010: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00022020: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00022030: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+00022040: 2e2e 2020 2020 205b 5b64 6174 6574 696d  ..     [[datetim
+00022050: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
+00022060: 696d 6528 2232 3032 302d 3035 2d30 3120  ime("2020-05-01 
+00022070: 3133 3a31 313a 3230 2e30 3030 222c 2022  13:11:20.000", "
+00022080: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+00022090: 532e 2566 2229 5d5d 2c0a 2020 2020 2020  S.%f")]],.      
+000220a0: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
+000220b0: 3d5b 2261 225d 2c0a 2020 2020 2020 2020  =["a"],.        
+000220c0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+000220d0: 3e20 6466 2e73 656c 6563 7428 6461 796f  > df.select(dayo
+000220e0: 6679 6561 7228 2261 2229 292e 636f 6c6c  fyear("a")).coll
+000220f0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00022100: 6f77 2844 4159 4f46 5945 4152 2822 4122  ow(DAYOFYEAR("A"
+00022110: 293d 3132 3229 5d0a 2020 2020 2222 220a  )=122)].    """.
+00022120: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00022130: 6966 5f73 7472 2865 2c20 2264 6179 6f66  if_str(e, "dayof
+00022140: 7965 6172 2229 0a20 2020 2072 6574 7572  year").    retur
+00022150: 6e20 6275 696c 7469 6e28 2264 6179 6f66  n builtin("dayof
+00022160: 7965 6172 2229 2863 290a 0a0a 6465 6620  year")(c)...def 
+00022170: 6973 5f61 7272 6179 2863 6f6c 3a20 436f  is_array(col: Co
+00022180: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00022190: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000221a0: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
+000221b0: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
+000221c0: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
+000221d0: 636f 6e74 6169 6e73 2061 6e20 4152 5241  contains an ARRA
+000221e0: 5920 7661 6c75 652e 0a0a 2020 2020 4578  Y value...    Ex
+000221f0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
+00022200: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00022210: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00022220: 616d 6528 5b5b 5b22 656c 656d 656e 7422  ame([[["element"
+00022230: 5d2c 2054 7275 655d 5d2c 2073 6368 656d  ], True]], schem
+00022240: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+00022250: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00022260: 6563 7428 6973 5f61 7272 6179 2864 665b  ect(is_array(df[
+00022270: 2261 225d 292e 616c 6961 7328 2269 735f  "a"]).alias("is_
+00022280: 6172 7261 795f 6122 292c 2069 735f 6172  array_a"), is_ar
+00022290: 7261 7928 6466 5b22 6222 5d29 2e61 6c69  ray(df["b"]).ali
+000222a0: 6173 2822 6973 5f61 7272 6179 5f62 2229  as("is_array_b")
+000222b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000222c0: 2020 2020 5b52 6f77 2849 535f 4152 5241      [Row(IS_ARRA
+000222d0: 595f 413d 5472 7565 2c20 4953 5f41 5252  Y_A=True, IS_ARR
+000222e0: 4159 5f42 3d46 616c 7365 295d 0a20 2020  AY_B=False)].   
+000222f0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00022300: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
+00022310: 2022 6973 5f61 7272 6179 2229 0a20 2020   "is_array").   
+00022320: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00022330: 2269 735f 6172 7261 7922 2928 6329 0a0a  "is_array")(c)..
+00022340: 0a64 6566 2069 735f 626f 6f6c 6561 6e28  .def is_boolean(
+00022350: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
+00022360: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00022370: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+00022380: 7320 7472 7565 2069 6620 7468 6520 7370  s true if the sp
+00022390: 6563 6966 6965 6420 5641 5249 414e 5420  ecified VARIANT 
+000223a0: 636f 6c75 6d6e 2063 6f6e 7461 696e 7320  column contains 
+000223b0: 6120 626f 6f6c 6561 6e20 7661 6c75 652e  a boolean value.
+000223c0: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
+000223d0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+000223e0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+000223f0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00022400: 7274 2053 7472 7563 7446 6965 6c64 2c20  rt StructField, 
+00022410: 5661 7269 616e 7454 7970 650a 2020 2020  VariantType.    
+00022420: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00022430: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00022440: 6672 616d 6528 5b5b 5472 7565 2c20 2758  frame([[True, 'X
+00022450: 275d 5d2c 2073 6368 656d 613d 5b22 6122  ']], schema=["a"
+00022460: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+00022470: 3e3e 3e20 6466 2e73 656c 6563 7428 6973  >>> df.select(is
+00022480: 5f62 6f6f 6c65 616e 2874 6f5f 7661 7269  _boolean(to_vari
+00022490: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
+000224a0: 6961 7328 2262 6f6f 6c65 616e 2229 2c20  ias("boolean"), 
+000224b0: 6973 5f62 6f6f 6c65 616e 2874 6f5f 7661  is_boolean(to_va
+000224c0: 7269 616e 7428 6466 5b22 6222 5d29 292e  riant(df["b"])).
+000224d0: 616c 6961 7328 2276 6172 6368 6172 2229  alias("varchar")
+000224e0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000224f0: 2020 2020 5b52 6f77 2842 4f4f 4c45 414e      [Row(BOOLEAN
+00022500: 3d54 7275 652c 2056 4152 4348 4152 3d46  =True, VARCHAR=F
+00022510: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
 00022520: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00022530: 665f 7374 7228 636f 6c2c 2022 6973 5f6f  f_str(col, "is_o
-00022540: 626a 6563 7422 290a 2020 2020 7265 7475  bject").    retu
-00022550: 726e 2062 7569 6c74 696e 2822 6973 5f6f  rn builtin("is_o
-00022560: 626a 6563 7422 2928 6329 0a0a 0a64 6566  bject")(c)...def
-00022570: 2069 735f 7469 6d65 2863 6f6c 3a20 436f   is_time(col: Co
-00022580: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00022590: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-000225a0: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-000225b0: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
-000225c0: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
-000225d0: 636f 6e74 6169 6e73 2061 2054 494d 4520  contains a TIME 
-000225e0: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
-000225f0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00022600: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00022610: 6d65 0a20 2020 2020 2020 203e 3e3e 2066  me.        >>> f
-00022620: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00022630: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
-00022640: 2069 6d70 6f72 7420 746f 5f76 6172 6961   import to_varia
-00022650: 6e74 2c20 6973 5f74 696d 650a 2020 2020  nt, is_time.    
-00022660: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00022670: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00022680: 6672 616d 6528 5b5b 6461 7465 7469 6d65  frame([[datetime
-00022690: 2e74 696d 6528 3130 2c20 3130 292c 2022  .time(10, 10), "
-000226a0: 5822 5d5d 2c20 7363 6865 6d61 3d5b 2261  X"]], schema=["a
-000226b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-000226c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
-000226d0: 735f 7469 6d65 2874 6f5f 7661 7269 616e  s_time(to_varian
-000226e0: 7428 2261 2229 292e 6173 5f28 2261 2229  t("a")).as_("a")
-000226f0: 2c20 6973 5f74 696d 6528 746f 5f76 6172  , is_time(to_var
-00022700: 6961 6e74 2822 6222 2929 2e61 735f 2822  iant("b")).as_("
-00022710: 6222 2929 2e63 6f6c 6c65 6374 2829 0a20  b")).collect(). 
-00022720: 2020 2020 2020 205b 526f 7728 413d 5472         [Row(A=Tr
-00022730: 7565 2c20 423d 4661 6c73 6529 5d0a 2020  ue, B=False)].  
-00022740: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00022750: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-00022760: 2c20 2269 735f 7469 6d65 2229 0a20 2020  , "is_time").   
-00022770: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00022780: 2269 735f 7469 6d65 2229 2863 290a 0a0a  "is_time")(c)...
-00022790: 6465 6620 6973 5f74 696d 6573 7461 6d70  def is_timestamp
-000227a0: 5f6c 747a 2863 6f6c 3a20 436f 6c75 6d6e  _ltz(col: Column
-000227b0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-000227c0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-000227d0: 6574 7572 6e73 2074 7275 6520 6966 2074  eturns true if t
-000227e0: 6865 2073 7065 6369 6669 6564 2056 4152  he specified VAR
-000227f0: 4941 4e54 2063 6f6c 756d 6e20 636f 6e74  IANT column cont
-00022800: 6169 6e73 2061 2054 494d 4553 5441 4d50  ains a TIMESTAMP
-00022810: 5f4c 545a 2076 616c 7565 2074 6f20 6265  _LTZ value to be
-00022820: 0a20 2020 2069 6e74 6572 7072 6574 6564  .    interpreted
-00022830: 2075 7369 6e67 2074 6865 206c 6f63 616c   using the local
-00022840: 2074 696d 6520 7a6f 6e65 2e0a 0a20 2020   time zone...   
-00022850: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00022860: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00022870: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00022880: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00022890: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
-000228a0: 7469 6d65 7374 616d 705f 6c74 7a0a 2020  timestamp_ltz.  
-000228b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000228c0: 6573 7369 6f6e 2e73 716c 2822 7365 6c65  ession.sql("sele
-000228d0: 6374 2074 6f5f 7469 6d65 7374 616d 705f  ct to_timestamp_
-000228e0: 6e74 7a28 2732 3031 372d 3032 2d32 3420  ntz('2017-02-24 
-000228f0: 3132 3a30 303a 3030 2e34 3536 2729 2061  12:00:00.456') a
-00022900: 7320 7469 6d65 7374 616d 705f 6e74 7a31  s timestamp_ntz1
-00022910: 2c20 220a 2020 2020 2020 2020 2e2e 2e20  , ".        ... 
-00022920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022930: 2022 746f 5f74 696d 6573 7461 6d70 5f6c   "to_timestamp_l
-00022940: 747a 2827 3230 3137 2d30 322d 3234 2031  tz('2017-02-24 1
-00022950: 333a 3030 3a30 302e 3132 3320 2b30 313a  3:00:00.123 +01:
-00022960: 3030 2729 2061 7320 7469 6d65 7374 616d  00') as timestam
-00022970: 705f 6c74 7a31 2c20 220a 2020 2020 2020  p_ltz1, ".      
-00022980: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-00022990: 2020 2020 2020 2022 746f 5f74 696d 6573         "to_times
-000229a0: 7461 6d70 5f74 7a28 2732 3031 372d 3032  tamp_tz('2017-02
-000229b0: 2d32 3420 3133 3a30 303a 3030 2e31 3233  -24 13:00:00.123
-000229c0: 202b 3031 3a30 3027 2920 6173 2074 696d   +01:00') as tim
-000229d0: 6573 7461 6d70 5f74 7a31 2229 0a20 2020  estamp_tz1").   
-000229e0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-000229f0: 6374 2869 735f 7469 6d65 7374 616d 705f  ct(is_timestamp_
-00022a00: 6c74 7a28 746f 5f76 6172 6961 6e74 2822  ltz(to_variant("
-00022a10: 7469 6d65 7374 616d 705f 6e74 7a31 2229  timestamp_ntz1")
-00022a20: 292e 6173 5f28 2261 2229 2c0a 2020 2020  ).as_("a"),.    
-00022a30: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00022a40: 2020 6973 5f74 696d 6573 7461 6d70 5f6c    is_timestamp_l
-00022a50: 747a 2874 6f5f 7661 7269 616e 7428 2274  tz(to_variant("t
-00022a60: 696d 6573 7461 6d70 5f6c 747a 3122 2929  imestamp_ltz1"))
-00022a70: 2e61 735f 2822 6222 292c 0a20 2020 2020  .as_("b"),.     
-00022a80: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00022a90: 2069 735f 7469 6d65 7374 616d 705f 6c74   is_timestamp_lt
-00022aa0: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
-00022ab0: 6d65 7374 616d 705f 747a 3122 2929 2e61  mestamp_tz1")).a
-00022ac0: 735f 2822 6322 2929 2e63 6f6c 6c65 6374  s_("c")).collect
-00022ad0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00022ae0: 413d 4661 6c73 652c 2042 3d54 7275 652c  A=False, B=True,
-00022af0: 2043 3d46 616c 7365 295d 0a20 2020 2022   C=False)].    "
-00022b00: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00022b10: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-00022b20: 6973 5f74 696d 6573 7461 6d70 5f6c 747a  is_timestamp_ltz
-00022b30: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00022b40: 696c 7469 6e28 2269 735f 7469 6d65 7374  iltin("is_timest
-00022b50: 616d 705f 6c74 7a22 2928 6329 0a0a 0a64  amp_ltz")(c)...d
-00022b60: 6566 2069 735f 7469 6d65 7374 616d 705f  ef is_timestamp_
-00022b70: 6e74 7a28 636f 6c3a 2043 6f6c 756d 6e4f  ntz(col: ColumnO
-00022b80: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00022b90: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00022ba0: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
-00022bb0: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
-00022bc0: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
-00022bd0: 696e 7320 6120 5449 4d45 5354 414d 505f  ins a TIMESTAMP_
-00022be0: 4e54 5a20 7661 6c75 6520 7769 7468 206e  NTZ value with n
-00022bf0: 6f20 7469 6d65 207a 6f6e 652e 0a0a 2020  o time zone...  
-00022c00: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00022c10: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00022c20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00022c30: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-00022c40: 7420 746f 5f76 6172 6961 6e74 2c20 6973  t to_variant, is
-00022c50: 5f74 696d 6573 7461 6d70 5f6e 747a 0a20  _timestamp_ntz. 
-00022c60: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00022c70: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-00022c80: 6563 7420 746f 5f74 696d 6573 7461 6d70  ect to_timestamp
-00022c90: 5f6e 747a 2827 3230 3137 2d30 322d 3234  _ntz('2017-02-24
-00022ca0: 2031 323a 3030 3a30 302e 3435 3627 2920   12:00:00.456') 
-00022cb0: 6173 2074 696d 6573 7461 6d70 5f6e 747a  as timestamp_ntz
-00022cc0: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
-00022cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ce0: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
-00022cf0: 6c74 7a28 2732 3031 372d 3032 2d32 3420  ltz('2017-02-24 
-00022d00: 3133 3a30 303a 3030 2e31 3233 202b 3031  13:00:00.123 +01
-00022d10: 3a30 3027 2920 6173 2074 696d 6573 7461  :00') as timesta
-00022d20: 6d70 5f6c 747a 312c 2022 0a20 2020 2020  mp_ltz1, ".     
-00022d30: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00022d40: 2020 2020 2020 2020 2274 6f5f 7469 6d65          "to_time
-00022d50: 7374 616d 705f 747a 2827 3230 3137 2d30  stamp_tz('2017-0
-00022d60: 322d 3234 2031 333a 3030 3a30 302e 3132  2-24 13:00:00.12
-00022d70: 3320 2b30 313a 3030 2729 2061 7320 7469  3 +01:00') as ti
-00022d80: 6d65 7374 616d 705f 747a 3122 290a 2020  mestamp_tz1").  
-00022d90: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00022da0: 6563 7428 6973 5f74 696d 6573 7461 6d70  ect(is_timestamp
-00022db0: 5f6e 747a 2874 6f5f 7661 7269 616e 7428  _ntz(to_variant(
-00022dc0: 2274 696d 6573 7461 6d70 5f6e 747a 3122  "timestamp_ntz1"
-00022dd0: 2929 2e61 735f 2822 6122 292c 0a20 2020  )).as_("a"),.   
-00022de0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00022df0: 2020 2069 735f 7469 6d65 7374 616d 705f     is_timestamp_
-00022e00: 6e74 7a28 746f 5f76 6172 6961 6e74 2822  ntz(to_variant("
-00022e10: 7469 6d65 7374 616d 705f 6c74 7a31 2229  timestamp_ltz1")
-00022e20: 292e 6173 5f28 2262 2229 2c0a 2020 2020  ).as_("b"),.    
-00022e30: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00022e40: 2020 6973 5f74 696d 6573 7461 6d70 5f6e    is_timestamp_n
-00022e50: 747a 2874 6f5f 7661 7269 616e 7428 2274  tz(to_variant("t
-00022e60: 696d 6573 7461 6d70 5f74 7a31 2229 292e  imestamp_tz1")).
-00022e70: 6173 5f28 2263 2229 292e 636f 6c6c 6563  as_("c")).collec
-00022e80: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00022e90: 2841 3d54 7275 652c 2042 3d46 616c 7365  (A=True, B=False
-00022ea0: 2c20 433d 4661 6c73 6529 5d0a 2020 2020  , C=False)].    
-00022eb0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00022ec0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-00022ed0: 2269 735f 7469 6d65 7374 616d 705f 6e74  "is_timestamp_nt
-00022ee0: 7a22 290a 2020 2020 7265 7475 726e 2062  z").    return b
-00022ef0: 7569 6c74 696e 2822 6973 5f74 696d 6573  uiltin("is_times
-00022f00: 7461 6d70 5f6e 747a 2229 2863 290a 0a0a  tamp_ntz")(c)...
-00022f10: 6465 6620 6973 5f74 696d 6573 7461 6d70  def is_timestamp
-00022f20: 5f74 7a28 636f 6c3a 2043 6f6c 756d 6e4f  _tz(col: ColumnO
-00022f30: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00022f40: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00022f50: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
-00022f60: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
-00022f70: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
-00022f80: 696e 7320 6120 5449 4d45 5354 414d 505f  ins a TIMESTAMP_
-00022f90: 545a 2076 616c 7565 2077 6974 6820 6120  TZ value with a 
-00022fa0: 7469 6d65 207a 6f6e 652e 0a0a 2020 2020  time zone...    
-00022fb0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00022fc0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00022fd0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-00022fe0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-00022ff0: 746f 5f76 6172 6961 6e74 2c20 6973 5f74  to_variant, is_t
-00023000: 696d 6573 7461 6d70 5f74 7a0a 2020 2020  imestamp_tz.    
-00023010: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00023020: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
-00023030: 2074 6f5f 7469 6d65 7374 616d 705f 6e74   to_timestamp_nt
-00023040: 7a28 2732 3031 372d 3032 2d32 3420 3132  z('2017-02-24 12
-00023050: 3a30 303a 3030 2e34 3536 2729 2061 7320  :00:00.456') as 
-00023060: 7469 6d65 7374 616d 705f 6e74 7a31 2c20  timestamp_ntz1, 
-00023070: 220a 2020 2020 2020 2020 2e2e 2e20 2020  ".        ...   
-00023080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00023090: 746f 5f74 696d 6573 7461 6d70 5f6c 747a  to_timestamp_ltz
-000230a0: 2827 3230 3137 2d30 322d 3234 2031 333a  ('2017-02-24 13:
-000230b0: 3030 3a30 302e 3132 3320 2b30 313a 3030  00:00.123 +01:00
-000230c0: 2729 2061 7320 7469 6d65 7374 616d 705f  ') as timestamp_
-000230d0: 6c74 7a31 2c20 220a 2020 2020 2020 2020  ltz1, ".        
-000230e0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-000230f0: 2020 2020 2022 746f 5f74 696d 6573 7461       "to_timesta
-00023100: 6d70 5f74 7a28 2732 3031 372d 3032 2d32  mp_tz('2017-02-2
-00023110: 3420 3133 3a30 303a 3030 2e31 3233 202b  4 13:00:00.123 +
-00023120: 3031 3a30 3027 2920 6173 2074 696d 6573  01:00') as times
-00023130: 7461 6d70 5f74 7a31 2229 0a20 2020 2020  tamp_tz1").     
-00023140: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00023150: 2869 735f 7469 6d65 7374 616d 705f 747a  (is_timestamp_tz
-00023160: 2874 6f5f 7661 7269 616e 7428 2274 696d  (to_variant("tim
-00023170: 6573 7461 6d70 5f6e 747a 3122 2929 2e61  estamp_ntz1")).a
-00023180: 735f 2822 6122 292c 0a20 2020 2020 2020  s_("a"),.       
-00023190: 202e 2e2e 2020 2020 2020 2020 2020 2069   ...           i
-000231a0: 735f 7469 6d65 7374 616d 705f 747a 2874  s_timestamp_tz(t
-000231b0: 6f5f 7661 7269 616e 7428 2274 696d 6573  o_variant("times
-000231c0: 7461 6d70 5f6c 747a 3122 2929 2e61 735f  tamp_ltz1")).as_
-000231d0: 2822 6222 292c 0a20 2020 2020 2020 202e  ("b"),.        .
-000231e0: 2e2e 2020 2020 2020 2020 2020 2069 735f  ..           is_
-000231f0: 7469 6d65 7374 616d 705f 747a 2874 6f5f  timestamp_tz(to_
-00023200: 7661 7269 616e 7428 2274 696d 6573 7461  variant("timesta
-00023210: 6d70 5f74 7a31 2229 292e 6173 5f28 2263  mp_tz1")).as_("c
-00023220: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00023230: 2020 2020 2020 5b52 6f77 2841 3d46 616c        [Row(A=Fal
-00023240: 7365 2c20 423d 4661 6c73 652c 2043 3d54  se, B=False, C=T
-00023250: 7275 6529 5d0a 2020 2020 2222 220a 2020  rue)].    """.  
-00023260: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00023270: 5f73 7472 2863 6f6c 2c20 2269 735f 7469  _str(col, "is_ti
-00023280: 6d65 7374 616d 705f 747a 2229 0a20 2020  mestamp_tz").   
-00023290: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000232a0: 2269 735f 7469 6d65 7374 616d 705f 747a  "is_timestamp_tz
-000232b0: 2229 2863 290a 0a0a 6465 6620 5f63 6f6c  ")(c)...def _col
-000232c0: 756d 6e73 5f66 726f 6d5f 7469 6d65 7374  umns_from_timest
-000232d0: 616d 705f 7061 7274 7328 0a20 2020 2066  amp_parts(.    f
-000232e0: 756e 635f 6e61 6d65 3a20 7374 722c 202a  unc_name: str, *
-000232f0: 6172 6773 3a20 556e 696f 6e5b 436f 6c75  args: Union[Colu
-00023300: 6d6e 4f72 4e61 6d65 2c20 696e 745d 0a29  mnOrName, int].)
-00023310: 202d 3e20 5475 706c 655b 436f 6c75 6d6e   -> Tuple[Column
-00023320: 2c20 2e2e 2e5d 3a0a 2020 2020 6966 206c  , ...]:.    if l
-00023330: 656e 2861 7267 7329 203d 3d20 333a 0a20  en(args) == 3:. 
-00023340: 2020 2020 2020 2079 6561 725f 203d 205f         year_ = _
-00023350: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-00023360: 5f69 6e74 2861 7267 735b 305d 2c20 6675  _int(args[0], fu
-00023370: 6e63 5f6e 616d 6529 0a20 2020 2020 2020  nc_name).       
-00023380: 206d 6f6e 7468 203d 205f 746f 5f63 6f6c   month = _to_col
-00023390: 5f69 665f 7374 725f 6f72 5f69 6e74 2861  _if_str_or_int(a
-000233a0: 7267 735b 315d 2c20 6675 6e63 5f6e 616d  rgs[1], func_nam
-000233b0: 6529 0a20 2020 2020 2020 2064 6179 203d  e).        day =
-000233c0: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
-000233d0: 6f72 5f69 6e74 2861 7267 735b 325d 2c20  or_int(args[2], 
-000233e0: 6675 6e63 5f6e 616d 6529 0a20 2020 2020  func_name).     
-000233f0: 2020 2072 6574 7572 6e20 7965 6172 5f2c     return year_,
-00023400: 206d 6f6e 7468 2c20 6461 790a 2020 2020   month, day.    
-00023410: 656c 6966 206c 656e 2861 7267 7329 203d  elif len(args) =
-00023420: 3d20 363a 0a20 2020 2020 2020 2079 6561  = 6:.        yea
-00023430: 725f 203d 205f 746f 5f63 6f6c 5f69 665f  r_ = _to_col_if_
-00023440: 7374 725f 6f72 5f69 6e74 2861 7267 735b  str_or_int(args[
-00023450: 305d 2c20 6675 6e63 5f6e 616d 6529 0a20  0], func_name). 
-00023460: 2020 2020 2020 206d 6f6e 7468 203d 205f         month = _
-00023470: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-00023480: 5f69 6e74 2861 7267 735b 315d 2c20 6675  _int(args[1], fu
-00023490: 6e63 5f6e 616d 6529 0a20 2020 2020 2020  nc_name).       
-000234a0: 2064 6179 203d 205f 746f 5f63 6f6c 5f69   day = _to_col_i
-000234b0: 665f 7374 725f 6f72 5f69 6e74 2861 7267  f_str_or_int(arg
-000234c0: 735b 325d 2c20 6675 6e63 5f6e 616d 6529  s[2], func_name)
-000234d0: 0a20 2020 2020 2020 2068 6f75 7220 3d20  .        hour = 
-000234e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
-000234f0: 725f 696e 7428 6172 6773 5b33 5d2c 2066  r_int(args[3], f
-00023500: 756e 635f 6e61 6d65 290a 2020 2020 2020  unc_name).      
-00023510: 2020 6d69 6e75 7465 203d 205f 746f 5f63    minute = _to_c
-00023520: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
-00023530: 2861 7267 735b 345d 2c20 6675 6e63 5f6e  (args[4], func_n
-00023540: 616d 6529 0a20 2020 2020 2020 2073 6563  ame).        sec
-00023550: 6f6e 6420 3d20 5f74 6f5f 636f 6c5f 6966  ond = _to_col_if
-00023560: 5f73 7472 5f6f 725f 696e 7428 6172 6773  _str_or_int(args
-00023570: 5b35 5d2c 2066 756e 635f 6e61 6d65 290a  [5], func_name).
-00023580: 2020 2020 2020 2020 7265 7475 726e 2079          return y
-00023590: 6561 725f 2c20 6d6f 6e74 682c 2064 6179  ear_, month, day
-000235a0: 2c20 686f 7572 2c20 6d69 6e75 7465 2c20  , hour, minute, 
-000235b0: 7365 636f 6e64 0a20 2020 2065 6c73 653a  second.    else:
-000235c0: 0a20 2020 2020 2020 2023 2053 686f 756c  .        # Shoul
-000235d0: 6420 6e65 7665 7220 6861 7070 656e 2073  d never happen s
-000235e0: 696e 6365 2077 6520 6f6e 6c79 2075 7365  ince we only use
-000235f0: 2074 6869 7320 696e 7465 726e 616c 6c79   this internally
-00023600: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-00023610: 616c 7565 4572 726f 7228 6622 496e 636f  alueError(f"Inco
-00023620: 7272 6563 7420 6e75 6d62 6572 206f 6620  rrect number of 
-00023630: 6172 6773 2070 6173 7365 6420 746f 207b  args passed to {
-00023640: 6675 6e63 5f6e 616d 657d 2229 0a0a 0a64  func_name}")...d
-00023650: 6566 205f 7469 6d65 7374 616d 705f 6672  ef _timestamp_fr
-00023660: 6f6d 5f70 6172 7473 5f69 6e74 6572 6e61  om_parts_interna
-00023670: 6c28 0a20 2020 2066 756e 635f 6e61 6d65  l(.    func_name
-00023680: 3a20 7374 722c 202a 6172 6773 3a20 556e  : str, *args: Un
-00023690: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-000236a0: 2c20 696e 745d 2c20 2a2a 6b77 6172 6773  , int], **kwargs
-000236b0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-000236c0: 4e61 6d65 2c20 696e 745d 0a29 202d 3e20  Name, int].) -> 
-000236d0: 5475 706c 655b 436f 6c75 6d6e 2c20 2e2e  Tuple[Column, ..
-000236e0: 2e5d 3a0a 2020 2020 6e75 6d5f 6172 6773  .]:.    num_args
-000236f0: 203d 206c 656e 2861 7267 7329 0a20 2020   = len(args).   
-00023700: 2069 6620 6e75 6d5f 6172 6773 203d 3d20   if num_args == 
-00023710: 323a 0a20 2020 2020 2020 2023 2065 7870  2:.        # exp
-00023720: 7265 7373 696f 6e20 6d6f 6465 0a20 2020  ression mode.   
-00023730: 2020 2020 2064 6174 655f 6578 7072 203d       date_expr =
-00023740: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00023750: 6172 6773 5b30 5d2c 2066 756e 635f 6e61  args[0], func_na
-00023760: 6d65 290a 2020 2020 2020 2020 7469 6d65  me).        time
-00023770: 5f65 7870 7220 3d20 5f74 6f5f 636f 6c5f  _expr = _to_col_
-00023780: 6966 5f73 7472 2861 7267 735b 315d 2c20  if_str(args[1], 
-00023790: 6675 6e63 5f6e 616d 6529 0a20 2020 2020  func_name).     
-000237a0: 2020 2072 6574 7572 6e20 6461 7465 5f65     return date_e
-000237b0: 7870 722c 2074 696d 655f 6578 7072 0a20  xpr, time_expr. 
-000237c0: 2020 2065 6c69 6620 3620 3c3d 206e 756d     elif 6 <= num
-000237d0: 5f61 7267 7320 3c3d 2038 3a0a 2020 2020  _args <= 8:.    
-000237e0: 2020 2020 2320 7061 7274 7320 6d6f 6465      # parts mode
-000237f0: 0a20 2020 2020 2020 2079 2c20 6d2c 2064  .        y, m, d
-00023800: 2c20 682c 206d 696e 5f2c 2073 203d 205f  , h, min_, s = _
-00023810: 636f 6c75 6d6e 735f 6672 6f6d 5f74 696d  columns_from_tim
-00023820: 6573 7461 6d70 5f70 6172 7473 2866 756e  estamp_parts(fun
-00023830: 635f 6e61 6d65 2c20 2a61 7267 735b 3a36  c_name, *args[:6
-00023840: 5d29 0a20 2020 2020 2020 206e 735f 6172  ]).        ns_ar
-00023850: 6720 3d20 6172 6773 5b36 5d20 6966 206e  g = args[6] if n
-00023860: 756d 5f61 7267 7320 3e3d 2037 2065 6c73  um_args >= 7 els
-00023870: 6520 6b77 6172 6773 2e67 6574 2822 6e61  e kwargs.get("na
-00023880: 6e6f 7365 636f 6e64 7322 290a 2020 2020  noseconds").    
-00023890: 2020 2020 2320 5469 6d65 7a6f 6e65 2069      # Timezone i
-000238a0: 7320 6f6e 6c79 2061 6363 6570 7465 6420  s only accepted 
-000238b0: 696e 2074 696d 6573 7461 6d70 5f66 726f  in timestamp_fro
-000238c0: 6d5f 7061 7274 7320 6675 6e63 7469 6f6e  m_parts function
-000238d0: 0a20 2020 2020 2020 2074 7a5f 6172 6720  .        tz_arg 
-000238e0: 3d20 6172 6773 5b37 5d20 6966 206e 756d  = args[7] if num
-000238f0: 5f61 7267 7320 3d3d 2038 2065 6c73 6520  _args == 8 else 
-00023900: 6b77 6172 6773 2e67 6574 2822 7469 6d65  kwargs.get("time
-00023910: 7a6f 6e65 2229 0a20 2020 2020 2020 2069  zone").        i
-00023920: 6620 747a 5f61 7267 2069 7320 6e6f 7420  f tz_arg is not 
-00023930: 4e6f 6e65 2061 6e64 2066 756e 635f 6e61  None and func_na
-00023940: 6d65 2021 3d20 2274 696d 6573 7461 6d70  me != "timestamp
-00023950: 5f66 726f 6d5f 7061 7274 7322 3a0a 2020  _from_parts":.  
-00023960: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00023970: 5661 6c75 6545 7272 6f72 2866 227b 6675  ValueError(f"{fu
-00023980: 6e63 5f6e 616d 657d 2064 6f65 7320 6e6f  nc_name} does no
-00023990: 7420 6163 6365 7074 2074 696d 657a 6f6e  t accept timezon
-000239a0: 6520 6173 2061 6e20 6172 6775 6d65 6e74  e as an argument
-000239b0: 2229 0a20 2020 2020 2020 206e 7320 3d20  ").        ns = 
-000239c0: 4e6f 6e65 2069 6620 6e73 5f61 7267 2069  None if ns_arg i
-000239d0: 7320 4e6f 6e65 2065 6c73 6520 5f74 6f5f  s None else _to_
-000239e0: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
-000239f0: 7428 6e73 5f61 7267 2c20 6675 6e63 5f6e  t(ns_arg, func_n
-00023a00: 616d 6529 0a20 2020 2020 2020 2074 7a20  ame).        tz 
-00023a10: 3d20 4e6f 6e65 2069 6620 747a 5f61 7267  = None if tz_arg
-00023a20: 2069 7320 4e6f 6e65 2065 6c73 6520 5f74   is None else _t
-00023a30: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
-00023a40: 7228 747a 5f61 7267 2c20 6675 6e63 5f6e  r(tz_arg, func_n
-00023a50: 616d 6529 0a20 2020 2020 2020 2069 6620  ame).        if 
-00023a60: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2061  ns is not None a
-00023a70: 6e64 2074 7a20 6973 206e 6f74 204e 6f6e  nd tz is not Non
-00023a80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00023a90: 6574 7572 6e20 792c 206d 2c20 642c 2068  eturn y, m, d, h
-00023aa0: 2c20 6d69 6e5f 2c20 732c 206e 732c 2074  , min_, s, ns, t
-00023ab0: 7a0a 2020 2020 2020 2020 656c 6966 206e  z.        elif n
-00023ac0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-00023ad0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00023ae0: 6e20 792c 206d 2c20 642c 2068 2c20 6d69  n y, m, d, h, mi
-00023af0: 6e5f 2c20 732c 206e 730a 2020 2020 2020  n_, s, ns.      
-00023b00: 2020 656c 6966 2074 7a20 6973 206e 6f74    elif tz is not
-00023b10: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00023b20: 2020 2023 2057 6520 6e65 6564 2074 6f20     # We need to 
-00023b30: 6669 6c6c 2069 6e20 6e61 6e6f 7365 636f  fill in nanoseco
-00023b40: 6e64 7320 6173 2030 2074 6f20 6d61 6b65  nds as 0 to make
-00023b50: 2074 6865 2073 716c 2066 756e 6374 696f   the sql functio
-00023b60: 6e20 776f 726b 0a20 2020 2020 2020 2020  n work.         
-00023b70: 2020 2072 6574 7572 6e20 792c 206d 2c20     return y, m, 
-00023b80: 642c 2068 2c20 6d69 6e5f 2c20 732c 206c  d, h, min_, s, l
-00023b90: 6974 2830 292c 2074 7a0a 2020 2020 2020  it(0), tz.      
-00023ba0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00023bb0: 2020 2020 7265 7475 726e 2079 2c20 6d2c      return y, m,
-00023bc0: 2064 2c20 682c 206d 696e 5f2c 2073 0a20   d, h, min_, s. 
-00023bd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00023be0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00023bf0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
-00023c00: 227b 6675 6e63 5f6e 616d 657d 2065 7870  "{func_name} exp
-00023c10: 6563 7465 6420 3220 6f72 2036 2072 6571  ected 2 or 6 req
-00023c20: 7569 7265 6420 6172 6775 6d65 6e74 732c  uired arguments,
-00023c30: 2067 6f74 207b 6e75 6d5f 6172 6773 7d22   got {num_args}"
-00023c40: 0a20 2020 2020 2020 2029 0a0a 0a64 6566  .        )...def
-00023c50: 2074 696d 655f 6672 6f6d 5f70 6172 7473   time_from_parts
-00023c60: 280a 2020 2020 686f 7572 3a20 556e 696f  (.    hour: Unio
-00023c70: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-00023c80: 696e 745d 2c0a 2020 2020 6d69 6e75 7465  int],.    minute
-00023c90: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-00023ca0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-00023cb0: 7365 636f 6e64 3a20 556e 696f 6e5b 436f  second: Union[Co
-00023cc0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00023cd0: 2c0a 2020 2020 6e61 6e6f 7365 636f 6e64  ,.    nanosecond
-00023ce0: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
-00023cf0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-00023d00: 696e 745d 5d20 3d20 4e6f 6e65 2c0a 2920  int]] = None,.) 
-00023d10: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00023d20: 2222 0a20 2020 2043 7265 6174 6573 2061  "".    Creates a
-00023d30: 2074 696d 6520 6672 6f6d 2069 6e64 6976   time from indiv
-00023d40: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
-00023d50: 6d70 6f6e 656e 7473 2e0a 0a20 2020 2054  mponents...    T
-00023d60: 494d 455f 4652 4f4d 5f50 4152 5453 2069  IME_FROM_PARTS i
-00023d70: 7320 7479 7069 6361 6c6c 7920 7573 6564  s typically used
-00023d80: 2074 6f20 6861 6e64 6c65 2076 616c 7565   to handle value
-00023d90: 7320 696e 2022 6e6f 726d 616c 2220 7261  s in "normal" ra
-00023da0: 6e67 6573 2028 652e 672e 2068 6f75 7273  nges (e.g. hours
-00023db0: 2030 2d32 332c 206d 696e 7574 6573 2030   0-23, minutes 0
-00023dc0: 2d35 3929 2c0a 2020 2020 6275 7420 6974  -59),.    but it
-00023dd0: 2061 6c73 6f20 6861 6e64 6c65 7320 7661   also handles va
-00023de0: 6c75 6573 2066 726f 6d20 6f75 7473 6964  lues from outsid
-00023df0: 6520 7468 6573 6520 7261 6e67 6573 2e20  e these ranges. 
-00023e00: 5468 6973 2061 6c6c 6f77 732c 2066 6f72  This allows, for
-00023e10: 2065 7861 6d70 6c65 2c20 6368 6f6f 7369   example, choosi
-00023e20: 6e67 2074 6865 204e 2d74 6820 6d69 6e75  ng the N-th minu
-00023e30: 7465 0a20 2020 2069 6e20 6120 6461 792c  te.    in a day,
-00023e40: 2077 6869 6368 2063 616e 2062 6520 7573   which can be us
-00023e50: 6564 2074 6f20 7369 6d70 6c69 6679 2073  ed to simplify s
-00023e60: 6f6d 6520 636f 6d70 7574 6174 696f 6e73  ome computations
-00023e70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00023e80: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00023e90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00023ea0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-00023eb0: 2020 2020 202e 2e2e 2020 2020 205b 5b31       ...     [[1
-00023ec0: 312c 2031 312c 2030 2c20 3938 3736 3534  1, 11, 0, 987654
-00023ed0: 3332 315d 2c20 5b31 302c 2031 302c 2030  321], [10, 10, 0
-00023ee0: 2c20 3938 3736 3534 3332 315d 5d2c 0a20  , 987654321]],. 
-00023ef0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-00023f00: 6368 656d 613d 5b22 686f 7572 222c 2022  chema=["hour", "
-00023f10: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
-00023f20: 222c 2022 6e61 6e6f 7365 636f 6e64 7322  ", "nanoseconds"
-00023f30: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
-00023f40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00023f50: 7365 6c65 6374 2874 696d 655f 6672 6f6d  select(time_from
-00023f60: 5f70 6172 7473 280a 2020 2020 2020 2020  _parts(.        
-00023f70: 2e2e 2e20 2020 2020 2268 6f75 7222 2c20  ...     "hour", 
-00023f80: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
-00023f90: 6422 2c20 6e61 6e6f 7365 636f 6e64 733d  d", nanoseconds=
-00023fa0: 226e 616e 6f73 6563 6f6e 6473 220a 2020  "nanoseconds".  
-00023fb0: 2020 2020 2020 2e2e 2e20 292e 616c 6961        ... ).alia
-00023fc0: 7328 2254 494d 455f 4652 4f4d 5f50 4152  s("TIME_FROM_PAR
-00023fd0: 5453 2229 292e 636f 6c6c 6563 7428 290a  TS")).collect().
-00023fe0: 2020 2020 2020 2020 5b52 6f77 2854 494d          [Row(TIM
-00023ff0: 455f 4652 4f4d 5f50 4152 5453 3d64 6174  E_FROM_PARTS=dat
-00024000: 6574 696d 652e 7469 6d65 2831 312c 2031  etime.time(11, 1
-00024010: 312c 2030 2c20 3938 3736 3534 2929 2c20  1, 0, 987654)), 
-00024020: 526f 7728 5449 4d45 5f46 524f 4d5f 5041  Row(TIME_FROM_PA
-00024030: 5254 533d 6461 7465 7469 6d65 2e74 696d  RTS=datetime.tim
-00024040: 6528 3130 2c20 3130 2c20 302c 2039 3837  e(10, 10, 0, 987
-00024050: 3635 3429 295d 0a20 2020 2022 2222 0a20  654))].    """. 
-00024060: 2020 2068 2c20 6d2c 2073 203d 205f 636f     h, m, s = _co
-00024070: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
-00024080: 7461 6d70 5f70 6172 7473 2822 7469 6d65  tamp_parts("time
-00024090: 5f66 726f 6d5f 7061 7274 7322 2c20 686f  _from_parts", ho
-000240a0: 7572 2c20 6d69 6e75 7465 2c20 7365 636f  ur, minute, seco
-000240b0: 6e64 290a 2020 2020 6966 206e 616e 6f73  nd).    if nanos
-000240c0: 6563 6f6e 6473 3a0a 2020 2020 2020 2020  econds:.        
-000240d0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000240e0: 7469 6d65 5f66 726f 6d5f 7061 7274 7322  time_from_parts"
-000240f0: 2928 0a20 2020 2020 2020 2020 2020 2068  )(.            h
-00024100: 2c20 6d2c 2073 2c20 5f74 6f5f 636f 6c5f  , m, s, _to_col_
-00024110: 6966 5f73 7472 5f6f 725f 696e 7428 6e61  if_str_or_int(na
-00024120: 6e6f 7365 636f 6e64 732c 2022 7469 6d65  noseconds, "time
-00024130: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
-00024140: 2020 2020 2020 290a 2020 2020 656c 7365        ).    else
-00024150: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00024160: 2062 7569 6c74 696e 2822 7469 6d65 5f66   builtin("time_f
-00024170: 726f 6d5f 7061 7274 7322 2928 682c 206d  rom_parts")(h, m
-00024180: 2c20 7329 0a0a 0a40 6f76 6572 6c6f 6164  , s)...@overload
-00024190: 0a64 6566 2074 696d 6573 7461 6d70 5f66  .def timestamp_f
-000241a0: 726f 6d5f 7061 7274 7328 6461 7465 5f65  rom_parts(date_e
-000241b0: 7870 723a 2043 6f6c 756d 6e4f 724e 616d  xpr: ColumnOrNam
-000241c0: 652c 2074 696d 655f 6578 7072 3a20 436f  e, time_expr: Co
-000241d0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-000241e0: 6f6c 756d 6e3a 0a20 2020 202e 2e2e 2020  olumn:.    ...  
-000241f0: 2320 7072 6167 6d61 3a20 6e6f 2063 6f76  # pragma: no cov
-00024200: 6572 0a0a 0a40 6f76 6572 6c6f 6164 0a64  er...@overload.d
-00024210: 6566 2074 696d 6573 7461 6d70 5f66 726f  ef timestamp_fro
-00024220: 6d5f 7061 7274 7328 0a20 2020 2079 6561  m_parts(.    yea
-00024230: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
-00024240: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
-00024250: 206d 6f6e 7468 3a20 556e 696f 6e5b 436f   month: Union[Co
-00024260: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00024270: 2c0a 2020 2020 6461 793a 2055 6e69 6f6e  ,.    day: Union
-00024280: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00024290: 6e74 5d2c 0a20 2020 2068 6f75 723a 2055  nt],.    hour: U
-000242a0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-000242b0: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
-000242c0: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
-000242d0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-000242e0: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
-000242f0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00024300: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
-00024310: 6f6e 643a 204f 7074 696f 6e61 6c5b 556e  ond: Optional[Un
-00024320: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-00024330: 2c20 696e 745d 5d20 3d20 4e6f 6e65 2c0a  , int]] = None,.
-00024340: 2020 2020 7469 6d65 7a6f 6e65 3a20 4f70      timezone: Op
-00024350: 7469 6f6e 616c 5b43 6f6c 756d 6e4f 724c  tional[ColumnOrL
-00024360: 6974 6572 616c 5374 725d 203d 204e 6f6e  iteralStr] = Non
-00024370: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
-00024380: 2020 2020 2e2e 2e20 2023 2070 7261 676d      ...  # pragm
-00024390: 613a 206e 6f20 636f 7665 720a 0a0a 6465  a: no cover...de
-000243a0: 6620 7469 6d65 7374 616d 705f 6672 6f6d  f timestamp_from
-000243b0: 5f70 6172 7473 282a 6172 6773 2c20 2a2a  _parts(*args, **
-000243c0: 6b77 6172 6773 2920 2d3e 2043 6f6c 756d  kwargs) -> Colum
-000243d0: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
-000243e0: 7265 6174 6573 2061 2074 696d 6573 7461  reates a timesta
-000243f0: 6d70 2066 726f 6d20 696e 6469 7669 6475  mp from individu
-00024400: 616c 206e 756d 6572 6963 2063 6f6d 706f  al numeric compo
-00024410: 6e65 6e74 732e 2049 6620 6e6f 2074 696d  nents. If no tim
-00024420: 6520 7a6f 6e65 2069 7320 696e 2065 6666  e zone is in eff
-00024430: 6563 742c 0a20 2020 2074 6865 2066 756e  ect,.    the fun
-00024440: 6374 696f 6e20 6361 6e20 6265 2075 7365  ction can be use
-00024450: 6420 746f 2063 7265 6174 6520 6120 7469  d to create a ti
-00024460: 6d65 7374 616d 7020 6672 6f6d 2061 2064  mestamp from a d
-00024470: 6174 6520 6578 7072 6573 7369 6f6e 2061  ate expression a
-00024480: 6e64 2061 2074 696d 6520 6578 7072 6573  nd a time expres
-00024490: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
-000244a0: 6c65 2031 3a3a 0a0a 2020 2020 2020 2020  le 1::..        
-000244b0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000244c0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000244d0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-000244e0: 2020 205b 5b32 3032 322c 2034 2c20 312c     [[2022, 4, 1,
-000244f0: 2031 312c 2031 312c 2030 5d2c 205b 3230   11, 11, 0], [20
-00024500: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
-00024510: 312c 2030 5d5d 2c0a 2020 2020 2020 2020  1, 0]],.        
-00024520: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-00024530: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
-00024540: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
-00024550: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
-00024560: 6422 5d2c 0a20 2020 2020 2020 202e 2e2e  d"],.        ...
-00024570: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-00024580: 662e 7365 6c65 6374 2874 696d 6573 7461  f.select(timesta
-00024590: 6d70 5f66 726f 6d5f 7061 7274 7328 0a20  mp_from_parts(. 
-000245a0: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
-000245b0: 7965 6172 222c 2022 6d6f 6e74 6822 2c20  year", "month", 
-000245c0: 2264 6179 222c 2022 686f 7572 222c 2022  "day", "hour", "
-000245d0: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
-000245e0: 220a 2020 2020 2020 2020 2e2e 2e20 292e  ".        ... ).
-000245f0: 616c 6961 7328 2254 494d 4553 5441 4d50  alias("TIMESTAMP
-00024600: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
-00024610: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00024620: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
-00024630: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
-00024640: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-00024650: 322c 2034 2c20 312c 2031 312c 2031 3129  2, 4, 1, 11, 11)
-00024660: 292c 2052 6f77 2854 494d 4553 5441 4d50  ), Row(TIMESTAMP
-00024670: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
-00024680: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00024690: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
-000246a0: 3129 295d 0a0a 2020 2020 4578 616d 706c  1))]..    Exampl
-000246b0: 6520 323a 3a0a 0a20 2020 2020 2020 203e  e 2::..        >
-000246c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000246d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000246e0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-000246f0: 2020 5b5b 2732 3032 322d 3034 2d30 3127    [['2022-04-01'
-00024700: 2c20 2731 313a 3131 3a30 3027 5d2c 205b  , '11:11:00'], [
-00024710: 2732 3032 322d 3033 2d33 3127 2c20 2731  '2022-03-31', '1
-00024720: 313a 3131 3a30 3027 5d5d 2c0a 2020 2020  1:11:00']],.    
-00024730: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-00024740: 6d61 3d5b 2264 6174 6522 2c20 2274 696d  ma=["date", "tim
-00024750: 6522 5d0a 2020 2020 2020 2020 2e2e 2e20  e"].        ... 
-00024760: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00024770: 2e73 656c 6563 7428 0a20 2020 2020 2020  .select(.       
-00024780: 202e 2e2e 2020 2020 2074 696d 6573 7461   ...     timesta
-00024790: 6d70 5f66 726f 6d5f 7061 7274 7328 746f  mp_from_parts(to
-000247a0: 5f64 6174 6528 2264 6174 6522 292c 2074  _date("date"), t
-000247b0: 6f5f 7469 6d65 2822 7469 6d65 2229 0a20  o_time("time"). 
-000247c0: 2020 2020 2020 202e 2e2e 2029 2e61 6c69         ... ).ali
-000247d0: 6173 2822 5449 4d45 5354 414d 505f 4652  as("TIMESTAMP_FR
-000247e0: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
-000247f0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00024800: 6f77 2854 494d 4553 5441 4d50 5f46 524f  ow(TIMESTAMP_FRO
-00024810: 4d5f 5041 5254 533d 6461 7465 7469 6d65  M_PARTS=datetime
-00024820: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
-00024830: 342c 2031 2c20 3131 2c20 3131 2929 2c20  4, 1, 11, 11)), 
-00024840: 526f 7728 5449 4d45 5354 414d 505f 4652  Row(TIMESTAMP_FR
-00024850: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
-00024860: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00024870: 2033 2c20 3331 2c20 3131 2c20 3131 2929   3, 31, 11, 11))
-00024880: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
-00024890: 7475 726e 2062 7569 6c74 696e 2822 7469  turn builtin("ti
-000248a0: 6d65 7374 616d 705f 6672 6f6d 5f70 6172  mestamp_from_par
-000248b0: 7473 2229 280a 2020 2020 2020 2020 2a5f  ts")(.        *_
-000248c0: 7469 6d65 7374 616d 705f 6672 6f6d 5f70  timestamp_from_p
-000248d0: 6172 7473 5f69 6e74 6572 6e61 6c28 2274  arts_internal("t
-000248e0: 696d 6573 7461 6d70 5f66 726f 6d5f 7061  imestamp_from_pa
-000248f0: 7274 7322 2c20 2a61 7267 732c 202a 2a6b  rts", *args, **k
-00024900: 7761 7267 7329 0a20 2020 2029 0a0a 0a64  wargs).    )...d
-00024910: 6566 2074 696d 6573 7461 6d70 5f6c 747a  ef timestamp_ltz
-00024920: 5f66 726f 6d5f 7061 7274 7328 0a20 2020  _from_parts(.   
-00024930: 2079 6561 723a 2055 6e69 6f6e 5b43 6f6c   year: Union[Col
-00024940: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
-00024950: 0a20 2020 206d 6f6e 7468 3a20 556e 696f  .    month: Unio
-00024960: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-00024970: 696e 745d 2c0a 2020 2020 6461 793a 2055  int],.    day: U
-00024980: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00024990: 652c 2069 6e74 5d2c 0a20 2020 2068 6f75  e, int],.    hou
-000249a0: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
-000249b0: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
-000249c0: 206d 696e 7574 653a 2055 6e69 6f6e 5b43   minute: Union[C
-000249d0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-000249e0: 5d2c 0a20 2020 2073 6563 6f6e 643a 2055  ],.    second: U
-000249f0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00024a00: 652c 2069 6e74 5d2c 0a20 2020 206e 616e  e, int],.    nan
-00024a10: 6f73 6563 6f6e 6473 3a20 4f70 7469 6f6e  oseconds: Option
-00024a20: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f  al[Union[ColumnO
-00024a30: 724e 616d 652c 2069 6e74 5d5d 203d 204e  rName, int]] = N
-00024a40: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
-00024a50: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
-00024a60: 6561 7465 7320 6120 7469 6d65 7374 616d  eates a timestam
-00024a70: 7020 6672 6f6d 2069 6e64 6976 6964 7561  p from individua
-00024a80: 6c20 6e75 6d65 7269 6320 636f 6d70 6f6e  l numeric compon
-00024a90: 656e 7473 2e0a 0a20 2020 2045 7861 6d70  ents...    Examp
-00024aa0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00024ab0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
-00024ac0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00024ad0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00024ae0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-00024af0: 2020 2020 202e 2e2e 2020 2020 205b 5b32       ...     [[2
-00024b00: 3032 322c 2034 2c20 312c 2031 312c 2031  022, 4, 1, 11, 1
-00024b10: 312c 2030 5d2c 205b 3230 3232 2c20 332c  1, 0], [2022, 3,
-00024b20: 2033 312c 2031 312c 2031 312c 2030 5d5d   31, 11, 11, 0]]
-00024b30: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00024b40: 2020 7363 6865 6d61 3d5b 2279 6561 7222    schema=["year"
-00024b50: 2c20 226d 6f6e 7468 222c 2022 6461 7922  , "month", "day"
-00024b60: 2c20 2268 6f75 7222 2c20 226d 696e 7574  , "hour", "minut
-00024b70: 6522 2c20 2273 6563 6f6e 6422 5d2c 0a20  e", "second"],. 
-00024b80: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00024b90: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00024ba0: 6374 2874 696d 6573 7461 6d70 5f6c 747a  ct(timestamp_ltz
-00024bb0: 5f66 726f 6d5f 7061 7274 7328 0a20 2020  _from_parts(.   
-00024bc0: 2020 2020 202e 2e2e 2020 2020 2022 7965       ...     "ye
-00024bd0: 6172 222c 2022 6d6f 6e74 6822 2c20 2264  ar", "month", "d
-00024be0: 6179 222c 2022 686f 7572 222c 2022 6d69  ay", "hour", "mi
-00024bf0: 6e75 7465 222c 2022 7365 636f 6e64 220a  nute", "second".
-00024c00: 2020 2020 2020 2020 2e2e 2e20 292e 616c          ... ).al
-00024c10: 6961 7328 2254 494d 4553 5441 4d50 5f4c  ias("TIMESTAMP_L
-00024c20: 545a 5f46 524f 4d5f 5041 5254 5322 2929  TZ_FROM_PARTS"))
-00024c30: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00024c40: 2020 205b 526f 7728 5449 4d45 5354 414d     [Row(TIMESTAM
-00024c50: 505f 4c54 5a5f 4652 4f4d 5f50 4152 5453  P_LTZ_FROM_PARTS
-00024c60: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-00024c70: 6d65 2832 3032 322c 2034 2c20 312c 2031  me(2022, 4, 1, 1
-00024c80: 312c 2031 312c 2074 7a69 6e66 6f3d 3c44  1, 11, tzinfo=<D
-00024c90: 7374 547a 496e 666f 2027 416d 6572 6963  stTzInfo 'Americ
-00024ca0: 612f 4c6f 735f 416e 6765 6c65 7327 2050  a/Los_Angeles' P
-00024cb0: 4454 2d31 2064 6179 2c20 3137 3a30 303a  DT-1 day, 17:00:
-00024cc0: 3030 2044 5354 3e29 292c 2052 6f77 2854  00 DST>)), Row(T
-00024cd0: 494d 4553 5441 4d50 5f4c 545a 5f46 524f  IMESTAMP_LTZ_FRO
-00024ce0: 4d5f 5041 5254 533d 6461 7465 7469 6d65  M_PARTS=datetime
-00024cf0: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
-00024d00: 332c 2033 312c 2031 312c 2031 312c 2074  3, 31, 11, 11, t
-00024d10: 7a69 6e66 6f3d 3c44 7374 547a 496e 666f  zinfo=<DstTzInfo
-00024d20: 2027 416d 6572 6963 612f 4c6f 735f 416e   'America/Los_An
-00024d30: 6765 6c65 7327 2050 4454 2d31 2064 6179  geles' PDT-1 day
-00024d40: 2c20 3137 3a30 303a 3030 2044 5354 3e29  , 17:00:00 DST>)
-00024d50: 295d 0a20 2020 2022 2222 0a20 2020 2066  )].    """.    f
-00024d60: 756e 635f 6e61 6d65 203d 2022 7469 6d65  unc_name = "time
-00024d70: 7374 616d 705f 6c74 7a5f 6672 6f6d 5f70  stamp_ltz_from_p
-00024d80: 6172 7473 220a 2020 2020 792c 206d 2c20  arts".    y, m, 
-00024d90: 642c 2068 2c20 6d69 6e5f 2c20 7320 3d20  d, h, min_, s = 
-00024da0: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
-00024db0: 6d65 7374 616d 705f 7061 7274 7328 0a20  mestamp_parts(. 
-00024dc0: 2020 2020 2020 2066 756e 635f 6e61 6d65         func_name
-00024dd0: 2c20 7965 6172 2c20 6d6f 6e74 682c 2064  , year, month, d
-00024de0: 6179 2c20 686f 7572 2c20 6d69 6e75 7465  ay, hour, minute
-00024df0: 2c20 7365 636f 6e64 0a20 2020 2029 0a20  , second.    ). 
-00024e00: 2020 206e 7320 3d20 4e6f 6e65 2069 6620     ns = None if 
-00024e10: 6e61 6e6f 7365 636f 6e64 7320 6973 204e  nanoseconds is N
-00024e20: 6f6e 6520 656c 7365 205f 746f 5f63 6f6c  one else _to_col
-00024e30: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
-00024e40: 616e 6f73 6563 6f6e 6473 2c20 6675 6e63  anoseconds, func
-00024e50: 5f6e 616d 6529 0a20 2020 2072 6574 7572  _name).    retur
-00024e60: 6e20 280a 2020 2020 2020 2020 6275 696c  n (.        buil
-00024e70: 7469 6e28 6675 6e63 5f6e 616d 6529 2879  tin(func_name)(y
-00024e80: 2c20 6d2c 2064 2c20 682c 206d 696e 5f2c  , m, d, h, min_,
-00024e90: 2073 290a 2020 2020 2020 2020 6966 206e   s).        if n
-00024ea0: 7320 6973 204e 6f6e 650a 2020 2020 2020  s is None.      
-00024eb0: 2020 656c 7365 2062 7569 6c74 696e 2866    else builtin(f
-00024ec0: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
-00024ed0: 642c 2068 2c20 6d69 6e5f 2c20 732c 206e  d, h, min_, s, n
-00024ee0: 7329 0a20 2020 2029 0a0a 0a40 6f76 6572  s).    )...@over
-00024ef0: 6c6f 6164 0a64 6566 2074 696d 6573 7461  load.def timesta
-00024f00: 6d70 5f6e 747a 5f66 726f 6d5f 7061 7274  mp_ntz_from_part
-00024f10: 7328 0a20 2020 2064 6174 655f 6578 7072  s(.    date_expr
-00024f20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00024f30: 7469 6d65 5f65 7870 723a 2043 6f6c 756d  time_expr: Colum
-00024f40: 6e4f 724e 616d 650a 2920 2d3e 2043 6f6c  nOrName.) -> Col
-00024f50: 756d 6e3a 0a20 2020 202e 2e2e 2020 2320  umn:.    ...  # 
-00024f60: 7072 6167 6d61 3a20 6e6f 2063 6f76 6572  pragma: no cover
-00024f70: 0a0a 0a40 6f76 6572 6c6f 6164 0a64 6566  ...@overload.def
-00024f80: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
-00024f90: 726f 6d5f 7061 7274 7328 0a20 2020 2079  rom_parts(.    y
-00024fa0: 6561 723a 2055 6e69 6f6e 5b43 6f6c 756d  ear: Union[Colum
-00024fb0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-00024fc0: 2020 206d 6f6e 7468 3a20 556e 696f 6e5b     month: Union[
-00024fd0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-00024fe0: 745d 2c0a 2020 2020 6461 793a 2055 6e69  t],.    day: Uni
-00024ff0: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-00025000: 2069 6e74 5d2c 0a20 2020 2068 6f75 723a   int],.    hour:
-00025010: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
-00025020: 616d 652c 2069 6e74 5d2c 0a20 2020 206d  ame, int],.    m
-00025030: 696e 7574 653a 2055 6e69 6f6e 5b43 6f6c  inute: Union[Col
-00025040: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
-00025050: 0a20 2020 2073 6563 6f6e 643a 2055 6e69  .    second: Uni
-00025060: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-00025070: 2069 6e74 5d2c 0a20 2020 206e 616e 6f73   int],.    nanos
-00025080: 6563 6f6e 643a 204f 7074 696f 6e61 6c5b  econd: Optional[
-00025090: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-000250a0: 6d65 2c20 696e 745d 5d20 3d20 4e6f 6e65  me, int]] = None
-000250b0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-000250c0: 2020 202e 2e2e 2020 2320 7072 6167 6d61     ...  # pragma
-000250d0: 3a20 6e6f 2063 6f76 6572 0a0a 0a64 6566  : no cover...def
-000250e0: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
-000250f0: 726f 6d5f 7061 7274 7328 2a61 7267 732c  rom_parts(*args,
-00025100: 202a 2a6b 7761 7267 7329 202d 3e20 436f   **kwargs) -> Co
-00025110: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00025120: 2020 4372 6561 7465 7320 6120 7469 6d65    Creates a time
-00025130: 7374 616d 7020 6672 6f6d 2069 6e64 6976  stamp from indiv
-00025140: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
-00025150: 6d70 6f6e 656e 7473 2e20 5468 6520 6675  mponents. The fu
-00025160: 6e63 7469 6f6e 2063 616e 2062 6520 7573  nction can be us
-00025170: 6564 2074 6f0a 2020 2020 6372 6561 7465  ed to.    create
-00025180: 2061 2074 696d 6573 7461 6d70 2066 726f   a timestamp fro
-00025190: 6d20 6120 6461 7465 2065 7870 7265 7373  m a date express
-000251a0: 696f 6e20 616e 6420 6120 7469 6d65 2065  ion and a time e
-000251b0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
-000251c0: 4578 616d 706c 6520 313a 3a0a 0a20 2020  Example 1::..   
-000251d0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000251e0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000251f0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-00025200: 2e2e 2e20 2020 2020 5b5b 3230 3232 2c20  ...     [[2022, 
-00025210: 342c 2031 2c20 3131 2c20 3131 2c20 305d  4, 1, 11, 11, 0]
-00025220: 2c20 5b32 3032 322c 2033 2c20 3331 2c20  , [2022, 3, 31, 
-00025230: 3131 2c20 3131 2c20 305d 5d2c 0a20 2020  11, 11, 0]],.   
-00025240: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
-00025250: 656d 613d 5b22 7965 6172 222c 2022 6d6f  ema=["year", "mo
-00025260: 6e74 6822 2c20 2264 6179 222c 2022 686f  nth", "day", "ho
-00025270: 7572 222c 2022 6d69 6e75 7465 222c 2022  ur", "minute", "
-00025280: 7365 636f 6e64 225d 2c0a 2020 2020 2020  second"],.      
-00025290: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
-000252a0: 3e3e 3e20 6466 2e73 656c 6563 7428 7469  >>> df.select(ti
-000252b0: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
-000252c0: 5f70 6172 7473 280a 2020 2020 2020 2020  _parts(.        
-000252d0: 2e2e 2e20 2020 2020 2279 6561 7222 2c20  ...     "year", 
-000252e0: 226d 6f6e 7468 222c 2022 6461 7922 2c20  "month", "day", 
-000252f0: 2268 6f75 7222 2c20 226d 696e 7574 6522  "hour", "minute"
-00025300: 2c20 2273 6563 6f6e 6422 0a20 2020 2020  , "second".     
-00025310: 2020 202e 2e2e 2029 2e61 6c69 6173 2822     ... ).alias("
-00025320: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
-00025330: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
-00025340: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00025350: 6f77 2854 494d 4553 5441 4d50 5f4e 545a  ow(TIMESTAMP_NTZ
-00025360: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
-00025370: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00025380: 3232 2c20 342c 2031 2c20 3131 2c20 3131  22, 4, 1, 11, 11
-00025390: 2929 2c20 526f 7728 5449 4d45 5354 414d  )), Row(TIMESTAM
-000253a0: 505f 4e54 5a5f 4652 4f4d 5f50 4152 5453  P_NTZ_FROM_PARTS
-000253b0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-000253c0: 6d65 2832 3032 322c 2033 2c20 3331 2c20  me(2022, 3, 31, 
-000253d0: 3131 2c20 3131 2929 5d0a 0a20 2020 2045  11, 11))]..    E
-000253e0: 7861 6d70 6c65 2032 3a3a 0a0a 2020 2020  xample 2::..    
-000253f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00025400: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00025410: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
-00025420: 2e2e 2020 2020 205b 5b27 3230 3232 2d30  ..     [['2022-0
-00025430: 342d 3031 272c 2027 3131 3a31 313a 3030  4-01', '11:11:00
-00025440: 275d 2c20 5b27 3230 3232 2d30 332d 3331  '], ['2022-03-31
-00025450: 272c 2027 3131 3a31 313a 3030 275d 5d2c  ', '11:11:00']],
-00025460: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00025470: 2073 6368 656d 613d 5b22 6461 7465 222c   schema=["date",
-00025480: 2022 7469 6d65 225d 0a20 2020 2020 2020   "time"].       
-00025490: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-000254a0: 3e3e 2064 662e 7365 6c65 6374 280a 2020  >> df.select(.  
-000254b0: 2020 2020 2020 2e2e 2e20 2020 2020 7469        ...     ti
-000254c0: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
-000254d0: 5f70 6172 7473 2874 6f5f 6461 7465 2822  _parts(to_date("
-000254e0: 6461 7465 2229 2c20 746f 5f74 696d 6528  date"), to_time(
-000254f0: 2274 696d 6522 290a 2020 2020 2020 2020  "time").        
-00025500: 2e2e 2e20 292e 616c 6961 7328 2254 494d  ... ).alias("TIM
-00025510: 4553 5441 4d50 5f4e 545a 5f46 524f 4d5f  ESTAMP_NTZ_FROM_
-00025520: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
-00025530: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00025540: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
-00025550: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
-00025560: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00025570: 2034 2c20 312c 2031 312c 2031 3129 292c   4, 1, 11, 11)),
-00025580: 2052 6f77 2854 494d 4553 5441 4d50 5f4e   Row(TIMESTAMP_N
-00025590: 545a 5f46 524f 4d5f 5041 5254 533d 6461  TZ_FROM_PARTS=da
-000255a0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-000255b0: 3230 3232 2c20 332c 2033 312c 2031 312c  2022, 3, 31, 11,
-000255c0: 2031 3129 295d 0a20 2020 2022 2222 0a20   11))].    """. 
-000255d0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-000255e0: 6e28 2274 696d 6573 7461 6d70 5f6e 747a  n("timestamp_ntz
-000255f0: 5f66 726f 6d5f 7061 7274 7322 2928 0a20  _from_parts")(. 
-00025600: 2020 2020 2020 202a 5f74 696d 6573 7461         *_timesta
-00025610: 6d70 5f66 726f 6d5f 7061 7274 735f 696e  mp_from_parts_in
-00025620: 7465 726e 616c 2822 7469 6d65 7374 616d  ternal("timestam
-00025630: 705f 6e74 7a5f 6672 6f6d 5f70 6172 7473  p_ntz_from_parts
-00025640: 222c 202a 6172 6773 2c20 2a2a 6b77 6172  ", *args, **kwar
-00025650: 6773 290a 2020 2020 290a 0a0a 6465 6620  gs).    )...def 
-00025660: 7469 6d65 7374 616d 705f 747a 5f66 726f  timestamp_tz_fro
-00025670: 6d5f 7061 7274 7328 0a20 2020 2079 6561  m_parts(.    yea
-00025680: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
-00025690: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
-000256a0: 206d 6f6e 7468 3a20 556e 696f 6e5b 436f   month: Union[Co
-000256b0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-000256c0: 2c0a 2020 2020 6461 793a 2055 6e69 6f6e  ,.    day: Union
-000256d0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-000256e0: 6e74 5d2c 0a20 2020 2068 6f75 723a 2055  nt],.    hour: U
-000256f0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00025700: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
-00025710: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
-00025720: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-00025730: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
-00025740: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00025750: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
-00025760: 6f6e 6473 3a20 4f70 7469 6f6e 616c 5b55  onds: Optional[U
-00025770: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00025780: 652c 2069 6e74 5d5d 203d 204e 6f6e 652c  e, int]] = None,
-00025790: 0a20 2020 2074 696d 657a 6f6e 653a 204f  .    timezone: O
-000257a0: 7074 696f 6e61 6c5b 436f 6c75 6d6e 4f72  ptional[ColumnOr
-000257b0: 4c69 7465 7261 6c53 7472 5d20 3d20 4e6f  LiteralStr] = No
-000257c0: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
-000257d0: 0a20 2020 2022 2222 0a20 2020 2043 7265  .    """.    Cre
-000257e0: 6174 6573 2061 2074 696d 6573 7461 6d70  ates a timestamp
-000257f0: 2066 726f 6d20 696e 6469 7669 6475 616c   from individual
-00025800: 206e 756d 6572 6963 2063 6f6d 706f 6e65   numeric compone
-00025810: 6e74 7320 616e 6420 6120 7374 7269 6e67  nts and a string
-00025820: 2074 696d 657a 6f6e 652e 0a0a 2020 2020   timezone...    
-00025830: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00025840: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00025850: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00025860: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00025870: 2e20 2020 2020 5b5b 3230 3232 2c20 342c  .     [[2022, 4,
-00025880: 2031 2c20 3131 2c20 3131 2c20 302c 2027   1, 11, 11, 0, '
-00025890: 416d 6572 6963 612f 4c6f 735f 416e 6765  America/Los_Ange
-000258a0: 6c65 7327 5d2c 205b 3230 3232 2c20 332c  les'], [2022, 3,
-000258b0: 2033 312c 2031 312c 2031 312c 2030 2c20   31, 11, 11, 0, 
-000258c0: 2741 6d65 7269 6361 2f4c 6f73 5f41 6e67  'America/Los_Ang
-000258d0: 656c 6573 275d 5d2c 0a20 2020 2020 2020  eles']],.       
-000258e0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-000258f0: 5b22 7965 6172 222c 2022 6d6f 6e74 6822  ["year", "month"
-00025900: 2c20 2264 6179 222c 2022 686f 7572 222c  , "day", "hour",
-00025910: 2022 6d69 6e75 7465 222c 2022 7365 636f   "minute", "seco
-00025920: 6e64 222c 2022 7469 6d65 7a6f 6e65 225d  nd", "timezone"]
-00025930: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
-00025940: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00025950: 656c 6563 7428 7469 6d65 7374 616d 705f  elect(timestamp_
-00025960: 747a 5f66 726f 6d5f 7061 7274 7328 0a20  tz_from_parts(. 
-00025970: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
-00025980: 7965 6172 222c 2022 6d6f 6e74 6822 2c20  year", "month", 
-00025990: 2264 6179 222c 2022 686f 7572 222c 2022  "day", "hour", "
-000259a0: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
-000259b0: 222c 2074 696d 657a 6f6e 653d 2274 696d  ", timezone="tim
-000259c0: 657a 6f6e 6522 0a20 2020 2020 2020 202e  ezone".        .
-000259d0: 2e2e 2029 2e61 6c69 6173 2822 5449 4d45  .. ).alias("TIME
-000259e0: 5354 414d 505f 545a 5f46 524f 4d5f 5041  STAMP_TZ_FROM_PA
-000259f0: 5254 5322 2929 2e63 6f6c 6c65 6374 2829  RTS")).collect()
-00025a00: 0a20 2020 2020 2020 205b 526f 7728 5449  .        [Row(TI
-00025a10: 4d45 5354 414d 505f 545a 5f46 524f 4d5f  MESTAMP_TZ_FROM_
-00025a20: 5041 5254 533d 6461 7465 7469 6d65 2e64  PARTS=datetime.d
-00025a30: 6174 6574 696d 6528 3230 3232 2c20 342c  atetime(2022, 4,
-00025a40: 2031 2c20 3131 2c20 3131 2c20 747a 696e   1, 11, 11, tzin
-00025a50: 666f 3d70 7974 7a2e 4669 7865 644f 6666  fo=pytz.FixedOff
-00025a60: 7365 7428 2d34 3230 2929 292c 2052 6f77  set(-420))), Row
-00025a70: 2854 494d 4553 5441 4d50 5f54 5a5f 4652  (TIMESTAMP_TZ_FR
-00025a80: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
-00025a90: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00025aa0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
-00025ab0: 747a 696e 666f 3d70 7974 7a2e 4669 7865  tzinfo=pytz.Fixe
-00025ac0: 644f 6666 7365 7428 2d34 3230 2929 295d  dOffset(-420)))]
-00025ad0: 0a20 2020 2022 2222 0a20 2020 2066 756e  .    """.    fun
-00025ae0: 635f 6e61 6d65 203d 2022 7469 6d65 7374  c_name = "timest
-00025af0: 616d 705f 747a 5f66 726f 6d5f 7061 7274  amp_tz_from_part
-00025b00: 7322 0a20 2020 2079 2c20 6d2c 2064 2c20  s".    y, m, d, 
-00025b10: 682c 206d 696e 5f2c 2073 203d 205f 636f  h, min_, s = _co
-00025b20: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
-00025b30: 7461 6d70 5f70 6172 7473 280a 2020 2020  tamp_parts(.    
-00025b40: 2020 2020 6675 6e63 5f6e 616d 652c 2079      func_name, y
-00025b50: 6561 722c 206d 6f6e 7468 2c20 6461 792c  ear, month, day,
-00025b60: 2068 6f75 722c 206d 696e 7574 652c 2073   hour, minute, s
-00025b70: 6563 6f6e 640a 2020 2020 290a 2020 2020  econd.    ).    
-00025b80: 6e73 203d 204e 6f6e 6520 6966 206e 616e  ns = None if nan
-00025b90: 6f73 6563 6f6e 6473 2069 7320 4e6f 6e65  oseconds is None
-00025ba0: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
-00025bb0: 5f73 7472 5f6f 725f 696e 7428 6e61 6e6f  _str_or_int(nano
-00025bc0: 7365 636f 6e64 732c 2066 756e 635f 6e61  seconds, func_na
-00025bd0: 6d65 290a 2020 2020 747a 203d 204e 6f6e  me).    tz = Non
-00025be0: 6520 6966 2074 696d 657a 6f6e 6520 6973  e if timezone is
-00025bf0: 204e 6f6e 6520 656c 7365 205f 746f 5f63   None else _to_c
-00025c00: 6f6c 5f69 665f 7371 6c5f 6578 7072 2874  ol_if_sql_expr(t
-00025c10: 696d 657a 6f6e 652c 2066 756e 635f 6e61  imezone, func_na
-00025c20: 6d65 290a 2020 2020 6966 206e 616e 6f73  me).    if nanos
-00025c30: 6563 6f6e 6473 2069 7320 6e6f 7420 4e6f  econds is not No
-00025c40: 6e65 2061 6e64 2074 696d 657a 6f6e 6520  ne and timezone 
-00025c50: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00025c60: 2020 2020 2072 6574 7572 6e20 6275 696c       return buil
-00025c70: 7469 6e28 6675 6e63 5f6e 616d 6529 2879  tin(func_name)(y
-00025c80: 2c20 6d2c 2064 2c20 682c 206d 696e 5f2c  , m, d, h, min_,
-00025c90: 2073 2c20 6e73 2c20 747a 290a 2020 2020   s, ns, tz).    
-00025ca0: 656c 6966 206e 616e 6f73 6563 6f6e 6473  elif nanoseconds
-00025cb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00025cc0: 2020 2020 2020 7265 7475 726e 2062 7569        return bui
-00025cd0: 6c74 696e 2866 756e 635f 6e61 6d65 2928  ltin(func_name)(
-00025ce0: 792c 206d 2c20 642c 2068 2c20 6d69 6e5f  y, m, d, h, min_
-00025cf0: 2c20 732c 206e 7329 0a20 2020 2065 6c69  , s, ns).    eli
-00025d00: 6620 7469 6d65 7a6f 6e65 2069 7320 6e6f  f timezone is no
-00025d10: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00025d20: 7265 7475 726e 2062 7569 6c74 696e 2866  return builtin(f
-00025d30: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
-00025d40: 642c 2068 2c20 6d69 6e5f 2c20 732c 206c  d, h, min_, s, l
-00025d50: 6974 2830 292c 2074 7a29 0a20 2020 2065  it(0), tz).    e
-00025d60: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-00025d70: 7572 6e20 6275 696c 7469 6e28 6675 6e63  urn builtin(func
-00025d80: 5f6e 616d 6529 2879 2c20 6d2c 2064 2c20  _name)(y, m, d, 
-00025d90: 682c 206d 696e 5f2c 2073 290a 0a0a 6465  h, min_, s)...de
-00025da0: 6620 7765 656b 6f66 7965 6172 2865 3a20  f weekofyear(e: 
-00025db0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00025dc0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00025dd0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
-00025de0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
-00025df0: 7765 656b 2028 6e75 6d62 6572 2920 6f66  week (number) of
-00025e00: 2074 6865 2079 6561 7220 6672 6f6d 2061   the year from a
-00025e10: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
-00025e20: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
-00025e30: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00025e40: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00025e50: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00025e60: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00025e70: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-00025e80: 2020 202e 2e2e 2020 2020 205b 5b64 6174     ...     [[dat
-00025e90: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
-00025ea0: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
-00025eb0: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
-00025ec0: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
-00025ed0: 254d 3a25 532e 2566 2229 5d5d 2c0a 2020  %M:%S.%f")]],.  
-00025ee0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-00025ef0: 6865 6d61 3d5b 2261 225d 2c0a 2020 2020  hema=["a"],.    
-00025f00: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-00025f10: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00025f20: 7765 656b 6f66 7965 6172 2822 6122 2929  weekofyear("a"))
-00025f30: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00025f40: 2020 205b 526f 7728 5745 454b 4f46 5945     [Row(WEEKOFYE
-00025f50: 4152 2822 4122 293d 3138 295d 0a20 2020  AR("A")=18)].   
-00025f60: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00025f70: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00025f80: 7765 656b 6f66 7965 6172 2229 0a20 2020  weekofyear").   
-00025f90: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00025fa0: 2277 6565 6b6f 6679 6561 7222 2928 6329  "weekofyear")(c)
-00025fb0: 0a0a 0a64 6566 2074 7970 656f 6628 636f  ...def typeof(co
-00025fc0: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
-00025fd0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00025fe0: 2222 2252 6570 6f72 7473 2074 6865 2074  """Reports the t
-00025ff0: 7970 6520 6f66 2061 2076 616c 7565 2073  ype of a value s
-00026000: 746f 7265 6420 696e 2061 2056 4152 4941  tored in a VARIA
-00026010: 4e54 2063 6f6c 756d 6e2e 2054 6865 2074  NT column. The t
-00026020: 7970 6520 6973 2072 6574 7572 6e65 6420  ype is returned 
-00026030: 6173 2061 2073 7472 696e 672e 0a0a 2020  as a string...  
-00026040: 2020 466f 7220 636f 6c75 6d6e 7320 7768    For columns wh
-00026050: 6572 6520 616c 6c20 726f 7773 2073 6861  ere all rows sha
-00026060: 7265 2074 6865 2073 616d 6520 7479 7065  re the same type
-00026070: 2c20 7468 6520 7265 7375 6c74 206f 6620  , the result of 
-00026080: 6074 7970 656f 6660 2069 7320 7468 6520  `typeof` is the 
-00026090: 756e 6465 726c 7969 6e67 2053 6e6f 7766  underlying Snowf
-000260a0: 6c61 6b65 2063 6f6c 756d 6e20 7479 7065  lake column type
-000260b0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000260c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-000260d0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-000260e0: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-000260f0: 322c 2033 5d2c 2073 6368 656d 613d 5b22  2, 3], schema=["
-00026100: 4122 5d29 0a20 2020 2020 2020 203e 3e3e  A"]).        >>>
-00026110: 2064 662e 7365 6c65 6374 2874 7970 656f   df.select(typeo
-00026120: 6628 636f 6c28 2241 2229 292e 6173 5f28  f(col("A")).as_(
-00026130: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-00026140: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00026150: 4e53 3d27 494e 5445 4745 5227 292c 2052  NS='INTEGER'), R
-00026160: 6f77 2841 4e53 3d27 494e 5445 4745 5227  ow(ANS='INTEGER'
-00026170: 292c 2052 6f77 2841 4e53 3d27 494e 5445  ), Row(ANS='INTE
-00026180: 4745 5227 295d 0a0a 2020 2020 466f 7220  GER')]..    For 
-00026190: 636f 6c75 6d6e 7320 6f66 2056 4152 4941  columns of VARIA
-000261a0: 4e54 2074 7970 652c 2074 6865 2075 6e64  NT type, the und
-000261b0: 6572 6c79 696e 6720 7374 6f72 6564 2074  erlying stored t
-000261c0: 7970 6520 6973 2072 6574 7572 6e65 642e  ype is returned.
-000261d0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-000261e0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-000261f0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00026200: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00026210: 7420 5661 7269 616e 7454 7970 652c 2053  t VariantType, S
-00026220: 7472 7563 7454 7970 652c 2053 7472 7563  tructType, Struc
-00026230: 7446 6965 6c64 0a20 2020 2020 2020 203e  tField.        >
-00026240: 3e3e 2073 6368 656d 6120 3d20 5374 7275  >> schema = Stru
-00026250: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
-00026260: 656c 6428 2241 222c 2056 6172 6961 6e74  eld("A", Variant
-00026270: 5479 7065 2829 295d 290a 2020 2020 2020  Type())]).      
-00026280: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00026290: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000262a0: 616d 6528 5b31 2c20 332e 312c 2027 7465  ame([1, 3.1, 'te
-000262b0: 7374 275d 2c20 7363 6865 6d61 3d73 6368  st'], schema=sch
-000262c0: 656d 6129 0a20 2020 2020 2020 203e 3e3e  ema).        >>>
-000262d0: 2064 662e 7365 6c65 6374 2874 7970 656f   df.select(typeo
-000262e0: 6628 636f 6c28 2241 2229 292e 6173 5f28  f(col("A")).as_(
-000262f0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-00026300: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00026310: 4e53 3d27 494e 5445 4745 5227 292c 2052  NS='INTEGER'), R
-00026320: 6f77 2841 4e53 3d27 4445 4349 4d41 4c27  ow(ANS='DECIMAL'
-00026330: 292c 2052 6f77 2841 4e53 3d27 5641 5243  ), Row(ANS='VARC
-00026340: 4841 5227 295d 0a0a 2020 2020 2222 220a  HAR')]..    """.
-00026350: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00026360: 6966 5f73 7472 2863 6f6c 2c20 2274 7970  if_str(col, "typ
-00026370: 656f 6622 290a 2020 2020 7265 7475 726e  eof").    return
-00026380: 2062 7569 6c74 696e 2822 7479 7065 6f66   builtin("typeof
-00026390: 2229 2863 290a 0a0a 6465 6620 6368 6563  ")(c)...def chec
-000263a0: 6b5f 6a73 6f6e 2863 6f6c 3a20 436f 6c75  k_json(col: Colu
-000263b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000263c0: 756d 6e3a 0a20 2020 2022 2222 4368 6563  umn:.    """Chec
-000263d0: 6b73 2074 6865 2076 616c 6964 6974 7920  ks the validity 
-000263e0: 6f66 2061 204a 534f 4e20 646f 6375 6d65  of a JSON docume
-000263f0: 6e74 2e0a 2020 2020 4966 2074 6865 2069  nt..    If the i
-00026400: 6e70 7574 2073 7472 696e 6720 6973 2061  nput string is a
-00026410: 2076 616c 6964 204a 534f 4e20 646f 6375   valid JSON docu
-00026420: 6d65 6e74 206f 7220 6120 4e55 4c4c 2028  ment or a NULL (
-00026430: 692e 652e 206e 6f20 6572 726f 7220 776f  i.e. no error wo
-00026440: 756c 6420 6f63 6375 7220 7768 656e 0a20  uld occur when. 
-00026450: 2020 2070 6172 7369 6e67 2074 6865 2069     parsing the i
-00026460: 6e70 7574 2073 7472 696e 6729 2c20 7468  nput string), th
-00026470: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-00026480: 6e73 204e 554c 4c2e 0a20 2020 2049 6e20  ns NULL..    In 
-00026490: 6361 7365 206f 6620 6120 4a53 4f4e 2070  case of a JSON p
-000264a0: 6172 7369 6e67 2065 7272 6f72 2c20 7468  arsing error, th
-000264b0: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-000264c0: 6e73 2061 2073 7472 696e 6720 7468 6174  ns a string that
-000264d0: 2063 6f6e 7461 696e 7320 7468 6520 6572   contains the er
-000264e0: 726f 720a 2020 2020 6d65 7373 6167 652e  ror.    message.
-000264f0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00026500: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00026510: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00026520: 5f64 6174 6166 7261 6d65 285b 227b 2756  _dataframe(["{'V
-00026530: 616c 6964 4b65 7931 273a 2027 5661 6c69  alidKey1': 'Vali
-00026540: 6456 616c 7565 3127 7d22 2c20 227b 274d  dValue1'}", "{'M
-00026550: 616c 666f 726d 6564 202d 2d20 6d69 7373  alformed -- miss
-00026560: 696e 6720 7661 6c27 3a7d 222c 204e 6f6e  ing val':}", Non
-00026570: 655d 2c20 7363 6865 6d61 3d5b 2761 275d  e], schema=['a']
-00026580: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00026590: 2e73 656c 6563 7428 6368 6563 6b5f 6a73  .select(check_js
-000265a0: 6f6e 2864 662e 6129 292e 7368 6f77 2829  on(df.a)).show()
-000265b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000265c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000265d0: 0a20 2020 2020 2020 207c 2243 4845 434b  .        |"CHECK
-000265e0: 5f4a 534f 4e28 2222 4122 2229 2220 207c  _JSON(""A"")"  |
-000265f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00026600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026610: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
-00026620: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00026630: 0a20 2020 2020 2020 207c 6d69 7370 6c61  .        |mispla
-00026640: 6365 6420 7d2c 2070 6f73 2032 3920 207c  ced }, pos 29  |
-00026650: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
-00026660: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00026670: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00026680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026690: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-000266a0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-000266b0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000266c0: 7374 7228 636f 6c2c 2022 6368 6563 6b5f  str(col, "check_
-000266d0: 6a73 6f6e 2229 0a20 2020 2072 6574 7572  json").    retur
-000266e0: 6e20 6275 696c 7469 6e28 2263 6865 636b  n builtin("check
-000266f0: 5f6a 736f 6e22 2928 6329 0a0a 0a64 6566  _json")(c)...def
-00026700: 2063 6865 636b 5f78 6d6c 2863 6f6c 3a20   check_xml(col: 
-00026710: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00026720: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00026730: 4368 6563 6b73 2074 6865 2076 616c 6964  Checks the valid
-00026740: 6974 7920 6f66 2061 6e20 584d 4c20 646f  ity of an XML do
-00026750: 6375 6d65 6e74 2e0a 2020 2020 4966 2074  cument..    If t
-00026760: 6865 2069 6e70 7574 2073 7472 696e 6720  he input string 
-00026770: 6973 2061 2076 616c 6964 2058 4d4c 2064  is a valid XML d
-00026780: 6f63 756d 656e 7420 6f72 2061 204e 554c  ocument or a NUL
-00026790: 4c20 2869 2e65 2e20 6e6f 2065 7272 6f72  L (i.e. no error
-000267a0: 2077 6f75 6c64 206f 6363 7572 2077 6865   would occur whe
-000267b0: 6e20 7061 7273 696e 670a 2020 2020 7468  n parsing.    th
-000267c0: 6520 696e 7075 7420 7374 7269 6e67 292c  e input string),
-000267d0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-000267e0: 7475 726e 7320 4e55 4c4c 2e0a 2020 2020  turns NULL..    
-000267f0: 496e 2063 6173 6520 6f66 2061 6e20 584d  In case of an XM
-00026800: 4c20 7061 7273 696e 6720 6572 726f 722c  L parsing error,
-00026810: 2074 6865 206f 7574 7075 7420 7374 7269   the output stri
-00026820: 6e67 2063 6f6e 7461 696e 7320 7468 6520  ng contains the 
-00026830: 6572 726f 7220 6d65 7373 6167 652e 0a0a  error message...
-00026840: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00026850: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00026860: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00026870: 6174 6166 7261 6d65 285b 223c 6e61 6d65  ataframe(["<name
-00026880: 3e20 5661 6c69 6420 3c2f 6e61 6d65 3e22  > Valid </name>"
-00026890: 2c20 223c 6e61 6d65 3e20 496e 7661 6c69  , "<name> Invali
-000268a0: 6420 3c2f 5752 4f4e 475f 434c 4f53 494e  d </WRONG_CLOSIN
-000268b0: 475f 5441 473e 222c 204e 6f6e 655d 2c20  G_TAG>", None], 
-000268c0: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
-000268d0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000268e0: 6563 7428 6368 6563 6b5f 786d 6c28 6466  ect(check_xml(df
-000268f0: 2e61 2929 2e73 686f 7728 290a 2020 2020  .a)).show().    
-00026900: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00026910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026930: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00026940: 7c22 4348 4543 4b5f 584d 4c28 2222 4122  |"CHECK_XML(""A"
-00026950: 2229 2220 2020 2020 2020 2020 2020 2020  ")"             
-00026960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026970: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00026980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000269a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000269b0: 2020 2020 2020 2020 7c4e 554c 4c20 2020          |NULL   
-000269c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269e0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-000269f0: 2020 2020 7c6e 6f20 6f70 656e 696e 6720      |no opening 
-00026a00: 7461 6720 666f 7220 3c2f 5752 4f4e 475f  tag for </WRONG_
-00026a10: 434c 4f53 494e 475f 5441 473e 2c20 706f  CLOSING_TAG>, po
-00026a20: 7320 3335 2020 7c0a 2020 2020 2020 2020  s 35  |.        
-00026a30: 7c4e 554c 4c20 2020 2020 2020 2020 2020  |NULL           
-00026a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00026a70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-00026aa0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00026ab0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-00026ac0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00026ad0: 7472 2863 6f6c 2c20 2263 6865 636b 5f78  tr(col, "check_x
-00026ae0: 6d6c 2229 0a20 2020 2072 6574 7572 6e20  ml").    return 
-00026af0: 6275 696c 7469 6e28 2263 6865 636b 5f78  builtin("check_x
-00026b00: 6d6c 2229 2863 290a 0a0a 6465 6620 6a73  ml")(c)...def js
-00026b10: 6f6e 5f65 7874 7261 6374 5f70 6174 685f  on_extract_path_
-00026b20: 7465 7874 2863 6f6c 3a20 436f 6c75 6d6e  text(col: Column
-00026b30: 4f72 4e61 6d65 2c20 7061 7468 3a20 436f  OrName, path: Co
-00026b40: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00026b50: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00026b60: 2020 2050 6172 7365 7320 6120 4a53 4f4e     Parses a JSON
-00026b70: 2073 7472 696e 6720 616e 6420 7265 7475   string and retu
-00026b80: 726e 7320 7468 6520 7661 6c75 6520 6f66  rns the value of
-00026b90: 2061 6e20 656c 656d 656e 7420 6174 2061   an element at a
-00026ba0: 2073 7065 6369 6669 6564 2070 6174 6820   specified path 
-00026bb0: 696e 2074 6865 2072 6573 756c 7469 6e67  in the resulting
-00026bc0: 0a20 2020 204a 534f 4e20 646f 6375 6d65  .    JSON docume
-00026bd0: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
-00026be0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00026bf0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00026c00: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-00026c10: 7320 696d 706f 7274 206a 736f 6e5f 6578  s import json_ex
-00026c20: 7472 6163 745f 7061 7468 5f74 6578 742c  tract_path_text,
-00026c30: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
-00026c40: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00026c50: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00026c60: 6672 616d 6528 5b5b 7b22 6122 3a20 2266  frame([[{"a": "f
-00026c70: 6f6f 227d 2c20 2261 225d 2c20 5b7b 2261  oo"}, "a"], [{"a
-00026c80: 223a 204e 6f6e 657d 2c20 2261 225d 2c20  ": None}, "a"], 
-00026c90: 5b7b 2261 223a 2022 666f 6f22 7d2c 2022  [{"a": "foo"}, "
-00026ca0: 6222 5d2c 205b 4e6f 6e65 2c20 2261 225d  b"], [None, "a"]
-00026cb0: 5d2c 2073 6368 656d 613d 5b22 6b22 2c20  ], schema=["k", 
-00026cc0: 2276 225d 290a 2020 2020 2020 2020 3e3e  "v"]).        >>
-00026cd0: 3e20 6466 2e73 656c 6563 7428 6a73 6f6e  > df.select(json
-00026ce0: 5f65 7874 7261 6374 5f70 6174 685f 7465  _extract_path_te
-00026cf0: 7874 2874 6f5f 7661 7269 616e 7428 226b  xt(to_variant("k
-00026d00: 2229 2c20 2276 2229 2e61 735f 2822 7265  "), "v").as_("re
-00026d10: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-00026d20: 2020 2020 2020 205b 526f 7728 5245 533d         [Row(RES=
-00026d30: 2766 6f6f 2729 2c20 526f 7728 5245 533d  'foo'), Row(RES=
-00026d40: 4e6f 6e65 292c 2052 6f77 2852 4553 3d4e  None), Row(RES=N
-00026d50: 6f6e 6529 2c20 526f 7728 5245 533d 4e6f  one), Row(RES=No
-00026d60: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
-00026d70: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00026d80: 7374 7228 636f 6c2c 2022 6a73 6f6e 5f65  str(col, "json_e
-00026d90: 7874 7261 6374 5f70 6174 685f 7465 7874  xtract_path_text
-00026da0: 2229 0a20 2020 2070 203d 205f 746f 5f63  ").    p = _to_c
-00026db0: 6f6c 5f69 665f 7374 7228 7061 7468 2c20  ol_if_str(path, 
-00026dc0: 226a 736f 6e5f 6578 7472 6163 745f 7061  "json_extract_pa
-00026dd0: 7468 5f74 6578 7422 290a 2020 2020 7265  th_text").    re
-00026de0: 7475 726e 2062 7569 6c74 696e 2822 6a73  turn builtin("js
-00026df0: 6f6e 5f65 7874 7261 6374 5f70 6174 685f  on_extract_path_
-00026e00: 7465 7874 2229 2863 2c20 7029 0a0a 0a64  text")(c, p)...d
-00026e10: 6566 2070 6172 7365 5f6a 736f 6e28 653a  ef parse_json(e:
-00026e20: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00026e30: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00026e40: 2250 6172 7365 2074 6865 2076 616c 7565  "Parse the value
-00026e50: 206f 6620 7468 6520 7370 6563 6966 6965   of the specifie
-00026e60: 6420 636f 6c75 6d6e 2061 7320 6120 4a53  d column as a JS
-00026e70: 4f4e 2073 7472 696e 6720 616e 6420 7265  ON string and re
-00026e80: 7475 726e 7320 7468 650a 2020 2020 7265  turns the.    re
-00026e90: 7375 6c74 696e 6720 4a53 4f4e 2064 6f63  sulting JSON doc
-00026ea0: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
-00026eb0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00026ec0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00026ed0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00026ee0: 285b 5b27 7b22 6b65 7922 3a20 2231 227d  ([['{"key": "1"}
-00026ef0: 275d 5d2c 2073 6368 656d 613d 5b22 6122  ']], schema=["a"
-00026f00: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00026f10: 662e 7365 6c65 6374 2870 6172 7365 5f6a  f.select(parse_j
-00026f20: 736f 6e28 6466 5b22 6122 5d29 2e61 6c69  son(df["a"]).ali
-00026f30: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-00026f40: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00026f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00026f60: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00026f70: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00026f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-00026f90: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-00026fa0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00026fb0: 207c 2020 226b 6579 223a 2022 3122 2020   |  "key": "1"  
-00026fc0: 7c0a 2020 2020 2020 2020 7c7d 2020 2020  |.        |}    
-00026fd0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00026fe0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00026ff0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00027000: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00027010: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00027020: 6966 5f73 7472 2865 2c20 2270 6172 7365  if_str(e, "parse
-00027030: 5f6a 736f 6e22 290a 2020 2020 7265 7475  _json").    retu
-00027040: 726e 2062 7569 6c74 696e 2822 7061 7273  rn builtin("pars
-00027050: 655f 6a73 6f6e 2229 2863 290a 0a0a 6465  e_json")(c)...de
-00027060: 6620 7061 7273 655f 786d 6c28 653a 2043  f parse_xml(e: C
-00027070: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00027080: 436f 6c75 6d6e 3a0a 2020 2020 2222 2250  Column:.    """P
-00027090: 6172 7365 2074 6865 2076 616c 7565 206f  arse the value o
-000270a0: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
-000270b0: 636f 6c75 6d6e 2061 7320 6120 4a53 4f4e  column as a JSON
-000270c0: 2073 7472 696e 6720 616e 6420 7265 7475   string and retu
-000270d0: 726e 7320 7468 650a 2020 2020 7265 7375  rns the.    resu
-000270e0: 6c74 696e 6720 584d 4c20 646f 6375 6d65  lting XML docume
-000270f0: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
-00027100: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00027110: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-00027120: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00027130: 2020 2273 656c 6563 7420 2863 6f6c 756d    "select (colum
-00027140: 6e31 2920 6173 2076 2066 726f 6d20 7661  n1) as v from va
-00027150: 6c75 6573 2028 273c 7431 3e66 6f6f 3c74  lues ('<t1>foo<t
-00027160: 323e 6261 723c 2f74 323e 3c74 333e 3c2f  2>bar</t2><t3></
-00027170: 7433 3e3c 2f74 313e 2729 2c20 220a 2020  t3></t1>'), ".  
-00027180: 2020 2020 2020 2e2e 2e20 2020 2020 2228        ...     "(
-00027190: 273c 7431 3e3c 2f74 313e 2729 220a 2020  '<t1></t1>')".  
-000271a0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
-000271b0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000271c0: 7428 7061 7273 655f 786d 6c28 2276 2229  t(parse_xml("v")
-000271d0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-000271e0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-000271f0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00027200: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00027210: 5355 4c54 2220 2020 2020 2020 207c 0a20  SULT"        |. 
-00027220: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00027230: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00027240: 2020 7c3c 7431 3e20 2020 2020 2020 2020    |<t1>         
-00027250: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-00027260: 666f 6f20 2020 2020 2020 2020 2020 7c0a  foo           |.
-00027270: 2020 2020 2020 2020 7c20 203c 7432 3e62          |  <t2>b
-00027280: 6172 3c2f 7432 3e20 207c 0a20 2020 2020  ar</t2>  |.     
-00027290: 2020 207c 2020 3c74 333e 3c2f 7433 3e20     |  <t3></t3> 
-000272a0: 2020 2020 7c0a 2020 2020 2020 2020 7c3c      |.        |<
-000272b0: 2f74 313e 2020 2020 2020 2020 2020 207c  /t1>           |
-000272c0: 0a20 2020 2020 2020 207c 3c74 313e 3c2f  .        |<t1></
-000272d0: 7431 3e20 2020 2020 2020 7c0a 2020 2020  t1>       |.    
-000272e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000272f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00027300: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00027310: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00027320: 6f6c 5f69 665f 7374 7228 652c 2022 7061  ol_if_str(e, "pa
-00027330: 7273 655f 786d 6c22 290a 2020 2020 7265  rse_xml").    re
-00027340: 7475 726e 2062 7569 6c74 696e 2822 7061  turn builtin("pa
-00027350: 7273 655f 786d 6c22 2928 6329 0a0a 0a64  rse_xml")(c)...d
-00027360: 6566 2073 7472 6970 5f6e 756c 6c5f 7661  ef strip_null_va
-00027370: 6c75 6528 636f 6c3a 2043 6f6c 756d 6e4f  lue(col: ColumnO
-00027380: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00027390: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
-000273a0: 7320 6120 4a53 4f4e 2022 6e75 6c6c 2220  s a JSON "null" 
-000273b0: 7661 6c75 6520 696e 2074 6865 2073 7065  value in the spe
-000273c0: 6369 6669 6564 2063 6f6c 756d 6e20 746f  cified column to
-000273d0: 2061 2053 514c 204e 554c 4c20 7661 6c75   a SQL NULL valu
-000273e0: 652e 0a20 2020 2041 6c6c 206f 7468 6572  e..    All other
-000273f0: 2056 4152 4941 4e54 2076 616c 7565 7320   VARIANT values 
-00027400: 696e 2074 6865 2063 6f6c 756d 6e20 6172  in the column ar
-00027410: 6520 7265 7475 726e 6564 2075 6e63 6861  e returned uncha
-00027420: 6e67 6564 2e0a 0a20 2020 2045 7861 6d70  nged...    Examp
-00027430: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00027440: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00027450: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00027460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00027470: 5b22 6e75 6c6c 222c 2022 3122 5d2c 0a20  ["null", "1"],. 
-00027480: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-00027490: 6368 656d 613d 5b22 5322 5d2c 0a20 2020  chema=["S"],.   
-000274a0: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
-000274b0: 7428 7374 7269 705f 6e75 6c6c 5f76 616c  t(strip_null_val
-000274c0: 7565 2870 6172 7365 5f6a 736f 6e28 636f  ue(parse_json(co
-000274d0: 6c28 2253 2229 2929 2e61 735f 2822 4222  l("S"))).as_("B"
-000274e0: 2929 2e77 6865 7265 280a 2020 2020 2020  )).where(.      
-000274f0: 2020 2e2e 2e20 2020 2020 7371 6c5f 6578    ...     sql_ex
-00027500: 7072 2822 4220 6973 206e 756c 6c22 290a  pr("B is null").
-00027510: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
-00027520: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
-00027530: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00027540: 526f 7728 423d 4e6f 6e65 295d 0a20 2020  Row(B=None)].   
-00027550: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00027560: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
-00027570: 2022 7374 7269 705f 6e75 6c6c 5f76 616c   "strip_null_val
-00027580: 7565 2229 0a20 2020 2072 6574 7572 6e20  ue").    return 
-00027590: 6275 696c 7469 6e28 2273 7472 6970 5f6e  builtin("strip_n
-000275a0: 756c 6c5f 7661 6c75 6522 2928 6329 0a0a  ull_value")(c)..
-000275b0: 0a64 6566 2061 7272 6179 5f61 6767 2863  .def array_agg(c
-000275c0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
-000275d0: 2c20 6973 5f64 6973 7469 6e63 743a 2062  , is_distinct: b
-000275e0: 6f6f 6c20 3d20 4661 6c73 6529 202d 3e20  ool = False) -> 
-000275f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00027600: 6574 7572 6e73 2074 6865 2069 6e70 7574  eturns the input
-00027610: 2076 616c 7565 732c 2070 6976 6f74 6564   values, pivoted
-00027620: 2069 6e74 6f20 616e 2041 5252 4159 2e20   into an ARRAY. 
-00027630: 4966 2074 6865 2069 6e70 7574 2069 7320  If the input is 
-00027640: 656d 7074 792c 2061 6e20 656d 7074 790a  empty, an empty.
-00027650: 2020 2020 4152 5241 5920 6973 2072 6574      ARRAY is ret
-00027660: 7572 6e65 642e 0a0a 2020 2020 4578 616d  urned...    Exam
-00027670: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00027680: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00027690: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000276a0: 5b5b 315d 2c20 5b32 5d2c 205b 335d 2c20  [[1], [2], [3], 
-000276b0: 5b31 5d5d 2c20 7363 6865 6d61 3d5b 2261  [1]], schema=["a
-000276c0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000276d0: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
-000276e0: 6167 6728 2261 222c 2054 7275 6529 2e61  agg("a", True).a
-000276f0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00027700: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00027710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00027720: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00027730: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00027740: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c5b  -----.        |[
-00027750: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00027760: 2020 207c 2020 312c 2020 2020 2020 7c0a     |  1,      |.
-00027770: 2020 2020 2020 2020 7c20 2032 2c20 2020          |  2,   
-00027780: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-00027790: 3320 2020 2020 2020 7c0a 2020 2020 2020  3       |.      
-000277a0: 2020 7c5d 2020 2020 2020 2020 207c 0a20    |]         |. 
-000277b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000277c0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-000277d0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-000277e0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-000277f0: 6966 5f73 7472 2863 6f6c 2c20 2261 7272  if_str(col, "arr
-00027800: 6179 5f61 6767 2229 0a20 2020 2072 6574  ay_agg").    ret
-00027810: 7572 6e20 5f63 616c 6c5f 6675 6e63 7469  urn _call_functi
-00027820: 6f6e 2822 6172 7261 795f 6167 6722 2c20  on("array_agg", 
-00027830: 6973 5f64 6973 7469 6e63 742c 2063 290a  is_distinct, c).
-00027840: 0a0a 6465 6620 6172 7261 795f 6170 7065  ..def array_appe
-00027850: 6e64 2861 7272 6179 3a20 436f 6c75 6d6e  nd(array: Column
-00027860: 4f72 4e61 6d65 2c20 656c 656d 656e 743a  OrName, element:
-00027870: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00027880: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00027890: 2252 6574 7572 6e73 2061 6e20 4152 5241  "Returns an ARRA
-000278a0: 5920 636f 6e74 6169 6e69 6e67 2061 6c6c  Y containing all
-000278b0: 2065 6c65 6d65 6e74 7320 6672 6f6d 2074   elements from t
-000278c0: 6865 2073 6f75 7263 6520 4152 5241 5920  he source ARRAY 
-000278d0: 6173 2077 656c 6c20 6173 2074 6865 206e  as well as the n
-000278e0: 6577 2065 6c65 6d65 6e74 2e0a 2020 2020  ew element..    
-000278f0: 5468 6520 6e65 7720 656c 656d 656e 7420  The new element 
-00027900: 6973 206c 6f63 6174 6564 2061 7420 656e  is located at en
-00027910: 6420 6f66 2074 6865 2041 5252 4159 2e0a  d of the ARRAY..
-00027920: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00027930: 2020 2061 7272 6179 3a20 5468 6520 636f     array: The co
-00027940: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-00027950: 7468 6520 736f 7572 6365 2041 5252 4159  the source ARRAY
-00027960: 2e0a 2020 2020 2020 2020 656c 656d 656e  ..        elemen
-00027970: 743a 2054 6865 2063 6f6c 756d 6e20 636f  t: The column co
-00027980: 6e74 6169 6e69 6e67 2074 6865 2065 6c65  ntaining the ele
-00027990: 6d65 6e74 2074 6f20 6265 2061 7070 656e  ment to be appen
-000279a0: 6465 642e 2054 6865 2065 6c65 6d65 6e74  ded. The element
-000279b0: 206d 6179 2062 6520 6f66 2061 6c6d 6f73   may be of almos
-000279c0: 740a 2020 2020 2020 2020 2020 2020 616e  t.            an
-000279d0: 7920 6461 7461 2074 7970 652e 2054 6865  y data type. The
-000279e0: 2064 6174 6120 7479 7065 2064 6f65 7320   data type does 
-000279f0: 6e6f 7420 6e65 6564 2074 6f20 6d61 7463  not need to matc
-00027a00: 6820 7468 6520 6461 7461 2074 7970 6528  h the data type(
-00027a10: 7329 206f 6620 7468 650a 2020 2020 2020  s) of the.      
-00027a20: 2020 2020 2020 6578 6973 7469 6e67 2065        existing e
-00027a30: 6c65 6d65 6e74 7320 696e 2074 6865 2041  lements in the A
-00027a40: 5252 4159 2e0a 0a20 2020 2045 7861 6d70  RRAY...    Examp
-00027a50: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-00027a60: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-00027a70: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
-00027a80: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
-00027a90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00027aa0: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
-00027ab0: 6f77 2861 3d5b 312c 2032 2c20 335d 295d  ow(a=[1, 2, 3])]
-00027ac0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00027ad0: 2e73 656c 6563 7428 6172 7261 795f 6170  .select(array_ap
-00027ae0: 7065 6e64 2822 6122 2c20 6c69 7428 3429  pend("a", lit(4)
-00027af0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00027b00: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00027b10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00027b20: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00027b30: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00027b40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00027b50: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
-00027b60: 2020 2020 2020 7c20 2031 2c20 2020 2020        |  1,     
-00027b70: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
-00027b80: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00027b90: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
-00027ba0: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
-00027bb0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00027bc0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00027bd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00027be0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00027bf0: 2020 2020 2222 220a 2020 2020 6120 3d20      """.    a = 
-00027c00: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-00027c10: 7272 6179 2c20 2261 7272 6179 5f61 7070  rray, "array_app
-00027c20: 656e 6422 290a 2020 2020 6520 3d20 5f74  end").    e = _t
-00027c30: 6f5f 636f 6c5f 6966 5f73 7472 2865 6c65  o_col_if_str(ele
-00027c40: 6d65 6e74 2c20 2261 7272 6179 5f61 7070  ment, "array_app
-00027c50: 656e 6422 290a 2020 2020 7265 7475 726e  end").    return
-00027c60: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
-00027c70: 6170 7065 6e64 2229 2861 2c20 6529 0a0a  append")(a, e)..
-00027c80: 0a64 6566 2061 7272 6179 5f63 6174 2861  .def array_cat(a
-00027c90: 7272 6179 313a 2043 6f6c 756d 6e4f 724e  rray1: ColumnOrN
-00027ca0: 616d 652c 2061 7272 6179 323a 2043 6f6c  ame, array2: Col
-00027cb0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00027cc0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00027cd0: 7572 6e73 2074 6865 2063 6f6e 6361 7465  urns the concate
-00027ce0: 6e61 7469 6f6e 206f 6620 7477 6f20 4152  nation of two AR
-00027cf0: 5241 5973 2e0a 0a20 2020 2041 7267 733a  RAYs...    Args:
-00027d00: 0a20 2020 2020 2020 2061 7272 6179 313a  .        array1:
-00027d10: 2043 6f6c 756d 6e20 636f 6e74 6169 6e69   Column containi
-00027d20: 6e67 2074 6865 2073 6f75 7263 6520 4152  ng the source AR
-00027d30: 5241 592e 0a20 2020 2020 2020 2061 7272  RAY..        arr
-00027d40: 6179 323a 2043 6f6c 756d 6e20 636f 6e74  ay2: Column cont
-00027d50: 6169 6e69 6e67 2074 6865 2041 5252 4159  aining the ARRAY
-00027d60: 2074 6f20 6265 2061 7070 656e 6465 6420   to be appended 
-00027d70: 746f 2061 7272 6179 312e 0a0a 2020 2020  to array1...    
-00027d80: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-00027d90: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00027da0: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
-00027db0: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
-00027dc0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00027dd0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00027de0: 6d65 285b 526f 7728 613d 5b31 2c20 322c  me([Row(a=[1, 2,
-00027df0: 2033 5d2c 2062 3d5b 342c 2035 5d29 5d29   3], b=[4, 5])])
-00027e00: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00027e10: 7365 6c65 6374 2861 7272 6179 5f63 6174  select(array_cat
-00027e20: 2822 6122 2c20 2262 2229 2e61 6c69 6173  ("a", "b").alias
-00027e30: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-00027e40: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00027e50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00027e60: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-00027e70: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00027e80: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
-00027e90: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00027ea0: 2020 312c 2020 2020 2020 7c0a 2020 2020    1,      |.    
-00027eb0: 2020 2020 7c20 2032 2c20 2020 2020 207c      |  2,      |
-00027ec0: 0a20 2020 2020 2020 207c 2020 332c 2020  .        |  3,  
-00027ed0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00027ee0: 2034 2c20 2020 2020 207c 0a20 2020 2020   4,      |.     
-00027ef0: 2020 207c 2020 3520 2020 2020 2020 7c0a     |  5       |.
-00027f00: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
-00027f10: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00027f20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00027f30: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00027f40: 2020 2222 220a 2020 2020 6131 203d 205f    """.    a1 = _
-00027f50: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
-00027f60: 7261 7931 2c20 2261 7272 6179 5f63 6174  ray1, "array_cat
-00027f70: 2229 0a20 2020 2061 3220 3d20 5f74 6f5f  ").    a2 = _to_
-00027f80: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
-00027f90: 322c 2022 6172 7261 795f 6361 7422 290a  2, "array_cat").
-00027fa0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00027fb0: 696e 2822 6172 7261 795f 6361 7422 2928  in("array_cat")(
-00027fc0: 6131 2c20 6132 290a 0a0a 6465 6620 6172  a1, a2)...def ar
-00027fd0: 7261 795f 636f 6d70 6163 7428 6172 7261  ray_compact(arra
-00027fe0: 793a 2043 6f6c 756d 6e4f 724e 616d 6529  y: ColumnOrName)
-00027ff0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00028000: 2222 2252 6574 7572 6e73 2061 2063 6f6d  """Returns a com
-00028010: 7061 6374 6564 2041 5252 4159 2077 6974  pacted ARRAY wit
-00028020: 6820 6d69 7373 696e 6720 616e 6420 6e75  h missing and nu
-00028030: 6c6c 2076 616c 7565 7320 7265 6d6f 7665  ll values remove
-00028040: 642c 0a20 2020 2065 6666 6563 7469 7665  d,.    effective
-00028050: 6c79 2063 6f6e 7665 7274 696e 6720 7370  ly converting sp
-00028060: 6172 7365 2061 7272 6179 7320 696e 746f  arse arrays into
-00028070: 2064 656e 7365 2061 7272 6179 732e 0a0a   dense arrays...
-00028080: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00028090: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
-000280a0: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
-000280b0: 6f75 7263 6520 4152 5241 5920 746f 2062  ource ARRAY to b
-000280c0: 6520 636f 6d70 6163 7465 640a 0a20 2020  e compacted..   
-000280d0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-000280e0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-000280f0: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
-00028100: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
-00028110: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00028120: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00028130: 616d 6528 5b52 6f77 2861 3d5b 312c 204e  ame([Row(a=[1, N
-00028140: 6f6e 652c 2033 5d29 5d29 0a20 2020 2020  one, 3])]).     
-00028150: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00028160: 2822 6122 2c20 6172 7261 795f 636f 6d70  ("a", array_comp
-00028170: 6163 7428 2261 2229 2e61 6c69 6173 2822  act("a").alias("
-00028180: 636f 6d70 6163 7465 6422 2929 2e73 686f  compacted")).sho
-00028190: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-000281a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000281b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-000281c0: 4122 2020 2020 2020 7c22 434f 4d50 4143  A"      |"COMPAC
-000281d0: 5445 4422 2020 7c0a 2020 2020 2020 2020  TED"  |.        
-000281e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000281f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00028200: 2020 7c5b 2020 2020 2020 2020 7c5b 2020    |[        |[  
-00028210: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00028220: 2020 2020 7c20 2031 2c20 2020 2020 7c20      |  1,     | 
-00028230: 2031 2c20 2020 2020 2020 2020 7c0a 2020   1,         |.  
-00028240: 2020 2020 2020 7c20 206e 756c 6c2c 2020        |  null,  
-00028250: 7c20 2033 2020 2020 2020 2020 2020 7c0a  |  3          |.
-00028260: 2020 2020 2020 2020 7c20 2033 2020 2020          |  3    
-00028270: 2020 7c5d 2020 2020 2020 2020 2020 2020    |]            
-00028280: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00028290: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
-000282a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000282b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000282c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-000282d0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-000282e0: 220a 2020 2020 6120 3d20 5f74 6f5f 636f  ".    a = _to_co
-000282f0: 6c5f 6966 5f73 7472 2861 7272 6179 2c20  l_if_str(array, 
-00028300: 2261 7272 6179 5f63 6f6d 7061 6374 2229  "array_compact")
-00028310: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00028320: 7469 6e28 2261 7272 6179 5f63 6f6d 7061  tin("array_compa
-00028330: 6374 2229 2861 290a 0a0a 6465 6620 6172  ct")(a)...def ar
-00028340: 7261 795f 636f 6e73 7472 7563 7428 2a63  ray_construct(*c
-00028350: 6f6c 733a 2043 6f6c 756d 6e4f 724e 616d  ols: ColumnOrNam
-00028360: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00028370: 2020 2222 2252 6574 7572 6e73 2061 6e20    """Returns an 
-00028380: 4152 5241 5920 636f 6e73 7472 7563 7465  ARRAY constructe
-00028390: 6420 6672 6f6d 207a 6572 6f2c 206f 6e65  d from zero, one
-000283a0: 2c20 6f72 206d 6f72 6520 696e 7075 7473  , or more inputs
-000283b0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-000283c0: 2020 2020 2063 6f6c 733a 2043 6f6c 756d       cols: Colum
-000283d0: 6e73 2063 6f6e 7461 696e 696e 6720 7468  ns containing th
-000283e0: 6520 7661 6c75 6573 2028 6f72 2065 7870  e values (or exp
-000283f0: 7265 7373 696f 6e73 2074 6861 7420 6576  ressions that ev
-00028400: 616c 7561 7465 2074 6f20 7661 6c75 6573  aluate to values
-00028410: 292e 2054 6865 0a20 2020 2020 2020 2020  ). The.         
-00028420: 2020 2076 616c 7565 7320 646f 206e 6f74     values do not
-00028430: 2061 6c6c 206e 6565 6420 746f 2062 6520   all need to be 
-00028440: 6f66 2074 6865 2073 616d 6520 6461 7461  of the same data
-00028450: 2074 7970 652e 0a0a 2020 2020 4578 616d   type...    Exam
-00028460: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00028470: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00028480: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00028490: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
-000284a0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-000284b0: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-000284c0: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
-000284d0: 5f63 6f6e 7374 7275 6374 2822 6122 2c20  _construct("a", 
-000284e0: 2262 2229 2e61 6c69 6173 2822 7265 7375  "b").alias("resu
-000284f0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00028500: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00028510: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00028520: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00028530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00028540: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
-00028550: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
-00028560: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00028570: 2032 2020 2020 2020 207c 0a20 2020 2020   2       |.     
-00028580: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
-00028590: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
-000285a0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-000285b0: 332c 2020 2020 2020 7c0a 2020 2020 2020  3,      |.      
-000285c0: 2020 7c20 2034 2020 2020 2020 207c 0a20    |  4       |. 
-000285d0: 2020 2020 2020 207c 5d20 2020 2020 2020         |]       
-000285e0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000285f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00028600: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00028610: 2022 2222 0a20 2020 2063 7320 3d20 5b5f   """.    cs = [_
-00028620: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
-00028630: 2022 6172 7261 795f 636f 6e73 7472 7563   "array_construc
-00028640: 7422 2920 666f 7220 6320 696e 2063 6f6c  t") for c in col
-00028650: 735d 0a20 2020 2072 6574 7572 6e20 6275  s].    return bu
-00028660: 696c 7469 6e28 2261 7272 6179 5f63 6f6e  iltin("array_con
-00028670: 7374 7275 6374 2229 282a 6373 290a 0a0a  struct")(*cs)...
-00028680: 6465 6620 6172 7261 795f 636f 6e73 7472  def array_constr
-00028690: 7563 745f 636f 6d70 6163 7428 2a63 6f6c  uct_compact(*col
-000286a0: 733a 2043 6f6c 756d 6e4f 724e 616d 6529  s: ColumnOrName)
-000286b0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-000286c0: 2222 2252 6574 7572 6e73 2061 6e20 4152  """Returns an AR
-000286d0: 5241 5920 636f 6e73 7472 7563 7465 6420  RAY constructed 
-000286e0: 6672 6f6d 207a 6572 6f2c 206f 6e65 2c20  from zero, one, 
-000286f0: 6f72 206d 6f72 6520 696e 7075 7473 2e0a  or more inputs..
-00028700: 2020 2020 5468 6520 636f 6e73 7472 7563      The construc
-00028710: 7465 6420 4152 5241 5920 6f6d 6974 7320  ted ARRAY omits 
-00028720: 616e 7920 4e55 4c4c 2069 6e70 7574 2076  any NULL input v
-00028730: 616c 7565 732e 0a0a 2020 2020 4172 6773  alues...    Args
-00028740: 3a0a 2020 2020 2020 2020 636f 6c73 3a20  :.        cols: 
-00028750: 436f 6c75 6d6e 7320 636f 6e74 6169 6e69  Columns containi
-00028760: 6e67 2074 6865 2076 616c 7565 7320 286f  ng the values (o
-00028770: 7220 6578 7072 6573 7369 6f6e 7320 7468  r expressions th
-00028780: 6174 2065 7661 6c75 6174 6520 746f 2076  at evaluate to v
-00028790: 616c 7565 7329 2e20 5468 650a 2020 2020  alues). The.    
-000287a0: 2020 2020 2020 2020 7661 6c75 6573 2064          values d
-000287b0: 6f20 6e6f 7420 616c 6c20 6e65 6564 2074  o not all need t
-000287c0: 6f20 6265 206f 6620 7468 6520 7361 6d65  o be of the same
-000287d0: 2064 6174 6120 7479 7065 2e0a 0a20 2020   data type...   
-000287e0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-000287f0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00028800: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00028810: 7261 6d65 285b 5b31 2c20 4e6f 6e65 2c20  rame([[1, None, 
-00028820: 325d 2c20 5b33 2c20 4e6f 6e65 2c20 345d  2], [3, None, 4]
-00028830: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-00028840: 2262 222c 2022 6322 5d29 0a20 2020 2020  "b", "c"]).     
-00028850: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00028860: 2861 7272 6179 5f63 6f6e 7374 7275 6374  (array_construct
-00028870: 5f63 6f6d 7061 6374 2822 6122 2c20 2262  _compact("a", "b
-00028880: 222c 2022 6322 292e 616c 6961 7328 2272  ", "c").alias("r
-00028890: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-000288a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000288b0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-000288c0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-000288d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000288e0: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
-000288f0: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
-00028900: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-00028910: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
-00028920: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
-00028930: 207c 0a20 2020 2020 2020 207c 5b20 2020   |.        |[   
-00028940: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00028950: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
-00028960: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
-00028970: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00028980: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00028990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000289a0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-000289b0: 2020 2020 2222 220a 2020 2020 6373 203d      """.    cs =
-000289c0: 205b 5f74 6f5f 636f 6c5f 6966 5f73 7472   [_to_col_if_str
-000289d0: 2863 2c20 2261 7272 6179 5f63 6f6e 7374  (c, "array_const
-000289e0: 7275 6374 5f63 6f6d 7061 6374 2229 2066  ruct_compact") f
-000289f0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
-00028a00: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00028a10: 2822 6172 7261 795f 636f 6e73 7472 7563  ("array_construc
-00028a20: 745f 636f 6d70 6163 7422 2928 2a63 7329  t_compact")(*cs)
-00028a30: 0a0a 0a64 6566 2061 7272 6179 5f63 6f6e  ...def array_con
-00028a40: 7461 696e 7328 7661 7269 616e 743a 2043  tains(variant: C
-00028a50: 6f6c 756d 6e4f 724e 616d 652c 2061 7272  olumnOrName, arr
-00028a60: 6179 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ay: ColumnOrName
-00028a70: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00028a80: 2022 2222 5265 7475 726e 7320 5472 7565   """Returns True
-00028a90: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
-00028aa0: 6420 5641 5249 414e 5420 6973 2066 6f75  d VARIANT is fou
-00028ab0: 6e64 2069 6e20 7468 6520 7370 6563 6966  nd in the specif
-00028ac0: 6965 6420 4152 5241 592e 0a0a 2020 2020  ied ARRAY...    
-00028ad0: 4172 6773 3a0a 2020 2020 2020 2020 7661  Args:.        va
-00028ae0: 7269 616e 743a 2043 6f6c 756d 6e20 636f  riant: Column co
-00028af0: 6e74 6169 6e69 6e67 2074 6865 2056 4152  ntaining the VAR
-00028b00: 4941 4e54 2074 6f20 6669 6e64 2e0a 2020  IANT to find..  
-00028b10: 2020 2020 2020 6172 7261 793a 2043 6f6c        array: Col
-00028b20: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
-00028b30: 6865 2041 5252 4159 2074 6f20 7365 6172  he ARRAY to sear
-00028b40: 6368 2e0a 0a20 2020 2045 7861 6d70 6c65  ch...    Example
-00028b50: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
-00028b60: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00028b70: 6f77 7061 726b 2069 6d70 6f72 7420 526f  owpark import Ro
-00028b80: 770a 2020 2020 2020 2020 3e3e 3e20 6466  w.        >>> df
-00028b90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00028ba0: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
-00028bb0: 285b 312c 2032 5d29 2c20 526f 7728 5b31  ([1, 2]), Row([1
-00028bc0: 2c20 335d 295d 2c20 7363 6865 6d61 3d5b  , 3])], schema=[
-00028bd0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00028be0: 3e20 6466 2e73 656c 6563 7428 6172 7261  > df.select(arra
-00028bf0: 795f 636f 6e74 6169 6e73 286c 6974 2832  y_contains(lit(2
-00028c00: 292c 2022 6122 292e 616c 6961 7328 2272  ), "a").alias("r
-00028c10: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00028c20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00028c30: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-00028c40: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-00028c50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00028c60: 2020 2020 2020 207c 5472 7565 2020 2020         |True    
-00028c70: 2020 7c0a 2020 2020 2020 2020 7c46 616c    |.        |Fal
-00028c80: 7365 2020 2020 207c 0a20 2020 2020 2020  se     |.       
-00028c90: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00028ca0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00028cb0: 3e0a 2020 2020 2222 220a 2020 2020 7620  >.    """.    v 
-00028cc0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00028cd0: 2876 6172 6961 6e74 2c20 2261 7272 6179  (variant, "array
-00028ce0: 5f63 6f6e 7461 696e 7322 290a 2020 2020  _contains").    
-00028cf0: 6120 3d20 5f74 6f5f 636f 6c5f 6966 5f73  a = _to_col_if_s
-00028d00: 7472 2861 7272 6179 2c20 2261 7272 6179  tr(array, "array
-00028d10: 5f63 6f6e 7461 696e 7322 290a 2020 2020  _contains").    
-00028d20: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00028d30: 6172 7261 795f 636f 6e74 6169 6e73 2229  array_contains")
-00028d40: 2876 2c20 6129 0a0a 0a64 6566 2061 7272  (v, a)...def arr
-00028d50: 6179 5f69 6e73 6572 7428 0a20 2020 2061  ay_insert(.    a
-00028d60: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
-00028d70: 6d65 2c20 706f 733a 2043 6f6c 756d 6e4f  me, pos: ColumnO
-00028d80: 724e 616d 652c 2065 6c65 6d65 6e74 3a20  rName, element: 
-00028d90: 436f 6c75 6d6e 4f72 4e61 6d65 0a29 202d  ColumnOrName.) -
-00028da0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00028db0: 2252 6574 7572 6e73 2061 6e20 4152 5241  "Returns an ARRA
-00028dc0: 5920 636f 6e74 6169 6e69 6e67 2061 6c6c  Y containing all
-00028dd0: 2065 6c65 6d65 6e74 7320 6672 6f6d 2074   elements from t
-00028de0: 6865 2073 6f75 7263 6520 4152 5241 5920  he source ARRAY 
-00028df0: 6173 2077 656c 6c20 6173 2074 6865 206e  as well as the n
-00028e00: 6577 2065 6c65 6d65 6e74 2e0a 0a20 2020  ew element...   
-00028e10: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
-00028e20: 7272 6179 3a20 436f 6c75 6d6e 2063 6f6e  rray: Column con
-00028e30: 7461 696e 696e 6720 7468 6520 736f 7572  taining the sour
-00028e40: 6365 2041 5252 4159 2e0a 2020 2020 2020  ce ARRAY..      
-00028e50: 2020 706f 733a 2043 6f6c 756d 6e20 636f    pos: Column co
-00028e60: 6e74 6169 6e69 6e67 2061 2028 7a65 726f  ntaining a (zero
-00028e70: 2d62 6173 6564 2920 706f 7369 7469 6f6e  -based) position
-00028e80: 2069 6e20 7468 6520 736f 7572 6365 2041   in the source A
-00028e90: 5252 4159 2e0a 2020 2020 2020 2020 2020  RRAY..          
-00028ea0: 2020 5468 6520 6e65 7720 656c 656d 656e    The new elemen
-00028eb0: 7420 6973 2069 6e73 6572 7465 6420 6174  t is inserted at
-00028ec0: 2074 6869 7320 706f 7369 7469 6f6e 2e20   this position. 
-00028ed0: 5468 6520 6f72 6967 696e 616c 2065 6c65  The original ele
-00028ee0: 6d65 6e74 2066 726f 6d20 7468 6973 0a20  ment from this. 
-00028ef0: 2020 2020 2020 2020 2020 2070 6f73 6974             posit
-00028f00: 696f 6e20 2869 6620 616e 7929 2061 6e64  ion (if any) and
-00028f10: 2061 6c6c 2073 7562 7365 7175 656e 7420   all subsequent 
-00028f20: 656c 656d 656e 7473 2028 6966 2061 6e79  elements (if any
-00028f30: 2920 6172 6520 7368 6966 7465 6420 6279  ) are shifted by
-00028f40: 206f 6e65 2070 6f73 6974 696f 6e0a 2020   one position.  
-00028f50: 2020 2020 2020 2020 2020 746f 2074 6865            to the
-00028f60: 2072 6967 6874 2069 6e20 7468 6520 7265   right in the re
-00028f70: 7375 6c74 696e 6720 6172 7261 7920 2869  sulting array (i
-00028f80: 2e65 2e20 696e 7365 7274 696e 6720 6174  .e. inserting at
-00028f90: 2070 6f73 6974 696f 6e20 3020 6861 7320   position 0 has 
-00028fa0: 7468 6520 7361 6d65 0a20 2020 2020 2020  the same.       
-00028fb0: 2020 2020 2065 6666 6563 7420 6173 2075       effect as u
-00028fc0: 7369 6e67 2061 7272 6179 5f70 7265 7065  sing array_prepe
-00028fd0: 6e64 292e 0a20 2020 2020 2020 2020 2020  nd)..           
-00028fe0: 2041 206e 6567 6174 6976 6520 706f 7369   A negative posi
-00028ff0: 7469 6f6e 2069 7320 696e 7465 7270 7265  tion is interpre
-00029000: 7465 6420 6173 2061 6e20 696e 6465 7820  ted as an index 
-00029010: 6672 6f6d 2074 6865 2062 6163 6b20 6f66  from the back of
-00029020: 2074 6865 2061 7272 6179 2028 652e 672e   the array (e.g.
-00029030: 0a20 2020 2020 2020 2020 2020 202d 3120  .            -1 
-00029040: 7265 7375 6c74 7320 696e 2069 6e73 6572  results in inser
-00029050: 7469 6f6e 2062 6566 6f72 6520 7468 6520  tion before the 
-00029060: 6c61 7374 2065 6c65 6d65 6e74 2069 6e20  last element in 
-00029070: 7468 6520 6172 7261 7929 2e0a 2020 2020  the array)..    
-00029080: 2020 2020 656c 656d 656e 743a 2043 6f6c      element: Col
-00029090: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
-000290a0: 6865 2065 6c65 6d65 6e74 2074 6f20 6265  he element to be
-000290b0: 2069 6e73 6572 7465 642e 2054 6865 206e   inserted. The n
-000290c0: 6577 2065 6c65 6d65 6e74 2069 7320 6c6f  ew element is lo
-000290d0: 6361 7465 6420 6174 0a20 2020 2020 2020  cated at.       
-000290e0: 2020 2020 2070 6f73 6974 696f 6e20 706f       position po
-000290f0: 732e 2054 6865 2072 656c 6174 6976 6520  s. The relative 
-00029100: 6f72 6465 7220 6f66 2074 6865 206f 7468  order of the oth
-00029110: 6572 2065 6c65 6d65 6e74 7320 6672 6f6d  er elements from
-00029120: 2074 6865 2073 6f75 7263 650a 2020 2020   the source.    
-00029130: 2020 2020 2020 2020 6172 7261 7920 6973          array is
-00029140: 2070 7265 7365 7276 6564 2e0a 0a20 2020   preserved...   
-00029150: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-00029160: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00029170: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
-00029180: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
-00029190: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000291a0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000291b0: 616d 6528 5b52 6f77 285b 312c 2032 5d29  ame([Row([1, 2])
-000291c0: 2c20 526f 7728 5b31 2c20 335d 295d 2c20  , Row([1, 3])], 
-000291d0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-000291e0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000291f0: 6563 7428 6172 7261 795f 696e 7365 7274  ect(array_insert
-00029200: 2822 6122 2c20 6c69 7428 3029 2c20 6c69  ("a", lit(0), li
-00029210: 7428 3130 2929 2e61 6c69 6173 2822 7265  t(10)).alias("re
-00029220: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00029230: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00029240: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-00029250: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-00029260: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00029270: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
-00029280: 207c 0a20 2020 2020 2020 207c 2020 3130   |.        |  10
-00029290: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-000292a0: 7c20 2031 2c20 2020 2020 207c 0a20 2020  |  1,      |.   
-000292b0: 2020 2020 207c 2020 3220 2020 2020 2020       |  2       
-000292c0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-000292d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-000292e0: 5b20 2020 2020 2020 2020 7c0a 2020 2020  [         |.    
-000292f0: 2020 2020 7c20 2031 302c 2020 2020 207c      |  10,     |
-00029300: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
-00029310: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00029320: 2033 2020 2020 2020 207c 0a20 2020 2020   3       |.     
-00029330: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
-00029340: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00029350: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00029360: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00029370: 0a20 2020 2061 203d 205f 746f 5f63 6f6c  .    a = _to_col
-00029380: 5f69 665f 7374 7228 6172 7261 792c 2022  _if_str(array, "
-00029390: 6172 7261 795f 696e 7365 7274 2229 0a20  array_insert"). 
-000293a0: 2020 2070 203d 205f 746f 5f63 6f6c 5f69     p = _to_col_i
-000293b0: 665f 7374 7228 706f 732c 2022 6172 7261  f_str(pos, "arra
-000293c0: 795f 696e 7365 7274 2229 0a20 2020 2065  y_insert").    e
-000293d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000293e0: 7228 656c 656d 656e 742c 2022 6172 7261  r(element, "arra
-000293f0: 795f 696e 7365 7274 2229 0a20 2020 2072  y_insert").    r
-00029400: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-00029410: 7272 6179 5f69 6e73 6572 7422 2928 612c  rray_insert")(a,
-00029420: 2070 2c20 6529 0a0a 0a64 6566 2061 7272   p, e)...def arr
-00029430: 6179 5f70 6f73 6974 696f 6e28 7661 7269  ay_position(vari
-00029440: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
-00029450: 652c 2061 7272 6179 3a20 436f 6c75 6d6e  e, array: Column
-00029460: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00029470: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00029480: 7320 7468 6520 696e 6465 7820 6f66 2074  s the index of t
-00029490: 6865 2066 6972 7374 206f 6363 7572 7265  he first occurre
-000294a0: 6e63 6520 6f66 2061 6e20 656c 656d 656e  nce of an elemen
-000294b0: 7420 696e 2061 6e20 4152 5241 592e 0a0a  t in an ARRAY...
-000294c0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-000294d0: 2020 7661 7269 616e 743a 2043 6f6c 756d    variant: Colum
-000294e0: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
-000294f0: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
-00029500: 6861 7420 796f 7520 7761 6e74 2074 6f20  hat you want to 
-00029510: 6669 6e64 2e20 5468 6520 6675 6e63 7469  find. The functi
-00029520: 6f6e 0a20 2020 2020 2020 2020 2020 2073  on.            s
-00029530: 6561 7263 6865 7320 666f 7220 7468 6520  earches for the 
-00029540: 6669 7273 7420 6f63 6375 7272 656e 6365  first occurrence
-00029550: 206f 6620 7468 6973 2076 616c 7565 2069   of this value i
-00029560: 6e20 7468 6520 6172 7261 792e 0a20 2020  n the array..   
-00029570: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
-00029580: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
-00029590: 6520 4152 5241 5920 746f 2062 6520 7365  e ARRAY to be se
-000295a0: 6172 6368 6564 2e0a 0a20 2020 2045 7861  arched...    Exa
-000295b0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-000295c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-000295d0: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
-000295e0: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
-000295f0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00029600: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00029610: 5b52 6f77 285b 322c 2031 5d29 2c20 526f  [Row([2, 1]), Ro
-00029620: 7728 5b31 2c20 335d 295d 2c20 7363 6865  w([1, 3])], sche
-00029630: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00029640: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00029650: 6172 7261 795f 706f 7369 7469 6f6e 286c  array_position(l
-00029660: 6974 2831 292c 2022 6122 292e 616c 6961  it(1), "a").alia
-00029670: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-00029680: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00029690: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000296a0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-000296b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000296c0: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
-000296d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-000296e0: 7c30 2020 2020 2020 2020 207c 0a20 2020  |0         |.   
-000296f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00029700: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00029710: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00029720: 2020 7620 3d20 5f74 6f5f 636f 6c5f 6966    v = _to_col_if
-00029730: 5f73 7472 2876 6172 6961 6e74 2c20 2261  _str(variant, "a
-00029740: 7272 6179 5f70 6f73 6974 696f 6e22 290a  rray_position").
-00029750: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
-00029760: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
-00029770: 7272 6179 5f70 6f73 6974 696f 6e22 290a  rray_position").
-00029780: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00029790: 696e 2822 6172 7261 795f 706f 7369 7469  in("array_positi
-000297a0: 6f6e 2229 2876 2c20 6129 0a0a 0a64 6566  on")(v, a)...def
-000297b0: 2061 7272 6179 5f70 7265 7065 6e64 2861   array_prepend(a
-000297c0: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
-000297d0: 6d65 2c20 656c 656d 656e 743a 2043 6f6c  me, element: Col
-000297e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000297f0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00029800: 7572 6e73 2061 6e20 4152 5241 5920 636f  urns an ARRAY co
-00029810: 6e74 6169 6e69 6e67 2074 6865 206e 6577  ntaining the new
-00029820: 2065 6c65 6d65 6e74 2061 7320 7765 6c6c   element as well
-00029830: 2061 7320 616c 6c20 656c 656d 656e 7473   as all elements
-00029840: 2066 726f 6d20 7468 6520 736f 7572 6365   from the source
-00029850: 2041 5252 4159 2e0a 2020 2020 5468 6520   ARRAY..    The 
-00029860: 6e65 7720 656c 656d 656e 7420 6973 2070  new element is p
-00029870: 6f73 6974 696f 6e65 6420 6174 2074 6865  ositioned at the
-00029880: 2062 6567 696e 6e69 6e67 206f 6620 7468   beginning of th
-00029890: 6520 4152 5241 592e 0a0a 2020 2020 4172  e ARRAY...    Ar
-000298a0: 6773 3a0a 2020 2020 2020 2020 6172 7261  gs:.        arra
-000298b0: 7920 436f 6c75 6d6e 2063 6f6e 7461 696e  y Column contain
-000298c0: 696e 6720 7468 6520 736f 7572 6365 2041  ing the source A
-000298d0: 5252 4159 2e0a 2020 2020 2020 2020 656c  RRAY..        el
-000298e0: 656d 656e 7420 436f 6c75 6d6e 2063 6f6e  ement Column con
-000298f0: 7461 696e 696e 6720 7468 6520 656c 656d  taining the elem
-00029900: 656e 7420 746f 2062 6520 7072 6570 656e  ent to be prepen
-00029910: 6465 642e 0a0a 2020 2020 4578 616d 706c  ded...    Exampl
-00029920: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00029930: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00029940: 6e6f 7770 6172 6b20 696d 706f 7274 2052  nowpark import R
-00029950: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
-00029960: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00029970: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
-00029980: 7728 613d 5b31 2c20 322c 2033 5d29 5d29  w(a=[1, 2, 3])])
-00029990: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000299a0: 7365 6c65 6374 2861 7272 6179 5f70 7265  select(array_pre
-000299b0: 7065 6e64 2822 6122 2c20 6c69 7428 3429  pend("a", lit(4)
-000299c0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-000299d0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-000299e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000299f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00029a00: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00029a10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00029a20: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
-00029a30: 2020 2020 2020 7c20 2034 2c20 2020 2020        |  4,     
-00029a40: 207c 0a20 2020 2020 2020 207c 2020 312c   |.        |  1,
-00029a50: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00029a60: 7c20 2032 2c20 2020 2020 207c 0a20 2020  |  2,      |.   
-00029a70: 2020 2020 207c 2020 3320 2020 2020 2020       |  3       
-00029a80: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00029a90: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00029aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00029ab0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00029ac0: 2020 2020 2222 220a 2020 2020 6120 3d20      """.    a = 
-00029ad0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-00029ae0: 7272 6179 2c20 2261 7272 6179 5f70 7265  rray, "array_pre
-00029af0: 7065 6e64 2229 0a20 2020 2065 203d 205f  pend").    e = _
-00029b00: 746f 5f63 6f6c 5f69 665f 7374 7228 656c  to_col_if_str(el
-00029b10: 656d 656e 742c 2022 6172 7261 795f 7072  ement, "array_pr
-00029b20: 6570 656e 6422 290a 2020 2020 7265 7475  epend").    retu
-00029b30: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
-00029b40: 795f 7072 6570 656e 6422 2928 612c 2065  y_prepend")(a, e
-00029b50: 290a 0a0a 6465 6620 6172 7261 795f 7369  )...def array_si
-00029b60: 7a65 2861 7272 6179 3a20 436f 6c75 6d6e  ze(array: Column
-00029b70: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00029b80: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00029b90: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
-00029ba0: 6520 696e 7075 7420 4152 5241 592e 0a0a  e input ARRAY...
-00029bb0: 2020 2020 4966 2074 6865 2073 7065 6369      If the speci
-00029bc0: 6669 6564 2063 6f6c 756d 6e20 636f 6e74  fied column cont
-00029bd0: 6169 6e73 2061 2056 4152 4941 4e54 2076  ains a VARIANT v
-00029be0: 616c 7565 2074 6861 7420 636f 6e74 6169  alue that contai
-00029bf0: 6e73 2061 6e20 4152 5241 592c 2074 6865  ns an ARRAY, the
-00029c00: 2073 697a 6520 6f66 2074 6865 2041 5252   size of the ARR
-00029c10: 4159 0a20 2020 2069 7320 7265 7475 726e  AY.    is return
-00029c20: 6564 3b20 6f74 6865 7277 6973 652c 204e  ed; otherwise, N
-00029c30: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
-00029c40: 6966 2074 6865 2076 616c 7565 2069 7320  if the value is 
-00029c50: 6e6f 7420 616e 2041 5252 4159 2e0a 0a20  not an ARRAY... 
-00029c60: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00029c70: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00029c80: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00029c90: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
-00029ca0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00029cb0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00029cc0: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
-00029cd0: 2032 2c20 335d 295d 290a 2020 2020 2020   2, 3])]).      
-00029ce0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00029cf0: 6172 7261 795f 7369 7a65 2822 6122 292e  array_size("a").
-00029d00: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00029d10: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00029d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00029d30: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00029d40: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00029d50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00029d60: 3320 2020 2020 2020 2020 7c0a 2020 2020  3         |.    
-00029d70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00029d80: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00029d90: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00029da0: 2061 203d 205f 746f 5f63 6f6c 5f69 665f   a = _to_col_if_
-00029db0: 7374 7228 6172 7261 792c 2022 6172 7261  str(array, "arra
-00029dc0: 795f 7369 7a65 2229 0a20 2020 2072 6574  y_size").    ret
-00029dd0: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
-00029de0: 6179 5f73 697a 6522 2928 6129 0a0a 0a64  ay_size")(a)...d
-00029df0: 6566 2061 7272 6179 5f73 6c69 6365 2861  ef array_slice(a
-00029e00: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
-00029e10: 6d65 2c20 6672 6f6d 5f3a 2043 6f6c 756d  me, from_: Colum
-00029e20: 6e4f 724e 616d 652c 2074 6f3a 2043 6f6c  nOrName, to: Col
-00029e30: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00029e40: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00029e50: 7572 6e73 2061 6e20 4152 5241 5920 636f  urns an ARRAY co
-00029e60: 6e73 7472 7563 7465 6420 6672 6f6d 2061  nstructed from a
-00029e70: 2073 7065 6369 6669 6564 2073 7562 7365   specified subse
-00029e80: 7420 6f66 2065 6c65 6d65 6e74 7320 6f66  t of elements of
-00029e90: 2074 6865 2069 6e70 7574 2041 5252 4159   the input ARRAY
-00029ea0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00029eb0: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
-00029ec0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
-00029ed0: 6520 736f 7572 6365 2041 5252 4159 2e0a  e source ARRAY..
-00029ee0: 2020 2020 2020 2020 6672 6f6d 5f3a 2043          from_: C
-00029ef0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
-00029f00: 2061 2070 6f73 6974 696f 6e20 696e 2074   a position in t
-00029f10: 6865 2073 6f75 7263 6520 4152 5241 592e  he source ARRAY.
-00029f20: 2054 6865 2070 6f73 6974 696f 6e20 6f66   The position of
-00029f30: 2074 6865 2066 6972 7374 0a20 2020 2020   the first.     
-00029f40: 2020 2020 2020 2065 6c65 6d65 6e74 2069         element i
-00029f50: 7320 302e 2045 6c65 6d65 6e74 7320 6672  s 0. Elements fr
-00029f60: 6f6d 2070 6f73 6974 696f 6e73 206c 6573  om positions les
-00029f70: 7320 7468 616e 2074 6869 7320 7061 7261  s than this para
-00029f80: 6d65 7465 7220 6172 650a 2020 2020 2020  meter are.      
-00029f90: 2020 2020 2020 6e6f 7420 696e 636c 7564        not includ
-00029fa0: 6564 2069 6e20 7468 6520 7265 7375 6c74  ed in the result
-00029fb0: 696e 6720 4152 5241 592e 0a20 2020 2020  ing ARRAY..     
-00029fc0: 2020 2074 6f3a 2043 6f6c 756d 6e20 636f     to: Column co
-00029fd0: 6e74 6169 6e69 6e67 2061 2070 6f73 6974  ntaining a posit
-00029fe0: 696f 6e20 696e 2074 6865 2073 6f75 7263  ion in the sourc
-00029ff0: 6520 4152 5241 592e 2045 6c65 6d65 6e74  e ARRAY. Element
-0002a000: 7320 6672 6f6d 2070 6f73 6974 696f 6e73  s from positions
-0002a010: 2065 7175 616c 2074 6f0a 2020 2020 2020   equal to.      
-0002a020: 2020 2020 2020 6f72 2067 7265 6174 6572        or greater
-0002a030: 2074 6861 6e20 7468 6973 2070 6172 616d   than this param
-0002a040: 6574 6572 2061 7265 206e 6f74 2069 6e63  eter are not inc
-0002a050: 6c75 6465 6420 696e 2074 6865 2072 6573  luded in the res
-0002a060: 756c 7469 6e67 2061 7272 6179 2e0a 0a20  ulting array... 
-0002a070: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0002a080: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0002a090: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002a0a0: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
-0002a0b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002a0c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002a0d0: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
-0002a0e0: 2032 2c20 332c 2034 2c20 355d 295d 290a   2, 3, 4, 5])]).
-0002a0f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002a100: 656c 6563 7428 6172 7261 795f 736c 6963  elect(array_slic
-0002a110: 6528 2261 222c 206c 6974 2831 292c 206c  e("a", lit(1), l
-0002a120: 6974 2833 2929 2e61 6c69 6173 2822 7265  it(3)).alias("re
-0002a130: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-0002a140: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002a150: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0002a160: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-0002a170: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0002a180: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
-0002a190: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
-0002a1a0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002a1b0: 7c20 2033 2020 2020 2020 207c 0a20 2020  |  3       |.   
-0002a1c0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
-0002a1d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002a1e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0002a1f0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0002a200: 2222 0a20 2020 2061 203d 205f 746f 5f63  "".    a = _to_c
-0002a210: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
-0002a220: 2022 6172 7261 795f 736c 6963 6522 290a   "array_slice").
-0002a230: 2020 2020 6620 3d20 5f74 6f5f 636f 6c5f      f = _to_col_
-0002a240: 6966 5f73 7472 2866 726f 6d5f 2c20 2261  if_str(from_, "a
-0002a250: 7272 6179 5f73 6c69 6365 2229 0a20 2020  rray_slice").   
-0002a260: 2074 203d 205f 746f 5f63 6f6c 5f69 665f   t = _to_col_if_
-0002a270: 7374 7228 746f 2c20 2261 7272 6179 5f73  str(to, "array_s
-0002a280: 6c69 6365 2229 0a20 2020 2072 6574 7572  lice").    retur
-0002a290: 6e20 6275 696c 7469 6e28 2261 7272 6179  n builtin("array
-0002a2a0: 5f73 6c69 6365 2229 2861 2c20 662c 2074  _slice")(a, f, t
-0002a2b0: 290a 0a0a 6465 6620 6172 7261 795f 746f  )...def array_to
-0002a2c0: 5f73 7472 696e 6728 6172 7261 793a 2043  _string(array: C
-0002a2d0: 6f6c 756d 6e4f 724e 616d 652c 2073 6570  olumnOrName, sep
-0002a2e0: 6172 6174 6f72 3a20 436f 6c75 6d6e 4f72  arator: ColumnOr
-0002a2f0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002a300: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0002a310: 616e 2069 6e70 7574 2041 5252 4159 2063  an input ARRAY c
-0002a320: 6f6e 7665 7274 6564 2074 6f20 6120 7374  onverted to a st
-0002a330: 7269 6e67 2062 7920 6361 7374 696e 6720  ring by casting 
-0002a340: 616c 6c20 7661 6c75 6573 2074 6f20 7374  all values to st
-0002a350: 7269 6e67 7320 2875 7369 6e67 0a20 2020  rings (using.   
-0002a360: 2054 4f5f 5641 5243 4841 5229 2061 6e64   TO_VARCHAR) and
-0002a370: 2063 6f6e 6361 7465 6e61 7469 6e67 2074   concatenating t
-0002a380: 6865 6d20 2875 7369 6e67 2074 6865 2073  hem (using the s
-0002a390: 7472 696e 6720 6672 6f6d 2074 6865 2073  tring from the s
-0002a3a0: 6563 6f6e 6420 6172 6775 6d65 6e74 2074  econd argument t
-0002a3b0: 6f20 7365 7061 7261 7465 0a20 2020 2074  o separate.    t
-0002a3c0: 6865 2065 6c65 6d65 6e74 7329 2e0a 0a20  he elements)... 
-0002a3d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0002a3e0: 2061 7272 6179 3a20 436f 6c75 6d6e 2063   array: Column c
-0002a3f0: 6f6e 7461 696e 696e 6720 7468 6520 4152  ontaining the AR
-0002a400: 5241 5920 6f66 2065 6c65 6d65 6e74 7320  RAY of elements 
-0002a410: 746f 2063 6f6e 7665 7274 2074 6f20 6120  to convert to a 
-0002a420: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-0002a430: 7365 7061 7261 746f 723a 2043 6f6c 756d  separator: Colum
-0002a440: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
-0002a450: 2073 7472 696e 6720 746f 2070 7574 2062   string to put b
-0002a460: 6574 7765 656e 2065 6163 6820 656c 656d  etween each elem
-0002a470: 656e 7420 2865 2e67 2e20 6120 7370 6163  ent (e.g. a spac
-0002a480: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
-0002a490: 6f6d 6d61 2c20 6f72 206f 7468 6572 2068  omma, or other h
-0002a4a0: 756d 616e 2d72 6561 6461 626c 6520 7365  uman-readable se
-0002a4b0: 7061 7261 746f 7229 2e0a 0a20 2020 2045  parator)...    E
-0002a4c0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002a4d0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0002a4e0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
-0002a4f0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
-0002a500: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002a510: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0002a520: 6528 5b52 6f77 2861 3d5b 312c 2054 7275  e([Row(a=[1, Tru
-0002a530: 652c 2022 7322 5d29 5d29 0a20 2020 2020  e, "s"])]).     
-0002a540: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0002a550: 2861 7272 6179 5f74 6f5f 7374 7269 6e67  (array_to_string
-0002a560: 2822 6122 2c20 6c69 7428 222c 2229 292e  ("a", lit(",")).
-0002a570: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002a580: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002a590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002a5a0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0002a5b0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002a5c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002a5d0: 312c 7472 7565 2c73 2020 7c0a 2020 2020  1,true,s  |.    
-0002a5e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002a5f0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0002a600: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0002a610: 2061 203d 205f 746f 5f63 6f6c 5f69 665f   a = _to_col_if_
-0002a620: 7374 7228 6172 7261 792c 2022 6172 7261  str(array, "arra
-0002a630: 795f 746f 5f73 7472 696e 6722 290a 2020  y_to_string").  
-0002a640: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
-0002a650: 5f73 7472 2873 6570 6172 6174 6f72 2c20  _str(separator, 
-0002a660: 2261 7272 6179 5f74 6f5f 7374 7269 6e67  "array_to_string
-0002a670: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0002a680: 696c 7469 6e28 2261 7272 6179 5f74 6f5f  iltin("array_to_
-0002a690: 7374 7269 6e67 2229 2861 2c20 7329 0a0a  string")(a, s)..
-0002a6a0: 0a64 6566 2061 7272 6179 5f75 6e69 7175  .def array_uniqu
-0002a6b0: 655f 6167 6728 636f 6c3a 2043 6f6c 756d  e_agg(col: Colum
-0002a6c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002a6d0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0002a6e0: 6e73 2061 2043 6f6c 756d 6e20 636f 6e74  ns a Column cont
-0002a6f0: 6169 6e69 6e67 2074 6865 2064 6973 7469  aining the disti
-0002a700: 6e63 7420 7661 6c75 6573 2069 6e20 7468  nct values in th
-0002a710: 6520 7370 6563 6966 6965 6420 636f 6c75  e specified colu
-0002a720: 6d6e 2063 6f6c 2e0a 2020 2020 5468 6520  mn col..    The 
-0002a730: 7661 6c75 6573 2069 6e20 7468 6520 436f  values in the Co
-0002a740: 6c75 6d6e 2061 7265 2069 6e20 6e6f 2070  lumn are in no p
-0002a750: 6172 7469 6375 6c61 7220 6f72 6465 722c  articular order,
-0002a760: 2061 6e64 2074 6865 206f 7264 6572 2069   and the order i
-0002a770: 7320 6e6f 7420 6465 7465 726d 696e 6973  s not determinis
-0002a780: 7469 632e 0a20 2020 2054 6865 2066 756e  tic..    The fun
-0002a790: 6374 696f 6e20 6967 6e6f 7265 7320 4e55  ction ignores NU
-0002a7a0: 4c4c 2076 616c 7565 7320 696e 2063 6f6c  LL values in col
-0002a7b0: 2e0a 2020 2020 4966 2063 6f6c 2063 6f6e  ..    If col con
-0002a7c0: 7461 696e 7320 6f6e 6c79 204e 554c 4c20  tains only NULL 
-0002a7d0: 7661 6c75 6573 206f 7220 636f 6c20 6973  values or col is
-0002a7e0: 2065 6d70 7479 2c20 7468 6520 6675 6e63   empty, the func
-0002a7f0: 7469 6f6e 2072 6574 7572 6e73 2061 6e20  tion returns an 
-0002a800: 656d 7074 7920 436f 6c75 6d6e 2e0a 0a20  empty Column... 
-0002a810: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0002a820: 2063 6f6c 3a20 4120 3a63 6c61 7373 3a60   col: A :class:`
-0002a830: 436f 6c75 6d6e 6020 6f62 6a65 6374 206f  Column` object o
-0002a840: 7220 636f 6c75 6d6e 206e 616d 6520 7468  r column name th
-0002a850: 6174 2064 6574 6572 6d69 6e65 7320 7468  at determines th
-0002a860: 6520 7661 6c75 6573 2e0a 0a20 2020 2045  e values...    E
-0002a870: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002a880: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0002a890: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0002a8a0: 6d65 285b 5b35 5d2c 205b 325d 2c20 5b31  me([[5], [2], [1
-0002a8b0: 5d2c 205b 325d 2c20 5b31 5d5d 2c20 7363  ], [2], [1]], sc
-0002a8c0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0002a8d0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002a8e0: 7428 6172 7261 795f 756e 6971 7565 5f61  t(array_unique_a
-0002a8f0: 6767 2822 6122 292e 616c 6961 7328 2272  gg("a").alias("r
-0002a900: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0002a910: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002a920: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0002a930: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0002a940: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0002a950: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
-0002a960: 2020 7c0a 2020 2020 2020 2020 7c20 2035    |.        |  5
-0002a970: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-0002a980: 207c 2020 322c 2020 2020 2020 7c0a 2020   |  2,      |.  
-0002a990: 2020 2020 2020 7c20 2031 2020 2020 2020        |  1      
-0002a9a0: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
-0002a9b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002a9c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002a9d0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0002a9e0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002a9f0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002aa00: 636f 6c2c 2022 6172 7261 795f 756e 6971  col, "array_uniq
-0002aa10: 7565 5f61 6767 2229 0a20 2020 2072 6574  ue_agg").    ret
-0002aa20: 7572 6e20 5f63 616c 6c5f 6675 6e63 7469  urn _call_functi
-0002aa30: 6f6e 2822 6172 7261 795f 756e 6971 7565  on("array_unique
-0002aa40: 5f61 6767 222c 2054 7275 652c 2063 290a  _agg", True, c).
-0002aa50: 0a0a 6465 6620 6f62 6a65 6374 5f61 6767  ..def object_agg
-0002aa60: 286b 6579 3a20 436f 6c75 6d6e 4f72 4e61  (key: ColumnOrNa
-0002aa70: 6d65 2c20 7661 6c75 653a 2043 6f6c 756d  me, value: Colum
-0002aa80: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002aa90: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0002aaa0: 6e73 206f 6e65 204f 424a 4543 5420 7065  ns one OBJECT pe
-0002aab0: 7220 6772 6f75 702e 2046 6f72 2065 6163  r group. For eac
-0002aac0: 6820 6b65 792d 7661 6c75 6520 696e 7075  h key-value inpu
-0002aad0: 7420 7061 6972 2c20 7768 6572 6520 6b65  t pair, where ke
-0002aae0: 7920 6d75 7374 2062 6520 6120 5641 5243  y must be a VARC
-0002aaf0: 4841 520a 2020 2020 616e 6420 7661 6c75  HAR.    and valu
-0002ab00: 6520 6d75 7374 2062 6520 6120 5641 5249  e must be a VARI
-0002ab10: 414e 542c 2074 6865 2072 6573 756c 7469  ANT, the resulti
-0002ab20: 6e67 204f 424a 4543 5420 636f 6e74 6169  ng OBJECT contai
-0002ab30: 6e73 2061 206b 6579 2d76 616c 7565 2066  ns a key-value f
-0002ab40: 6965 6c64 2e0a 0a20 2020 2045 7861 6d70  ield...    Examp
-0002ab50: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0002ab60: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0002ab70: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-0002ab80: 696d 706f 7274 2053 7472 7563 7454 7970  import StructTyp
-0002ab90: 652c 2053 7472 7563 7446 6965 6c64 2c20  e, StructField, 
-0002aba0: 5661 7269 616e 7454 7970 652c 2053 7472  VariantType, Str
-0002abb0: 696e 6754 7970 650a 2020 2020 2020 2020  ingType.        
-0002abc0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002abd0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0002abe0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-0002abf0: 2020 205b 5b22 6e61 6d65 222c 2022 4a6f     [["name", "Jo
-0002ac00: 6522 5d2c 205b 227a 6970 222c 2022 3938  e"], ["zip", "98
-0002ac10: 3030 3422 5d5d 2c0a 2020 2020 2020 2020  004"]],.        
-0002ac20: 2e2e 2e20 2020 2020 7363 6865 6d61 3d53  ...     schema=S
-0002ac30: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
-0002ac40: 7446 6965 6c64 2822 6b22 2c20 5374 7269  tField("k", Stri
-0002ac50: 6e67 5479 7065 2829 292c 2053 7472 7563  ngType()), Struc
-0002ac60: 7446 6965 6c64 2822 7622 2c20 5661 7269  tField("v", Vari
-0002ac70: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
-0002ac80: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-0002ac90: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0002aca0: 286f 626a 6563 745f 6167 6728 636f 6c28  (object_agg(col(
-0002acb0: 226b 2229 2c20 636f 6c28 2276 2229 292e  "k"), col("v")).
-0002acc0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002acd0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002ace0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002acf0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0002ad00: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
-0002ad10: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002ad20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002ad30: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
-0002ad40: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002ad50: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
-0002ad60: 4a6f 6522 2c20 207c 0a20 2020 2020 2020  Joe",  |.       
-0002ad70: 207c 2020 227a 6970 223a 2022 3938 3030   |  "zip": "9800
-0002ad80: 3422 2020 7c0a 2020 2020 2020 2020 7c7d  4"  |.        |}
-0002ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ada0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0002adb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0002adc0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0002add0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-0002ade0: 6b20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  k = _to_col_if_s
-0002adf0: 7472 286b 6579 2c20 226f 626a 6563 745f  tr(key, "object_
-0002ae00: 6167 6722 290a 2020 2020 7620 3d20 5f74  agg").    v = _t
-0002ae10: 6f5f 636f 6c5f 6966 5f73 7472 2876 616c  o_col_if_str(val
-0002ae20: 7565 2c20 226f 626a 6563 745f 6167 6722  ue, "object_agg"
-0002ae30: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002ae40: 6c74 696e 2822 6f62 6a65 6374 5f61 6767  ltin("object_agg
-0002ae50: 2229 286b 2c20 7629 0a0a 0a64 6566 206f  ")(k, v)...def o
-0002ae60: 626a 6563 745f 636f 6e73 7472 7563 7428  bject_construct(
-0002ae70: 2a6b 6579 5f76 616c 7565 733a 2043 6f6c  *key_values: Col
-0002ae80: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0002ae90: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-0002aea0: 7572 6e73 2061 6e20 4f42 4a45 4354 2063  urns an OBJECT c
-0002aeb0: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
-0002aec0: 7468 6520 6172 6775 6d65 6e74 732e 0a0a  the arguments...
-0002aed0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0002aee0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002aef0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002af00: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0002af10: 5374 7275 6374 5479 7065 2c20 5374 7275  StructType, Stru
-0002af20: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
-0002af30: 5479 7065 2c20 5374 7269 6e67 5479 7065  Type, StringType
-0002af40: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002af50: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002af60: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-0002af70: 2020 2020 2e2e 2e20 2020 2020 5b5b 226e      ...     [["n
-0002af80: 616d 6522 2c20 224a 6f65 225d 2c20 5b22  ame", "Joe"], ["
-0002af90: 7a69 7022 2c20 2239 3830 3034 225d 2c5b  zip", "98004"],[
-0002afa0: 2261 6765 222c 204e 6f6e 655d 2c20 5b4e  "age", None], [N
-0002afb0: 6f6e 652c 2022 7661 6c75 6522 5d5d 2c0a  one, "value"]],.
-0002afc0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002afd0: 7363 6865 6d61 3d53 7472 7563 7454 7970  schema=StructTyp
-0002afe0: 6528 5b53 7472 7563 7446 6965 6c64 2822  e([StructField("
-0002aff0: 6b22 2c20 5374 7269 6e67 5479 7065 2829  k", StringType()
-0002b000: 292c 2053 7472 7563 7446 6965 6c64 2822  ), StructField("
-0002b010: 7622 2c20 5661 7269 616e 7454 7970 6528  v", VariantType(
-0002b020: 2929 5d29 0a20 2020 2020 2020 202e 2e2e  ))]).        ...
-0002b030: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-0002b040: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-0002b050: 636f 6e73 7472 7563 7428 636f 6c28 226b  construct(col("k
-0002b060: 2229 2c20 636f 6c28 2276 2229 292e 616c  "), col("v")).al
-0002b070: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-0002b080: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0002b090: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002b0a0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0002b0b0: 554c 5422 2020 2020 2020 2020 2020 7c0a  ULT"          |.
-0002b0c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002b0d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002b0e0: 2020 2020 207c 7b20 2020 2020 2020 2020       |{         
-0002b0f0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0002b100: 2020 7c20 2022 6e61 6d65 223a 2022 4a6f    |  "name": "Jo
-0002b110: 6522 2020 207c 0a20 2020 2020 2020 207c  e"   |.        |
-0002b120: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
-0002b130: 2020 7c0a 2020 2020 2020 2020 7c7b 2020    |.        |{  
-0002b140: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0002b150: 0a20 2020 2020 2020 207c 2020 227a 6970  .        |  "zip
-0002b160: 223a 2022 3938 3030 3422 2020 7c0a 2020  ": "98004"  |.  
-0002b170: 2020 2020 2020 7c7d 2020 2020 2020 2020        |}        
-0002b180: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0002b190: 2020 207c 7b7d 2020 2020 2020 2020 2020     |{}          
-0002b1a0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002b1b0: 7c7b 7d20 2020 2020 2020 2020 2020 2020  |{}             
-0002b1c0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-0002b1d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002b1e0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0002b1f0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0002b200: 2020 6b76 7320 3d20 5b5f 746f 5f63 6f6c    kvs = [_to_col
-0002b210: 5f69 665f 7374 7228 6b76 2c20 226f 626a  _if_str(kv, "obj
-0002b220: 6563 745f 636f 6e73 7472 7563 7422 2920  ect_construct") 
-0002b230: 666f 7220 6b76 2069 6e20 6b65 795f 7661  for kv in key_va
-0002b240: 6c75 6573 5d0a 2020 2020 7265 7475 726e  lues].    return
-0002b250: 2062 7569 6c74 696e 2822 6f62 6a65 6374   builtin("object
-0002b260: 5f63 6f6e 7374 7275 6374 2229 282a 6b76  _construct")(*kv
-0002b270: 7329 0a0a 0a64 6566 206f 626a 6563 745f  s)...def object_
-0002b280: 636f 6e73 7472 7563 745f 6b65 6570 5f6e  construct_keep_n
-0002b290: 756c 6c28 2a6b 6579 5f76 616c 7565 733a  ull(*key_values:
-0002b2a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0002b2b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002b2c0: 2252 6574 7572 6e73 2061 6e20 6f62 6a65  "Returns an obje
-0002b2d0: 6374 2063 6f6e 7461 696e 696e 6720 7468  ct containing th
-0002b2e0: 6520 636f 6e74 656e 7473 206f 6620 7468  e contents of th
-0002b2f0: 6520 696e 7075 7420 2869 2e65 2e20 736f  e input (i.e. so
-0002b300: 7572 6365 2920 6f62 6a65 6374 2077 6974  urce) object wit
-0002b310: 6820 6f6e 6520 6f72 206d 6f72 650a 2020  h one or more.  
-0002b320: 2020 6b65 7973 2072 656d 6f76 6564 2e0a    keys removed..
-0002b330: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0002b340: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0002b350: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0002b360: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-0002b370: 2053 7472 7563 7454 7970 652c 2053 7472   StructType, Str
-0002b380: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
-0002b390: 7454 7970 652c 2053 7472 696e 6754 7970  tType, StringTyp
-0002b3a0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0002b3b0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002b3c0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-0002b3d0: 2020 2020 202e 2e2e 2020 2020 205b 5b22       ...     [["
-0002b3e0: 6b65 795f 3122 2c20 226f 6e65 225d 2c20  key_1", "one"], 
-0002b3f0: 5b22 6b65 795f 3222 2c20 4e6f 6e65 5d5d  ["key_2", None]]
-0002b400: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0002b410: 2020 7363 6865 6d61 3d53 7472 7563 7454    schema=StructT
-0002b420: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
-0002b430: 2822 6b22 2c20 5374 7269 6e67 5479 7065  ("k", StringType
-0002b440: 2829 292c 2053 7472 7563 7446 6965 6c64  ()), StructField
-0002b450: 2822 7622 2c20 5661 7269 616e 7454 7970  ("v", VariantTyp
-0002b460: 6528 2929 5d29 0a20 2020 2020 2020 202e  e())]).        .
-0002b470: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0002b480: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
-0002b490: 745f 636f 6e73 7472 7563 745f 6b65 6570  t_construct_keep
-0002b4a0: 5f6e 756c 6c28 636f 6c28 226b 2229 2c20  _null(col("k"), 
-0002b4b0: 636f 6c28 2276 2229 292e 616c 6961 7328  col("v")).alias(
-0002b4c0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0002b4d0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0002b4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002b4f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0002b500: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002b510: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002b520: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002b530: 207c 7b20 2020 2020 2020 2020 2020 2020   |{             
-0002b540: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0002b550: 2022 6b65 795f 3122 3a20 226f 6e65 2220   "key_1": "one" 
-0002b560: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
-0002b570: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-0002b580: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-0002b590: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0002b5a0: 2020 2020 207c 2020 226b 6579 5f32 223a       |  "key_2":
-0002b5b0: 206e 756c 6c20 2020 7c0a 2020 2020 2020   null   |.      
-0002b5c0: 2020 7c7d 2020 2020 2020 2020 2020 2020    |}            
-0002b5d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0002b5e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002b5f0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0002b600: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0002b610: 2020 2020 6b76 7320 3d20 5b5f 746f 5f63      kvs = [_to_c
-0002b620: 6f6c 5f69 665f 7374 7228 6b76 2c20 226f  ol_if_str(kv, "o
-0002b630: 626a 6563 745f 636f 6e73 7472 7563 745f  bject_construct_
-0002b640: 6b65 6570 5f6e 756c 6c22 2920 666f 7220  keep_null") for 
-0002b650: 6b76 2069 6e20 6b65 795f 7661 6c75 6573  kv in key_values
-0002b660: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
-0002b670: 6c74 696e 2822 6f62 6a65 6374 5f63 6f6e  ltin("object_con
-0002b680: 7374 7275 6374 5f6b 6565 705f 6e75 6c6c  struct_keep_null
-0002b690: 2229 282a 6b76 7329 0a0a 0a64 6566 206f  ")(*kvs)...def o
-0002b6a0: 626a 6563 745f 6465 6c65 7465 286f 626a  bject_delete(obj
-0002b6b0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0002b6c0: 6b65 7931 3a20 436f 6c75 6d6e 4f72 4e61  key1: ColumnOrNa
-0002b6d0: 6d65 2c20 2a6b 6579 733a 2043 6f6c 756d  me, *keys: Colum
-0002b6e0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002b6f0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0002b700: 6e73 2061 6e20 6f62 6a65 6374 2063 6f6e  ns an object con
-0002b710: 7369 7374 696e 6720 6f66 2074 6865 2069  sisting of the i
-0002b720: 6e70 7574 206f 626a 6563 7420 7769 7468  nput object with
-0002b730: 206f 6e65 206f 7220 6d6f 7265 206b 6579   one or more key
-0002b740: 7320 7265 6d6f 7665 642e 0a20 2020 2054  s removed..    T
-0002b750: 6865 2069 6e70 7574 206b 6579 206d 7573  he input key mus
-0002b760: 7420 6e6f 7420 6578 6973 7420 696e 2074  t not exist in t
-0002b770: 6865 206f 626a 6563 742e 0a0a 2020 2020  he object...    
-0002b780: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0002b790: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0002b7a0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-0002b7b0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-0002b7c0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
-0002b7d0: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-0002b7e0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-0002b7f0: 2020 2273 656c 6563 7420 6f62 6a65 6374    "select object
-0002b800: 5f63 6f6e 7374 7275 6374 2861 2c62 2c63  _construct(a,b,c
-0002b810: 2c64 2c65 2c66 2920 6173 206f 626a 2066  ,d,e,f) as obj f
-0002b820: 726f 6d20 220a 2020 2020 2020 2020 2e2e  rom ".        ..
-0002b830: 2e20 2020 2020 2276 616c 7565 7328 2761  .     "values('a
-0002b840: 6765 272c 2032 312c 2027 7a69 7027 2c20  ge', 21, 'zip', 
-0002b850: 3231 3032 312c 2027 6e61 6d65 272c 2027  21021, 'name', '
-0002b860: 4a6f 6527 292c 220a 2020 2020 2020 2020  Joe'),".        
-0002b870: 2e2e 2e20 2020 2020 2228 2761 6765 272c  ...     "('age',
-0002b880: 2032 362c 2027 7a69 7027 2c20 3934 3032   26, 'zip', 9402
-0002b890: 312c 2027 6e61 6d65 272c 2027 4a61 7927  1, 'name', 'Jay'
-0002b8a0: 2920 6173 2054 2861 2c62 2c63 2c64 2c65  ) as T(a,b,c,d,e
-0002b8b0: 2c66 2922 0a20 2020 2020 2020 202e 2e2e  ,f)".        ...
-0002b8c0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-0002b8d0: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-0002b8e0: 6465 6c65 7465 2863 6f6c 2822 6f62 6a22  delete(col("obj"
-0002b8f0: 292c 206c 6974 2822 6167 6522 2929 2e61  ), lit("age")).a
-0002b900: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0002b910: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0002b920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002b930: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0002b940: 5355 4c54 2220 2020 2020 2020 2020 207c  SULT"          |
-0002b950: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002b960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0002b970: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
-0002b980: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0002b990: 2020 207c 2020 226e 616d 6522 3a20 224a     |  "name": "J
-0002b9a0: 6f65 222c 2020 7c0a 2020 2020 2020 2020  oe",  |.        
-0002b9b0: 7c20 2022 7a69 7022 3a20 3231 3032 3120  |  "zip": 21021 
-0002b9c0: 2020 207c 0a20 2020 2020 2020 207c 7d20     |.        |} 
-0002b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9e0: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
-0002b9f0: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-0002ba00: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-0002ba10: 3a20 224a 6179 222c 2020 7c0a 2020 2020  : "Jay",  |.    
-0002ba20: 2020 2020 7c20 2022 7a69 7022 3a20 3934      |  "zip": 94
-0002ba30: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
-0002ba40: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-0002ba50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002ba60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ba70: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0002ba80: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-0002ba90: 2020 206f 203d 205f 746f 5f63 6f6c 5f69     o = _to_col_i
-0002baa0: 665f 7374 7228 6f62 6a2c 2022 6f62 6a65  f_str(obj, "obje
-0002bab0: 6374 5f64 656c 6574 6522 290a 2020 2020  ct_delete").    
-0002bac0: 6b31 203d 205f 746f 5f63 6f6c 5f69 665f  k1 = _to_col_if_
-0002bad0: 7374 7228 6b65 7931 2c20 226f 626a 6563  str(key1, "objec
-0002bae0: 745f 6465 6c65 7465 2229 0a20 2020 206b  t_delete").    k
-0002baf0: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
-0002bb00: 7374 7228 6b2c 2022 6f62 6a65 6374 5f64  str(k, "object_d
-0002bb10: 656c 6574 6522 2920 666f 7220 6b20 696e  elete") for k in
-0002bb20: 206b 6579 735d 0a20 2020 2072 6574 7572   keys].    retur
-0002bb30: 6e20 6275 696c 7469 6e28 226f 626a 6563  n builtin("objec
-0002bb40: 745f 6465 6c65 7465 2229 286f 2c20 6b31  t_delete")(o, k1
-0002bb50: 2c20 2a6b 7329 0a0a 0a64 6566 206f 626a  , *ks)...def obj
-0002bb60: 6563 745f 696e 7365 7274 280a 2020 2020  ect_insert(.    
-0002bb70: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
-0002bb80: 652c 0a20 2020 206b 6579 3a20 436f 6c75  e,.    key: Colu
-0002bb90: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7661  mnOrName,.    va
-0002bba0: 6c75 653a 2043 6f6c 756d 6e4f 724e 616d  lue: ColumnOrNam
-0002bbb0: 652c 0a20 2020 2075 7064 6174 655f 666c  e,.    update_fl
-0002bbc0: 6167 3a20 4f70 7469 6f6e 616c 5b43 6f6c  ag: Optional[Col
-0002bbd0: 756d 6e4f 724e 616d 655d 203d 204e 6f6e  umnOrName] = Non
-0002bbe0: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
-0002bbf0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-0002bc00: 6e20 6f62 6a65 6374 2063 6f6e 7369 7374  n object consist
-0002bc10: 696e 6720 6f66 2074 6865 2069 6e70 7574  ing of the input
-0002bc20: 206f 626a 6563 7420 7769 7468 2061 206e   object with a n
-0002bc30: 6577 206b 6579 2d76 616c 7565 2070 6169  ew key-value pai
-0002bc40: 7220 696e 7365 7274 6564 2028 6f72 2061  r inserted (or a
-0002bc50: 6e0a 2020 2020 6578 6973 7469 6e67 206b  n.    existing k
-0002bc60: 6579 2075 7064 6174 6564 2077 6974 6820  ey updated with 
-0002bc70: 6120 6e65 7720 7661 6c75 6529 2e0a 0a20  a new value)... 
-0002bc80: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0002bc90: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0002bca0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002bcb0: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-0002bcc0: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
-0002bcd0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-0002bce0: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
-0002bcf0: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
-0002bd00: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
-0002bd10: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
-0002bd20: 2c20 6b2c 2076 2066 726f 6d20 220a 2020  , k, v from ".  
-0002bd30: 2020 2020 2020 2e2e 2e20 2020 2020 2276        ...     "v
-0002bd40: 616c 7565 7328 2761 6765 272c 2032 312c  alues('age', 21,
-0002bd50: 2027 7a69 7027 2c20 3231 3032 312c 2027   'zip', 21021, '
-0002bd60: 6e61 6d65 272c 2027 4a6f 6527 2c20 2761  name', 'Joe', 'a
-0002bd70: 6765 272c 2030 292c 220a 2020 2020 2020  ge', 0),".      
-0002bd80: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
-0002bd90: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
-0002bda0: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
-0002bdb0: 7927 2c20 2761 6765 272c 2030 2920 6173  y', 'age', 0) as
-0002bdc0: 2054 2861 2c62 2c63 2c64 2c65 2c66 2c6b   T(a,b,c,d,e,f,k
-0002bdd0: 2c76 2922 0a20 2020 2020 2020 202e 2e2e  ,v)".        ...
-0002bde0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-0002bdf0: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
-0002be00: 696e 7365 7274 2863 6f6c 2822 6f62 6a22  insert(col("obj"
-0002be10: 292c 206c 6974 2822 6b65 7922 292c 206c  ), lit("key"), l
-0002be20: 6974 2822 7622 2929 2e61 6c69 6173 2822  it("v")).alias("
-0002be30: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-0002be40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002be50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0002be60: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-0002be70: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0002be80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0002be90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002bea0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
-0002beb0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-0002bec0: 2261 6765 223a 2032 312c 2020 2020 2020  "age": 21,      
-0002bed0: 7c0a 2020 2020 2020 2020 7c20 2022 6b65  |.        |  "ke
-0002bee0: 7922 3a20 2276 222c 2020 2020 207c 0a20  y": "v",     |. 
-0002bef0: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-0002bf00: 3a20 224a 6f65 222c 2020 7c0a 2020 2020  : "Joe",  |.    
-0002bf10: 2020 2020 7c20 2022 7a69 7022 3a20 3231      |  "zip": 21
-0002bf20: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
-0002bf30: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-0002bf40: 2020 2020 7c0a 2020 2020 2020 2020 7c7b      |.        |{
-0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf60: 207c 0a20 2020 2020 2020 207c 2020 2261   |.        |  "a
-0002bf70: 6765 223a 2032 362c 2020 2020 2020 7c0a  ge": 26,      |.
-0002bf80: 2020 2020 2020 2020 7c20 2022 6b65 7922          |  "key"
-0002bf90: 3a20 2276 222c 2020 2020 207c 0a20 2020  : "v",     |.   
-0002bfa0: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
-0002bfb0: 224a 6179 222c 2020 7c0a 2020 2020 2020  "Jay",  |.      
-0002bfc0: 2020 7c20 2022 7a69 7022 3a20 3934 3032    |  "zip": 9402
-0002bfd0: 3120 2020 207c 0a20 2020 2020 2020 207c  1    |.        |
-0002bfe0: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
-0002bff0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002c000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c010: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0002c020: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0002c030: 206f 203d 205f 746f 5f63 6f6c 5f69 665f   o = _to_col_if_
-0002c040: 7374 7228 6f62 6a2c 2022 6f62 6a65 6374  str(obj, "object
-0002c050: 5f69 6e73 6572 7422 290a 2020 2020 6b20  _insert").    k 
-0002c060: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0002c070: 286b 6579 2c20 226f 626a 6563 745f 696e  (key, "object_in
-0002c080: 7365 7274 2229 0a20 2020 2076 203d 205f  sert").    v = _
-0002c090: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-0002c0a0: 6c75 652c 2022 6f62 6a65 6374 5f69 6e73  lue, "object_ins
-0002c0b0: 6572 7422 290a 2020 2020 7566 203d 205f  ert").    uf = _
-0002c0c0: 746f 5f63 6f6c 5f69 665f 7374 7228 7570  to_col_if_str(up
-0002c0d0: 6461 7465 5f66 6c61 672c 2022 7570 6461  date_flag, "upda
-0002c0e0: 7465 5f66 6c61 6722 2920 6966 2075 7064  te_flag") if upd
-0002c0f0: 6174 655f 666c 6167 2069 7320 6e6f 7420  ate_flag is not 
-0002c100: 4e6f 6e65 2065 6c73 6520 4e6f 6e65 0a20  None else None. 
-0002c110: 2020 2069 6620 7566 2069 7320 6e6f 7420     if uf is not 
-0002c120: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-0002c130: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
-0002c140: 6a65 6374 5f69 6e73 6572 7422 2928 6f2c  ject_insert")(o,
-0002c150: 206b 2c20 762c 2075 6629 0a20 2020 2065   k, v, uf).    e
-0002c160: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-0002c170: 7572 6e20 6275 696c 7469 6e28 226f 626a  urn builtin("obj
-0002c180: 6563 745f 696e 7365 7274 2229 286f 2c20  ect_insert")(o, 
-0002c190: 6b2c 2076 290a 0a0a 6465 6620 6f62 6a65  k, v)...def obje
-0002c1a0: 6374 5f70 6963 6b28 6f62 6a3a 2043 6f6c  ct_pick(obj: Col
-0002c1b0: 756d 6e4f 724e 616d 652c 206b 6579 313a  umnOrName, key1:
-0002c1c0: 2043 6f6c 756d 6e4f 724e 616d 652c 202a   ColumnOrName, *
-0002c1d0: 6b65 7973 3a20 436f 6c75 6d6e 4f72 4e61  keys: ColumnOrNa
-0002c1e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0002c1f0: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-0002c200: 6e65 7720 4f42 4a45 4354 2063 6f6e 7461  new OBJECT conta
-0002c210: 696e 696e 6720 736f 6d65 206f 6620 7468  ining some of th
-0002c220: 6520 6b65 792d 7661 6c75 6520 7061 6972  e key-value pair
-0002c230: 7320 6672 6f6d 2061 6e20 6578 6973 7469  s from an existi
-0002c240: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
-0002c250: 546f 2069 6465 6e74 6966 7920 7468 6520  To identify the 
-0002c260: 6b65 792d 7661 6c75 6520 7061 6972 7320  key-value pairs 
-0002c270: 746f 2069 6e63 6c75 6465 2069 6e20 7468  to include in th
-0002c280: 6520 6e65 7720 6f62 6a65 6374 2c20 7061  e new object, pa
-0002c290: 7373 2069 6e20 7468 6520 6b65 7973 2061  ss in the keys a
-0002c2a0: 7320 6172 6775 6d65 6e74 732c 0a20 2020  s arguments,.   
-0002c2b0: 206f 7220 7061 7373 2069 6e20 616e 2061   or pass in an a
-0002c2c0: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
-0002c2d0: 7468 6520 6b65 7973 2e0a 0a20 2020 2049  the keys...    I
-0002c2e0: 6620 6120 7370 6563 6966 6965 6420 6b65  f a specified ke
-0002c2f0: 7920 6973 206e 6f74 2070 7265 7365 6e74  y is not present
-0002c300: 2069 6e20 7468 6520 696e 7075 7420 6f62   in the input ob
-0002c310: 6a65 6374 2c20 7468 6520 6b65 7920 6973  ject, the key is
-0002c320: 2069 676e 6f72 6564 2e0a 0a20 2020 2045   ignored...    E
-0002c330: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002c340: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0002c350: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-0002c360: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
-0002c370: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-0002c380: 203d 2073 6573 7369 6f6e 2e73 716c 280a   = session.sql(.
-0002c390: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002c3a0: 2273 656c 6563 7420 6f62 6a65 6374 5f63  "select object_c
-0002c3b0: 6f6e 7374 7275 6374 2861 2c62 2c63 2c64  onstruct(a,b,c,d
-0002c3c0: 2c65 2c66 2920 6173 206f 626a 2c20 6b2c  ,e,f) as obj, k,
-0002c3d0: 2076 2066 726f 6d20 220a 2020 2020 2020   v from ".      
-0002c3e0: 2020 2e2e 2e20 2020 2020 2276 616c 7565    ...     "value
-0002c3f0: 7328 2761 6765 272c 2032 312c 2027 7a69  s('age', 21, 'zi
-0002c400: 7027 2c20 3231 3032 312c 2027 6e61 6d65  p', 21021, 'name
-0002c410: 272c 2027 4a6f 6527 2c20 2761 6765 272c  ', 'Joe', 'age',
-0002c420: 2030 292c 220a 2020 2020 2020 2020 2e2e   0),".        ..
-0002c430: 2e20 2020 2020 2228 2761 6765 272c 2032  .     "('age', 2
-0002c440: 362c 2027 7a69 7027 2c20 3934 3032 312c  6, 'zip', 94021,
-0002c450: 2027 6e61 6d65 272c 2027 4a61 7927 2c20   'name', 'Jay', 
-0002c460: 2761 6765 272c 2030 2920 6173 2054 2861  'age', 0) as T(a
-0002c470: 2c62 2c63 2c64 2c65 2c66 2c6b 2c76 2922  ,b,c,d,e,f,k,v)"
-0002c480: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-0002c490: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002c4a0: 6c65 6374 286f 626a 6563 745f 7069 636b  lect(object_pick
-0002c4b0: 2863 6f6c 2822 6f62 6a22 292c 2063 6f6c  (col("obj"), col
-0002c4c0: 2822 6b22 292c 206c 6974 2822 6e61 6d65  ("k"), lit("name
-0002c4d0: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-0002c4e0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-0002c4f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002c500: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002c510: 7c22 5245 5355 4c54 2220 2020 2020 2020  |"RESULT"       
-0002c520: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002c530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0002c540: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-0002c550: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002c560: 2020 2020 7c20 2022 6167 6522 3a20 3231      |  "age": 21
-0002c570: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-0002c580: 7c20 2022 6e61 6d65 223a 2022 4a6f 6522  |  "name": "Joe"
-0002c590: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-0002c5a0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-0002c5b0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-0002c5c0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002c5d0: 2020 2020 7c20 2022 6167 6522 3a20 3236      |  "age": 26
-0002c5e0: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
-0002c5f0: 7c20 2022 6e61 6d65 223a 2022 4a61 7922  |  "name": "Jay"
-0002c600: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-0002c610: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-0002c620: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002c630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0002c640: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0002c650: 2020 2020 2222 220a 2020 2020 6f20 3d20      """.    o = 
-0002c660: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
-0002c670: 626a 2c20 226f 626a 6563 745f 7069 636b  bj, "object_pick
-0002c680: 2229 0a20 2020 206b 3120 3d20 5f74 6f5f  ").    k1 = _to_
-0002c690: 636f 6c5f 6966 5f73 7472 286b 6579 312c  col_if_str(key1,
-0002c6a0: 2022 6f62 6a65 6374 5f70 6963 6b22 290a   "object_pick").
-0002c6b0: 2020 2020 6b73 203d 205b 5f74 6f5f 636f      ks = [_to_co
-0002c6c0: 6c5f 6966 5f73 7472 286b 2c20 226f 626a  l_if_str(k, "obj
-0002c6d0: 6563 745f 7069 636b 2229 2066 6f72 206b  ect_pick") for k
-0002c6e0: 2069 6e20 6b65 7973 5d0a 2020 2020 7265   in keys].    re
-0002c6f0: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
-0002c700: 6a65 6374 5f70 6963 6b22 2928 6f2c 206b  ject_pick")(o, k
-0002c710: 312c 202a 6b73 290a 0a0a 6465 6620 6173  1, *ks)...def as
-0002c720: 6328 633a 2043 6f6c 756d 6e4f 724e 616d  c(c: ColumnOrNam
-0002c730: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0002c740: 2020 2222 2252 6574 7572 6e73 2061 2043    """Returns a C
-0002c750: 6f6c 756d 6e20 6578 7072 6573 7369 6f6e  olumn expression
-0002c760: 2077 6974 6820 7661 6c75 6573 2073 6f72   with values sor
-0002c770: 7465 6420 696e 2061 7363 656e 6469 6e67  ted in ascending
-0002c780: 206f 7264 6572 2e0a 0a20 2020 2045 7861   order...    Exa
-0002c790: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0002c7a0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002c7b0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0002c7c0: 6528 5b4e 6f6e 652c 2033 2c20 322c 2031  e([None, 3, 2, 1
-0002c7d0: 2c20 4e6f 6e65 5d2c 2073 6368 656d 613d  , None], schema=
-0002c7e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-0002c7f0: 3e3e 2064 662e 736f 7274 2861 7363 2864  >> df.sort(asc(d
-0002c800: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
-0002c810: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0002c820: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
-0002c830: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
-0002c840: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
-0002c850: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
-0002c860: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0002c870: 7472 2863 2c20 2261 7363 2229 0a20 2020  tr(c, "asc").   
-0002c880: 2072 6574 7572 6e20 632e 6173 6328 290a   return c.asc().
-0002c890: 0a0a 6465 6620 6173 635f 6e75 6c6c 735f  ..def asc_nulls_
-0002c8a0: 6669 7273 7428 633a 2043 6f6c 756d 6e4f  first(c: ColumnO
-0002c8b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002c8c0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-0002c8d0: 2061 2043 6f6c 756d 6e20 6578 7072 6573   a Column expres
-0002c8e0: 7369 6f6e 2077 6974 6820 7661 6c75 6573  sion with values
-0002c8f0: 2073 6f72 7465 6420 696e 2061 7363 656e   sorted in ascen
-0002c900: 6469 6e67 206f 7264 6572 0a20 2020 2028  ding order.    (
-0002c910: 6e75 6c6c 2076 616c 7565 7320 736f 7274  null values sort
-0002c920: 6564 2062 6566 6f72 6520 6e6f 6e2d 6e75  ed before non-nu
-0002c930: 6c6c 2076 616c 7565 7329 2e0a 0a20 2020  ll values)...   
-0002c940: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0002c950: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002c960: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002c970: 6672 616d 6528 5b4e 6f6e 652c 2033 2c20  frame([None, 3, 
-0002c980: 322c 2031 2c20 4e6f 6e65 5d2c 2073 6368  2, 1, None], sch
-0002c990: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-0002c9a0: 2020 203e 3e3e 2064 662e 736f 7274 2861     >>> df.sort(a
-0002c9b0: 7363 5f6e 756c 6c73 5f66 6972 7374 2864  sc_nulls_first(d
-0002c9c0: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
-0002c9d0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0002c9e0: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
-0002c9f0: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
-0002ca00: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
-0002ca10: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
-0002ca20: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0002ca30: 7472 2863 2c20 2261 7363 5f6e 756c 6c73  tr(c, "asc_nulls
-0002ca40: 5f66 6972 7374 2229 0a20 2020 2072 6574  _first").    ret
-0002ca50: 7572 6e20 632e 6173 635f 6e75 6c6c 735f  urn c.asc_nulls_
-0002ca60: 6669 7273 7428 290a 0a0a 6465 6620 6173  first()...def as
-0002ca70: 635f 6e75 6c6c 735f 6c61 7374 2863 3a20  c_nulls_last(c: 
-0002ca80: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0002ca90: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0002caa0: 5265 7475 726e 7320 6120 436f 6c75 6d6e  Returns a Column
-0002cab0: 2065 7870 7265 7373 696f 6e20 7769 7468   expression with
-0002cac0: 2076 616c 7565 7320 736f 7274 6564 2069   values sorted i
-0002cad0: 6e20 6173 6365 6e64 696e 6720 6f72 6465  n ascending orde
-0002cae0: 720a 2020 2020 286e 756c 6c20 7661 6c75  r.    (null valu
-0002caf0: 6573 2073 6f72 7465 6420 6166 7465 7220  es sorted after 
-0002cb00: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
-0002cb10: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002cb20: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0002cb30: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002cb40: 655f 6461 7461 6672 616d 6528 5b4e 6f6e  e_dataframe([Non
-0002cb50: 652c 2033 2c20 322c 2031 2c20 4e6f 6e65  e, 3, 2, 1, None
-0002cb60: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0002cb70: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002cb80: 736f 7274 2861 7363 5f6e 756c 6c73 5f6c  sort(asc_nulls_l
-0002cb90: 6173 7428 6466 5b22 6122 5d29 292e 636f  ast(df["a"])).co
-0002cba0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0002cbb0: 5b52 6f77 2841 3d31 292c 2052 6f77 2841  [Row(A=1), Row(A
-0002cbc0: 3d32 292c 2052 6f77 2841 3d33 292c 2052  =2), Row(A=3), R
-0002cbd0: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
-0002cbe0: 413d 4e6f 6e65 295d 0a20 2020 2022 2222  A=None)].    """
-0002cbf0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002cc00: 5f69 665f 7374 7228 632c 2022 6173 635f  _if_str(c, "asc_
-0002cc10: 6e75 6c6c 735f 6c61 7374 2229 0a20 2020  nulls_last").   
-0002cc20: 2072 6574 7572 6e20 632e 6173 635f 6e75   return c.asc_nu
-0002cc30: 6c6c 735f 6c61 7374 2829 0a0a 0a64 6566  lls_last()...def
-0002cc40: 2064 6573 6328 633a 2043 6f6c 756d 6e4f   desc(c: ColumnO
-0002cc50: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002cc60: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0002cc70: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
-0002cc80: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
-0002cc90: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
-0002cca0: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
-0002ccb0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002ccc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0002ccd0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002cce0: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-0002ccf0: 322c 2033 2c20 4e6f 6e65 2c20 4e6f 6e65  2, 3, None, None
-0002cd00: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0002cd10: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002cd20: 736f 7274 2864 6573 6328 6466 5b22 6122  sort(desc(df["a"
-0002cd30: 5d29 292e 636f 6c6c 6563 7428 290a 2020  ])).collect().  
-0002cd40: 2020 2020 2020 5b52 6f77 2841 3d33 292c        [Row(A=3),
-0002cd50: 2052 6f77 2841 3d32 292c 2052 6f77 2841   Row(A=2), Row(A
-0002cd60: 3d31 292c 2052 6f77 2841 3d4e 6f6e 6529  =1), Row(A=None)
-0002cd70: 2c20 526f 7728 413d 4e6f 6e65 295d 0a20  , Row(A=None)]. 
-0002cd80: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0002cd90: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
-0002cda0: 2022 6465 7363 2229 0a20 2020 2072 6574   "desc").    ret
-0002cdb0: 7572 6e20 632e 6465 7363 2829 0a0a 0a64  urn c.desc()...d
-0002cdc0: 6566 2064 6573 635f 6e75 6c6c 735f 6669  ef desc_nulls_fi
-0002cdd0: 7273 7428 633a 2043 6f6c 756d 6e4f 724e  rst(c: ColumnOrN
-0002cde0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0002cdf0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0002ce00: 726e 7320 6120 436f 6c75 6d6e 2065 7870  rns a Column exp
-0002ce10: 7265 7373 696f 6e20 7769 7468 2076 616c  ression with val
-0002ce20: 7565 7320 736f 7274 6564 2069 6e20 6465  ues sorted in de
-0002ce30: 7363 656e 6469 6e67 206f 7264 6572 0a20  scending order. 
-0002ce40: 2020 2028 6e75 6c6c 2076 616c 7565 7320     (null values 
-0002ce50: 736f 7274 6564 2062 6566 6f72 6520 6e6f  sorted before no
-0002ce60: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
-0002ce70: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0002ce80: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0002ce90: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0002cea0: 6461 7461 6672 616d 6528 5b31 2c20 322c  dataframe([1, 2,
-0002ceb0: 2033 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c   3, None, None],
-0002cec0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0002ced0: 2020 2020 2020 203e 3e3e 2064 662e 736f         >>> df.so
-0002cee0: 7274 2864 6573 635f 6e75 6c6c 735f 6669  rt(desc_nulls_fi
-0002cef0: 7273 7428 6466 5b22 6122 5d29 292e 636f  rst(df["a"])).co
-0002cf00: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0002cf10: 5b52 6f77 2841 3d4e 6f6e 6529 2c20 526f  [Row(A=None), Ro
-0002cf20: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-0002cf30: 3d33 292c 2052 6f77 2841 3d32 292c 2052  =3), Row(A=2), R
-0002cf40: 6f77 2841 3d31 295d 0a20 2020 2022 2222  ow(A=1)].    """
-0002cf50: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002cf60: 5f69 665f 7374 7228 632c 2022 6465 7363  _if_str(c, "desc
-0002cf70: 5f6e 756c 6c73 5f66 6972 7374 2229 0a20  _nulls_first"). 
-0002cf80: 2020 2072 6574 7572 6e20 632e 6465 7363     return c.desc
-0002cf90: 5f6e 756c 6c73 5f66 6972 7374 2829 0a0a  _nulls_first()..
-0002cfa0: 0a64 6566 2064 6573 635f 6e75 6c6c 735f  .def desc_nulls_
-0002cfb0: 6c61 7374 2863 3a20 436f 6c75 6d6e 4f72  last(c: ColumnOr
-0002cfc0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002cfd0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-0002cfe0: 7572 6e73 2061 2043 6f6c 756d 6e20 6578  urns a Column ex
-0002cff0: 7072 6573 7369 6f6e 2077 6974 6820 7661  pression with va
-0002d000: 6c75 6573 2073 6f72 7465 6420 696e 2064  lues sorted in d
-0002d010: 6573 6365 6e64 696e 6720 6f72 6465 720a  escending order.
-0002d020: 2020 2020 286e 756c 6c20 7661 6c75 6573      (null values
-0002d030: 2073 6f72 7465 6420 6166 7465 7220 6e6f   sorted after no
-0002d040: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
-0002d050: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0002d060: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002d070: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0002d080: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
-0002d090: 332c 204e 6f6e 652c 204e 6f6e 655d 2c20  3, None, None], 
-0002d0a0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-0002d0b0: 2020 2020 2020 3e3e 3e20 6466 2e73 6f72        >>> df.sor
-0002d0c0: 7428 6465 7363 5f6e 756c 6c73 5f6c 6173  t(desc_nulls_las
-0002d0d0: 7428 6466 5b22 6122 5d29 292e 636f 6c6c  t(df["a"])).coll
-0002d0e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0002d0f0: 6f77 2841 3d33 292c 2052 6f77 2841 3d32  ow(A=3), Row(A=2
-0002d100: 292c 2052 6f77 2841 3d31 292c 2052 6f77  ), Row(A=1), Row
-0002d110: 2841 3d4e 6f6e 6529 2c20 526f 7728 413d  (A=None), Row(A=
-0002d120: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
-0002d130: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0002d140: 665f 7374 7228 632c 2022 6465 7363 5f6e  f_str(c, "desc_n
-0002d150: 756c 6c73 5f6c 6173 7422 290a 2020 2020  ulls_last").    
-0002d160: 7265 7475 726e 2063 2e64 6573 635f 6e75  return c.desc_nu
-0002d170: 6c6c 735f 6c61 7374 2829 0a0a 0a64 6566  lls_last()...def
-0002d180: 2061 735f 6172 7261 7928 7661 7269 616e   as_array(varian
-0002d190: 743a 2043 6f6c 756d 6e4f 724e 616d 6529  t: ColumnOrName)
-0002d1a0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0002d1b0: 2222 2243 6173 7473 2061 2056 4152 4941  """Casts a VARIA
-0002d1c0: 4e54 2076 616c 7565 2074 6f20 616e 2061  NT value to an a
-0002d1d0: 7272 6179 2e0a 0a20 2020 2045 7861 6d70  rray...    Examp
-0002d1e0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-0002d1f0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
-0002d200: 6c28 2273 656c 6563 7420 6172 7261 795f  l("select array_
-0002d210: 636f 6e73 7472 7563 7428 312c 2032 293a  construct(1, 2):
-0002d220: 3a76 6172 6961 6e74 2061 7320 6122 290a  :variant as a").
-0002d230: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002d240: 656c 6563 7428 6173 5f61 7272 6179 2822  elect(as_array("
-0002d250: 6122 292e 616c 6961 7328 2272 6573 756c  a").alias("resul
-0002d260: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-0002d270: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002d280: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0002d290: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-0002d2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002d2b0: 2020 207c 5b20 2020 2020 2020 2020 7c0a     |[         |.
-0002d2c0: 2020 2020 2020 2020 7c20 2031 2c20 2020          |  1,   
-0002d2d0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-0002d2e0: 3220 2020 2020 2020 7c0a 2020 2020 2020  2       |.      
-0002d2f0: 2020 7c5d 2020 2020 2020 2020 207c 0a20    |]         |. 
-0002d300: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002d310: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0002d320: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0002d330: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0002d340: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
-0002d350: 2261 735f 6172 7261 7922 290a 2020 2020  "as_array").    
-0002d360: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002d370: 6173 5f61 7272 6179 2229 2863 290a 0a0a  as_array")(c)...
-0002d380: 6465 6620 6173 5f62 696e 6172 7928 7661  def as_binary(va
-0002d390: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
-0002d3a0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0002d3b0: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
-0002d3c0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
-0002d3d0: 6120 6269 6e61 7279 2073 7472 696e 672e  a binary string.
-0002d3e0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0002d3f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0002d400: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
-0002d410: 6c65 6374 2074 6f5f 6269 6e61 7279 2827  lect to_binary('
-0002d420: 4630 4135 2729 3a3a 7661 7269 616e 7420  F0A5')::variant 
-0002d430: 6173 2061 2229 0a20 2020 2020 2020 203e  as a").        >
-0002d440: 3e3e 2064 662e 7365 6c65 6374 2861 735f  >> df.select(as_
-0002d450: 6269 6e61 7279 2822 6122 292e 616c 6961  binary("a").alia
-0002d460: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-0002d470: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0002d480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002d490: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002d4a0: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
-0002d4b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0002d4c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0002d4d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002d4e0: 2020 2020 207c 6279 7465 6172 7261 7928       |bytearray(
-0002d4f0: 6227 5c78 6630 5c78 6135 2729 2020 7c0a  b'\xf0\xa5')  |.
-0002d500: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002d510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002d520: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0002d530: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-0002d540: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0002d550: 665f 7374 7228 7661 7269 616e 742c 2022  f_str(variant, "
-0002d560: 6173 5f62 696e 6172 7922 290a 2020 2020  as_binary").    
-0002d570: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002d580: 6173 5f62 696e 6172 7922 2928 6329 0a0a  as_binary")(c)..
-0002d590: 0a64 6566 2061 735f 6368 6172 2876 6172  .def as_char(var
-0002d5a0: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-0002d5b0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0002d5c0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
-0002d5d0: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-0002d5e0: 2073 7472 696e 672e 0a0a 2020 2020 4578   string...    Ex
-0002d5f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0002d600: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0002d610: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
-0002d620: 6374 696f 6e73 2069 6d70 6f72 7420 6173  ctions import as
-0002d630: 5f63 6861 722c 2074 6f5f 7661 7269 616e  _char, to_varian
-0002d640: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
-0002d650: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-0002d660: 7365 6c65 6374 2027 736f 6d65 2073 7472  select 'some str
-0002d670: 696e 6727 2061 7320 6368 6172 2229 0a20  ing' as char"). 
-0002d680: 2020 2020 2020 203e 3e3e 2064 662e 6368         >>> df.ch
-0002d690: 6172 5f76 203d 2074 6f5f 7661 7269 616e  ar_v = to_varian
-0002d6a0: 7428 6466 2e63 6861 7229 0a20 2020 2020  t(df.char).     
-0002d6b0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0002d6c0: 2864 662e 6368 6172 5f76 2e61 735f 2822  (df.char_v.as_("
-0002d6d0: 6368 6172 2229 292e 636f 6c6c 6563 7428  char")).collect(
-0002d6e0: 2920 3d3d 2064 662e 7365 6c65 6374 2864  ) == df.select(d
-0002d6f0: 662e 6368 6172 292e 636f 6c6c 6563 7428  f.char).collect(
-0002d700: 290a 2020 2020 2020 2020 4661 6c73 650a  ).        False.
-0002d710: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002d720: 656c 6563 7428 6173 5f63 6861 7228 6466  elect(as_char(df
-0002d730: 2e63 6861 725f 7629 2e61 735f 2822 6368  .char_v).as_("ch
-0002d740: 6172 2229 292e 636f 6c6c 6563 7428 2920  ar")).collect() 
-0002d750: 3d3d 2064 662e 7365 6c65 6374 2864 662e  == df.select(df.
-0002d760: 6368 6172 292e 636f 6c6c 6563 7428 290a  char).collect().
-0002d770: 2020 2020 2020 2020 5472 7565 0a20 2020          True.   
-0002d780: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0002d790: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
-0002d7a0: 616e 742c 2022 6173 5f63 6861 7222 290a  ant, "as_char").
-0002d7b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002d7c0: 696e 2822 6173 5f63 6861 7222 2928 6329  in("as_char")(c)
-0002d7d0: 0a0a 0a64 6566 2061 735f 7661 7263 6861  ...def as_varcha
-0002d7e0: 7228 7661 7269 616e 743a 2043 6f6c 756d  r(variant: Colum
-0002d7f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002d800: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
-0002d810: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
-0002d820: 2074 6f20 6120 7374 7269 6e67 2e0a 0a20   to a string... 
-0002d830: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0002d840: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0002d850: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002d860: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-0002d870: 7274 2061 735f 7661 7263 6861 722c 2074  rt as_varchar, t
-0002d880: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
-0002d890: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0002d8a0: 6f6e 2e73 716c 2822 7365 6c65 6374 2027  on.sql("select '
-0002d8b0: 736f 6d65 2073 7472 696e 6727 2061 7320  some string' as 
-0002d8c0: 6368 6172 2229 0a20 2020 2020 2020 203e  char").        >
-0002d8d0: 3e3e 2064 662e 6368 6172 5f76 203d 2074  >> df.char_v = t
-0002d8e0: 6f5f 7661 7269 616e 7428 6466 2e63 6861  o_variant(df.cha
-0002d8f0: 7229 0a20 2020 2020 2020 203e 3e3e 2064  r).        >>> d
-0002d900: 662e 7365 6c65 6374 2864 662e 6368 6172  f.select(df.char
-0002d910: 5f76 2e61 735f 2822 6368 6172 2229 292e  _v.as_("char")).
-0002d920: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
-0002d930: 7365 6c65 6374 2864 662e 6368 6172 292e  select(df.char).
-0002d940: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002d950: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-0002d960: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
-0002d970: 5f76 6172 6368 6172 2864 662e 6368 6172  _varchar(df.char
-0002d980: 5f76 292e 6173 5f28 2263 6861 7222 2929  _v).as_("char"))
-0002d990: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
-0002d9a0: 2e73 656c 6563 7428 6466 2e63 6861 7229  .select(df.char)
-0002d9b0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0002d9c0: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
-0002d9d0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0002d9e0: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
-0002d9f0: 2261 735f 7661 7263 6861 7222 290a 2020  "as_varchar").  
-0002da00: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0002da10: 2822 6173 5f76 6172 6368 6172 2229 2863  ("as_varchar")(c
-0002da20: 290a 0a0a 6465 6620 6173 5f64 6174 6528  )...def as_date(
-0002da30: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
-0002da40: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002da50: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
-0002da60: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
-0002da70: 6f20 6120 6461 7465 2e0a 0a20 2020 2045  o a date...    E
-0002da80: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002da90: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0002daa0: 6e2e 7371 6c28 2273 656c 6563 7420 6461  n.sql("select da
-0002dab0: 7465 2732 3032 302d 312d 3127 3a3a 7661  te'2020-1-1'::va
-0002dac0: 7269 616e 7420 6173 2061 2229 0a20 2020  riant as a").   
-0002dad0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002dae0: 6374 2861 735f 6461 7465 2822 6122 292e  ct(as_date("a").
-0002daf0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002db00: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002db10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002db20: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0002db30: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002db40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002db50: 2020 2020 207c 3230 3230 2d30 312d 3031       |2020-01-01
-0002db60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002db70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002db80: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0002db90: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0002dba0: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-0002dbb0: 7269 616e 742c 2022 6173 5f64 6174 6522  riant, "as_date"
-0002dbc0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002dbd0: 6c74 696e 2822 6173 5f64 6174 6522 2928  ltin("as_date")(
-0002dbe0: 6329 0a0a 0a64 6566 2063 6173 7428 636f  c)...def cast(co
-0002dbf0: 6c75 6d6e 3a20 436f 6c75 6d6e 4f72 4e61  lumn: ColumnOrNa
-0002dc00: 6d65 2c20 746f 3a20 556e 696f 6e5b 7374  me, to: Union[st
-0002dc10: 722c 2044 6174 6154 7970 655d 2920 2d3e  r, DataType]) ->
-0002dc20: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0002dc30: 436f 6e76 6572 7473 2061 2076 616c 7565  Converts a value
-0002dc40: 206f 6620 6f6e 6520 6461 7461 2074 7970   of one data typ
-0002dc50: 6520 696e 746f 2061 6e6f 7468 6572 2064  e into another d
-0002dc60: 6174 6120 7479 7065 2e0a 2020 2020 5468  ata type..    Th
-0002dc70: 6520 7365 6d61 6e74 6963 7320 6f66 2043  e semantics of C
-0002dc80: 4153 5420 6172 6520 7468 6520 7361 6d65  AST are the same
-0002dc90: 2061 7320 7468 6520 7365 6d61 6e74 6963   as the semantic
-0002dca0: 7320 6f66 2074 6865 2063 6f72 7265 7370  s of the corresp
-0002dcb0: 6f6e 6469 6e67 2074 6f20 6461 7461 7479  onding to dataty
-0002dcc0: 7065 2063 6f6e 7665 7273 696f 6e20 6675  pe conversion fu
-0002dcd0: 6e63 7469 6f6e 732e 0a20 2020 2049 6620  nctions..    If 
-0002dce0: 7468 6520 6361 7374 2069 7320 6e6f 7420  the cast is not 
-0002dcf0: 706f 7373 6962 6c65 2c20 6120 6060 536e  possible, a ``Sn
-0002dd00: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
-0002dd10: 6f6e 6060 2065 7863 6570 7469 6f6e 2069  on`` exception i
-0002dd20: 7320 7468 726f 776e 2e0a 0a20 2020 2045  s thrown...    E
-0002dd30: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0002dd40: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0002dd50: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-0002dd60: 7065 7320 696d 706f 7274 2044 6563 696d  pes import Decim
-0002dd70: 616c 5479 7065 2c20 496e 7465 6765 7254  alType, IntegerT
-0002dd80: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-0002dd90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002dda0: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-0002ddb0: 312e 3534 3332 5d5d 2c20 7363 6865 6d61  1.5432]], schema
-0002ddc0: 3d5b 2264 225d 290a 2020 2020 2020 2020  =["d"]).        
-0002ddd0: 3e3e 3e20 6466 2e73 656c 6563 7428 6361  >>> df.select(ca
-0002dde0: 7374 2864 662e 642c 2044 6563 696d 616c  st(df.d, Decimal
-0002ddf0: 5479 7065 2831 352c 2032 2929 2e61 735f  Type(15, 2)).as_
-0002de00: 2822 4445 4349 4d41 4c22 292c 2063 6173  ("DECIMAL"), cas
-0002de10: 7428 6466 2e64 2c20 496e 7465 6765 7254  t(df.d, IntegerT
-0002de20: 7970 6528 2929 2e61 735f 2822 494e 5422  ype()).as_("INT"
-0002de30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0002de40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0002de50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002de60: 7c22 4445 4349 4d41 4c22 2020 7c22 494e  |"DECIMAL"  |"IN
-0002de70: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-0002de80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002de90: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e35  ---.        |1.5
-0002dea0: 3420 2020 2020 2020 7c32 2020 2020 2020  4       |2      
-0002deb0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002dec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0002ded0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0002dee0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-0002def0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0002df00: 7472 2863 6f6c 756d 6e2c 2022 6361 7374  tr(column, "cast
-0002df10: 2229 0a20 2020 2072 6574 7572 6e20 632e  ").    return c.
-0002df20: 6361 7374 2874 6f29 0a0a 0a64 6566 2074  cast(to)...def t
-0002df30: 7279 5f63 6173 7428 636f 6c75 6d6e 3a20  ry_cast(column: 
-0002df40: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 746f  ColumnOrName, to
-0002df50: 3a20 556e 696f 6e5b 7374 722c 2044 6174  : Union[str, Dat
-0002df60: 6154 7970 655d 2920 2d3e 2043 6f6c 756d  aType]) -> Colum
-0002df70: 6e3a 0a20 2020 2022 2222 4120 7370 6563  n:.    """A spec
-0002df80: 6961 6c20 7665 7273 696f 6e20 6f66 2043  ial version of C
-0002df90: 4153 5420 666f 7220 6120 7375 6273 6574  AST for a subset
-0002dfa0: 206f 6620 6461 7461 2074 7970 6520 636f   of data type co
-0002dfb0: 6e76 6572 7369 6f6e 732e 0a20 2020 2049  nversions..    I
-0002dfc0: 7420 7065 7266 6f72 6d73 2074 6865 2073  t performs the s
-0002dfd0: 616d 6520 6f70 6572 6174 696f 6e20 2869  ame operation (i
-0002dfe0: 2e65 2e20 636f 6e76 6572 7473 2061 2076  .e. converts a v
-0002dff0: 616c 7565 206f 6620 6f6e 6520 6461 7461  alue of one data
-0002e000: 2074 7970 6520 696e 746f 2061 6e6f 7468   type into anoth
-0002e010: 6572 2064 6174 6120 7479 7065 292c 0a20  er data type),. 
-0002e020: 2020 2062 7574 2072 6574 7572 6e73 2061     but returns a
-0002e030: 204e 554c 4c20 7661 6c75 6520 696e 7374   NULL value inst
-0002e040: 6561 6420 6f66 2072 6169 7369 6e67 2061  ead of raising a
-0002e050: 6e20 6572 726f 7220 7768 656e 2074 6865  n error when the
-0002e060: 2063 6f6e 7665 7273 696f 6e20 6361 6e20   conversion can 
-0002e070: 6e6f 7420 6265 2070 6572 666f 726d 6564  not be performed
-0002e080: 2e0a 0a20 2020 2054 6865 2060 6063 6f6c  ...    The ``col
-0002e090: 756d 6e60 6020 6172 6775 6d65 6e74 206d  umn`` argument m
-0002e0a0: 7573 7420 6265 2061 2073 7472 696e 6720  ust be a string 
-0002e0b0: 636f 6c75 6d6e 2069 6e20 536e 6f77 666c  column in Snowfl
-0002e0c0: 616b 652e 0a0a 2020 2020 4578 616d 706c  ake...    Exampl
-0002e0d0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-0002e0e0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0002e0f0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0002e100: 6d70 6f72 7420 496e 7465 6765 7254 7970  mport IntegerTyp
-0002e110: 652c 2046 6c6f 6174 5479 7065 0a20 2020  e, FloatType.   
-0002e120: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0002e130: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0002e140: 6166 7261 6d65 285b 2730 272c 2027 2d31  aframe(['0', '-1
-0002e150: 3227 2c20 2732 3227 2c20 2731 3030 3127  2', '22', '1001'
-0002e160: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0002e170: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002e180: 7365 6c65 6374 2874 7279 5f63 6173 7428  select(try_cast(
-0002e190: 636f 6c28 2261 2229 2c20 496e 7465 6765  col("a"), Intege
-0002e1a0: 7254 7970 6528 2929 2e61 735f 2827 616e  rType()).as_('an
-0002e1b0: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
-0002e1c0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-0002e1d0: 3029 2c20 526f 7728 414e 533d 2d31 3229  0), Row(ANS=-12)
-0002e1e0: 2c20 526f 7728 414e 533d 3232 292c 2052  , Row(ANS=22), R
-0002e1f0: 6f77 2841 4e53 3d31 3030 3129 5d0a 0a20  ow(ANS=1001)].. 
-0002e200: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0002e210: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0002e220: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0002e230: 7461 6672 616d 6528 5b27 302e 3132 272c  taframe(['0.12',
-0002e240: 2027 5553 4420 3237 2e39 3027 2c20 2731   'USD 27.90', '1
-0002e250: 332e 3937 2055 5344 272c 2027 e282 ac39  3.97 USD', '...9
-0002e260: 372e 3027 2c20 2731 372c 2d27 5d2c 2073  7.0', '17,-'], s
-0002e270: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0002e280: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002e290: 6374 2874 7279 5f63 6173 7428 636f 6c28  ct(try_cast(col(
-0002e2a0: 2261 2229 2c20 466c 6f61 7454 7970 6528  "a"), FloatType(
-0002e2b0: 2929 2e61 735f 2827 616e 7327 2929 2e63  )).as_('ans')).c
-0002e2c0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0002e2d0: 205b 526f 7728 414e 533d 302e 3132 292c   [Row(ANS=0.12),
-0002e2e0: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
-0002e2f0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
-0002e300: 6f77 2841 4e53 3d4e 6f6e 6529 2c20 526f  ow(ANS=None), Ro
-0002e310: 7728 414e 533d 4e6f 6e65 295d 0a0a 2020  w(ANS=None)]..  
-0002e320: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0002e330: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-0002e340: 756d 6e2c 2022 7472 795f 6361 7374 2229  umn, "try_cast")
-0002e350: 0a20 2020 2072 6574 7572 6e20 632e 7472  .    return c.tr
-0002e360: 795f 6361 7374 2874 6f29 0a0a 0a64 6566  y_cast(to)...def
-0002e370: 205f 6173 5f64 6563 696d 616c 5f6f 725f   _as_decimal_or_
-0002e380: 6e75 6d62 6572 280a 2020 2020 6361 7374  number(.    cast
-0002e390: 5f74 7970 653a 2073 7472 2c0a 2020 2020  _type: str,.    
-0002e3a0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
-0002e3b0: 724e 616d 652c 0a20 2020 2070 7265 6369  rName,.    preci
-0002e3c0: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b69  sion: Optional[i
-0002e3d0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-0002e3e0: 7363 616c 653a 204f 7074 696f 6e61 6c5b  scale: Optional[
-0002e3f0: 696e 745d 203d 204e 6f6e 652c 0a29 202d  int] = None,.) -
-0002e400: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002e410: 2248 656c 7065 7220 6675 6e63 7469 6f6e  "Helper function
-0002e420: 2074 6861 7420 6361 7374 7320 6120 5641   that casts a VA
-0002e430: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-0002e440: 2064 6563 696d 616c 206f 7220 6e75 6d62   decimal or numb
-0002e450: 6572 2e22 2222 0a20 2020 2063 203d 205f  er.""".    c = _
-0002e460: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-0002e470: 7269 616e 742c 2063 6173 745f 7479 7065  riant, cast_type
-0002e480: 290a 2020 2020 6966 2073 6361 6c65 2061  ).    if scale a
-0002e490: 6e64 206e 6f74 2070 7265 6369 7369 6f6e  nd not precision
-0002e4a0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0002e4b0: 5661 6c75 6545 7272 6f72 2822 4361 6e6e  ValueError("Cann
-0002e4c0: 6f74 2064 6566 696e 6520 7363 616c 6520  ot define scale 
-0002e4d0: 7769 7468 6f75 7420 7072 6563 6973 696f  without precisio
-0002e4e0: 6e22 290a 2020 2020 6966 2070 7265 6369  n").    if preci
-0002e4f0: 7369 6f6e 2061 6e64 2073 6361 6c65 3a0a  sion and scale:.
-0002e500: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-0002e510: 7569 6c74 696e 2863 6173 745f 7479 7065  uiltin(cast_type
-0002e520: 2928 632c 206c 6974 2870 7265 6369 7369  )(c, lit(precisi
-0002e530: 6f6e 292c 206c 6974 2873 6361 6c65 2929  on), lit(scale))
-0002e540: 0a20 2020 2065 6c69 6620 7072 6563 6973  .    elif precis
-0002e550: 696f 6e3a 0a20 2020 2020 2020 2072 6574  ion:.        ret
-0002e560: 7572 6e20 6275 696c 7469 6e28 6361 7374  urn builtin(cast
-0002e570: 5f74 7970 6529 2863 2c20 6c69 7428 7072  _type)(c, lit(pr
-0002e580: 6563 6973 696f 6e29 290a 2020 2020 656c  ecision)).    el
-0002e590: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
-0002e5a0: 726e 2062 7569 6c74 696e 2863 6173 745f  rn builtin(cast_
-0002e5b0: 7479 7065 2928 6329 0a0a 0a64 6566 2061  type)(c)...def a
-0002e5c0: 735f 6465 6369 6d61 6c28 0a20 2020 2076  s_decimal(.    v
-0002e5d0: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-0002e5e0: 4e61 6d65 2c0a 2020 2020 7072 6563 6973  Name,.    precis
-0002e5f0: 696f 6e3a 204f 7074 696f 6e61 6c5b 696e  ion: Optional[in
-0002e600: 745d 203d 204e 6f6e 652c 0a20 2020 2073  t] = None,.    s
-0002e610: 6361 6c65 3a20 4f70 7469 6f6e 616c 5b69  cale: Optional[i
-0002e620: 6e74 5d20 3d20 4e6f 6e65 2c0a 2920 2d3e  nt] = None,.) ->
-0002e630: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0002e640: 4361 7374 7320 6120 5641 5249 414e 5420  Casts a VARIANT 
-0002e650: 7661 6c75 6520 746f 2061 2066 6978 6564  value to a fixed
-0002e660: 2d70 6f69 6e74 2064 6563 696d 616c 2028  -point decimal (
-0002e670: 646f 6573 206e 6f74 206d 6174 6368 2066  does not match f
-0002e680: 6c6f 6174 696e 672d 706f 696e 7420 7661  loating-point va
-0002e690: 6c75 6573 292e 0a0a 2020 2020 4578 616d  lues)...    Exam
-0002e6a0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-0002e6b0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-0002e6c0: 716c 2822 7365 6c65 6374 2031 2e32 3334  ql("select 1.234
-0002e6d0: 353a 3a76 6172 6961 6e74 2061 7320 6122  5::variant as a"
-0002e6e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002e6f0: 2e73 656c 6563 7428 6173 5f64 6563 696d  .select(as_decim
-0002e700: 616c 2822 6122 2c20 342c 2031 292e 616c  al("a", 4, 1).al
-0002e710: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-0002e720: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0002e730: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002e740: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-0002e750: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002e760: 2d2d 2d2d 0a20 2020 2020 2020 207c 312e  ----.        |1.
-0002e770: 3220 2020 2020 2020 7c0a 2020 2020 2020  2       |.      
-0002e780: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0002e790: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0002e7a0: 453e 0a20 2020 2022 2222 0a20 2020 2072  E>.    """.    r
-0002e7b0: 6574 7572 6e20 5f61 735f 6465 6369 6d61  eturn _as_decima
-0002e7c0: 6c5f 6f72 5f6e 756d 6265 7228 2261 735f  l_or_number("as_
-0002e7d0: 6465 6369 6d61 6c22 2c20 7661 7269 616e  decimal", varian
-0002e7e0: 742c 2070 7265 6369 7369 6f6e 2c20 7363  t, precision, sc
-0002e7f0: 616c 6529 0a0a 0a64 6566 2061 735f 6e75  ale)...def as_nu
-0002e800: 6d62 6572 280a 2020 2020 7661 7269 616e  mber(.    varian
-0002e810: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
-0002e820: 0a20 2020 2070 7265 6369 7369 6f6e 3a20  .    precision: 
-0002e830: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-0002e840: 4e6f 6e65 2c0a 2020 2020 7363 616c 653a  None,.    scale:
-0002e850: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-0002e860: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
-0002e870: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
-0002e880: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
-0002e890: 2074 6f20 6120 6669 7865 642d 706f 696e   to a fixed-poin
-0002e8a0: 7420 6465 6369 6d61 6c20 2864 6f65 7320  t decimal (does 
-0002e8b0: 6e6f 7420 6d61 7463 6820 666c 6f61 7469  not match floati
-0002e8c0: 6e67 2d70 6f69 6e74 2076 616c 7565 7329  ng-point values)
-0002e8d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002e8e0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002e8f0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-0002e900: 656c 6563 7420 312e 3233 3435 3a3a 7661  elect 1.2345::va
-0002e910: 7269 616e 7420 6173 2061 2229 0a20 2020  riant as a").   
-0002e920: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002e930: 6374 2861 735f 6e75 6d62 6572 2822 6122  ct(as_number("a"
-0002e940: 2c20 342c 2031 292e 616c 6961 7328 2272  , 4, 1).alias("r
-0002e950: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0002e960: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002e970: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0002e980: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0002e990: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0002e9a0: 2020 2020 2020 207c 312e 3220 2020 2020         |1.2     
-0002e9b0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002e9c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002e9d0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0002e9e0: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
-0002e9f0: 5f61 735f 6465 6369 6d61 6c5f 6f72 5f6e  _as_decimal_or_n
-0002ea00: 756d 6265 7228 2261 735f 6e75 6d62 6572  umber("as_number
-0002ea10: 222c 2076 6172 6961 6e74 2c20 7072 6563  ", variant, prec
-0002ea20: 6973 696f 6e2c 2073 6361 6c65 290a 0a0a  ision, scale)...
-0002ea30: 6465 6620 6173 5f64 6f75 626c 6528 7661  def as_double(va
-0002ea40: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
-0002ea50: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0002ea60: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
-0002ea70: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
-0002ea80: 6120 666c 6f61 7469 6e67 2d70 6f69 6e74  a floating-point
-0002ea90: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
-0002eaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-0002eab0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0002eac0: 7371 6c28 2273 656c 6563 7420 312e 3233  sql("select 1.23
-0002ead0: 3435 3a3a 7661 7269 616e 7420 6173 2061  45::variant as a
-0002eae0: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
-0002eaf0: 662e 7365 6c65 6374 2861 735f 646f 7562  f.select(as_doub
-0002eb00: 6c65 2822 6122 292e 616c 6961 7328 2272  le("a").alias("r
-0002eb10: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0002eb20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0002eb30: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0002eb40: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0002eb50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0002eb60: 2020 2020 2020 207c 312e 3233 3435 2020         |1.2345  
-0002eb70: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002eb80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002eb90: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0002eba0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0002ebb0: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
-0002ebc0: 616e 742c 2022 6173 5f64 6f75 626c 6522  ant, "as_double"
-0002ebd0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002ebe0: 6c74 696e 2822 6173 5f64 6f75 626c 6522  ltin("as_double"
-0002ebf0: 2928 6329 0a0a 0a64 6566 2061 735f 7265  )(c)...def as_re
-0002ec00: 616c 2876 6172 6961 6e74 3a20 436f 6c75  al(variant: Colu
-0002ec10: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0002ec20: 756d 6e3a 0a20 2020 2022 2222 4361 7374  umn:.    """Cast
-0002ec30: 7320 6120 5641 5249 414e 5420 7661 6c75  s a VARIANT valu
-0002ec40: 6520 746f 2061 2066 6c6f 6174 696e 672d  e to a floating-
-0002ec50: 706f 696e 7420 7661 6c75 652e 0a0a 2020  point value...  
-0002ec60: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0002ec70: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0002ec80: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002ec90: 2e74 7970 6573 2069 6d70 6f72 7420 5661  .types import Va
-0002eca0: 7269 616e 7454 7970 652c 2053 7472 7563  riantType, Struc
-0002ecb0: 7454 7970 652c 2053 7472 7563 7446 6965  tType, StructFie
-0002ecc0: 6c64 2c20 446f 7562 6c65 5479 7065 0a20  ld, DoubleType. 
-0002ecd0: 2020 2020 2020 203e 3e3e 2073 6368 656d         >>> schem
-0002ece0: 613d 5374 7275 6374 5479 7065 285b 5374  a=StructType([St
-0002ecf0: 7275 6374 4669 656c 6428 2272 6164 6975  ructField("radiu
-0002ed00: 7322 2c20 446f 7562 6c65 5479 7065 2829  s", DoubleType()
-0002ed10: 292c 2020 5374 7275 6374 4669 656c 6428  ),  StructField(
-0002ed20: 2272 6164 6975 735f 7622 2c20 5661 7269  "radius_v", Vari
-0002ed30: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
-0002ed40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0002ed50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0002ed60: 6166 7261 6d65 2864 6174 613d 5b5b 322e  aframe(data=[[2.
-0002ed70: 302c 204e 6f6e 655d 5d2c 2073 6368 656d  0, None]], schem
-0002ed80: 613d 7363 6865 6d61 290a 2020 2020 2020  a=schema).      
-0002ed90: 2020 3e3e 3e20 6466 2e72 6164 6975 735f    >>> df.radius_
-0002eda0: 7620 3d20 746f 5f76 6172 6961 6e74 2864  v = to_variant(d
-0002edb0: 662e 7261 6469 7573 290a 2020 2020 2020  f.radius).      
-0002edc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002edd0: 6466 2e72 6164 6975 735f 762e 6173 5f28  df.radius_v.as_(
-0002ede0: 2272 6164 6975 735f 7622 292c 2064 662e  "radius_v"), df.
-0002edf0: 7261 6469 7573 292e 636f 6c6c 6563 7428  radius).collect(
-0002ee00: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
-0002ee10: 4144 4955 535f 563d 2732 2e30 3030 3030  ADIUS_V='2.00000
-0002ee20: 3030 3030 3030 3030 3030 652b 3030 272c  0000000000e+00',
-0002ee30: 2052 4144 4955 533d 322e 3029 5d0a 2020   RADIUS=2.0)].  
-0002ee40: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0002ee50: 6563 7428 6173 5f72 6561 6c28 6466 2e72  ect(as_real(df.r
-0002ee60: 6164 6975 735f 7629 2e61 735f 2822 7265  adius_v).as_("re
-0002ee70: 616c 5f72 6164 6975 735f 7622 292c 2064  al_radius_v"), d
-0002ee80: 662e 7261 6469 7573 292e 636f 6c6c 6563  f.radius).collec
-0002ee90: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0002eea0: 2852 4541 4c5f 5241 4449 5553 5f56 3d32  (REAL_RADIUS_V=2
-0002eeb0: 2e30 2c20 5241 4449 5553 3d32 2e30 295d  .0, RADIUS=2.0)]
-0002eec0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002eed0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002eee0: 7661 7269 616e 742c 2022 6173 5f72 6561  variant, "as_rea
-0002eef0: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
-0002ef00: 7569 6c74 696e 2822 6173 5f72 6561 6c22  uiltin("as_real"
-0002ef10: 2928 6329 0a0a 0a64 6566 2061 735f 696e  )(c)...def as_in
-0002ef20: 7465 6765 7228 7661 7269 616e 743a 2043  teger(variant: C
-0002ef30: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0002ef40: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0002ef50: 6173 7473 2061 2056 4152 4941 4e54 2076  asts a VARIANT v
-0002ef60: 616c 7565 2074 6f20 616e 2069 6e74 6567  alue to an integ
-0002ef70: 6572 2e0a 0a20 2020 2045 7861 6d70 6c65  er...    Example
-0002ef80: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-0002ef90: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
-0002efa0: 2273 656c 6563 7420 312e 3233 3435 3a3a  "select 1.2345::
-0002efb0: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
-0002efc0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002efd0: 6c65 6374 2861 735f 696e 7465 6765 7228  lect(as_integer(
-0002efe0: 2261 2229 2e61 6c69 6173 2822 7265 7375  "a").alias("resu
-0002eff0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-0002f000: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0002f010: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-0002f020: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-0002f030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0002f040: 2020 2020 7c31 2020 2020 2020 2020 207c      |1         |
-0002f050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002f060: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0002f070: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0002f080: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0002f090: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
-0002f0a0: 2c20 2261 735f 696e 7465 6765 7222 290a  , "as_integer").
-0002f0b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002f0c0: 696e 2822 6173 5f69 6e74 6567 6572 2229  in("as_integer")
-0002f0d0: 2863 290a 0a0a 6465 6620 6173 5f6f 626a  (c)...def as_obj
-0002f0e0: 6563 7428 7661 7269 616e 743a 2043 6f6c  ect(variant: Col
-0002f0f0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0002f100: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
-0002f110: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
-0002f120: 7565 2074 6f20 616e 206f 626a 6563 742e  ue to an object.
-0002f130: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0002f140: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0002f150: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
-0002f160: 6c65 6374 206f 626a 6563 745f 636f 6e73  lect object_cons
-0002f170: 7472 7563 7428 2741 272c 312c 2742 272c  truct('A',1,'B',
-0002f180: 2742 4242 4227 293a 3a76 6172 6961 6e74  'BBBB')::variant
-0002f190: 2061 7320 6122 290a 2020 2020 2020 2020   as a").        
-0002f1a0: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
-0002f1b0: 5f6f 626a 6563 7428 2261 2229 2e61 6c69  _object("a").ali
-0002f1c0: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-0002f1d0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-0002f1e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002f1f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0002f200: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0002f210: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0002f220: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
-0002f230: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0002f240: 2020 2020 207c 2020 2241 223a 2031 2c20       |  "A": 1, 
-0002f250: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0002f260: 2020 2242 223a 2022 4242 4242 2220 207c    "B": "BBBB"  |
-0002f270: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
-0002f280: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0002f290: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0002f2a0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0002f2b0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0002f2c0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002f2d0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
-0002f2e0: 2022 6173 5f6f 626a 6563 7422 290a 2020   "as_object").  
-0002f2f0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0002f300: 2822 6173 5f6f 626a 6563 7422 2928 6329  ("as_object")(c)
-0002f310: 0a0a 0a64 6566 2061 735f 7469 6d65 2876  ...def as_time(v
-0002f320: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-0002f330: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002f340: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-0002f350: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002f360: 2061 2074 696d 6520 7661 6c75 652e 0a0a   a time value...
-0002f370: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0002f380: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002f390: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002f3a0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-0002f3b0: 6f72 7420 6173 5f74 696d 652c 2074 6f5f  ort as_time, to_
-0002f3c0: 7661 7269 616e 740a 2020 2020 2020 2020  variant.        
-0002f3d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002f3e0: 2e73 716c 2822 7365 6c65 6374 2054 4f5f  .sql("select TO_
-0002f3f0: 5449 4d45 2827 3132 3a33 343a 3536 2729  TIME('12:34:56')
-0002f400: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
-0002f410: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
-0002f420: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
-0002f430: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
-0002f440: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002f450: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
-0002f460: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-0002f470: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-0002f480: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-0002f490: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-0002f4a0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0002f4b0: 2e73 656c 6563 7428 6173 5f74 696d 6528  .select(as_time(
-0002f4c0: 6466 2e61 6c61 726d 5f76 292e 6173 5f28  df.alarm_v).as_(
-0002f4d0: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
-0002f4e0: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
-0002f4f0: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
-0002f500: 6374 2829 0a20 2020 2020 2020 2054 7275  ct().        Tru
-0002f510: 650a 2020 2020 2222 220a 2020 2020 6320  e.    """.    c 
-0002f520: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0002f530: 2876 6172 6961 6e74 2c20 2261 735f 7469  (variant, "as_ti
-0002f540: 6d65 2229 0a20 2020 2072 6574 7572 6e20  me").    return 
-0002f550: 6275 696c 7469 6e28 2261 735f 7469 6d65  builtin("as_time
-0002f560: 2229 2863 290a 0a0a 6465 6620 6173 5f74  ")(c)...def as_t
-0002f570: 696d 6573 7461 6d70 5f6c 747a 2876 6172  imestamp_ltz(var
-0002f580: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-0002f590: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0002f5a0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
-0002f5b0: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-0002f5c0: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
-0002f5d0: 6120 6c6f 6361 6c20 7469 6d65 7a6f 6e65  a local timezone
-0002f5e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002f5f0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-0002f600: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-0002f610: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
-0002f620: 696d 706f 7274 2061 735f 7469 6d65 7374  import as_timest
-0002f630: 616d 705f 6c74 7a2c 2074 6f5f 7661 7269  amp_ltz, to_vari
-0002f640: 616e 740a 2020 2020 2020 2020 3e3e 3e20  ant.        >>> 
-0002f650: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-0002f660: 2822 7365 6c65 6374 2054 4f5f 5449 4d45  ("select TO_TIME
-0002f670: 5354 414d 505f 4c54 5a28 2732 3031 382d  STAMP_LTZ('2018-
-0002f680: 3130 2d31 3020 3132 3a33 343a 3536 2729  10-10 12:34:56')
-0002f690: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
-0002f6a0: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
-0002f6b0: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
-0002f6c0: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
-0002f6d0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002f6e0: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
-0002f6f0: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-0002f700: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-0002f710: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-0002f720: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-0002f730: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0002f740: 2e73 656c 6563 7428 6173 5f74 696d 6573  .select(as_times
-0002f750: 7461 6d70 5f6c 747a 2864 662e 616c 6172  tamp_ltz(df.alar
-0002f760: 6d5f 7629 2e61 735f 2822 616c 6172 6d22  m_v).as_("alarm"
-0002f770: 2929 2e63 6f6c 6c65 6374 2829 203d 3d20  )).collect() == 
-0002f780: 6466 2e73 656c 6563 7428 6466 2e61 6c61  df.select(df.ala
-0002f790: 726d 292e 636f 6c6c 6563 7428 290a 2020  rm).collect().  
-0002f7a0: 2020 2020 2020 5472 7565 0a20 2020 2022        True.    "
-0002f7b0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0002f7c0: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
-0002f7d0: 742c 2022 6173 5f74 696d 6573 7461 6d70  t, "as_timestamp
-0002f7e0: 5f6c 747a 2229 0a20 2020 2072 6574 7572  _ltz").    retur
-0002f7f0: 6e20 6275 696c 7469 6e28 2261 735f 7469  n builtin("as_ti
-0002f800: 6d65 7374 616d 705f 6c74 7a22 2928 6329  mestamp_ltz")(c)
-0002f810: 0a0a 0a64 6566 2061 735f 7469 6d65 7374  ...def as_timest
-0002f820: 616d 705f 6e74 7a28 7661 7269 616e 743a  amp_ntz(variant:
-0002f830: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0002f840: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002f850: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
-0002f860: 2076 616c 7565 2074 6f20 6120 5449 4d45   value to a TIME
-0002f870: 5354 414d 5020 7769 7468 206e 6f20 7469  STAMP with no ti
-0002f880: 6d65 7a6f 6e65 2e0a 0a20 2020 2045 7861  mezone...    Exa
-0002f890: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0002f8a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0002f8b0: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-0002f8c0: 7469 6f6e 7320 696d 706f 7274 2061 735f  tions import as_
-0002f8d0: 7469 6d65 7374 616d 705f 6e74 7a2c 2074  timestamp_ntz, t
-0002f8e0: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
-0002f8f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0002f900: 6f6e 2e73 716c 2822 7365 6c65 6374 2054  on.sql("select T
-0002f910: 4f5f 5449 4d45 5354 414d 505f 4e54 5a28  O_TIMESTAMP_NTZ(
-0002f920: 2732 3031 382d 3130 2d31 3020 3132 3a33  '2018-10-10 12:3
-0002f930: 343a 3536 2729 2061 7320 616c 6172 6d22  4:56') as alarm"
-0002f940: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002f950: 2e61 6c61 726d 5f76 203d 2074 6f5f 7661  .alarm_v = to_va
-0002f960: 7269 616e 7428 6466 2e61 6c61 726d 290a  riant(df.alarm).
-0002f970: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002f980: 656c 6563 7428 6466 2e61 6c61 726d 5f76  elect(df.alarm_v
-0002f990: 2e61 735f 2822 616c 6172 6d22 2929 2e63  .as_("alarm")).c
-0002f9a0: 6f6c 6c65 6374 2829 203d 3d20 6466 2e73  ollect() == df.s
-0002f9b0: 656c 6563 7428 6466 2e61 6c61 726d 292e  elect(df.alarm).
-0002f9c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002f9d0: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-0002f9e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
-0002f9f0: 5f74 696d 6573 7461 6d70 5f6e 747a 2864  _timestamp_ntz(d
-0002fa00: 662e 616c 6172 6d5f 7629 2e61 735f 2822  f.alarm_v).as_("
-0002fa10: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-0002fa20: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-0002fa30: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-0002fa40: 7428 290a 2020 2020 2020 2020 5472 7565  t().        True
-0002fa50: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002fa60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002fa70: 7661 7269 616e 742c 2022 6173 5f74 696d  variant, "as_tim
-0002fa80: 6573 7461 6d70 5f6e 747a 2229 0a20 2020  estamp_ntz").   
-0002fa90: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-0002faa0: 2261 735f 7469 6d65 7374 616d 705f 6e74  "as_timestamp_nt
-0002fab0: 7a22 2928 6329 0a0a 0a64 6566 2061 735f  z")(c)...def as_
-0002fac0: 7469 6d65 7374 616d 705f 747a 2876 6172  timestamp_tz(var
-0002fad0: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
-0002fae0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0002faf0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
-0002fb00: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-0002fb10: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
-0002fb20: 6120 7469 6d65 7a6f 6e65 2e0a 0a20 2020  a timezone...   
-0002fb30: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0002fb40: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0002fb50: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0002fb60: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-0002fb70: 2061 735f 7469 6d65 7374 616d 705f 747a   as_timestamp_tz
-0002fb80: 2c20 746f 5f76 6172 6961 6e74 0a20 2020  , to_variant.   
-0002fb90: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0002fba0: 7373 696f 6e2e 7371 6c28 2273 656c 6563  ssion.sql("selec
-0002fbb0: 7420 544f 5f54 494d 4553 5441 4d50 5f54  t TO_TIMESTAMP_T
-0002fbc0: 5a28 2732 3031 382d 3130 2d31 3020 3132  Z('2018-10-10 12
-0002fbd0: 3a33 343a 3536 202b 3030 3030 2729 2061  :34:56 +0000') a
-0002fbe0: 7320 616c 6172 6d22 290a 2020 2020 2020  s alarm").      
-0002fbf0: 2020 3e3e 3e20 6466 2e61 6c61 726d 5f76    >>> df.alarm_v
-0002fc00: 203d 2074 6f5f 7661 7269 616e 7428 6466   = to_variant(df
-0002fc10: 2e61 6c61 726d 290a 2020 2020 2020 2020  .alarm).        
-0002fc20: 3e3e 3e20 6466 2e73 656c 6563 7428 6466  >>> df.select(df
-0002fc30: 2e61 6c61 726d 5f76 2e61 735f 2822 616c  .alarm_v.as_("al
-0002fc40: 6172 6d22 2929 2e63 6f6c 6c65 6374 2829  arm")).collect()
-0002fc50: 203d 3d20 6466 2e73 656c 6563 7428 6466   == df.select(df
-0002fc60: 2e61 6c61 726d 292e 636f 6c6c 6563 7428  .alarm).collect(
-0002fc70: 290a 2020 2020 2020 2020 4661 6c73 650a  ).        False.
-0002fc80: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002fc90: 656c 6563 7428 6173 5f74 696d 6573 7461  elect(as_timesta
-0002fca0: 6d70 5f74 7a28 6466 2e61 6c61 726d 5f76  mp_tz(df.alarm_v
-0002fcb0: 292e 6173 5f28 2261 6c61 726d 2229 292e  ).as_("alarm")).
-0002fcc0: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
-0002fcd0: 7365 6c65 6374 2864 662e 616c 6172 6d29  select(df.alarm)
-0002fce0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0002fcf0: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
-0002fd00: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-0002fd10: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
-0002fd20: 2261 735f 7469 6d65 7374 616d 705f 747a  "as_timestamp_tz
-0002fd30: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0002fd40: 696c 7469 6e28 2261 735f 7469 6d65 7374  iltin("as_timest
-0002fd50: 616d 705f 747a 2229 2863 290a 0a0a 6465  amp_tz")(c)...de
-0002fd60: 6620 746f 5f62 696e 6172 7928 653a 2043  f to_binary(e: C
-0002fd70: 6f6c 756d 6e4f 724e 616d 652c 2066 6d74  olumnOrName, fmt
-0002fd80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0002fd90: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
-0002fda0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
-0002fdb0: 7473 2074 6865 2069 6e70 7574 2065 7870  ts the input exp
-0002fdc0: 7265 7373 696f 6e20 746f 2061 2062 696e  ression to a bin
-0002fdd0: 6172 7920 7661 6c75 652e 2046 6f72 204e  ary value. For N
-0002fde0: 554c 4c20 696e 7075 742c 2074 6865 206f  ULL input, the o
-0002fdf0: 7574 7075 7420 6973 204e 554c 4c2e 0a0a  utput is NULL...
-0002fe00: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0002fe10: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002fe20: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0002fe30: 6174 6166 7261 6d65 285b 2730 3027 2c20  ataframe(['00', 
-0002fe40: 2736 3727 2c20 2730 3331 3227 5d2c 2073  '67', '0312'], s
-0002fe50: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-0002fe60: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002fe70: 6374 2874 6f5f 6269 6e61 7279 2863 6f6c  ct(to_binary(col
-0002fe80: 2827 6127 2929 2e61 735f 2827 616e 7327  ('a')).as_('ans'
-0002fe90: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0002fea0: 2020 2020 205b 526f 7728 414e 533d 6279       [Row(ANS=by
-0002feb0: 7465 6172 7261 7928 6227 5c5c 7830 3027  tearray(b'\\x00'
-0002fec0: 2929 2c20 526f 7728 414e 533d 6279 7465  )), Row(ANS=byte
-0002fed0: 6172 7261 7928 6227 6727 2929 2c20 526f  array(b'g')), Ro
-0002fee0: 7728 414e 533d 6279 7465 6172 7261 7928  w(ANS=bytearray(
-0002fef0: 6227 5c5c 7830 335c 5c78 3132 2729 295d  b'\\x03\\x12'))]
-0002ff00: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0002ff10: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002ff20: 655f 6461 7461 6672 616d 6528 5b27 6147  e_dataframe(['aG
-0002ff30: 5673 6247 383d 272c 2027 6432 3979 6247  VsbG8=', 'd29ybG
-0002ff40: 513d 272c 2027 4951 3d3d 275d 2c20 7363  Q=', 'IQ=='], sc
-0002ff50: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-0002ff60: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002ff70: 7428 746f 5f62 696e 6172 7928 636f 6c28  t(to_binary(col(
-0002ff80: 2761 2729 2c20 2742 4153 4536 3427 292e  'a'), 'BASE64').
-0002ff90: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
-0002ffa0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0002ffb0: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
-0002ffc0: 2862 2768 656c 6c6f 2729 292c 2052 6f77  (b'hello')), Row
-0002ffd0: 2841 4e53 3d62 7974 6561 7272 6179 2862  (ANS=bytearray(b
-0002ffe0: 2777 6f72 6c64 2729 292c 2052 6f77 2841  'world')), Row(A
-0002fff0: 4e53 3d62 7974 6561 7272 6179 2862 2721  NS=bytearray(b'!
-00030000: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
-00030010: 3e20 6466 2e73 656c 6563 7428 746f 5f62  > df.select(to_b
-00030020: 696e 6172 7928 636f 6c28 2761 2729 2c20  inary(col('a'), 
-00030030: 2755 5446 2d38 2729 2e61 735f 2827 616e  'UTF-8').as_('an
-00030040: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
-00030050: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-00030060: 6279 7465 6172 7261 7928 6227 6147 5673  bytearray(b'aGVs
-00030070: 6247 383d 2729 292c 2052 6f77 2841 4e53  bG8=')), Row(ANS
-00030080: 3d62 7974 6561 7272 6179 2862 2764 3239  =bytearray(b'd29
-00030090: 7962 4751 3d27 2929 2c20 526f 7728 414e  ybGQ=')), Row(AN
-000300a0: 533d 6279 7465 6172 7261 7928 6227 4951  S=bytearray(b'IQ
-000300b0: 3d3d 2729 295d 0a20 2020 2022 2222 0a20  =='))].    """. 
-000300c0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-000300d0: 665f 7374 7228 652c 2022 746f 5f62 696e  f_str(e, "to_bin
-000300e0: 6172 7922 290a 2020 2020 7265 7475 726e  ary").    return
-000300f0: 2062 7569 6c74 696e 2822 746f 5f62 696e   builtin("to_bin
-00030100: 6172 7922 2928 632c 2066 6d74 2920 6966  ary")(c, fmt) if
-00030110: 2066 6d74 2065 6c73 6520 6275 696c 7469   fmt else builti
-00030120: 6e28 2274 6f5f 6269 6e61 7279 2229 2863  n("to_binary")(c
-00030130: 290a 0a0a 6465 6620 746f 5f61 7272 6179  )...def to_array
-00030140: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00030150: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00030160: 2022 2222 436f 6e76 6572 7473 2061 6e79   """Converts any
-00030170: 2076 616c 7565 2074 6f20 616e 2041 5252   value to an ARR
-00030180: 4159 2076 616c 7565 206f 7220 4e55 4c4c  AY value or NULL
-00030190: 2028 6966 2069 6e70 7574 2069 7320 4e55   (if input is NU
-000301a0: 4c4c 292e 0a0a 2020 2020 4578 616d 706c  LL)...    Exampl
-000301b0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-000301c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000301d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-000301e0: 312c 2032 2c20 332c 2034 5d2c 2073 6368  1, 2, 3, 4], sch
-000301f0: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
-00030200: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00030210: 2874 6f5f 6172 7261 7928 636f 6c28 2761  (to_array(col('a
-00030220: 2729 292e 6173 5f28 2761 6e73 2729 292e  ')).as_('ans')).
-00030230: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00030240: 2020 5b52 6f77 2841 4e53 3d27 5b5c 5c6e    [Row(ANS='[\\n
-00030250: 2020 315c 5c6e 5d27 292c 2052 6f77 2841    1\\n]'), Row(A
-00030260: 4e53 3d27 5b5c 5c6e 2020 325c 5c6e 5d27  NS='[\\n  2\\n]'
-00030270: 292c 2052 6f77 2841 4e53 3d27 5b5c 5c6e  ), Row(ANS='[\\n
-00030280: 2020 335c 5c6e 5d27 292c 2052 6f77 2841    3\\n]'), Row(A
-00030290: 4e53 3d27 5b5c 5c6e 2020 345c 5c6e 5d27  NS='[\\n  4\\n]'
-000302a0: 295d 0a0a 0a20 2020 2020 2020 203e 3e3e  )]...        >>>
-000302b0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-000302c0: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
-000302d0: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
-000302e0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-000302f0: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
-00030300: 6f77 2861 3d5b 312c 2032 2c20 335d 292c  ow(a=[1, 2, 3]),
-00030310: 2052 6f77 2861 3d4e 6f6e 6529 5d29 0a20   Row(a=None)]). 
-00030320: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00030330: 6c65 6374 2874 6f5f 6172 7261 7928 636f  lect(to_array(co
-00030340: 6c28 2761 2729 292e 6173 5f28 2761 6e73  l('a')).as_('ans
-00030350: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-00030360: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-00030370: 5b5c 5c6e 2020 312c 5c5c 6e20 2032 2c5c  [\\n  1,\\n  2,\
-00030380: 5c6e 2020 335c 5c6e 5d27 292c 2052 6f77  \n  3\\n]'), Row
-00030390: 2841 4e53 3d4e 6f6e 6529 5d0a 2020 2020  (ANS=None)].    
-000303a0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-000303b0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
-000303c0: 6f5f 6172 7261 7922 290a 2020 2020 7265  o_array").    re
-000303d0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-000303e0: 5f61 7272 6179 2229 2863 290a 0a0a 6465  _array")(c)...de
-000303f0: 6620 746f 5f6a 736f 6e28 653a 2043 6f6c  f to_json(e: Col
-00030400: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00030410: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6e  lumn:.    """Con
-00030420: 7665 7274 7320 616e 7920 5641 5249 414e  verts any VARIAN
-00030430: 5420 7661 6c75 6520 746f 2061 2073 7472  T value to a str
-00030440: 696e 6720 636f 6e74 6169 6e69 6e67 2074  ing containing t
-00030450: 6865 204a 534f 4e20 7265 7072 6573 656e  he JSON represen
-00030460: 7461 7469 6f6e 206f 6620 7468 650a 2020  tation of the.  
-00030470: 2020 7661 6c75 652e 2049 6620 7468 6520    value. If the 
-00030480: 696e 7075 7420 6973 204e 554c 4c2c 2074  input is NULL, t
-00030490: 6865 2072 6573 756c 7420 6973 2061 6c73  he result is als
-000304a0: 6f20 4e55 4c4c 2e0a 0a20 2020 2045 7861  o NULL...    Exa
-000304b0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-000304c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-000304d0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-000304e0: 2069 6d70 6f72 7420 5661 7269 616e 7454   import VariantT
-000304f0: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
-00030500: 2c20 5374 7275 6374 5479 7065 0a20 2020  , StructType.   
-00030510: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00030520: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00030530: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
-00030540: 2020 2020 3e3e 3e20 7363 6865 6d61 203d      >>> schema =
-00030550: 2053 7472 7563 7454 7970 6528 5b53 7472   StructType([Str
-00030560: 7563 7446 6965 6c64 2822 6122 2c20 5661  uctField("a", Va
-00030570: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
-00030580: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00030590: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000305a0: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
-000305b0: 4e6f 6e65 292c 526f 7728 613d 3132 292c  None),Row(a=12),
-000305c0: 526f 7728 613d 332e 3134 3129 2c52 6f77  Row(a=3.141),Row
-000305d0: 2861 3d7b 2761 273a 3130 2c27 6227 3a32  (a={'a':10,'b':2
-000305e0: 307d 292c 526f 7728 613d 5b31 2c32 332c  0}),Row(a=[1,23,
-000305f0: 3435 365d 295d 2c20 7363 6865 6d61 3d73  456])], schema=s
-00030600: 6368 656d 6129 0a20 2020 2020 2020 203e  chema).        >
-00030610: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
-00030620: 6a73 6f6e 2863 6f6c 2822 6122 2929 2e61  json(col("a")).a
-00030630: 735f 2827 616e 7327 2929 2e63 6f6c 6c65  s_('ans')).colle
-00030640: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00030650: 7728 414e 533d 4e6f 6e65 292c 2052 6f77  w(ANS=None), Row
-00030660: 2841 4e53 3d27 3132 2729 2c20 526f 7728  (ANS='12'), Row(
-00030670: 414e 533d 2733 2e31 3431 2729 2c20 526f  ANS='3.141'), Ro
-00030680: 7728 414e 533d 277b 2261 223a 3130 2c22  w(ANS='{"a":10,"
-00030690: 6222 3a32 307d 2729 2c20 526f 7728 414e  b":20}'), Row(AN
-000306a0: 533d 275b 312c 3233 2c34 3536 5d27 295d  S='[1,23,456]')]
-000306b0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-000306c0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-000306d0: 652c 2022 746f 5f6a 736f 6e22 290a 2020  e, "to_json").  
-000306e0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-000306f0: 2822 746f 5f6a 736f 6e22 2928 6329 0a0a  ("to_json")(c)..
-00030700: 0a64 6566 2074 6f5f 6f62 6a65 6374 2865  .def to_object(e
-00030710: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00030720: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00030730: 2222 436f 6e76 6572 7473 2061 6e79 2076  ""Converts any v
-00030740: 616c 7565 2074 6f20 6120 4f42 4a45 4354  alue to a OBJECT
-00030750: 2076 616c 7565 206f 7220 4e55 4c4c 2028   value or NULL (
-00030760: 6966 2069 6e70 7574 2069 7320 4e55 4c4c  if input is NULL
-00030770: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
-00030780: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-00030790: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-000307a0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-000307b0: 7274 2056 6172 6961 6e74 5479 7065 2c20  rt VariantType, 
-000307c0: 5374 7275 6374 4669 656c 642c 2053 7472  StructField, Str
-000307d0: 7563 7454 7970 650a 2020 2020 2020 2020  uctType.        
-000307e0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000307f0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
-00030800: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
-00030810: 3e3e 2073 6368 656d 6120 3d20 5374 7275  >> schema = Stru
-00030820: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
-00030830: 656c 6428 2261 222c 2056 6172 6961 6e74  eld("a", Variant
-00030840: 5479 7065 2829 295d 290a 2020 2020 2020  Type())]).      
-00030850: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00030860: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00030870: 616d 6528 5b22 7b27 6127 3a31 302c 2762  ame(["{'a':10,'b
-00030880: 273a 3230 7d22 2c20 4e6f 6e65 5d2c 2073  ':20}", None], s
-00030890: 6368 656d 613d 7363 6865 6d61 290a 2020  chema=schema).  
-000308a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000308b0: 6563 7428 746f 5f6f 626a 6563 7428 636f  ect(to_object(co
-000308c0: 6c28 2261 2229 292e 6173 5f28 2761 6e73  l("a")).as_('ans
-000308d0: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
-000308e0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000308f0: 7b5c 5c6e 2020 2261 223a 2031 302c 5c5c  {\\n  "a": 10,\\
-00030900: 6e20 2022 6222 3a20 3230 5c5c 6e7d 2729  n  "b": 20\\n}')
-00030910: 2c20 526f 7728 414e 533d 4e6f 6e65 295d  , Row(ANS=None)]
-00030920: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00030930: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00030940: 652c 2022 746f 5f6f 626a 6563 7422 290a  e, "to_object").
-00030950: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00030960: 696e 2822 746f 5f6f 626a 6563 7422 2928  in("to_object")(
-00030970: 6329 0a0a 0a64 6566 2074 6f5f 7661 7269  c)...def to_vari
-00030980: 616e 7428 653a 2043 6f6c 756d 6e4f 724e  ant(e: ColumnOrN
-00030990: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-000309a0: 2020 2020 2222 2243 6f6e 7665 7274 7320      """Converts 
-000309b0: 616e 7920 7661 6c75 6520 746f 2061 2056  any value to a V
-000309c0: 4152 4941 4e54 2076 616c 7565 206f 7220  ARIANT value or 
-000309d0: 4e55 4c4c 2028 6966 2069 6e70 7574 2069  NULL (if input i
-000309e0: 7320 4e55 4c4c 292e 0a0a 2020 2020 4578  s NULL)...    Ex
-000309f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00030a00: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00030a10: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00030a20: 6d65 285b 312c 2032 2c20 332c 2034 5d2c  me([1, 2, 3, 4],
-00030a30: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-00030a40: 2020 2020 2020 203e 3e3e 2064 665f 636f         >>> df_co
-00030a50: 6e76 203d 2064 662e 7365 6c65 6374 2874  nv = df.select(t
-00030a60: 6f5f 7661 7269 616e 7428 636f 6c28 2261  o_variant(col("a
-00030a70: 2229 292e 6173 5f28 2261 6e73 2229 290a  ")).as_("ans")).
-00030a80: 2020 2020 2020 2020 3e3e 3e20 6466 5f63          >>> df_c
-00030a90: 6f6e 762e 636f 6c6c 6563 7428 290a 2020  onv.collect().  
-00030aa0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-00030ab0: 3127 292c 2052 6f77 2841 4e53 3d27 3227  1'), Row(ANS='2'
-00030ac0: 292c 2052 6f77 2841 4e53 3d27 3327 292c  ), Row(ANS='3'),
-00030ad0: 2052 6f77 2841 4e53 3d27 3427 295d 0a0a   Row(ANS='4')]..
-00030ae0: 2020 2020 2020 2020 4166 7465 7220 636f          After co
-00030af0: 6e76 6572 7369 6f6e 2076 6961 2074 6f5f  nversion via to_
-00030b00: 7661 7269 616e 742c 2061 6e6f 7468 6572  variant, another
-00030b10: 2076 6172 6961 6e74 2064 6174 6166 7261   variant datafra
-00030b20: 6d65 2063 616e 2062 6520 6d65 7267 6564  me can be merged
-00030b30: 2e0a 0a20 2020 2020 2020 203e 3e3e 2066  ...        >>> f
-00030b40: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00030b50: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-00030b60: 6f72 7420 5661 7269 616e 7454 7970 652c  ort VariantType,
-00030b70: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
-00030b80: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
-00030b90: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00030ba0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
-00030bb0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
-00030bc0: 3e3e 3e20 7363 6865 6d61 203d 2053 7472  >>> schema = Str
-00030bd0: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
-00030be0: 6965 6c64 2822 6122 2c20 5661 7269 616e  ield("a", Varian
-00030bf0: 7454 7970 6528 2929 5d29 0a20 2020 2020  tType())]).     
-00030c00: 2020 203e 3e3e 2064 665f 6f74 6865 7220     >>> df_other 
-00030c10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00030c20: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
-00030c30: 613d 3130 292c 2052 6f77 2861 3d27 7465  a=10), Row(a='te
-00030c40: 7374 2729 2c20 526f 7728 613d 7b27 6127  st'), Row(a={'a'
-00030c50: 3a20 3130 2c20 2762 273a 2032 307d 292c  : 10, 'b': 20}),
-00030c60: 2052 6f77 2861 3d5b 312c 2032 2c20 335d   Row(a=[1, 2, 3]
-00030c70: 295d 2c20 7363 6865 6d61 3d73 6368 656d  )], schema=schem
-00030c80: 6129 0a20 2020 2020 2020 203e 3e3e 2064  a).        >>> d
-00030c90: 665f 636f 6e76 2e75 6e69 6f6e 2864 665f  f_conv.union(df_
-00030ca0: 6f74 6865 7229 2e73 656c 6563 7428 7479  other).select(ty
-00030cb0: 7065 6f66 2863 6f6c 2822 616e 7322 2929  peof(col("ans"))
-00030cc0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-00030cd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00030ce0: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
-00030cf0: 2729 2c20 526f 7728 414e 533d 2749 4e54  '), Row(ANS='INT
-00030d00: 4547 4552 2729 2c20 526f 7728 414e 533d  EGER'), Row(ANS=
-00030d10: 2749 4e54 4547 4552 2729 2c20 526f 7728  'INTEGER'), Row(
-00030d20: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
-00030d30: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
-00030d40: 2729 2c20 526f 7728 414e 533d 2756 4152  '), Row(ANS='VAR
-00030d50: 4348 4152 2729 2c20 526f 7728 414e 533d  CHAR'), Row(ANS=
-00030d60: 274f 424a 4543 5427 292c 2052 6f77 2841  'OBJECT'), Row(A
-00030d70: 4e53 3d27 4152 5241 5927 295d 0a20 2020  NS='ARRAY')].   
-00030d80: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00030d90: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00030da0: 746f 5f76 6172 6961 6e74 2229 0a20 2020  to_variant").   
-00030db0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00030dc0: 2274 6f5f 7661 7269 616e 7422 2928 6329  "to_variant")(c)
-00030dd0: 0a0a 0a64 6566 2074 6f5f 786d 6c28 653a  ...def to_xml(e:
-00030de0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00030df0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00030e00: 2243 6f6e 7665 7274 7320 616e 7920 5641  "Converts any VA
-00030e10: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
-00030e20: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-00030e30: 6e67 2074 6865 2058 4d4c 2072 6570 7265  ng the XML repre
-00030e40: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
-00030e50: 0a20 2020 2076 616c 7565 2e20 4966 2074  .    value. If t
-00030e60: 6865 2069 6e70 7574 2069 7320 4e55 4c4c  he input is NULL
-00030e70: 2c20 7468 6520 7265 7375 6c74 2069 7320  , the result is 
-00030e80: 616c 736f 204e 554c 4c2e 0a0a 2020 2020  also NULL...    
-00030e90: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-00030ea0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00030eb0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-00030ec0: 7065 7320 696d 706f 7274 2056 6172 6961  pes import Varia
-00030ed0: 6e74 5479 7065 2c20 5374 7275 6374 4669  ntType, StructFi
-00030ee0: 656c 642c 2053 7472 7563 7454 7970 650a  eld, StructType.
-00030ef0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00030f00: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00030f10: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
-00030f20: 2020 2020 2020 203e 3e3e 2073 6368 656d         >>> schem
-00030f30: 6120 3d20 5374 7275 6374 5479 7065 285b  a = StructType([
-00030f40: 5374 7275 6374 4669 656c 6428 2261 222c  StructField("a",
-00030f50: 2056 6172 6961 6e74 5479 7065 2829 295d   VariantType())]
-00030f60: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00030f70: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00030f80: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
-00030f90: 2861 3d31 3029 2c20 526f 7728 613d 2774  (a=10), Row(a='t
-00030fa0: 6573 7427 292c 2052 6f77 2861 3d7b 2761  est'), Row(a={'a
-00030fb0: 273a 2031 302c 2027 6227 3a20 3230 7d29  ': 10, 'b': 20})
-00030fc0: 2c20 526f 7728 613d 5b31 2c20 322c 2033  , Row(a=[1, 2, 3
-00030fd0: 5d29 5d2c 2073 6368 656d 613d 7363 6865  ])], schema=sche
-00030fe0: 6d61 290a 2020 2020 2020 2020 3e3e 3e20  ma).        >>> 
-00030ff0: 6466 2e73 656c 6563 7428 746f 5f78 6d6c  df.select(to_xml
-00031000: 2863 6f6c 2822 4122 2929 2e61 735f 2822  (col("A")).as_("
-00031010: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
-00031020: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-00031030: 533d 273c 536e 6f77 666c 616b 6544 6174  S='<SnowflakeDat
-00031040: 6120 7479 7065 3d22 494e 5445 4745 5222  a type="INTEGER"
-00031050: 3e31 303c 2f53 6e6f 7766 6c61 6b65 4461  >10</SnowflakeDa
-00031060: 7461 3e27 292c 2052 6f77 2841 4e53 3d27  ta>'), Row(ANS='
-00031070: 3c53 6e6f 7766 6c61 6b65 4461 7461 2074  <SnowflakeData t
-00031080: 7970 653d 2256 4152 4348 4152 223e 7465  ype="VARCHAR">te
-00031090: 7374 3c2f 536e 6f77 666c 616b 6544 6174  st</SnowflakeDat
-000310a0: 613e 2729 2c20 526f 7728 414e 533d 273c  a>'), Row(ANS='<
-000310b0: 536e 6f77 666c 616b 6544 6174 6120 7479  SnowflakeData ty
-000310c0: 7065 3d22 4f42 4a45 4354 223e 3c61 2074  pe="OBJECT"><a t
-000310d0: 7970 653d 2249 4e54 4547 4552 223e 3130  ype="INTEGER">10
-000310e0: 3c2f 613e 3c62 2074 7970 653d 2249 4e54  </a><b type="INT
-000310f0: 4547 4552 223e 3230 3c2f 623e 3c2f 536e  EGER">20</b></Sn
-00031100: 6f77 666c 616b 6544 6174 613e 2729 2c20  owflakeData>'), 
-00031110: 526f 7728 414e 533d 273c 536e 6f77 666c  Row(ANS='<Snowfl
-00031120: 616b 6544 6174 6120 7479 7065 3d22 4152  akeData type="AR
-00031130: 5241 5922 3e3c 6520 7479 7065 3d22 494e  RAY"><e type="IN
-00031140: 5445 4745 5222 3e31 3c2f 653e 3c65 2074  TEGER">1</e><e t
-00031150: 7970 653d 2249 4e54 4547 4552 223e 323c  ype="INTEGER">2<
-00031160: 2f65 3e3c 6520 7479 7065 3d22 494e 5445  /e><e type="INTE
-00031170: 4745 5222 3e33 3c2f 653e 3c2f 536e 6f77  GER">3</e></Snow
-00031180: 666c 616b 6544 6174 613e 2729 5d0a 2020  flakeData>')].  
-00031190: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-000311a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-000311b0: 2274 6f5f 786d 6c22 290a 2020 2020 7265  "to_xml").    re
-000311c0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-000311d0: 5f78 6d6c 2229 2863 290a 0a0a 6465 6620  _xml")(c)...def 
-000311e0: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
-000311f0: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
-00031200: 652c 2066 6965 6c64 3a20 436f 6c75 6d6e  e, field: Column
-00031210: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00031220: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
-00031230: 7874 7261 6374 7320 6120 6669 656c 6420  xtracts a field 
-00031240: 7661 6c75 6520 6672 6f6d 2061 6e20 6f62  value from an ob
-00031250: 6a65 6374 2e20 5265 7475 726e 7320 4e55  ject. Returns NU
-00031260: 4c4c 2069 6620 6569 7468 6572 206f 6620  LL if either of 
-00031270: 7468 6520 6172 6775 6d65 6e74 7320 6973  the arguments is
-00031280: 204e 554c 4c2e 0a20 2020 2054 6869 7320   NULL..    This 
-00031290: 6675 6e63 7469 6f6e 2069 7320 7369 6d69  function is simi
-000312a0: 6c61 7220 746f 203a 6d65 7468 3a60 6765  lar to :meth:`ge
-000312b0: 7460 2062 7574 2061 7070 6c69 6573 2063  t` but applies c
-000312c0: 6173 652d 696e 7365 6e73 6974 6976 6520  ase-insensitive 
-000312d0: 6d61 7463 6869 6e67 2074 6f20 6669 656c  matching to fiel
-000312e0: 6420 6e61 6d65 732e 0a0a 2020 2020 4578  d names...    Ex
-000312f0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
-00031300: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00031310: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00031320: 616d 6528 5b7b 2261 223a 207b 2261 6122  ame([{"a": {"aa"
-00031330: 3a20 312c 2022 6262 223a 2032 2c20 2263  : 1, "bb": 2, "c
-00031340: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
-00031350: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00031360: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
-00031370: 6466 5b22 6122 5d2c 206c 6974 2822 4141  df["a"], lit("AA
-00031380: 2229 292e 616c 6961 7328 2267 6574 5f69  ")).alias("get_i
-00031390: 676e 6f72 655f 6361 7365 2229 292e 636f  gnore_case")).co
-000313a0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000313b0: 5b52 6f77 2847 4554 5f49 474e 4f52 455f  [Row(GET_IGNORE_
-000313c0: 4341 5345 3d27 3127 295d 0a20 2020 2022  CASE='1')].    "
-000313d0: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
-000313e0: 636f 6c5f 6966 5f73 7472 286f 626a 2c20  col_if_str(obj, 
-000313f0: 2267 6574 5f69 676e 6f72 655f 6361 7365  "get_ignore_case
-00031400: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
-00031410: 636f 6c5f 6966 5f73 7472 2866 6965 6c64  col_if_str(field
-00031420: 2c20 2267 6574 5f69 676e 6f72 655f 6361  , "get_ignore_ca
-00031430: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
-00031440: 6275 696c 7469 6e28 2267 6574 5f69 676e  builtin("get_ign
-00031450: 6f72 655f 6361 7365 2229 2863 312c 2063  ore_case")(c1, c
-00031460: 3229 0a0a 0a64 6566 206f 626a 6563 745f  2)...def object_
-00031470: 6b65 7973 286f 626a 3a20 436f 6c75 6d6e  keys(obj: Column
-00031480: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00031490: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-000314a0: 7320 616e 2061 7272 6179 2063 6f6e 7461  s an array conta
-000314b0: 696e 696e 6720 7468 6520 6c69 7374 206f  ining the list o
-000314c0: 6620 6b65 7973 2069 6e20 7468 6520 696e  f keys in the in
-000314d0: 7075 7420 6f62 6a65 6374 2e0a 0a0a 2020  put object....  
-000314e0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-000314f0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00031500: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00031510: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00031520: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
-00031530: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
-00031540: 6c28 0a20 2020 2020 2020 202e 2e2e 2020  l(.        ...  
-00031550: 2020 2022 7365 6c65 6374 206f 626a 6563     "select objec
-00031560: 745f 636f 6e73 7472 7563 7428 612c 622c  t_construct(a,b,
-00031570: 632c 642c 652c 6629 2061 7320 6f62 6a2c  c,d,e,f) as obj,
-00031580: 206b 2c20 7620 6672 6f6d 2022 0a20 2020   k, v from ".   
-00031590: 2020 2020 202e 2e2e 2020 2020 2022 7661       ...     "va
-000315a0: 6c75 6573 2827 6167 6527 2c20 3231 2c20  lues('age', 21, 
-000315b0: 277a 6970 272c 2032 3130 3231 2c20 276e  'zip', 21021, 'n
-000315c0: 616d 6527 2c20 274a 6f65 272c 2027 6167  ame', 'Joe', 'ag
-000315d0: 6527 2c20 3029 2c22 0a20 2020 2020 2020  e', 0),".       
-000315e0: 202e 2e2e 2020 2020 2022 2827 6167 6527   ...     "('age'
-000315f0: 2c20 3236 2c20 277a 6970 272c 2039 3430  , 26, 'zip', 940
-00031600: 3231 2c20 276e 616d 6527 2c20 274a 6179  21, 'name', 'Jay
-00031610: 272c 2027 6167 6527 2c20 3029 2061 7320  ', 'age', 0) as 
-00031620: 5428 612c 622c 632c 642c 652c 662c 6b2c  T(a,b,c,d,e,f,k,
-00031630: 7629 220a 2020 2020 2020 2020 2e2e 2e20  v)".        ... 
-00031640: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00031650: 2e73 656c 6563 7428 6f62 6a65 6374 5f6b  .select(object_k
-00031660: 6579 7328 636f 6c28 226f 626a 2229 292e  eys(col("obj")).
-00031670: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00031680: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00031690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000316a0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-000316b0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000316c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000316d0: 2020 7c5b 2020 2020 2020 2020 2020 7c0a    |[          |.
-000316e0: 2020 2020 2020 2020 7c20 2022 6167 6522          |  "age"
-000316f0: 2c20 2020 7c0a 2020 2020 2020 2020 7c20  ,   |.        | 
-00031700: 2022 6e61 6d65 222c 2020 7c0a 2020 2020   "name",  |.    
-00031710: 2020 2020 7c20 2022 7a69 7022 2020 2020      |  "zip"    
-00031720: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00031730: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00031740: 7c5b 2020 2020 2020 2020 2020 7c0a 2020  |[          |.  
-00031750: 2020 2020 2020 7c20 2022 6167 6522 2c20        |  "age", 
-00031760: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
-00031770: 6e61 6d65 222c 2020 7c0a 2020 2020 2020  name",  |.      
-00031780: 2020 7c20 2022 7a69 7022 2020 2020 7c0a    |  "zip"    |.
-00031790: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
-000317a0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-000317b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000317c0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-000317d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-000317e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
-000317f0: 626a 2c20 226f 626a 6563 745f 6b65 7973  bj, "object_keys
-00031800: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00031810: 696c 7469 6e28 226f 626a 6563 745f 6b65  iltin("object_ke
-00031820: 7973 2229 2863 290a 0a0a 6465 6620 786d  ys")(c)...def xm
-00031830: 6c67 6574 280a 2020 2020 786d 6c3a 2043  lget(.    xml: C
-00031840: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
-00031850: 2074 6167 3a20 436f 6c75 6d6e 4f72 4e61   tag: ColumnOrNa
-00031860: 6d65 2c0a 2020 2020 696e 7374 616e 6365  me,.    instance
-00031870: 5f6e 756d 3a20 556e 696f 6e5b 436f 6c75  _num: Union[Colu
-00031880: 6d6e 4f72 4e61 6d65 2c20 696e 745d 203d  mnOrName, int] =
-00031890: 2030 2c0a 2920 2d3e 2043 6f6c 756d 6e3a   0,.) -> Column:
-000318a0: 0a20 2020 2022 2222 4578 7472 6163 7473  .    """Extracts
-000318b0: 2061 6e20 584d 4c20 656c 656d 656e 7420   an XML element 
-000318c0: 6f62 6a65 6374 2028 6f66 7465 6e20 7265  object (often re
-000318d0: 6665 7272 6564 2074 6f20 6173 2073 696d  ferred to as sim
-000318e0: 706c 7920 6120 7461 6729 2066 726f 6d20  ply a tag) from 
-000318f0: 6120 636f 6e74 656e 7420 6f66 206f 7574  a content of out
-00031900: 6572 0a20 2020 2058 4d4c 2065 6c65 6d65  er.    XML eleme
-00031910: 6e74 206f 626a 6563 7420 6279 2074 6865  nt object by the
-00031920: 206e 616d 6520 6f66 2074 6865 2074 6167   name of the tag
-00031930: 2061 6e64 2069 7473 2069 6e73 7461 6e63   and its instanc
-00031940: 6520 6e75 6d62 6572 2028 636f 756e 7469  e number (counti
-00031950: 6e67 2066 726f 6d20 3029 2e0a 0a20 2020  ng from 0)...   
-00031960: 2054 6865 2066 6f6c 6c6f 7769 6e67 2065   The following e
-00031970: 7861 6d70 6c65 2072 6574 7572 6e73 2074  xample returns t
-00031980: 6865 2066 6972 7374 2069 6e6e 6572 206c  he first inner l
-00031990: 6576 656c 2028 6c65 7665 6c32 2920 6672  evel (level2) fr
-000319a0: 6f6d 2074 6865 2058 4d4c 206f 626a 6563  om the XML objec
-000319b0: 7420 6372 6561 7465 6420 7669 6120 6070  t created via `p
-000319c0: 6172 7365 5f78 6d6c 602e 0a0a 2020 2020  arse_xml`...    
-000319d0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000319e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000319f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00031a00: 7261 6d65 285b 273c 6c65 7665 6c31 2061  rame(['<level1 a
-00031a10: 7474 7231 3d22 6122 3e31 3c6c 6576 656c  ttr1="a">1<level
-00031a20: 3220 6174 7472 323d 2262 223e 323c 6c65  2 attr2="b">2<le
-00031a30: 7665 6c33 3e33 613c 2f6c 6576 656c 333e  vel3>3a</level3>
-00031a40: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
-00031a50: 6c33 3e3c 2f6c 6576 656c 323e 3c2f 6c65  l3></level2></le
-00031a60: 7665 6c31 3e27 5d2c 2073 6368 656d 613d  vel1>'], schema=
-00031a70: 5b22 7374 7222 5d29 2e73 656c 6563 7428  ["str"]).select(
-00031a80: 7061 7273 655f 786d 6c28 2273 7472 2229  parse_xml("str")
-00031a90: 2e61 735f 2822 6f62 6a22 2929 0a20 2020  .as_("obj")).   
-00031aa0: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
-00031ab0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00031ac0: 6f77 284f 424a 3d27 3c6c 6576 656c 3120  ow(OBJ='<level1 
-00031ad0: 6174 7472 313d 2261 223e 5c5c 6e20 2031  attr1="a">\\n  1
-00031ae0: 5c5c 6e20 203c 6c65 7665 6c32 2061 7474  \\n  <level2 att
-00031af0: 7232 3d22 6222 3e5c 5c6e 2020 2020 325c  r2="b">\\n    2\
-00031b00: 5c6e 2020 2020 3c6c 6576 656c 333e 3361  \n    <level3>3a
-00031b10: 3c2f 6c65 7665 6c33 3e5c 5c6e 2020 2020  </level3>\\n    
-00031b20: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
-00031b30: 6c33 3e5c 5c6e 2020 3c2f 6c65 7665 6c32  l3>\\n  </level2
-00031b40: 3e5c 5c6e 3c2f 6c65 7665 6c31 3e27 295d  >\\n</level1>')]
-00031b50: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00031b60: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
-00031b70: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
-00031b80: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-00031b90: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00031ba0: 2020 5b52 6f77 2841 4e53 3d27 3c6c 6576    [Row(ANS='<lev
-00031bb0: 656c 3220 6174 7472 323d 2262 223e 5c5c  el2 attr2="b">\\
-00031bc0: 6e20 2032 5c5c 6e20 203c 6c65 7665 6c33  n  2\\n  <level3
-00031bd0: 3e33 613c 2f6c 6576 656c 333e 5c5c 6e20  >3a</level3>\\n 
-00031be0: 203c 6c65 7665 6c33 3e33 623c 2f6c 6576   <level3>3b</lev
-00031bf0: 656c 333e 5c5c 6e3c 2f6c 6576 656c 323e  el3>\\n</level2>
-00031c00: 2729 5d0a 0a20 2020 2057 6865 6e20 6d75  ')]..    When mu
-00031c10: 6c74 6970 6c65 2074 6167 7320 6578 6973  ltiple tags exis
-00031c20: 7420 6174 2061 206c 6576 656c 2c20 696e  t at a level, in
-00031c30: 7374 616e 6365 5f6e 756d 2063 616e 2062  stance_num can b
-00031c40: 6520 7573 6564 2074 6f20 6469 7374 696e  e used to distin
-00031c50: 6775 6973 6820 7768 6963 6820 656c 656d  guish which elem
-00031c60: 656e 7420 746f 2072 6574 7572 6e2e 0a0a  ent to return...
-00031c70: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00022530: 665f 7374 7228 636f 6c2c 2022 6973 5f62  f_str(col, "is_b
+00022540: 6f6f 6c65 616e 2229 0a20 2020 2072 6574  oolean").    ret
+00022550: 7572 6e20 6275 696c 7469 6e28 2269 735f  urn builtin("is_
+00022560: 626f 6f6c 6561 6e22 2928 6329 0a0a 0a64  boolean")(c)...d
+00022570: 6566 2069 735f 6269 6e61 7279 2863 6f6c  ef is_binary(col
+00022580: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00022590: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000225a0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000225b0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+000225c0: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
+000225d0: 756d 6e20 636f 6e74 6169 6e73 2061 2062  umn contains a b
+000225e0: 696e 6172 7920 7661 6c75 652e 0a0a 2020  inary value...  
+000225f0: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
+00022600: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00022610: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00022620: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
+00022630: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
+00022640: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
+00022650: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00022660: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00022670: 6528 5b5b 6222 736e 6f77 222c 2022 736e  e([[b"snow", "sn
+00022680: 6f77 225d 5d2c 2073 6368 656d 613d 5b22  ow"]], schema=["
+00022690: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+000226a0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000226b0: 6973 5f62 696e 6172 7928 746f 5f76 6172  is_binary(to_var
+000226c0: 6961 6e74 2864 665b 2261 225d 2929 2e61  iant(df["a"])).a
+000226d0: 6c69 6173 2822 6269 6e61 7279 2229 2c20  lias("binary"), 
+000226e0: 6973 5f62 696e 6172 7928 746f 5f76 6172  is_binary(to_var
+000226f0: 6961 6e74 2864 665b 2262 225d 2929 2e61  iant(df["b"])).a
+00022700: 6c69 6173 2822 7661 7263 6861 7222 2929  lias("varchar"))
+00022710: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00022720: 2020 205b 526f 7728 4249 4e41 5259 3d54     [Row(BINARY=T
+00022730: 7275 652c 2056 4152 4348 4152 3d46 616c  rue, VARCHAR=Fal
+00022740: 7365 295d 0a20 2020 2022 2222 0a20 2020  se)].    """.   
+00022750: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00022760: 7374 7228 636f 6c2c 2022 6973 5f62 696e  str(col, "is_bin
+00022770: 6172 7922 290a 2020 2020 7265 7475 726e  ary").    return
+00022780: 2062 7569 6c74 696e 2822 6973 5f62 696e   builtin("is_bin
+00022790: 6172 7922 2928 6329 0a0a 0a64 6566 2069  ary")(c)...def i
+000227a0: 735f 6368 6172 2863 6f6c 3a20 436f 6c75  s_char(col: Colu
+000227b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+000227c0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+000227d0: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
+000227e0: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
+000227f0: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
+00022800: 6e74 6169 6e73 2061 2073 7472 696e 672e  ntains a string.
+00022810: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
+00022820: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00022830: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00022840: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00022850: 7274 2053 7472 7563 7446 6965 6c64 2c20  rt StructField, 
+00022860: 5661 7269 616e 7454 7970 650a 2020 2020  VariantType.    
+00022870: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00022880: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00022890: 6672 616d 6528 5b5b 2261 6263 222c 2031  frame([["abc", 1
+000228a0: 3233 5d5d 2c20 7363 6865 6d61 3d5b 2261  23]], schema=["a
+000228b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+000228c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
+000228d0: 735f 6368 6172 2874 6f5f 7661 7269 616e  s_char(to_varian
+000228e0: 7428 6466 5b22 6122 5d29 292e 616c 6961  t(df["a"])).alia
+000228f0: 7328 2276 6172 6368 6172 2229 2c20 6973  s("varchar"), is
+00022900: 5f63 6861 7228 746f 5f76 6172 6961 6e74  _char(to_variant
+00022910: 2864 665b 2262 225d 2929 2e61 6c69 6173  (df["b"])).alias
+00022920: 2822 696e 7422 2929 2e63 6f6c 6c65 6374  ("int")).collect
+00022930: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00022940: 5641 5243 4841 523d 5472 7565 2c20 494e  VARCHAR=True, IN
+00022950: 543d 4661 6c73 6529 5d0a 2020 2020 2222  T=False)].    ""
+00022960: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00022970: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2269  l_if_str(col, "i
+00022980: 735f 6368 6172 2229 0a20 2020 2072 6574  s_char").    ret
+00022990: 7572 6e20 6275 696c 7469 6e28 2269 735f  urn builtin("is_
+000229a0: 6368 6172 2229 2863 290a 0a0a 6973 5f76  char")(c)...is_v
+000229b0: 6172 6368 6172 203d 2069 735f 6368 6172  archar = is_char
+000229c0: 0a0a 0a64 6566 2069 735f 6461 7465 2863  ...def is_date(c
+000229d0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+000229e0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000229f0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00022a00: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
+00022a10: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
+00022a20: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
+00022a30: 2064 6174 6520 7661 6c75 652e 0a0a 2020   date value...  
+00022a40: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
+00022a50: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00022a60: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
+00022a70: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00022a80: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
+00022a90: 7065 7320 696d 706f 7274 2053 7472 7563  pes import Struc
+00022aa0: 7446 6965 6c64 2c20 5661 7269 616e 7454  tField, VariantT
+00022ab0: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
+00022ac0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00022ad0: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+00022ae0: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
+00022af0: 3233 2c20 332c 2032 292c 2031 3233 5d5d  23, 3, 2), 123]]
+00022b00: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+00022b10: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
+00022b20: 2064 662e 7365 6c65 6374 2869 735f 6461   df.select(is_da
+00022b30: 7465 2874 6f5f 7661 7269 616e 7428 6466  te(to_variant(df
+00022b40: 5b22 6122 5d29 292e 616c 6961 7328 2264  ["a"])).alias("d
+00022b50: 6174 6522 292c 2069 735f 6461 7465 2874  ate"), is_date(t
+00022b60: 6f5f 7661 7269 616e 7428 6466 5b22 6222  o_variant(df["b"
+00022b70: 5d29 292e 616c 6961 7328 2269 6e74 2229  ])).alias("int")
+00022b80: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00022b90: 2020 2020 5b52 6f77 2844 4154 453d 5472      [Row(DATE=Tr
+00022ba0: 7565 2c20 494e 543d 4661 6c73 6529 5d0a  ue, INT=False)].
+00022bb0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00022bc0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00022bd0: 6f6c 2c20 2269 735f 6461 7465 2229 0a20  ol, "is_date"). 
+00022be0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00022bf0: 6e28 2269 735f 6461 7465 2229 2863 290a  n("is_date")(c).
+00022c00: 0a0a 6973 5f64 6174 655f 7661 6c75 6520  ..is_date_value 
+00022c10: 3d20 6973 5f64 6174 650a 0a0a 6465 6620  = is_date...def 
+00022c20: 6973 5f64 6563 696d 616c 2863 6f6c 3a20  is_decimal(col: 
+00022c30: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00022c40: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00022c50: 0a20 2020 2052 6574 7572 6e73 2074 7275  .    Returns tru
+00022c60: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
+00022c70: 6564 2056 4152 4941 4e54 2063 6f6c 756d  ed VARIANT colum
+00022c80: 6e20 636f 6e74 6169 6e73 2061 2066 6978  n contains a fix
+00022c90: 6564 2d70 6f69 6e74 2064 6563 696d 616c  ed-point decimal
+00022ca0: 2076 616c 7565 206f 7220 696e 7465 6765   value or intege
+00022cb0: 722e 0a0a 2020 2020 4578 616d 706c 6573  r...    Examples
+00022cc0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00022cd0: 696d 706f 7274 2064 6563 696d 616c 0a20  import decimal. 
+00022ce0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00022cf0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00022d00: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+00022d10: 5374 7275 6374 4669 656c 642c 2056 6172  StructField, Var
+00022d20: 6961 6e74 5479 7065 0a20 2020 2020 2020  iantType.       
+00022d30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00022d40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00022d50: 6d65 285b 5b64 6563 696d 616c 2e44 6563  me([[decimal.Dec
+00022d60: 696d 616c 2831 292c 2022 5822 5d5d 2c20  imal(1), "X"]], 
+00022d70: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
+00022d80: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00022d90: 662e 7365 6c65 6374 2869 735f 6465 6369  f.select(is_deci
+00022da0: 6d61 6c28 746f 5f76 6172 6961 6e74 2864  mal(to_variant(d
+00022db0: 665b 2261 225d 2929 2e61 6c69 6173 2822  f["a"])).alias("
+00022dc0: 6465 6369 6d61 6c22 292c 2069 735f 6465  decimal"), is_de
+00022dd0: 6369 6d61 6c28 746f 5f76 6172 6961 6e74  cimal(to_variant
+00022de0: 2864 665b 2262 225d 2929 2e61 6c69 6173  (df["b"])).alias
+00022df0: 2822 7661 7263 6861 7222 2929 2e63 6f6c  ("varchar")).col
+00022e00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00022e10: 526f 7728 4445 4349 4d41 4c3d 5472 7565  Row(DECIMAL=True
+00022e20: 2c20 5641 5243 4841 523d 4661 6c73 6529  , VARCHAR=False)
+00022e30: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00022e40: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00022e50: 2863 6f6c 2c20 2269 735f 6465 6369 6d61  (col, "is_decima
+00022e60: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
+00022e70: 7569 6c74 696e 2822 6973 5f64 6563 696d  uiltin("is_decim
+00022e80: 616c 2229 2863 290a 0a0a 6465 6620 6973  al")(c)...def is
+00022e90: 5f64 6f75 626c 6528 636f 6c3a 2043 6f6c  _double(col: Col
+00022ea0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00022eb0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00022ec0: 2020 5265 7475 726e 7320 7472 7565 2069    Returns true i
+00022ed0: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
+00022ee0: 5641 5249 414e 5420 636f 6c75 6d6e 2063  VARIANT column c
+00022ef0: 6f6e 7461 696e 7320 6120 666c 6f61 7469  ontains a floati
+00022f00: 6e67 2d70 6f69 6e74 2076 616c 7565 2c20  ng-point value, 
+00022f10: 6669 7865 642d 706f 696e 7420 6465 6369  fixed-point deci
+00022f20: 6d61 6c2c 206f 7220 696e 7465 6765 722e  mal, or integer.
+00022f30: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
+00022f40: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00022f50: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00022f60: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00022f70: 7274 2053 7472 7563 7446 6965 6c64 2c20  rt StructField, 
+00022f80: 5661 7269 616e 7454 7970 650a 2020 2020  VariantType.    
+00022f90: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00022fa0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00022fb0: 6672 616d 6528 5b5b 312e 322c 2022 5822  frame([[1.2, "X"
+00022fc0: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
+00022fd0: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
+00022fe0: 3e3e 2064 662e 7365 6c65 6374 2869 735f  >> df.select(is_
+00022ff0: 646f 7562 6c65 2874 6f5f 7661 7269 616e  double(to_varian
+00023000: 7428 6466 5b22 6122 5d29 292e 616c 6961  t(df["a"])).alia
+00023010: 7328 2264 6f75 626c 6522 292c 2069 735f  s("double"), is_
+00023020: 646f 7562 6c65 2874 6f5f 7661 7269 616e  double(to_varian
+00023030: 7428 6466 5b22 6222 5d29 292e 616c 6961  t(df["b"])).alia
+00023040: 7328 2276 6172 6368 6172 2229 292e 636f  s("varchar")).co
+00023050: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00023060: 5b52 6f77 2844 4f55 424c 453d 5472 7565  [Row(DOUBLE=True
+00023070: 2c20 5641 5243 4841 523d 4661 6c73 6529  , VARCHAR=False)
+00023080: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00023090: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000230a0: 2863 6f6c 2c20 2269 735f 646f 7562 6c65  (col, "is_double
+000230b0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+000230c0: 696c 7469 6e28 2269 735f 646f 7562 6c65  iltin("is_double
+000230d0: 2229 2863 290a 0a0a 6465 6620 6973 5f72  ")(c)...def is_r
+000230e0: 6561 6c28 636f 6c3a 2043 6f6c 756d 6e4f  eal(col: ColumnO
+000230f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00023100: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00023110: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
+00023120: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
+00023130: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
+00023140: 696e 7320 6120 666c 6f61 7469 6e67 2d70  ins a floating-p
+00023150: 6f69 6e74 2076 616c 7565 2c20 6669 7865  oint value, fixe
+00023160: 642d 706f 696e 7420 6465 6369 6d61 6c2c  d-point decimal,
+00023170: 206f 7220 696e 7465 6765 722e 0a0a 2020   or integer...  
+00023180: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00023190: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+000231a0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+000231b0: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+000231c0: 7420 746f 5f76 6172 6961 6e74 2c20 6973  t to_variant, is
+000231d0: 5f72 6561 6c0a 2020 2020 2020 2020 3e3e  _real.        >>
+000231e0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000231f0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00023200: 5b5b 312e 322c 2022 5822 5d5d 2c20 7363  [[1.2, "X"]], sc
+00023210: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
+00023220: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00023230: 7365 6c65 6374 2869 735f 7265 616c 2874  select(is_real(t
+00023240: 6f5f 7661 7269 616e 7428 2261 2229 292e  o_variant("a")).
+00023250: 6173 5f28 2261 2229 2c20 6973 5f72 6561  as_("a"), is_rea
+00023260: 6c28 746f 5f76 6172 6961 6e74 2822 6222  l(to_variant("b"
+00023270: 2929 2e61 735f 2822 6222 2929 2e63 6f6c  )).as_("b")).col
+00023280: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00023290: 526f 7728 413d 5472 7565 2c20 423d 4661  Row(A=True, B=Fa
+000232a0: 6c73 6529 5d0a 2020 2020 2222 220a 2020  lse)].    """.  
+000232b0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+000232c0: 5f73 7472 2863 6f6c 2c20 2269 735f 7265  _str(col, "is_re
+000232d0: 616c 2229 0a20 2020 2072 6574 7572 6e20  al").    return 
+000232e0: 6275 696c 7469 6e28 2269 735f 7265 616c  builtin("is_real
+000232f0: 2229 2863 290a 0a0a 6465 6620 6973 5f69  ")(c)...def is_i
+00023300: 6e74 6567 6572 2863 6f6c 3a20 436f 6c75  nteger(col: Colu
+00023310: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00023320: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00023330: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
+00023340: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
+00023350: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
+00023360: 6e74 6169 6e73 2061 2069 6e74 6567 6572  ntains a integer
+00023370: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
+00023380: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
+00023390: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+000233a0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+000233b0: 6573 2069 6d70 6f72 7420 5374 7275 6374  es import Struct
+000233c0: 4669 656c 642c 2056 6172 6961 6e74 5479  Field, VariantTy
+000233d0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+000233e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000233f0: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+00023400: 2c20 2258 225d 5d2c 2073 6368 656d 613d  , "X"]], schema=
+00023410: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+00023420: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00023430: 7428 6973 5f69 6e74 6567 6572 2874 6f5f  t(is_integer(to_
+00023440: 7661 7269 616e 7428 6466 5b22 6122 5d29  variant(df["a"])
+00023450: 292e 616c 6961 7328 2269 6e74 2229 2c20  ).alias("int"), 
+00023460: 6973 5f69 6e74 6567 6572 2874 6f5f 7661  is_integer(to_va
+00023470: 7269 616e 7428 6466 5b22 6222 5d29 292e  riant(df["b"])).
+00023480: 616c 6961 7328 2276 6172 6368 6172 2229  alias("varchar")
+00023490: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000234a0: 2020 2020 5b52 6f77 2849 4e54 3d54 7275      [Row(INT=Tru
+000234b0: 652c 2056 4152 4348 4152 3d46 616c 7365  e, VARCHAR=False
+000234c0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+000234d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+000234e0: 7228 636f 6c2c 2022 6973 5f69 6e74 6567  r(col, "is_integ
+000234f0: 6572 2229 0a20 2020 2072 6574 7572 6e20  er").    return 
+00023500: 6275 696c 7469 6e28 2269 735f 696e 7465  builtin("is_inte
+00023510: 6765 7222 2928 6329 0a0a 0a64 6566 2069  ger")(c)...def i
+00023520: 735f 6e75 6c6c 5f76 616c 7565 2863 6f6c  s_null_value(col
+00023530: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00023540: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00023550: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+00023560: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
+00023570: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
+00023580: 756d 6e20 636f 6e74 6169 6e73 2061 204a  umn contains a J
+00023590: 534f 4e20 6e75 6c6c 2076 616c 7565 2e0a  SON null value..
+000235a0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+000235b0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+000235c0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+000235d0: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
+000235e0: 706f 7274 2074 6f5f 7661 7269 616e 742c  port to_variant,
+000235f0: 2069 735f 6e75 6c6c 5f76 616c 7565 0a20   is_null_value. 
+00023600: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00023610: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00023620: 6174 6166 7261 6d65 285b 5b7b 2261 223a  ataframe([[{"a":
+00023630: 2022 666f 6f22 7d5d 2c20 5b7b 2261 223a   "foo"}], [{"a":
+00023640: 204e 6f6e 657d 5d2c 205b 4e6f 6e65 5d5d   None}], [None]]
+00023650: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00023660: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00023670: 656c 6563 7428 6973 5f6e 756c 6c5f 7661  elect(is_null_va
+00023680: 6c75 6528 746f 5f76 6172 6961 6e74 2822  lue(to_variant("
+00023690: 6122 295b 2261 225d 292e 6173 5f28 2261  a")["a"]).as_("a
+000236a0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+000236b0: 2020 2020 2020 5b52 6f77 2841 3d46 616c        [Row(A=Fal
+000236c0: 7365 292c 2052 6f77 2841 3d54 7275 6529  se), Row(A=True)
+000236d0: 2c20 526f 7728 413d 4e6f 6e65 295d 0a20  , Row(A=None)]. 
+000236e0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+000236f0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+00023700: 6c2c 2022 6973 5f6e 756c 6c5f 7661 6c75  l, "is_null_valu
+00023710: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
+00023720: 7569 6c74 696e 2822 6973 5f6e 756c 6c5f  uiltin("is_null_
+00023730: 7661 6c75 6522 2928 6329 0a0a 0a64 6566  value")(c)...def
+00023740: 2069 735f 6f62 6a65 6374 2863 6f6c 3a20   is_object(col: 
+00023750: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00023760: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00023770: 0a20 2020 2052 6574 7572 6e73 2074 7275  .    Returns tru
+00023780: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
+00023790: 6564 2056 4152 4941 4e54 2063 6f6c 756d  ed VARIANT colum
+000237a0: 6e20 636f 6e74 6169 6e73 2061 6e20 4f42  n contains an OB
+000237b0: 4a45 4354 2076 616c 7565 2e0a 0a20 2020  JECT value...   
+000237c0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+000237d0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000237e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000237f0: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00023800: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
+00023810: 6f62 6a65 6374 0a20 2020 2020 2020 203e  object.        >
+00023820: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00023830: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00023840: 285b 5b5b 312c 2032 5d2c 207b 2261 223a  ([[[1, 2], {"a":
+00023850: 2022 736e 6f77 227d 5d5d 2c20 7363 6865   "snow"}]], sche
+00023860: 6d61 3d5b 2261 222c 2022 6222 5d29 0a20  ma=["a", "b"]). 
+00023870: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00023880: 6c65 6374 2869 735f 6f62 6a65 6374 2874  lect(is_object(t
+00023890: 6f5f 7661 7269 616e 7428 2261 2229 292e  o_variant("a")).
+000238a0: 6173 5f28 2261 2229 2c20 6973 5f6f 626a  as_("a"), is_obj
+000238b0: 6563 7428 746f 5f76 6172 6961 6e74 2822  ect(to_variant("
+000238c0: 6222 2929 2e61 735f 2822 6222 2929 2e63  b")).as_("b")).c
+000238d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000238e0: 205b 526f 7728 413d 4661 6c73 652c 2042   [Row(A=False, B
+000238f0: 3d54 7275 6529 5d0a 2020 2020 2222 220a  =True)].    """.
+00023900: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00023910: 6966 5f73 7472 2863 6f6c 2c20 2269 735f  if_str(col, "is_
+00023920: 6f62 6a65 6374 2229 0a20 2020 2072 6574  object").    ret
+00023930: 7572 6e20 6275 696c 7469 6e28 2269 735f  urn builtin("is_
+00023940: 6f62 6a65 6374 2229 2863 290a 0a0a 6465  object")(c)...de
+00023950: 6620 6973 5f74 696d 6528 636f 6c3a 2043  f is_time(col: C
+00023960: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00023970: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00023980: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
+00023990: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
+000239a0: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
+000239b0: 2063 6f6e 7461 696e 7320 6120 5449 4d45   contains a TIME
+000239c0: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
+000239d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000239e0: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+000239f0: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+00023a00: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00023a10: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+00023a20: 7320 696d 706f 7274 2074 6f5f 7661 7269  s import to_vari
+00023a30: 616e 742c 2069 735f 7469 6d65 0a20 2020  ant, is_time.   
+00023a40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00023a50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00023a60: 6166 7261 6d65 285b 5b64 6174 6574 696d  aframe([[datetim
+00023a70: 652e 7469 6d65 2831 302c 2031 3029 2c20  e.time(10, 10), 
+00023a80: 2258 225d 5d2c 2073 6368 656d 613d 5b22  "X"]], schema=["
+00023a90: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+00023aa0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00023ab0: 6973 5f74 696d 6528 746f 5f76 6172 6961  is_time(to_varia
+00023ac0: 6e74 2822 6122 2929 2e61 735f 2822 6122  nt("a")).as_("a"
+00023ad0: 292c 2069 735f 7469 6d65 2874 6f5f 7661  ), is_time(to_va
+00023ae0: 7269 616e 7428 2262 2229 292e 6173 5f28  riant("b")).as_(
+00023af0: 2262 2229 292e 636f 6c6c 6563 7428 290a  "b")).collect().
+00023b00: 2020 2020 2020 2020 5b52 6f77 2841 3d54          [Row(A=T
+00023b10: 7275 652c 2042 3d46 616c 7365 295d 0a20  rue, B=False)]. 
+00023b20: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00023b30: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+00023b40: 6c2c 2022 6973 5f74 696d 6522 290a 2020  l, "is_time").  
+00023b50: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00023b60: 2822 6973 5f74 696d 6522 2928 6329 0a0a  ("is_time")(c)..
+00023b70: 0a64 6566 2069 735f 7469 6d65 7374 616d  .def is_timestam
+00023b80: 705f 6c74 7a28 636f 6c3a 2043 6f6c 756d  p_ltz(col: Colum
+00023b90: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00023ba0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00023bb0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00023bc0: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
+00023bd0: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
+00023be0: 7461 696e 7320 6120 5449 4d45 5354 414d  tains a TIMESTAM
+00023bf0: 505f 4c54 5a20 7661 6c75 6520 746f 2062  P_LTZ value to b
+00023c00: 650a 2020 2020 696e 7465 7270 7265 7465  e.    interprete
+00023c10: 6420 7573 696e 6720 7468 6520 6c6f 6361  d using the loca
+00023c20: 6c20 7469 6d65 207a 6f6e 652e 0a0a 2020  l time zone...  
+00023c30: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00023c40: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00023c50: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00023c60: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+00023c70: 7420 746f 5f76 6172 6961 6e74 2c20 6973  t to_variant, is
+00023c80: 5f74 696d 6573 7461 6d70 5f6c 747a 0a20  _timestamp_ltz. 
+00023c90: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00023ca0: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+00023cb0: 6563 7420 746f 5f74 696d 6573 7461 6d70  ect to_timestamp
+00023cc0: 5f6e 747a 2827 3230 3137 2d30 322d 3234  _ntz('2017-02-24
+00023cd0: 2031 323a 3030 3a30 302e 3435 3627 2920   12:00:00.456') 
+00023ce0: 6173 2074 696d 6573 7461 6d70 5f6e 747a  as timestamp_ntz
+00023cf0: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
+00023d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d10: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
+00023d20: 6c74 7a28 2732 3031 372d 3032 2d32 3420  ltz('2017-02-24 
+00023d30: 3133 3a30 303a 3030 2e31 3233 202b 3031  13:00:00.123 +01
+00023d40: 3a30 3027 2920 6173 2074 696d 6573 7461  :00') as timesta
+00023d50: 6d70 5f6c 747a 312c 2022 0a20 2020 2020  mp_ltz1, ".     
+00023d60: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00023d70: 2020 2020 2020 2020 2274 6f5f 7469 6d65          "to_time
+00023d80: 7374 616d 705f 747a 2827 3230 3137 2d30  stamp_tz('2017-0
+00023d90: 322d 3234 2031 333a 3030 3a30 302e 3132  2-24 13:00:00.12
+00023da0: 3320 2b30 313a 3030 2729 2061 7320 7469  3 +01:00') as ti
+00023db0: 6d65 7374 616d 705f 747a 3122 290a 2020  mestamp_tz1").  
+00023dc0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00023dd0: 6563 7428 6973 5f74 696d 6573 7461 6d70  ect(is_timestamp
+00023de0: 5f6c 747a 2874 6f5f 7661 7269 616e 7428  _ltz(to_variant(
+00023df0: 2274 696d 6573 7461 6d70 5f6e 747a 3122  "timestamp_ntz1"
+00023e00: 2929 2e61 735f 2822 6122 292c 0a20 2020  )).as_("a"),.   
+00023e10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00023e20: 2020 2069 735f 7469 6d65 7374 616d 705f     is_timestamp_
+00023e30: 6c74 7a28 746f 5f76 6172 6961 6e74 2822  ltz(to_variant("
+00023e40: 7469 6d65 7374 616d 705f 6c74 7a31 2229  timestamp_ltz1")
+00023e50: 292e 6173 5f28 2262 2229 2c0a 2020 2020  ).as_("b"),.    
+00023e60: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00023e70: 2020 6973 5f74 696d 6573 7461 6d70 5f6c    is_timestamp_l
+00023e80: 747a 2874 6f5f 7661 7269 616e 7428 2274  tz(to_variant("t
+00023e90: 696d 6573 7461 6d70 5f74 7a31 2229 292e  imestamp_tz1")).
+00023ea0: 6173 5f28 2263 2229 292e 636f 6c6c 6563  as_("c")).collec
+00023eb0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00023ec0: 2841 3d46 616c 7365 2c20 423d 5472 7565  (A=False, B=True
+00023ed0: 2c20 433d 4661 6c73 6529 5d0a 2020 2020  , C=False)].    
+00023ee0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00023ef0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
+00023f00: 2269 735f 7469 6d65 7374 616d 705f 6c74  "is_timestamp_lt
+00023f10: 7a22 290a 2020 2020 7265 7475 726e 2062  z").    return b
+00023f20: 7569 6c74 696e 2822 6973 5f74 696d 6573  uiltin("is_times
+00023f30: 7461 6d70 5f6c 747a 2229 2863 290a 0a0a  tamp_ltz")(c)...
+00023f40: 6465 6620 6973 5f74 696d 6573 7461 6d70  def is_timestamp
+00023f50: 5f6e 747a 2863 6f6c 3a20 436f 6c75 6d6e  _ntz(col: Column
+00023f60: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00023f70: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00023f80: 6574 7572 6e73 2074 7275 6520 6966 2074  eturns true if t
+00023f90: 6865 2073 7065 6369 6669 6564 2056 4152  he specified VAR
+00023fa0: 4941 4e54 2063 6f6c 756d 6e20 636f 6e74  IANT column cont
+00023fb0: 6169 6e73 2061 2054 494d 4553 5441 4d50  ains a TIMESTAMP
+00023fc0: 5f4e 545a 2076 616c 7565 2077 6974 6820  _NTZ value with 
+00023fd0: 6e6f 2074 696d 6520 7a6f 6e65 2e0a 0a20  no time zone... 
+00023fe0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00023ff0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00024000: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00024010: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+00024020: 7274 2074 6f5f 7661 7269 616e 742c 2069  rt to_variant, i
+00024030: 735f 7469 6d65 7374 616d 705f 6e74 7a0a  s_timestamp_ntz.
+00024040: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00024050: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
+00024060: 6c65 6374 2074 6f5f 7469 6d65 7374 616d  lect to_timestam
+00024070: 705f 6e74 7a28 2732 3031 372d 3032 2d32  p_ntz('2017-02-2
+00024080: 3420 3132 3a30 303a 3030 2e34 3536 2729  4 12:00:00.456')
+00024090: 2061 7320 7469 6d65 7374 616d 705f 6e74   as timestamp_nt
+000240a0: 7a31 2c20 220a 2020 2020 2020 2020 2e2e  z1, ".        ..
+000240b0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+000240c0: 2020 2022 746f 5f74 696d 6573 7461 6d70     "to_timestamp
+000240d0: 5f6c 747a 2827 3230 3137 2d30 322d 3234  _ltz('2017-02-24
+000240e0: 2031 333a 3030 3a30 302e 3132 3320 2b30   13:00:00.123 +0
+000240f0: 313a 3030 2729 2061 7320 7469 6d65 7374  1:00') as timest
+00024100: 616d 705f 6c74 7a31 2c20 220a 2020 2020  amp_ltz1, ".    
+00024110: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00024120: 2020 2020 2020 2020 2022 746f 5f74 696d           "to_tim
+00024130: 6573 7461 6d70 5f74 7a28 2732 3031 372d  estamp_tz('2017-
+00024140: 3032 2d32 3420 3133 3a30 303a 3030 2e31  02-24 13:00:00.1
+00024150: 3233 202b 3031 3a30 3027 2920 6173 2074  23 +01:00') as t
+00024160: 696d 6573 7461 6d70 5f74 7a31 2229 0a20  imestamp_tz1"). 
+00024170: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00024180: 6c65 6374 2869 735f 7469 6d65 7374 616d  lect(is_timestam
+00024190: 705f 6e74 7a28 746f 5f76 6172 6961 6e74  p_ntz(to_variant
+000241a0: 2822 7469 6d65 7374 616d 705f 6e74 7a31  ("timestamp_ntz1
+000241b0: 2229 292e 6173 5f28 2261 2229 2c0a 2020  ")).as_("a"),.  
+000241c0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000241d0: 2020 2020 6973 5f74 696d 6573 7461 6d70      is_timestamp
+000241e0: 5f6e 747a 2874 6f5f 7661 7269 616e 7428  _ntz(to_variant(
+000241f0: 2274 696d 6573 7461 6d70 5f6c 747a 3122  "timestamp_ltz1"
+00024200: 2929 2e61 735f 2822 6222 292c 0a20 2020  )).as_("b"),.   
+00024210: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00024220: 2020 2069 735f 7469 6d65 7374 616d 705f     is_timestamp_
+00024230: 6e74 7a28 746f 5f76 6172 6961 6e74 2822  ntz(to_variant("
+00024240: 7469 6d65 7374 616d 705f 747a 3122 2929  timestamp_tz1"))
+00024250: 2e61 735f 2822 6322 2929 2e63 6f6c 6c65  .as_("c")).colle
+00024260: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00024270: 7728 413d 5472 7565 2c20 423d 4661 6c73  w(A=True, B=Fals
+00024280: 652c 2043 3d46 616c 7365 295d 0a20 2020  e, C=False)].   
+00024290: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000242a0: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
+000242b0: 2022 6973 5f74 696d 6573 7461 6d70 5f6e   "is_timestamp_n
+000242c0: 747a 2229 0a20 2020 2072 6574 7572 6e20  tz").    return 
+000242d0: 6275 696c 7469 6e28 2269 735f 7469 6d65  builtin("is_time
+000242e0: 7374 616d 705f 6e74 7a22 2928 6329 0a0a  stamp_ntz")(c)..
+000242f0: 0a64 6566 2069 735f 7469 6d65 7374 616d  .def is_timestam
+00024300: 705f 747a 2863 6f6c 3a20 436f 6c75 6d6e  p_tz(col: Column
+00024310: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00024320: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00024330: 6574 7572 6e73 2074 7275 6520 6966 2074  eturns true if t
+00024340: 6865 2073 7065 6369 6669 6564 2056 4152  he specified VAR
+00024350: 4941 4e54 2063 6f6c 756d 6e20 636f 6e74  IANT column cont
+00024360: 6169 6e73 2061 2054 494d 4553 5441 4d50  ains a TIMESTAMP
+00024370: 5f54 5a20 7661 6c75 6520 7769 7468 2061  _TZ value with a
+00024380: 2074 696d 6520 7a6f 6e65 2e0a 0a20 2020   time zone...   
+00024390: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+000243a0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000243b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000243c0: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+000243d0: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
+000243e0: 7469 6d65 7374 616d 705f 747a 0a20 2020  timestamp_tz.   
+000243f0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00024400: 7373 696f 6e2e 7371 6c28 2273 656c 6563  ssion.sql("selec
+00024410: 7420 746f 5f74 696d 6573 7461 6d70 5f6e  t to_timestamp_n
+00024420: 747a 2827 3230 3137 2d30 322d 3234 2031  tz('2017-02-24 1
+00024430: 323a 3030 3a30 302e 3435 3627 2920 6173  2:00:00.456') as
+00024440: 2074 696d 6573 7461 6d70 5f6e 747a 312c   timestamp_ntz1,
+00024450: 2022 0a20 2020 2020 2020 202e 2e2e 2020   ".        ...  
+00024460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024470: 2274 6f5f 7469 6d65 7374 616d 705f 6c74  "to_timestamp_lt
+00024480: 7a28 2732 3031 372d 3032 2d32 3420 3133  z('2017-02-24 13
+00024490: 3a30 303a 3030 2e31 3233 202b 3031 3a30  :00:00.123 +01:0
+000244a0: 3027 2920 6173 2074 696d 6573 7461 6d70  0') as timestamp
+000244b0: 5f6c 747a 312c 2022 0a20 2020 2020 2020  _ltz1, ".       
+000244c0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+000244d0: 2020 2020 2020 2274 6f5f 7469 6d65 7374        "to_timest
+000244e0: 616d 705f 747a 2827 3230 3137 2d30 322d  amp_tz('2017-02-
+000244f0: 3234 2031 333a 3030 3a30 302e 3132 3320  24 13:00:00.123 
+00024500: 2b30 313a 3030 2729 2061 7320 7469 6d65  +01:00') as time
+00024510: 7374 616d 705f 747a 3122 290a 2020 2020  stamp_tz1").    
+00024520: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00024530: 7428 6973 5f74 696d 6573 7461 6d70 5f74  t(is_timestamp_t
+00024540: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
+00024550: 6d65 7374 616d 705f 6e74 7a31 2229 292e  mestamp_ntz1")).
+00024560: 6173 5f28 2261 2229 2c0a 2020 2020 2020  as_("a"),.      
+00024570: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00024580: 6973 5f74 696d 6573 7461 6d70 5f74 7a28  is_timestamp_tz(
+00024590: 746f 5f76 6172 6961 6e74 2822 7469 6d65  to_variant("time
+000245a0: 7374 616d 705f 6c74 7a31 2229 292e 6173  stamp_ltz1")).as
+000245b0: 5f28 2262 2229 2c0a 2020 2020 2020 2020  _("b"),.        
+000245c0: 2e2e 2e20 2020 2020 2020 2020 2020 6973  ...           is
+000245d0: 5f74 696d 6573 7461 6d70 5f74 7a28 746f  _timestamp_tz(to
+000245e0: 5f76 6172 6961 6e74 2822 7469 6d65 7374  _variant("timest
+000245f0: 616d 705f 747a 3122 2929 2e61 735f 2822  amp_tz1")).as_("
+00024600: 6322 2929 2e63 6f6c 6c65 6374 2829 0a20  c")).collect(). 
+00024610: 2020 2020 2020 205b 526f 7728 413d 4661         [Row(A=Fa
+00024620: 6c73 652c 2042 3d46 616c 7365 2c20 433d  lse, B=False, C=
+00024630: 5472 7565 295d 0a20 2020 2022 2222 0a20  True)].    """. 
+00024640: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00024650: 665f 7374 7228 636f 6c2c 2022 6973 5f74  f_str(col, "is_t
+00024660: 696d 6573 7461 6d70 5f74 7a22 290a 2020  imestamp_tz").  
+00024670: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00024680: 2822 6973 5f74 696d 6573 7461 6d70 5f74  ("is_timestamp_t
+00024690: 7a22 2928 6329 0a0a 0a64 6566 205f 636f  z")(c)...def _co
+000246a0: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
+000246b0: 7461 6d70 5f70 6172 7473 280a 2020 2020  tamp_parts(.    
+000246c0: 6675 6e63 5f6e 616d 653a 2073 7472 2c20  func_name: str, 
+000246d0: 2a61 7267 733a 2055 6e69 6f6e 5b43 6f6c  *args: Union[Col
+000246e0: 756d 6e4f 724e 616d 652c 2069 6e74 5d0a  umnOrName, int].
+000246f0: 2920 2d3e 2054 7570 6c65 5b43 6f6c 756d  ) -> Tuple[Colum
+00024700: 6e2c 202e 2e2e 5d3a 0a20 2020 2069 6620  n, ...]:.    if 
+00024710: 6c65 6e28 6172 6773 2920 3d3d 2033 3a0a  len(args) == 3:.
+00024720: 2020 2020 2020 2020 7965 6172 5f20 3d20          year_ = 
+00024730: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
+00024740: 725f 696e 7428 6172 6773 5b30 5d2c 2066  r_int(args[0], f
+00024750: 756e 635f 6e61 6d65 290a 2020 2020 2020  unc_name).      
+00024760: 2020 6d6f 6e74 6820 3d20 5f74 6f5f 636f    month = _to_co
+00024770: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
+00024780: 6172 6773 5b31 5d2c 2066 756e 635f 6e61  args[1], func_na
+00024790: 6d65 290a 2020 2020 2020 2020 6461 7920  me).        day 
+000247a0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000247b0: 5f6f 725f 696e 7428 6172 6773 5b32 5d2c  _or_int(args[2],
+000247c0: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
+000247d0: 2020 2020 7265 7475 726e 2079 6561 725f      return year_
+000247e0: 2c20 6d6f 6e74 682c 2064 6179 0a20 2020  , month, day.   
+000247f0: 2065 6c69 6620 6c65 6e28 6172 6773 2920   elif len(args) 
+00024800: 3d3d 2036 3a0a 2020 2020 2020 2020 7965  == 6:.        ye
+00024810: 6172 5f20 3d20 5f74 6f5f 636f 6c5f 6966  ar_ = _to_col_if
+00024820: 5f73 7472 5f6f 725f 696e 7428 6172 6773  _str_or_int(args
+00024830: 5b30 5d2c 2066 756e 635f 6e61 6d65 290a  [0], func_name).
+00024840: 2020 2020 2020 2020 6d6f 6e74 6820 3d20          month = 
+00024850: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
+00024860: 725f 696e 7428 6172 6773 5b31 5d2c 2066  r_int(args[1], f
+00024870: 756e 635f 6e61 6d65 290a 2020 2020 2020  unc_name).      
+00024880: 2020 6461 7920 3d20 5f74 6f5f 636f 6c5f    day = _to_col_
+00024890: 6966 5f73 7472 5f6f 725f 696e 7428 6172  if_str_or_int(ar
+000248a0: 6773 5b32 5d2c 2066 756e 635f 6e61 6d65  gs[2], func_name
+000248b0: 290a 2020 2020 2020 2020 686f 7572 203d  ).        hour =
+000248c0: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
+000248d0: 6f72 5f69 6e74 2861 7267 735b 335d 2c20  or_int(args[3], 
+000248e0: 6675 6e63 5f6e 616d 6529 0a20 2020 2020  func_name).     
+000248f0: 2020 206d 696e 7574 6520 3d20 5f74 6f5f     minute = _to_
+00024900: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
+00024910: 7428 6172 6773 5b34 5d2c 2066 756e 635f  t(args[4], func_
+00024920: 6e61 6d65 290a 2020 2020 2020 2020 7365  name).        se
+00024930: 636f 6e64 203d 205f 746f 5f63 6f6c 5f69  cond = _to_col_i
+00024940: 665f 7374 725f 6f72 5f69 6e74 2861 7267  f_str_or_int(arg
+00024950: 735b 355d 2c20 6675 6e63 5f6e 616d 6529  s[5], func_name)
+00024960: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024970: 7965 6172 5f2c 206d 6f6e 7468 2c20 6461  year_, month, da
+00024980: 792c 2068 6f75 722c 206d 696e 7574 652c  y, hour, minute,
+00024990: 2073 6563 6f6e 640a 2020 2020 656c 7365   second.    else
+000249a0: 3a0a 2020 2020 2020 2020 2320 5368 6f75  :.        # Shou
+000249b0: 6c64 206e 6576 6572 2068 6170 7065 6e20  ld never happen 
+000249c0: 7369 6e63 6520 7765 206f 6e6c 7920 7573  since we only us
+000249d0: 6520 7468 6973 2069 6e74 6572 6e61 6c6c  e this internall
+000249e0: 790a 2020 2020 2020 2020 7261 6973 6520  y.        raise 
+000249f0: 5661 6c75 6545 7272 6f72 2866 2249 6e63  ValueError(f"Inc
+00024a00: 6f72 7265 6374 206e 756d 6265 7220 6f66  orrect number of
+00024a10: 2061 7267 7320 7061 7373 6564 2074 6f20   args passed to 
+00024a20: 7b66 756e 635f 6e61 6d65 7d22 290a 0a0a  {func_name}")...
+00024a30: 6465 6620 5f74 696d 6573 7461 6d70 5f66  def _timestamp_f
+00024a40: 726f 6d5f 7061 7274 735f 696e 7465 726e  rom_parts_intern
+00024a50: 616c 280a 2020 2020 6675 6e63 5f6e 616d  al(.    func_nam
+00024a60: 653a 2073 7472 2c20 2a61 7267 733a 2055  e: str, *args: U
+00024a70: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00024a80: 652c 2069 6e74 5d2c 202a 2a6b 7761 7267  e, int], **kwarg
+00024a90: 733a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  s: Union[ColumnO
+00024aa0: 724e 616d 652c 2069 6e74 5d0a 2920 2d3e  rName, int].) ->
+00024ab0: 2054 7570 6c65 5b43 6f6c 756d 6e2c 202e   Tuple[Column, .
+00024ac0: 2e2e 5d3a 0a20 2020 206e 756d 5f61 7267  ..]:.    num_arg
+00024ad0: 7320 3d20 6c65 6e28 6172 6773 290a 2020  s = len(args).  
+00024ae0: 2020 6966 206e 756d 5f61 7267 7320 3d3d    if num_args ==
+00024af0: 2032 3a0a 2020 2020 2020 2020 2320 6578   2:.        # ex
+00024b00: 7072 6573 7369 6f6e 206d 6f64 650a 2020  pression mode.  
+00024b10: 2020 2020 2020 6461 7465 5f65 7870 7220        date_expr 
+00024b20: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00024b30: 2861 7267 735b 305d 2c20 6675 6e63 5f6e  (args[0], func_n
+00024b40: 616d 6529 0a20 2020 2020 2020 2074 696d  ame).        tim
+00024b50: 655f 6578 7072 203d 205f 746f 5f63 6f6c  e_expr = _to_col
+00024b60: 5f69 665f 7374 7228 6172 6773 5b31 5d2c  _if_str(args[1],
+00024b70: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
+00024b80: 2020 2020 7265 7475 726e 2064 6174 655f      return date_
+00024b90: 6578 7072 2c20 7469 6d65 5f65 7870 720a  expr, time_expr.
+00024ba0: 2020 2020 656c 6966 2036 203c 3d20 6e75      elif 6 <= nu
+00024bb0: 6d5f 6172 6773 203c 3d20 383a 0a20 2020  m_args <= 8:.   
+00024bc0: 2020 2020 2023 2070 6172 7473 206d 6f64       # parts mod
+00024bd0: 650a 2020 2020 2020 2020 792c 206d 2c20  e.        y, m, 
+00024be0: 642c 2068 2c20 6d69 6e5f 2c20 7320 3d20  d, h, min_, s = 
+00024bf0: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
+00024c00: 6d65 7374 616d 705f 7061 7274 7328 6675  mestamp_parts(fu
+00024c10: 6e63 5f6e 616d 652c 202a 6172 6773 5b3a  nc_name, *args[:
+00024c20: 365d 290a 2020 2020 2020 2020 6e73 5f61  6]).        ns_a
+00024c30: 7267 203d 2061 7267 735b 365d 2069 6620  rg = args[6] if 
+00024c40: 6e75 6d5f 6172 6773 203e 3d20 3720 656c  num_args >= 7 el
+00024c50: 7365 206b 7761 7267 732e 6765 7428 226e  se kwargs.get("n
+00024c60: 616e 6f73 6563 6f6e 6473 2229 0a20 2020  anoseconds").   
+00024c70: 2020 2020 2023 2054 696d 657a 6f6e 6520       # Timezone 
+00024c80: 6973 206f 6e6c 7920 6163 6365 7074 6564  is only accepted
+00024c90: 2069 6e20 7469 6d65 7374 616d 705f 6672   in timestamp_fr
+00024ca0: 6f6d 5f70 6172 7473 2066 756e 6374 696f  om_parts functio
+00024cb0: 6e0a 2020 2020 2020 2020 747a 5f61 7267  n.        tz_arg
+00024cc0: 203d 2061 7267 735b 375d 2069 6620 6e75   = args[7] if nu
+00024cd0: 6d5f 6172 6773 203d 3d20 3820 656c 7365  m_args == 8 else
+00024ce0: 206b 7761 7267 732e 6765 7428 2274 696d   kwargs.get("tim
+00024cf0: 657a 6f6e 6522 290a 2020 2020 2020 2020  ezone").        
+00024d00: 6966 2074 7a5f 6172 6720 6973 206e 6f74  if tz_arg is not
+00024d10: 204e 6f6e 6520 616e 6420 6675 6e63 5f6e   None and func_n
+00024d20: 616d 6520 213d 2022 7469 6d65 7374 616d  ame != "timestam
+00024d30: 705f 6672 6f6d 5f70 6172 7473 223a 0a20  p_from_parts":. 
+00024d40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00024d50: 2056 616c 7565 4572 726f 7228 6622 7b66   ValueError(f"{f
+00024d60: 756e 635f 6e61 6d65 7d20 646f 6573 206e  unc_name} does n
+00024d70: 6f74 2061 6363 6570 7420 7469 6d65 7a6f  ot accept timezo
+00024d80: 6e65 2061 7320 616e 2061 7267 756d 656e  ne as an argumen
+00024d90: 7422 290a 2020 2020 2020 2020 6e73 203d  t").        ns =
+00024da0: 204e 6f6e 6520 6966 206e 735f 6172 6720   None if ns_arg 
+00024db0: 6973 204e 6f6e 6520 656c 7365 205f 746f  is None else _to
+00024dc0: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
+00024dd0: 6e74 286e 735f 6172 672c 2066 756e 635f  nt(ns_arg, func_
+00024de0: 6e61 6d65 290a 2020 2020 2020 2020 747a  name).        tz
+00024df0: 203d 204e 6f6e 6520 6966 2074 7a5f 6172   = None if tz_ar
+00024e00: 6720 6973 204e 6f6e 6520 656c 7365 205f  g is None else _
+00024e10: 746f 5f63 6f6c 5f69 665f 7371 6c5f 6578  to_col_if_sql_ex
+00024e20: 7072 2874 7a5f 6172 672c 2066 756e 635f  pr(tz_arg, func_
+00024e30: 6e61 6d65 290a 2020 2020 2020 2020 6966  name).        if
+00024e40: 206e 7320 6973 206e 6f74 204e 6f6e 6520   ns is not None 
+00024e50: 616e 6420 747a 2069 7320 6e6f 7420 4e6f  and tz is not No
+00024e60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00024e70: 7265 7475 726e 2079 2c20 6d2c 2064 2c20  return y, m, d, 
+00024e80: 682c 206d 696e 5f2c 2073 2c20 6e73 2c20  h, min_, s, ns, 
+00024e90: 747a 0a20 2020 2020 2020 2065 6c69 6620  tz.        elif 
+00024ea0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ns is not None:.
+00024eb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00024ec0: 726e 2079 2c20 6d2c 2064 2c20 682c 206d  rn y, m, d, h, m
+00024ed0: 696e 5f2c 2073 2c20 6e73 0a20 2020 2020  in_, s, ns.     
+00024ee0: 2020 2065 6c69 6620 747a 2069 7320 6e6f     elif tz is no
+00024ef0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00024f00: 2020 2020 2320 5765 206e 6565 6420 746f      # We need to
+00024f10: 2066 696c 6c20 696e 206e 616e 6f73 6563   fill in nanosec
+00024f20: 6f6e 6473 2061 7320 3020 746f 206d 616b  onds as 0 to mak
+00024f30: 6520 7468 6520 7371 6c20 6675 6e63 7469  e the sql functi
+00024f40: 6f6e 2077 6f72 6b0a 2020 2020 2020 2020  on work.        
+00024f50: 2020 2020 7265 7475 726e 2079 2c20 6d2c      return y, m,
+00024f60: 2064 2c20 682c 206d 696e 5f2c 2073 2c20   d, h, min_, s, 
+00024f70: 6c69 7428 3029 2c20 747a 0a20 2020 2020  lit(0), tz.     
+00024f80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00024f90: 2020 2020 2072 6574 7572 6e20 792c 206d       return y, m
+00024fa0: 2c20 642c 2068 2c20 6d69 6e5f 2c20 730a  , d, h, min_, s.
+00024fb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00024fc0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00024fd0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00024fe0: 6622 7b66 756e 635f 6e61 6d65 7d20 6578  f"{func_name} ex
+00024ff0: 7065 6374 6564 2032 206f 7220 3620 7265  pected 2 or 6 re
+00025000: 7175 6972 6564 2061 7267 756d 656e 7473  quired arguments
+00025010: 2c20 676f 7420 7b6e 756d 5f61 7267 737d  , got {num_args}
+00025020: 220a 2020 2020 2020 2020 290a 0a0a 6465  ".        )...de
+00025030: 6620 7469 6d65 5f66 726f 6d5f 7061 7274  f time_from_part
+00025040: 7328 0a20 2020 2068 6f75 723a 2055 6e69  s(.    hour: Uni
+00025050: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00025060: 2069 6e74 5d2c 0a20 2020 206d 696e 7574   int],.    minut
+00025070: 653a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  e: Union[ColumnO
+00025080: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
+00025090: 2073 6563 6f6e 643a 2055 6e69 6f6e 5b43   second: Union[C
+000250a0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+000250b0: 5d2c 0a20 2020 206e 616e 6f73 6563 6f6e  ],.    nanosecon
+000250c0: 6473 3a20 4f70 7469 6f6e 616c 5b55 6e69  ds: Optional[Uni
+000250d0: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+000250e0: 2069 6e74 5d5d 203d 204e 6f6e 652c 0a29   int]] = None,.)
+000250f0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00025100: 2222 220a 2020 2020 4372 6561 7465 7320  """.    Creates 
+00025110: 6120 7469 6d65 2066 726f 6d20 696e 6469  a time from indi
+00025120: 7669 6475 616c 206e 756d 6572 6963 2063  vidual numeric c
+00025130: 6f6d 706f 6e65 6e74 732e 0a0a 2020 2020  omponents...    
+00025140: 5449 4d45 5f46 524f 4d5f 5041 5254 5320  TIME_FROM_PARTS 
+00025150: 6973 2074 7970 6963 616c 6c79 2075 7365  is typically use
+00025160: 6420 746f 2068 616e 646c 6520 7661 6c75  d to handle valu
+00025170: 6573 2069 6e20 226e 6f72 6d61 6c22 2072  es in "normal" r
+00025180: 616e 6765 7320 2865 2e67 2e20 686f 7572  anges (e.g. hour
+00025190: 7320 302d 3233 2c20 6d69 6e75 7465 7320  s 0-23, minutes 
+000251a0: 302d 3539 292c 0a20 2020 2062 7574 2069  0-59),.    but i
+000251b0: 7420 616c 736f 2068 616e 646c 6573 2076  t also handles v
+000251c0: 616c 7565 7320 6672 6f6d 206f 7574 7369  alues from outsi
+000251d0: 6465 2074 6865 7365 2072 616e 6765 732e  de these ranges.
+000251e0: 2054 6869 7320 616c 6c6f 7773 2c20 666f   This allows, fo
+000251f0: 7220 6578 616d 706c 652c 2063 686f 6f73  r example, choos
+00025200: 696e 6720 7468 6520 4e2d 7468 206d 696e  ing the N-th min
+00025210: 7574 650a 2020 2020 696e 2061 2064 6179  ute.    in a day
+00025220: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
+00025230: 7365 6420 746f 2073 696d 706c 6966 7920  sed to simplify 
+00025240: 736f 6d65 2063 6f6d 7075 7461 7469 6f6e  some computation
+00025250: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00025260: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00025270: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00025280: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00025290: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+000252a0: 3131 2c20 3131 2c20 302c 2039 3837 3635  11, 11, 0, 98765
+000252b0: 3433 3231 5d2c 205b 3130 2c20 3130 2c20  4321], [10, 10, 
+000252c0: 302c 2039 3837 3635 3433 3231 5d5d 2c0a  0, 987654321]],.
+000252d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+000252e0: 7363 6865 6d61 3d5b 2268 6f75 7222 2c20  schema=["hour", 
+000252f0: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+00025300: 6422 2c20 226e 616e 6f73 6563 6f6e 6473  d", "nanoseconds
+00025310: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
+00025320: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00025330: 2e73 656c 6563 7428 7469 6d65 5f66 726f  .select(time_fro
+00025340: 6d5f 7061 7274 7328 0a20 2020 2020 2020  m_parts(.       
+00025350: 202e 2e2e 2020 2020 2022 686f 7572 222c   ...     "hour",
+00025360: 2022 6d69 6e75 7465 222c 2022 7365 636f   "minute", "seco
+00025370: 6e64 222c 206e 616e 6f73 6563 6f6e 6473  nd", nanoseconds
+00025380: 3d22 6e61 6e6f 7365 636f 6e64 7322 0a20  ="nanoseconds". 
+00025390: 2020 2020 2020 202e 2e2e 2029 2e61 6c69         ... ).ali
+000253a0: 6173 2822 5449 4d45 5f46 524f 4d5f 5041  as("TIME_FROM_PA
+000253b0: 5254 5322 2929 2e63 6f6c 6c65 6374 2829  RTS")).collect()
+000253c0: 0a20 2020 2020 2020 205b 526f 7728 5449  .        [Row(TI
+000253d0: 4d45 5f46 524f 4d5f 5041 5254 533d 6461  ME_FROM_PARTS=da
+000253e0: 7465 7469 6d65 2e74 696d 6528 3131 2c20  tetime.time(11, 
+000253f0: 3131 2c20 302c 2039 3837 3635 3429 292c  11, 0, 987654)),
+00025400: 2052 6f77 2854 494d 455f 4652 4f4d 5f50   Row(TIME_FROM_P
+00025410: 4152 5453 3d64 6174 6574 696d 652e 7469  ARTS=datetime.ti
+00025420: 6d65 2831 302c 2031 302c 2030 2c20 3938  me(10, 10, 0, 98
+00025430: 3736 3534 2929 5d0a 2020 2020 2222 220a  7654))].    """.
+00025440: 2020 2020 682c 206d 2c20 7320 3d20 5f63      h, m, s = _c
+00025450: 6f6c 756d 6e73 5f66 726f 6d5f 7469 6d65  olumns_from_time
+00025460: 7374 616d 705f 7061 7274 7328 2274 696d  stamp_parts("tim
+00025470: 655f 6672 6f6d 5f70 6172 7473 222c 2068  e_from_parts", h
+00025480: 6f75 722c 206d 696e 7574 652c 2073 6563  our, minute, sec
+00025490: 6f6e 6429 0a20 2020 2069 6620 6e61 6e6f  ond).    if nano
+000254a0: 7365 636f 6e64 733a 0a20 2020 2020 2020  seconds:.       
+000254b0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000254c0: 2274 696d 655f 6672 6f6d 5f70 6172 7473  "time_from_parts
+000254d0: 2229 280a 2020 2020 2020 2020 2020 2020  ")(.            
+000254e0: 682c 206d 2c20 732c 205f 746f 5f63 6f6c  h, m, s, _to_col
+000254f0: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
+00025500: 616e 6f73 6563 6f6e 6473 2c20 2274 696d  anoseconds, "tim
+00025510: 655f 6672 6f6d 5f70 6172 7473 2229 0a20  e_from_parts"). 
+00025520: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
+00025530: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+00025540: 6e20 6275 696c 7469 6e28 2274 696d 655f  n builtin("time_
+00025550: 6672 6f6d 5f70 6172 7473 2229 2868 2c20  from_parts")(h, 
+00025560: 6d2c 2073 290a 0a0a 406f 7665 726c 6f61  m, s)...@overloa
+00025570: 640a 6465 6620 7469 6d65 7374 616d 705f  d.def timestamp_
+00025580: 6672 6f6d 5f70 6172 7473 2864 6174 655f  from_parts(date_
+00025590: 6578 7072 3a20 436f 6c75 6d6e 4f72 4e61  expr: ColumnOrNa
+000255a0: 6d65 2c20 7469 6d65 5f65 7870 723a 2043  me, time_expr: C
+000255b0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+000255c0: 436f 6c75 6d6e 3a0a 2020 2020 2e2e 2e20  Column:.    ... 
+000255d0: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
+000255e0: 7665 720a 0a0a 406f 7665 726c 6f61 640a  ver...@overload.
+000255f0: 6465 6620 7469 6d65 7374 616d 705f 6672  def timestamp_fr
+00025600: 6f6d 5f70 6172 7473 280a 2020 2020 7965  om_parts(.    ye
+00025610: 6172 3a20 556e 696f 6e5b 436f 6c75 6d6e  ar: Union[Column
+00025620: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
+00025630: 2020 6d6f 6e74 683a 2055 6e69 6f6e 5b43    month: Union[C
+00025640: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+00025650: 5d2c 0a20 2020 2064 6179 3a20 556e 696f  ],.    day: Unio
+00025660: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00025670: 696e 745d 2c0a 2020 2020 686f 7572 3a20  int],.    hour: 
+00025680: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00025690: 6d65 2c20 696e 745d 2c0a 2020 2020 6d69  me, int],.    mi
+000256a0: 6e75 7465 3a20 556e 696f 6e5b 436f 6c75  nute: Union[Colu
+000256b0: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+000256c0: 2020 2020 7365 636f 6e64 3a20 556e 696f      second: Unio
+000256d0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+000256e0: 696e 745d 2c0a 2020 2020 6e61 6e6f 7365  int],.    nanose
+000256f0: 636f 6e64 3a20 4f70 7469 6f6e 616c 5b55  cond: Optional[U
+00025700: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00025710: 652c 2069 6e74 5d5d 203d 204e 6f6e 652c  e, int]] = None,
+00025720: 0a20 2020 2074 696d 657a 6f6e 653a 204f  .    timezone: O
+00025730: 7074 696f 6e61 6c5b 436f 6c75 6d6e 4f72  ptional[ColumnOr
+00025740: 4c69 7465 7261 6c53 7472 5d20 3d20 4e6f  LiteralStr] = No
+00025750: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
+00025760: 0a20 2020 202e 2e2e 2020 2320 7072 6167  .    ...  # prag
+00025770: 6d61 3a20 6e6f 2063 6f76 6572 0a0a 0a64  ma: no cover...d
+00025780: 6566 2074 696d 6573 7461 6d70 5f66 726f  ef timestamp_fro
+00025790: 6d5f 7061 7274 7328 2a61 7267 732c 202a  m_parts(*args, *
+000257a0: 2a6b 7761 7267 7329 202d 3e20 436f 6c75  *kwargs) -> Colu
+000257b0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000257c0: 4372 6561 7465 7320 6120 7469 6d65 7374  Creates a timest
+000257d0: 616d 7020 6672 6f6d 2069 6e64 6976 6964  amp from individ
+000257e0: 7561 6c20 6e75 6d65 7269 6320 636f 6d70  ual numeric comp
+000257f0: 6f6e 656e 7473 2e20 4966 206e 6f20 7469  onents. If no ti
+00025800: 6d65 207a 6f6e 6520 6973 2069 6e20 6566  me zone is in ef
+00025810: 6665 6374 2c0a 2020 2020 7468 6520 6675  fect,.    the fu
+00025820: 6e63 7469 6f6e 2063 616e 2062 6520 7573  nction can be us
+00025830: 6564 2074 6f20 6372 6561 7465 2061 2074  ed to create a t
+00025840: 696d 6573 7461 6d70 2066 726f 6d20 6120  imestamp from a 
+00025850: 6461 7465 2065 7870 7265 7373 696f 6e20  date expression 
+00025860: 616e 6420 6120 7469 6d65 2065 7870 7265  and a time expre
+00025870: 7373 696f 6e2e 0a0a 2020 2020 4578 616d  ssion...    Exam
+00025880: 706c 6520 313a 3a0a 0a20 2020 2020 2020  ple 1::..       
+00025890: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000258a0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000258b0: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+000258c0: 2020 2020 5b5b 3230 3232 2c20 342c 2031      [[2022, 4, 1
+000258d0: 2c20 3131 2c20 3131 2c20 305d 2c20 5b32  , 11, 11, 0], [2
+000258e0: 3032 322c 2033 2c20 3331 2c20 3131 2c20  022, 3, 31, 11, 
+000258f0: 3131 2c20 305d 5d2c 0a20 2020 2020 2020  11, 0]],.       
+00025900: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00025910: 5b22 7965 6172 222c 2022 6d6f 6e74 6822  ["year", "month"
+00025920: 2c20 2264 6179 222c 2022 686f 7572 222c  , "day", "hour",
+00025930: 2022 6d69 6e75 7465 222c 2022 7365 636f   "minute", "seco
+00025940: 6e64 225d 2c0a 2020 2020 2020 2020 2e2e  nd"],.        ..
+00025950: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+00025960: 6466 2e73 656c 6563 7428 7469 6d65 7374  df.select(timest
+00025970: 616d 705f 6672 6f6d 5f70 6172 7473 280a  amp_from_parts(.
+00025980: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00025990: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
+000259a0: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
+000259b0: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+000259c0: 6422 0a20 2020 2020 2020 202e 2e2e 2029  d".        ... )
+000259d0: 2e61 6c69 6173 2822 5449 4d45 5354 414d  .alias("TIMESTAM
+000259e0: 505f 4652 4f4d 5f50 4152 5453 2229 292e  P_FROM_PARTS")).
+000259f0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00025a00: 2020 5b52 6f77 2854 494d 4553 5441 4d50    [Row(TIMESTAMP
+00025a10: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+00025a20: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+00025a30: 3232 2c20 342c 2031 2c20 3131 2c20 3131  22, 4, 1, 11, 11
+00025a40: 2929 2c20 526f 7728 5449 4d45 5354 414d  )), Row(TIMESTAM
+00025a50: 505f 4652 4f4d 5f50 4152 5453 3d64 6174  P_FROM_PARTS=dat
+00025a60: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00025a70: 3032 322c 2033 2c20 3331 2c20 3131 2c20  022, 3, 31, 11, 
+00025a80: 3131 2929 5d0a 0a20 2020 2045 7861 6d70  11))]..    Examp
+00025a90: 6c65 2032 3a3a 0a0a 2020 2020 2020 2020  le 2::..        
+00025aa0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00025ab0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00025ac0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+00025ad0: 2020 205b 5b27 3230 3232 2d30 342d 3031     [['2022-04-01
+00025ae0: 272c 2027 3131 3a31 313a 3030 275d 2c20  ', '11:11:00'], 
+00025af0: 5b27 3230 3232 2d30 332d 3331 272c 2027  ['2022-03-31', '
+00025b00: 3131 3a31 313a 3030 275d 5d2c 0a20 2020  11:11:00']],.   
+00025b10: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
+00025b20: 656d 613d 5b22 6461 7465 222c 2022 7469  ema=["date", "ti
+00025b30: 6d65 225d 0a20 2020 2020 2020 202e 2e2e  me"].        ...
+00025b40: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00025b50: 662e 7365 6c65 6374 280a 2020 2020 2020  f.select(.      
+00025b60: 2020 2e2e 2e20 2020 2020 7469 6d65 7374    ...     timest
+00025b70: 616d 705f 6672 6f6d 5f70 6172 7473 2874  amp_from_parts(t
+00025b80: 6f5f 6461 7465 2822 6461 7465 2229 2c20  o_date("date"), 
+00025b90: 746f 5f74 696d 6528 2274 696d 6522 290a  to_time("time").
+00025ba0: 2020 2020 2020 2020 2e2e 2e20 292e 616c          ... ).al
+00025bb0: 6961 7328 2254 494d 4553 5441 4d50 5f46  ias("TIMESTAMP_F
+00025bc0: 524f 4d5f 5041 5254 5322 2929 2e63 6f6c  ROM_PARTS")).col
+00025bd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00025be0: 526f 7728 5449 4d45 5354 414d 505f 4652  Row(TIMESTAMP_FR
+00025bf0: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
+00025c00: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
+00025c10: 2034 2c20 312c 2031 312c 2031 3129 292c   4, 1, 11, 11)),
+00025c20: 2052 6f77 2854 494d 4553 5441 4d50 5f46   Row(TIMESTAMP_F
+00025c30: 524f 4d5f 5041 5254 533d 6461 7465 7469  ROM_PARTS=dateti
+00025c40: 6d65 2e64 6174 6574 696d 6528 3230 3232  me.datetime(2022
+00025c50: 2c20 332c 2033 312c 2031 312c 2031 3129  , 3, 31, 11, 11)
+00025c60: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+00025c70: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+00025c80: 696d 6573 7461 6d70 5f66 726f 6d5f 7061  imestamp_from_pa
+00025c90: 7274 7322 2928 0a20 2020 2020 2020 202a  rts")(.        *
+00025ca0: 5f74 696d 6573 7461 6d70 5f66 726f 6d5f  _timestamp_from_
+00025cb0: 7061 7274 735f 696e 7465 726e 616c 2822  parts_internal("
+00025cc0: 7469 6d65 7374 616d 705f 6672 6f6d 5f70  timestamp_from_p
+00025cd0: 6172 7473 222c 202a 6172 6773 2c20 2a2a  arts", *args, **
+00025ce0: 6b77 6172 6773 290a 2020 2020 290a 0a0a  kwargs).    )...
+00025cf0: 6465 6620 7469 6d65 7374 616d 705f 6c74  def timestamp_lt
+00025d00: 7a5f 6672 6f6d 5f70 6172 7473 280a 2020  z_from_parts(.  
+00025d10: 2020 7965 6172 3a20 556e 696f 6e5b 436f    year: Union[Co
+00025d20: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00025d30: 2c0a 2020 2020 6d6f 6e74 683a 2055 6e69  ,.    month: Uni
+00025d40: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00025d50: 2069 6e74 5d2c 0a20 2020 2064 6179 3a20   int],.    day: 
+00025d60: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00025d70: 6d65 2c20 696e 745d 2c0a 2020 2020 686f  me, int],.    ho
+00025d80: 7572 3a20 556e 696f 6e5b 436f 6c75 6d6e  ur: Union[Column
+00025d90: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
+00025da0: 2020 6d69 6e75 7465 3a20 556e 696f 6e5b    minute: Union[
+00025db0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+00025dc0: 745d 2c0a 2020 2020 7365 636f 6e64 3a20  t],.    second: 
+00025dd0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00025de0: 6d65 2c20 696e 745d 2c0a 2020 2020 6e61  me, int],.    na
+00025df0: 6e6f 7365 636f 6e64 733a 204f 7074 696f  noseconds: Optio
+00025e00: 6e61 6c5b 556e 696f 6e5b 436f 6c75 6d6e  nal[Union[Column
+00025e10: 4f72 4e61 6d65 2c20 696e 745d 5d20 3d20  OrName, int]] = 
+00025e20: 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c 756d  None,.) -> Colum
+00025e30: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
+00025e40: 7265 6174 6573 2061 2074 696d 6573 7461  reates a timesta
+00025e50: 6d70 2066 726f 6d20 696e 6469 7669 6475  mp from individu
+00025e60: 616c 206e 756d 6572 6963 2063 6f6d 706f  al numeric compo
+00025e70: 6e65 6e74 732e 0a0a 2020 2020 4578 616d  nents...    Exam
+00025e80: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00025e90: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00025ea0: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00025eb0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00025ec0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+00025ed0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+00025ee0: 3230 3232 2c20 342c 2031 2c20 3131 2c20  2022, 4, 1, 11, 
+00025ef0: 3131 2c20 305d 2c20 5b32 3032 322c 2033  11, 0], [2022, 3
+00025f00: 2c20 3331 2c20 3131 2c20 3131 2c20 305d  , 31, 11, 11, 0]
+00025f10: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00025f20: 2020 2073 6368 656d 613d 5b22 7965 6172     schema=["year
+00025f30: 222c 2022 6d6f 6e74 6822 2c20 2264 6179  ", "month", "day
+00025f40: 222c 2022 686f 7572 222c 2022 6d69 6e75  ", "hour", "minu
+00025f50: 7465 222c 2022 7365 636f 6e64 225d 2c0a  te", "second"],.
+00025f60: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+00025f70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00025f80: 6563 7428 7469 6d65 7374 616d 705f 6c74  ect(timestamp_lt
+00025f90: 7a5f 6672 6f6d 5f70 6172 7473 280a 2020  z_from_parts(.  
+00025fa0: 2020 2020 2020 2e2e 2e20 2020 2020 2279        ...     "y
+00025fb0: 6561 7222 2c20 226d 6f6e 7468 222c 2022  ear", "month", "
+00025fc0: 6461 7922 2c20 2268 6f75 7222 2c20 226d  day", "hour", "m
+00025fd0: 696e 7574 6522 2c20 2273 6563 6f6e 6422  inute", "second"
+00025fe0: 0a20 2020 2020 2020 202e 2e2e 2029 2e61  .        ... ).a
+00025ff0: 6c69 6173 2822 5449 4d45 5354 414d 505f  lias("TIMESTAMP_
+00026000: 4c54 5a5f 4652 4f4d 5f50 4152 5453 2229  LTZ_FROM_PARTS")
+00026010: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00026020: 2020 2020 5b52 6f77 2854 494d 4553 5441      [Row(TIMESTA
+00026030: 4d50 5f4c 545a 5f46 524f 4d5f 5041 5254  MP_LTZ_FROM_PART
+00026040: 533d 6461 7465 7469 6d65 2e64 6174 6574  S=datetime.datet
+00026050: 696d 6528 3230 3232 2c20 342c 2031 2c20  ime(2022, 4, 1, 
+00026060: 3131 2c20 3131 2c20 747a 696e 666f 3d3c  11, 11, tzinfo=<
+00026070: 4473 7454 7a49 6e66 6f20 2741 6d65 7269  DstTzInfo 'Ameri
+00026080: 6361 2f4c 6f73 5f41 6e67 656c 6573 2720  ca/Los_Angeles' 
+00026090: 5044 542d 3120 6461 792c 2031 373a 3030  PDT-1 day, 17:00
+000260a0: 3a30 3020 4453 543e 2929 2c20 526f 7728  :00 DST>)), Row(
+000260b0: 5449 4d45 5354 414d 505f 4c54 5a5f 4652  TIMESTAMP_LTZ_FR
+000260c0: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
+000260d0: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
+000260e0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
+000260f0: 747a 696e 666f 3d3c 4473 7454 7a49 6e66  tzinfo=<DstTzInf
+00026100: 6f20 2741 6d65 7269 6361 2f4c 6f73 5f41  o 'America/Los_A
+00026110: 6e67 656c 6573 2720 5044 542d 3120 6461  ngeles' PDT-1 da
+00026120: 792c 2031 373a 3030 3a30 3020 4453 543e  y, 17:00:00 DST>
+00026130: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
+00026140: 6675 6e63 5f6e 616d 6520 3d20 2274 696d  func_name = "tim
+00026150: 6573 7461 6d70 5f6c 747a 5f66 726f 6d5f  estamp_ltz_from_
+00026160: 7061 7274 7322 0a20 2020 2079 2c20 6d2c  parts".    y, m,
+00026170: 2064 2c20 682c 206d 696e 5f2c 2073 203d   d, h, min_, s =
+00026180: 205f 636f 6c75 6d6e 735f 6672 6f6d 5f74   _columns_from_t
+00026190: 696d 6573 7461 6d70 5f70 6172 7473 280a  imestamp_parts(.
+000261a0: 2020 2020 2020 2020 6675 6e63 5f6e 616d          func_nam
+000261b0: 652c 2079 6561 722c 206d 6f6e 7468 2c20  e, year, month, 
+000261c0: 6461 792c 2068 6f75 722c 206d 696e 7574  day, hour, minut
+000261d0: 652c 2073 6563 6f6e 640a 2020 2020 290a  e, second.    ).
+000261e0: 2020 2020 6e73 203d 204e 6f6e 6520 6966      ns = None if
+000261f0: 206e 616e 6f73 6563 6f6e 6473 2069 7320   nanoseconds is 
+00026200: 4e6f 6e65 2065 6c73 6520 5f74 6f5f 636f  None else _to_co
+00026210: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
+00026220: 6e61 6e6f 7365 636f 6e64 732c 2066 756e  nanoseconds, fun
+00026230: 635f 6e61 6d65 290a 2020 2020 7265 7475  c_name).    retu
+00026240: 726e 2028 0a20 2020 2020 2020 2062 7569  rn (.        bui
+00026250: 6c74 696e 2866 756e 635f 6e61 6d65 2928  ltin(func_name)(
+00026260: 792c 206d 2c20 642c 2068 2c20 6d69 6e5f  y, m, d, h, min_
+00026270: 2c20 7329 0a20 2020 2020 2020 2069 6620  , s).        if 
+00026280: 6e73 2069 7320 4e6f 6e65 0a20 2020 2020  ns is None.     
+00026290: 2020 2065 6c73 6520 6275 696c 7469 6e28     else builtin(
+000262a0: 6675 6e63 5f6e 616d 6529 2879 2c20 6d2c  func_name)(y, m,
+000262b0: 2064 2c20 682c 206d 696e 5f2c 2073 2c20   d, h, min_, s, 
+000262c0: 6e73 290a 2020 2020 290a 0a0a 406f 7665  ns).    )...@ove
+000262d0: 726c 6f61 640a 6465 6620 7469 6d65 7374  rload.def timest
+000262e0: 616d 705f 6e74 7a5f 6672 6f6d 5f70 6172  amp_ntz_from_par
+000262f0: 7473 280a 2020 2020 6461 7465 5f65 7870  ts(.    date_exp
+00026300: 723a 2043 6f6c 756d 6e4f 724e 616d 652c  r: ColumnOrName,
+00026310: 2074 696d 655f 6578 7072 3a20 436f 6c75   time_expr: Colu
+00026320: 6d6e 4f72 4e61 6d65 0a29 202d 3e20 436f  mnOrName.) -> Co
+00026330: 6c75 6d6e 3a0a 2020 2020 2e2e 2e20 2023  lumn:.    ...  #
+00026340: 2070 7261 676d 613a 206e 6f20 636f 7665   pragma: no cove
+00026350: 720a 0a0a 406f 7665 726c 6f61 640a 6465  r...@overload.de
+00026360: 6620 7469 6d65 7374 616d 705f 6e74 7a5f  f timestamp_ntz_
+00026370: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
+00026380: 7965 6172 3a20 556e 696f 6e5b 436f 6c75  year: Union[Colu
+00026390: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+000263a0: 2020 2020 6d6f 6e74 683a 2055 6e69 6f6e      month: Union
+000263b0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+000263c0: 6e74 5d2c 0a20 2020 2064 6179 3a20 556e  nt],.    day: Un
+000263d0: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+000263e0: 2c20 696e 745d 2c0a 2020 2020 686f 7572  , int],.    hour
+000263f0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+00026400: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+00026410: 6d69 6e75 7465 3a20 556e 696f 6e5b 436f  minute: Union[Co
+00026420: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00026430: 2c0a 2020 2020 7365 636f 6e64 3a20 556e  ,.    second: Un
+00026440: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+00026450: 2c20 696e 745d 2c0a 2020 2020 6e61 6e6f  , int],.    nano
+00026460: 7365 636f 6e64 3a20 4f70 7469 6f6e 616c  second: Optional
+00026470: 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f 724e  [Union[ColumnOrN
+00026480: 616d 652c 2069 6e74 5d5d 203d 204e 6f6e  ame, int]] = Non
+00026490: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
+000264a0: 2020 2020 2e2e 2e20 2023 2070 7261 676d      ...  # pragm
+000264b0: 613a 206e 6f20 636f 7665 720a 0a0a 6465  a: no cover...de
+000264c0: 6620 7469 6d65 7374 616d 705f 6e74 7a5f  f timestamp_ntz_
+000264d0: 6672 6f6d 5f70 6172 7473 282a 6172 6773  from_parts(*args
+000264e0: 2c20 2a2a 6b77 6172 6773 2920 2d3e 2043  , **kwargs) -> C
+000264f0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00026500: 2020 2043 7265 6174 6573 2061 2074 696d     Creates a tim
+00026510: 6573 7461 6d70 2066 726f 6d20 696e 6469  estamp from indi
+00026520: 7669 6475 616c 206e 756d 6572 6963 2063  vidual numeric c
+00026530: 6f6d 706f 6e65 6e74 732e 2054 6865 2066  omponents. The f
+00026540: 756e 6374 696f 6e20 6361 6e20 6265 2075  unction can be u
+00026550: 7365 6420 746f 0a20 2020 2063 7265 6174  sed to.    creat
+00026560: 6520 6120 7469 6d65 7374 616d 7020 6672  e a timestamp fr
+00026570: 6f6d 2061 2064 6174 6520 6578 7072 6573  om a date expres
+00026580: 7369 6f6e 2061 6e64 2061 2074 696d 6520  sion and a time 
+00026590: 6578 7072 6573 7369 6f6e 2e0a 0a20 2020  expression...   
+000265a0: 2045 7861 6d70 6c65 2031 3a3a 0a0a 2020   Example 1::..  
+000265b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000265c0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000265d0: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+000265e0: 202e 2e2e 2020 2020 205b 5b32 3032 322c   ...     [[2022,
+000265f0: 2034 2c20 312c 2031 312c 2031 312c 2030   4, 1, 11, 11, 0
+00026600: 5d2c 205b 3230 3232 2c20 332c 2033 312c  ], [2022, 3, 31,
+00026610: 2031 312c 2031 312c 2030 5d5d 2c0a 2020   11, 11, 0]],.  
+00026620: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+00026630: 6865 6d61 3d5b 2279 6561 7222 2c20 226d  hema=["year", "m
+00026640: 6f6e 7468 222c 2022 6461 7922 2c20 2268  onth", "day", "h
+00026650: 6f75 7222 2c20 226d 696e 7574 6522 2c20  our", "minute", 
+00026660: 2273 6563 6f6e 6422 5d2c 0a20 2020 2020  "second"],.     
+00026670: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
+00026680: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
+00026690: 696d 6573 7461 6d70 5f6e 747a 5f66 726f  imestamp_ntz_fro
+000266a0: 6d5f 7061 7274 7328 0a20 2020 2020 2020  m_parts(.       
+000266b0: 202e 2e2e 2020 2020 2022 7965 6172 222c   ...     "year",
+000266c0: 2022 6d6f 6e74 6822 2c20 2264 6179 222c   "month", "day",
+000266d0: 2022 686f 7572 222c 2022 6d69 6e75 7465   "hour", "minute
+000266e0: 222c 2022 7365 636f 6e64 220a 2020 2020  ", "second".    
+000266f0: 2020 2020 2e2e 2e20 292e 616c 6961 7328      ... ).alias(
+00026700: 2254 494d 4553 5441 4d50 5f4e 545a 5f46  "TIMESTAMP_NTZ_F
+00026710: 524f 4d5f 5041 5254 5322 2929 2e63 6f6c  ROM_PARTS")).col
+00026720: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00026730: 526f 7728 5449 4d45 5354 414d 505f 4e54  Row(TIMESTAMP_NT
+00026740: 5a5f 4652 4f4d 5f50 4152 5453 3d64 6174  Z_FROM_PARTS=dat
+00026750: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00026760: 3032 322c 2034 2c20 312c 2031 312c 2031  022, 4, 1, 11, 1
+00026770: 3129 292c 2052 6f77 2854 494d 4553 5441  1)), Row(TIMESTA
+00026780: 4d50 5f4e 545a 5f46 524f 4d5f 5041 5254  MP_NTZ_FROM_PART
+00026790: 533d 6461 7465 7469 6d65 2e64 6174 6574  S=datetime.datet
+000267a0: 696d 6528 3230 3232 2c20 332c 2033 312c  ime(2022, 3, 31,
+000267b0: 2031 312c 2031 3129 295d 0a0a 2020 2020   11, 11))]..    
+000267c0: 4578 616d 706c 6520 323a 3a0a 0a20 2020  Example 2::..   
+000267d0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000267e0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000267f0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00026800: 2e2e 2e20 2020 2020 5b5b 2732 3032 322d  ...     [['2022-
+00026810: 3034 2d30 3127 2c20 2731 313a 3131 3a30  04-01', '11:11:0
+00026820: 3027 5d2c 205b 2732 3032 322d 3033 2d33  0'], ['2022-03-3
+00026830: 3127 2c20 2731 313a 3131 3a30 3027 5d5d  1', '11:11:00']]
+00026840: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00026850: 2020 7363 6865 6d61 3d5b 2264 6174 6522    schema=["date"
+00026860: 2c20 2274 696d 6522 5d0a 2020 2020 2020  , "time"].      
+00026870: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+00026880: 3e3e 3e20 6466 2e73 656c 6563 7428 0a20  >>> df.select(. 
+00026890: 2020 2020 2020 202e 2e2e 2020 2020 2074         ...     t
+000268a0: 696d 6573 7461 6d70 5f6e 747a 5f66 726f  imestamp_ntz_fro
+000268b0: 6d5f 7061 7274 7328 746f 5f64 6174 6528  m_parts(to_date(
+000268c0: 2264 6174 6522 292c 2074 6f5f 7469 6d65  "date"), to_time
+000268d0: 2822 7469 6d65 2229 0a20 2020 2020 2020  ("time").       
+000268e0: 202e 2e2e 2029 2e61 6c69 6173 2822 5449   ... ).alias("TI
+000268f0: 4d45 5354 414d 505f 4e54 5a5f 4652 4f4d  MESTAMP_NTZ_FROM
+00026900: 5f50 4152 5453 2229 292e 636f 6c6c 6563  _PARTS")).collec
+00026910: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00026920: 2854 494d 4553 5441 4d50 5f4e 545a 5f46  (TIMESTAMP_NTZ_F
+00026930: 524f 4d5f 5041 5254 533d 6461 7465 7469  ROM_PARTS=dateti
+00026940: 6d65 2e64 6174 6574 696d 6528 3230 3232  me.datetime(2022
+00026950: 2c20 342c 2031 2c20 3131 2c20 3131 2929  , 4, 1, 11, 11))
+00026960: 2c20 526f 7728 5449 4d45 5354 414d 505f  , Row(TIMESTAMP_
+00026970: 4e54 5a5f 4652 4f4d 5f50 4152 5453 3d64  NTZ_FROM_PARTS=d
+00026980: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+00026990: 2832 3032 322c 2033 2c20 3331 2c20 3131  (2022, 3, 31, 11
+000269a0: 2c20 3131 2929 5d0a 2020 2020 2222 220a  , 11))].    """.
+000269b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000269c0: 696e 2822 7469 6d65 7374 616d 705f 6e74  in("timestamp_nt
+000269d0: 7a5f 6672 6f6d 5f70 6172 7473 2229 280a  z_from_parts")(.
+000269e0: 2020 2020 2020 2020 2a5f 7469 6d65 7374          *_timest
+000269f0: 616d 705f 6672 6f6d 5f70 6172 7473 5f69  amp_from_parts_i
+00026a00: 6e74 6572 6e61 6c28 2274 696d 6573 7461  nternal("timesta
+00026a10: 6d70 5f6e 747a 5f66 726f 6d5f 7061 7274  mp_ntz_from_part
+00026a20: 7322 2c20 2a61 7267 732c 202a 2a6b 7761  s", *args, **kwa
+00026a30: 7267 7329 0a20 2020 2029 0a0a 0a64 6566  rgs).    )...def
+00026a40: 2074 696d 6573 7461 6d70 5f74 7a5f 6672   timestamp_tz_fr
+00026a50: 6f6d 5f70 6172 7473 280a 2020 2020 7965  om_parts(.    ye
+00026a60: 6172 3a20 556e 696f 6e5b 436f 6c75 6d6e  ar: Union[Column
+00026a70: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
+00026a80: 2020 6d6f 6e74 683a 2055 6e69 6f6e 5b43    month: Union[C
+00026a90: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+00026aa0: 5d2c 0a20 2020 2064 6179 3a20 556e 696f  ],.    day: Unio
+00026ab0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00026ac0: 696e 745d 2c0a 2020 2020 686f 7572 3a20  int],.    hour: 
+00026ad0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00026ae0: 6d65 2c20 696e 745d 2c0a 2020 2020 6d69  me, int],.    mi
+00026af0: 6e75 7465 3a20 556e 696f 6e5b 436f 6c75  nute: Union[Colu
+00026b00: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
+00026b10: 2020 2020 7365 636f 6e64 3a20 556e 696f      second: Unio
+00026b20: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00026b30: 696e 745d 2c0a 2020 2020 6e61 6e6f 7365  int],.    nanose
+00026b40: 636f 6e64 733a 204f 7074 696f 6e61 6c5b  conds: Optional[
+00026b50: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00026b60: 6d65 2c20 696e 745d 5d20 3d20 4e6f 6e65  me, int]] = None
+00026b70: 2c0a 2020 2020 7469 6d65 7a6f 6e65 3a20  ,.    timezone: 
+00026b80: 4f70 7469 6f6e 616c 5b43 6f6c 756d 6e4f  Optional[ColumnO
+00026b90: 724c 6974 6572 616c 5374 725d 203d 204e  rLiteralStr] = N
+00026ba0: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
+00026bb0: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
+00026bc0: 6561 7465 7320 6120 7469 6d65 7374 616d  eates a timestam
+00026bd0: 7020 6672 6f6d 2069 6e64 6976 6964 7561  p from individua
+00026be0: 6c20 6e75 6d65 7269 6320 636f 6d70 6f6e  l numeric compon
+00026bf0: 656e 7473 2061 6e64 2061 2073 7472 696e  ents and a strin
+00026c00: 6720 7469 6d65 7a6f 6e65 2e0a 0a20 2020  g timezone...   
+00026c10: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00026c20: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00026c30: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00026c40: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+00026c50: 2e2e 2020 2020 205b 5b32 3032 322c 2034  ..     [[2022, 4
+00026c60: 2c20 312c 2031 312c 2031 312c 2030 2c20  , 1, 11, 11, 0, 
+00026c70: 2741 6d65 7269 6361 2f4c 6f73 5f41 6e67  'America/Los_Ang
+00026c80: 656c 6573 275d 2c20 5b32 3032 322c 2033  eles'], [2022, 3
+00026c90: 2c20 3331 2c20 3131 2c20 3131 2c20 302c  , 31, 11, 11, 0,
+00026ca0: 2027 416d 6572 6963 612f 4c6f 735f 416e   'America/Los_An
+00026cb0: 6765 6c65 7327 5d5d 2c0a 2020 2020 2020  geles']],.      
+00026cc0: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
+00026cd0: 3d5b 2279 6561 7222 2c20 226d 6f6e 7468  =["year", "month
+00026ce0: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
+00026cf0: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
+00026d00: 6f6e 6422 2c20 2274 696d 657a 6f6e 6522  ond", "timezone"
+00026d10: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+00026d20: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00026d30: 7365 6c65 6374 2874 696d 6573 7461 6d70  select(timestamp
+00026d40: 5f74 7a5f 6672 6f6d 5f70 6172 7473 280a  _tz_from_parts(.
+00026d50: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00026d60: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
+00026d70: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
+00026d80: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+00026d90: 6422 2c20 7469 6d65 7a6f 6e65 3d22 7469  d", timezone="ti
+00026da0: 6d65 7a6f 6e65 220a 2020 2020 2020 2020  mezone".        
+00026db0: 2e2e 2e20 292e 616c 6961 7328 2254 494d  ... ).alias("TIM
+00026dc0: 4553 5441 4d50 5f54 5a5f 4652 4f4d 5f50  ESTAMP_TZ_FROM_P
+00026dd0: 4152 5453 2229 292e 636f 6c6c 6563 7428  ARTS")).collect(
+00026de0: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
+00026df0: 494d 4553 5441 4d50 5f54 5a5f 4652 4f4d  IMESTAMP_TZ_FROM
+00026e00: 5f50 4152 5453 3d64 6174 6574 696d 652e  _PARTS=datetime.
+00026e10: 6461 7465 7469 6d65 2832 3032 322c 2034  datetime(2022, 4
+00026e20: 2c20 312c 2031 312c 2031 312c 2074 7a69  , 1, 11, 11, tzi
+00026e30: 6e66 6f3d 7079 747a 2e46 6978 6564 4f66  nfo=pytz.FixedOf
+00026e40: 6673 6574 282d 3432 3029 2929 2c20 526f  fset(-420))), Ro
+00026e50: 7728 5449 4d45 5354 414d 505f 545a 5f46  w(TIMESTAMP_TZ_F
+00026e60: 524f 4d5f 5041 5254 533d 6461 7465 7469  ROM_PARTS=dateti
+00026e70: 6d65 2e64 6174 6574 696d 6528 3230 3232  me.datetime(2022
+00026e80: 2c20 332c 2033 312c 2031 312c 2031 312c  , 3, 31, 11, 11,
+00026e90: 2074 7a69 6e66 6f3d 7079 747a 2e46 6978   tzinfo=pytz.Fix
+00026ea0: 6564 4f66 6673 6574 282d 3432 3029 2929  edOffset(-420)))
+00026eb0: 5d0a 2020 2020 2222 220a 2020 2020 6675  ].    """.    fu
+00026ec0: 6e63 5f6e 616d 6520 3d20 2274 696d 6573  nc_name = "times
+00026ed0: 7461 6d70 5f74 7a5f 6672 6f6d 5f70 6172  tamp_tz_from_par
+00026ee0: 7473 220a 2020 2020 792c 206d 2c20 642c  ts".    y, m, d,
+00026ef0: 2068 2c20 6d69 6e5f 2c20 7320 3d20 5f63   h, min_, s = _c
+00026f00: 6f6c 756d 6e73 5f66 726f 6d5f 7469 6d65  olumns_from_time
+00026f10: 7374 616d 705f 7061 7274 7328 0a20 2020  stamp_parts(.   
+00026f20: 2020 2020 2066 756e 635f 6e61 6d65 2c20       func_name, 
+00026f30: 7965 6172 2c20 6d6f 6e74 682c 2064 6179  year, month, day
+00026f40: 2c20 686f 7572 2c20 6d69 6e75 7465 2c20  , hour, minute, 
+00026f50: 7365 636f 6e64 0a20 2020 2029 0a20 2020  second.    ).   
+00026f60: 206e 7320 3d20 4e6f 6e65 2069 6620 6e61   ns = None if na
+00026f70: 6e6f 7365 636f 6e64 7320 6973 204e 6f6e  noseconds is Non
+00026f80: 6520 656c 7365 205f 746f 5f63 6f6c 5f69  e else _to_col_i
+00026f90: 665f 7374 725f 6f72 5f69 6e74 286e 616e  f_str_or_int(nan
+00026fa0: 6f73 6563 6f6e 6473 2c20 6675 6e63 5f6e  oseconds, func_n
+00026fb0: 616d 6529 0a20 2020 2074 7a20 3d20 4e6f  ame).    tz = No
+00026fc0: 6e65 2069 6620 7469 6d65 7a6f 6e65 2069  ne if timezone i
+00026fd0: 7320 4e6f 6e65 2065 6c73 6520 5f74 6f5f  s None else _to_
+00026fe0: 636f 6c5f 6966 5f73 716c 5f65 7870 7228  col_if_sql_expr(
+00026ff0: 7469 6d65 7a6f 6e65 2c20 6675 6e63 5f6e  timezone, func_n
+00027000: 616d 6529 0a20 2020 2069 6620 6e61 6e6f  ame).    if nano
+00027010: 7365 636f 6e64 7320 6973 206e 6f74 204e  seconds is not N
+00027020: 6f6e 6520 616e 6420 7469 6d65 7a6f 6e65  one and timezone
+00027030: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00027040: 2020 2020 2020 7265 7475 726e 2062 7569        return bui
+00027050: 6c74 696e 2866 756e 635f 6e61 6d65 2928  ltin(func_name)(
+00027060: 792c 206d 2c20 642c 2068 2c20 6d69 6e5f  y, m, d, h, min_
+00027070: 2c20 732c 206e 732c 2074 7a29 0a20 2020  , s, ns, tz).   
+00027080: 2065 6c69 6620 6e61 6e6f 7365 636f 6e64   elif nanosecond
+00027090: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+000270a0: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
+000270b0: 696c 7469 6e28 6675 6e63 5f6e 616d 6529  iltin(func_name)
+000270c0: 2879 2c20 6d2c 2064 2c20 682c 206d 696e  (y, m, d, h, min
+000270d0: 5f2c 2073 2c20 6e73 290a 2020 2020 656c  _, s, ns).    el
+000270e0: 6966 2074 696d 657a 6f6e 6520 6973 206e  if timezone is n
+000270f0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00027100: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00027110: 6675 6e63 5f6e 616d 6529 2879 2c20 6d2c  func_name)(y, m,
+00027120: 2064 2c20 682c 206d 696e 5f2c 2073 2c20   d, h, min_, s, 
+00027130: 6c69 7428 3029 2c20 747a 290a 2020 2020  lit(0), tz).    
+00027140: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+00027150: 7475 726e 2062 7569 6c74 696e 2866 756e  turn builtin(fun
+00027160: 635f 6e61 6d65 2928 792c 206d 2c20 642c  c_name)(y, m, d,
+00027170: 2068 2c20 6d69 6e5f 2c20 7329 0a0a 0a64   h, min_, s)...d
+00027180: 6566 2077 6565 6b6f 6679 6561 7228 653a  ef weekofyear(e:
+00027190: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000271a0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000271b0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+000271c0: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+000271d0: 2077 6565 6b20 286e 756d 6265 7229 206f   week (number) o
+000271e0: 6620 7468 6520 7965 6172 2066 726f 6d20  f the year from 
+000271f0: 6120 6461 7465 206f 7220 7469 6d65 7374  a date or timest
+00027200: 616d 702e 0a0a 2020 2020 4578 616d 706c  amp...    Exampl
+00027210: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00027220: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+00027230: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00027240: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00027250: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
+00027260: 2020 2020 2e2e 2e20 2020 2020 5b5b 6461      ...     [[da
+00027270: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+00027280: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+00027290: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
+000272a0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+000272b0: 3a25 4d3a 2553 2e25 6622 295d 5d2c 0a20  :%M:%S.%f")]],. 
+000272c0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+000272d0: 6368 656d 613d 5b22 6122 5d2c 0a20 2020  chema=["a"],.   
+000272e0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+000272f0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00027300: 2877 6565 6b6f 6679 6561 7228 2261 2229  (weekofyear("a")
+00027310: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00027320: 2020 2020 5b52 6f77 2857 4545 4b4f 4659      [Row(WEEKOFY
+00027330: 4541 5228 2241 2229 3d31 3829 5d0a 2020  EAR("A")=18)].  
+00027340: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00027350: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00027360: 2277 6565 6b6f 6679 6561 7222 290a 2020  "weekofyear").  
+00027370: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00027380: 2822 7765 656b 6f66 7965 6172 2229 2863  ("weekofyear")(c
+00027390: 290a 0a0a 6465 6620 7479 7065 6f66 2863  )...def typeof(c
+000273a0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+000273b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000273c0: 2022 2222 5265 706f 7274 7320 7468 6520   """Reports the 
+000273d0: 7479 7065 206f 6620 6120 7661 6c75 6520  type of a value 
+000273e0: 7374 6f72 6564 2069 6e20 6120 5641 5249  stored in a VARI
+000273f0: 414e 5420 636f 6c75 6d6e 2e20 5468 6520  ANT column. The 
+00027400: 7479 7065 2069 7320 7265 7475 726e 6564  type is returned
+00027410: 2061 7320 6120 7374 7269 6e67 2e0a 0a20   as a string... 
+00027420: 2020 2046 6f72 2063 6f6c 756d 6e73 2077     For columns w
+00027430: 6865 7265 2061 6c6c 2072 6f77 7320 7368  here all rows sh
+00027440: 6172 6520 7468 6520 7361 6d65 2074 7970  are the same typ
+00027450: 652c 2074 6865 2072 6573 756c 7420 6f66  e, the result of
+00027460: 2060 7479 7065 6f66 6020 6973 2074 6865   `typeof` is the
+00027470: 2075 6e64 6572 6c79 696e 6720 536e 6f77   underlying Snow
+00027480: 666c 616b 6520 636f 6c75 6d6e 2074 7970  flake column typ
+00027490: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
+000274a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+000274b0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000274c0: 7465 5f64 6174 6166 7261 6d65 285b 312c  te_dataframe([1,
+000274d0: 2032 2c20 335d 2c20 7363 6865 6d61 3d5b   2, 3], schema=[
+000274e0: 2241 225d 290a 2020 2020 2020 2020 3e3e  "A"]).        >>
+000274f0: 3e20 6466 2e73 656c 6563 7428 7479 7065  > df.select(type
+00027500: 6f66 2863 6f6c 2822 4122 2929 2e61 735f  of(col("A")).as_
+00027510: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
+00027520: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00027530: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
+00027540: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
+00027550: 2729 2c20 526f 7728 414e 533d 2749 4e54  '), Row(ANS='INT
+00027560: 4547 4552 2729 5d0a 0a20 2020 2046 6f72  EGER')]..    For
+00027570: 2063 6f6c 756d 6e73 206f 6620 5641 5249   columns of VARI
+00027580: 414e 5420 7479 7065 2c20 7468 6520 756e  ANT type, the un
+00027590: 6465 726c 7969 6e67 2073 746f 7265 6420  derlying stored 
+000275a0: 7479 7065 2069 7320 7265 7475 726e 6564  type is returned
+000275b0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000275c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+000275d0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+000275e0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+000275f0: 7274 2056 6172 6961 6e74 5479 7065 2c20  rt VariantType, 
+00027600: 5374 7275 6374 5479 7065 2c20 5374 7275  StructType, Stru
+00027610: 6374 4669 656c 640a 2020 2020 2020 2020  ctField.        
+00027620: 3e3e 3e20 7363 6865 6d61 203d 2053 7472  >>> schema = Str
+00027630: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
+00027640: 6965 6c64 2822 4122 2c20 5661 7269 616e  ield("A", Varian
+00027650: 7454 7970 6528 2929 5d29 0a20 2020 2020  tType())]).     
+00027660: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00027670: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00027680: 7261 6d65 285b 312c 2033 2e31 2c20 2774  rame([1, 3.1, 't
+00027690: 6573 7427 5d2c 2073 6368 656d 613d 7363  est'], schema=sc
+000276a0: 6865 6d61 290a 2020 2020 2020 2020 3e3e  hema).        >>
+000276b0: 3e20 6466 2e73 656c 6563 7428 7479 7065  > df.select(type
+000276c0: 6f66 2863 6f6c 2822 4122 2929 2e61 735f  of(col("A")).as_
+000276d0: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
+000276e0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+000276f0: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
+00027700: 526f 7728 414e 533d 2744 4543 494d 414c  Row(ANS='DECIMAL
+00027710: 2729 2c20 526f 7728 414e 533d 2756 4152  '), Row(ANS='VAR
+00027720: 4348 4152 2729 5d0a 0a20 2020 2022 2222  CHAR')]..    """
+00027730: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00027740: 5f69 665f 7374 7228 636f 6c2c 2022 7479  _if_str(col, "ty
+00027750: 7065 6f66 2229 0a20 2020 2072 6574 7572  peof").    retur
+00027760: 6e20 6275 696c 7469 6e28 2274 7970 656f  n builtin("typeo
+00027770: 6622 2928 6329 0a0a 0a64 6566 2063 6865  f")(c)...def che
+00027780: 636b 5f6a 736f 6e28 636f 6c3a 2043 6f6c  ck_json(col: Col
+00027790: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000277a0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6865  lumn:.    """Che
+000277b0: 636b 7320 7468 6520 7661 6c69 6469 7479  cks the validity
+000277c0: 206f 6620 6120 4a53 4f4e 2064 6f63 756d   of a JSON docum
+000277d0: 656e 742e 0a20 2020 2049 6620 7468 6520  ent..    If the 
+000277e0: 696e 7075 7420 7374 7269 6e67 2069 7320  input string is 
+000277f0: 6120 7661 6c69 6420 4a53 4f4e 2064 6f63  a valid JSON doc
+00027800: 756d 656e 7420 6f72 2061 204e 554c 4c20  ument or a NULL 
+00027810: 2869 2e65 2e20 6e6f 2065 7272 6f72 2077  (i.e. no error w
+00027820: 6f75 6c64 206f 6363 7572 2077 6865 6e0a  ould occur when.
+00027830: 2020 2020 7061 7273 696e 6720 7468 6520      parsing the 
+00027840: 696e 7075 7420 7374 7269 6e67 292c 2074  input string), t
+00027850: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+00027860: 726e 7320 4e55 4c4c 2e0a 2020 2020 496e  rns NULL..    In
+00027870: 2063 6173 6520 6f66 2061 204a 534f 4e20   case of a JSON 
+00027880: 7061 7273 696e 6720 6572 726f 722c 2074  parsing error, t
+00027890: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+000278a0: 726e 7320 6120 7374 7269 6e67 2074 6861  rns a string tha
+000278b0: 7420 636f 6e74 6169 6e73 2074 6865 2065  t contains the e
+000278c0: 7272 6f72 0a20 2020 206d 6573 7361 6765  rror.    message
+000278d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000278e0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+000278f0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00027900: 655f 6461 7461 6672 616d 6528 5b22 7b27  e_dataframe(["{'
+00027910: 5661 6c69 644b 6579 3127 3a20 2756 616c  ValidKey1': 'Val
+00027920: 6964 5661 6c75 6531 277d 222c 2022 7b27  idValue1'}", "{'
+00027930: 4d61 6c66 6f72 6d65 6420 2d2d 206d 6973  Malformed -- mis
+00027940: 7369 6e67 2076 616c 273a 7d22 2c20 4e6f  sing val':}", No
+00027950: 6e65 5d2c 2073 6368 656d 613d 5b27 6127  ne], schema=['a'
+00027960: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00027970: 662e 7365 6c65 6374 2863 6865 636b 5f6a  f.select(check_j
+00027980: 736f 6e28 6466 2e61 2929 2e73 686f 7728  son(df.a)).show(
+00027990: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+000279a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000279b0: 2d0a 2020 2020 2020 2020 7c22 4348 4543  -.        |"CHEC
+000279c0: 4b5f 4a53 4f4e 2822 2241 2222 2922 2020  K_JSON(""A"")"  
+000279d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000279e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000279f0: 2d0a 2020 2020 2020 2020 7c4e 554c 4c20  -.        |NULL 
+00027a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a10: 7c0a 2020 2020 2020 2020 7c6d 6973 706c  |.        |mispl
+00027a20: 6163 6564 207d 2c20 706f 7320 3239 2020  aced }, pos 29  
+00027a30: 7c0a 2020 2020 2020 2020 7c4e 554c 4c20  |.        |NULL 
+00027a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a50: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00027a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027a70: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00027a80: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00027a90: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00027aa0: 5f73 7472 2863 6f6c 2c20 2263 6865 636b  _str(col, "check
+00027ab0: 5f6a 736f 6e22 290a 2020 2020 7265 7475  _json").    retu
+00027ac0: 726e 2062 7569 6c74 696e 2822 6368 6563  rn builtin("chec
+00027ad0: 6b5f 6a73 6f6e 2229 2863 290a 0a0a 6465  k_json")(c)...de
+00027ae0: 6620 6368 6563 6b5f 786d 6c28 636f 6c3a  f check_xml(col:
+00027af0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00027b00: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00027b10: 2243 6865 636b 7320 7468 6520 7661 6c69  "Checks the vali
+00027b20: 6469 7479 206f 6620 616e 2058 4d4c 2064  dity of an XML d
+00027b30: 6f63 756d 656e 742e 0a20 2020 2049 6620  ocument..    If 
+00027b40: 7468 6520 696e 7075 7420 7374 7269 6e67  the input string
+00027b50: 2069 7320 6120 7661 6c69 6420 584d 4c20   is a valid XML 
+00027b60: 646f 6375 6d65 6e74 206f 7220 6120 4e55  document or a NU
+00027b70: 4c4c 2028 692e 652e 206e 6f20 6572 726f  LL (i.e. no erro
+00027b80: 7220 776f 756c 6420 6f63 6375 7220 7768  r would occur wh
+00027b90: 656e 2070 6172 7369 6e67 0a20 2020 2074  en parsing.    t
+00027ba0: 6865 2069 6e70 7574 2073 7472 696e 6729  he input string)
+00027bb0: 2c20 7468 6520 6675 6e63 7469 6f6e 2072  , the function r
+00027bc0: 6574 7572 6e73 204e 554c 4c2e 0a20 2020  eturns NULL..   
+00027bd0: 2049 6e20 6361 7365 206f 6620 616e 2058   In case of an X
+00027be0: 4d4c 2070 6172 7369 6e67 2065 7272 6f72  ML parsing error
+00027bf0: 2c20 7468 6520 6f75 7470 7574 2073 7472  , the output str
+00027c00: 696e 6720 636f 6e74 6169 6e73 2074 6865  ing contains the
+00027c10: 2065 7272 6f72 206d 6573 7361 6765 2e0a   error message..
+00027c20: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00027c30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00027c40: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00027c50: 6461 7461 6672 616d 6528 5b22 3c6e 616d  dataframe(["<nam
+00027c60: 653e 2056 616c 6964 203c 2f6e 616d 653e  e> Valid </name>
+00027c70: 222c 2022 3c6e 616d 653e 2049 6e76 616c  ", "<name> Inval
+00027c80: 6964 203c 2f57 524f 4e47 5f43 4c4f 5349  id </WRONG_CLOSI
+00027c90: 4e47 5f54 4147 3e22 2c20 4e6f 6e65 5d2c  NG_TAG>", None],
+00027ca0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
+00027cb0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00027cc0: 6c65 6374 2863 6865 636b 5f78 6d6c 2864  lect(check_xml(d
+00027cd0: 662e 6129 292e 7368 6f77 2829 0a20 2020  f.a)).show().   
+00027ce0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00027cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027d10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00027d20: 207c 2243 4845 434b 5f58 4d4c 2822 2241   |"CHECK_XML(""A
+00027d30: 2222 2922 2020 2020 2020 2020 2020 2020  "")"            
+00027d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d50: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00027d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027d90: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
+00027da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027dc0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+00027dd0: 2020 2020 207c 6e6f 206f 7065 6e69 6e67       |no opening
+00027de0: 2074 6167 2066 6f72 203c 2f57 524f 4e47   tag for </WRONG
+00027df0: 5f43 4c4f 5349 4e47 5f54 4147 3e2c 2070  _CLOSING_TAG>, p
+00027e00: 6f73 2033 3520 207c 0a20 2020 2020 2020  os 35  |.       
+00027e10: 207c 4e55 4c4c 2020 2020 2020 2020 2020   |NULL          
+00027e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e40: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00027e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00027e80: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00027e90: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00027ea0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00027eb0: 7374 7228 636f 6c2c 2022 6368 6563 6b5f  str(col, "check_
+00027ec0: 786d 6c22 290a 2020 2020 7265 7475 726e  xml").    return
+00027ed0: 2062 7569 6c74 696e 2822 6368 6563 6b5f   builtin("check_
+00027ee0: 786d 6c22 2928 6329 0a0a 0a64 6566 206a  xml")(c)...def j
+00027ef0: 736f 6e5f 6578 7472 6163 745f 7061 7468  son_extract_path
+00027f00: 5f74 6578 7428 636f 6c3a 2043 6f6c 756d  _text(col: Colum
+00027f10: 6e4f 724e 616d 652c 2070 6174 683a 2043  nOrName, path: C
+00027f20: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00027f30: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00027f40: 2020 2020 5061 7273 6573 2061 204a 534f      Parses a JSO
+00027f50: 4e20 7374 7269 6e67 2061 6e64 2072 6574  N string and ret
+00027f60: 7572 6e73 2074 6865 2076 616c 7565 206f  urns the value o
+00027f70: 6620 616e 2065 6c65 6d65 6e74 2061 7420  f an element at 
+00027f80: 6120 7370 6563 6966 6965 6420 7061 7468  a specified path
+00027f90: 2069 6e20 7468 6520 7265 7375 6c74 696e   in the resultin
+00027fa0: 670a 2020 2020 4a53 4f4e 2064 6f63 756d  g.    JSON docum
+00027fb0: 656e 742e 0a0a 2020 2020 4578 616d 706c  ent...    Exampl
+00027fc0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00027fd0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+00027fe0: 736e 6f77 7061 726b 2e66 756e 6374 696f  snowpark.functio
+00027ff0: 6e73 2069 6d70 6f72 7420 6a73 6f6e 5f65  ns import json_e
+00028000: 7874 7261 6374 5f70 6174 685f 7465 7874  xtract_path_text
+00028010: 2c20 746f 5f76 6172 6961 6e74 0a20 2020  , to_variant.   
+00028020: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00028030: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00028040: 6166 7261 6d65 285b 5b7b 2261 223a 2022  aframe([[{"a": "
+00028050: 666f 6f22 7d2c 2022 6122 5d2c 205b 7b22  foo"}, "a"], [{"
+00028060: 6122 3a20 4e6f 6e65 7d2c 2022 6122 5d2c  a": None}, "a"],
+00028070: 205b 7b22 6122 3a20 2266 6f6f 227d 2c20   [{"a": "foo"}, 
+00028080: 2262 225d 2c20 5b4e 6f6e 652c 2022 6122  "b"], [None, "a"
+00028090: 5d5d 2c20 7363 6865 6d61 3d5b 226b 222c  ]], schema=["k",
+000280a0: 2022 7622 5d29 0a20 2020 2020 2020 203e   "v"]).        >
+000280b0: 3e3e 2064 662e 7365 6c65 6374 286a 736f  >> df.select(jso
+000280c0: 6e5f 6578 7472 6163 745f 7061 7468 5f74  n_extract_path_t
+000280d0: 6578 7428 746f 5f76 6172 6961 6e74 2822  ext(to_variant("
+000280e0: 6b22 292c 2022 7622 292e 6173 5f28 2272  k"), "v").as_("r
+000280f0: 6573 2229 292e 636f 6c6c 6563 7428 290a  es")).collect().
+00028100: 2020 2020 2020 2020 5b52 6f77 2852 4553          [Row(RES
+00028110: 3d27 666f 6f27 292c 2052 6f77 2852 4553  ='foo'), Row(RES
+00028120: 3d4e 6f6e 6529 2c20 526f 7728 5245 533d  =None), Row(RES=
+00028130: 4e6f 6e65 292c 2052 6f77 2852 4553 3d4e  None), Row(RES=N
+00028140: 6f6e 6529 5d0a 2020 2020 2222 220a 2020  one)].    """.  
+00028150: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00028160: 5f73 7472 2863 6f6c 2c20 226a 736f 6e5f  _str(col, "json_
+00028170: 6578 7472 6163 745f 7061 7468 5f74 6578  extract_path_tex
+00028180: 7422 290a 2020 2020 7020 3d20 5f74 6f5f  t").    p = _to_
+00028190: 636f 6c5f 6966 5f73 7472 2870 6174 682c  col_if_str(path,
+000281a0: 2022 6a73 6f6e 5f65 7874 7261 6374 5f70   "json_extract_p
+000281b0: 6174 685f 7465 7874 2229 0a20 2020 2072  ath_text").    r
+000281c0: 6574 7572 6e20 6275 696c 7469 6e28 226a  eturn builtin("j
+000281d0: 736f 6e5f 6578 7472 6163 745f 7061 7468  son_extract_path
+000281e0: 5f74 6578 7422 2928 632c 2070 290a 0a0a  _text")(c, p)...
+000281f0: 6465 6620 7061 7273 655f 6a73 6f6e 2865  def parse_json(e
+00028200: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00028210: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00028220: 2222 5061 7273 6520 7468 6520 7661 6c75  ""Parse the valu
+00028230: 6520 6f66 2074 6865 2073 7065 6369 6669  e of the specifi
+00028240: 6564 2063 6f6c 756d 6e20 6173 2061 204a  ed column as a J
+00028250: 534f 4e20 7374 7269 6e67 2061 6e64 2072  SON string and r
+00028260: 6574 7572 6e73 2074 6865 0a20 2020 2072  eturns the.    r
+00028270: 6573 756c 7469 6e67 204a 534f 4e20 646f  esulting JSON do
+00028280: 6375 6d65 6e74 2e0a 0a20 2020 2045 7861  cument...    Exa
+00028290: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000282a0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000282b0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+000282c0: 6528 5b5b 277b 226b 6579 223a 2022 3122  e([['{"key": "1"
+000282d0: 7d27 5d5d 2c20 7363 6865 6d61 3d5b 2261  }']], schema=["a
+000282e0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000282f0: 6466 2e73 656c 6563 7428 7061 7273 655f  df.select(parse_
+00028300: 6a73 6f6e 2864 665b 2261 225d 292e 616c  json(df["a"]).al
+00028310: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+00028320: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00028330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00028340: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00028350: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00028360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00028370: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
+00028380: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00028390: 2020 7c20 2022 6b65 7922 3a20 2231 2220    |  "key": "1" 
+000283a0: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
+000283b0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+000283c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000283d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+000283e0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+000283f0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00028400: 5f69 665f 7374 7228 652c 2022 7061 7273  _if_str(e, "pars
+00028410: 655f 6a73 6f6e 2229 0a20 2020 2072 6574  e_json").    ret
+00028420: 7572 6e20 6275 696c 7469 6e28 2270 6172  urn builtin("par
+00028430: 7365 5f6a 736f 6e22 2928 6329 0a0a 0a64  se_json")(c)...d
+00028440: 6566 2070 6172 7365 5f78 6d6c 2865 3a20  ef parse_xml(e: 
+00028450: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00028460: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00028470: 5061 7273 6520 7468 6520 7661 6c75 6520  Parse the value 
+00028480: 6f66 2074 6865 2073 7065 6369 6669 6564  of the specified
+00028490: 2063 6f6c 756d 6e20 6173 2061 204a 534f   column as a JSO
+000284a0: 4e20 7374 7269 6e67 2061 6e64 2072 6574  N string and ret
+000284b0: 7572 6e73 2074 6865 0a20 2020 2072 6573  urns the.    res
+000284c0: 756c 7469 6e67 2058 4d4c 2064 6f63 756d  ulting XML docum
+000284d0: 656e 742e 0a0a 2020 2020 4578 616d 706c  ent...    Exampl
+000284e0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+000284f0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+00028500: 6c28 0a20 2020 2020 2020 202e 2e2e 2020  l(.        ...  
+00028510: 2020 2022 7365 6c65 6374 2028 636f 6c75     "select (colu
+00028520: 6d6e 3129 2061 7320 7620 6672 6f6d 2076  mn1) as v from v
+00028530: 616c 7565 7320 2827 3c74 313e 666f 6f3c  alues ('<t1>foo<
+00028540: 7432 3e62 6172 3c2f 7432 3e3c 7433 3e3c  t2>bar</t2><t3><
+00028550: 2f74 333e 3c2f 7431 3e27 292c 2022 0a20  /t3></t1>'), ". 
+00028560: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+00028570: 2827 3c74 313e 3c2f 7431 3e27 2922 0a20  ('<t1></t1>')". 
+00028580: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00028590: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+000285a0: 6374 2870 6172 7365 5f78 6d6c 2822 7622  ct(parse_xml("v"
+000285b0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000285c0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000285d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000285e0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+000285f0: 4553 554c 5422 2020 2020 2020 2020 7c0a  ESULT"        |.
+00028600: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00028610: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00028620: 2020 207c 3c74 313e 2020 2020 2020 2020     |<t1>        
+00028630: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00028640: 2066 6f6f 2020 2020 2020 2020 2020 207c   foo           |
+00028650: 0a20 2020 2020 2020 207c 2020 3c74 323e  .        |  <t2>
+00028660: 6261 723c 2f74 323e 2020 7c0a 2020 2020  bar</t2>  |.    
+00028670: 2020 2020 7c20 203c 7433 3e3c 2f74 333e      |  <t3></t3>
+00028680: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00028690: 3c2f 7431 3e20 2020 2020 2020 2020 2020  </t1>           
+000286a0: 7c0a 2020 2020 2020 2020 7c3c 7431 3e3c  |.        |<t1><
+000286b0: 2f74 313e 2020 2020 2020 207c 0a20 2020  /t1>       |.   
+000286c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000286d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000286e0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+000286f0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00028700: 636f 6c5f 6966 5f73 7472 2865 2c20 2270  col_if_str(e, "p
+00028710: 6172 7365 5f78 6d6c 2229 0a20 2020 2072  arse_xml").    r
+00028720: 6574 7572 6e20 6275 696c 7469 6e28 2270  eturn builtin("p
+00028730: 6172 7365 5f78 6d6c 2229 2863 290a 0a0a  arse_xml")(c)...
+00028740: 6465 6620 7374 7269 705f 6e75 6c6c 5f76  def strip_null_v
+00028750: 616c 7565 2863 6f6c 3a20 436f 6c75 6d6e  alue(col: Column
+00028760: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00028770: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
+00028780: 7473 2061 204a 534f 4e20 226e 756c 6c22  ts a JSON "null"
+00028790: 2076 616c 7565 2069 6e20 7468 6520 7370   value in the sp
+000287a0: 6563 6966 6965 6420 636f 6c75 6d6e 2074  ecified column t
+000287b0: 6f20 6120 5351 4c20 4e55 4c4c 2076 616c  o a SQL NULL val
+000287c0: 7565 2e0a 2020 2020 416c 6c20 6f74 6865  ue..    All othe
+000287d0: 7220 5641 5249 414e 5420 7661 6c75 6573  r VARIANT values
+000287e0: 2069 6e20 7468 6520 636f 6c75 6d6e 2061   in the column a
+000287f0: 7265 2072 6574 7572 6e65 6420 756e 6368  re returned unch
+00028800: 616e 6765 642e 0a0a 2020 2020 4578 616d  anged...    Exam
+00028810: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00028820: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00028830: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00028840: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00028850: 205b 226e 756c 6c22 2c20 2231 225d 2c0a   ["null", "1"],.
+00028860: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00028870: 7363 6865 6d61 3d5b 2253 225d 2c0a 2020  schema=["S"],.  
+00028880: 2020 2020 2020 2e2e 2e20 292e 7365 6c65        ... ).sele
+00028890: 6374 2873 7472 6970 5f6e 756c 6c5f 7661  ct(strip_null_va
+000288a0: 6c75 6528 7061 7273 655f 6a73 6f6e 2863  lue(parse_json(c
+000288b0: 6f6c 2822 5322 2929 292e 6173 5f28 2242  ol("S"))).as_("B
+000288c0: 2229 292e 7768 6572 6528 0a20 2020 2020  ")).where(.     
+000288d0: 2020 202e 2e2e 2020 2020 2073 716c 5f65     ...     sql_e
+000288e0: 7870 7228 2242 2069 7320 6e75 6c6c 2229  xpr("B is null")
+000288f0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+00028900: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
+00028910: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00028920: 5b52 6f77 2842 3d4e 6f6e 6529 5d0a 2020  [Row(B=None)].  
+00028930: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00028940: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00028950: 2c20 2273 7472 6970 5f6e 756c 6c5f 7661  , "strip_null_va
+00028960: 6c75 6522 290a 2020 2020 7265 7475 726e  lue").    return
+00028970: 2062 7569 6c74 696e 2822 7374 7269 705f   builtin("strip_
+00028980: 6e75 6c6c 5f76 616c 7565 2229 2863 290a  null_value")(c).
+00028990: 0a0a 6465 6620 6172 7261 795f 6167 6728  ..def array_agg(
+000289a0: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
+000289b0: 652c 2069 735f 6469 7374 696e 6374 3a20  e, is_distinct: 
+000289c0: 626f 6f6c 203d 2046 616c 7365 2920 2d3e  bool = False) ->
+000289d0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000289e0: 5265 7475 726e 7320 7468 6520 696e 7075  Returns the inpu
+000289f0: 7420 7661 6c75 6573 2c20 7069 766f 7465  t values, pivote
+00028a00: 6420 696e 746f 2061 6e20 4152 5241 592e  d into an ARRAY.
+00028a10: 2049 6620 7468 6520 696e 7075 7420 6973   If the input is
+00028a20: 2065 6d70 7479 2c20 616e 2065 6d70 7479   empty, an empty
+00028a30: 0a20 2020 2041 5252 4159 2069 7320 7265  .    ARRAY is re
+00028a40: 7475 726e 6564 2e0a 0a20 2020 2045 7861  turned...    Exa
+00028a50: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00028a60: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00028a70: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00028a80: 285b 5b31 5d2c 205b 325d 2c20 5b33 5d2c  ([[1], [2], [3],
+00028a90: 205b 315d 5d2c 2073 6368 656d 613d 5b22   [1]], schema=["
+00028aa0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00028ab0: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
+00028ac0: 5f61 6767 2822 6122 2c20 5472 7565 292e  _agg("a", True).
+00028ad0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00028ae0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00028af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00028b00: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00028b10: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00028b20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00028b30: 5b20 2020 2020 2020 2020 7c0a 2020 2020  [         |.    
+00028b40: 2020 2020 7c20 2031 2c20 2020 2020 207c      |  1,      |
+00028b50: 0a20 2020 2020 2020 207c 2020 322c 2020  .        |  2,  
+00028b60: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00028b70: 2033 2020 2020 2020 207c 0a20 2020 2020   3       |.     
+00028b80: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+00028b90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00028ba0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00028bb0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00028bc0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00028bd0: 5f69 665f 7374 7228 636f 6c2c 2022 6172  _if_str(col, "ar
+00028be0: 7261 795f 6167 6722 290a 2020 2020 7265  ray_agg").    re
+00028bf0: 7475 726e 205f 6361 6c6c 5f66 756e 6374  turn _call_funct
+00028c00: 696f 6e28 2261 7272 6179 5f61 6767 222c  ion("array_agg",
+00028c10: 2069 735f 6469 7374 696e 6374 2c20 6329   is_distinct, c)
+00028c20: 0a0a 0a64 6566 2061 7272 6179 5f61 7070  ...def array_app
+00028c30: 656e 6428 6172 7261 793a 2043 6f6c 756d  end(array: Colum
+00028c40: 6e4f 724e 616d 652c 2065 6c65 6d65 6e74  nOrName, element
+00028c50: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00028c60: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00028c70: 2222 5265 7475 726e 7320 616e 2041 5252  ""Returns an ARR
+00028c80: 4159 2063 6f6e 7461 696e 696e 6720 616c  AY containing al
+00028c90: 6c20 656c 656d 656e 7473 2066 726f 6d20  l elements from 
+00028ca0: 7468 6520 736f 7572 6365 2041 5252 4159  the source ARRAY
+00028cb0: 2061 7320 7765 6c6c 2061 7320 7468 6520   as well as the 
+00028cc0: 6e65 7720 656c 656d 656e 742e 0a20 2020  new element..   
+00028cd0: 2054 6865 206e 6577 2065 6c65 6d65 6e74   The new element
+00028ce0: 2069 7320 6c6f 6361 7465 6420 6174 2065   is located at e
+00028cf0: 6e64 206f 6620 7468 6520 4152 5241 592e  nd of the ARRAY.
+00028d00: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+00028d10: 2020 2020 6172 7261 793a 2054 6865 2063      array: The c
+00028d20: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
+00028d30: 2074 6865 2073 6f75 7263 6520 4152 5241   the source ARRA
+00028d40: 592e 0a20 2020 2020 2020 2065 6c65 6d65  Y..        eleme
+00028d50: 6e74 3a20 5468 6520 636f 6c75 6d6e 2063  nt: The column c
+00028d60: 6f6e 7461 696e 696e 6720 7468 6520 656c  ontaining the el
+00028d70: 656d 656e 7420 746f 2062 6520 6170 7065  ement to be appe
+00028d80: 6e64 6564 2e20 5468 6520 656c 656d 656e  nded. The elemen
+00028d90: 7420 6d61 7920 6265 206f 6620 616c 6d6f  t may be of almo
+00028da0: 7374 0a20 2020 2020 2020 2020 2020 2061  st.            a
+00028db0: 6e79 2064 6174 6120 7479 7065 2e20 5468  ny data type. Th
+00028dc0: 6520 6461 7461 2074 7970 6520 646f 6573  e data type does
+00028dd0: 206e 6f74 206e 6565 6420 746f 206d 6174   not need to mat
+00028de0: 6368 2074 6865 2064 6174 6120 7479 7065  ch the data type
+00028df0: 2873 2920 6f66 2074 6865 0a20 2020 2020  (s) of the.     
+00028e00: 2020 2020 2020 2065 7869 7374 696e 6720         existing 
+00028e10: 656c 656d 656e 7473 2069 6e20 7468 6520  elements in the 
+00028e20: 4152 5241 592e 0a0a 2020 2020 4578 616d  ARRAY...    Exam
+00028e30: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00028e40: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+00028e50: 2e73 6e6f 7770 6172 6b20 696d 706f 7274  .snowpark import
+00028e60: 2052 6f77 0a20 2020 2020 2020 203e 3e3e   Row.        >>>
+00028e70: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00028e80: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00028e90: 526f 7728 613d 5b31 2c20 322c 2033 5d29  Row(a=[1, 2, 3])
+00028ea0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00028eb0: 662e 7365 6c65 6374 2861 7272 6179 5f61  f.select(array_a
+00028ec0: 7070 656e 6428 2261 222c 206c 6974 2834  ppend("a", lit(4
+00028ed0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+00028ee0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00028ef0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00028f00: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00028f10: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00028f20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00028f30: 2020 7c5b 2020 2020 2020 2020 207c 0a20    |[         |. 
+00028f40: 2020 2020 2020 207c 2020 312c 2020 2020         |  1,    
+00028f50: 2020 7c0a 2020 2020 2020 2020 7c20 2032    |.        |  2
+00028f60: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+00028f70: 207c 2020 332c 2020 2020 2020 7c0a 2020   |  3,      |.  
+00028f80: 2020 2020 2020 7c20 2034 2020 2020 2020        |  4      
+00028f90: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+00028fa0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00028fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00028fc0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00028fd0: 0a20 2020 2022 2222 0a20 2020 2061 203d  .    """.    a =
+00028fe0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00028ff0: 6172 7261 792c 2022 6172 7261 795f 6170  array, "array_ap
+00029000: 7065 6e64 2229 0a20 2020 2065 203d 205f  pend").    e = _
+00029010: 746f 5f63 6f6c 5f69 665f 7374 7228 656c  to_col_if_str(el
+00029020: 656d 656e 742c 2022 6172 7261 795f 6170  ement, "array_ap
+00029030: 7065 6e64 2229 0a20 2020 2072 6574 7572  pend").    retur
+00029040: 6e20 6275 696c 7469 6e28 2261 7272 6179  n builtin("array
+00029050: 5f61 7070 656e 6422 2928 612c 2065 290a  _append")(a, e).
+00029060: 0a0a 6465 6620 6172 7261 795f 6361 7428  ..def array_cat(
+00029070: 6172 7261 7931 3a20 436f 6c75 6d6e 4f72  array1: ColumnOr
+00029080: 4e61 6d65 2c20 6172 7261 7932 3a20 436f  Name, array2: Co
+00029090: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000290a0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+000290b0: 7475 726e 7320 7468 6520 636f 6e63 6174  turns the concat
+000290c0: 656e 6174 696f 6e20 6f66 2074 776f 2041  enation of two A
+000290d0: 5252 4159 732e 0a0a 2020 2020 4172 6773  RRAYs...    Args
+000290e0: 3a0a 2020 2020 2020 2020 6172 7261 7931  :.        array1
+000290f0: 3a20 436f 6c75 6d6e 2063 6f6e 7461 696e  : Column contain
+00029100: 696e 6720 7468 6520 736f 7572 6365 2041  ing the source A
+00029110: 5252 4159 2e0a 2020 2020 2020 2020 6172  RRAY..        ar
+00029120: 7261 7932 3a20 436f 6c75 6d6e 2063 6f6e  ray2: Column con
+00029130: 7461 696e 696e 6720 7468 6520 4152 5241  taining the ARRA
+00029140: 5920 746f 2062 6520 6170 7065 6e64 6564  Y to be appended
+00029150: 2074 6f20 6172 7261 7931 2e0a 0a20 2020   to array1...   
+00029160: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00029170: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00029180: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+00029190: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+000291a0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000291b0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000291c0: 616d 6528 5b52 6f77 2861 3d5b 312c 2032  ame([Row(a=[1, 2
+000291d0: 2c20 335d 2c20 623d 5b34 2c20 355d 295d  , 3], b=[4, 5])]
+000291e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000291f0: 2e73 656c 6563 7428 6172 7261 795f 6361  .select(array_ca
+00029200: 7428 2261 222c 2022 6222 292e 616c 6961  t("a", "b").alia
+00029210: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00029220: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00029230: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00029240: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00029250: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00029260: 2d2d 0a20 2020 2020 2020 207c 5b20 2020  --.        |[   
+00029270: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00029280: 7c20 2031 2c20 2020 2020 207c 0a20 2020  |  1,      |.   
+00029290: 2020 2020 207c 2020 322c 2020 2020 2020       |  2,      
+000292a0: 7c0a 2020 2020 2020 2020 7c20 2033 2c20  |.        |  3, 
+000292b0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+000292c0: 2020 342c 2020 2020 2020 7c0a 2020 2020    4,      |.    
+000292d0: 2020 2020 7c20 2035 2020 2020 2020 207c      |  5       |
+000292e0: 0a20 2020 2020 2020 207c 5d20 2020 2020  .        |]     
+000292f0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00029300: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00029310: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00029320: 2020 2022 2222 0a20 2020 2061 3120 3d20     """.    a1 = 
+00029330: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+00029340: 7272 6179 312c 2022 6172 7261 795f 6361  rray1, "array_ca
+00029350: 7422 290a 2020 2020 6132 203d 205f 746f  t").    a2 = _to
+00029360: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
+00029370: 7932 2c20 2261 7272 6179 5f63 6174 2229  y2, "array_cat")
+00029380: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00029390: 7469 6e28 2261 7272 6179 5f63 6174 2229  tin("array_cat")
+000293a0: 2861 312c 2061 3229 0a0a 0a64 6566 2061  (a1, a2)...def a
+000293b0: 7272 6179 5f63 6f6d 7061 6374 2861 7272  rray_compact(arr
+000293c0: 6179 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ay: ColumnOrName
+000293d0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+000293e0: 2022 2222 5265 7475 726e 7320 6120 636f   """Returns a co
+000293f0: 6d70 6163 7465 6420 4152 5241 5920 7769  mpacted ARRAY wi
+00029400: 7468 206d 6973 7369 6e67 2061 6e64 206e  th missing and n
+00029410: 756c 6c20 7661 6c75 6573 2072 656d 6f76  ull values remov
+00029420: 6564 2c0a 2020 2020 6566 6665 6374 6976  ed,.    effectiv
+00029430: 656c 7920 636f 6e76 6572 7469 6e67 2073  ely converting s
+00029440: 7061 7273 6520 6172 7261 7973 2069 6e74  parse arrays int
+00029450: 6f20 6465 6e73 6520 6172 7261 7973 2e0a  o dense arrays..
+00029460: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00029470: 2020 2061 7272 6179 3a20 436f 6c75 6d6e     array: Column
+00029480: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00029490: 736f 7572 6365 2041 5252 4159 2074 6f20  source ARRAY to 
+000294a0: 6265 2063 6f6d 7061 6374 6564 0a0a 2020  be compacted..  
+000294b0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+000294c0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000294d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b20  wflake.snowpark 
+000294e0: 696d 706f 7274 2052 6f77 0a20 2020 2020  import Row.     
+000294f0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00029500: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00029510: 7261 6d65 285b 526f 7728 613d 5b31 2c20  rame([Row(a=[1, 
+00029520: 4e6f 6e65 2c20 335d 295d 290a 2020 2020  None, 3])]).    
+00029530: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00029540: 7428 2261 222c 2061 7272 6179 5f63 6f6d  t("a", array_com
+00029550: 7061 6374 2822 6122 292e 616c 6961 7328  pact("a").alias(
+00029560: 2263 6f6d 7061 6374 6564 2229 292e 7368  "compacted")).sh
+00029570: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00029580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00029590: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+000295a0: 2241 2220 2020 2020 207c 2243 4f4d 5041  "A"      |"COMPA
+000295b0: 4354 4544 2220 207c 0a20 2020 2020 2020  CTED"  |.       
+000295c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000295d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000295e0: 2020 207c 5b20 2020 2020 2020 207c 5b20     |[        |[ 
+000295f0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+00029600: 2020 2020 207c 2020 312c 2020 2020 207c       |  1,     |
+00029610: 2020 312c 2020 2020 2020 2020 207c 0a20    1,         |. 
+00029620: 2020 2020 2020 207c 2020 6e75 6c6c 2c20         |  null, 
+00029630: 207c 2020 3320 2020 2020 2020 2020 207c   |  3          |
+00029640: 0a20 2020 2020 2020 207c 2020 3320 2020  .        |  3   
+00029650: 2020 207c 5d20 2020 2020 2020 2020 2020     |]           
+00029660: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+00029670: 2020 2020 207c 2020 2020 2020 2020 2020       |          
+00029680: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00029690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000296a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+000296b0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+000296c0: 2222 0a20 2020 2061 203d 205f 746f 5f63  "".    a = _to_c
+000296d0: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
+000296e0: 2022 6172 7261 795f 636f 6d70 6163 7422   "array_compact"
+000296f0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00029700: 6c74 696e 2822 6172 7261 795f 636f 6d70  ltin("array_comp
+00029710: 6163 7422 2928 6129 0a0a 0a64 6566 2061  act")(a)...def a
+00029720: 7272 6179 5f63 6f6e 7374 7275 6374 282a  rray_construct(*
+00029730: 636f 6c73 3a20 436f 6c75 6d6e 4f72 4e61  cols: ColumnOrNa
+00029740: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00029750: 2020 2022 2222 5265 7475 726e 7320 616e     """Returns an
+00029760: 2041 5252 4159 2063 6f6e 7374 7275 6374   ARRAY construct
+00029770: 6564 2066 726f 6d20 7a65 726f 2c20 6f6e  ed from zero, on
+00029780: 652c 206f 7220 6d6f 7265 2069 6e70 7574  e, or more input
+00029790: 732e 0a0a 2020 2020 4172 6773 3a0a 2020  s...    Args:.  
+000297a0: 2020 2020 2020 636f 6c73 3a20 436f 6c75        cols: Colu
+000297b0: 6d6e 7320 636f 6e74 6169 6e69 6e67 2074  mns containing t
+000297c0: 6865 2076 616c 7565 7320 286f 7220 6578  he values (or ex
+000297d0: 7072 6573 7369 6f6e 7320 7468 6174 2065  pressions that e
+000297e0: 7661 6c75 6174 6520 746f 2076 616c 7565  valuate to value
+000297f0: 7329 2e20 5468 650a 2020 2020 2020 2020  s). The.        
+00029800: 2020 2020 7661 6c75 6573 2064 6f20 6e6f      values do no
+00029810: 7420 616c 6c20 6e65 6564 2074 6f20 6265  t all need to be
+00029820: 206f 6620 7468 6520 7361 6d65 2064 6174   of the same dat
+00029830: 6120 7479 7065 2e0a 0a20 2020 2045 7861  a type...    Exa
+00029840: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00029850: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00029860: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00029870: 285b 5b31 2c20 325d 2c20 5b33 2c20 345d  ([[1, 2], [3, 4]
+00029880: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+00029890: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+000298a0: 3e20 6466 2e73 656c 6563 7428 6172 7261  > df.select(arra
+000298b0: 795f 636f 6e73 7472 7563 7428 2261 222c  y_construct("a",
+000298c0: 2022 6222 292e 616c 6961 7328 2272 6573   "b").alias("res
+000298d0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+000298e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000298f0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00029900: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00029910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00029920: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
+00029930: 7c0a 2020 2020 2020 2020 7c20 2031 2c20  |.        |  1, 
+00029940: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00029950: 2020 3220 2020 2020 2020 7c0a 2020 2020    2       |.    
+00029960: 2020 2020 7c5d 2020 2020 2020 2020 207c      |]         |
+00029970: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
+00029980: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00029990: 2033 2c20 2020 2020 207c 0a20 2020 2020   3,      |.     
+000299a0: 2020 207c 2020 3420 2020 2020 2020 7c0a     |  4       |.
+000299b0: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
+000299c0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+000299d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000299e0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+000299f0: 2020 2222 220a 2020 2020 6373 203d 205b    """.    cs = [
+00029a00: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00029a10: 2c20 2261 7272 6179 5f63 6f6e 7374 7275  , "array_constru
+00029a20: 6374 2229 2066 6f72 2063 2069 6e20 636f  ct") for c in co
+00029a30: 6c73 5d0a 2020 2020 7265 7475 726e 2062  ls].    return b
+00029a40: 7569 6c74 696e 2822 6172 7261 795f 636f  uiltin("array_co
+00029a50: 6e73 7472 7563 7422 2928 2a63 7329 0a0a  nstruct")(*cs)..
+00029a60: 0a64 6566 2061 7272 6179 5f63 6f6e 7374  .def array_const
+00029a70: 7275 6374 5f63 6f6d 7061 6374 282a 636f  ruct_compact(*co
+00029a80: 6c73 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ls: ColumnOrName
+00029a90: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00029aa0: 2022 2222 5265 7475 726e 7320 616e 2041   """Returns an A
+00029ab0: 5252 4159 2063 6f6e 7374 7275 6374 6564  RRAY constructed
+00029ac0: 2066 726f 6d20 7a65 726f 2c20 6f6e 652c   from zero, one,
+00029ad0: 206f 7220 6d6f 7265 2069 6e70 7574 732e   or more inputs.
+00029ae0: 0a20 2020 2054 6865 2063 6f6e 7374 7275  .    The constru
+00029af0: 6374 6564 2041 5252 4159 206f 6d69 7473  cted ARRAY omits
+00029b00: 2061 6e79 204e 554c 4c20 696e 7075 7420   any NULL input 
+00029b10: 7661 6c75 6573 2e0a 0a20 2020 2041 7267  values...    Arg
+00029b20: 733a 0a20 2020 2020 2020 2063 6f6c 733a  s:.        cols:
+00029b30: 2043 6f6c 756d 6e73 2063 6f6e 7461 696e   Columns contain
+00029b40: 696e 6720 7468 6520 7661 6c75 6573 2028  ing the values (
+00029b50: 6f72 2065 7870 7265 7373 696f 6e73 2074  or expressions t
+00029b60: 6861 7420 6576 616c 7561 7465 2074 6f20  hat evaluate to 
+00029b70: 7661 6c75 6573 292e 2054 6865 0a20 2020  values). The.   
+00029b80: 2020 2020 2020 2020 2076 616c 7565 7320           values 
+00029b90: 646f 206e 6f74 2061 6c6c 206e 6565 6420  do not all need 
+00029ba0: 746f 2062 6520 6f66 2074 6865 2073 616d  to be of the sam
+00029bb0: 6520 6461 7461 2074 7970 652e 0a0a 2020  e data type...  
+00029bc0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00029bd0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00029be0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00029bf0: 6672 616d 6528 5b5b 312c 204e 6f6e 652c  frame([[1, None,
+00029c00: 2032 5d2c 205b 332c 204e 6f6e 652c 2034   2], [3, None, 4
+00029c10: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
+00029c20: 2022 6222 2c20 2263 225d 290a 2020 2020   "b", "c"]).    
+00029c30: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00029c40: 7428 6172 7261 795f 636f 6e73 7472 7563  t(array_construc
+00029c50: 745f 636f 6d70 6163 7428 2261 222c 2022  t_compact("a", "
+00029c60: 6222 2c20 2263 2229 2e61 6c69 6173 2822  b", "c").alias("
+00029c70: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00029c80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00029c90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00029ca0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+00029cb0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00029cc0: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
+00029cd0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+00029ce0: 312c 2020 2020 2020 7c0a 2020 2020 2020  1,      |.      
+00029cf0: 2020 7c20 2032 2020 2020 2020 207c 0a20    |  2       |. 
+00029d00: 2020 2020 2020 207c 5d20 2020 2020 2020         |]       
+00029d10: 2020 7c0a 2020 2020 2020 2020 7c5b 2020    |.        |[  
+00029d20: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00029d30: 207c 2020 332c 2020 2020 2020 7c0a 2020   |  3,      |.  
+00029d40: 2020 2020 2020 7c20 2034 2020 2020 2020        |  4      
+00029d50: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+00029d60: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00029d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00029d80: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00029d90: 0a20 2020 2022 2222 0a20 2020 2063 7320  .    """.    cs 
+00029da0: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
+00029db0: 7228 632c 2022 6172 7261 795f 636f 6e73  r(c, "array_cons
+00029dc0: 7472 7563 745f 636f 6d70 6163 7422 2920  truct_compact") 
+00029dd0: 666f 7220 6320 696e 2063 6f6c 735d 0a20  for c in cols]. 
+00029de0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00029df0: 6e28 2261 7272 6179 5f63 6f6e 7374 7275  n("array_constru
+00029e00: 6374 5f63 6f6d 7061 6374 2229 282a 6373  ct_compact")(*cs
+00029e10: 290a 0a0a 6465 6620 6172 7261 795f 636f  )...def array_co
+00029e20: 6e74 6169 6e73 2876 6172 6961 6e74 3a20  ntains(variant: 
+00029e30: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6172  ColumnOrName, ar
+00029e40: 7261 793a 2043 6f6c 756d 6e4f 724e 616d  ray: ColumnOrNam
+00029e50: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00029e60: 2020 2222 2252 6574 7572 6e73 2054 7275    """Returns Tru
+00029e70: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
+00029e80: 6564 2056 4152 4941 4e54 2069 7320 666f  ed VARIANT is fo
+00029e90: 756e 6420 696e 2074 6865 2073 7065 6369  und in the speci
+00029ea0: 6669 6564 2041 5252 4159 2e0a 0a20 2020  fied ARRAY...   
+00029eb0: 2041 7267 733a 0a20 2020 2020 2020 2076   Args:.        v
+00029ec0: 6172 6961 6e74 3a20 436f 6c75 6d6e 2063  ariant: Column c
+00029ed0: 6f6e 7461 696e 696e 6720 7468 6520 5641  ontaining the VA
+00029ee0: 5249 414e 5420 746f 2066 696e 642e 0a20  RIANT to find.. 
+00029ef0: 2020 2020 2020 2061 7272 6179 3a20 436f         array: Co
+00029f00: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+00029f10: 7468 6520 4152 5241 5920 746f 2073 6561  the ARRAY to sea
+00029f20: 7263 682e 0a0a 2020 2020 4578 616d 706c  rch...    Exampl
+00029f30: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00029f40: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00029f50: 6e6f 7770 6172 6b20 696d 706f 7274 2052  nowpark import R
+00029f60: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
+00029f70: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00029f80: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
+00029f90: 7728 5b31 2c20 325d 292c 2052 6f77 285b  w([1, 2]), Row([
+00029fa0: 312c 2033 5d29 5d2c 2073 6368 656d 613d  1, 3])], schema=
+00029fb0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00029fc0: 3e3e 2064 662e 7365 6c65 6374 2861 7272  >> df.select(arr
+00029fd0: 6179 5f63 6f6e 7461 696e 7328 6c69 7428  ay_contains(lit(
+00029fe0: 3229 2c20 2261 2229 2e61 6c69 6173 2822  2), "a").alias("
+00029ff0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0002a000: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002a010: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002a020: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0002a030: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002a040: 2020 2020 2020 2020 7c54 7275 6520 2020          |True   
+0002a050: 2020 207c 0a20 2020 2020 2020 207c 4661     |.        |Fa
+0002a060: 6c73 6520 2020 2020 7c0a 2020 2020 2020  lse     |.      
+0002a070: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002a080: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0002a090: 453e 0a20 2020 2022 2222 0a20 2020 2076  E>.    """.    v
+0002a0a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002a0b0: 7228 7661 7269 616e 742c 2022 6172 7261  r(variant, "arra
+0002a0c0: 795f 636f 6e74 6169 6e73 2229 0a20 2020  y_contains").   
+0002a0d0: 2061 203d 205f 746f 5f63 6f6c 5f69 665f   a = _to_col_if_
+0002a0e0: 7374 7228 6172 7261 792c 2022 6172 7261  str(array, "arra
+0002a0f0: 795f 636f 6e74 6169 6e73 2229 0a20 2020  y_contains").   
+0002a100: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0002a110: 2261 7272 6179 5f63 6f6e 7461 696e 7322  "array_contains"
+0002a120: 2928 762c 2061 290a 0a0a 6465 6620 6172  )(v, a)...def ar
+0002a130: 7261 795f 696e 7365 7274 280a 2020 2020  ray_insert(.    
+0002a140: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
+0002a150: 616d 652c 2070 6f73 3a20 436f 6c75 6d6e  ame, pos: Column
+0002a160: 4f72 4e61 6d65 2c20 656c 656d 656e 743a  OrName, element:
+0002a170: 2043 6f6c 756d 6e4f 724e 616d 650a 2920   ColumnOrName.) 
+0002a180: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002a190: 2222 5265 7475 726e 7320 616e 2041 5252  ""Returns an ARR
+0002a1a0: 4159 2063 6f6e 7461 696e 696e 6720 616c  AY containing al
+0002a1b0: 6c20 656c 656d 656e 7473 2066 726f 6d20  l elements from 
+0002a1c0: 7468 6520 736f 7572 6365 2041 5252 4159  the source ARRAY
+0002a1d0: 2061 7320 7765 6c6c 2061 7320 7468 6520   as well as the 
+0002a1e0: 6e65 7720 656c 656d 656e 742e 0a0a 2020  new element...  
+0002a1f0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0002a200: 6172 7261 793a 2043 6f6c 756d 6e20 636f  array: Column co
+0002a210: 6e74 6169 6e69 6e67 2074 6865 2073 6f75  ntaining the sou
+0002a220: 7263 6520 4152 5241 592e 0a20 2020 2020  rce ARRAY..     
+0002a230: 2020 2070 6f73 3a20 436f 6c75 6d6e 2063     pos: Column c
+0002a240: 6f6e 7461 696e 696e 6720 6120 287a 6572  ontaining a (zer
+0002a250: 6f2d 6261 7365 6429 2070 6f73 6974 696f  o-based) positio
+0002a260: 6e20 696e 2074 6865 2073 6f75 7263 6520  n in the source 
+0002a270: 4152 5241 592e 0a20 2020 2020 2020 2020  ARRAY..         
+0002a280: 2020 2054 6865 206e 6577 2065 6c65 6d65     The new eleme
+0002a290: 6e74 2069 7320 696e 7365 7274 6564 2061  nt is inserted a
+0002a2a0: 7420 7468 6973 2070 6f73 6974 696f 6e2e  t this position.
+0002a2b0: 2054 6865 206f 7269 6769 6e61 6c20 656c   The original el
+0002a2c0: 656d 656e 7420 6672 6f6d 2074 6869 730a  ement from this.
+0002a2d0: 2020 2020 2020 2020 2020 2020 706f 7369              posi
+0002a2e0: 7469 6f6e 2028 6966 2061 6e79 2920 616e  tion (if any) an
+0002a2f0: 6420 616c 6c20 7375 6273 6571 7565 6e74  d all subsequent
+0002a300: 2065 6c65 6d65 6e74 7320 2869 6620 616e   elements (if an
+0002a310: 7929 2061 7265 2073 6869 6674 6564 2062  y) are shifted b
+0002a320: 7920 6f6e 6520 706f 7369 7469 6f6e 0a20  y one position. 
+0002a330: 2020 2020 2020 2020 2020 2074 6f20 7468             to th
+0002a340: 6520 7269 6768 7420 696e 2074 6865 2072  e right in the r
+0002a350: 6573 756c 7469 6e67 2061 7272 6179 2028  esulting array (
+0002a360: 692e 652e 2069 6e73 6572 7469 6e67 2061  i.e. inserting a
+0002a370: 7420 706f 7369 7469 6f6e 2030 2068 6173  t position 0 has
+0002a380: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
+0002a390: 2020 2020 2020 6566 6665 6374 2061 7320        effect as 
+0002a3a0: 7573 696e 6720 6172 7261 795f 7072 6570  using array_prep
+0002a3b0: 656e 6429 2e0a 2020 2020 2020 2020 2020  end)..          
+0002a3c0: 2020 4120 6e65 6761 7469 7665 2070 6f73    A negative pos
+0002a3d0: 6974 696f 6e20 6973 2069 6e74 6572 7072  ition is interpr
+0002a3e0: 6574 6564 2061 7320 616e 2069 6e64 6578  eted as an index
+0002a3f0: 2066 726f 6d20 7468 6520 6261 636b 206f   from the back o
+0002a400: 6620 7468 6520 6172 7261 7920 2865 2e67  f the array (e.g
+0002a410: 2e0a 2020 2020 2020 2020 2020 2020 2d31  ..            -1
+0002a420: 2072 6573 756c 7473 2069 6e20 696e 7365   results in inse
+0002a430: 7274 696f 6e20 6265 666f 7265 2074 6865  rtion before the
+0002a440: 206c 6173 7420 656c 656d 656e 7420 696e   last element in
+0002a450: 2074 6865 2061 7272 6179 292e 0a20 2020   the array)..   
+0002a460: 2020 2020 2065 6c65 6d65 6e74 3a20 436f       element: Co
+0002a470: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+0002a480: 7468 6520 656c 656d 656e 7420 746f 2062  the element to b
+0002a490: 6520 696e 7365 7274 6564 2e20 5468 6520  e inserted. The 
+0002a4a0: 6e65 7720 656c 656d 656e 7420 6973 206c  new element is l
+0002a4b0: 6f63 6174 6564 2061 740a 2020 2020 2020  ocated at.      
+0002a4c0: 2020 2020 2020 706f 7369 7469 6f6e 2070        position p
+0002a4d0: 6f73 2e20 5468 6520 7265 6c61 7469 7665  os. The relative
+0002a4e0: 206f 7264 6572 206f 6620 7468 6520 6f74   order of the ot
+0002a4f0: 6865 7220 656c 656d 656e 7473 2066 726f  her elements fro
+0002a500: 6d20 7468 6520 736f 7572 6365 0a20 2020  m the source.   
+0002a510: 2020 2020 2020 2020 2061 7272 6179 2069           array i
+0002a520: 7320 7072 6573 6572 7665 642e 0a0a 2020  s preserved...  
+0002a530: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0002a540: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0002a550: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b20  wflake.snowpark 
+0002a560: 696d 706f 7274 2052 6f77 0a20 2020 2020  import Row.     
+0002a570: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0002a580: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0002a590: 7261 6d65 285b 526f 7728 5b31 2c20 325d  rame([Row([1, 2]
+0002a5a0: 292c 2052 6f77 285b 312c 2033 5d29 5d2c  ), Row([1, 3])],
+0002a5b0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0002a5c0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002a5d0: 6c65 6374 2861 7272 6179 5f69 6e73 6572  lect(array_inser
+0002a5e0: 7428 2261 222c 206c 6974 2830 292c 206c  t("a", lit(0), l
+0002a5f0: 6974 2831 3029 292e 616c 6961 7328 2272  it(10)).alias("r
+0002a600: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0002a610: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002a620: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002a630: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0002a640: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002a650: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+0002a660: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+0002a670: 302c 2020 2020 207c 0a20 2020 2020 2020  0,     |.       
+0002a680: 207c 2020 312c 2020 2020 2020 7c0a 2020   |  1,      |.  
+0002a690: 2020 2020 2020 7c20 2032 2020 2020 2020        |  2      
+0002a6a0: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+0002a6b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002a6c0: 7c5b 2020 2020 2020 2020 207c 0a20 2020  |[         |.   
+0002a6d0: 2020 2020 207c 2020 3130 2c20 2020 2020       |  10,     
+0002a6e0: 7c0a 2020 2020 2020 2020 7c20 2031 2c20  |.        |  1, 
+0002a6f0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002a700: 2020 3320 2020 2020 2020 7c0a 2020 2020    3       |.    
+0002a710: 2020 2020 7c5d 2020 2020 2020 2020 207c      |]         |
+0002a720: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002a730: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0002a740: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0002a750: 220a 2020 2020 6120 3d20 5f74 6f5f 636f  ".    a = _to_co
+0002a760: 6c5f 6966 5f73 7472 2861 7272 6179 2c20  l_if_str(array, 
+0002a770: 2261 7272 6179 5f69 6e73 6572 7422 290a  "array_insert").
+0002a780: 2020 2020 7020 3d20 5f74 6f5f 636f 6c5f      p = _to_col_
+0002a790: 6966 5f73 7472 2870 6f73 2c20 2261 7272  if_str(pos, "arr
+0002a7a0: 6179 5f69 6e73 6572 7422 290a 2020 2020  ay_insert").    
+0002a7b0: 6520 3d20 5f74 6f5f 636f 6c5f 6966 5f73  e = _to_col_if_s
+0002a7c0: 7472 2865 6c65 6d65 6e74 2c20 2261 7272  tr(element, "arr
+0002a7d0: 6179 5f69 6e73 6572 7422 290a 2020 2020  ay_insert").    
+0002a7e0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002a7f0: 6172 7261 795f 696e 7365 7274 2229 2861  array_insert")(a
+0002a800: 2c20 702c 2065 290a 0a0a 6465 6620 6172  , p, e)...def ar
+0002a810: 7261 795f 706f 7369 7469 6f6e 2876 6172  ray_position(var
+0002a820: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
+0002a830: 6d65 2c20 6172 7261 793a 2043 6f6c 756d  me, array: Colum
+0002a840: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002a850: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002a860: 6e73 2074 6865 2069 6e64 6578 206f 6620  ns the index of 
+0002a870: 7468 6520 6669 7273 7420 6f63 6375 7272  the first occurr
+0002a880: 656e 6365 206f 6620 616e 2065 6c65 6d65  ence of an eleme
+0002a890: 6e74 2069 6e20 616e 2041 5252 4159 2e0a  nt in an ARRAY..
+0002a8a0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0002a8b0: 2020 2076 6172 6961 6e74 3a20 436f 6c75     variant: Colu
+0002a8c0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
+0002a8d0: 6520 5641 5249 414e 5420 7661 6c75 6520  e VARIANT value 
+0002a8e0: 7468 6174 2079 6f75 2077 616e 7420 746f  that you want to
+0002a8f0: 2066 696e 642e 2054 6865 2066 756e 6374   find. The funct
+0002a900: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+0002a910: 7365 6172 6368 6573 2066 6f72 2074 6865  searches for the
+0002a920: 2066 6972 7374 206f 6363 7572 7265 6e63   first occurrenc
+0002a930: 6520 6f66 2074 6869 7320 7661 6c75 6520  e of this value 
+0002a940: 696e 2074 6865 2061 7272 6179 2e0a 2020  in the array..  
+0002a950: 2020 2020 2020 6172 7261 793a 2043 6f6c        array: Col
+0002a960: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
+0002a970: 6865 2041 5252 4159 2074 6f20 6265 2073  he ARRAY to be s
+0002a980: 6561 7263 6865 642e 0a0a 2020 2020 4578  earched...    Ex
+0002a990: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0002a9a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0002a9b0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
+0002a9c0: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
+0002a9d0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002a9e0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0002a9f0: 285b 526f 7728 5b32 2c20 315d 292c 2052  ([Row([2, 1]), R
+0002aa00: 6f77 285b 312c 2033 5d29 5d2c 2073 6368  ow([1, 3])], sch
+0002aa10: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0002aa20: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0002aa30: 2861 7272 6179 5f70 6f73 6974 696f 6e28  (array_position(
+0002aa40: 6c69 7428 3129 2c20 2261 2229 2e61 6c69  lit(1), "a").ali
+0002aa50: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+0002aa60: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0002aa70: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002aa80: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+0002aa90: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002aaa0: 2d2d 2d0a 2020 2020 2020 2020 7c31 2020  ---.        |1  
+0002aab0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0002aac0: 207c 3020 2020 2020 2020 2020 7c0a 2020   |0         |.  
+0002aad0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0002aae0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0002aaf0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0002ab00: 2020 2076 203d 205f 746f 5f63 6f6c 5f69     v = _to_col_i
+0002ab10: 665f 7374 7228 7661 7269 616e 742c 2022  f_str(variant, "
+0002ab20: 6172 7261 795f 706f 7369 7469 6f6e 2229  array_position")
+0002ab30: 0a20 2020 2061 203d 205f 746f 5f63 6f6c  .    a = _to_col
+0002ab40: 5f69 665f 7374 7228 6172 7261 792c 2022  _if_str(array, "
+0002ab50: 6172 7261 795f 706f 7369 7469 6f6e 2229  array_position")
+0002ab60: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0002ab70: 7469 6e28 2261 7272 6179 5f70 6f73 6974  tin("array_posit
+0002ab80: 696f 6e22 2928 762c 2061 290a 0a0a 6465  ion")(v, a)...de
+0002ab90: 6620 6172 7261 795f 7072 6570 656e 6428  f array_prepend(
+0002aba0: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
+0002abb0: 616d 652c 2065 6c65 6d65 6e74 3a20 436f  ame, element: Co
+0002abc0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0002abd0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0002abe0: 7475 726e 7320 616e 2041 5252 4159 2063  turns an ARRAY c
+0002abf0: 6f6e 7461 696e 696e 6720 7468 6520 6e65  ontaining the ne
+0002ac00: 7720 656c 656d 656e 7420 6173 2077 656c  w element as wel
+0002ac10: 6c20 6173 2061 6c6c 2065 6c65 6d65 6e74  l as all element
+0002ac20: 7320 6672 6f6d 2074 6865 2073 6f75 7263  s from the sourc
+0002ac30: 6520 4152 5241 592e 0a20 2020 2054 6865  e ARRAY..    The
+0002ac40: 206e 6577 2065 6c65 6d65 6e74 2069 7320   new element is 
+0002ac50: 706f 7369 7469 6f6e 6564 2061 7420 7468  positioned at th
+0002ac60: 6520 6265 6769 6e6e 696e 6720 6f66 2074  e beginning of t
+0002ac70: 6865 2041 5252 4159 2e0a 0a20 2020 2041  he ARRAY...    A
+0002ac80: 7267 733a 0a20 2020 2020 2020 2061 7272  rgs:.        arr
+0002ac90: 6179 2043 6f6c 756d 6e20 636f 6e74 6169  ay Column contai
+0002aca0: 6e69 6e67 2074 6865 2073 6f75 7263 6520  ning the source 
+0002acb0: 4152 5241 592e 0a20 2020 2020 2020 2065  ARRAY..        e
+0002acc0: 6c65 6d65 6e74 2043 6f6c 756d 6e20 636f  lement Column co
+0002acd0: 6e74 6169 6e69 6e67 2074 6865 2065 6c65  ntaining the ele
+0002ace0: 6d65 6e74 2074 6f20 6265 2070 7265 7065  ment to be prepe
+0002acf0: 6e64 6564 2e0a 0a20 2020 2045 7861 6d70  nded...    Examp
+0002ad00: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+0002ad10: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+0002ad20: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
+0002ad30: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
+0002ad40: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002ad50: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
+0002ad60: 6f77 2861 3d5b 312c 2032 2c20 335d 295d  ow(a=[1, 2, 3])]
+0002ad70: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002ad80: 2e73 656c 6563 7428 6172 7261 795f 7072  .select(array_pr
+0002ad90: 6570 656e 6428 2261 222c 206c 6974 2834  epend("a", lit(4
+0002ada0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+0002adb0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0002adc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002add0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0002ade0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0002adf0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002ae00: 2020 7c5b 2020 2020 2020 2020 207c 0a20    |[         |. 
+0002ae10: 2020 2020 2020 207c 2020 342c 2020 2020         |  4,    
+0002ae20: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+0002ae30: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+0002ae40: 207c 2020 322c 2020 2020 2020 7c0a 2020   |  2,      |.  
+0002ae50: 2020 2020 2020 7c20 2033 2020 2020 2020        |  3      
+0002ae60: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+0002ae70: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002ae80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002ae90: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0002aea0: 0a20 2020 2022 2222 0a20 2020 2061 203d  .    """.    a =
+0002aeb0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002aec0: 6172 7261 792c 2022 6172 7261 795f 7072  array, "array_pr
+0002aed0: 6570 656e 6422 290a 2020 2020 6520 3d20  epend").    e = 
+0002aee0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0002aef0: 6c65 6d65 6e74 2c20 2261 7272 6179 5f70  lement, "array_p
+0002af00: 7265 7065 6e64 2229 0a20 2020 2072 6574  repend").    ret
+0002af10: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
+0002af20: 6179 5f70 7265 7065 6e64 2229 2861 2c20  ay_prepend")(a, 
+0002af30: 6529 0a0a 0a64 6566 2061 7272 6179 5f73  e)...def array_s
+0002af40: 697a 6528 6172 7261 793a 2043 6f6c 756d  ize(array: Colum
+0002af50: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002af60: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002af70: 6e73 2074 6865 2073 697a 6520 6f66 2074  ns the size of t
+0002af80: 6865 2069 6e70 7574 2041 5252 4159 2e0a  he input ARRAY..
+0002af90: 0a20 2020 2049 6620 7468 6520 7370 6563  .    If the spec
+0002afa0: 6966 6965 6420 636f 6c75 6d6e 2063 6f6e  ified column con
+0002afb0: 7461 696e 7320 6120 5641 5249 414e 5420  tains a VARIANT 
+0002afc0: 7661 6c75 6520 7468 6174 2063 6f6e 7461  value that conta
+0002afd0: 696e 7320 616e 2041 5252 4159 2c20 7468  ins an ARRAY, th
+0002afe0: 6520 7369 7a65 206f 6620 7468 6520 4152  e size of the AR
+0002aff0: 5241 590a 2020 2020 6973 2072 6574 7572  RAY.    is retur
+0002b000: 6e65 643b 206f 7468 6572 7769 7365 2c20  ned; otherwise, 
+0002b010: 4e55 4c4c 2069 7320 7265 7475 726e 6564  NULL is returned
+0002b020: 2069 6620 7468 6520 7661 6c75 6520 6973   if the value is
+0002b030: 206e 6f74 2061 6e20 4152 5241 592e 0a0a   not an ARRAY...
+0002b040: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0002b050: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002b060: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002b070: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+0002b080: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002b090: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0002b0a0: 6166 7261 6d65 285b 526f 7728 613d 5b31  aframe([Row(a=[1
+0002b0b0: 2c20 322c 2033 5d29 5d29 0a20 2020 2020  , 2, 3])]).     
+0002b0c0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0002b0d0: 2861 7272 6179 5f73 697a 6528 2261 2229  (array_size("a")
+0002b0e0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0002b0f0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0002b100: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0002b110: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0002b120: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002b130: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002b140: 7c33 2020 2020 2020 2020 207c 0a20 2020  |3         |.   
+0002b150: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002b160: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0002b170: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0002b180: 2020 6120 3d20 5f74 6f5f 636f 6c5f 6966    a = _to_col_if
+0002b190: 5f73 7472 2861 7272 6179 2c20 2261 7272  _str(array, "arr
+0002b1a0: 6179 5f73 697a 6522 290a 2020 2020 7265  ay_size").    re
+0002b1b0: 7475 726e 2062 7569 6c74 696e 2822 6172  turn builtin("ar
+0002b1c0: 7261 795f 7369 7a65 2229 2861 290a 0a0a  ray_size")(a)...
+0002b1d0: 6465 6620 6172 7261 795f 736c 6963 6528  def array_slice(
+0002b1e0: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
+0002b1f0: 616d 652c 2066 726f 6d5f 3a20 436f 6c75  ame, from_: Colu
+0002b200: 6d6e 4f72 4e61 6d65 2c20 746f 3a20 436f  mnOrName, to: Co
+0002b210: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0002b220: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0002b230: 7475 726e 7320 616e 2041 5252 4159 2063  turns an ARRAY c
+0002b240: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
+0002b250: 6120 7370 6563 6966 6965 6420 7375 6273  a specified subs
+0002b260: 6574 206f 6620 656c 656d 656e 7473 206f  et of elements o
+0002b270: 6620 7468 6520 696e 7075 7420 4152 5241  f the input ARRA
+0002b280: 592e 0a0a 2020 2020 4172 6773 3a0a 2020  Y...    Args:.  
+0002b290: 2020 2020 2020 6172 7261 793a 2043 6f6c        array: Col
+0002b2a0: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
+0002b2b0: 6865 2073 6f75 7263 6520 4152 5241 592e  he source ARRAY.
+0002b2c0: 0a20 2020 2020 2020 2066 726f 6d5f 3a20  .        from_: 
+0002b2d0: 436f 6c75 6d6e 2063 6f6e 7461 696e 696e  Column containin
+0002b2e0: 6720 6120 706f 7369 7469 6f6e 2069 6e20  g a position in 
+0002b2f0: 7468 6520 736f 7572 6365 2041 5252 4159  the source ARRAY
+0002b300: 2e20 5468 6520 706f 7369 7469 6f6e 206f  . The position o
+0002b310: 6620 7468 6520 6669 7273 740a 2020 2020  f the first.    
+0002b320: 2020 2020 2020 2020 656c 656d 656e 7420          element 
+0002b330: 6973 2030 2e20 456c 656d 656e 7473 2066  is 0. Elements f
+0002b340: 726f 6d20 706f 7369 7469 6f6e 7320 6c65  rom positions le
+0002b350: 7373 2074 6861 6e20 7468 6973 2070 6172  ss than this par
+0002b360: 616d 6574 6572 2061 7265 0a20 2020 2020  ameter are.     
+0002b370: 2020 2020 2020 206e 6f74 2069 6e63 6c75         not inclu
+0002b380: 6465 6420 696e 2074 6865 2072 6573 756c  ded in the resul
+0002b390: 7469 6e67 2041 5252 4159 2e0a 2020 2020  ting ARRAY..    
+0002b3a0: 2020 2020 746f 3a20 436f 6c75 6d6e 2063      to: Column c
+0002b3b0: 6f6e 7461 696e 696e 6720 6120 706f 7369  ontaining a posi
+0002b3c0: 7469 6f6e 2069 6e20 7468 6520 736f 7572  tion in the sour
+0002b3d0: 6365 2041 5252 4159 2e20 456c 656d 656e  ce ARRAY. Elemen
+0002b3e0: 7473 2066 726f 6d20 706f 7369 7469 6f6e  ts from position
+0002b3f0: 7320 6571 7561 6c20 746f 0a20 2020 2020  s equal to.     
+0002b400: 2020 2020 2020 206f 7220 6772 6561 7465         or greate
+0002b410: 7220 7468 616e 2074 6869 7320 7061 7261  r than this para
+0002b420: 6d65 7465 7220 6172 6520 6e6f 7420 696e  meter are not in
+0002b430: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
+0002b440: 7375 6c74 696e 6720 6172 7261 792e 0a0a  sulting array...
+0002b450: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0002b460: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002b470: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002b480: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+0002b490: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002b4a0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0002b4b0: 6166 7261 6d65 285b 526f 7728 613d 5b31  aframe([Row(a=[1
+0002b4c0: 2c20 322c 2033 2c20 342c 2035 5d29 5d29  , 2, 3, 4, 5])])
+0002b4d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002b4e0: 7365 6c65 6374 2861 7272 6179 5f73 6c69  select(array_sli
+0002b4f0: 6365 2822 6122 2c20 6c69 7428 3129 2c20  ce("a", lit(1), 
+0002b500: 6c69 7428 3329 292e 616c 6961 7328 2272  lit(3)).alias("r
+0002b510: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0002b520: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002b530: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002b540: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0002b550: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002b560: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+0002b570: 2020 7c0a 2020 2020 2020 2020 7c20 2032    |.        |  2
+0002b580: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+0002b590: 207c 2020 3320 2020 2020 2020 7c0a 2020   |  3       |.  
+0002b5a0: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+0002b5b0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002b5c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002b5d0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0002b5e0: 2222 220a 2020 2020 6120 3d20 5f74 6f5f  """.    a = _to_
+0002b5f0: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
+0002b600: 2c20 2261 7272 6179 5f73 6c69 6365 2229  , "array_slice")
+0002b610: 0a20 2020 2066 203d 205f 746f 5f63 6f6c  .    f = _to_col
+0002b620: 5f69 665f 7374 7228 6672 6f6d 5f2c 2022  _if_str(from_, "
+0002b630: 6172 7261 795f 736c 6963 6522 290a 2020  array_slice").  
+0002b640: 2020 7420 3d20 5f74 6f5f 636f 6c5f 6966    t = _to_col_if
+0002b650: 5f73 7472 2874 6f2c 2022 6172 7261 795f  _str(to, "array_
+0002b660: 736c 6963 6522 290a 2020 2020 7265 7475  slice").    retu
+0002b670: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
+0002b680: 795f 736c 6963 6522 2928 612c 2066 2c20  y_slice")(a, f, 
+0002b690: 7429 0a0a 0a64 6566 2061 7272 6179 5f74  t)...def array_t
+0002b6a0: 6f5f 7374 7269 6e67 2861 7272 6179 3a20  o_string(array: 
+0002b6b0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7365  ColumnOrName, se
+0002b6c0: 7061 7261 746f 723a 2043 6f6c 756d 6e4f  parator: ColumnO
+0002b6d0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002b6e0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0002b6f0: 2061 6e20 696e 7075 7420 4152 5241 5920   an input ARRAY 
+0002b700: 636f 6e76 6572 7465 6420 746f 2061 2073  converted to a s
+0002b710: 7472 696e 6720 6279 2063 6173 7469 6e67  tring by casting
+0002b720: 2061 6c6c 2076 616c 7565 7320 746f 2073   all values to s
+0002b730: 7472 696e 6773 2028 7573 696e 670a 2020  trings (using.  
+0002b740: 2020 544f 5f56 4152 4348 4152 2920 616e    TO_VARCHAR) an
+0002b750: 6420 636f 6e63 6174 656e 6174 696e 6720  d concatenating 
+0002b760: 7468 656d 2028 7573 696e 6720 7468 6520  them (using the 
+0002b770: 7374 7269 6e67 2066 726f 6d20 7468 6520  string from the 
+0002b780: 7365 636f 6e64 2061 7267 756d 656e 7420  second argument 
+0002b790: 746f 2073 6570 6172 6174 650a 2020 2020  to separate.    
+0002b7a0: 7468 6520 656c 656d 656e 7473 292e 0a0a  the elements)...
+0002b7b0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0002b7c0: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
+0002b7d0: 636f 6e74 6169 6e69 6e67 2074 6865 2041  containing the A
+0002b7e0: 5252 4159 206f 6620 656c 656d 656e 7473  RRAY of elements
+0002b7f0: 2074 6f20 636f 6e76 6572 7420 746f 2061   to convert to a
+0002b800: 2073 7472 696e 672e 0a20 2020 2020 2020   string..       
+0002b810: 2073 6570 6172 6174 6f72 3a20 436f 6c75   separator: Colu
+0002b820: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
+0002b830: 6520 7374 7269 6e67 2074 6f20 7075 7420  e string to put 
+0002b840: 6265 7477 6565 6e20 6561 6368 2065 6c65  between each ele
+0002b850: 6d65 6e74 2028 652e 672e 2061 2073 7061  ment (e.g. a spa
+0002b860: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+0002b870: 636f 6d6d 612c 206f 7220 6f74 6865 7220  comma, or other 
+0002b880: 6875 6d61 6e2d 7265 6164 6162 6c65 2073  human-readable s
+0002b890: 6570 6172 6174 6f72 292e 0a0a 2020 2020  eparator)...    
+0002b8a0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0002b8b0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002b8c0: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
+0002b8d0: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
+0002b8e0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002b8f0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0002b900: 6d65 285b 526f 7728 613d 5b31 2c20 5472  me([Row(a=[1, Tr
+0002b910: 7565 2c20 2273 225d 295d 290a 2020 2020  ue, "s"])]).    
+0002b920: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002b930: 7428 6172 7261 795f 746f 5f73 7472 696e  t(array_to_strin
+0002b940: 6728 2261 222c 206c 6974 2822 2c22 2929  g("a", lit(","))
+0002b950: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0002b960: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0002b970: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0002b980: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0002b990: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002b9a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002b9b0: 7c31 2c74 7275 652c 7320 207c 0a20 2020  |1,true,s  |.   
+0002b9c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002b9d0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0002b9e0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0002b9f0: 2020 6120 3d20 5f74 6f5f 636f 6c5f 6966    a = _to_col_if
+0002ba00: 5f73 7472 2861 7272 6179 2c20 2261 7272  _str(array, "arr
+0002ba10: 6179 5f74 6f5f 7374 7269 6e67 2229 0a20  ay_to_string"). 
+0002ba20: 2020 2073 203d 205f 746f 5f63 6f6c 5f69     s = _to_col_i
+0002ba30: 665f 7374 7228 7365 7061 7261 746f 722c  f_str(separator,
+0002ba40: 2022 6172 7261 795f 746f 5f73 7472 696e   "array_to_strin
+0002ba50: 6722 290a 2020 2020 7265 7475 726e 2062  g").    return b
+0002ba60: 7569 6c74 696e 2822 6172 7261 795f 746f  uiltin("array_to
+0002ba70: 5f73 7472 696e 6722 2928 612c 2073 290a  _string")(a, s).
+0002ba80: 0a0a 6465 6620 6172 7261 795f 756e 6971  ..def array_uniq
+0002ba90: 7565 5f61 6767 2863 6f6c 3a20 436f 6c75  ue_agg(col: Colu
+0002baa0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002bab0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0002bac0: 726e 7320 6120 436f 6c75 6d6e 2063 6f6e  rns a Column con
+0002bad0: 7461 696e 696e 6720 7468 6520 6469 7374  taining the dist
+0002bae0: 696e 6374 2076 616c 7565 7320 696e 2074  inct values in t
+0002baf0: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
+0002bb00: 756d 6e20 636f 6c2e 0a20 2020 2054 6865  umn col..    The
+0002bb10: 2076 616c 7565 7320 696e 2074 6865 2043   values in the C
+0002bb20: 6f6c 756d 6e20 6172 6520 696e 206e 6f20  olumn are in no 
+0002bb30: 7061 7274 6963 756c 6172 206f 7264 6572  particular order
+0002bb40: 2c20 616e 6420 7468 6520 6f72 6465 7220  , and the order 
+0002bb50: 6973 206e 6f74 2064 6574 6572 6d69 6e69  is not determini
+0002bb60: 7374 6963 2e0a 2020 2020 5468 6520 6675  stic..    The fu
+0002bb70: 6e63 7469 6f6e 2069 676e 6f72 6573 204e  nction ignores N
+0002bb80: 554c 4c20 7661 6c75 6573 2069 6e20 636f  ULL values in co
+0002bb90: 6c2e 0a20 2020 2049 6620 636f 6c20 636f  l..    If col co
+0002bba0: 6e74 6169 6e73 206f 6e6c 7920 4e55 4c4c  ntains only NULL
+0002bbb0: 2076 616c 7565 7320 6f72 2063 6f6c 2069   values or col i
+0002bbc0: 7320 656d 7074 792c 2074 6865 2066 756e  s empty, the fun
+0002bbd0: 6374 696f 6e20 7265 7475 726e 7320 616e  ction returns an
+0002bbe0: 2065 6d70 7479 2043 6f6c 756d 6e2e 0a0a   empty Column...
+0002bbf0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0002bc00: 2020 636f 6c3a 2041 203a 636c 6173 733a    col: A :class:
+0002bc10: 6043 6f6c 756d 6e60 206f 626a 6563 7420  `Column` object 
+0002bc20: 6f72 2063 6f6c 756d 6e20 6e61 6d65 2074  or column name t
+0002bc30: 6861 7420 6465 7465 726d 696e 6573 2074  hat determines t
+0002bc40: 6865 2076 616c 7565 732e 0a0a 2020 2020  he values...    
+0002bc50: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0002bc60: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002bc70: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0002bc80: 616d 6528 5b5b 355d 2c20 5b32 5d2c 205b  ame([[5], [2], [
+0002bc90: 315d 2c20 5b32 5d2c 205b 315d 5d2c 2073  1], [2], [1]], s
+0002bca0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0002bcb0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002bcc0: 6374 2861 7272 6179 5f75 6e69 7175 655f  ct(array_unique_
+0002bcd0: 6167 6728 2261 2229 2e61 6c69 6173 2822  agg("a").alias("
+0002bce0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0002bcf0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002bd00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002bd10: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0002bd20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002bd30: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
+0002bd40: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0002bd50: 352c 2020 2020 2020 7c0a 2020 2020 2020  5,      |.      
+0002bd60: 2020 7c20 2032 2c20 2020 2020 207c 0a20    |  2,      |. 
+0002bd70: 2020 2020 2020 207c 2020 3120 2020 2020         |  1     
+0002bd80: 2020 7c0a 2020 2020 2020 2020 7c5d 2020    |.        |]  
+0002bd90: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0002bda0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0002bdb0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+0002bdc0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
+0002bdd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0002bde0: 2863 6f6c 2c20 2261 7272 6179 5f75 6e69  (col, "array_uni
+0002bdf0: 7175 655f 6167 6722 290a 2020 2020 7265  que_agg").    re
+0002be00: 7475 726e 205f 6361 6c6c 5f66 756e 6374  turn _call_funct
+0002be10: 696f 6e28 2261 7272 6179 5f75 6e69 7175  ion("array_uniqu
+0002be20: 655f 6167 6722 2c20 5472 7565 2c20 6329  e_agg", True, c)
+0002be30: 0a0a 0a64 6566 206f 626a 6563 745f 6167  ...def object_ag
+0002be40: 6728 6b65 793a 2043 6f6c 756d 6e4f 724e  g(key: ColumnOrN
+0002be50: 616d 652c 2076 616c 7565 3a20 436f 6c75  ame, value: Colu
+0002be60: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002be70: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0002be80: 726e 7320 6f6e 6520 4f42 4a45 4354 2070  rns one OBJECT p
+0002be90: 6572 2067 726f 7570 2e20 466f 7220 6561  er group. For ea
+0002bea0: 6368 206b 6579 2d76 616c 7565 2069 6e70  ch key-value inp
+0002beb0: 7574 2070 6169 722c 2077 6865 7265 206b  ut pair, where k
+0002bec0: 6579 206d 7573 7420 6265 2061 2056 4152  ey must be a VAR
+0002bed0: 4348 4152 0a20 2020 2061 6e64 2076 616c  CHAR.    and val
+0002bee0: 7565 206d 7573 7420 6265 2061 2056 4152  ue must be a VAR
+0002bef0: 4941 4e54 2c20 7468 6520 7265 7375 6c74  IANT, the result
+0002bf00: 696e 6720 4f42 4a45 4354 2063 6f6e 7461  ing OBJECT conta
+0002bf10: 696e 7320 6120 6b65 792d 7661 6c75 6520  ins a key-value 
+0002bf20: 6669 656c 642e 0a0a 2020 2020 4578 616d  field...    Exam
+0002bf30: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+0002bf40: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0002bf50: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0002bf60: 2069 6d70 6f72 7420 5374 7275 6374 5479   import StructTy
+0002bf70: 7065 2c20 5374 7275 6374 4669 656c 642c  pe, StructField,
+0002bf80: 2056 6172 6961 6e74 5479 7065 2c20 5374   VariantType, St
+0002bf90: 7269 6e67 5479 7065 0a20 2020 2020 2020  ringType.       
+0002bfa0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002bfb0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0002bfc0: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+0002bfd0: 2020 2020 5b5b 226e 616d 6522 2c20 224a      [["name", "J
+0002bfe0: 6f65 225d 2c20 5b22 7a69 7022 2c20 2239  oe"], ["zip", "9
+0002bff0: 3830 3034 225d 5d2c 0a20 2020 2020 2020  8004"]],.       
+0002c000: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+0002c010: 5374 7275 6374 5479 7065 285b 5374 7275  StructType([Stru
+0002c020: 6374 4669 656c 6428 226b 222c 2053 7472  ctField("k", Str
+0002c030: 696e 6754 7970 6528 2929 2c20 5374 7275  ingType()), Stru
+0002c040: 6374 4669 656c 6428 2276 222c 2056 6172  ctField("v", Var
+0002c050: 6961 6e74 5479 7065 2829 295d 290a 2020  iantType())]).  
+0002c060: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
+0002c070: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002c080: 7428 6f62 6a65 6374 5f61 6767 2863 6f6c  t(object_agg(col
+0002c090: 2822 6b22 292c 2063 6f6c 2822 7622 2929  ("k"), col("v"))
+0002c0a0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0002c0b0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0002c0c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0002c0d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002c0e0: 5245 5355 4c54 2220 2020 2020 2020 2020  RESULT"         
+0002c0f0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002c100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002c110: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+0002c120: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002c130: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
+0002c140: 224a 6f65 222c 2020 7c0a 2020 2020 2020  "Joe",  |.      
+0002c150: 2020 7c20 2022 7a69 7022 3a20 2239 3830    |  "zip": "980
+0002c160: 3034 2220 207c 0a20 2020 2020 2020 207c  04"  |.        |
+0002c170: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+0002c180: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002c190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c1a0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0002c1b0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0002c1c0: 206b 203d 205f 746f 5f63 6f6c 5f69 665f   k = _to_col_if_
+0002c1d0: 7374 7228 6b65 792c 2022 6f62 6a65 6374  str(key, "object
+0002c1e0: 5f61 6767 2229 0a20 2020 2076 203d 205f  _agg").    v = _
+0002c1f0: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002c200: 6c75 652c 2022 6f62 6a65 6374 5f61 6767  lue, "object_agg
+0002c210: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0002c220: 696c 7469 6e28 226f 626a 6563 745f 6167  iltin("object_ag
+0002c230: 6722 2928 6b2c 2076 290a 0a0a 6465 6620  g")(k, v)...def 
+0002c240: 6f62 6a65 6374 5f63 6f6e 7374 7275 6374  object_construct
+0002c250: 282a 6b65 795f 7661 6c75 6573 3a20 436f  (*key_values: Co
+0002c260: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0002c270: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0002c280: 7475 726e 7320 616e 204f 424a 4543 5420  turns an OBJECT 
+0002c290: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
+0002c2a0: 2074 6865 2061 7267 756d 656e 7473 2e0a   the arguments..
+0002c2b0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0002c2c0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0002c2d0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0002c2e0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0002c2f0: 2053 7472 7563 7454 7970 652c 2053 7472   StructType, Str
+0002c300: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
+0002c310: 7454 7970 652c 2053 7472 696e 6754 7970  tType, StringTyp
+0002c320: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002c330: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002c340: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+0002c350: 2020 2020 202e 2e2e 2020 2020 205b 5b22       ...     [["
+0002c360: 6e61 6d65 222c 2022 4a6f 6522 5d2c 205b  name", "Joe"], [
+0002c370: 227a 6970 222c 2022 3938 3030 3422 5d2c  "zip", "98004"],
+0002c380: 5b22 6167 6522 2c20 4e6f 6e65 5d2c 205b  ["age", None], [
+0002c390: 4e6f 6e65 2c20 2276 616c 7565 225d 5d2c  None, "value"]],
+0002c3a0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0002c3b0: 2073 6368 656d 613d 5374 7275 6374 5479   schema=StructTy
+0002c3c0: 7065 285b 5374 7275 6374 4669 656c 6428  pe([StructField(
+0002c3d0: 226b 222c 2053 7472 696e 6754 7970 6528  "k", StringType(
+0002c3e0: 2929 2c20 5374 7275 6374 4669 656c 6428  )), StructField(
+0002c3f0: 2276 222c 2056 6172 6961 6e74 5479 7065  "v", VariantType
+0002c400: 2829 295d 290a 2020 2020 2020 2020 2e2e  ())]).        ..
+0002c410: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+0002c420: 6466 2e73 656c 6563 7428 6f62 6a65 6374  df.select(object
+0002c430: 5f63 6f6e 7374 7275 6374 2863 6f6c 2822  _construct(col("
+0002c440: 6b22 292c 2063 6f6c 2822 7622 2929 2e61  k"), col("v")).a
+0002c450: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0002c460: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0002c470: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c480: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0002c490: 5355 4c54 2220 2020 2020 2020 2020 207c  SULT"          |
+0002c4a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002c4b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002c4c0: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
+0002c4d0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002c4e0: 2020 207c 2020 226e 616d 6522 3a20 224a     |  "name": "J
+0002c4f0: 6f65 2220 2020 7c0a 2020 2020 2020 2020  oe"   |.        
+0002c500: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
+0002c510: 2020 207c 0a20 2020 2020 2020 207c 7b20     |.        |{ 
+0002c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c530: 7c0a 2020 2020 2020 2020 7c20 2022 7a69  |.        |  "zi
+0002c540: 7022 3a20 2239 3830 3034 2220 207c 0a20  p": "98004"  |. 
+0002c550: 2020 2020 2020 207c 7d20 2020 2020 2020         |}       
+0002c560: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002c570: 2020 2020 7c7b 7d20 2020 2020 2020 2020      |{}         
+0002c580: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0002c590: 207c 7b7d 2020 2020 2020 2020 2020 2020   |{}            
+0002c5a0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002c5b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c5c0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0002c5d0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0002c5e0: 2020 206b 7673 203d 205b 5f74 6f5f 636f     kvs = [_to_co
+0002c5f0: 6c5f 6966 5f73 7472 286b 762c 2022 6f62  l_if_str(kv, "ob
+0002c600: 6a65 6374 5f63 6f6e 7374 7275 6374 2229  ject_construct")
+0002c610: 2066 6f72 206b 7620 696e 206b 6579 5f76   for kv in key_v
+0002c620: 616c 7565 735d 0a20 2020 2072 6574 7572  alues].    retur
+0002c630: 6e20 6275 696c 7469 6e28 226f 626a 6563  n builtin("objec
+0002c640: 745f 636f 6e73 7472 7563 7422 2928 2a6b  t_construct")(*k
+0002c650: 7673 290a 0a0a 6465 6620 6f62 6a65 6374  vs)...def object
+0002c660: 5f63 6f6e 7374 7275 6374 5f6b 6565 705f  _construct_keep_
+0002c670: 6e75 6c6c 282a 6b65 795f 7661 6c75 6573  null(*key_values
+0002c680: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0002c690: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002c6a0: 2222 5265 7475 726e 7320 616e 206f 626a  ""Returns an obj
+0002c6b0: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
+0002c6c0: 6865 2063 6f6e 7465 6e74 7320 6f66 2074  he contents of t
+0002c6d0: 6865 2069 6e70 7574 2028 692e 652e 2073  he input (i.e. s
+0002c6e0: 6f75 7263 6529 206f 626a 6563 7420 7769  ource) object wi
+0002c6f0: 7468 206f 6e65 206f 7220 6d6f 7265 0a20  th one or more. 
+0002c700: 2020 206b 6579 7320 7265 6d6f 7665 642e     keys removed.
+0002c710: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002c720: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0002c730: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0002c740: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+0002c750: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
+0002c760: 7275 6374 4669 656c 642c 2056 6172 6961  ructField, Varia
+0002c770: 6e74 5479 7065 2c20 5374 7269 6e67 5479  ntType, StringTy
+0002c780: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+0002c790: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0002c7a0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+0002c7b0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
+0002c7c0: 226b 6579 5f31 222c 2022 6f6e 6522 5d2c  "key_1", "one"],
+0002c7d0: 205b 226b 6579 5f32 222c 204e 6f6e 655d   ["key_2", None]
+0002c7e0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+0002c7f0: 2020 2073 6368 656d 613d 5374 7275 6374     schema=Struct
+0002c800: 5479 7065 285b 5374 7275 6374 4669 656c  Type([StructFiel
+0002c810: 6428 226b 222c 2053 7472 696e 6754 7970  d("k", StringTyp
+0002c820: 6528 2929 2c20 5374 7275 6374 4669 656c  e()), StructFiel
+0002c830: 6428 2276 222c 2056 6172 6961 6e74 5479  d("v", VariantTy
+0002c840: 7065 2829 295d 290a 2020 2020 2020 2020  pe())]).        
+0002c850: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+0002c860: 3e20 6466 2e73 656c 6563 7428 6f62 6a65  > df.select(obje
+0002c870: 6374 5f63 6f6e 7374 7275 6374 5f6b 6565  ct_construct_kee
+0002c880: 705f 6e75 6c6c 2863 6f6c 2822 6b22 292c  p_null(col("k"),
+0002c890: 2063 6f6c 2822 7622 2929 2e61 6c69 6173   col("v")).alias
+0002c8a0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+0002c8b0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0002c8c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002c8d0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0002c8e0: 2220 2020 2020 2020 2020 207c 0a20 2020  "          |.   
+0002c8f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002c900: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002c910: 2020 7c7b 2020 2020 2020 2020 2020 2020    |{            
+0002c920: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002c930: 2020 226b 6579 5f31 223a 2022 6f6e 6522    "key_1": "one"
+0002c940: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
+0002c950: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0002c960: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
+0002c970: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+0002c980: 2020 2020 2020 7c20 2022 6b65 795f 3222        |  "key_2"
+0002c990: 3a20 6e75 6c6c 2020 207c 0a20 2020 2020  : null   |.     
+0002c9a0: 2020 207c 7d20 2020 2020 2020 2020 2020     |}           
+0002c9b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002c9c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c9d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0002c9e0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0002c9f0: 0a20 2020 206b 7673 203d 205b 5f74 6f5f  .    kvs = [_to_
+0002ca00: 636f 6c5f 6966 5f73 7472 286b 762c 2022  col_if_str(kv, "
+0002ca10: 6f62 6a65 6374 5f63 6f6e 7374 7275 6374  object_construct
+0002ca20: 5f6b 6565 705f 6e75 6c6c 2229 2066 6f72  _keep_null") for
+0002ca30: 206b 7620 696e 206b 6579 5f76 616c 7565   kv in key_value
+0002ca40: 735d 0a20 2020 2072 6574 7572 6e20 6275  s].    return bu
+0002ca50: 696c 7469 6e28 226f 626a 6563 745f 636f  iltin("object_co
+0002ca60: 6e73 7472 7563 745f 6b65 6570 5f6e 756c  nstruct_keep_nul
+0002ca70: 6c22 2928 2a6b 7673 290a 0a0a 6465 6620  l")(*kvs)...def 
+0002ca80: 6f62 6a65 6374 5f64 656c 6574 6528 6f62  object_delete(ob
+0002ca90: 6a3a 2043 6f6c 756d 6e4f 724e 616d 652c  j: ColumnOrName,
+0002caa0: 206b 6579 313a 2043 6f6c 756d 6e4f 724e   key1: ColumnOrN
+0002cab0: 616d 652c 202a 6b65 7973 3a20 436f 6c75  ame, *keys: Colu
+0002cac0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002cad0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0002cae0: 726e 7320 616e 206f 626a 6563 7420 636f  rns an object co
+0002caf0: 6e73 6973 7469 6e67 206f 6620 7468 6520  nsisting of the 
+0002cb00: 696e 7075 7420 6f62 6a65 6374 2077 6974  input object wit
+0002cb10: 6820 6f6e 6520 6f72 206d 6f72 6520 6b65  h one or more ke
+0002cb20: 7973 2072 656d 6f76 6564 2e0a 2020 2020  ys removed..    
+0002cb30: 5468 6520 696e 7075 7420 6b65 7920 6d75  The input key mu
+0002cb40: 7374 206e 6f74 2065 7869 7374 2069 6e20  st not exist in 
+0002cb50: 7468 6520 6f62 6a65 6374 2e0a 0a20 2020  the object...   
+0002cb60: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0002cb70: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0002cb80: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0002cb90: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+0002cba0: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
+0002cbb0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+0002cbc0: 6c28 0a20 2020 2020 2020 202e 2e2e 2020  l(.        ...  
+0002cbd0: 2020 2022 7365 6c65 6374 206f 626a 6563     "select objec
+0002cbe0: 745f 636f 6e73 7472 7563 7428 612c 622c  t_construct(a,b,
+0002cbf0: 632c 642c 652c 6629 2061 7320 6f62 6a20  c,d,e,f) as obj 
+0002cc00: 6672 6f6d 2022 0a20 2020 2020 2020 202e  from ".        .
+0002cc10: 2e2e 2020 2020 2022 7661 6c75 6573 2827  ..     "values('
+0002cc20: 6167 6527 2c20 3231 2c20 277a 6970 272c  age', 21, 'zip',
+0002cc30: 2032 3130 3231 2c20 276e 616d 6527 2c20   21021, 'name', 
+0002cc40: 274a 6f65 2729 2c22 0a20 2020 2020 2020  'Joe'),".       
+0002cc50: 202e 2e2e 2020 2020 2022 2827 6167 6527   ...     "('age'
+0002cc60: 2c20 3236 2c20 277a 6970 272c 2039 3430  , 26, 'zip', 940
+0002cc70: 3231 2c20 276e 616d 6527 2c20 274a 6179  21, 'name', 'Jay
+0002cc80: 2729 2061 7320 5428 612c 622c 632c 642c  ') as T(a,b,c,d,
+0002cc90: 652c 6629 220a 2020 2020 2020 2020 2e2e  e,f)".        ..
+0002cca0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+0002ccb0: 6466 2e73 656c 6563 7428 6f62 6a65 6374  df.select(object
+0002ccc0: 5f64 656c 6574 6528 636f 6c28 226f 626a  _delete(col("obj
+0002ccd0: 2229 2c20 6c69 7428 2261 6765 2229 292e  "), lit("age")).
+0002cce0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0002ccf0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0002cd00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002cd10: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002cd20: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
+0002cd30: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002cd40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002cd50: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
+0002cd60: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002cd70: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
+0002cd80: 4a6f 6522 2c20 207c 0a20 2020 2020 2020  Joe",  |.       
+0002cd90: 207c 2020 227a 6970 223a 2032 3130 3231   |  "zip": 21021
+0002cda0: 2020 2020 7c0a 2020 2020 2020 2020 7c7d      |.        |}
+0002cdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdc0: 207c 0a20 2020 2020 2020 207c 7b20 2020   |.        |{   
+0002cdd0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+0002cde0: 2020 2020 2020 2020 7c20 2022 6e61 6d65          |  "name
+0002cdf0: 223a 2022 4a61 7922 2c20 207c 0a20 2020  ": "Jay",  |.   
+0002ce00: 2020 2020 207c 2020 227a 6970 223a 2039       |  "zip": 9
+0002ce10: 3430 3231 2020 2020 7c0a 2020 2020 2020  4021    |.      
+0002ce20: 2020 7c7d 2020 2020 2020 2020 2020 2020    |}            
+0002ce30: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0002ce40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002ce50: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0002ce60: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0002ce70: 2020 2020 6f20 3d20 5f74 6f5f 636f 6c5f      o = _to_col_
+0002ce80: 6966 5f73 7472 286f 626a 2c20 226f 626a  if_str(obj, "obj
+0002ce90: 6563 745f 6465 6c65 7465 2229 0a20 2020  ect_delete").   
+0002cea0: 206b 3120 3d20 5f74 6f5f 636f 6c5f 6966   k1 = _to_col_if
+0002ceb0: 5f73 7472 286b 6579 312c 2022 6f62 6a65  _str(key1, "obje
+0002cec0: 6374 5f64 656c 6574 6522 290a 2020 2020  ct_delete").    
+0002ced0: 6b73 203d 205b 5f74 6f5f 636f 6c5f 6966  ks = [_to_col_if
+0002cee0: 5f73 7472 286b 2c20 226f 626a 6563 745f  _str(k, "object_
+0002cef0: 6465 6c65 7465 2229 2066 6f72 206b 2069  delete") for k i
+0002cf00: 6e20 6b65 7973 5d0a 2020 2020 7265 7475  n keys].    retu
+0002cf10: 726e 2062 7569 6c74 696e 2822 6f62 6a65  rn builtin("obje
+0002cf20: 6374 5f64 656c 6574 6522 2928 6f2c 206b  ct_delete")(o, k
+0002cf30: 312c 202a 6b73 290a 0a0a 6465 6620 6f62  1, *ks)...def ob
+0002cf40: 6a65 6374 5f69 6e73 6572 7428 0a20 2020  ject_insert(.   
+0002cf50: 206f 626a 3a20 436f 6c75 6d6e 4f72 4e61   obj: ColumnOrNa
+0002cf60: 6d65 2c0a 2020 2020 6b65 793a 2043 6f6c  me,.    key: Col
+0002cf70: 756d 6e4f 724e 616d 652c 0a20 2020 2076  umnOrName,.    v
+0002cf80: 616c 7565 3a20 436f 6c75 6d6e 4f72 4e61  alue: ColumnOrNa
+0002cf90: 6d65 2c0a 2020 2020 7570 6461 7465 5f66  me,.    update_f
+0002cfa0: 6c61 673a 204f 7074 696f 6e61 6c5b 436f  lag: Optional[Co
+0002cfb0: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
+0002cfc0: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
+0002cfd0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0002cfe0: 616e 206f 626a 6563 7420 636f 6e73 6973  an object consis
+0002cff0: 7469 6e67 206f 6620 7468 6520 696e 7075  ting of the inpu
+0002d000: 7420 6f62 6a65 6374 2077 6974 6820 6120  t object with a 
+0002d010: 6e65 7720 6b65 792d 7661 6c75 6520 7061  new key-value pa
+0002d020: 6972 2069 6e73 6572 7465 6420 286f 7220  ir inserted (or 
+0002d030: 616e 0a20 2020 2065 7869 7374 696e 6720  an.    existing 
+0002d040: 6b65 7920 7570 6461 7465 6420 7769 7468  key updated with
+0002d050: 2061 206e 6577 2076 616c 7565 292e 0a0a   a new value)...
+0002d060: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0002d070: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002d080: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002d090: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+0002d0a0: 7274 206c 6974 0a20 2020 2020 2020 203e  rt lit.        >
+0002d0b0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002d0c0: 7371 6c28 0a20 2020 2020 2020 202e 2e2e  sql(.        ...
+0002d0d0: 2020 2020 2022 7365 6c65 6374 206f 626a       "select obj
+0002d0e0: 6563 745f 636f 6e73 7472 7563 7428 612c  ect_construct(a,
+0002d0f0: 622c 632c 642c 652c 6629 2061 7320 6f62  b,c,d,e,f) as ob
+0002d100: 6a2c 206b 2c20 7620 6672 6f6d 2022 0a20  j, k, v from ". 
+0002d110: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+0002d120: 7661 6c75 6573 2827 6167 6527 2c20 3231  values('age', 21
+0002d130: 2c20 277a 6970 272c 2032 3130 3231 2c20  , 'zip', 21021, 
+0002d140: 276e 616d 6527 2c20 274a 6f65 272c 2027  'name', 'Joe', '
+0002d150: 6167 6527 2c20 3029 2c22 0a20 2020 2020  age', 0),".     
+0002d160: 2020 202e 2e2e 2020 2020 2022 2827 6167     ...     "('ag
+0002d170: 6527 2c20 3236 2c20 277a 6970 272c 2039  e', 26, 'zip', 9
+0002d180: 3430 3231 2c20 276e 616d 6527 2c20 274a  4021, 'name', 'J
+0002d190: 6179 272c 2027 6167 6527 2c20 3029 2061  ay', 'age', 0) a
+0002d1a0: 7320 5428 612c 622c 632c 642c 652c 662c  s T(a,b,c,d,e,f,
+0002d1b0: 6b2c 7629 220a 2020 2020 2020 2020 2e2e  k,v)".        ..
+0002d1c0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+0002d1d0: 6466 2e73 656c 6563 7428 6f62 6a65 6374  df.select(object
+0002d1e0: 5f69 6e73 6572 7428 636f 6c28 226f 626a  _insert(col("obj
+0002d1f0: 2229 2c20 6c69 7428 226b 6579 2229 2c20  "), lit("key"), 
+0002d200: 6c69 7428 2276 2229 292e 616c 6961 7328  lit("v")).alias(
+0002d210: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0002d220: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0002d230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002d240: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0002d250: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002d260: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002d270: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002d280: 207c 7b20 2020 2020 2020 2020 2020 2020   |{             
+0002d290: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0002d2a0: 2022 6167 6522 3a20 3231 2c20 2020 2020   "age": 21,     
+0002d2b0: 207c 0a20 2020 2020 2020 207c 2020 226b   |.        |  "k
+0002d2c0: 6579 223a 2022 7622 2c20 2020 2020 7c0a  ey": "v",     |.
+0002d2d0: 2020 2020 2020 2020 7c20 2022 6e61 6d65          |  "name
+0002d2e0: 223a 2022 4a6f 6522 2c20 207c 0a20 2020  ": "Joe",  |.   
+0002d2f0: 2020 2020 207c 2020 227a 6970 223a 2032       |  "zip": 2
+0002d300: 3130 3231 2020 2020 7c0a 2020 2020 2020  1021    |.      
+0002d310: 2020 7c7d 2020 2020 2020 2020 2020 2020    |}            
+0002d320: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002d330: 7b20 2020 2020 2020 2020 2020 2020 2020  {               
+0002d340: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+0002d350: 6167 6522 3a20 3236 2c20 2020 2020 207c  age": 26,      |
+0002d360: 0a20 2020 2020 2020 207c 2020 226b 6579  .        |  "key
+0002d370: 223a 2022 7622 2c20 2020 2020 7c0a 2020  ": "v",     |.  
+0002d380: 2020 2020 2020 7c20 2022 6e61 6d65 223a        |  "name":
+0002d390: 2022 4a61 7922 2c20 207c 0a20 2020 2020   "Jay",  |.     
+0002d3a0: 2020 207c 2020 227a 6970 223a 2039 3430     |  "zip": 940
+0002d3b0: 3231 2020 2020 7c0a 2020 2020 2020 2020  21    |.        
+0002d3c0: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
+0002d3d0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0002d3e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d3f0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0002d400: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0002d410: 2020 6f20 3d20 5f74 6f5f 636f 6c5f 6966    o = _to_col_if
+0002d420: 5f73 7472 286f 626a 2c20 226f 626a 6563  _str(obj, "objec
+0002d430: 745f 696e 7365 7274 2229 0a20 2020 206b  t_insert").    k
+0002d440: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0002d450: 7228 6b65 792c 2022 6f62 6a65 6374 5f69  r(key, "object_i
+0002d460: 6e73 6572 7422 290a 2020 2020 7620 3d20  nsert").    v = 
+0002d470: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2876  _to_col_if_str(v
+0002d480: 616c 7565 2c20 226f 626a 6563 745f 696e  alue, "object_in
+0002d490: 7365 7274 2229 0a20 2020 2075 6620 3d20  sert").    uf = 
+0002d4a0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2875  _to_col_if_str(u
+0002d4b0: 7064 6174 655f 666c 6167 2c20 2275 7064  pdate_flag, "upd
+0002d4c0: 6174 655f 666c 6167 2229 2069 6620 7570  ate_flag") if up
+0002d4d0: 6461 7465 5f66 6c61 6720 6973 206e 6f74  date_flag is not
+0002d4e0: 204e 6f6e 6520 656c 7365 204e 6f6e 650a   None else None.
+0002d4f0: 2020 2020 6966 2075 6620 6973 206e 6f74      if uf is not
+0002d500: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+0002d510: 6574 7572 6e20 6275 696c 7469 6e28 226f  eturn builtin("o
+0002d520: 626a 6563 745f 696e 7365 7274 2229 286f  bject_insert")(o
+0002d530: 2c20 6b2c 2076 2c20 7566 290a 2020 2020  , k, v, uf).    
+0002d540: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+0002d550: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
+0002d560: 6a65 6374 5f69 6e73 6572 7422 2928 6f2c  ject_insert")(o,
+0002d570: 206b 2c20 7629 0a0a 0a64 6566 206f 626a   k, v)...def obj
+0002d580: 6563 745f 7069 636b 286f 626a 3a20 436f  ect_pick(obj: Co
+0002d590: 6c75 6d6e 4f72 4e61 6d65 2c20 6b65 7931  lumnOrName, key1
+0002d5a0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0002d5b0: 2a6b 6579 733a 2043 6f6c 756d 6e4f 724e  *keys: ColumnOrN
+0002d5c0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002d5d0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+0002d5e0: 206e 6577 204f 424a 4543 5420 636f 6e74   new OBJECT cont
+0002d5f0: 6169 6e69 6e67 2073 6f6d 6520 6f66 2074  aining some of t
+0002d600: 6865 206b 6579 2d76 616c 7565 2070 6169  he key-value pai
+0002d610: 7273 2066 726f 6d20 616e 2065 7869 7374  rs from an exist
+0002d620: 696e 6720 6f62 6a65 6374 2e0a 0a20 2020  ing object...   
+0002d630: 2054 6f20 6964 656e 7469 6679 2074 6865   To identify the
+0002d640: 206b 6579 2d76 616c 7565 2070 6169 7273   key-value pairs
+0002d650: 2074 6f20 696e 636c 7564 6520 696e 2074   to include in t
+0002d660: 6865 206e 6577 206f 626a 6563 742c 2070  he new object, p
+0002d670: 6173 7320 696e 2074 6865 206b 6579 7320  ass in the keys 
+0002d680: 6173 2061 7267 756d 656e 7473 2c0a 2020  as arguments,.  
+0002d690: 2020 6f72 2070 6173 7320 696e 2061 6e20    or pass in an 
+0002d6a0: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
+0002d6b0: 2074 6865 206b 6579 732e 0a0a 2020 2020   the keys...    
+0002d6c0: 4966 2061 2073 7065 6369 6669 6564 206b  If a specified k
+0002d6d0: 6579 2069 7320 6e6f 7420 7072 6573 656e  ey is not presen
+0002d6e0: 7420 696e 2074 6865 2069 6e70 7574 206f  t in the input o
+0002d6f0: 626a 6563 742c 2074 6865 206b 6579 2069  bject, the key i
+0002d700: 7320 6967 6e6f 7265 642e 0a0a 2020 2020  s ignored...    
+0002d710: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0002d720: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002d730: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+0002d740: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
+0002d750: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
+0002d760: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
+0002d770: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0002d780: 2022 7365 6c65 6374 206f 626a 6563 745f   "select object_
+0002d790: 636f 6e73 7472 7563 7428 612c 622c 632c  construct(a,b,c,
+0002d7a0: 642c 652c 6629 2061 7320 6f62 6a2c 206b  d,e,f) as obj, k
+0002d7b0: 2c20 7620 6672 6f6d 2022 0a20 2020 2020  , v from ".     
+0002d7c0: 2020 202e 2e2e 2020 2020 2022 7661 6c75     ...     "valu
+0002d7d0: 6573 2827 6167 6527 2c20 3231 2c20 277a  es('age', 21, 'z
+0002d7e0: 6970 272c 2032 3130 3231 2c20 276e 616d  ip', 21021, 'nam
+0002d7f0: 6527 2c20 274a 6f65 272c 2027 6167 6527  e', 'Joe', 'age'
+0002d800: 2c20 3029 2c22 0a20 2020 2020 2020 202e  , 0),".        .
+0002d810: 2e2e 2020 2020 2022 2827 6167 6527 2c20  ..     "('age', 
+0002d820: 3236 2c20 277a 6970 272c 2039 3430 3231  26, 'zip', 94021
+0002d830: 2c20 276e 616d 6527 2c20 274a 6179 272c  , 'name', 'Jay',
+0002d840: 2027 6167 6527 2c20 3029 2061 7320 5428   'age', 0) as T(
+0002d850: 612c 622c 632c 642c 652c 662c 6b2c 7629  a,b,c,d,e,f,k,v)
+0002d860: 220a 2020 2020 2020 2020 2e2e 2e20 290a  ".        ... ).
+0002d870: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002d880: 656c 6563 7428 6f62 6a65 6374 5f70 6963  elect(object_pic
+0002d890: 6b28 636f 6c28 226f 626a 2229 2c20 636f  k(col("obj"), co
+0002d8a0: 6c28 226b 2229 2c20 6c69 7428 226e 616d  l("k"), lit("nam
+0002d8b0: 6522 2929 2e61 6c69 6173 2822 7265 7375  e")).alias("resu
+0002d8c0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0002d8d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002d8e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002d8f0: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
+0002d900: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0002d910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d920: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
+0002d930: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002d940: 2020 2020 207c 2020 2261 6765 223a 2032       |  "age": 2
+0002d950: 312c 2020 2020 207c 0a20 2020 2020 2020  1,     |.       
+0002d960: 207c 2020 226e 616d 6522 3a20 224a 6f65   |  "name": "Joe
+0002d970: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+0002d980: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0002d990: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
+0002d9a0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002d9b0: 2020 2020 207c 2020 2261 6765 223a 2032       |  "age": 2
+0002d9c0: 362c 2020 2020 207c 0a20 2020 2020 2020  6,     |.       
+0002d9d0: 207c 2020 226e 616d 6522 3a20 224a 6179   |  "name": "Jay
+0002d9e0: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+0002d9f0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0002da00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002da10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002da20: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0002da30: 0a20 2020 2022 2222 0a20 2020 206f 203d  .    """.    o =
+0002da40: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002da50: 6f62 6a2c 2022 6f62 6a65 6374 5f70 6963  obj, "object_pic
+0002da60: 6b22 290a 2020 2020 6b31 203d 205f 746f  k").    k1 = _to
+0002da70: 5f63 6f6c 5f69 665f 7374 7228 6b65 7931  _col_if_str(key1
+0002da80: 2c20 226f 626a 6563 745f 7069 636b 2229  , "object_pick")
+0002da90: 0a20 2020 206b 7320 3d20 5b5f 746f 5f63  .    ks = [_to_c
+0002daa0: 6f6c 5f69 665f 7374 7228 6b2c 2022 6f62  ol_if_str(k, "ob
+0002dab0: 6a65 6374 5f70 6963 6b22 2920 666f 7220  ject_pick") for 
+0002dac0: 6b20 696e 206b 6579 735d 0a20 2020 2072  k in keys].    r
+0002dad0: 6574 7572 6e20 6275 696c 7469 6e28 226f  eturn builtin("o
+0002dae0: 626a 6563 745f 7069 636b 2229 286f 2c20  bject_pick")(o, 
+0002daf0: 6b31 2c20 2a6b 7329 0a0a 0a64 6566 2061  k1, *ks)...def a
+0002db00: 7363 2863 3a20 436f 6c75 6d6e 4f72 4e61  sc(c: ColumnOrNa
+0002db10: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002db20: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+0002db30: 436f 6c75 6d6e 2065 7870 7265 7373 696f  Column expressio
+0002db40: 6e20 7769 7468 2076 616c 7565 7320 736f  n with values so
+0002db50: 7274 6564 2069 6e20 6173 6365 6e64 696e  rted in ascendin
+0002db60: 6720 6f72 6465 722e 0a0a 2020 2020 4578  g order...    Ex
+0002db70: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0002db80: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002db90: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0002dba0: 6d65 285b 4e6f 6e65 2c20 332c 2032 2c20  me([None, 3, 2, 
+0002dbb0: 312c 204e 6f6e 655d 2c20 7363 6865 6d61  1, None], schema
+0002dbc0: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+0002dbd0: 3e3e 3e20 6466 2e73 6f72 7428 6173 6328  >>> df.sort(asc(
+0002dbe0: 6466 5b22 6122 5d29 292e 636f 6c6c 6563  df["a"])).collec
+0002dbf0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0002dc00: 2841 3d4e 6f6e 6529 2c20 526f 7728 413d  (A=None), Row(A=
+0002dc10: 4e6f 6e65 292c 2052 6f77 2841 3d31 292c  None), Row(A=1),
+0002dc20: 2052 6f77 2841 3d32 292c 2052 6f77 2841   Row(A=2), Row(A
+0002dc30: 3d33 295d 0a20 2020 2022 2222 0a20 2020  =3)].    """.   
+0002dc40: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0002dc50: 7374 7228 632c 2022 6173 6322 290a 2020  str(c, "asc").  
+0002dc60: 2020 7265 7475 726e 2063 2e61 7363 2829    return c.asc()
+0002dc70: 0a0a 0a64 6566 2061 7363 5f6e 756c 6c73  ...def asc_nulls
+0002dc80: 5f66 6972 7374 2863 3a20 436f 6c75 6d6e  _first(c: Column
+0002dc90: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0002dca0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+0002dcb0: 7320 6120 436f 6c75 6d6e 2065 7870 7265  s a Column expre
+0002dcc0: 7373 696f 6e20 7769 7468 2076 616c 7565  ssion with value
+0002dcd0: 7320 736f 7274 6564 2069 6e20 6173 6365  s sorted in asce
+0002dce0: 6e64 696e 6720 6f72 6465 720a 2020 2020  nding order.    
+0002dcf0: 286e 756c 6c20 7661 6c75 6573 2073 6f72  (null values sor
+0002dd00: 7465 6420 6265 666f 7265 206e 6f6e 2d6e  ted before non-n
+0002dd10: 756c 6c20 7661 6c75 6573 292e 0a0a 2020  ull values)...  
+0002dd20: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0002dd30: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002dd40: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0002dd50: 6166 7261 6d65 285b 4e6f 6e65 2c20 332c  aframe([None, 3,
+0002dd60: 2032 2c20 312c 204e 6f6e 655d 2c20 7363   2, 1, None], sc
+0002dd70: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0002dd80: 2020 2020 3e3e 3e20 6466 2e73 6f72 7428      >>> df.sort(
+0002dd90: 6173 635f 6e75 6c6c 735f 6669 7273 7428  asc_nulls_first(
+0002dda0: 6466 5b22 6122 5d29 292e 636f 6c6c 6563  df["a"])).collec
+0002ddb0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0002ddc0: 2841 3d4e 6f6e 6529 2c20 526f 7728 413d  (A=None), Row(A=
+0002ddd0: 4e6f 6e65 292c 2052 6f77 2841 3d31 292c  None), Row(A=1),
+0002dde0: 2052 6f77 2841 3d32 292c 2052 6f77 2841   Row(A=2), Row(A
+0002ddf0: 3d33 295d 0a20 2020 2022 2222 0a20 2020  =3)].    """.   
+0002de00: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0002de10: 7374 7228 632c 2022 6173 635f 6e75 6c6c  str(c, "asc_null
+0002de20: 735f 6669 7273 7422 290a 2020 2020 7265  s_first").    re
+0002de30: 7475 726e 2063 2e61 7363 5f6e 756c 6c73  turn c.asc_nulls
+0002de40: 5f66 6972 7374 2829 0a0a 0a64 6566 2061  _first()...def a
+0002de50: 7363 5f6e 756c 6c73 5f6c 6173 7428 633a  sc_nulls_last(c:
+0002de60: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0002de70: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002de80: 2252 6574 7572 6e73 2061 2043 6f6c 756d  "Returns a Colum
+0002de90: 6e20 6578 7072 6573 7369 6f6e 2077 6974  n expression wit
+0002dea0: 6820 7661 6c75 6573 2073 6f72 7465 6420  h values sorted 
+0002deb0: 696e 2061 7363 656e 6469 6e67 206f 7264  in ascending ord
+0002dec0: 6572 0a20 2020 2028 6e75 6c6c 2076 616c  er.    (null val
+0002ded0: 7565 7320 736f 7274 6564 2061 6674 6572  ues sorted after
+0002dee0: 206e 6f6e 2d6e 756c 6c20 7661 6c75 6573   non-null values
+0002def0: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
+0002df00: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0002df10: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0002df20: 7465 5f64 6174 6166 7261 6d65 285b 4e6f  te_dataframe([No
+0002df30: 6e65 2c20 332c 2032 2c20 312c 204e 6f6e  ne, 3, 2, 1, Non
+0002df40: 655d 2c20 7363 6865 6d61 3d5b 2261 225d  e], schema=["a"]
+0002df50: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002df60: 2e73 6f72 7428 6173 635f 6e75 6c6c 735f  .sort(asc_nulls_
+0002df70: 6c61 7374 2864 665b 2261 225d 2929 2e63  last(df["a"])).c
+0002df80: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0002df90: 205b 526f 7728 413d 3129 2c20 526f 7728   [Row(A=1), Row(
+0002dfa0: 413d 3229 2c20 526f 7728 413d 3329 2c20  A=2), Row(A=3), 
+0002dfb0: 526f 7728 413d 4e6f 6e65 292c 2052 6f77  Row(A=None), Row
+0002dfc0: 2841 3d4e 6f6e 6529 5d0a 2020 2020 2222  (A=None)].    ""
+0002dfd0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002dfe0: 6c5f 6966 5f73 7472 2863 2c20 2261 7363  l_if_str(c, "asc
+0002dff0: 5f6e 756c 6c73 5f6c 6173 7422 290a 2020  _nulls_last").  
+0002e000: 2020 7265 7475 726e 2063 2e61 7363 5f6e    return c.asc_n
+0002e010: 756c 6c73 5f6c 6173 7428 290a 0a0a 6465  ulls_last()...de
+0002e020: 6620 6465 7363 2863 3a20 436f 6c75 6d6e  f desc(c: Column
+0002e030: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0002e040: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+0002e050: 6574 7572 6e73 2061 2043 6f6c 756d 6e20  eturns a Column 
+0002e060: 6578 7072 6573 7369 6f6e 2077 6974 6820  expression with 
+0002e070: 7661 6c75 6573 2073 6f72 7465 6420 696e  values sorted in
+0002e080: 2064 6573 6365 6e64 696e 6720 6f72 6465   descending orde
+0002e090: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
+0002e0a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0002e0b0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0002e0c0: 7465 5f64 6174 6166 7261 6d65 285b 312c  te_dataframe([1,
+0002e0d0: 2032 2c20 332c 204e 6f6e 652c 204e 6f6e   2, 3, None, Non
+0002e0e0: 655d 2c20 7363 6865 6d61 3d5b 2261 225d  e], schema=["a"]
+0002e0f0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002e100: 2e73 6f72 7428 6465 7363 2864 665b 2261  .sort(desc(df["a
+0002e110: 225d 2929 2e63 6f6c 6c65 6374 2829 0a20  "])).collect(). 
+0002e120: 2020 2020 2020 205b 526f 7728 413d 3329         [Row(A=3)
+0002e130: 2c20 526f 7728 413d 3229 2c20 526f 7728  , Row(A=2), Row(
+0002e140: 413d 3129 2c20 526f 7728 413d 4e6f 6e65  A=1), Row(A=None
+0002e150: 292c 2052 6f77 2841 3d4e 6f6e 6529 5d0a  ), Row(A=None)].
+0002e160: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0002e170: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+0002e180: 2c20 2264 6573 6322 290a 2020 2020 7265  , "desc").    re
+0002e190: 7475 726e 2063 2e64 6573 6328 290a 0a0a  turn c.desc()...
+0002e1a0: 6465 6620 6465 7363 5f6e 756c 6c73 5f66  def desc_nulls_f
+0002e1b0: 6972 7374 2863 3a20 436f 6c75 6d6e 4f72  irst(c: ColumnOr
+0002e1c0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002e1d0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+0002e1e0: 7572 6e73 2061 2043 6f6c 756d 6e20 6578  urns a Column ex
+0002e1f0: 7072 6573 7369 6f6e 2077 6974 6820 7661  pression with va
+0002e200: 6c75 6573 2073 6f72 7465 6420 696e 2064  lues sorted in d
+0002e210: 6573 6365 6e64 696e 6720 6f72 6465 720a  escending order.
+0002e220: 2020 2020 286e 756c 6c20 7661 6c75 6573      (null values
+0002e230: 2073 6f72 7465 6420 6265 666f 7265 206e   sorted before n
+0002e240: 6f6e 2d6e 756c 6c20 7661 6c75 6573 292e  on-null values).
+0002e250: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002e260: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002e270: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0002e280: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
+0002e290: 2c20 332c 204e 6f6e 652c 204e 6f6e 655d  , 3, None, None]
+0002e2a0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0002e2b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002e2c0: 6f72 7428 6465 7363 5f6e 756c 6c73 5f66  ort(desc_nulls_f
+0002e2d0: 6972 7374 2864 665b 2261 225d 2929 2e63  irst(df["a"])).c
+0002e2e0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0002e2f0: 205b 526f 7728 413d 4e6f 6e65 292c 2052   [Row(A=None), R
+0002e300: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
+0002e310: 413d 3329 2c20 526f 7728 413d 3229 2c20  A=3), Row(A=2), 
+0002e320: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
+0002e330: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002e340: 6c5f 6966 5f73 7472 2863 2c20 2264 6573  l_if_str(c, "des
+0002e350: 635f 6e75 6c6c 735f 6669 7273 7422 290a  c_nulls_first").
+0002e360: 2020 2020 7265 7475 726e 2063 2e64 6573      return c.des
+0002e370: 635f 6e75 6c6c 735f 6669 7273 7428 290a  c_nulls_first().
+0002e380: 0a0a 6465 6620 6465 7363 5f6e 756c 6c73  ..def desc_nulls
+0002e390: 5f6c 6173 7428 633a 2043 6f6c 756d 6e4f  _last(c: ColumnO
+0002e3a0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002e3b0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0002e3c0: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
+0002e3d0: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
+0002e3e0: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
+0002e3f0: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
+0002e400: 0a20 2020 2028 6e75 6c6c 2076 616c 7565  .    (null value
+0002e410: 7320 736f 7274 6564 2061 6674 6572 206e  s sorted after n
+0002e420: 6f6e 2d6e 756c 6c20 7661 6c75 6573 292e  on-null values).
+0002e430: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002e440: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002e450: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0002e460: 6461 7461 6672 616d 6528 5b31 2c20 322c  dataframe([1, 2,
+0002e470: 2033 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c   3, None, None],
+0002e480: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0002e490: 2020 2020 2020 203e 3e3e 2064 662e 736f         >>> df.so
+0002e4a0: 7274 2864 6573 635f 6e75 6c6c 735f 6c61  rt(desc_nulls_la
+0002e4b0: 7374 2864 665b 2261 225d 2929 2e63 6f6c  st(df["a"])).col
+0002e4c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0002e4d0: 526f 7728 413d 3329 2c20 526f 7728 413d  Row(A=3), Row(A=
+0002e4e0: 3229 2c20 526f 7728 413d 3129 2c20 526f  2), Row(A=1), Ro
+0002e4f0: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
+0002e500: 3d4e 6f6e 6529 5d0a 2020 2020 2222 220a  =None)].    """.
+0002e510: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0002e520: 6966 5f73 7472 2863 2c20 2264 6573 635f  if_str(c, "desc_
+0002e530: 6e75 6c6c 735f 6c61 7374 2229 0a20 2020  nulls_last").   
+0002e540: 2072 6574 7572 6e20 632e 6465 7363 5f6e   return c.desc_n
+0002e550: 756c 6c73 5f6c 6173 7428 290a 0a0a 6465  ulls_last()...de
+0002e560: 6620 6173 5f61 7272 6179 2876 6172 6961  f as_array(varia
+0002e570: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
+0002e580: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0002e590: 2022 2222 4361 7374 7320 6120 5641 5249   """Casts a VARI
+0002e5a0: 414e 5420 7661 6c75 6520 746f 2061 6e20  ANT value to an 
+0002e5b0: 6172 7261 792e 0a0a 2020 2020 4578 616d  array...    Exam
+0002e5c0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+0002e5d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+0002e5e0: 716c 2822 7365 6c65 6374 2061 7272 6179  ql("select array
+0002e5f0: 5f63 6f6e 7374 7275 6374 2831 2c20 3229  _construct(1, 2)
+0002e600: 3a3a 7661 7269 616e 7420 6173 2061 2229  ::variant as a")
+0002e610: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002e620: 7365 6c65 6374 2861 735f 6172 7261 7928  select(as_array(
+0002e630: 2261 2229 2e61 6c69 6173 2822 7265 7375  "a").alias("resu
+0002e640: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0002e650: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002e660: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0002e670: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0002e680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0002e690: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
+0002e6a0: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
+0002e6b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0002e6c0: 2032 2020 2020 2020 207c 0a20 2020 2020   2       |.     
+0002e6d0: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+0002e6e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002e6f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0002e700: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0002e710: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002e720: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+0002e730: 2022 6173 5f61 7272 6179 2229 0a20 2020   "as_array").   
+0002e740: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0002e750: 2261 735f 6172 7261 7922 2928 6329 0a0a  "as_array")(c)..
+0002e760: 0a64 6566 2061 735f 6269 6e61 7279 2876  .def as_binary(v
+0002e770: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002e780: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002e790: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002e7a0: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002e7b0: 2061 2062 696e 6172 7920 7374 7269 6e67   a binary string
+0002e7c0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002e7d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002e7e0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
+0002e7f0: 656c 6563 7420 746f 5f62 696e 6172 7928  elect to_binary(
+0002e800: 2746 3041 3527 293a 3a76 6172 6961 6e74  'F0A5')::variant
+0002e810: 2061 7320 6122 290a 2020 2020 2020 2020   as a").        
+0002e820: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
+0002e830: 5f62 696e 6172 7928 2261 2229 2e61 6c69  _binary("a").ali
+0002e840: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+0002e850: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0002e860: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002e870: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002e880: 7c22 5245 5355 4c54 2220 2020 2020 2020  |"RESULT"       
+0002e890: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002e8a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0002e8b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002e8c0: 2020 2020 2020 7c62 7974 6561 7272 6179        |bytearray
+0002e8d0: 2862 275c 7866 305c 7861 3527 2920 207c  (b'\xf0\xa5')  |
+0002e8e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002e8f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002e900: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0002e910: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0002e920: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0002e930: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
+0002e940: 2261 735f 6269 6e61 7279 2229 0a20 2020  "as_binary").   
+0002e950: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0002e960: 2261 735f 6269 6e61 7279 2229 2863 290a  "as_binary")(c).
+0002e970: 0a0a 6465 6620 6173 5f63 6861 7228 7661  ..def as_char(va
+0002e980: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
+0002e990: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002e9a0: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
+0002e9b0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+0002e9c0: 6120 7374 7269 6e67 2e0a 0a20 2020 2045  a string...    E
+0002e9d0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0002e9e0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002e9f0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+0002ea00: 6e63 7469 6f6e 7320 696d 706f 7274 2061  nctions import a
+0002ea10: 735f 6368 6172 2c20 746f 5f76 6172 6961  s_char, to_varia
+0002ea20: 6e74 0a20 2020 2020 2020 203e 3e3e 2064  nt.        >>> d
+0002ea30: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
+0002ea40: 2273 656c 6563 7420 2773 6f6d 6520 7374  "select 'some st
+0002ea50: 7269 6e67 2720 6173 2063 6861 7222 290a  ring' as char").
+0002ea60: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
+0002ea70: 6861 725f 7620 3d20 746f 5f76 6172 6961  har_v = to_varia
+0002ea80: 6e74 2864 662e 6368 6172 290a 2020 2020  nt(df.char).    
+0002ea90: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002eaa0: 7428 6466 2e63 6861 725f 762e 6173 5f28  t(df.char_v.as_(
+0002eab0: 2263 6861 7222 2929 2e63 6f6c 6c65 6374  "char")).collect
+0002eac0: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
+0002ead0: 6466 2e63 6861 7229 2e63 6f6c 6c65 6374  df.char).collect
+0002eae0: 2829 0a20 2020 2020 2020 2046 616c 7365  ().        False
+0002eaf0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002eb00: 7365 6c65 6374 2861 735f 6368 6172 2864  select(as_char(d
+0002eb10: 662e 6368 6172 5f76 292e 6173 5f28 2263  f.char_v).as_("c
+0002eb20: 6861 7222 2929 2e63 6f6c 6c65 6374 2829  har")).collect()
+0002eb30: 203d 3d20 6466 2e73 656c 6563 7428 6466   == df.select(df
+0002eb40: 2e63 6861 7229 2e63 6f6c 6c65 6374 2829  .char).collect()
+0002eb50: 0a20 2020 2020 2020 2054 7275 650a 2020  .        True.  
+0002eb60: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0002eb70: 6f5f 636f 6c5f 6966 5f73 7472 2876 6172  o_col_if_str(var
+0002eb80: 6961 6e74 2c20 2261 735f 6368 6172 2229  iant, "as_char")
+0002eb90: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0002eba0: 7469 6e28 2261 735f 6368 6172 2229 2863  tin("as_char")(c
+0002ebb0: 290a 0a0a 6465 6620 6173 5f76 6172 6368  )...def as_varch
+0002ebc0: 6172 2876 6172 6961 6e74 3a20 436f 6c75  ar(variant: Colu
+0002ebd0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002ebe0: 756d 6e3a 0a20 2020 2022 2222 4361 7374  umn:.    """Cast
+0002ebf0: 7320 6120 5641 5249 414e 5420 7661 6c75  s a VARIANT valu
+0002ec00: 6520 746f 2061 2073 7472 696e 672e 0a0a  e to a string...
+0002ec10: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002ec20: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002ec30: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002ec40: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+0002ec50: 6f72 7420 6173 5f76 6172 6368 6172 2c20  ort as_varchar, 
+0002ec60: 746f 5f76 6172 6961 6e74 0a20 2020 2020  to_variant.     
+0002ec70: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0002ec80: 696f 6e2e 7371 6c28 2273 656c 6563 7420  ion.sql("select 
+0002ec90: 2773 6f6d 6520 7374 7269 6e67 2720 6173  'some string' as
+0002eca0: 2063 6861 7222 290a 2020 2020 2020 2020   char").        
+0002ecb0: 3e3e 3e20 6466 2e63 6861 725f 7620 3d20  >>> df.char_v = 
+0002ecc0: 746f 5f76 6172 6961 6e74 2864 662e 6368  to_variant(df.ch
+0002ecd0: 6172 290a 2020 2020 2020 2020 3e3e 3e20  ar).        >>> 
+0002ece0: 6466 2e73 656c 6563 7428 6466 2e63 6861  df.select(df.cha
+0002ecf0: 725f 762e 6173 5f28 2263 6861 7222 2929  r_v.as_("char"))
+0002ed00: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
+0002ed10: 2e73 656c 6563 7428 6466 2e63 6861 7229  .select(df.char)
+0002ed20: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0002ed30: 2020 2046 616c 7365 0a20 2020 2020 2020     False.       
+0002ed40: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+0002ed50: 735f 7661 7263 6861 7228 6466 2e63 6861  s_varchar(df.cha
+0002ed60: 725f 7629 2e61 735f 2822 6368 6172 2229  r_v).as_("char")
+0002ed70: 292e 636f 6c6c 6563 7428 2920 3d3d 2064  ).collect() == d
+0002ed80: 662e 7365 6c65 6374 2864 662e 6368 6172  f.select(df.char
+0002ed90: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0002eda0: 2020 2020 5472 7565 0a20 2020 2022 2222      True.    """
+0002edb0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002edc0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+0002edd0: 2022 6173 5f76 6172 6368 6172 2229 0a20   "as_varchar"). 
+0002ede0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0002edf0: 6e28 2261 735f 7661 7263 6861 7222 2928  n("as_varchar")(
+0002ee00: 6329 0a0a 0a64 6566 2061 735f 6461 7465  c)...def as_date
+0002ee10: 2876 6172 6961 6e74 3a20 436f 6c75 6d6e  (variant: Column
+0002ee20: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0002ee30: 6e3a 0a20 2020 2022 2222 4361 7374 7320  n:.    """Casts 
+0002ee40: 6120 5641 5249 414e 5420 7661 6c75 6520  a VARIANT value 
+0002ee50: 746f 2061 2064 6174 652e 0a0a 2020 2020  to a date...    
+0002ee60: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0002ee70: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002ee80: 6f6e 2e73 716c 2822 7365 6c65 6374 2064  on.sql("select d
+0002ee90: 6174 6527 3230 3230 2d31 2d31 273a 3a76  ate'2020-1-1'::v
+0002eea0: 6172 6961 6e74 2061 7320 6122 290a 2020  ariant as a").  
+0002eeb0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0002eec0: 6563 7428 6173 5f64 6174 6528 2261 2229  ect(as_date("a")
+0002eed0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0002eee0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0002eef0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a   --------------.
+0002ef00: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0002ef10: 2220 2020 207c 0a20 2020 2020 2020 202d  "    |.        -
+0002ef20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002ef30: 2020 2020 2020 7c32 3032 302d 3031 2d30        |2020-01-0
+0002ef40: 3120 207c 0a20 2020 2020 2020 202d 2d2d  1  |.        ---
+0002ef50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0002ef60: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0002ef70: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0002ef80: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2876  _to_col_if_str(v
+0002ef90: 6172 6961 6e74 2c20 2261 735f 6461 7465  ariant, "as_date
+0002efa0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0002efb0: 696c 7469 6e28 2261 735f 6461 7465 2229  iltin("as_date")
+0002efc0: 2863 290a 0a0a 6465 6620 6361 7374 2863  (c)...def cast(c
+0002efd0: 6f6c 756d 6e3a 2043 6f6c 756d 6e4f 724e  olumn: ColumnOrN
+0002efe0: 616d 652c 2074 6f3a 2055 6e69 6f6e 5b73  ame, to: Union[s
+0002eff0: 7472 2c20 4461 7461 5479 7065 5d29 202d  tr, DataType]) -
+0002f000: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002f010: 2243 6f6e 7665 7274 7320 6120 7661 6c75  "Converts a valu
+0002f020: 6520 6f66 206f 6e65 2064 6174 6120 7479  e of one data ty
+0002f030: 7065 2069 6e74 6f20 616e 6f74 6865 7220  pe into another 
+0002f040: 6461 7461 2074 7970 652e 0a20 2020 2054  data type..    T
+0002f050: 6865 2073 656d 616e 7469 6373 206f 6620  he semantics of 
+0002f060: 4341 5354 2061 7265 2074 6865 2073 616d  CAST are the sam
+0002f070: 6520 6173 2074 6865 2073 656d 616e 7469  e as the semanti
+0002f080: 6373 206f 6620 7468 6520 636f 7272 6573  cs of the corres
+0002f090: 706f 6e64 696e 6720 746f 2064 6174 6174  ponding to datat
+0002f0a0: 7970 6520 636f 6e76 6572 7369 6f6e 2066  ype conversion f
+0002f0b0: 756e 6374 696f 6e73 2e0a 2020 2020 4966  unctions..    If
+0002f0c0: 2074 6865 2063 6173 7420 6973 206e 6f74   the cast is not
+0002f0d0: 2070 6f73 7369 626c 652c 2061 2060 6053   possible, a ``S
+0002f0e0: 6e6f 7770 6172 6b53 514c 4578 6365 7074  nowparkSQLExcept
+0002f0f0: 696f 6e60 6020 6578 6365 7074 696f 6e20  ion`` exception 
+0002f100: 6973 2074 6872 6f77 6e2e 0a0a 2020 2020  is thrown...    
+0002f110: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0002f120: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0002f130: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0002f140: 7970 6573 2069 6d70 6f72 7420 4465 6369  ypes import Deci
+0002f150: 6d61 6c54 7970 652c 2049 6e74 6567 6572  malType, Integer
+0002f160: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+0002f170: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0002f180: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0002f190: 5b31 2e35 3433 325d 5d2c 2073 6368 656d  [1.5432]], schem
+0002f1a0: 613d 5b22 6422 5d29 0a20 2020 2020 2020  a=["d"]).       
+0002f1b0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
+0002f1c0: 6173 7428 6466 2e64 2c20 4465 6369 6d61  ast(df.d, Decima
+0002f1d0: 6c54 7970 6528 3135 2c20 3229 292e 6173  lType(15, 2)).as
+0002f1e0: 5f28 2244 4543 494d 414c 2229 2c20 6361  _("DECIMAL"), ca
+0002f1f0: 7374 2864 662e 642c 2049 6e74 6567 6572  st(df.d, Integer
+0002f200: 5479 7065 2829 292e 6173 5f28 2249 4e54  Type()).as_("INT
+0002f210: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0002f220: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0002f230: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002f240: 207c 2244 4543 494d 414c 2220 207c 2249   |"DECIMAL"  |"I
+0002f250: 4e54 2220 207c 0a20 2020 2020 2020 202d  NT"  |.        -
+0002f260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002f270: 2d2d 2d2d 0a20 2020 2020 2020 207c 312e  ----.        |1.
+0002f280: 3534 2020 2020 2020 207c 3220 2020 2020  54       |2     
+0002f290: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002f2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002f2b0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0002f2c0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0002f2d0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+0002f2e0: 7374 7228 636f 6c75 6d6e 2c20 2263 6173  str(column, "cas
+0002f2f0: 7422 290a 2020 2020 7265 7475 726e 2063  t").    return c
+0002f300: 2e63 6173 7428 746f 290a 0a0a 6465 6620  .cast(to)...def 
+0002f310: 7472 795f 6361 7374 2863 6f6c 756d 6e3a  try_cast(column:
+0002f320: 2043 6f6c 756d 6e4f 724e 616d 652c 2074   ColumnOrName, t
+0002f330: 6f3a 2055 6e69 6f6e 5b73 7472 2c20 4461  o: Union[str, Da
+0002f340: 7461 5479 7065 5d29 202d 3e20 436f 6c75  taType]) -> Colu
+0002f350: 6d6e 3a0a 2020 2020 2222 2241 2073 7065  mn:.    """A spe
+0002f360: 6369 616c 2076 6572 7369 6f6e 206f 6620  cial version of 
+0002f370: 4341 5354 2066 6f72 2061 2073 7562 7365  CAST for a subse
+0002f380: 7420 6f66 2064 6174 6120 7479 7065 2063  t of data type c
+0002f390: 6f6e 7665 7273 696f 6e73 2e0a 2020 2020  onversions..    
+0002f3a0: 4974 2070 6572 666f 726d 7320 7468 6520  It performs the 
+0002f3b0: 7361 6d65 206f 7065 7261 7469 6f6e 2028  same operation (
+0002f3c0: 692e 652e 2063 6f6e 7665 7274 7320 6120  i.e. converts a 
+0002f3d0: 7661 6c75 6520 6f66 206f 6e65 2064 6174  value of one dat
+0002f3e0: 6120 7479 7065 2069 6e74 6f20 616e 6f74  a type into anot
+0002f3f0: 6865 7220 6461 7461 2074 7970 6529 2c0a  her data type),.
+0002f400: 2020 2020 6275 7420 7265 7475 726e 7320      but returns 
+0002f410: 6120 4e55 4c4c 2076 616c 7565 2069 6e73  a NULL value ins
+0002f420: 7465 6164 206f 6620 7261 6973 696e 6720  tead of raising 
+0002f430: 616e 2065 7272 6f72 2077 6865 6e20 7468  an error when th
+0002f440: 6520 636f 6e76 6572 7369 6f6e 2063 616e  e conversion can
+0002f450: 206e 6f74 2062 6520 7065 7266 6f72 6d65   not be performe
+0002f460: 642e 0a0a 2020 2020 5468 6520 6060 636f  d...    The ``co
+0002f470: 6c75 6d6e 6060 2061 7267 756d 656e 7420  lumn`` argument 
+0002f480: 6d75 7374 2062 6520 6120 7374 7269 6e67  must be a string
+0002f490: 2063 6f6c 756d 6e20 696e 2053 6e6f 7766   column in Snowf
+0002f4a0: 6c61 6b65 2e0a 0a20 2020 2045 7861 6d70  lake...    Examp
+0002f4b0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0002f4c0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+0002f4d0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+0002f4e0: 696d 706f 7274 2049 6e74 6567 6572 5479  import IntegerTy
+0002f4f0: 7065 2c20 466c 6f61 7454 7970 650a 2020  pe, FloatType.  
+0002f500: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0002f510: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0002f520: 7461 6672 616d 6528 5b27 3027 2c20 272d  taframe(['0', '-
+0002f530: 3132 272c 2027 3232 272c 2027 3130 3031  12', '22', '1001
+0002f540: 275d 2c20 7363 6865 6d61 3d5b 2261 225d  '], schema=["a"]
+0002f550: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002f560: 2e73 656c 6563 7428 7472 795f 6361 7374  .select(try_cast
+0002f570: 2863 6f6c 2822 6122 292c 2049 6e74 6567  (col("a"), Integ
+0002f580: 6572 5479 7065 2829 292e 6173 5f28 2761  erType()).as_('a
+0002f590: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
+0002f5a0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+0002f5b0: 3d30 292c 2052 6f77 2841 4e53 3d2d 3132  =0), Row(ANS=-12
+0002f5c0: 292c 2052 6f77 2841 4e53 3d32 3229 2c20  ), Row(ANS=22), 
+0002f5d0: 526f 7728 414e 533d 3130 3031 295d 0a0a  Row(ANS=1001)]..
+0002f5e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002f5f0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002f600: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0002f610: 6174 6166 7261 6d65 285b 2730 2e31 3227  ataframe(['0.12'
+0002f620: 2c20 2755 5344 2032 372e 3930 272c 2027  , 'USD 27.90', '
+0002f630: 3133 2e39 3720 5553 4427 2c20 27e2 82ac  13.97 USD', '...
+0002f640: 3937 2e30 272c 2027 3137 2c2d 275d 2c20  97.0', '17,-'], 
+0002f650: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+0002f660: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0002f670: 6563 7428 7472 795f 6361 7374 2863 6f6c  ect(try_cast(col
+0002f680: 2822 6122 292c 2046 6c6f 6174 5479 7065  ("a"), FloatType
+0002f690: 2829 292e 6173 5f28 2761 6e73 2729 292e  ()).as_('ans')).
+0002f6a0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002f6b0: 2020 5b52 6f77 2841 4e53 3d30 2e31 3229    [Row(ANS=0.12)
+0002f6c0: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
+0002f6d0: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+0002f6e0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+0002f6f0: 6f77 2841 4e53 3d4e 6f6e 6529 5d0a 0a20  ow(ANS=None)].. 
+0002f700: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002f710: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+0002f720: 6c75 6d6e 2c20 2274 7279 5f63 6173 7422  lumn, "try_cast"
+0002f730: 290a 2020 2020 7265 7475 726e 2063 2e74  ).    return c.t
+0002f740: 7279 5f63 6173 7428 746f 290a 0a0a 6465  ry_cast(to)...de
+0002f750: 6620 5f61 735f 6465 6369 6d61 6c5f 6f72  f _as_decimal_or
+0002f760: 5f6e 756d 6265 7228 0a20 2020 2063 6173  _number(.    cas
+0002f770: 745f 7479 7065 3a20 7374 722c 0a20 2020  t_type: str,.   
+0002f780: 2076 6172 6961 6e74 3a20 436f 6c75 6d6e   variant: Column
+0002f790: 4f72 4e61 6d65 2c0a 2020 2020 7072 6563  OrName,.    prec
+0002f7a0: 6973 696f 6e3a 204f 7074 696f 6e61 6c5b  ision: Optional[
+0002f7b0: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0002f7c0: 2073 6361 6c65 3a20 4f70 7469 6f6e 616c   scale: Optional
+0002f7d0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2920  [int] = None,.) 
+0002f7e0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0002f7f0: 2222 4865 6c70 6572 2066 756e 6374 696f  ""Helper functio
+0002f800: 6e20 7468 6174 2063 6173 7473 2061 2056  n that casts a V
+0002f810: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+0002f820: 6120 6465 6369 6d61 6c20 6f72 206e 756d  a decimal or num
+0002f830: 6265 722e 2222 220a 2020 2020 6320 3d20  ber.""".    c = 
+0002f840: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2876  _to_col_if_str(v
+0002f850: 6172 6961 6e74 2c20 6361 7374 5f74 7970  ariant, cast_typ
+0002f860: 6529 0a20 2020 2069 6620 7363 616c 6520  e).    if scale 
+0002f870: 616e 6420 6e6f 7420 7072 6563 6973 696f  and not precisio
+0002f880: 6e3a 0a20 2020 2020 2020 2072 6169 7365  n:.        raise
+0002f890: 2056 616c 7565 4572 726f 7228 2243 616e   ValueError("Can
+0002f8a0: 6e6f 7420 6465 6669 6e65 2073 6361 6c65  not define scale
+0002f8b0: 2077 6974 686f 7574 2070 7265 6369 7369   without precisi
+0002f8c0: 6f6e 2229 0a20 2020 2069 6620 7072 6563  on").    if prec
+0002f8d0: 6973 696f 6e20 616e 6420 7363 616c 653a  ision and scale:
+0002f8e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002f8f0: 6275 696c 7469 6e28 6361 7374 5f74 7970  builtin(cast_typ
+0002f900: 6529 2863 2c20 6c69 7428 7072 6563 6973  e)(c, lit(precis
+0002f910: 696f 6e29 2c20 6c69 7428 7363 616c 6529  ion), lit(scale)
+0002f920: 290a 2020 2020 656c 6966 2070 7265 6369  ).    elif preci
+0002f930: 7369 6f6e 3a0a 2020 2020 2020 2020 7265  sion:.        re
+0002f940: 7475 726e 2062 7569 6c74 696e 2863 6173  turn builtin(cas
+0002f950: 745f 7479 7065 2928 632c 206c 6974 2870  t_type)(c, lit(p
+0002f960: 7265 6369 7369 6f6e 2929 0a20 2020 2065  recision)).    e
+0002f970: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+0002f980: 7572 6e20 6275 696c 7469 6e28 6361 7374  urn builtin(cast
+0002f990: 5f74 7970 6529 2863 290a 0a0a 6465 6620  _type)(c)...def 
+0002f9a0: 6173 5f64 6563 696d 616c 280a 2020 2020  as_decimal(.    
+0002f9b0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+0002f9c0: 724e 616d 652c 0a20 2020 2070 7265 6369  rName,.    preci
+0002f9d0: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b69  sion: Optional[i
+0002f9e0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+0002f9f0: 7363 616c 653a 204f 7074 696f 6e61 6c5b  scale: Optional[
+0002fa00: 696e 745d 203d 204e 6f6e 652c 0a29 202d  int] = None,.) -
+0002fa10: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002fa20: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
+0002fa30: 2076 616c 7565 2074 6f20 6120 6669 7865   value to a fixe
+0002fa40: 642d 706f 696e 7420 6465 6369 6d61 6c20  d-point decimal 
+0002fa50: 2864 6f65 7320 6e6f 7420 6d61 7463 6820  (does not match 
+0002fa60: 666c 6f61 7469 6e67 2d70 6f69 6e74 2076  floating-point v
+0002fa70: 616c 7565 7329 2e0a 0a20 2020 2045 7861  alues)...    Exa
+0002fa80: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0002fa90: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002faa0: 7371 6c28 2273 656c 6563 7420 312e 3233  sql("select 1.23
+0002fab0: 3435 3a3a 7661 7269 616e 7420 6173 2061  45::variant as a
+0002fac0: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
+0002fad0: 662e 7365 6c65 6374 2861 735f 6465 6369  f.select(as_deci
+0002fae0: 6d61 6c28 2261 222c 2034 2c20 3129 2e61  mal("a", 4, 1).a
+0002faf0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0002fb00: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0002fb10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0002fb20: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+0002fb30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002fb40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+0002fb50: 2e32 2020 2020 2020 207c 0a20 2020 2020  .2       |.     
+0002fb60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002fb70: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0002fb80: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+0002fb90: 7265 7475 726e 205f 6173 5f64 6563 696d  return _as_decim
+0002fba0: 616c 5f6f 725f 6e75 6d62 6572 2822 6173  al_or_number("as
+0002fbb0: 5f64 6563 696d 616c 222c 2076 6172 6961  _decimal", varia
+0002fbc0: 6e74 2c20 7072 6563 6973 696f 6e2c 2073  nt, precision, s
+0002fbd0: 6361 6c65 290a 0a0a 6465 6620 6173 5f6e  cale)...def as_n
+0002fbe0: 756d 6265 7228 0a20 2020 2076 6172 6961  umber(.    varia
+0002fbf0: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
+0002fc00: 2c0a 2020 2020 7072 6563 6973 696f 6e3a  ,.    precision:
+0002fc10: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+0002fc20: 204e 6f6e 652c 0a20 2020 2073 6361 6c65   None,.    scale
+0002fc30: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+0002fc40: 3d20 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c  = None,.) -> Col
+0002fc50: 756d 6e3a 0a20 2020 2022 2222 4361 7374  umn:.    """Cast
+0002fc60: 7320 6120 5641 5249 414e 5420 7661 6c75  s a VARIANT valu
+0002fc70: 6520 746f 2061 2066 6978 6564 2d70 6f69  e to a fixed-poi
+0002fc80: 6e74 2064 6563 696d 616c 2028 646f 6573  nt decimal (does
+0002fc90: 206e 6f74 206d 6174 6368 2066 6c6f 6174   not match float
+0002fca0: 696e 672d 706f 696e 7420 7661 6c75 6573  ing-point values
+0002fcb0: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
+0002fcc0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0002fcd0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+0002fce0: 7365 6c65 6374 2031 2e32 3334 353a 3a76  select 1.2345::v
+0002fcf0: 6172 6961 6e74 2061 7320 6122 290a 2020  ariant as a").  
+0002fd00: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0002fd10: 6563 7428 6173 5f6e 756d 6265 7228 2261  ect(as_number("a
+0002fd20: 222c 2034 2c20 3129 2e61 6c69 6173 2822  ", 4, 1).alias("
+0002fd30: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0002fd40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002fd50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002fd60: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0002fd70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002fd80: 2020 2020 2020 2020 7c31 2e32 2020 2020          |1.2    
+0002fd90: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0002fda0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002fdb0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0002fdc0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+0002fdd0: 205f 6173 5f64 6563 696d 616c 5f6f 725f   _as_decimal_or_
+0002fde0: 6e75 6d62 6572 2822 6173 5f6e 756d 6265  number("as_numbe
+0002fdf0: 7222 2c20 7661 7269 616e 742c 2070 7265  r", variant, pre
+0002fe00: 6369 7369 6f6e 2c20 7363 616c 6529 0a0a  cision, scale)..
+0002fe10: 0a64 6566 2061 735f 646f 7562 6c65 2876  .def as_double(v
+0002fe20: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002fe30: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002fe40: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002fe50: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002fe60: 2061 2066 6c6f 6174 696e 672d 706f 696e   a floating-poin
+0002fe70: 7420 7661 6c75 652e 0a0a 2020 2020 4578  t value...    Ex
+0002fe80: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0002fe90: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002fea0: 2e73 716c 2822 7365 6c65 6374 2031 2e32  .sql("select 1.2
+0002feb0: 3334 353a 3a76 6172 6961 6e74 2061 7320  345::variant as 
+0002fec0: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
+0002fed0: 6466 2e73 656c 6563 7428 6173 5f64 6f75  df.select(as_dou
+0002fee0: 626c 6528 2261 2229 2e61 6c69 6173 2822  ble("a").alias("
+0002fef0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0002ff00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002ff10: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0002ff20: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0002ff30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0002ff40: 2020 2020 2020 2020 7c31 2e32 3334 3520          |1.2345 
+0002ff50: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0002ff60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002ff70: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0002ff80: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0002ff90: 6f5f 636f 6c5f 6966 5f73 7472 2876 6172  o_col_if_str(var
+0002ffa0: 6961 6e74 2c20 2261 735f 646f 7562 6c65  iant, "as_double
+0002ffb0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0002ffc0: 696c 7469 6e28 2261 735f 646f 7562 6c65  iltin("as_double
+0002ffd0: 2229 2863 290a 0a0a 6465 6620 6173 5f72  ")(c)...def as_r
+0002ffe0: 6561 6c28 7661 7269 616e 743a 2043 6f6c  eal(variant: Col
+0002fff0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00030000: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
+00030010: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
+00030020: 7565 2074 6f20 6120 666c 6f61 7469 6e67  ue to a floating
+00030030: 2d70 6f69 6e74 2076 616c 7565 2e0a 0a20  -point value... 
+00030040: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00030050: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00030060: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00030070: 6b2e 7479 7065 7320 696d 706f 7274 2056  k.types import V
+00030080: 6172 6961 6e74 5479 7065 2c20 5374 7275  ariantType, Stru
+00030090: 6374 5479 7065 2c20 5374 7275 6374 4669  ctType, StructFi
+000300a0: 656c 642c 2044 6f75 626c 6554 7970 650a  eld, DoubleType.
+000300b0: 2020 2020 2020 2020 3e3e 3e20 7363 6865          >>> sche
+000300c0: 6d61 3d53 7472 7563 7454 7970 6528 5b53  ma=StructType([S
+000300d0: 7472 7563 7446 6965 6c64 2822 7261 6469  tructField("radi
+000300e0: 7573 222c 2044 6f75 626c 6554 7970 6528  us", DoubleType(
+000300f0: 2929 2c20 2053 7472 7563 7446 6965 6c64  )),  StructField
+00030100: 2822 7261 6469 7573 5f76 222c 2056 6172  ("radius_v", Var
+00030110: 6961 6e74 5479 7065 2829 295d 290a 2020  iantType())]).  
+00030120: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00030130: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00030140: 7461 6672 616d 6528 6461 7461 3d5b 5b32  taframe(data=[[2
+00030150: 2e30 2c20 4e6f 6e65 5d5d 2c20 7363 6865  .0, None]], sche
+00030160: 6d61 3d73 6368 656d 6129 0a20 2020 2020  ma=schema).     
+00030170: 2020 203e 3e3e 2064 662e 7261 6469 7573     >>> df.radius
+00030180: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
+00030190: 6466 2e72 6164 6975 7329 0a20 2020 2020  df.radius).     
+000301a0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000301b0: 2864 662e 7261 6469 7573 5f76 2e61 735f  (df.radius_v.as_
+000301c0: 2822 7261 6469 7573 5f76 2229 2c20 6466  ("radius_v"), df
+000301d0: 2e72 6164 6975 7329 2e63 6f6c 6c65 6374  .radius).collect
+000301e0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+000301f0: 5241 4449 5553 5f56 3d27 322e 3030 3030  RADIUS_V='2.0000
+00030200: 3030 3030 3030 3030 3030 3065 2b30 3027  00000000000e+00'
+00030210: 2c20 5241 4449 5553 3d32 2e30 295d 0a20  , RADIUS=2.0)]. 
+00030220: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00030230: 6c65 6374 2861 735f 7265 616c 2864 662e  lect(as_real(df.
+00030240: 7261 6469 7573 5f76 292e 6173 5f28 2272  radius_v).as_("r
+00030250: 6561 6c5f 7261 6469 7573 5f76 2229 2c20  eal_radius_v"), 
+00030260: 6466 2e72 6164 6975 7329 2e63 6f6c 6c65  df.radius).colle
+00030270: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00030280: 7728 5245 414c 5f52 4144 4955 535f 563d  w(REAL_RADIUS_V=
+00030290: 322e 302c 2052 4144 4955 533d 322e 3029  2.0, RADIUS=2.0)
+000302a0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+000302b0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000302c0: 2876 6172 6961 6e74 2c20 2261 735f 7265  (variant, "as_re
+000302d0: 616c 2229 0a20 2020 2072 6574 7572 6e20  al").    return 
+000302e0: 6275 696c 7469 6e28 2261 735f 7265 616c  builtin("as_real
+000302f0: 2229 2863 290a 0a0a 6465 6620 6173 5f69  ")(c)...def as_i
+00030300: 6e74 6567 6572 2876 6172 6961 6e74 3a20  nteger(variant: 
+00030310: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00030320: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00030330: 4361 7374 7320 6120 5641 5249 414e 5420  Casts a VARIANT 
+00030340: 7661 6c75 6520 746f 2061 6e20 696e 7465  value to an inte
+00030350: 6765 722e 0a0a 2020 2020 4578 616d 706c  ger...    Exampl
+00030360: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00030370: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+00030380: 2822 7365 6c65 6374 2031 2e32 3334 353a  ("select 1.2345:
+00030390: 3a76 6172 6961 6e74 2061 7320 6122 290a  :variant as a").
+000303a0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000303b0: 656c 6563 7428 6173 5f69 6e74 6567 6572  elect(as_integer
+000303c0: 2822 6122 292e 616c 6961 7328 2272 6573  ("a").alias("res
+000303d0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+000303e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000303f0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00030400: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00030410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00030420: 2020 2020 207c 3120 2020 2020 2020 2020       |1         
+00030430: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00030440: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00030450: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00030460: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00030470: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
+00030480: 742c 2022 6173 5f69 6e74 6567 6572 2229  t, "as_integer")
+00030490: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+000304a0: 7469 6e28 2261 735f 696e 7465 6765 7222  tin("as_integer"
+000304b0: 2928 6329 0a0a 0a64 6566 2061 735f 6f62  )(c)...def as_ob
+000304c0: 6a65 6374 2876 6172 6961 6e74 3a20 436f  ject(variant: Co
+000304d0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000304e0: 6f6c 756d 6e3a 0a20 2020 2022 2222 4361  olumn:.    """Ca
+000304f0: 7374 7320 6120 5641 5249 414e 5420 7661  sts a VARIANT va
+00030500: 6c75 6520 746f 2061 6e20 6f62 6a65 6374  lue to an object
+00030510: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00030520: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00030530: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
+00030540: 656c 6563 7420 6f62 6a65 6374 5f63 6f6e  elect object_con
+00030550: 7374 7275 6374 2827 4127 2c31 2c27 4227  struct('A',1,'B'
+00030560: 2c27 4242 4242 2729 3a3a 7661 7269 616e  ,'BBBB')::varian
+00030570: 7420 6173 2061 2229 0a20 2020 2020 2020  t as a").       
+00030580: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+00030590: 735f 6f62 6a65 6374 2822 6122 292e 616c  s_object("a").al
+000305a0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+000305b0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+000305c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000305d0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+000305e0: 2220 2020 2020 2020 7c0a 2020 2020 2020  "       |.      
+000305f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00030600: 2d2d 2d0a 2020 2020 2020 2020 7c7b 2020  ---.        |{  
+00030610: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00030620: 2020 2020 2020 7c20 2022 4122 3a20 312c        |  "A": 1,
+00030630: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00030640: 7c20 2022 4222 3a20 2242 4242 4222 2020  |  "B": "BBBB"  
+00030650: 7c0a 2020 2020 2020 2020 7c7d 2020 2020  |.        |}    
+00030660: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00030670: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00030680: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00030690: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+000306a0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+000306b0: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
+000306c0: 2c20 2261 735f 6f62 6a65 6374 2229 0a20  , "as_object"). 
+000306d0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000306e0: 6e28 2261 735f 6f62 6a65 6374 2229 2863  n("as_object")(c
+000306f0: 290a 0a0a 6465 6620 6173 5f74 696d 6528  )...def as_time(
+00030700: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+00030710: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00030720: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
+00030730: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
+00030740: 6f20 6120 7469 6d65 2076 616c 7565 2e0a  o a time value..
+00030750: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00030760: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00030770: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00030780: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
+00030790: 706f 7274 2061 735f 7469 6d65 2c20 746f  port as_time, to
+000307a0: 5f76 6172 6961 6e74 0a20 2020 2020 2020  _variant.       
+000307b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000307c0: 6e2e 7371 6c28 2273 656c 6563 7420 544f  n.sql("select TO
+000307d0: 5f54 494d 4528 2731 323a 3334 3a35 3627  _TIME('12:34:56'
+000307e0: 2920 6173 2061 6c61 726d 2229 0a20 2020  ) as alarm").   
+000307f0: 2020 2020 203e 3e3e 2064 662e 616c 6172       >>> df.alar
+00030800: 6d5f 7620 3d20 746f 5f76 6172 6961 6e74  m_v = to_variant
+00030810: 2864 662e 616c 6172 6d29 0a20 2020 2020  (df.alarm).     
+00030820: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00030830: 2864 662e 616c 6172 6d5f 762e 6173 5f28  (df.alarm_v.as_(
+00030840: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
+00030850: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
+00030860: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
+00030870: 6374 2829 0a20 2020 2020 2020 2046 616c  ct().        Fal
+00030880: 7365 0a20 2020 2020 2020 203e 3e3e 2064  se.        >>> d
+00030890: 662e 7365 6c65 6374 2861 735f 7469 6d65  f.select(as_time
+000308a0: 2864 662e 616c 6172 6d5f 7629 2e61 735f  (df.alarm_v).as_
+000308b0: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
+000308c0: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
+000308d0: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
+000308e0: 6563 7428 290a 2020 2020 2020 2020 5472  ect().        Tr
+000308f0: 7565 0a20 2020 2022 2222 0a20 2020 2063  ue.    """.    c
+00030900: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00030910: 7228 7661 7269 616e 742c 2022 6173 5f74  r(variant, "as_t
+00030920: 696d 6522 290a 2020 2020 7265 7475 726e  ime").    return
+00030930: 2062 7569 6c74 696e 2822 6173 5f74 696d   builtin("as_tim
+00030940: 6522 2928 6329 0a0a 0a64 6566 2061 735f  e")(c)...def as_
+00030950: 7469 6d65 7374 616d 705f 6c74 7a28 7661  timestamp_ltz(va
+00030960: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
+00030970: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00030980: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
+00030990: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+000309a0: 6120 5449 4d45 5354 414d 5020 7769 7468  a TIMESTAMP with
+000309b0: 2061 206c 6f63 616c 2074 696d 657a 6f6e   a local timezon
+000309c0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
+000309d0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
+000309e0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+000309f0: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
+00030a00: 2069 6d70 6f72 7420 6173 5f74 696d 6573   import as_times
+00030a10: 7461 6d70 5f6c 747a 2c20 746f 5f76 6172  tamp_ltz, to_var
+00030a20: 6961 6e74 0a20 2020 2020 2020 203e 3e3e  iant.        >>>
+00030a30: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+00030a40: 6c28 2273 656c 6563 7420 544f 5f54 494d  l("select TO_TIM
+00030a50: 4553 5441 4d50 5f4c 545a 2827 3230 3138  ESTAMP_LTZ('2018
+00030a60: 2d31 302d 3130 2031 323a 3334 3a35 3627  -10-10 12:34:56'
+00030a70: 2920 6173 2061 6c61 726d 2229 0a20 2020  ) as alarm").   
+00030a80: 2020 2020 203e 3e3e 2064 662e 616c 6172       >>> df.alar
+00030a90: 6d5f 7620 3d20 746f 5f76 6172 6961 6e74  m_v = to_variant
+00030aa0: 2864 662e 616c 6172 6d29 0a20 2020 2020  (df.alarm).     
+00030ab0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00030ac0: 2864 662e 616c 6172 6d5f 762e 6173 5f28  (df.alarm_v.as_(
+00030ad0: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
+00030ae0: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
+00030af0: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
+00030b00: 6374 2829 0a20 2020 2020 2020 2046 616c  ct().        Fal
+00030b10: 7365 0a20 2020 2020 2020 203e 3e3e 2064  se.        >>> d
+00030b20: 662e 7365 6c65 6374 2861 735f 7469 6d65  f.select(as_time
+00030b30: 7374 616d 705f 6c74 7a28 6466 2e61 6c61  stamp_ltz(df.ala
+00030b40: 726d 5f76 292e 6173 5f28 2261 6c61 726d  rm_v).as_("alarm
+00030b50: 2229 292e 636f 6c6c 6563 7428 2920 3d3d  ")).collect() ==
+00030b60: 2064 662e 7365 6c65 6374 2864 662e 616c   df.select(df.al
+00030b70: 6172 6d29 2e63 6f6c 6c65 6374 2829 0a20  arm).collect(). 
+00030b80: 2020 2020 2020 2054 7275 650a 2020 2020         True.    
+00030b90: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00030ba0: 636f 6c5f 6966 5f73 7472 2876 6172 6961  col_if_str(varia
+00030bb0: 6e74 2c20 2261 735f 7469 6d65 7374 616d  nt, "as_timestam
+00030bc0: 705f 6c74 7a22 290a 2020 2020 7265 7475  p_ltz").    retu
+00030bd0: 726e 2062 7569 6c74 696e 2822 6173 5f74  rn builtin("as_t
+00030be0: 696d 6573 7461 6d70 5f6c 747a 2229 2863  imestamp_ltz")(c
+00030bf0: 290a 0a0a 6465 6620 6173 5f74 696d 6573  )...def as_times
+00030c00: 7461 6d70 5f6e 747a 2876 6172 6961 6e74  tamp_ntz(variant
+00030c10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00030c20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00030c30: 2222 4361 7374 7320 6120 5641 5249 414e  ""Casts a VARIAN
+00030c40: 5420 7661 6c75 6520 746f 2061 2054 494d  T value to a TIM
+00030c50: 4553 5441 4d50 2077 6974 6820 6e6f 2074  ESTAMP with no t
+00030c60: 696d 657a 6f6e 652e 0a0a 2020 2020 4578  imezone...    Ex
+00030c70: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00030c80: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00030c90: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+00030ca0: 6374 696f 6e73 2069 6d70 6f72 7420 6173  ctions import as
+00030cb0: 5f74 696d 6573 7461 6d70 5f6e 747a 2c20  _timestamp_ntz, 
+00030cc0: 746f 5f76 6172 6961 6e74 0a20 2020 2020  to_variant.     
+00030cd0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00030ce0: 696f 6e2e 7371 6c28 2273 656c 6563 7420  ion.sql("select 
+00030cf0: 544f 5f54 494d 4553 5441 4d50 5f4e 545a  TO_TIMESTAMP_NTZ
+00030d00: 2827 3230 3138 2d31 302d 3130 2031 323a  ('2018-10-10 12:
+00030d10: 3334 3a35 3627 2920 6173 2061 6c61 726d  34:56') as alarm
+00030d20: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
+00030d30: 662e 616c 6172 6d5f 7620 3d20 746f 5f76  f.alarm_v = to_v
+00030d40: 6172 6961 6e74 2864 662e 616c 6172 6d29  ariant(df.alarm)
+00030d50: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00030d60: 7365 6c65 6374 2864 662e 616c 6172 6d5f  select(df.alarm_
+00030d70: 762e 6173 5f28 2261 6c61 726d 2229 292e  v.as_("alarm")).
+00030d80: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
+00030d90: 7365 6c65 6374 2864 662e 616c 6172 6d29  select(df.alarm)
+00030da0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00030db0: 2020 2046 616c 7365 0a20 2020 2020 2020     False.       
+00030dc0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+00030dd0: 735f 7469 6d65 7374 616d 705f 6e74 7a28  s_timestamp_ntz(
+00030de0: 6466 2e61 6c61 726d 5f76 292e 6173 5f28  df.alarm_v).as_(
+00030df0: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
+00030e00: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
+00030e10: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
+00030e20: 6374 2829 0a20 2020 2020 2020 2054 7275  ct().        Tru
+00030e30: 650a 2020 2020 2222 220a 2020 2020 6320  e.    """.    c 
+00030e40: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00030e50: 2876 6172 6961 6e74 2c20 2261 735f 7469  (variant, "as_ti
+00030e60: 6d65 7374 616d 705f 6e74 7a22 290a 2020  mestamp_ntz").  
+00030e70: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00030e80: 2822 6173 5f74 696d 6573 7461 6d70 5f6e  ("as_timestamp_n
+00030e90: 747a 2229 2863 290a 0a0a 6465 6620 6173  tz")(c)...def as
+00030ea0: 5f74 696d 6573 7461 6d70 5f74 7a28 7661  _timestamp_tz(va
+00030eb0: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
+00030ec0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00030ed0: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
+00030ee0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+00030ef0: 6120 5449 4d45 5354 414d 5020 7769 7468  a TIMESTAMP with
+00030f00: 2061 2074 696d 657a 6f6e 652e 0a0a 2020   a timezone...  
+00030f10: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00030f20: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00030f30: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00030f40: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+00030f50: 7420 6173 5f74 696d 6573 7461 6d70 5f74  t as_timestamp_t
+00030f60: 7a2c 2074 6f5f 7661 7269 616e 740a 2020  z, to_variant.  
+00030f70: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00030f80: 6573 7369 6f6e 2e73 716c 2822 7365 6c65  ession.sql("sele
+00030f90: 6374 2054 4f5f 5449 4d45 5354 414d 505f  ct TO_TIMESTAMP_
+00030fa0: 545a 2827 3230 3138 2d31 302d 3130 2031  TZ('2018-10-10 1
+00030fb0: 323a 3334 3a35 3620 2b30 3030 3027 2920  2:34:56 +0000') 
+00030fc0: 6173 2061 6c61 726d 2229 0a20 2020 2020  as alarm").     
+00030fd0: 2020 203e 3e3e 2064 662e 616c 6172 6d5f     >>> df.alarm_
+00030fe0: 7620 3d20 746f 5f76 6172 6961 6e74 2864  v = to_variant(d
+00030ff0: 662e 616c 6172 6d29 0a20 2020 2020 2020  f.alarm).       
+00031000: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+00031010: 662e 616c 6172 6d5f 762e 6173 5f28 2261  f.alarm_v.as_("a
+00031020: 6c61 726d 2229 292e 636f 6c6c 6563 7428  larm")).collect(
+00031030: 2920 3d3d 2064 662e 7365 6c65 6374 2864  ) == df.select(d
+00031040: 662e 616c 6172 6d29 2e63 6f6c 6c65 6374  f.alarm).collect
+00031050: 2829 0a20 2020 2020 2020 2046 616c 7365  ().        False
+00031060: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00031070: 7365 6c65 6374 2861 735f 7469 6d65 7374  select(as_timest
+00031080: 616d 705f 747a 2864 662e 616c 6172 6d5f  amp_tz(df.alarm_
+00031090: 7629 2e61 735f 2822 616c 6172 6d22 2929  v).as_("alarm"))
+000310a0: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
+000310b0: 2e73 656c 6563 7428 6466 2e61 6c61 726d  .select(df.alarm
+000310c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000310d0: 2020 2020 5472 7565 0a20 2020 2022 2222      True.    """
+000310e0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000310f0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+00031100: 2022 6173 5f74 696d 6573 7461 6d70 5f74   "as_timestamp_t
+00031110: 7a22 290a 2020 2020 7265 7475 726e 2062  z").    return b
+00031120: 7569 6c74 696e 2822 6173 5f74 696d 6573  uiltin("as_times
+00031130: 7461 6d70 5f74 7a22 2928 6329 0a0a 0a64  tamp_tz")(c)...d
+00031140: 6566 2074 6f5f 6269 6e61 7279 2865 3a20  ef to_binary(e: 
+00031150: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 666d  ColumnOrName, fm
+00031160: 743a 204f 7074 696f 6e61 6c5b 7374 725d  t: Optional[str]
+00031170: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
+00031180: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
+00031190: 7274 7320 7468 6520 696e 7075 7420 6578  rts the input ex
+000311a0: 7072 6573 7369 6f6e 2074 6f20 6120 6269  pression to a bi
+000311b0: 6e61 7279 2076 616c 7565 2e20 466f 7220  nary value. For 
+000311c0: 4e55 4c4c 2069 6e70 7574 2c20 7468 6520  NULL input, the 
+000311d0: 6f75 7470 7574 2069 7320 4e55 4c4c 2e0a  output is NULL..
+000311e0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+000311f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00031200: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00031210: 6461 7461 6672 616d 6528 5b27 3030 272c  dataframe(['00',
+00031220: 2027 3637 272c 2027 3033 3132 275d 2c20   '67', '0312'], 
+00031230: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
+00031240: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00031250: 6563 7428 746f 5f62 696e 6172 7928 636f  ect(to_binary(co
+00031260: 6c28 2761 2729 292e 6173 5f28 2761 6e73  l('a')).as_('ans
+00031270: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
+00031280: 2020 2020 2020 5b52 6f77 2841 4e53 3d62        [Row(ANS=b
+00031290: 7974 6561 7272 6179 2862 275c 5c78 3030  ytearray(b'\\x00
+000312a0: 2729 292c 2052 6f77 2841 4e53 3d62 7974  ')), Row(ANS=byt
+000312b0: 6561 7272 6179 2862 2767 2729 292c 2052  earray(b'g')), R
+000312c0: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
+000312d0: 2862 275c 5c78 3033 5c5c 7831 3227 2929  (b'\\x03\\x12'))
+000312e0: 5d0a 0a20 2020 2020 2020 203e 3e3e 2064  ]..        >>> d
+000312f0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00031300: 7465 5f64 6174 6166 7261 6d65 285b 2761  te_dataframe(['a
+00031310: 4756 7362 4738 3d27 2c20 2764 3239 7962  GVsbG8=', 'd29yb
+00031320: 4751 3d27 2c20 2749 513d 3d27 5d2c 2073  GQ=', 'IQ=='], s
+00031330: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+00031340: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00031350: 6374 2874 6f5f 6269 6e61 7279 2863 6f6c  ct(to_binary(col
+00031360: 2827 6127 292c 2027 4241 5345 3634 2729  ('a'), 'BASE64')
+00031370: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
+00031380: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00031390: 526f 7728 414e 533d 6279 7465 6172 7261  Row(ANS=bytearra
+000313a0: 7928 6227 6865 6c6c 6f27 2929 2c20 526f  y(b'hello')), Ro
+000313b0: 7728 414e 533d 6279 7465 6172 7261 7928  w(ANS=bytearray(
+000313c0: 6227 776f 726c 6427 2929 2c20 526f 7728  b'world')), Row(
+000313d0: 414e 533d 6279 7465 6172 7261 7928 6227  ANS=bytearray(b'
+000313e0: 2127 2929 5d0a 0a20 2020 2020 2020 203e  !'))]..        >
+000313f0: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
+00031400: 6269 6e61 7279 2863 6f6c 2827 6127 292c  binary(col('a'),
+00031410: 2027 5554 462d 3827 292e 6173 5f28 2761   'UTF-8').as_('a
+00031420: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
+00031430: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+00031440: 3d62 7974 6561 7272 6179 2862 2761 4756  =bytearray(b'aGV
+00031450: 7362 4738 3d27 2929 2c20 526f 7728 414e  sbG8=')), Row(AN
+00031460: 533d 6279 7465 6172 7261 7928 6227 6432  S=bytearray(b'd2
+00031470: 3979 6247 513d 2729 292c 2052 6f77 2841  9ybGQ=')), Row(A
+00031480: 4e53 3d62 7974 6561 7272 6179 2862 2749  NS=bytearray(b'I
+00031490: 513d 3d27 2929 5d0a 2020 2020 2222 220a  Q=='))].    """.
+000314a0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+000314b0: 6966 5f73 7472 2865 2c20 2274 6f5f 6269  if_str(e, "to_bi
+000314c0: 6e61 7279 2229 0a20 2020 2072 6574 7572  nary").    retur
+000314d0: 6e20 6275 696c 7469 6e28 2274 6f5f 6269  n builtin("to_bi
+000314e0: 6e61 7279 2229 2863 2c20 666d 7429 2069  nary")(c, fmt) i
+000314f0: 6620 666d 7420 656c 7365 2062 7569 6c74  f fmt else built
+00031500: 696e 2822 746f 5f62 696e 6172 7922 2928  in("to_binary")(
+00031510: 6329 0a0a 0a64 6566 2074 6f5f 6172 7261  c)...def to_arra
+00031520: 7928 653a 2043 6f6c 756d 6e4f 724e 616d  y(e: ColumnOrNam
+00031530: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00031540: 2020 2222 2243 6f6e 7665 7274 7320 616e    """Converts an
+00031550: 7920 7661 6c75 6520 746f 2061 6e20 4152  y value to an AR
+00031560: 5241 5920 7661 6c75 6520 6f72 204e 554c  RAY value or NUL
+00031570: 4c20 2869 6620 696e 7075 7420 6973 204e  L (if input is N
+00031580: 554c 4c29 2e0a 0a20 2020 2045 7861 6d70  ULL)...    Examp
+00031590: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+000315a0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000315b0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000315c0: 5b31 2c20 322c 2033 2c20 345d 2c20 7363  [1, 2, 3, 4], sc
+000315d0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
+000315e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000315f0: 7428 746f 5f61 7272 6179 2863 6f6c 2827  t(to_array(col('
+00031600: 6127 2929 2e61 735f 2827 616e 7327 2929  a')).as_('ans'))
+00031610: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00031620: 2020 205b 526f 7728 414e 533d 275b 5c5c     [Row(ANS='[\\
+00031630: 6e20 2031 5c5c 6e5d 2729 2c20 526f 7728  n  1\\n]'), Row(
+00031640: 414e 533d 275b 5c5c 6e20 2032 5c5c 6e5d  ANS='[\\n  2\\n]
+00031650: 2729 2c20 526f 7728 414e 533d 275b 5c5c  '), Row(ANS='[\\
+00031660: 6e20 2033 5c5c 6e5d 2729 2c20 526f 7728  n  3\\n]'), Row(
+00031670: 414e 533d 275b 5c5c 6e20 2034 5c5c 6e5d  ANS='[\\n  4\\n]
+00031680: 2729 5d0a 0a0a 2020 2020 2020 2020 3e3e  ')]...        >>
+00031690: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+000316a0: 2e73 6e6f 7770 6172 6b20 696d 706f 7274  .snowpark import
+000316b0: 2052 6f77 0a20 2020 2020 2020 203e 3e3e   Row.        >>>
+000316c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000316d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000316e0: 526f 7728 613d 5b31 2c20 322c 2033 5d29  Row(a=[1, 2, 3])
+000316f0: 2c20 526f 7728 613d 4e6f 6e65 295d 290a  , Row(a=None)]).
+00031700: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00031710: 656c 6563 7428 746f 5f61 7272 6179 2863  elect(to_array(c
+00031720: 6f6c 2827 6127 2929 2e61 735f 2827 616e  ol('a')).as_('an
+00031730: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+00031740: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00031750: 275b 5c5c 6e20 2031 2c5c 5c6e 2020 322c  '[\\n  1,\\n  2,
+00031760: 5c5c 6e20 2033 5c5c 6e5d 2729 2c20 526f  \\n  3\\n]'), Ro
+00031770: 7728 414e 533d 4e6f 6e65 295d 0a20 2020  w(ANS=None)].   
+00031780: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00031790: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+000317a0: 746f 5f61 7272 6179 2229 0a20 2020 2072  to_array").    r
+000317b0: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+000317c0: 6f5f 6172 7261 7922 2928 6329 0a0a 0a64  o_array")(c)...d
+000317d0: 6566 2074 6f5f 6a73 6f6e 2865 3a20 436f  ef to_json(e: Co
+000317e0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000317f0: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+00031800: 6e76 6572 7473 2061 6e79 2056 4152 4941  nverts any VARIA
+00031810: 4e54 2076 616c 7565 2074 6f20 6120 7374  NT value to a st
+00031820: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
+00031830: 7468 6520 4a53 4f4e 2072 6570 7265 7365  the JSON represe
+00031840: 6e74 6174 696f 6e20 6f66 2074 6865 0a20  ntation of the. 
+00031850: 2020 2076 616c 7565 2e20 4966 2074 6865     value. If the
+00031860: 2069 6e70 7574 2069 7320 4e55 4c4c 2c20   input is NULL, 
+00031870: 7468 6520 7265 7375 6c74 2069 7320 616c  the result is al
+00031880: 736f 204e 554c 4c2e 0a0a 2020 2020 4578  so NULL...    Ex
+00031890: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+000318a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+000318b0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+000318c0: 7320 696d 706f 7274 2056 6172 6961 6e74  s import Variant
+000318d0: 5479 7065 2c20 5374 7275 6374 4669 656c  Type, StructFiel
+000318e0: 642c 2053 7472 7563 7454 7970 650a 2020  d, StructType.  
+000318f0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00031900: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00031910: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+00031920: 2020 2020 203e 3e3e 2073 6368 656d 6120       >>> schema 
+00031930: 3d20 5374 7275 6374 5479 7065 285b 5374  = StructType([St
+00031940: 7275 6374 4669 656c 6428 2261 222c 2056  ructField("a", V
+00031950: 6172 6961 6e74 5479 7065 2829 295d 290a  ariantType())]).
+00031960: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00031970: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00031980: 6461 7461 6672 616d 6528 5b52 6f77 2861  dataframe([Row(a
+00031990: 3d4e 6f6e 6529 2c52 6f77 2861 3d31 3229  =None),Row(a=12)
+000319a0: 2c52 6f77 2861 3d33 2e31 3431 292c 526f  ,Row(a=3.141),Ro
+000319b0: 7728 613d 7b27 6127 3a31 302c 2762 273a  w(a={'a':10,'b':
+000319c0: 3230 7d29 2c52 6f77 2861 3d5b 312c 3233  20}),Row(a=[1,23
+000319d0: 2c34 3536 5d29 5d2c 2073 6368 656d 613d  ,456])], schema=
+000319e0: 7363 6865 6d61 290a 2020 2020 2020 2020  schema).        
+000319f0: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
+00031a00: 5f6a 736f 6e28 636f 6c28 2261 2229 292e  _json(col("a")).
+00031a10: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
+00031a20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00031a30: 6f77 2841 4e53 3d4e 6f6e 6529 2c20 526f  ow(ANS=None), Ro
+00031a40: 7728 414e 533d 2731 3227 292c 2052 6f77  w(ANS='12'), Row
+00031a50: 2841 4e53 3d27 332e 3134 3127 292c 2052  (ANS='3.141'), R
+00031a60: 6f77 2841 4e53 3d27 7b22 6122 3a31 302c  ow(ANS='{"a":10,
+00031a70: 2262 223a 3230 7d27 292c 2052 6f77 2841  "b":20}'), Row(A
+00031a80: 4e53 3d27 5b31 2c32 332c 3435 365d 2729  NS='[1,23,456]')
+00031a90: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00031aa0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00031ab0: 2865 2c20 2274 6f5f 6a73 6f6e 2229 0a20  (e, "to_json"). 
+00031ac0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00031ad0: 6e28 2274 6f5f 6a73 6f6e 2229 2863 290a  n("to_json")(c).
+00031ae0: 0a0a 6465 6620 746f 5f6f 626a 6563 7428  ..def to_object(
+00031af0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+00031b00: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00031b10: 2222 2243 6f6e 7665 7274 7320 616e 7920  """Converts any 
+00031b20: 7661 6c75 6520 746f 2061 204f 424a 4543  value to a OBJEC
+00031b30: 5420 7661 6c75 6520 6f72 204e 554c 4c20  T value or NULL 
+00031b40: 2869 6620 696e 7075 7420 6973 204e 554c  (if input is NUL
+00031b50: 4c29 2e0a 0a20 2020 2045 7861 6d70 6c65  L)...    Example
+00031b60: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+00031b70: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00031b80: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+00031b90: 6f72 7420 5661 7269 616e 7454 7970 652c  ort VariantType,
+00031ba0: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
+00031bb0: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
+00031bc0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00031bd0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
+00031be0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
+00031bf0: 3e3e 3e20 7363 6865 6d61 203d 2053 7472  >>> schema = Str
+00031c00: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
+00031c10: 6965 6c64 2822 6122 2c20 5661 7269 616e  ield("a", Varian
+00031c20: 7454 7970 6528 2929 5d29 0a20 2020 2020  tType())]).     
+00031c30: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00031c40: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00031c50: 7261 6d65 285b 227b 2761 273a 3130 2c27  rame(["{'a':10,'
+00031c60: 6227 3a32 307d 222c 204e 6f6e 655d 2c20  b':20}", None], 
+00031c70: 7363 6865 6d61 3d73 6368 656d 6129 0a20  schema=schema). 
 00031c80: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00031c90: 6c65 6374 2878 6d6c 6765 7428 786d 6c67  lect(xmlget(xmlg
-00031ca0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
-00031cb0: 6576 656c 3222 2929 2c20 6c69 7428 226c  evel2")), lit("l
-00031cc0: 6576 656c 3322 292c 206c 6974 2830 2929  evel3"), lit(0))
-00031cd0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-00031ce0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00031cf0: 526f 7728 414e 533d 273c 6c65 7665 6c33  Row(ANS='<level3
-00031d00: 3e33 613c 2f6c 6576 656c 333e 2729 5d0a  >3a</level3>')].
-00031d10: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00031d20: 656c 6563 7428 786d 6c67 6574 2878 6d6c  elect(xmlget(xml
-00031d30: 6765 7428 226f 626a 222c 206c 6974 2822  get("obj", lit("
-00031d40: 6c65 7665 6c32 2229 292c 206c 6974 2822  level2")), lit("
-00031d50: 6c65 7665 6c33 2229 2c20 6c69 7428 3129  level3"), lit(1)
-00031d60: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
-00031d70: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00031d80: 5b52 6f77 2841 4e53 3d27 3c6c 6576 656c  [Row(ANS='<level
-00031d90: 333e 3362 3c2f 6c65 7665 6c33 3e27 295d  3>3b</level3>')]
-00031da0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00031db0: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
-00031dc0: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
-00031dd0: 2229 2c20 6c69 7428 3529 292e 6173 5f28  "), lit(5)).as_(
-00031de0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-00031df0: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00031e00: 4e53 3d4e 6f6e 6529 5d0a 0a20 2020 2049  NS=None)]..    I
-00031e10: 6e20 6f72 6465 7220 746f 2067 6574 2074  n order to get t
-00031e20: 6865 2074 6167 6e61 6d65 2c20 7468 6520  he tagname, the 
-00031e30: 7661 6c75 6520 6f66 2061 6e20 6174 7472  value of an attr
-00031e40: 6962 7574 6520 6f72 2074 6865 2063 6f6e  ibute or the con
-00031e50: 7465 6e74 2077 6974 6869 6e20 6120 7461  tent within a ta
-00031e60: 6720 7468 6520 6067 6574 6020 6675 6e63  g the `get` func
-00031e70: 7469 6f6e 2063 616e 2062 6520 7573 6564  tion can be used
-00031e80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00031e90: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00031ea0: 2e73 656c 6563 7428 6765 7428 786d 6c67  .select(get(xmlg
-00031eb0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
-00031ec0: 6576 656c 3222 2929 2c20 6c69 7428 2240  evel2")), lit("@
-00031ed0: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-00031ee0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00031ef0: 2020 5b52 6f77 2841 4e53 3d27 226c 6576    [Row(ANS='"lev
-00031f00: 656c 3222 2729 5d0a 2020 2020 2020 2020  el2"')].        
-00031f10: 3e3e 3e20 6466 2e73 656c 6563 7428 6765  >>> df.select(ge
-00031f20: 7428 786d 6c67 6574 2822 6f62 6a22 2c20  t(xmlget("obj", 
-00031f30: 6c69 7428 226c 6576 656c 3222 2929 2c20  lit("level2")), 
-00031f40: 6c69 7428 2224 2229 292e 6173 5f28 2261  lit("$")).as_("a
-00031f50: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-00031f60: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-00031f70: 3d27 5b5c 5c6e 2020 322c 5c5c 6e20 207b  ='[\\n  2,\\n  {
-00031f80: 5c5c 6e20 2020 2022 2422 3a20 2233 6122  \\n    "$": "3a"
-00031f90: 2c5c 5c6e 2020 2020 2240 223a 2022 6c65  ,\\n    "@": "le
-00031fa0: 7665 6c33 225c 5c6e 2020 7d2c 5c5c 6e20  vel3"\\n  },\\n 
-00031fb0: 207b 5c5c 6e20 2020 2022 2422 3a20 2233   {\\n    "$": "3
-00031fc0: 6222 2c5c 5c6e 2020 2020 2240 223a 2022  b",\\n    "@": "
-00031fd0: 6c65 7665 6c33 225c 5c6e 2020 7d5c 5c6e  level3"\\n  }\\n
-00031fe0: 5d27 295d 0a20 2020 2020 2020 203e 3e3e  ]')].        >>>
-00031ff0: 2064 662e 7365 6c65 6374 2867 6574 2878   df.select(get(x
-00032000: 6d6c 6765 7428 786d 6c67 6574 2822 6f62  mlget(xmlget("ob
-00032010: 6a22 2c20 6c69 7428 226c 6576 656c 3222  j", lit("level2"
-00032020: 2929 2c20 6c69 7428 226c 6576 656c 3322  )), lit("level3"
-00032030: 2929 2c20 6c69 7428 2224 2229 292e 6173  )), lit("$")).as
-00032040: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
-00032050: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00032060: 2841 4e53 3d27 2233 6122 2729 5d0a 2020  (ANS='"3a"')].  
-00032070: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00032080: 6563 7428 6765 7428 786d 6c67 6574 2822  ect(get(xmlget("
-00032090: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
-000320a0: 3222 2929 2c20 6c69 7428 2240 6174 7472  2")), lit("@attr
-000320b0: 3222 2929 2e61 735f 2822 616e 7322 2929  2")).as_("ans"))
-000320c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000320d0: 2020 205b 526f 7728 414e 533d 2722 6222     [Row(ANS='"b"
-000320e0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-000320f0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-00032100: 7374 7228 786d 6c2c 2022 786d 6c67 6574  str(xml, "xmlget
-00032110: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
-00032120: 636f 6c5f 6966 5f73 7472 2874 6167 2c20  col_if_str(tag, 
-00032130: 2278 6d6c 6765 7422 290a 2020 2020 6333  "xmlget").    c3
-00032140: 203d 2028 0a20 2020 2020 2020 2069 6e73   = (.        ins
-00032150: 7461 6e63 655f 6e75 6d0a 2020 2020 2020  tance_num.      
-00032160: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00032170: 696e 7374 616e 6365 5f6e 756d 2c20 696e  instance_num, in
-00032180: 7429 0a20 2020 2020 2020 2065 6c73 6520  t).        else 
-00032190: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2869  _to_col_if_str(i
-000321a0: 6e73 7461 6e63 655f 6e75 6d2c 2022 786d  nstance_num, "xm
-000321b0: 6c67 6574 2229 0a20 2020 2029 0a20 2020  lget").    ).   
-000321c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000321d0: 2278 6d6c 6765 7422 2928 6331 2c20 6332  "xmlget")(c1, c2
-000321e0: 2c20 6333 290a 0a0a 6465 6620 6765 745f  , c3)...def get_
-000321f0: 7061 7468 2863 6f6c 3a20 436f 6c75 6d6e  path(col: Column
-00032200: 4f72 4e61 6d65 2c20 7061 7468 3a20 436f  OrName, path: Co
-00032210: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00032220: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00032230: 2020 2045 7874 7261 6374 7320 6120 7661     Extracts a va
-00032240: 6c75 6520 6672 6f6d 2073 656d 692d 7374  lue from semi-st
-00032250: 7275 6374 7572 6564 2064 6174 6120 7573  ructured data us
-00032260: 696e 6720 6120 7061 7468 206e 616d 652e  ing a path name.
-00032270: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
-00032280: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00032290: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-000322a0: 655f 6461 7461 6672 616d 6528 5b7b 2261  e_dataframe([{"a
-000322b0: 223a 207b 2261 6122 3a20 7b22 6464 223a  ": {"aa": {"dd":
-000322c0: 2034 7d2c 2022 6262 223a 2032 2c20 2263   4}, "bb": 2, "c
-000322d0: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
-000322e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000322f0: 6765 745f 7061 7468 2864 665b 2261 225d  get_path(df["a"]
-00032300: 2c20 6c69 7428 2261 612e 6464 2229 292e  , lit("aa.dd")).
-00032310: 616c 6961 7328 2267 6574 5f70 6174 6822  alias("get_path"
-00032320: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00032330: 2020 2020 205b 526f 7728 4745 545f 5041       [Row(GET_PA
-00032340: 5448 3d27 3427 295d 0a20 2020 2022 2222  TH='4')].    """
-00032350: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
-00032360: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2267  l_if_str(col, "g
-00032370: 6574 5f70 6174 6822 290a 2020 2020 6332  et_path").    c2
-00032380: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00032390: 7228 7061 7468 2c20 2267 6574 5f70 6174  r(path, "get_pat
-000323a0: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
-000323b0: 7569 6c74 696e 2822 6765 745f 7061 7468  uiltin("get_path
-000323c0: 2229 2863 312c 2063 3229 0a0a 0a64 6566  ")(c1, c2)...def
-000323d0: 2067 6574 2863 6f6c 313a 2055 6e69 6f6e   get(col1: Union
-000323e0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-000323f0: 6e74 5d2c 2063 6f6c 323a 2055 6e69 6f6e  nt], col2: Union
-00032400: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00032410: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
-00032420: 2020 2020 2222 2245 7874 7261 6374 7320      """Extracts 
-00032430: 6120 7661 6c75 6520 6672 6f6d 2061 6e20  a value from an 
-00032440: 6f62 6a65 6374 206f 7220 6172 7261 793b  object or array;
-00032450: 2072 6574 7572 6e73 204e 554c 4c20 6966   returns NULL if
-00032460: 2065 6974 6865 7220 6f66 2074 6865 2061   either of the a
-00032470: 7267 756d 656e 7473 2069 7320 4e55 4c4c  rguments is NULL
-00032480: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00032490: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-000324a0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-000324b0: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
-000324c0: 696d 706f 7274 206c 6974 0a20 2020 2020  import lit.     
-000324d0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000324e0: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
-000324f0: 616d 6528 5b28 7b22 6122 3a20 312e 302c  ame([({"a": 1.0,
-00032500: 2022 6222 3a20 322e 307d 2c20 5b31 2c20   "b": 2.0}, [1, 
-00032510: 322c 2033 5d2c 292c 2028 7b7d 2c20 5b5d  2, 3],), ({}, []
-00032520: 2c29 5d2c 205b 226d 6170 222c 2022 6c69  ,)], ["map", "li
-00032530: 7374 225d 290a 2020 2020 2020 2020 3e3e  st"]).        >>
-00032540: 3e20 6466 2e73 656c 6563 7428 6765 7428  > df.select(get(
-00032550: 6466 2e6c 6973 742c 2031 292e 6173 5f28  df.list, 1).as_(
-00032560: 2269 6478 3122 2929 2e73 6f72 7428 636f  "idx1")).sort(co
-00032570: 6c28 2269 6478 3122 2929 2e73 686f 7728  l("idx1")).show(
-00032580: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00032590: 2d2d 2d2d 0a20 2020 2020 2020 207c 2249  ----.        |"I
-000325a0: 4458 3122 2020 7c0a 2020 2020 2020 2020  DX1"  |.        
-000325b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000325c0: 2020 207c 4e55 4c4c 2020 2020 7c0a 2020     |NULL    |.  
-000325d0: 2020 2020 2020 7c32 2020 2020 2020 207c        |2       |
-000325e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000325f0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00032600: 4e4b 4c49 4e45 3e0a 0a20 2020 2020 2020  NKLINE>..       
-00032610: 203e 3e3e 2064 662e 7365 6c65 6374 2867   >>> df.select(g
-00032620: 6574 2864 662e 6d61 702c 206c 6974 2822  et(df.map, lit("
-00032630: 6122 2929 2e61 735f 2822 6765 745f 6122  a")).as_("get_a"
-00032640: 2929 2e73 6f72 7428 636f 6c28 2267 6574  )).sort(col("get
-00032650: 5f61 2229 292e 7368 6f77 2829 0a20 2020  _a")).show().   
-00032660: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00032670: 0a20 2020 2020 2020 207c 2247 4554 5f41  .        |"GET_A
-00032680: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-00032690: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000326a0: 207c 4e55 4c4c 2020 2020 207c 0a20 2020   |NULL     |.   
-000326b0: 2020 2020 207c 3120 2020 2020 2020 207c       |1        |
-000326c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000326d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-000326e0: 414e 4b4c 494e 453e 2222 220a 2020 2020  ANKLINE>""".    
-000326f0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-00032700: 7374 725f 6f72 5f69 6e74 2863 6f6c 312c  str_or_int(col1,
-00032710: 2022 6765 7422 290a 2020 2020 6332 203d   "get").    c2 =
-00032720: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
-00032730: 6f72 5f69 6e74 2863 6f6c 322c 2022 6765  or_int(col2, "ge
-00032740: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
-00032750: 7569 6c74 696e 2822 6765 7422 2928 6331  uiltin("get")(c1
-00032760: 2c20 6332 290a 0a0a 656c 656d 656e 745f  , c2)...element_
-00032770: 6174 203d 2067 6574 0a0a 0a64 6566 2077  at = get...def w
-00032780: 6865 6e28 636f 6e64 6974 696f 6e3a 2043  hen(condition: C
-00032790: 6f6c 756d 6e4f 7253 716c 4578 7072 2c20  olumnOrSqlExpr, 
-000327a0: 7661 6c75 653a 2043 6f6c 756d 6e4f 724c  value: ColumnOrL
-000327b0: 6974 6572 616c 2920 2d3e 2043 6173 6545  iteral) -> CaseE
-000327c0: 7870 723a 0a20 2020 2022 2222 576f 726b  xpr:.    """Work
-000327d0: 7320 6c69 6b65 2061 2063 6173 6361 6469  s like a cascadi
-000327e0: 6e67 2069 662d 7468 656e 2d65 6c73 6520  ng if-then-else 
-000327f0: 7374 6174 656d 656e 742e 0a20 2020 2041  statement..    A
-00032800: 2073 6572 6965 7320 6f66 2063 6f6e 6469   series of condi
-00032810: 7469 6f6e 7320 6172 6520 6576 616c 7561  tions are evalua
-00032820: 7465 6420 696e 2073 6571 7565 6e63 652e  ted in sequence.
-00032830: 0a20 2020 2057 6865 6e20 6120 636f 6e64  .    When a cond
-00032840: 6974 696f 6e20 6576 616c 7561 7465 7320  ition evaluates 
-00032850: 746f 2054 5255 452c 2074 6865 2065 7661  to TRUE, the eva
-00032860: 6c75 6174 696f 6e20 7374 6f70 7320 616e  luation stops an
-00032870: 6420 7468 6520 6173 736f 6369 6174 6564  d the associated
-00032880: 0a20 2020 2072 6573 756c 7420 2861 6674  .    result (aft
-00032890: 6572 2054 4845 4e29 2069 7320 7265 7475  er THEN) is retu
-000328a0: 726e 6564 2e20 4966 206e 6f6e 6520 6f66  rned. If none of
-000328b0: 2074 6865 2063 6f6e 6469 7469 6f6e 7320   the conditions 
-000328c0: 6576 616c 7561 7465 2074 6f20 5452 5545  evaluate to TRUE
-000328d0: 2c0a 2020 2020 7468 656e 2074 6865 2072  ,.    then the r
-000328e0: 6573 756c 7420 6166 7465 7220 7468 6520  esult after the 
-000328f0: 6f70 7469 6f6e 616c 204f 5448 4552 5749  optional OTHERWI
-00032900: 5345 2069 7320 7265 7475 726e 6564 2c20  SE is returned, 
-00032910: 6966 2070 7265 7365 6e74 3b0a 2020 2020  if present;.    
-00032920: 6f74 6865 7277 6973 6520 4e55 4c4c 2069  otherwise NULL i
-00032930: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
-00032940: 2041 7267 733a 0a20 2020 2020 2020 2063   Args:.        c
-00032950: 6f6e 6469 7469 6f6e 3a20 4120 3a63 6c61  ondition: A :cla
-00032960: 7373 3a60 436f 6c75 6d6e 6020 6578 7072  ss:`Column` expr
-00032970: 6573 7369 6f6e 206f 7220 5351 4c20 7465  ession or SQL te
-00032980: 7874 2072 6570 7265 7365 6e74 696e 6720  xt representing 
-00032990: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
-000329a0: 6e64 6974 696f 6e2e 0a20 2020 2020 2020  ndition..       
-000329b0: 2076 616c 7565 3a20 4120 3a63 6c61 7373   value: A :class
-000329c0: 3a60 436f 6c75 6d6e 6020 6578 7072 6573  :`Column` expres
-000329d0: 7369 6f6e 206f 7220 6120 6c69 7465 7261  sion or a litera
-000329e0: 6c20 7661 6c75 652c 2077 6869 6368 2077  l value, which w
-000329f0: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
-00032a00: 2020 2020 2020 2020 2020 2020 6966 2060              if `
-00032a10: 6063 6f6e 6469 7469 6f6e 6060 2069 7320  `condition`` is 
-00032a20: 7472 7565 2e0a 0a20 2020 2045 7861 6d70  true...    Examp
-00032a30: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00032a40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00032a50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00032a60: 5b31 2c20 4e6f 6e65 2c20 322c 2033 2c20  [1, None, 2, 3, 
-00032a70: 4e6f 6e65 2c20 352c 2036 5d2c 2073 6368  None, 5, 6], sch
-00032a80: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00032a90: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
-00032aa0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00032ab0: 2841 3d31 292c 2052 6f77 2841 3d4e 6f6e  (A=1), Row(A=Non
-00032ac0: 6529 2c20 526f 7728 413d 3229 2c20 526f  e), Row(A=2), Ro
-00032ad0: 7728 413d 3329 2c20 526f 7728 413d 4e6f  w(A=3), Row(A=No
-00032ae0: 6e65 292c 2052 6f77 2841 3d35 292c 2052  ne), Row(A=5), R
-00032af0: 6f77 2841 3d36 295d 0a20 2020 2020 2020  ow(A=6)].       
-00032b00: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
-00032b10: 6865 6e28 636f 6c28 2261 2229 2025 2032  hen(col("a") % 2
-00032b20: 203d 3d20 302c 206c 6974 2822 6576 656e   == 0, lit("even
-00032b30: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-00032b40: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00032b50: 2020 5b52 6f77 2841 4e53 3d4e 6f6e 6529    [Row(ANS=None)
-00032b60: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
-00032b70: 2052 6f77 2841 4e53 3d27 6576 656e 2729   Row(ANS='even')
-00032b80: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
-00032b90: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
-00032ba0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
-00032bb0: 6f77 2841 4e53 3d27 6576 656e 2729 5d0a  ow(ANS='even')].
-00032bc0: 0a20 2020 204d 756c 7469 706c 6520 7768  .    Multiple wh
-00032bd0: 656e 2073 7461 7465 6d65 6e74 7320 6361  en statements ca
-00032be0: 6e20 6265 2063 6861 6e67 6564 2061 6e64  n be changed and
-00032bf0: 2060 6f74 6865 7277 6973 6560 2f60 656c   `otherwise`/`el
-00032c00: 7365 5f60 2075 7365 6420 746f 2063 7265  se_` used to cre
-00032c10: 6174 6520 6578 7072 6573 7369 6f6e 7320  ate expressions 
-00032c20: 7369 6d69 6c61 7220 746f 2060 6043 4153  similar to ``CAS
-00032c30: 4520 5748 454e 202e 2e2e 2045 4c53 4520  E WHEN ... ELSE 
-00032c40: 2e2e 2e20 454e 4460 6020 696e 2053 514c  ... END`` in SQL
-00032c50: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00032c60: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00032c70: 2e73 656c 6563 7428 7768 656e 2863 6f6c  .select(when(col
-00032c80: 2822 6122 2920 2520 3220 3d3d 2030 2c20  ("a") % 2 == 0, 
-00032c90: 6c69 7428 2265 7665 6e22 2929 2e77 6865  lit("even")).whe
-00032ca0: 6e28 636f 6c28 2261 2229 2025 2032 203d  n(col("a") % 2 =
-00032cb0: 3d20 312c 206c 6974 2822 6f64 6422 2929  = 1, lit("odd"))
-00032cc0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-00032cd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00032ce0: 526f 7728 414e 533d 276f 6464 2729 2c20  Row(ANS='odd'), 
-00032cf0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
-00032d00: 6f77 2841 4e53 3d27 6576 656e 2729 2c20  ow(ANS='even'), 
-00032d10: 526f 7728 414e 533d 276f 6464 2729 2c20  Row(ANS='odd'), 
-00032d20: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
-00032d30: 6f77 2841 4e53 3d27 6f64 6427 292c 2052  ow(ANS='odd'), R
-00032d40: 6f77 2841 4e53 3d27 6576 656e 2729 5d0a  ow(ANS='even')].
-00032d50: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00032d60: 656c 6563 7428 7768 656e 2863 6f6c 2822  elect(when(col("
-00032d70: 6122 2920 2520 3220 3d3d 2030 2c20 6c69  a") % 2 == 0, li
-00032d80: 7428 2265 7665 6e22 2929 2e77 6865 6e28  t("even")).when(
-00032d90: 636f 6c28 2261 2229 2025 2032 203d 3d20  col("a") % 2 == 
-00032da0: 312c 206c 6974 2822 6f64 6422 2929 2e6f  1, lit("odd")).o
-00032db0: 7468 6572 7769 7365 286c 6974 2822 756e  therwise(lit("un
-00032dc0: 6b6e 6f77 6e22 2929 2e61 735f 2822 616e  known")).as_("an
-00032dd0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-00032de0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-00032df0: 276f 6464 2729 2c20 526f 7728 414e 533d  'odd'), Row(ANS=
-00032e00: 2775 6e6b 6e6f 776e 2729 2c20 526f 7728  'unknown'), Row(
-00032e10: 414e 533d 2765 7665 6e27 292c 2052 6f77  ANS='even'), Row
-00032e20: 2841 4e53 3d27 6f64 6427 292c 2052 6f77  (ANS='odd'), Row
-00032e30: 2841 4e53 3d27 756e 6b6e 6f77 6e27 292c  (ANS='unknown'),
-00032e40: 2052 6f77 2841 4e53 3d27 6f64 6427 292c   Row(ANS='odd'),
-00032e50: 2052 6f77 2841 4e53 3d27 6576 656e 2729   Row(ANS='even')
-00032e60: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
-00032e70: 7475 726e 2043 6173 6545 7870 7228 0a20  turn CaseExpr(. 
-00032e80: 2020 2020 2020 2043 6173 6557 6865 6e28         CaseWhen(
-00032e90: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-00032ea0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00032eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032ec0: 2020 2020 205f 746f 5f63 6f6c 5f69 665f       _to_col_if_
-00032ed0: 7371 6c5f 6578 7072 2863 6f6e 6469 7469  sql_expr(conditi
-00032ee0: 6f6e 2c20 2277 6865 6e22 292e 5f65 7870  on, "when")._exp
-00032ef0: 7265 7373 696f 6e2c 0a20 2020 2020 2020  ression,.       
-00032f00: 2020 2020 2020 2020 2020 2020 2043 6f6c               Col
-00032f10: 756d 6e2e 5f74 6f5f 6578 7072 2876 616c  umn._to_expr(val
-00032f20: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
-00032f30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00032f40: 2020 205d 0a20 2020 2020 2020 2029 0a20     ].        ). 
-00032f50: 2020 2029 0a0a 0a64 6566 2069 6666 280a     )...def iff(.
-00032f60: 2020 2020 636f 6e64 6974 696f 6e3a 2043      condition: C
-00032f70: 6f6c 756d 6e4f 7253 716c 4578 7072 2c0a  olumnOrSqlExpr,.
-00032f80: 2020 2020 6578 7072 313a 2043 6f6c 756d      expr1: Colum
-00032f90: 6e4f 724c 6974 6572 616c 2c0a 2020 2020  nOrLiteral,.    
-00032fa0: 6578 7072 323a 2043 6f6c 756d 6e4f 724c  expr2: ColumnOrL
-00032fb0: 6974 6572 616c 2c0a 2920 2d3e 2043 6f6c  iteral,.) -> Col
-00032fc0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00032fd0: 2052 6574 7572 6e73 206f 6e65 206f 6620   Returns one of 
-00032fe0: 7477 6f20 7370 6563 6966 6965 6420 6578  two specified ex
-00032ff0: 7072 6573 7369 6f6e 732c 2064 6570 656e  pressions, depen
-00033000: 6469 6e67 206f 6e20 6120 636f 6e64 6974  ding on a condit
-00033010: 696f 6e2e 0a20 2020 2054 6869 7320 6973  ion..    This is
-00033020: 2065 7175 6976 616c 656e 7420 746f 2061   equivalent to a
-00033030: 6e20 6060 6966 2d74 6865 6e2d 656c 7365  n ``if-then-else
-00033040: 6060 2065 7870 7265 7373 696f 6e2e 0a0a  `` expression...
-00033050: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00033060: 2020 636f 6e64 6974 696f 6e3a 2041 203a    condition: A :
-00033070: 636c 6173 733a 6043 6f6c 756d 6e60 2065  class:`Column` e
-00033080: 7870 7265 7373 696f 6e20 6f72 2053 514c  xpression or SQL
-00033090: 2074 6578 7420 7265 7072 6573 656e 7469   text representi
-000330a0: 6e67 2074 6865 2073 7065 6369 6669 6564  ng the specified
-000330b0: 2063 6f6e 6469 7469 6f6e 2e0a 2020 2020   condition..    
-000330c0: 2020 2020 6578 7072 313a 2041 203a 636c      expr1: A :cl
-000330d0: 6173 733a 6043 6f6c 756d 6e60 2065 7870  ass:`Column` exp
-000330e0: 7265 7373 696f 6e20 6f72 2061 206c 6974  ression or a lit
-000330f0: 6572 616c 2076 616c 7565 2c20 7768 6963  eral value, whic
-00033100: 6820 7769 6c6c 2062 6520 7265 7475 726e  h will be return
-00033110: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
-00033120: 6620 6060 636f 6e64 6974 696f 6e60 6020  f ``condition`` 
-00033130: 6973 2074 7275 652e 0a20 2020 2020 2020  is true..       
-00033140: 2065 7870 7232 3a20 4120 3a63 6c61 7373   expr2: A :class
-00033150: 3a60 436f 6c75 6d6e 6020 6578 7072 6573  :`Column` expres
-00033160: 7369 6f6e 206f 7220 6120 6c69 7465 7261  sion or a litera
-00033170: 6c20 7661 6c75 652c 2077 6869 6368 2077  l value, which w
-00033180: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
-00033190: 2020 2020 2020 2020 2020 2020 6966 2060              if `
-000331a0: 6063 6f6e 6469 7469 6f6e 6060 2069 7320  `condition`` is 
-000331b0: 6661 6c73 652e 0a0a 2020 2020 4578 616d  false...    Exam
-000331c0: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
-000331d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000331e0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000331f0: 6528 5b54 7275 652c 2046 616c 7365 2c20  e([True, False, 
-00033200: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b22  None], schema=["
-00033210: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-00033220: 2064 662e 7365 6c65 6374 2869 6666 2864   df.select(iff(d
-00033230: 665b 2261 225d 2c20 6c69 7428 2274 7275  f["a"], lit("tru
-00033240: 6522 292c 206c 6974 2822 6661 6c73 6522  e"), lit("false"
-00033250: 2929 2e61 6c69 6173 2822 6966 6622 2929  )).alias("iff"))
-00033260: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00033270: 2020 205b 526f 7728 4946 463d 2774 7275     [Row(IFF='tru
-00033280: 6527 292c 2052 6f77 2849 4646 3d27 6661  e'), Row(IFF='fa
-00033290: 6c73 6527 292c 2052 6f77 2849 4646 3d27  lse'), Row(IFF='
-000332a0: 6661 6c73 6527 295d 0a20 2020 2022 2222  false')].    """
-000332b0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-000332c0: 7469 6e28 2269 6666 2229 285f 746f 5f63  tin("iff")(_to_c
-000332d0: 6f6c 5f69 665f 7371 6c5f 6578 7072 2863  ol_if_sql_expr(c
-000332e0: 6f6e 6469 7469 6f6e 2c20 2269 6666 2229  ondition, "iff")
-000332f0: 2c20 6578 7072 312c 2065 7870 7232 290a  , expr1, expr2).
-00033300: 0a0a 6465 6620 696e 5f28 0a20 2020 2063  ..def in_(.    c
-00033310: 6f6c 733a 204c 6973 745b 436f 6c75 6d6e  ols: List[Column
-00033320: 4f72 4e61 6d65 5d2c 0a20 2020 202a 7661  OrName],.    *va
-00033330: 6c73 3a20 556e 696f 6e5b 2273 6e6f 7766  ls: Union["snowf
-00033340: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 4461  lake.snowpark.Da
-00033350: 7461 4672 616d 6522 2c20 4c69 7465 7261  taFrame", Litera
-00033360: 6c54 7970 652c 2049 7465 7261 626c 655b  lType, Iterable[
-00033370: 4c69 7465 7261 6c54 7970 655d 5d2c 0a29  LiteralType]],.)
-00033380: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00033390: 2222 2252 6574 7572 6e73 2061 2063 6f6e  """Returns a con
-000333a0: 6469 7469 6f6e 616c 2065 7870 7265 7373  ditional express
-000333b0: 696f 6e20 7468 6174 2079 6f75 2063 616e  ion that you can
-000333c0: 2070 6173 7320 746f 2074 6865 2066 696c   pass to the fil
-000333d0: 7465 7220 6f72 2077 6865 7265 206d 6574  ter or where met
-000333e0: 686f 6473 2074 6f0a 2020 2020 7065 7266  hods to.    perf
-000333f0: 6f72 6d20 7468 6520 6571 7569 7661 6c65  orm the equivale
-00033400: 6e74 206f 6620 6120 5748 4552 4520 2e2e  nt of a WHERE ..
-00033410: 2e20 494e 2071 7565 7279 2074 6861 7420  . IN query that 
-00033420: 6d61 7463 6865 7320 726f 7773 2063 6f6e  matches rows con
-00033430: 7461 696e 696e 6720 6120 7365 7175 656e  taining a sequen
-00033440: 6365 206f 660a 2020 2020 7661 6c75 6573  ce of.    values
-00033450: 2e0a 0a20 2020 2054 6865 2065 7870 7265  ...    The expre
-00033460: 7373 696f 6e20 6576 616c 7561 7465 7320  ssion evaluates 
-00033470: 746f 2074 7275 6520 6966 2074 6865 2076  to true if the v
-00033480: 616c 7565 7320 696e 2061 2072 6f77 206d  alues in a row m
-00033490: 6174 6368 6573 2074 6865 2076 616c 7565  atches the value
-000334a0: 7320 696e 206f 6e65 206f 660a 2020 2020  s in one of.    
-000334b0: 7468 6520 7370 6563 6966 6965 6420 7365  the specified se
-000334c0: 7175 656e 6365 732e 0a0a 2020 2020 5468  quences...    Th
-000334d0: 6520 666f 6c6c 6f77 696e 6720 636f 6465  e following code
-000334e0: 2072 6574 7572 6e73 2061 2044 6174 6146   returns a DataF
-000334f0: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
-00033500: 6e73 2074 6865 2072 6f77 7320 696e 2077  ns the rows in w
-00033510: 6869 6368 0a20 2020 2074 6865 2063 6f6c  hich.    the col
-00033520: 756d 6e73 2060 6331 6020 616e 6420 6063  umns `c1` and `c
-00033530: 3260 2063 6f6e 7461 696e 2074 6865 2076  2` contain the v
-00033540: 616c 7565 733a 0a20 2020 202d 2060 3160  alues:.    - `1`
-00033550: 2061 6e64 2060 2261 2260 2c20 6f72 0a20   and `"a"`, or. 
-00033560: 2020 202d 2060 3260 2061 6e64 2060 2262     - `2` and `"b
-00033570: 2260 0a20 2020 2054 6869 7320 6973 2065  "`.    This is e
-00033580: 7175 6976 616c 656e 7420 746f 2060 6053  quivalent to ``S
-00033590: 454c 4543 5420 2a20 4652 4f4d 2074 6162  ELECT * FROM tab
-000335a0: 6c65 2057 4845 5245 2028 6331 2c20 6332  le WHERE (c1, c2
-000335b0: 2920 494e 2028 2831 2c20 2761 2729 2c20  ) IN ((1, 'a'), 
-000335c0: 2832 2c20 2762 2729 2960 602e 0a0a 2020  (2, 'b'))``...  
-000335d0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-000335e0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000335f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00033600: 6166 7261 6d65 285b 5b31 2c20 2261 225d  aframe([[1, "a"]
-00033610: 2c20 5b32 2c20 2262 225d 2c20 5b33 2c20  , [2, "b"], [3, 
-00033620: 2263 225d 5d2c 2073 6368 656d 613d 5b22  "c"]], schema=["
-00033630: 636f 6c31 222c 2022 636f 6c32 225d 290a  col1", "col2"]).
-00033640: 2020 2020 2020 2020 3e3e 3e20 6466 2e66          >>> df.f
-00033650: 696c 7465 7228 696e 5f28 5b63 6f6c 2822  ilter(in_([col("
-00033660: 636f 6c31 2229 2c20 636f 6c28 2263 6f6c  col1"), col("col
-00033670: 3222 295d 2c20 5b5b 312c 2022 6122 5d2c  2")], [[1, "a"],
-00033680: 205b 322c 2022 6222 5d5d 2929 2e73 686f   [2, "b"]])).sho
-00033690: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-000336a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000336b0: 2020 2020 2020 2020 7c22 434f 4c31 2220          |"COL1" 
-000336c0: 207c 2243 4f4c 3222 2020 7c0a 2020 2020   |"COL2"  |.    
-000336d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000336e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000336f0: 7c31 2020 2020 2020 207c 6120 2020 2020  |1       |a     
-00033700: 2020 7c0a 2020 2020 2020 2020 7c32 2020    |.        |2  
-00033710: 2020 2020 207c 6220 2020 2020 2020 7c0a       |b       |.
-00033720: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00033730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00033740: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00033750: 0a20 2020 2054 6865 2066 6f6c 6c6f 7769  .    The followi
-00033760: 6e67 2063 6f64 6520 7265 7475 726e 7320  ng code returns 
-00033770: 6120 4461 7461 4672 616d 6520 7468 6174  a DataFrame that
-00033780: 2063 6f6e 7461 696e 7320 7468 6520 726f   contains the ro
-00033790: 7773 2077 6865 7265 0a20 2020 2074 6865  ws where.    the
-000337a0: 2076 616c 7565 7320 6f66 2074 6865 2063   values of the c
-000337b0: 6f6c 756d 6e73 2060 6331 6020 616e 6420  olumns `c1` and 
-000337c0: 6063 3260 2069 6e20 6064 6632 6020 6d61  `c2` in `df2` ma
-000337d0: 7463 6820 7468 6520 7661 6c75 6573 206f  tch the values o
-000337e0: 6620 7468 6520 636f 6c75 6d6e 730a 2020  f the columns.  
-000337f0: 2020 6061 6020 616e 6420 6062 6020 696e    `a` and `b` in
-00033800: 2060 6466 3160 2e20 5468 6973 2069 7320   `df1`. This is 
-00033810: 6571 7569 7661 6c65 6e74 2074 6f0a 2020  equivalent to.  
-00033820: 2020 6060 5345 4c45 4354 202a 2046 524f    ``SELECT * FRO
-00033830: 4d20 7461 626c 6532 2057 4845 5245 2028  M table2 WHERE (
-00033840: 6331 2c20 6332 2920 494e 2028 5345 4c45  c1, c2) IN (SELE
-00033850: 4354 2061 2c20 6220 4652 4f4d 2074 6162  CT a, b FROM tab
-00033860: 6c65 3129 6060 2e0a 0a20 2020 2045 7861  le1)``...    Exa
-00033870: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00033880: 3e3e 3e20 6466 3120 3d20 7365 7373 696f  >>> df1 = sessio
-00033890: 6e2e 7371 6c28 2273 656c 6563 7420 312c  n.sql("select 1,
-000338a0: 2027 6127 2229 0a20 2020 2020 2020 203e   'a'").        >
-000338b0: 3e3e 2064 662e 6669 6c74 6572 2869 6e5f  >> df.filter(in_
-000338c0: 285b 636f 6c28 2263 6f6c 3122 292c 2063  ([col("col1"), c
-000338d0: 6f6c 2822 636f 6c32 2229 5d2c 2064 6631  ol("col2")], df1
-000338e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-000338f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00033900: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00033910: 434f 4c31 2220 207c 2243 4f4c 3222 2020  COL1"  |"COL2"  
-00033920: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00033930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00033940: 2020 2020 2020 7c31 2020 2020 2020 207c        |1       |
-00033950: 6120 2020 2020 2020 7c0a 2020 2020 2020  a       |.      
-00033960: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00033970: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-00033980: 4c41 4e4b 4c49 4e45 3e0a 0a20 2020 2041  LANKLINE>..    A
-00033990: 7267 733a 3a0a 2020 2020 2020 2020 636f  rgs::.        co
-000339a0: 6c73 3a20 4120 6c69 7374 206f 6620 7468  ls: A list of th
-000339b0: 6520 636f 6c75 6d6e 7320 746f 2063 6f6d  e columns to com
-000339c0: 7061 7265 2066 6f72 2074 6865 2049 4e20  pare for the IN 
-000339d0: 6f70 6572 6174 696f 6e2e 0a20 2020 2020  operation..     
-000339e0: 2020 2076 616c 733a 2041 206c 6973 7420     vals: A list 
-000339f0: 636f 6e74 6169 6e69 6e67 2074 6865 2076  containing the v
-00033a00: 616c 7565 7320 746f 2063 6f6d 7061 7265  alues to compare
-00033a10: 2066 6f72 2074 6865 2049 4e20 6f70 6572   for the IN oper
-00033a20: 6174 696f 6e2e 0a20 2020 2022 2222 0a20  ation..    """. 
-00033a30: 2020 2076 616c 7320 3d20 7061 7273 655f     vals = parse_
-00033a40: 706f 7369 7469 6f6e 616c 5f61 7267 735f  positional_args_
-00033a50: 746f 5f6c 6973 7428 2a76 616c 7329 0a20  to_list(*vals). 
-00033a60: 2020 2063 6f6c 756d 6e73 203d 205b 5f74     columns = [_t
-00033a70: 6f5f 636f 6c5f 6966 5f73 7472 2863 2c20  o_col_if_str(c, 
-00033a80: 2269 6e5f 2229 2066 6f72 2063 2069 6e20  "in_") for c in 
-00033a90: 636f 6c73 5d0a 2020 2020 7265 7475 726e  cols].    return
-00033aa0: 2043 6f6c 756d 6e28 4d75 6c74 6970 6c65   Column(Multiple
-00033ab0: 4578 7072 6573 7369 6f6e 285b 632e 5f65  Expression([c._e
-00033ac0: 7870 7265 7373 696f 6e20 666f 7220 6320  xpression for c 
-00033ad0: 696e 2063 6f6c 756d 6e73 5d29 292e 696e  in columns])).in
-00033ae0: 5f28 7661 6c73 290a 0a0a 6465 6620 6375  _(vals)...def cu
-00033af0: 6d65 5f64 6973 7428 2920 2d3e 2043 6f6c  me_dist() -> Col
-00033b00: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00033b10: 2046 696e 6473 2074 6865 2063 756d 756c   Finds the cumul
-00033b20: 6174 6976 6520 6469 7374 7269 6275 7469  ative distributi
-00033b30: 6f6e 206f 6620 6120 7661 6c75 6520 7769  on of a value wi
-00033b40: 7468 2072 6567 6172 6420 746f 206f 7468  th regard to oth
-00033b50: 6572 2076 616c 7565 730a 2020 2020 7769  er values.    wi
-00033b60: 7468 696e 2074 6865 2073 616d 6520 7769  thin the same wi
-00033b70: 6e64 6f77 2070 6172 7469 7469 6f6e 2e0a  ndow partition..
-00033b80: 0a20 2020 2045 7861 6d70 6c65 3a0a 0a20  .    Example:.. 
-00033b90: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00033ba0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00033bb0: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
-00033bc0: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
-00033bd0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00033be0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-00033bf0: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
-00033c00: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-00033c10: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00033c20: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00033c30: 5b31 2c20 325d 2c20 5b31 2c20 325d 2c20  [1, 2], [1, 2], 
-00033c40: 5b31 2c33 5d2c 205b 342c 2035 5d2c 205b  [1,3], [4, 5], [
-00033c50: 322c 2033 5d2c 205b 332c 2034 5d2c 205b  2, 3], [3, 4], [
-00033c60: 342c 2037 5d2c 205b 332c 375d 2c20 5b34  4, 7], [3,7], [4
-00033c70: 2c35 5d5d 2c20 7363 6865 6d61 3d5b 2261  ,5]], schema=["a
-00033c80: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-00033c90: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-00033ca0: 756d 655f 6469 7374 2829 2e6f 7665 7228  ume_dist().over(
-00033cb0: 5769 6e64 6f77 2e6f 7264 6572 5f62 7928  Window.order_by(
-00033cc0: 2261 2229 292e 6361 7374 2844 6563 696d  "a")).cast(Decim
-00033cd0: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
-00033ce0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-00033cf0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00033d00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00033d10: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-00033d20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00033d30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00033d40: 7c30 2e33 3333 2020 2020 207c 0a20 2020  |0.333     |.   
-00033d50: 2020 2020 207c 302e 3333 3320 2020 2020       |0.333     
-00033d60: 7c0a 2020 2020 2020 2020 7c30 2e33 3333  |.        |0.333
-00033d70: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00033d80: 302e 3434 3420 2020 2020 7c0a 2020 2020  0.444     |.    
-00033d90: 2020 2020 7c30 2e36 3637 2020 2020 207c      |0.667     |
-00033da0: 0a20 2020 2020 2020 207c 302e 3636 3720  .        |0.667 
-00033db0: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
-00033dc0: 2e30 3030 2020 2020 207c 0a20 2020 2020  .000     |.     
-00033dd0: 2020 207c 312e 3030 3020 2020 2020 7c0a     |1.000     |.
-00033de0: 2020 2020 2020 2020 7c31 2e30 3030 2020          |1.000  
-00033df0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00033e00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00033e10: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00033e20: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00033e30: 2062 7569 6c74 696e 2822 6375 6d65 5f64   builtin("cume_d
-00033e40: 6973 7422 2928 290a 0a0a 6465 6620 7261  ist")()...def ra
-00033e50: 6e6b 2829 202d 3e20 436f 6c75 6d6e 3a0a  nk() -> Column:.
-00033e60: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-00033e70: 726e 7320 7468 6520 7261 6e6b 206f 6620  rns the rank of 
-00033e80: 6120 7661 6c75 6520 7769 7468 696e 2061  a value within a
-00033e90: 6e20 6f72 6465 7265 6420 6772 6f75 7020  n ordered group 
-00033ea0: 6f66 2076 616c 7565 732e 0a20 2020 2054  of values..    T
-00033eb0: 6865 2072 616e 6b20 7661 6c75 6520 7374  he rank value st
-00033ec0: 6172 7473 2061 7420 3120 616e 6420 636f  arts at 1 and co
-00033ed0: 6e74 696e 7565 7320 7570 2e0a 0a20 2020  ntinues up...   
-00033ee0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-00033ef0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00033f00: 666c 616b 652e 736e 6f77 7061 726b 2e77  flake.snowpark.w
-00033f10: 696e 646f 7720 696d 706f 7274 2057 696e  indow import Win
-00033f20: 646f 770a 2020 2020 2020 2020 3e3e 3e20  dow.        >>> 
-00033f30: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00033f40: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-00033f50: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-00033f60: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033f70: 2020 2020 205b 312c 2032 2c20 315d 2c0a       [1, 2, 1],.
-00033f80: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033f90: 2020 2020 5b31 2c20 322c 2033 5d2c 0a20      [1, 2, 3],. 
-00033fa0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00033fb0: 2020 205b 322c 2031 2c20 3130 5d2c 0a20     [2, 1, 10],. 
-00033fc0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00033fd0: 2020 205b 322c 2032 2c20 315d 2c0a 2020     [2, 2, 1],.  
-00033fe0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00033ff0: 2020 5b32 2c20 322c 2033 5d2c 0a20 2020    [2, 2, 3],.   
-00034000: 2020 2020 202e 2e2e 2020 2020 205d 2c0a       ...     ],.
-00034010: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00034020: 7363 6865 6d61 3d5b 2278 222c 2022 7922  schema=["x", "y"
-00034030: 2c20 227a 225d 0a20 2020 2020 2020 202e  , "z"].        .
-00034040: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-00034050: 2064 662e 7365 6c65 6374 2872 616e 6b28   df.select(rank(
-00034060: 292e 6f76 6572 2857 696e 646f 772e 7061  ).over(Window.pa
-00034070: 7274 6974 696f 6e5f 6279 2863 6f6c 2822  rtition_by(col("
-00034080: 5822 2929 2e6f 7264 6572 5f62 7928 636f  X")).order_by(co
-00034090: 6c28 2259 2229 2929 2e61 6c69 6173 2822  l("Y"))).alias("
-000340a0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-000340b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000340c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-000340d0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-000340e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000340f0: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
-00034100: 2020 207c 0a20 2020 2020 2020 207c 3220     |.        |2 
-00034110: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00034120: 2020 7c32 2020 2020 2020 2020 207c 0a20    |2         |. 
-00034130: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
-00034140: 2020 7c0a 2020 2020 2020 2020 7c31 2020    |.        |1  
-00034150: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00034160: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00034170: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00034180: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
-00034190: 7475 726e 2062 7569 6c74 696e 2822 7261  turn builtin("ra
-000341a0: 6e6b 2229 2829 0a0a 0a64 6566 2070 6572  nk")()...def per
-000341b0: 6365 6e74 5f72 616e 6b28 2920 2d3e 2043  cent_rank() -> C
-000341c0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-000341d0: 2020 2052 6574 7572 6e73 2074 6865 2072     Returns the r
-000341e0: 656c 6174 6976 6520 7261 6e6b 206f 6620  elative rank of 
-000341f0: 6120 7661 6c75 6520 7769 7468 696e 2061  a value within a
-00034200: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
-00034210: 2c20 7370 6563 6966 6965 6420 6173 2061  , specified as a
-00034220: 2070 6572 6365 6e74 6167 650a 2020 2020   percentage.    
-00034230: 7261 6e67 696e 6720 6672 6f6d 2030 2e30  ranging from 0.0
-00034240: 2074 6f20 312e 302e 0a0a 2020 2020 4578   to 1.0...    Ex
-00034250: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00034260: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00034270: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
-00034280: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
-00034290: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000342a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000342b0: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-000342c0: 2020 2020 2e2e 2e20 2020 2020 5b0a 2020      ...     [.  
-000342d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-000342e0: 2020 5b31 2c20 322c 2031 5d2c 0a20 2020    [1, 2, 1],.   
-000342f0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00034300: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
-00034310: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00034320: 5b32 2c20 312c 2031 305d 2c0a 2020 2020  [2, 1, 10],.    
-00034330: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00034340: 5b32 2c20 322c 2031 5d2c 0a20 2020 2020  [2, 2, 1],.     
-00034350: 2020 202e 2e2e 2020 2020 2020 2020 205b     ...         [
-00034360: 322c 2032 2c20 335d 2c0a 2020 2020 2020  2, 2, 3],.      
-00034370: 2020 2e2e 2e20 2020 2020 5d2c 0a20 2020    ...     ],.   
-00034380: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
-00034390: 656d 613d 5b22 7822 2c20 2279 222c 2022  ema=["x", "y", "
-000343a0: 7a22 5d0a 2020 2020 2020 2020 2e2e 2e20  z"].        ... 
-000343b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000343c0: 2e73 656c 6563 7428 7065 7263 656e 745f  .select(percent_
-000343d0: 7261 6e6b 2829 2e6f 7665 7228 5769 6e64  rank().over(Wind
-000343e0: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
-000343f0: 2278 2229 2e6f 7264 6572 5f62 7928 636f  "x").order_by(co
-00034400: 6c28 2279 2229 2929 2e61 6c69 6173 2822  l("y"))).alias("
-00034410: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00034420: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00034430: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00034440: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-00034450: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00034460: 2020 2020 2020 2020 7c30 2e30 2020 2020          |0.0    
-00034470: 2020 207c 0a20 2020 2020 2020 207c 302e     |.        |0.
-00034480: 3520 2020 2020 2020 7c0a 2020 2020 2020  5       |.      
-00034490: 2020 7c30 2e35 2020 2020 2020 207c 0a20    |0.5       |. 
-000344a0: 2020 2020 2020 207c 302e 3020 2020 2020         |0.0     
-000344b0: 2020 7c0a 2020 2020 2020 2020 7c30 2e30    |.        |0.0
-000344c0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-000344d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-000344e0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-000344f0: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
-00034500: 7475 726e 2062 7569 6c74 696e 2822 7065  turn builtin("pe
-00034510: 7263 656e 745f 7261 6e6b 2229 2829 0a0a  rcent_rank")()..
-00034520: 0a64 6566 2064 656e 7365 5f72 616e 6b28  .def dense_rank(
-00034530: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00034540: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00034550: 2074 6865 2072 616e 6b20 6f66 2061 2076   the rank of a v
-00034560: 616c 7565 2077 6974 6869 6e20 6120 6772  alue within a gr
-00034570: 6f75 7020 6f66 2076 616c 7565 732c 2077  oup of values, w
-00034580: 6974 686f 7574 2067 6170 7320 696e 2074  ithout gaps in t
-00034590: 6865 2072 616e 6b73 2e0a 2020 2020 5468  he ranks..    Th
-000345a0: 6520 7261 6e6b 2076 616c 7565 2073 7461  e rank value sta
-000345b0: 7274 7320 6174 2031 2061 6e64 2063 6f6e  rts at 1 and con
-000345c0: 7469 6e75 6573 2075 7020 7365 7175 656e  tinues up sequen
-000345d0: 7469 616c 6c79 2e0a 2020 2020 4966 2074  tially..    If t
-000345e0: 776f 2076 616c 7565 7320 6172 6520 7468  wo values are th
-000345f0: 6520 7361 6d65 2c20 7468 6579 2077 696c  e same, they wil
-00034600: 6c20 6861 7665 2074 6865 2073 616d 6520  l have the same 
-00034610: 7261 6e6b 2e0a 0a20 2020 2045 7861 6d70  rank...    Examp
-00034620: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00034630: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-00034640: 2e73 6e6f 7770 6172 6b2e 7769 6e64 6f77  .snowpark.window
-00034650: 2069 6d70 6f72 7420 5769 6e64 6f77 0a20   import Window. 
-00034660: 2020 2020 2020 203e 3e3e 2077 696e 646f         >>> windo
-00034670: 7720 3d20 5769 6e64 6f77 2e6f 7264 6572  w = Window.order
-00034680: 5f62 7928 226b 6579 2229 0a20 2020 2020  _by("key").     
-00034690: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000346a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000346b0: 7261 6d65 285b 2831 2c20 2231 2229 2c20  rame([(1, "1"), 
-000346c0: 2832 2c20 2232 2229 2c20 2831 2c20 2233  (2, "2"), (1, "3
-000346d0: 2229 2c20 2832 2c20 2234 2229 5d2c 2073  "), (2, "4")], s
-000346e0: 6368 656d 613d 5b22 6b65 7922 2c20 2276  chema=["key", "v
-000346f0: 616c 7565 225d 290a 2020 2020 2020 2020  alue"]).        
-00034700: 3e3e 3e20 6466 2e73 656c 6563 7428 6465  >>> df.select(de
-00034710: 6e73 655f 7261 6e6b 2829 2e6f 7665 7228  nse_rank().over(
-00034720: 7769 6e64 6f77 292e 6173 5f28 2264 656e  window).as_("den
-00034730: 7365 5f72 616e 6b22 2929 2e63 6f6c 6c65  se_rank")).colle
-00034740: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00034750: 7728 4445 4e53 455f 5241 4e4b 3d31 292c  w(DENSE_RANK=1),
-00034760: 2052 6f77 2844 454e 5345 5f52 414e 4b3d   Row(DENSE_RANK=
-00034770: 3129 2c20 526f 7728 4445 4e53 455f 5241  1), Row(DENSE_RA
-00034780: 4e4b 3d32 292c 2052 6f77 2844 454e 5345  NK=2), Row(DENSE
-00034790: 5f52 414e 4b3d 3229 5d0a 2020 2020 2222  _RANK=2)].    ""
-000347a0: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
-000347b0: 6c74 696e 2822 6465 6e73 655f 7261 6e6b  ltin("dense_rank
-000347c0: 2229 2829 0a0a 0a64 6566 2072 6f77 5f6e  ")()...def row_n
-000347d0: 756d 6265 7228 2920 2d3e 2043 6f6c 756d  umber() -> Colum
-000347e0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-000347f0: 6574 7572 6e73 2061 2075 6e69 7175 6520  eturns a unique 
-00034800: 726f 7720 6e75 6d62 6572 2066 6f72 2065  row number for e
-00034810: 6163 6820 726f 7720 7769 7468 696e 2061  ach row within a
-00034820: 2077 696e 646f 7720 7061 7274 6974 696f   window partitio
-00034830: 6e2e 0a20 2020 2054 6865 2072 6f77 206e  n..    The row n
-00034840: 756d 6265 7220 7374 6172 7473 2061 7420  umber starts at 
-00034850: 3120 616e 6420 636f 6e74 696e 7565 7320  1 and continues 
-00034860: 7570 2073 6571 7565 6e74 6961 6c6c 792e  up sequentially.
-00034870: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00034880: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00034890: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-000348a0: 7061 726b 2e77 696e 646f 7720 696d 706f  park.window impo
-000348b0: 7274 2057 696e 646f 770a 2020 2020 2020  rt Window.      
-000348c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000348d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000348e0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-000348f0: 2020 2020 205b 0a20 2020 2020 2020 202e       [.        .
-00034900: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
-00034910: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
-00034920: 2e20 2020 2020 2020 2020 5b31 2c20 322c  .         [1, 2,
-00034930: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
-00034940: 2020 2020 2020 2020 205b 322c 2031 2c20           [2, 1, 
-00034950: 3130 5d2c 0a20 2020 2020 2020 202e 2e2e  10],.        ...
-00034960: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
-00034970: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
-00034980: 2020 2020 2020 2020 5b32 2c20 322c 2033          [2, 2, 3
-00034990: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-000349a0: 2020 205d 2c0a 2020 2020 2020 2020 2e2e     ],.        ..
-000349b0: 2e20 2020 2020 7363 6865 6d61 3d5b 2278  .     schema=["x
-000349c0: 222c 2022 7922 2c20 227a 225d 0a20 2020  ", "y", "z"].   
-000349d0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-000349e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000349f0: 2872 6f77 5f6e 756d 6265 7228 292e 6f76  (row_number().ov
-00034a00: 6572 2857 696e 646f 772e 7061 7274 6974  er(Window.partit
-00034a10: 696f 6e5f 6279 2863 6f6c 2822 5822 2929  ion_by(col("X"))
-00034a20: 2e6f 7264 6572 5f62 7928 636f 6c28 2259  .order_by(col("Y
-00034a30: 2229 2929 2e61 6c69 6173 2822 7265 7375  "))).alias("resu
-00034a40: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00034a50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00034a60: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00034a70: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00034a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00034a90: 2020 2020 7c31 2020 2020 2020 2020 207c      |1         |
-00034aa0: 0a20 2020 2020 2020 207c 3220 2020 2020  .        |2     
-00034ab0: 2020 2020 7c0a 2020 2020 2020 2020 7c33      |.        |3
-00034ac0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00034ad0: 2020 207c 3120 2020 2020 2020 2020 7c0a     |1         |.
-00034ae0: 2020 2020 2020 2020 7c32 2020 2020 2020          |2      
-00034af0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00034b00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00034b10: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00034b20: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00034b30: 2062 7569 6c74 696e 2822 726f 775f 6e75   builtin("row_nu
-00034b40: 6d62 6572 2229 2829 0a0a 0a64 6566 206c  mber")()...def l
-00034b50: 6167 280a 2020 2020 653a 2043 6f6c 756d  ag(.    e: Colum
-00034b60: 6e4f 724e 616d 652c 0a20 2020 206f 6666  nOrName,.    off
-00034b70: 7365 743a 2069 6e74 203d 2031 2c0a 2020  set: int = 1,.  
-00034b80: 2020 6465 6661 756c 745f 7661 6c75 653a    default_value:
-00034b90: 204f 7074 696f 6e61 6c5b 436f 6c75 6d6e   Optional[Column
-00034ba0: 4f72 4c69 7465 7261 6c5d 203d 204e 6f6e  OrLiteral] = Non
-00034bb0: 652c 0a20 2020 2069 676e 6f72 655f 6e75  e,.    ignore_nu
-00034bc0: 6c6c 733a 2062 6f6f 6c20 3d20 4661 6c73  lls: bool = Fals
-00034bd0: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
-00034be0: 2020 2020 2222 220a 2020 2020 4163 6365      """.    Acce
-00034bf0: 7373 6573 2064 6174 6120 696e 2061 2070  sses data in a p
-00034c00: 7265 7669 6f75 7320 726f 7720 696e 2074  revious row in t
-00034c10: 6865 2073 616d 6520 7265 7375 6c74 2073  he same result s
-00034c20: 6574 2077 6974 686f 7574 2068 6176 696e  et without havin
-00034c30: 6720 746f 0a20 2020 206a 6f69 6e20 7468  g to.    join th
-00034c40: 6520 7461 626c 6520 746f 2069 7473 656c  e table to itsel
-00034c50: 662e 0a0a 2020 2020 4578 616d 706c 653a  f...    Example:
-00034c60: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
-00034c70: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-00034c80: 6f77 7061 726b 2e77 696e 646f 7720 696d  owpark.window im
-00034c90: 706f 7274 2057 696e 646f 770a 2020 2020  port Window.    
-00034ca0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00034cb0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00034cc0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
-00034cd0: 2e2e 2020 2020 205b 0a20 2020 2020 2020  ..     [.       
-00034ce0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
-00034cf0: 2032 2c20 315d 2c0a 2020 2020 2020 2020   2, 1],.        
-00034d00: 2e2e 2e20 2020 2020 2020 2020 5b31 2c20  ...         [1, 
-00034d10: 322c 2033 5d2c 0a20 2020 2020 2020 202e  2, 3],.        .
-00034d20: 2e2e 2020 2020 2020 2020 205b 322c 2031  ..         [2, 1
-00034d30: 2c20 3130 5d2c 0a20 2020 2020 2020 202e  , 10],.        .
-00034d40: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
-00034d50: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
-00034d60: 2e20 2020 2020 2020 2020 5b32 2c20 322c  .         [2, 2,
-00034d70: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
-00034d80: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00034d90: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-00034da0: 2278 222c 2022 7922 2c20 227a 225d 0a20  "x", "y", "z"]. 
-00034db0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00034dc0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00034dd0: 6374 286c 6167 2822 5a22 292e 6f76 6572  ct(lag("Z").over
-00034de0: 2857 696e 646f 772e 7061 7274 6974 696f  (Window.partitio
-00034df0: 6e5f 6279 2863 6f6c 2822 5822 2929 2e6f  n_by(col("X")).o
-00034e00: 7264 6572 5f62 7928 636f 6c28 2259 2229  rder_by(col("Y")
-00034e10: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
-00034e20: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00034e30: 2020 2020 2020 5b52 6f77 2852 4553 554c        [Row(RESUL
-00034e40: 543d 4e6f 6e65 292c 2052 6f77 2852 4553  T=None), Row(RES
-00034e50: 554c 543d 3130 292c 2052 6f77 2852 4553  ULT=10), Row(RES
-00034e60: 554c 543d 3129 2c20 526f 7728 5245 5355  ULT=1), Row(RESU
-00034e70: 4c54 3d4e 6f6e 6529 2c20 526f 7728 5245  LT=None), Row(RE
-00034e80: 5355 4c54 3d31 295d 0a20 2020 2022 2222  SULT=1)].    """
-00034e90: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00034ea0: 5f69 665f 7374 7228 652c 2022 6c61 6722  _if_str(e, "lag"
-00034eb0: 290a 2020 2020 7265 7475 726e 2043 6f6c  ).    return Col
-00034ec0: 756d 6e28 0a20 2020 2020 2020 204c 6167  umn(.        Lag
-00034ed0: 2863 2e5f 6578 7072 6573 7369 6f6e 2c20  (c._expression, 
-00034ee0: 6f66 6673 6574 2c20 436f 6c75 6d6e 2e5f  offset, Column._
-00034ef0: 746f 5f65 7870 7228 6465 6661 756c 745f  to_expr(default_
-00034f00: 7661 6c75 6529 2c20 6967 6e6f 7265 5f6e  value), ignore_n
-00034f10: 756c 6c73 290a 2020 2020 290a 0a0a 6465  ulls).    )...de
-00034f20: 6620 6c65 6164 280a 2020 2020 653a 2043  f lead(.    e: C
-00034f30: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
-00034f40: 206f 6666 7365 743a 2069 6e74 203d 2031   offset: int = 1
-00034f50: 2c0a 2020 2020 6465 6661 756c 745f 7661  ,.    default_va
-00034f60: 6c75 653a 204f 7074 696f 6e61 6c5b 556e  lue: Optional[Un
-00034f70: 696f 6e5b 436f 6c75 6d6e 2c20 4c69 7465  ion[Column, Lite
-00034f80: 7261 6c54 7970 655d 5d20 3d20 4e6f 6e65  ralType]] = None
-00034f90: 2c0a 2020 2020 6967 6e6f 7265 5f6e 756c  ,.    ignore_nul
-00034fa0: 6c73 3a20 626f 6f6c 203d 2046 616c 7365  ls: bool = False
-00034fb0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-00034fc0: 2020 2022 2222 0a20 2020 2041 6363 6573     """.    Acces
-00034fd0: 7365 7320 6461 7461 2069 6e20 6120 7375  ses data in a su
-00034fe0: 6273 6571 7565 6e74 2072 6f77 2069 6e20  bsequent row in 
-00034ff0: 7468 6520 7361 6d65 2072 6573 756c 7420  the same result 
-00035000: 7365 7420 7769 7468 6f75 7420 6861 7669  set without havi
-00035010: 6e67 2074 6f0a 2020 2020 6a6f 696e 2074  ng to.    join t
-00035020: 6865 2074 6162 6c65 2074 6f20 6974 7365  he table to itse
-00035030: 6c66 2e0a 0a20 2020 2045 7861 6d70 6c65  lf...    Example
-00035040: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00035050: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00035060: 6e6f 7770 6172 6b2e 7769 6e64 6f77 2069  nowpark.window i
-00035070: 6d70 6f72 7420 5769 6e64 6f77 0a20 2020  mport Window.   
-00035080: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00035090: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000350a0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-000350b0: 2e2e 2e20 2020 2020 5b0a 2020 2020 2020  ...     [.      
-000350c0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
-000350d0: 2c20 322c 2031 5d2c 0a20 2020 2020 2020  , 2, 1],.       
-000350e0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
-000350f0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
-00035100: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
-00035110: 312c 2031 305d 2c0a 2020 2020 2020 2020  1, 10],.        
-00035120: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
-00035130: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
-00035140: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
-00035150: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
-00035160: 2e20 2020 2020 5d2c 0a20 2020 2020 2020  .     ],.       
-00035170: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00035180: 5b22 7822 2c20 2279 222c 2022 7a22 5d0a  ["x", "y", "z"].
-00035190: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
-000351a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000351b0: 6563 7428 6c65 6164 2822 5a22 292e 6f76  ect(lead("Z").ov
-000351c0: 6572 2857 696e 646f 772e 7061 7274 6974  er(Window.partit
-000351d0: 696f 6e5f 6279 2863 6f6c 2822 5822 2929  ion_by(col("X"))
-000351e0: 2e6f 7264 6572 5f62 7928 636f 6c28 2259  .order_by(col("Y
-000351f0: 2229 2929 2e61 6c69 6173 2822 7265 7375  "))).alias("resu
-00035200: 6c74 2229 292e 636f 6c6c 6563 7428 290a  lt")).collect().
-00035210: 2020 2020 2020 2020 5b52 6f77 2852 4553          [Row(RES
-00035220: 554c 543d 3129 2c20 526f 7728 5245 5355  ULT=1), Row(RESU
-00035230: 4c54 3d33 292c 2052 6f77 2852 4553 554c  LT=3), Row(RESUL
-00035240: 543d 4e6f 6e65 292c 2052 6f77 2852 4553  T=None), Row(RES
-00035250: 554c 543d 3329 2c20 526f 7728 5245 5355  ULT=3), Row(RESU
-00035260: 4c54 3d4e 6f6e 6529 5d0a 2020 2020 2222  LT=None)].    ""
-00035270: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00035280: 6c5f 6966 5f73 7472 2865 2c20 226c 6561  l_if_str(e, "lea
-00035290: 6422 290a 2020 2020 7265 7475 726e 2043  d").    return C
-000352a0: 6f6c 756d 6e28 0a20 2020 2020 2020 204c  olumn(.        L
-000352b0: 6561 6428 632e 5f65 7870 7265 7373 696f  ead(c._expressio
-000352c0: 6e2c 206f 6666 7365 742c 2043 6f6c 756d  n, offset, Colum
-000352d0: 6e2e 5f74 6f5f 6578 7072 2864 6566 6175  n._to_expr(defau
-000352e0: 6c74 5f76 616c 7565 292c 2069 676e 6f72  lt_value), ignor
-000352f0: 655f 6e75 6c6c 7329 0a20 2020 2029 0a0a  e_nulls).    )..
-00035300: 0a64 6566 206c 6173 745f 7661 6c75 6528  .def last_value(
-00035310: 0a20 2020 2065 3a20 436f 6c75 6d6e 4f72  .    e: ColumnOr
-00035320: 4e61 6d65 2c0a 2020 2020 6967 6e6f 7265  Name,.    ignore
-00035330: 5f6e 756c 6c73 3a20 626f 6f6c 203d 2046  _nulls: bool = F
-00035340: 616c 7365 2c0a 2920 2d3e 2043 6f6c 756d  alse,.) -> Colum
-00035350: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-00035360: 6574 7572 6e73 2074 6865 206c 6173 7420  eturns the last 
-00035370: 7661 6c75 6520 7769 7468 696e 2061 6e20  value within an 
-00035380: 6f72 6465 7265 6420 6772 6f75 7020 6f66  ordered group of
-00035390: 2076 616c 7565 732e 0a0a 2020 2020 4578   values...    Ex
-000353a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000353b0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-000353c0: 616b 652e 736e 6f77 7061 726b 2e77 696e  ake.snowpark.win
-000353d0: 646f 7720 696d 706f 7274 2057 696e 646f  dow import Windo
-000353e0: 770a 2020 2020 2020 2020 3e3e 3e20 7769  w.        >>> wi
-000353f0: 6e64 6f77 203d 2057 696e 646f 772e 7061  ndow = Window.pa
-00035400: 7274 6974 696f 6e5f 6279 2822 636f 6c75  rtition_by("colu
-00035410: 6d6e 3122 292e 6f72 6465 725f 6279 2822  mn1").order_by("
-00035420: 636f 6c75 6d6e 3222 290a 2020 2020 2020  column2").      
-00035430: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00035440: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00035450: 616d 6528 5b5b 312c 2031 305d 2c20 5b31  ame([[1, 10], [1
-00035460: 2c20 3131 5d2c 205b 322c 2032 305d 2c20  , 11], [2, 20], 
-00035470: 5b32 2c20 3231 5d5d 2c20 7363 6865 6d61  [2, 21]], schema
-00035480: 3d5b 2263 6f6c 756d 6e31 222c 2022 636f  =["column1", "co
-00035490: 6c75 6d6e 3222 5d29 0a20 2020 2020 2020  lumn2"]).       
-000354a0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-000354b0: 665b 2263 6f6c 756d 6e31 225d 2c20 6466  f["column1"], df
-000354c0: 5b22 636f 6c75 6d6e 3222 5d2c 206c 6173  ["column2"], las
-000354d0: 745f 7661 6c75 6528 6466 5b22 636f 6c75  t_value(df["colu
-000354e0: 6d6e 3222 5d29 2e6f 7665 7228 7769 6e64  mn2"]).over(wind
-000354f0: 6f77 292e 6173 5f28 2263 6f6c 756d 6e32  ow).as_("column2
-00035500: 5f6c 6173 7422 2929 2e63 6f6c 6c65 6374  _last")).collect
-00035510: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00035520: 434f 4c55 4d4e 313d 312c 2043 4f4c 554d  COLUMN1=1, COLUM
-00035530: 4e32 3d31 302c 2043 4f4c 554d 4e32 5f4c  N2=10, COLUMN2_L
-00035540: 4153 543d 3131 292c 2052 6f77 2843 4f4c  AST=11), Row(COL
-00035550: 554d 4e31 3d31 2c20 434f 4c55 4d4e 323d  UMN1=1, COLUMN2=
-00035560: 3131 2c20 434f 4c55 4d4e 325f 4c41 5354  11, COLUMN2_LAST
-00035570: 3d31 3129 2c20 526f 7728 434f 4c55 4d4e  =11), Row(COLUMN
-00035580: 313d 322c 2043 4f4c 554d 4e32 3d32 302c  1=2, COLUMN2=20,
-00035590: 2043 4f4c 554d 4e32 5f4c 4153 543d 3231   COLUMN2_LAST=21
-000355a0: 292c 2052 6f77 2843 4f4c 554d 4e31 3d32  ), Row(COLUMN1=2
-000355b0: 2c20 434f 4c55 4d4e 323d 3231 2c20 434f  , COLUMN2=21, CO
-000355c0: 4c55 4d4e 325f 4c41 5354 3d32 3129 5d0a  LUMN2_LAST=21)].
-000355d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-000355e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-000355f0: 2c20 226c 6173 745f 7661 6c75 6522 290a  , "last_value").
-00035600: 2020 2020 7265 7475 726e 2043 6f6c 756d      return Colum
-00035610: 6e28 4c61 7374 5661 6c75 6528 632e 5f65  n(LastValue(c._e
-00035620: 7870 7265 7373 696f 6e2c 204e 6f6e 652c  xpression, None,
-00035630: 204e 6f6e 652c 2069 676e 6f72 655f 6e75   None, ignore_nu
-00035640: 6c6c 7329 290a 0a0a 6465 6620 6669 7273  lls))...def firs
-00035650: 745f 7661 6c75 6528 0a20 2020 2065 3a20  t_value(.    e: 
-00035660: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
-00035670: 2020 6967 6e6f 7265 5f6e 756c 6c73 3a20    ignore_nulls: 
-00035680: 626f 6f6c 203d 2046 616c 7365 2c0a 2920  bool = False,.) 
-00035690: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-000356a0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-000356b0: 6865 2066 6972 7374 2076 616c 7565 2077  he first value w
-000356c0: 6974 6869 6e20 616e 206f 7264 6572 6564  ithin an ordered
-000356d0: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
-000356e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000356f0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00035700: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00035710: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
-00035720: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
-00035730: 2020 203e 3e3e 2077 696e 646f 7720 3d20     >>> window = 
-00035740: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
-00035750: 5f62 7928 2263 6f6c 756d 6e31 2229 2e6f  _by("column1").o
-00035760: 7264 6572 5f62 7928 2263 6f6c 756d 6e32  rder_by("column2
-00035770: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
-00035780: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00035790: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
-000357a0: 2c20 3130 5d2c 205b 312c 2031 315d 2c20  , 10], [1, 11], 
-000357b0: 5b32 2c20 3230 5d2c 205b 322c 2032 315d  [2, 20], [2, 21]
-000357c0: 5d2c 2073 6368 656d 613d 5b22 636f 6c75  ], schema=["colu
-000357d0: 6d6e 3122 2c20 2263 6f6c 756d 6e32 225d  mn1", "column2"]
-000357e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000357f0: 2e73 656c 6563 7428 6466 5b22 636f 6c75  .select(df["colu
-00035800: 6d6e 3122 5d2c 2064 665b 2263 6f6c 756d  mn1"], df["colum
-00035810: 6e32 225d 2c20 6669 7273 745f 7661 6c75  n2"], first_valu
-00035820: 6528 6466 5b22 636f 6c75 6d6e 3222 5d29  e(df["column2"])
-00035830: 2e6f 7665 7228 7769 6e64 6f77 292e 6173  .over(window).as
-00035840: 5f28 2263 6f6c 756d 6e32 5f66 6972 7374  _("column2_first
-00035850: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00035860: 2020 2020 2020 5b52 6f77 2843 4f4c 554d        [Row(COLUM
-00035870: 4e31 3d31 2c20 434f 4c55 4d4e 323d 3130  N1=1, COLUMN2=10
-00035880: 2c20 434f 4c55 4d4e 325f 4649 5253 543d  , COLUMN2_FIRST=
-00035890: 3130 292c 2052 6f77 2843 4f4c 554d 4e31  10), Row(COLUMN1
-000358a0: 3d31 2c20 434f 4c55 4d4e 323d 3131 2c20  =1, COLUMN2=11, 
-000358b0: 434f 4c55 4d4e 325f 4649 5253 543d 3130  COLUMN2_FIRST=10
-000358c0: 292c 2052 6f77 2843 4f4c 554d 4e31 3d32  ), Row(COLUMN1=2
-000358d0: 2c20 434f 4c55 4d4e 323d 3230 2c20 434f  , COLUMN2=20, CO
-000358e0: 4c55 4d4e 325f 4649 5253 543d 3230 292c  LUMN2_FIRST=20),
-000358f0: 2052 6f77 2843 4f4c 554d 4e31 3d32 2c20   Row(COLUMN1=2, 
-00035900: 434f 4c55 4d4e 323d 3231 2c20 434f 4c55  COLUMN2=21, COLU
-00035910: 4d4e 325f 4649 5253 543d 3230 295d 0a20  MN2_FIRST=20)]. 
-00035920: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-00035930: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-00035940: 2022 6c61 7374 5f76 616c 7565 2229 0a20   "last_value"). 
-00035950: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
-00035960: 2846 6972 7374 5661 6c75 6528 632e 5f65  (FirstValue(c._e
-00035970: 7870 7265 7373 696f 6e2c 204e 6f6e 652c  xpression, None,
-00035980: 204e 6f6e 652c 2069 676e 6f72 655f 6e75   None, ignore_nu
-00035990: 6c6c 7329 290a 0a0a 6465 6620 6e74 696c  lls))...def ntil
-000359a0: 6528 653a 2055 6e69 6f6e 5b69 6e74 2c20  e(e: Union[int, 
-000359b0: 436f 6c75 6d6e 4f72 4e61 6d65 5d29 202d  ColumnOrName]) -
-000359c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000359d0: 220a 2020 2020 4469 7669 6465 7320 616e  ".    Divides an
-000359e0: 206f 7264 6572 6564 2064 6174 6120 7365   ordered data se
-000359f0: 7420 6571 7561 6c6c 7920 696e 746f 2074  t equally into t
-00035a00: 6865 206e 756d 6265 7220 6f66 2062 7563  he number of buc
-00035a10: 6b65 7473 2073 7065 6369 6669 6564 2062  kets specified b
-00035a20: 7920 6e2e 0a20 2020 2042 7563 6b65 7473  y n..    Buckets
-00035a30: 2061 7265 2073 6571 7565 6e74 6961 6c6c   are sequentiall
-00035a40: 7920 6e75 6d62 6572 6564 2031 2074 6872  y numbered 1 thr
-00035a50: 6f75 6768 206e 2e0a 0a20 2020 2041 7267  ough n...    Arg
-00035a60: 733a 0a20 2020 2020 2020 2065 3a20 5468  s:.        e: Th
-00035a70: 6520 6465 7369 7265 6420 6e75 6d62 6572  e desired number
-00035a80: 206f 6620 6275 636b 6574 733b 206d 7573   of buckets; mus
-00035a90: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
-00035aa0: 696e 7465 6765 7220 7661 6c75 652e 0a0a  integer value...
-00035ab0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00035ac0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00035ad0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00035ae0: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
-00035af0: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
-00035b00: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00035b10: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00035b20: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-00035b30: 2020 205b 5b22 4322 2c20 2253 5059 222c     [["C", "SPY",
-00035b40: 2033 5d2c 205b 2243 222c 2022 4141 504c   3], ["C", "AAPL
-00035b50: 222c 2031 305d 2c20 5b22 4e22 2c20 2253  ", 10], ["N", "S
-00035b60: 5059 222c 2035 5d2c 205b 224e 222c 2022  PY", 5], ["N", "
-00035b70: 4141 504c 222c 2037 5d2c 205b 2251 222c  AAPL", 7], ["Q",
-00035b80: 2022 4d53 4654 222c 2033 5d5d 2c0a 2020   "MSFT", 3]],.  
-00035b90: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-00035ba0: 6865 6d61 3d5b 2265 7863 6861 6e67 6522  hema=["exchange"
-00035bb0: 2c20 2273 796d 626f 6c22 2c20 2273 6861  , "symbol", "sha
-00035bc0: 7265 7322 5d0a 2020 2020 2020 2020 2e2e  res"].        ..
-00035bd0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-00035be0: 6466 2e73 656c 6563 7428 636f 6c28 2265  df.select(col("e
-00035bf0: 7863 6861 6e67 6522 292c 2063 6f6c 2822  xchange"), col("
-00035c00: 7379 6d62 6f6c 2229 2c20 6e74 696c 6528  symbol"), ntile(
-00035c10: 3329 2e6f 7665 7228 5769 6e64 6f77 2e70  3).over(Window.p
-00035c20: 6172 7469 7469 6f6e 5f62 7928 2265 7863  artition_by("exc
-00035c30: 6861 6e67 6522 292e 6f72 6465 725f 6279  hange").order_by
-00035c40: 2822 7368 6172 6573 2229 292e 616c 6961  ("shares")).alia
-00035c50: 7328 226e 7469 6c65 5f33 2229 292e 7368  s("ntile_3")).sh
-00035c60: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-00035c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035c90: 2d2d 0a20 2020 2020 2020 207c 2245 5843  --.        |"EXC
-00035ca0: 4841 4e47 4522 2020 7c22 5359 4d42 4f4c  HANGE"  |"SYMBOL
-00035cb0: 2220 207c 224e 5449 4c45 5f33 2220 207c  "  |"NTILE_3"  |
-00035cc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00035cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00035cf0: 2020 2020 2020 207c 5120 2020 2020 2020         |Q       
-00035d00: 2020 2020 7c4d 5346 5420 2020 2020 207c      |MSFT      |
-00035d10: 3120 2020 2020 2020 2020 207c 0a20 2020  1          |.   
-00035d20: 2020 2020 207c 4e20 2020 2020 2020 2020       |N         
-00035d30: 2020 7c53 5059 2020 2020 2020 207c 3120    |SPY       |1 
-00035d40: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00035d50: 2020 207c 4e20 2020 2020 2020 2020 2020     |N           
-00035d60: 7c41 4150 4c20 2020 2020 207c 3220 2020  |AAPL      |2   
-00035d70: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00035d80: 207c 4320 2020 2020 2020 2020 2020 7c53   |C           |S
-00035d90: 5059 2020 2020 2020 207c 3120 2020 2020  PY       |1     
-00035da0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00035db0: 4320 2020 2020 2020 2020 2020 7c41 4150  C           |AAP
-00035dc0: 4c20 2020 2020 207c 3220 2020 2020 2020  L      |2       
-00035dd0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00035de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00035e00: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00035e10: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00035e20: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00035e30: 665f 7374 725f 6f72 5f69 6e74 2865 2c20  f_str_or_int(e, 
-00035e40: 226e 7469 6c65 2229 0a20 2020 2072 6574  "ntile").    ret
-00035e50: 7572 6e20 6275 696c 7469 6e28 226e 7469  urn builtin("nti
-00035e60: 6c65 2229 2863 290a 0a0a 6465 6620 7065  le")(c)...def pe
-00035e70: 7263 656e 7469 6c65 5f63 6f6e 7428 7065  rcentile_cont(pe
-00035e80: 7263 656e 7469 6c65 3a20 666c 6f61 7429  rcentile: float)
-00035e90: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00035ea0: 2222 220a 2020 2020 5265 7475 726e 2061  """.    Return a
-00035eb0: 2070 6572 6365 6e74 696c 6520 7661 6c75   percentile valu
-00035ec0: 6520 6261 7365 6420 6f6e 2061 2063 6f6e  e based on a con
-00035ed0: 7469 6e75 6f75 7320 6469 7374 7269 6275  tinuous distribu
-00035ee0: 7469 6f6e 206f 6620 7468 650a 2020 2020  tion of the.    
-00035ef0: 696e 7075 7420 636f 6c75 6d6e 2e20 4966  input column. If
-00035f00: 206e 6f20 696e 7075 7420 726f 7720 6c69   no input row li
-00035f10: 6573 2065 7861 6374 6c79 2061 7420 7468  es exactly at th
-00035f20: 6520 6465 7369 7265 6420 7065 7263 656e  e desired percen
-00035f30: 7469 6c65 2c0a 2020 2020 7468 6520 7265  tile,.    the re
-00035f40: 7375 6c74 2069 7320 6361 6c63 756c 6174  sult is calculat
-00035f50: 6564 2075 7369 6e67 206c 696e 6561 7220  ed using linear 
-00035f60: 696e 7465 7270 6f6c 6174 696f 6e20 6f66  interpolation of
-00035f70: 2074 6865 2074 776f 206e 6561 7265 7374   the two nearest
-00035f80: 0a20 2020 2069 6e70 7574 2076 616c 7565  .    input value
-00035f90: 732e 204e 554c 4c20 7661 6c75 6573 2061  s. NULL values a
-00035fa0: 7265 2069 676e 6f72 6564 2069 6e20 7468  re ignored in th
-00035fb0: 6520 6361 6c63 756c 6174 696f 6e2e 0a0a  e calculation...
-00035fc0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00035fd0: 2020 7065 7263 656e 7469 6c65 3a20 7468    percentile: th
-00035fe0: 6520 7065 7263 656e 7469 6c65 206f 6620  e percentile of 
-00035ff0: 7468 6520 7661 6c75 6520 7468 6174 2079  the value that y
-00036000: 6f75 2077 616e 7420 746f 2066 696e 642e  ou want to find.
-00036010: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00036020: 2070 6572 6365 6e74 696c 6520 6d75 7374   percentile must
-00036030: 2062 6520 6120 636f 6e73 7461 6e74 2062   be a constant b
-00036040: 6574 7765 656e 2030 2e30 2061 6e64 2031  etween 0.0 and 1
-00036050: 2e30 2e20 466f 7220 6578 616d 706c 652c  .0. For example,
-00036060: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00036070: 796f 7520 7761 6e74 2074 6f20 6669 6e64  you want to find
-00036080: 2074 6865 2076 616c 7565 2061 7420 7468   the value at th
-00036090: 6520 3930 7468 2070 6572 6365 6e74 696c  e 90th percentil
-000360a0: 652c 2073 7065 6369 6679 2030 2e39 2e0a  e, specify 0.9..
-000360b0: 0a20 2020 2045 7861 6d70 6c65 3a0a 0a20  .    Example:.. 
-000360c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000360d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000360e0: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-000360f0: 2020 202e 2e2e 2020 2020 2028 302c 2030     ...     (0, 0
-00036100: 292c 2028 302c 2031 3029 2c20 2830 2c20  ), (0, 10), (0, 
-00036110: 3230 292c 2028 302c 2033 3029 2c20 2830  20), (0, 30), (0
-00036120: 2c20 3430 292c 0a20 2020 2020 2020 202e  , 40),.        .
-00036130: 2e2e 2020 2020 2028 312c 2031 3029 2c20  ..     (1, 10), 
-00036140: 2831 2c20 3230 292c 2028 322c 2031 3029  (1, 20), (2, 10)
-00036150: 2c20 2832 2c20 3230 292c 2028 322c 2032  , (2, 20), (2, 2
-00036160: 3529 2c0a 2020 2020 2020 2020 2e2e 2e20  5),.        ... 
-00036170: 2020 2020 2832 2c20 3330 292c 2028 332c      (2, 30), (3,
-00036180: 2036 3029 2c20 2834 2c20 4e6f 6e65 290a   60), (4, None).
-00036190: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
-000361a0: 6368 656d 613d 5b22 6b22 2c20 2276 225d  chema=["k", "v"]
-000361b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000361c0: 2e67 726f 7570 5f62 7928 226b 2229 2e61  .group_by("k").a
-000361d0: 6767 2870 6572 6365 6e74 696c 655f 636f  gg(percentile_co
-000361e0: 6e74 2830 2e32 3529 2e77 6974 6869 6e5f  nt(0.25).within_
-000361f0: 6772 6f75 7028 2276 2229 2e61 735f 2822  group("v").as_("
-00036200: 7065 7263 656e 7469 6c65 2229 292e 736f  percentile")).so
-00036210: 7274 2822 6b22 292e 636f 6c6c 6563 7428  rt("k").collect(
-00036220: 290a 2020 2020 2020 2020 5b52 6f77 284b  ).        [Row(K
-00036230: 3d30 2c20 5045 5243 454e 5449 4c45 3d44  =0, PERCENTILE=D
-00036240: 6563 696d 616c 2827 3130 2e30 3030 2729  ecimal('10.000')
-00036250: 292c 205c 0a52 6f77 284b 3d31 2c20 5045  ), \.Row(K=1, PE
-00036260: 5243 454e 5449 4c45 3d44 6563 696d 616c  RCENTILE=Decimal
-00036270: 2827 3132 2e35 3030 2729 292c 205c 0a52  ('12.500')), \.R
-00036280: 6f77 284b 3d32 2c20 5045 5243 454e 5449  ow(K=2, PERCENTI
-00036290: 4c45 3d44 6563 696d 616c 2827 3137 2e35  LE=Decimal('17.5
-000362a0: 3030 2729 292c 205c 0a52 6f77 284b 3d33  00')), \.Row(K=3
-000362b0: 2c20 5045 5243 454e 5449 4c45 3d44 6563  , PERCENTILE=Dec
-000362c0: 696d 616c 2827 3630 2e30 3030 2729 292c  imal('60.000')),
-000362d0: 205c 0a52 6f77 284b 3d34 2c20 5045 5243   \.Row(K=4, PERC
-000362e0: 454e 5449 4c45 3d4e 6f6e 6529 5d0a 2020  ENTILE=None)].  
-000362f0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00036300: 2062 7569 6c74 696e 2822 7065 7263 656e   builtin("percen
-00036310: 7469 6c65 5f63 6f6e 7422 2928 7065 7263  tile_cont")(perc
-00036320: 656e 7469 6c65 290a 0a0a 6465 6620 6772  entile)...def gr
-00036330: 6561 7465 7374 282a 636f 6c75 6d6e 733a  eatest(*columns:
-00036340: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00036350: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00036360: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
-00036370: 6520 6c61 7267 6573 7420 7661 6c75 6520  e largest value 
-00036380: 6672 6f6d 2061 206c 6973 7420 6f66 2065  from a list of e
-00036390: 7870 7265 7373 696f 6e73 2e0a 2020 2020  xpressions..    
-000363a0: 4966 2061 6e79 206f 6620 7468 6520 6172  If any of the ar
-000363b0: 6775 6d65 6e74 2076 616c 7565 7320 6973  gument values is
-000363c0: 204e 554c 4c2c 2074 6865 2072 6573 756c   NULL, the resul
-000363d0: 7420 6973 204e 554c 4c2e 0a20 2020 2047  t is NULL..    G
-000363e0: 5245 4154 4553 5420 7375 7070 6f72 7473  REATEST supports
-000363f0: 2061 6c6c 2064 6174 6120 7479 7065 732c   all data types,
-00036400: 2069 6e63 6c75 6469 6e67 2056 4152 4941   including VARIA
-00036410: 4e54 2e0a 0a20 2020 2045 7861 6d70 6c65  NT...    Example
-00036420: 733a 3a0a 0a20 2020 2020 2020 203e 3e3e  s::..        >>>
-00036430: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00036440: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00036450: 5b31 2c20 322c 2033 5d2c 205b 322c 2034  [1, 2, 3], [2, 4
-00036460: 2c20 2d31 5d2c 205b 332c 2036 2c20 4e6f  , -1], [3, 6, No
-00036470: 6e65 5d5d 2c20 7363 6865 6d61 3d5b 2261  ne]], schema=["a
-00036480: 222c 2022 6222 2c20 2263 225d 290a 2020  ", "b", "c"]).  
-00036490: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000364a0: 6563 7428 6772 6561 7465 7374 2864 665b  ect(greatest(df[
-000364b0: 2261 225d 2c20 6466 5b22 6222 5d2c 2064  "a"], df["b"], d
-000364c0: 665b 2263 225d 292e 616c 6961 7328 2267  f["c"]).alias("g
-000364d0: 7265 6174 6573 7422 2929 2e63 6f6c 6c65  reatest")).colle
-000364e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-000364f0: 7728 4752 4541 5445 5354 3d33 292c 2052  w(GREATEST=3), R
-00036500: 6f77 2847 5245 4154 4553 543d 3429 2c20  ow(GREATEST=4), 
-00036510: 526f 7728 4752 4541 5445 5354 3d4e 6f6e  Row(GREATEST=Non
-00036520: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-00036530: 6320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  c = [_to_col_if_
-00036540: 7374 7228 6578 2c20 2267 7265 6174 6573  str(ex, "greates
-00036550: 7422 2920 666f 7220 6578 2069 6e20 636f  t") for ex in co
-00036560: 6c75 6d6e 735d 0a20 2020 2072 6574 7572  lumns].    retur
-00036570: 6e20 6275 696c 7469 6e28 2267 7265 6174  n builtin("great
-00036580: 6573 7422 2928 2a63 290a 0a0a 6465 6620  est")(*c)...def 
-00036590: 6c65 6173 7428 2a63 6f6c 756d 6e73 3a20  least(*columns: 
-000365a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-000365b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000365c0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
-000365d0: 2073 6d61 6c6c 6573 7420 7661 6c75 6520   smallest value 
-000365e0: 6672 6f6d 2061 206c 6973 7420 6f66 2065  from a list of e
-000365f0: 7870 7265 7373 696f 6e73 2e0a 2020 2020  xpressions..    
-00036600: 4966 2061 6e79 206f 6620 7468 6520 6172  If any of the ar
-00036610: 6775 6d65 6e74 2076 616c 7565 7320 6973  gument values is
-00036620: 204e 554c 4c2c 2074 6865 2072 6573 756c   NULL, the resul
-00036630: 7420 6973 204e 554c 4c2e 0a20 2020 204c  t is NULL..    L
-00036640: 4541 5354 2073 7570 706f 7274 7320 616c  EAST supports al
-00036650: 6c20 6461 7461 2074 7970 6573 2c20 696e  l data types, in
-00036660: 636c 7564 696e 6720 5641 5249 414e 542e  cluding VARIANT.
-00036670: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00036680: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00036690: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000366a0: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
-000366b0: 322c 2033 5d2c 205b 322c 2034 2c20 2d31  2, 3], [2, 4, -1
-000366c0: 5d2c 205b 332c 2036 2c20 4e6f 6e65 5d5d  ], [3, 6, None]]
-000366d0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-000366e0: 6222 2c20 2263 225d 290a 2020 2020 2020  b", "c"]).      
-000366f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00036700: 6c65 6173 7428 6466 5b22 6122 5d2c 2064  least(df["a"], d
-00036710: 665b 2262 225d 2c20 6466 5b22 6322 5d29  f["b"], df["c"])
-00036720: 2e61 6c69 6173 2822 6c65 6173 7422 2929  .alias("least"))
-00036730: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00036740: 2020 205b 526f 7728 4c45 4153 543d 3129     [Row(LEAST=1)
-00036750: 2c20 526f 7728 4c45 4153 543d 2d31 292c  , Row(LEAST=-1),
-00036760: 2052 6f77 284c 4541 5354 3d4e 6f6e 6529   Row(LEAST=None)
-00036770: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-00036780: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
-00036790: 7228 6578 2c20 226c 6561 7374 2229 2066  r(ex, "least") f
-000367a0: 6f72 2065 7820 696e 2063 6f6c 756d 6e73  or ex in columns
-000367b0: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
-000367c0: 6c74 696e 2822 6c65 6173 7422 2928 2a63  ltin("least")(*c
-000367d0: 290a 0a0a 6465 6620 6c69 7374 6167 6728  )...def listagg(
-000367e0: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
-000367f0: 2064 656c 696d 6974 6572 3a20 7374 7220   delimiter: str 
-00036800: 3d20 2222 2c20 6973 5f64 6973 7469 6e63  = "", is_distinc
-00036810: 743a 2062 6f6f 6c20 3d20 4661 6c73 6529  t: bool = False)
-00036820: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00036830: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00036840: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
-00036850: 2069 6e70 7574 2076 616c 7565 732c 2073   input values, s
-00036860: 6570 6172 6174 6564 2062 7920 6064 656c  eparated by `del
-00036870: 696d 6974 6572 6020 7374 7269 6e67 2e0a  imiter` string..
-00036880: 2020 2020 5365 6520 604c 4953 5441 4747      See `LISTAGG
-00036890: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-000368a0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-000368b0: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
-000368c0: 6e63 7469 6f6e 732f 6c69 7374 6167 672e  nctions/listagg.
-000368d0: 6874 6d6c 3e60 5f20 666f 7220 6465 7461  html>`_ for deta
-000368e0: 696c 732e 0a0a 2020 2020 4172 6773 3a0a  ils...    Args:.
-000368f0: 2020 2020 2020 2020 653a 2041 203a 636c          e: A :cl
-00036900: 6173 733a 6043 6f6c 756d 6e60 206f 626a  ass:`Column` obj
-00036910: 6563 7420 6f72 2063 6f6c 756d 6e20 6e61  ect or column na
-00036920: 6d65 2074 6861 7420 6465 7465 726d 696e  me that determin
-00036930: 6573 2074 6865 2076 616c 7565 730a 2020  es the values.  
-00036940: 2020 2020 2020 2020 2020 746f 2062 6520            to be 
-00036950: 7075 7420 696e 746f 2074 6865 206c 6973  put into the lis
-00036960: 742e 0a20 2020 2020 2020 2064 656c 696d  t..        delim
-00036970: 6974 6572 3a20 4120 7374 7269 6e67 2064  iter: A string d
-00036980: 656c 696d 6974 6572 2e0a 2020 2020 2020  elimiter..      
-00036990: 2020 6973 5f64 6973 7469 6e63 743a 2057    is_distinct: W
-000369a0: 6865 7468 6572 2074 6865 2069 6e70 7574  hether the input
-000369b0: 2065 7870 7265 7373 696f 6e20 6973 2064   expression is d
-000369c0: 6973 7469 6e63 742e 0a0a 2020 2020 4578  istinct...    Ex
-000369d0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
-000369e0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000369f0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00036a00: 616d 6528 5b31 2c20 322c 2033 2c20 322c  ame([1, 2, 3, 2,
-00036a10: 2034 2c20 355d 2c20 7363 6865 6d61 3d5b   4, 5], schema=[
-00036a20: 2263 6f6c 225d 290a 2020 2020 2020 2020  "col"]).        
-00036a30: 3e3e 3e20 6466 2e73 656c 6563 7428 6c69  >>> df.select(li
-00036a40: 7374 6167 6728 2263 6f6c 222c 2022 2c22  stagg("col", ","
-00036a50: 292e 7769 7468 696e 5f67 726f 7570 2864  ).within_group(d
-00036a60: 665b 2263 6f6c 225d 2e61 7363 2829 292e  f["col"].asc()).
-00036a70: 6173 5f28 2272 6573 756c 7422 2929 2e63  as_("result")).c
-00036a80: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00036a90: 205b 526f 7728 5245 5355 4c54 3d27 312c   [Row(RESULT='1,
-00036aa0: 322c 322c 332c 342c 3527 295d 0a20 2020  2,2,3,4,5')].   
-00036ab0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00036ac0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00036ad0: 6c69 7374 6167 6722 290a 2020 2020 7265  listagg").    re
-00036ae0: 7475 726e 2043 6f6c 756d 6e28 4c69 7374  turn Column(List
-00036af0: 4167 6728 632e 5f65 7870 7265 7373 696f  Agg(c._expressio
-00036b00: 6e2c 2064 656c 696d 6974 6572 2c20 6973  n, delimiter, is
-00036b10: 5f64 6973 7469 6e63 7429 290a 0a0a 6465  _distinct))...de
-00036b20: 6620 7768 656e 5f6d 6174 6368 6564 280a  f when_matched(.
-00036b30: 2020 2020 636f 6e64 6974 696f 6e3a 204f      condition: O
-00036b40: 7074 696f 6e61 6c5b 436f 6c75 6d6e 5d20  ptional[Column] 
-00036b50: 3d20 4e6f 6e65 2c0a 2920 2d3e 2022 736e  = None,.) -> "sn
-00036b60: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00036b70: 2e74 6162 6c65 2e57 6865 6e4d 6174 6368  .table.WhenMatch
-00036b80: 6564 436c 6175 7365 223a 0a20 2020 2022  edClause":.    "
-00036b90: 2222 0a20 2020 2053 7065 6369 6669 6573  "".    Specifies
-00036ba0: 2061 206d 6174 6368 6564 2063 6c61 7573   a matched claus
-00036bb0: 6520 666f 7220 7468 6520 3a6d 6574 683a  e for the :meth:
-00036bc0: 6054 6162 6c65 2e6d 6572 6765 203c 736e  `Table.merge <sn
-00036bd0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00036be0: 2e54 6162 6c65 2e6d 6572 6765 3e60 2061  .Table.merge>` a
-00036bf0: 6374 696f 6e2e 0a20 2020 2053 6565 203a  ction..    See :
-00036c00: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-00036c10: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
-00036c20: 2e57 6865 6e4d 6174 6368 6564 436c 6175  .WhenMatchedClau
-00036c30: 7365 6020 666f 7220 6465 7461 696c 732e  se` for details.
-00036c40: 0a0a 2020 2020 436f 6e76 656e 6965 6e63  ..    Convenienc
-00036c50: 6520 6675 6e63 7469 6f6e 2074 6f20 6372  e function to cr
-00036c60: 6561 7465 2061 206e 6577 2057 6865 6e4d  eate a new WhenM
-00036c70: 6174 6368 6564 436c 6175 7365 2069 6e73  atchedClause ins
-00036c80: 7461 6e63 6520 7768 6963 6820 6973 2072  tance which is r
-00036c90: 6571 7569 7265 6420 746f 6765 7468 6572  equired together
-00036ca0: 2077 6974 6820 616e 2061 6374 696f 6e20   with an action 
-00036cb0: 7768 656e 206d 6572 6769 6e67 0a20 2020  when merging.   
-00036cc0: 2061 2053 6e6f 7770 6172 6b20 7461 626c   a Snowpark tabl
-00036cd0: 6520 7769 7468 2061 2053 6e6f 7770 6172  e with a Snowpar
-00036ce0: 6b20 4461 7461 4672 616d 6520 2873 6565  k DataFrame (see
-00036cf0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00036d00: 6172 6b2e 5461 626c 652e 6d65 7267 6520  ark.Table.merge 
-00036d10: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-00036d20: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
-00036d30: 3a0a 0a20 2020 2020 2020 203e 3e3e 2074  :..        >>> t
-00036d40: 6172 6765 745f 6466 203d 2073 6573 7369  arget_df = sessi
-00036d50: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00036d60: 616d 6528 5b28 3130 2c20 226f 6c64 2229  ame([(10, "old")
-00036d70: 2c20 2831 302c 2022 746f 6f5f 6f6c 6422  , (10, "too_old"
-00036d80: 292c 2028 3131 2c20 226f 6c64 2229 5d2c  ), (11, "old")],
-00036d90: 2073 6368 656d 613d 5b22 6b65 7922 2c20   schema=["key", 
-00036da0: 2276 616c 7565 225d 290a 2020 2020 2020  "value"]).      
-00036db0: 2020 3e3e 3e20 7461 7267 6574 5f64 662e    >>> target_df.
-00036dc0: 7772 6974 652e 7361 7665 5f61 735f 7461  write.save_as_ta
-00036dd0: 626c 6528 226d 795f 7461 626c 6522 2c20  ble("my_table", 
-00036de0: 6d6f 6465 3d22 6f76 6572 7772 6974 6522  mode="overwrite"
-00036df0: 2c20 7461 626c 655f 7479 7065 3d22 7465  , table_type="te
-00036e00: 6d70 6f72 6172 7922 290a 2020 2020 2020  mporary").      
-00036e10: 2020 3e3e 3e20 7461 7267 6574 203d 2073    >>> target = s
-00036e20: 6573 7369 6f6e 2e74 6162 6c65 2822 6d79  ession.table("my
-00036e30: 5f74 6162 6c65 2229 0a20 2020 2020 2020  _table").       
-00036e40: 203e 3e3e 2073 6f75 7263 6520 3d20 7365   >>> source = se
-00036e50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00036e60: 6166 7261 6d65 285b 2831 302c 2022 6e65  aframe([(10, "ne
-00036e70: 7722 292c 2028 3132 2c20 226e 6577 2229  w"), (12, "new")
-00036e80: 2c20 2831 332c 2022 6f6c 6422 295d 2c20  , (13, "old")], 
-00036e90: 7363 6865 6d61 3d5b 226b 6579 222c 2022  schema=["key", "
-00036ea0: 7661 6c75 6522 5d29 0a20 2020 2020 2020  value"]).       
-00036eb0: 203e 3e3e 2074 6172 6765 742e 6d65 7267   >>> target.merg
-00036ec0: 6528 736f 7572 6365 2c20 2874 6172 6765  e(source, (targe
-00036ed0: 745b 226b 6579 225d 203d 3d20 736f 7572  t["key"] == sour
-00036ee0: 6365 5b22 6b65 7922 5d29 2026 2028 7461  ce["key"]) & (ta
-00036ef0: 7267 6574 5b22 7661 6c75 6522 5d20 3d3d  rget["value"] ==
-00036f00: 2022 746f 6f5f 6f6c 6422 292c 0a20 2020   "too_old"),.   
-00036f10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00036f20: 2020 2020 2020 5b77 6865 6e5f 6d61 7463        [when_matc
-00036f30: 6865 6428 292e 7570 6461 7465 287b 2276  hed().update({"v
-00036f40: 616c 7565 223a 2073 6f75 7263 655b 2276  alue": source["v
-00036f50: 616c 7565 225d 7d29 5d29 0a20 2020 2020  alue"]})]).     
-00036f60: 2020 204d 6572 6765 5265 7375 6c74 2872     MergeResult(r
-00036f70: 6f77 735f 696e 7365 7274 6564 3d30 2c20  ows_inserted=0, 
-00036f80: 726f 7773 5f75 7064 6174 6564 3d31 2c20  rows_updated=1, 
-00036f90: 726f 7773 5f64 656c 6574 6564 3d30 290a  rows_deleted=0).
-00036fa0: 2020 2020 2020 2020 3e3e 3e20 7461 7267          >>> targ
-00036fb0: 6574 2e63 6f6c 6c65 6374 2829 0a20 2020  et.collect().   
-00036fc0: 2020 2020 205b 526f 7728 4b45 593d 3130       [Row(KEY=10
-00036fd0: 2c20 5641 4c55 453d 276f 6c64 2729 2c20  , VALUE='old'), 
-00036fe0: 526f 7728 4b45 593d 3130 2c20 5641 4c55  Row(KEY=10, VALU
-00036ff0: 453d 276e 6577 2729 2c20 526f 7728 4b45  E='new'), Row(KE
-00037000: 593d 3131 2c20 5641 4c55 453d 276f 6c64  Y=11, VALUE='old
-00037010: 2729 5d0a 0a20 2020 2022 2222 0a20 2020  ')]..    """.   
-00037020: 2072 6574 7572 6e20 736e 6f77 666c 616b   return snowflak
-00037030: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
-00037040: 2e57 6865 6e4d 6174 6368 6564 436c 6175  .WhenMatchedClau
-00037050: 7365 2863 6f6e 6469 7469 6f6e 290a 0a0a  se(condition)...
-00037060: 6465 6620 7768 656e 5f6e 6f74 5f6d 6174  def when_not_mat
-00037070: 6368 6564 280a 2020 2020 636f 6e64 6974  ched(.    condit
-00037080: 696f 6e3a 204f 7074 696f 6e61 6c5b 436f  ion: Optional[Co
-00037090: 6c75 6d6e 5d20 3d20 4e6f 6e65 2c0a 2920  lumn] = None,.) 
-000370a0: 2d3e 2022 736e 6f77 666c 616b 652e 736e  -> "snowflake.sn
-000370b0: 6f77 7061 726b 2e74 6162 6c65 2e57 6865  owpark.table.Whe
-000370c0: 6e4e 6f74 4d61 7463 6865 6443 6c61 7573  nNotMatchedClaus
-000370d0: 6522 3a0a 2020 2020 2222 220a 2020 2020  e":.    """.    
-000370e0: 5370 6563 6966 6965 7320 6120 6e6f 742d  Specifies a not-
-000370f0: 6d61 7463 6865 6420 636c 6175 7365 2066  matched clause f
-00037100: 6f72 2074 6865 203a 6d65 7468 3a60 5461  or the :meth:`Ta
-00037110: 626c 652e 6d65 7267 6520 3c73 6e6f 7766  ble.merge <snowf
-00037120: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5461  lake.snowpark.Ta
-00037130: 626c 652e 6d65 7267 653e 6020 6163 7469  ble.merge>` acti
-00037140: 6f6e 2e0a 2020 2020 5365 6520 3a63 6c61  on..    See :cla
-00037150: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
-00037160: 6e6f 7770 6172 6b2e 7461 626c 652e 5768  nowpark.table.Wh
-00037170: 656e 4e6f 744d 6174 6368 6564 436c 6175  enNotMatchedClau
-00037180: 7365 6020 666f 7220 6465 7461 696c 732e  se` for details.
-00037190: 0a0a 2020 2020 436f 6e76 656e 6965 6e63  ..    Convenienc
-000371a0: 6520 6675 6e63 7469 6f6e 2074 6f20 6372  e function to cr
-000371b0: 6561 7465 2061 206e 6577 2057 6865 6e4e  eate a new WhenN
-000371c0: 6f74 4d61 7463 6865 6443 6c61 7573 6520  otMatchedClause 
-000371d0: 696e 7374 616e 6365 2077 6869 6368 2069  instance which i
-000371e0: 7320 7265 7175 6972 6564 2074 6f67 6574  s required toget
-000371f0: 6865 7220 7769 7468 2061 6e20 6163 7469  her with an acti
-00037200: 6f6e 2077 6865 6e20 6d65 7267 696e 670a  on when merging.
-00037210: 2020 2020 6120 536e 6f77 7061 726b 2074      a Snowpark t
-00037220: 6162 6c65 2077 6974 6820 6120 536e 6f77  able with a Snow
-00037230: 7061 726b 2044 6174 6146 7261 6d65 2028  park DataFrame (
-00037240: 7365 6520 736e 6f77 666c 616b 652e 736e  see snowflake.sn
-00037250: 6f77 7061 726b 2e54 6162 6c65 2e6d 6572  owpark.Table.mer
-00037260: 6765 2066 6f72 206d 6f72 6520 6465 7461  ge for more deta
-00037270: 696c 7329 2e0a 0a20 2020 2045 7861 6d70  ils)...    Examp
-00037280: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00037290: 3e20 7461 7267 6574 5f64 6620 3d20 7365  > target_df = se
-000372a0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000372b0: 6166 7261 6d65 285b 2831 302c 2022 6f6c  aframe([(10, "ol
-000372c0: 6422 292c 2028 3130 2c20 2274 6f6f 5f6f  d"), (10, "too_o
-000372d0: 6c64 2229 2c20 2831 312c 2022 6f6c 6422  ld"), (11, "old"
-000372e0: 295d 2c20 7363 6865 6d61 3d5b 226b 6579  )], schema=["key
-000372f0: 222c 2022 7661 6c75 6522 5d29 0a20 2020  ", "value"]).   
-00037300: 2020 2020 203e 3e3e 2074 6172 6765 745f       >>> target_
-00037310: 6466 2e77 7269 7465 2e73 6176 655f 6173  df.write.save_as
-00037320: 5f74 6162 6c65 2822 6d79 5f74 6162 6c65  _table("my_table
-00037330: 222c 206d 6f64 653d 226f 7665 7277 7269  ", mode="overwri
-00037340: 7465 222c 2074 6162 6c65 5f74 7970 653d  te", table_type=
-00037350: 2274 656d 706f 7261 7279 2229 0a20 2020  "temporary").   
-00037360: 2020 2020 203e 3e3e 2074 6172 6765 7420       >>> target 
-00037370: 3d20 7365 7373 696f 6e2e 7461 626c 6528  = session.table(
-00037380: 226d 795f 7461 626c 6522 290a 2020 2020  "my_table").    
-00037390: 2020 2020 3e3e 3e20 736f 7572 6365 203d      >>> source =
-000373a0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000373b0: 6461 7461 6672 616d 6528 5b28 3130 2c20  dataframe([(10, 
-000373c0: 226e 6577 2229 2c20 2831 322c 2022 6e65  "new"), (12, "ne
-000373d0: 7722 292c 2028 3133 2c20 226f 6c64 2229  w"), (13, "old")
-000373e0: 5d2c 2073 6368 656d 613d 5b22 6b65 7922  ], schema=["key"
-000373f0: 2c20 2276 616c 7565 225d 290a 2020 2020  , "value"]).    
-00037400: 2020 2020 3e3e 3e20 7461 7267 6574 2e6d      >>> target.m
-00037410: 6572 6765 2873 6f75 7263 652c 2028 7461  erge(source, (ta
-00037420: 7267 6574 5b22 6b65 7922 5d20 3d3d 2073  rget["key"] == s
-00037430: 6f75 7263 655b 226b 6579 225d 2920 2620  ource["key"]) & 
-00037440: 2874 6172 6765 745b 2276 616c 7565 225d  (target["value"]
-00037450: 203d 3d20 2274 6f6f 5f6f 6c64 2229 2c0a   == "too_old"),.
-00037460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00037470: 2020 2020 2020 2020 205b 7768 656e 5f6e           [when_n
-00037480: 6f74 5f6d 6174 6368 6564 2829 2e69 6e73  ot_matched().ins
-00037490: 6572 7428 7b22 6b65 7922 3a20 736f 7572  ert({"key": sour
-000374a0: 6365 5b22 6b65 7922 5d7d 295d 290a 2020  ce["key"]})]).  
-000374b0: 2020 2020 2020 4d65 7267 6552 6573 756c        MergeResul
-000374c0: 7428 726f 7773 5f69 6e73 6572 7465 643d  t(rows_inserted=
-000374d0: 322c 2072 6f77 735f 7570 6461 7465 643d  2, rows_updated=
-000374e0: 302c 2072 6f77 735f 6465 6c65 7465 643d  0, rows_deleted=
-000374f0: 3029 0a20 2020 2020 2020 203e 3e3e 2074  0).        >>> t
-00037500: 6172 6765 742e 736f 7274 2863 6f6c 2822  arget.sort(col("
-00037510: 6b65 7922 292c 2063 6f6c 2822 7661 6c75  key"), col("valu
-00037520: 6522 2929 2e63 6f6c 6c65 6374 2829 0a20  e")).collect(). 
-00037530: 2020 2020 2020 205b 526f 7728 4b45 593d         [Row(KEY=
-00037540: 3130 2c20 5641 4c55 453d 276f 6c64 2729  10, VALUE='old')
-00037550: 2c20 526f 7728 4b45 593d 3130 2c20 5641  , Row(KEY=10, VA
-00037560: 4c55 453d 2774 6f6f 5f6f 6c64 2729 2c20  LUE='too_old'), 
-00037570: 526f 7728 4b45 593d 3131 2c20 5641 4c55  Row(KEY=11, VALU
-00037580: 453d 276f 6c64 2729 2c20 526f 7728 4b45  E='old'), Row(KE
-00037590: 593d 3132 2c20 5641 4c55 453d 4e6f 6e65  Y=12, VALUE=None
-000375a0: 292c 2052 6f77 284b 4559 3d31 332c 2056  ), Row(KEY=13, V
-000375b0: 414c 5545 3d4e 6f6e 6529 5d0a 2020 2020  ALUE=None)].    
-000375c0: 2222 220a 2020 2020 7265 7475 726e 2073  """.    return s
-000375d0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-000375e0: 6b2e 7461 626c 652e 5768 656e 4e6f 744d  k.table.WhenNotM
-000375f0: 6174 6368 6564 436c 6175 7365 2863 6f6e  atchedClause(con
-00037600: 6469 7469 6f6e 290a 0a0a 6465 6620 7564  dition)...def ud
-00037610: 6628 0a20 2020 2066 756e 633a 204f 7074  f(.    func: Opt
-00037620: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
-00037630: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
-00037640: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
-00037650: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
-00037660: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
-00037670: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
-00037680: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
-00037690: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
-000376a0: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
-000376b0: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
-000376c0: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
-000376d0: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
-000376e0: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
-000376f0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
-00037700: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
-00037710: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00037720: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
-00037730: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
-00037740: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
-00037750: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
-00037760: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
-00037770: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
-00037780: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
-00037790: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
-000377a0: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
-000377b0: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
-000377c0: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
-000377d0: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
-000377e0: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
-000377f0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00037800: 2e73 6573 7369 6f6e 2e53 6573 7369 6f6e  .session.Session
-00037810: 225d 203d 204e 6f6e 652c 0a20 2020 2070  "] = None,.    p
-00037820: 6172 616c 6c65 6c3a 2069 6e74 203d 2034  arallel: int = 4
-00037830: 2c0a 2020 2020 6d61 785f 6261 7463 685f  ,.    max_batch_
-00037840: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b69  size: Optional[i
-00037850: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-00037860: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
-00037870: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
-00037880: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
-00037890: 652c 0a20 2020 2073 6f75 7263 655f 636f  e,.    source_co
-000378a0: 6465 5f64 6973 706c 6179 3a20 626f 6f6c  de_display: bool
-000378b0: 203d 2054 7275 652c 0a20 2020 2073 7472   = True,.    str
-000378c0: 6963 743a 2062 6f6f 6c20 3d20 4661 6c73  ict: bool = Fals
-000378d0: 652c 0a20 2020 2073 6563 7572 653a 2062  e,.    secure: b
-000378e0: 6f6f 6c20 3d20 4661 6c73 652c 0a29 202d  ool = False,.) -
-000378f0: 3e20 556e 696f 6e5b 5573 6572 4465 6669  > Union[UserDefi
-00037900: 6e65 6446 756e 6374 696f 6e2c 2066 756e  nedFunction, fun
-00037910: 6374 6f6f 6c73 2e70 6172 7469 616c 5d3a  ctools.partial]:
-00037920: 0a20 2020 2022 2222 5265 6769 7374 6572  .    """Register
-00037930: 7320 6120 5079 7468 6f6e 2066 756e 6374  s a Python funct
-00037940: 696f 6e20 6173 2061 2053 6e6f 7766 6c61  ion as a Snowfla
-00037950: 6b65 2050 7974 686f 6e20 5544 4620 616e  ke Python UDF an
-00037960: 6420 7265 7475 726e 7320 7468 6520 5544  d returns the UD
-00037970: 462e 0a0a 2020 2020 4974 2063 616e 2062  F...    It can b
-00037980: 6520 7573 6564 2061 7320 6569 7468 6572  e used as either
-00037990: 2061 2066 756e 6374 696f 6e20 6361 6c6c   a function call
-000379a0: 206f 7220 6120 6465 636f 7261 746f 722e   or a decorator.
-000379b0: 2049 6e20 6d6f 7374 2063 6173 6573 2079   In most cases y
-000379c0: 6f75 2077 6f72 6b20 7769 7468 2061 2073  ou work with a s
-000379d0: 696e 676c 6520 7365 7373 696f 6e2e 0a20  ingle session.. 
-000379e0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-000379f0: 2075 7365 7320 7468 6174 2073 6573 7369   uses that sessi
-00037a00: 6f6e 2074 6f20 7265 6769 7374 6572 2074  on to register t
-00037a10: 6865 2055 4446 2e20 4966 2079 6f75 2068  he UDF. If you h
-00037a20: 6176 6520 6d75 6c74 6970 6c65 2073 6573  ave multiple ses
-00037a30: 7369 6f6e 732c 2079 6f75 206e 6565 6420  sions, you need 
-00037a40: 746f 0a20 2020 2065 7870 6c69 6369 746c  to.    explicitl
-00037a50: 7920 7370 6563 6966 7920 7468 6520 6060  y specify the ``
-00037a60: 7365 7373 696f 6e60 6020 7061 7261 6d65  session`` parame
-00037a70: 7465 7220 6f66 2074 6869 7320 6675 6e63  ter of this func
-00037a80: 7469 6f6e 2e20 4966 2079 6f75 2068 6176  tion. If you hav
-00037a90: 6520 6120 6675 6e63 7469 6f6e 2061 6e64  e a function and
-00037aa0: 2077 6f75 6c64 0a20 2020 206c 696b 6520   would.    like 
-00037ab0: 746f 2072 6567 6973 7465 7220 6974 2074  to register it t
-00037ac0: 6f20 6d75 6c74 6970 6c65 2064 6174 6162  o multiple datab
-00037ad0: 6173 6573 2c20 7573 6520 6060 7365 7373  ases, use ``sess
-00037ae0: 696f 6e2e 7564 662e 7265 6769 7374 6572  ion.udf.register
-00037af0: 6060 2069 6e73 7465 6164 2e20 5365 6520  `` instead. See 
-00037b00: 6578 616d 706c 6573 0a20 2020 2069 6e20  examples.    in 
-00037b10: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
-00037b20: 6b65 2e73 6e6f 7770 6172 6b2e 7564 662e  ke.snowpark.udf.
-00037b30: 5544 4652 6567 6973 7472 6174 696f 6e60  UDFRegistration`
-00037b40: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00037b50: 2020 2020 2066 756e 633a 2041 2050 7974       func: A Pyt
-00037b60: 686f 6e20 6675 6e63 7469 6f6e 2075 7365  hon function use
-00037b70: 6420 666f 7220 6372 6561 7469 6e67 2074  d for creating t
-00037b80: 6865 2055 4446 2e0a 2020 2020 2020 2020  he UDF..        
-00037b90: 7265 7475 726e 5f74 7970 653a 2041 203a  return_type: A :
-00037ba0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-00037bb0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00037bc0: 2e44 6174 6154 7970 6560 2072 6570 7265  .DataType` repre
-00037bd0: 7365 6e74 696e 6720 7468 6520 7265 7475  senting the retu
-00037be0: 726e 2064 6174 610a 2020 2020 2020 2020  rn data.        
-00037bf0: 2020 2020 7479 7065 206f 6620 7468 6520      type of the 
-00037c00: 5544 462e 204f 7074 696f 6e61 6c20 6966  UDF. Optional if
-00037c10: 2074 7970 6520 6869 6e74 7320 6172 6520   type hints are 
-00037c20: 7072 6f76 6964 6564 2e0a 2020 2020 2020  provided..      
-00037c30: 2020 696e 7075 745f 7479 7065 733a 2041    input_types: A
-00037c40: 206c 6973 7420 6f66 203a 636c 6173 733a   list of :class:
-00037c50: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-00037c60: 7061 726b 2e74 7970 6573 2e44 6174 6154  park.types.DataT
-00037c70: 7970 6560 0a20 2020 2020 2020 2020 2020  ype`.           
-00037c80: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00037c90: 6520 696e 7075 7420 6461 7461 2074 7970  e input data typ
-00037ca0: 6573 206f 6620 7468 6520 5544 462e 204f  es of the UDF. O
-00037cb0: 7074 696f 6e61 6c20 6966 0a20 2020 2020  ptional if.     
-00037cc0: 2020 2020 2020 2074 7970 6520 6869 6e74         type hint
-00037cd0: 7320 6172 6520 7072 6f76 6964 6564 2e0a  s are provided..
-00037ce0: 2020 2020 2020 2020 6e61 6d65 3a20 4120          name: A 
-00037cf0: 7374 7269 6e67 206f 7220 6c69 7374 206f  string or list o
-00037d00: 6620 7374 7269 6e67 7320 7468 6174 2073  f strings that s
-00037d10: 7065 6369 6679 2074 6865 206e 616d 6520  pecify the name 
-00037d20: 6f72 2066 756c 6c79 2d71 7561 6c69 6669  or fully-qualifi
-00037d30: 6564 0a20 2020 2020 2020 2020 2020 206f  ed.            o
-00037d40: 626a 6563 7420 6964 656e 7469 6669 6572  bject identifier
-00037d50: 2028 6461 7461 6261 7365 206e 616d 652c   (database name,
-00037d60: 2073 6368 656d 6120 6e61 6d65 2c20 616e   schema name, an
-00037d70: 6420 6675 6e63 7469 6f6e 206e 616d 6529  d function name)
-00037d80: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-00037d90: 2074 6865 2055 4446 2069 6e20 536e 6f77   the UDF in Snow
-00037da0: 666c 616b 652c 2077 6869 6368 2061 6c6c  flake, which all
-00037db0: 6f77 7320 796f 7520 746f 2063 616c 6c20  ows you to call 
-00037dc0: 7468 6973 2055 4446 2069 6e20 6120 5351  this UDF in a SQ
-00037dd0: 4c0a 2020 2020 2020 2020 2020 2020 636f  L.            co
-00037de0: 6d6d 616e 6420 6f72 2076 6961 203a 6675  mmand or via :fu
-00037df0: 6e63 3a60 6361 6c6c 5f75 6466 2829 602e  nc:`call_udf()`.
-00037e00: 2049 6620 6974 2069 7320 6e6f 7420 7072   If it is not pr
-00037e10: 6f76 6964 6564 2c20 6120 6e61 6d65 2077  ovided, a name w
-00037e20: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
-00037e30: 6265 2061 7574 6f6d 6174 6963 616c 6c79  be automatically
-00037e40: 2067 656e 6572 6174 6564 2066 6f72 2074   generated for t
-00037e50: 6865 2055 4446 2e20 4120 6e61 6d65 206d  he UDF. A name m
-00037e60: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
-00037e70: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
-00037e80: 2020 6060 6973 5f70 6572 6d61 6e65 6e74    ``is_permanent
-00037e90: 6060 2069 7320 6060 5472 7565 6060 2e0a  `` is ``True``..
-00037ea0: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
-00037eb0: 6e65 6e74 3a20 5768 6574 6865 7220 746f  nent: Whether to
-00037ec0: 2063 7265 6174 6520 6120 7065 726d 616e   create a perman
-00037ed0: 656e 7420 5544 462e 2054 6865 2064 6566  ent UDF. The def
-00037ee0: 6175 6c74 2069 7320 6060 4661 6c73 6560  ault is ``False`
-00037ef0: 602e 0a20 2020 2020 2020 2020 2020 2049  `..            I
-00037f00: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
-00037f10: 2c20 6120 7661 6c69 6420 6060 7374 6167  , a valid ``stag
-00037f20: 655f 6c6f 6361 7469 6f6e 6060 206d 7573  e_location`` mus
-00037f30: 7420 6265 2070 726f 7669 6465 642e 0a20  t be provided.. 
-00037f40: 2020 2020 2020 2073 7461 6765 5f6c 6f63         stage_loc
-00037f50: 6174 696f 6e3a 2054 6865 2073 7461 6765  ation: The stage
-00037f60: 206c 6f63 6174 696f 6e20 7768 6572 6520   location where 
-00037f70: 7468 6520 5079 7468 6f6e 2066 696c 6520  the Python file 
-00037f80: 666f 7220 7468 6520 5544 460a 2020 2020  for the UDF.    
-00037f90: 2020 2020 2020 2020 616e 6420 6974 7320          and its 
-00037fa0: 6465 7065 6e64 656e 6369 6573 2073 686f  dependencies sho
-00037fb0: 756c 6420 6265 2075 706c 6f61 6465 642e  uld be uploaded.
-00037fc0: 2054 6865 2073 7461 6765 206c 6f63 6174   The stage locat
-00037fd0: 696f 6e20 6d75 7374 2062 6520 7370 6563  ion must be spec
-00037fe0: 6966 6965 640a 2020 2020 2020 2020 2020  ified.          
-00037ff0: 2020 7768 656e 2060 6069 735f 7065 726d    when ``is_perm
-00038000: 616e 656e 7460 6020 6973 2060 6054 7275  anent`` is ``Tru
-00038010: 6560 602c 2061 6e64 2069 7420 7769 6c6c  e``, and it will
-00038020: 2062 6520 6967 6e6f 7265 6420 7768 656e   be ignored when
-00038030: 0a20 2020 2020 2020 2020 2020 2060 6069  .            ``i
-00038040: 735f 7065 726d 616e 656e 7460 6020 6973  s_permanent`` is
-00038050: 2060 6046 616c 7365 6060 2e20 4974 2063   ``False``. It c
-00038060: 616e 2062 6520 616e 7920 7374 6167 6520  an be any stage 
-00038070: 6f74 6865 7220 7468 616e 2074 656d 706f  other than tempo
-00038080: 7261 7279 0a20 2020 2020 2020 2020 2020  rary.           
-00038090: 2073 7461 6765 7320 616e 6420 6578 7465   stages and exte
-000380a0: 726e 616c 2073 7461 6765 732e 0a20 2020  rnal stages..   
-000380b0: 2020 2020 2069 6d70 6f72 7473 3a20 4120       imports: A 
-000380c0: 6c69 7374 206f 6620 696d 706f 7274 7320  list of imports 
-000380d0: 7468 6174 206f 6e6c 7920 6170 706c 7920  that only apply 
-000380e0: 746f 2074 6869 7320 5544 462e 2059 6f75  to this UDF. You
-000380f0: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
-00038100: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
-00038110: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
-00038120: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
-00038130: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
-00038140: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
-00038150: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
-00038160: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00038170: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
-00038180: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
-00038190: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
-000381a0: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
-000381b0: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
-000381c0: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
-000381d0: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
-000381e0: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
-000381f0: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
-00038200: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
-00038210: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
-00038220: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
-00038230: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
-00038240: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
-00038250: 2054 6865 7365 2055 4446 2d6c 6576 656c   These UDF-level
-00038260: 2069 6d70 6f72 7473 0a20 2020 2020 2020   imports.       
-00038270: 2020 2020 2077 696c 6c20 6f76 6572 7269       will overri
-00038280: 6465 2074 6865 2073 6573 7369 6f6e 2d6c  de the session-l
-00038290: 6576 656c 2069 6d70 6f72 7473 2061 6464  evel imports add
-000382a0: 6564 2062 790a 2020 2020 2020 2020 2020  ed by.          
-000382b0: 2020 3a6d 6574 683a 607e 736e 6f77 666c    :meth:`~snowfl
-000382c0: 616b 652e 736e 6f77 7061 726b 2e53 6573  ake.snowpark.Ses
-000382d0: 7369 6f6e 2e61 6464 5f69 6d70 6f72 7460  sion.add_import`
-000382e0: 2e20 4e6f 7465 2074 6861 7420 616e 2065  . Note that an e
-000382f0: 6d70 7479 206c 6973 7420 6d65 616e 730a  mpty list means.
-00038300: 2020 2020 2020 2020 2020 2020 6e6f 2069              no i
-00038310: 6d70 6f72 7420 666f 7220 7468 6973 2055  mport for this U
-00038320: 4446 2c20 616e 6420 6060 4e6f 6e65 6060  DF, and ``None``
-00038330: 206f 7220 6e6f 7420 7370 6563 6966 7969   or not specifyi
-00038340: 6e67 2074 6869 7320 7061 7261 6d65 7465  ng this paramete
-00038350: 7220 6d65 616e 7320 7573 696e 670a 2020  r means using.  
-00038360: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
-00038370: 6e2d 6c65 7665 6c20 696d 706f 7274 732e  n-level imports.
-00038380: 0a20 2020 2020 2020 2070 6163 6b61 6765  .        package
-00038390: 733a 2041 206c 6973 7420 6f66 2070 6163  s: A list of pac
-000383a0: 6b61 6765 7320 7468 6174 206f 6e6c 7920  kages that only 
-000383b0: 6170 706c 7920 746f 2074 6869 7320 5544  apply to this UD
-000383c0: 462e 2054 6865 7365 2055 4446 2d6c 6576  F. These UDF-lev
-000383d0: 656c 2070 6163 6b61 6765 730a 2020 2020  el packages.    
-000383e0: 2020 2020 2020 2020 7769 6c6c 206f 7665          will ove
-000383f0: 7272 6964 6520 7468 6520 7365 7373 696f  rride the sessio
-00038400: 6e2d 6c65 7665 6c20 7061 636b 6167 6573  n-level packages
-00038410: 2061 6464 6564 2062 790a 2020 2020 2020   added by.      
-00038420: 2020 2020 2020 3a6d 6574 683a 607e 736e        :meth:`~sn
-00038430: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00038440: 2e53 6573 7369 6f6e 2e61 6464 5f70 6163  .Session.add_pac
-00038450: 6b61 6765 7360 2061 6e64 0a20 2020 2020  kages` and.     
-00038460: 2020 2020 2020 203a 6d65 7468 3a60 7e73         :meth:`~s
-00038470: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00038480: 6b2e 5365 7373 696f 6e2e 6164 645f 7265  k.Session.add_re
-00038490: 7175 6972 656d 656e 7473 602e 204e 6f74  quirements`. Not
-000384a0: 6520 7468 6174 2061 6e20 656d 7074 7920  e that an empty 
-000384b0: 6c69 7374 206d 6561 6e73 0a20 2020 2020  list means.     
-000384c0: 2020 2020 2020 206e 6f20 7061 636b 6167         no packag
-000384d0: 6520 666f 7220 7468 6973 2055 4446 2c20  e for this UDF, 
-000384e0: 616e 6420 6060 4e6f 6e65 6060 206f 7220  and ``None`` or 
-000384f0: 6e6f 7420 7370 6563 6966 7969 6e67 2074  not specifying t
-00038500: 6869 7320 7061 7261 6d65 7465 7220 6d65  his parameter me
-00038510: 616e 7320 7573 696e 670a 2020 2020 2020  ans using.      
-00038520: 2020 2020 2020 7365 7373 696f 6e2d 6c65        session-le
-00038530: 7665 6c20 7061 636b 6167 6573 2e0a 2020  vel packages..  
-00038540: 2020 2020 2020 7265 706c 6163 653a 2057        replace: W
-00038550: 6865 7468 6572 2074 6f20 7265 706c 6163  hether to replac
-00038560: 6520 6120 5544 4620 7468 6174 2061 6c72  e a UDF that alr
-00038570: 6561 6479 2077 6173 2072 6567 6973 7465  eady was registe
-00038580: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
-00038590: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
-000385a0: 2020 2020 2020 2020 2020 2049 6620 6974             If it
-000385b0: 2069 7320 6060 4661 6c73 6560 602c 2061   is ``False``, a
-000385c0: 7474 656d 7074 696e 6720 746f 2072 6567  ttempting to reg
-000385d0: 6973 7465 7220 6120 5544 4620 7769 7468  ister a UDF with
-000385e0: 2061 206e 616d 6520 7468 6174 2061 6c72   a name that alr
-000385f0: 6561 6479 2065 7869 7374 730a 2020 2020  eady exists.    
-00038600: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
-00038610: 696e 2061 2060 6053 6e6f 7770 6172 6b53  in a ``SnowparkS
-00038620: 514c 4578 6365 7074 696f 6e60 6020 6578  QLException`` ex
-00038630: 6365 7074 696f 6e20 6265 696e 6720 7468  ception being th
-00038640: 726f 776e 2e20 4966 2069 7420 6973 2060  rown. If it is `
-00038650: 6054 7275 6560 602c 0a20 2020 2020 2020  `True``,.       
-00038660: 2020 2020 2061 6e20 6578 6973 7469 6e67       an existing
-00038670: 2055 4446 2077 6974 6820 7468 6520 7361   UDF with the sa
-00038680: 6d65 206e 616d 6520 6973 206f 7665 7277  me name is overw
-00038690: 7269 7474 656e 2e0a 2020 2020 2020 2020  ritten..        
-000386a0: 6966 5f6e 6f74 5f65 7869 7374 733a 2057  if_not_exists: W
-000386b0: 6865 7468 6572 2074 6f20 736b 6970 2063  hether to skip c
-000386c0: 7265 6174 696f 6e20 6f66 2061 2055 4446  reation of a UDF
-000386d0: 2077 6865 6e20 6f6e 6520 7769 7468 2074   when one with t
-000386e0: 6865 2073 616d 6520 7369 676e 6174 7572  he same signatur
-000386f0: 6520 616c 7265 6164 7920 6578 6973 7473  e already exists
-00038700: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00038710: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
-00038720: 616c 7365 6060 2e20 6060 6966 5f6e 6f74  alse``. ``if_not
-00038730: 5f65 7869 7374 7360 6020 616e 6420 6060  _exists`` and ``
-00038740: 7265 706c 6163 6560 6020 6172 6520 6d75  replace`` are mu
-00038750: 7475 616c 6c79 2065 7863 6c75 7369 7665  tually exclusive
-00038760: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00038770: 2061 2060 6056 616c 7565 4572 726f 7260   a ``ValueError`
-00038780: 6020 6973 2072 6169 7365 6420 7768 656e  ` is raised when
-00038790: 2062 6f74 6820 6172 6520 7365 742e 2049   both are set. I
-000387a0: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
-000387b0: 2061 6e64 2061 2055 4446 2077 6974 680a   and a UDF with.
-000387c0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-000387d0: 7361 6d65 2073 6967 6e61 7475 7265 2065  same signature e
-000387e0: 7869 7374 732c 2074 6865 2055 4446 2063  xists, the UDF c
-000387f0: 7265 6174 696f 6e20 6973 2073 6b69 7070  reation is skipp
-00038800: 6564 2e0a 2020 2020 2020 2020 7365 7373  ed..        sess
-00038810: 696f 6e3a 2055 7365 2074 6869 7320 7365  ion: Use this se
-00038820: 7373 696f 6e20 746f 2072 6567 6973 7465  ssion to registe
-00038830: 7220 7468 6520 5544 462e 2049 6620 6974  r the UDF. If it
-00038840: 2773 206e 6f74 2073 7065 6369 6669 6564  's not specified
-00038850: 2c20 7468 6520 7365 7373 696f 6e20 7468  , the session th
-00038860: 6174 2079 6f75 2063 7265 6174 6564 2062  at you created b
-00038870: 6566 6f72 6520 6361 6c6c 696e 6720 7468  efore calling th
-00038880: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
-00038890: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
-000388a0: 2020 2020 2020 596f 7520 6e65 6564 2074        You need t
-000388b0: 6f20 7370 6563 6966 7920 7468 6973 2070  o specify this p
-000388c0: 6172 616d 6574 6572 2069 6620 796f 7520  arameter if you 
-000388d0: 6861 7665 2063 7265 6174 6564 206d 756c  have created mul
-000388e0: 7469 706c 6520 7365 7373 696f 6e73 2062  tiple sessions b
-000388f0: 6566 6f72 6520 6361 6c6c 696e 6720 7468  efore calling th
-00038900: 6973 206d 6574 686f 642e 0a20 2020 2020  is method..     
-00038910: 2020 2070 6172 616c 6c65 6c3a 2054 6865     parallel: The
-00038920: 206e 756d 6265 7220 6f66 2074 6872 6561   number of threa
-00038930: 6473 2074 6f20 7573 6520 666f 7220 7570  ds to use for up
-00038940: 6c6f 6164 696e 6720 5544 4620 6669 6c65  loading UDF file
-00038950: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
-00038960: 2020 2020 2020 2060 5055 5420 3c68 7474         `PUT <htt
-00038970: 7073 3a2f 2f64 6f63 732e 736e 6f77 666c  ps://docs.snowfl
-00038980: 616b 652e 636f 6d2f 656e 2f73 716c 2d72  ake.com/en/sql-r
-00038990: 6566 6572 656e 6365 2f73 716c 2f70 7574  eference/sql/put
-000389a0: 2e68 746d 6c23 7075 743e 605f 0a20 2020  .html#put>`_.   
-000389b0: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
-000389c0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
-000389d0: 6c75 6520 6973 2034 2061 6e64 2073 7570  lue is 4 and sup
-000389e0: 706f 7274 6564 2076 616c 7565 7320 6172  ported values ar
-000389f0: 6520 6672 6f6d 2031 2074 6f20 3939 2e0a  e from 1 to 99..
-00038a00: 2020 2020 2020 2020 2020 2020 496e 6372              Incr
-00038a10: 6561 7369 6e67 2074 6865 206e 756d 6265  easing the numbe
-00038a20: 7220 6f66 2074 6872 6561 6473 2063 616e  r of threads can
-00038a30: 2069 6d70 726f 7665 2070 6572 666f 726d   improve perform
-00038a40: 616e 6365 2077 6865 6e20 7570 6c6f 6164  ance when upload
-00038a50: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00038a60: 6c61 7267 6520 5544 4620 6669 6c65 732e  large UDF files.
-00038a70: 0a20 2020 2020 2020 206d 6178 5f62 6174  .        max_bat
-00038a80: 6368 5f73 697a 653a 2054 6865 206d 6178  ch_size: The max
-00038a90: 696d 756d 206e 756d 6265 7220 6f66 2072  imum number of r
-00038aa0: 6f77 7320 7065 7220 696e 7075 7420 5061  ows per input Pa
-00038ab0: 6e64 6173 2044 6174 6146 7261 6d65 206f  ndas DataFrame o
-00038ac0: 7220 5061 6e64 6173 2053 6572 6965 730a  r Pandas Series.
-00038ad0: 2020 2020 2020 2020 2020 2020 696e 7369              insi
-00038ae0: 6465 2061 2076 6563 746f 7269 7a65 6420  de a vectorized 
-00038af0: 5544 462e 2042 6563 6175 7365 2061 2076  UDF. Because a v
-00038b00: 6563 746f 7269 7a65 6420 5544 4620 7769  ectorized UDF wi
-00038b10: 6c6c 2062 6520 6578 6563 7574 6564 2077  ll be executed w
-00038b20: 6974 6869 6e20 6120 7469 6d65 206c 696d  ithin a time lim
-00038b30: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
-00038b40: 7768 6963 6820 6973 2060 3630 6020 7365  which is `60` se
-00038b50: 636f 6e64 732c 2074 6869 7320 6f70 7469  conds, this opti
-00038b60: 6f6e 616c 2061 7267 756d 656e 7420 6361  onal argument ca
-00038b70: 6e20 6265 2075 7365 6420 746f 2072 6564  n be used to red
-00038b80: 7563 6520 7468 6520 7275 6e6e 696e 6720  uce the running 
-00038b90: 7469 6d65 206f 660a 2020 2020 2020 2020  time of.        
-00038ba0: 2020 2020 6576 6572 7920 6261 7463 6820      every batch 
-00038bb0: 6279 2073 6574 7469 6e67 2061 2073 6d61  by setting a sma
-00038bc0: 6c6c 6572 2062 6174 6368 2073 697a 652e  ller batch size.
-00038bd0: 204e 6f74 6520 7468 6174 2073 6574 7469   Note that setti
-00038be0: 6e67 2061 206c 6172 6765 7220 7661 6c75  ng a larger valu
-00038bf0: 6520 646f 6573 206e 6f74 0a20 2020 2020  e does not.     
-00038c00: 2020 2020 2020 2067 7561 7261 6e74 6565         guarantee
-00038c10: 2074 6861 7420 536e 6f77 666c 616b 6520   that Snowflake 
-00038c20: 7769 6c6c 2065 6e63 6f64 6520 6261 7463  will encode batc
-00038c30: 6865 7320 7769 7468 2074 6865 2073 7065  hes with the spe
-00038c40: 6369 6669 6564 206e 756d 6265 7220 6f66  cified number of
-00038c50: 2072 6f77 732e 2049 7420 7769 6c6c 0a20   rows. It will. 
-00038c60: 2020 2020 2020 2020 2020 2062 6520 6967             be ig
-00038c70: 6e6f 7265 6420 7768 656e 2072 6567 6973  nored when regis
-00038c80: 7465 7269 6e67 2061 206e 6f6e 2d76 6563  tering a non-vec
-00038c90: 746f 7269 7a65 6420 5544 462e 0a20 2020  torized UDF..   
-00038ca0: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
-00038cb0: 6172 616d 733a 2044 6963 7469 6f6e 6172  arams: Dictionar
-00038cc0: 7920 6f66 2073 7461 7465 6d65 6e74 206c  y of statement l
-00038cd0: 6576 656c 2070 6172 616d 6574 6572 7320  evel parameters 
-00038ce0: 746f 2062 6520 7365 7420 7768 696c 6520  to be set while 
-00038cf0: 6578 6563 7574 696e 6720 7468 6973 2061  executing this a
-00038d00: 6374 696f 6e2e 0a20 2020 2020 2020 2073  ction..        s
-00038d10: 6f75 7263 655f 636f 6465 5f64 6973 706c  ource_code_displ
-00038d20: 6179 3a20 4469 7370 6c61 7920 7468 6520  ay: Display the 
-00038d30: 736f 7572 6365 2063 6f64 6520 6f66 2074  source code of t
-00038d40: 6865 2055 4446 2060 6675 6e63 6020 6173  he UDF `func` as
-00038d50: 2063 6f6d 6d65 6e74 7320 696e 2074 6865   comments in the
-00038d60: 2067 656e 6572 6174 6564 2073 6372 6970   generated scrip
-00038d70: 742e 0a20 2020 2020 2020 2020 2020 2054  t..            T
-00038d80: 6865 2073 6f75 7263 6520 636f 6465 2069  he source code i
-00038d90: 7320 6479 6e61 6d69 6361 6c6c 7920 6765  s dynamically ge
-00038da0: 6e65 7261 7465 6420 7468 6572 6566 6f72  nerated therefor
-00038db0: 6520 6974 206d 6179 206e 6f74 2062 6520  e it may not be 
-00038dc0: 6964 656e 7469 6361 6c20 746f 2068 6f77  identical to how
-00038dd0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00038de0: 2060 6675 6e63 6020 6973 206f 7269 6769   `func` is origi
-00038df0: 6e61 6c6c 7920 6465 6669 6e65 642e 2054  nally defined. T
-00038e00: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
-00038e10: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
-00038e20: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
-00038e30: 616c 7365 6060 2c20 736f 7572 6365 2063  alse``, source c
-00038e40: 6f64 6520 7769 6c6c 206e 6f74 2062 6520  ode will not be 
-00038e50: 6765 6e65 7261 7465 6420 6f72 2064 6973  generated or dis
-00038e60: 706c 6179 6564 2e0a 2020 2020 2020 2020  played..        
-00038e70: 7374 7269 6374 3a20 5768 6574 6865 7220  strict: Whether 
-00038e80: 7468 6520 6372 6561 7465 6420 5544 4620  the created UDF 
-00038e90: 6973 2073 7472 6963 742e 2041 2073 7472  is strict. A str
-00038ea0: 6963 7420 5544 4620 7769 6c6c 206e 6f74  ict UDF will not
-00038eb0: 2069 6e76 6f6b 6520 7468 6520 5544 4620   invoke the UDF 
-00038ec0: 6966 2061 6e79 2069 6e70 7574 2069 730a  if any input is.
-00038ed0: 2020 2020 2020 2020 2020 2020 6e75 6c6c              null
-00038ee0: 2e20 496e 7374 6561 642c 2061 206e 756c  . Instead, a nul
-00038ef0: 6c20 7661 6c75 6520 7769 6c6c 2061 6c77  l value will alw
-00038f00: 6179 7320 6265 2072 6574 7572 6e65 6420  ays be returned 
-00038f10: 666f 7220 7468 6174 2072 6f77 2e20 4e6f  for that row. No
-00038f20: 7465 2074 6861 7420 7468 6520 5544 4620  te that the UDF 
-00038f30: 6d69 6768 740a 2020 2020 2020 2020 2020  might.          
-00038f40: 2020 7374 696c 6c20 7265 7475 726e 206e    still return n
-00038f50: 756c 6c20 666f 7220 6e6f 6e2d 6e75 6c6c  ull for non-null
-00038f60: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
-00038f70: 2073 6563 7572 653a 2057 6865 7468 6572   secure: Whether
-00038f80: 2074 6865 2063 7265 6174 6564 2055 4446   the created UDF
-00038f90: 2069 7320 7365 6375 7265 2e20 466f 7220   is secure. For 
-00038fa0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-00038fb0: 2061 626f 7574 2073 6563 7572 6520 6675   about secure fu
-00038fc0: 6e63 7469 6f6e 732c 0a20 2020 2020 2020  nctions,.       
-00038fd0: 2020 2020 2073 6565 2060 5365 6375 7265       see `Secure
-00038fe0: 2055 4446 7320 3c68 7474 7073 3a2f 2f64   UDFs <https://d
-00038ff0: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
-00039000: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
-00039010: 6365 2f75 6466 2d73 6563 7572 652e 6874  ce/udf-secure.ht
-00039020: 6d6c 3e60 5f2e 0a0a 2020 2020 5265 7475  ml>`_...    Retu
-00039030: 726e 733a 0a20 2020 2020 2020 2041 2055  rns:.        A U
-00039040: 4446 2066 756e 6374 696f 6e20 7468 6174  DF function that
-00039050: 2063 616e 2062 6520 6361 6c6c 6564 2077   can be called w
-00039060: 6974 6820 3a63 6c61 7373 3a60 7e73 6e6f  ith :class:`~sno
-00039070: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00039080: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
-00039090: 6f6e 732e 0a0a 2020 2020 4e6f 7465 3a0a  ons...    Note:.
-000390a0: 2020 2020 2020 2020 312e 2057 6865 6e20          1. When 
-000390b0: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
-000390c0: 726f 7669 6465 6420 616e 6420 6172 6520  rovided and are 
-000390d0: 636f 6d70 6c65 7465 2066 6f72 2061 2066  complete for a f
-000390e0: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
-000390f0: 2060 6072 6574 7572 6e5f 7479 7065 6060   ``return_type``
-00039100: 2061 6e64 2060 6069 6e70 7574 5f74 7970   and ``input_typ
-00039110: 6573 6060 2061 7265 206f 7074 696f 6e61  es`` are optiona
-00039120: 6c20 616e 6420 7769 6c6c 2062 6520 6967  l and will be ig
-00039130: 6e6f 7265 642e 0a20 2020 2020 2020 2053  nored..        S
-00039140: 6565 2064 6574 6169 6c73 206f 6620 7375  ee details of su
-00039150: 7070 6f72 7465 6420 6461 7461 2074 7970  pported data typ
-00039160: 6573 2066 6f72 2055 4446 7320 696e 0a20  es for UDFs in. 
-00039170: 2020 2020 2020 203a 636c 6173 733a 607e         :class:`~
-00039180: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00039190: 726b 2e75 6466 2e55 4446 5265 6769 7374  rk.udf.UDFRegist
-000391a0: 7261 7469 6f6e 602e 0a0a 2020 2020 2020  ration`...      
-000391b0: 2020 2020 2020 2d20 596f 7520 6361 6e20        - You can 
-000391c0: 7573 6520 7573 6520 3a61 7474 723a 607e  use use :attr:`~
-000391d0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-000391e0: 726b 2e74 7970 6573 2e56 6172 6961 6e74  rk.types.Variant
-000391f0: 6020 746f 0a20 2020 2020 2020 2020 2020  ` to.           
-00039200: 2020 2061 6e6e 6f74 6174 6520 6120 7661     annotate a va
-00039210: 7269 616e 742c 2061 6e64 2075 7365 203a  riant, and use :
-00039220: 6174 7472 3a60 7e73 6e6f 7766 6c61 6b65  attr:`~snowflake
-00039230: 2e73 6e6f 7770 6172 6b2e 7479 7065 732e  .snowpark.types.
-00039240: 4765 6f67 7261 7068 7960 0a20 2020 2020  Geography`.     
-00039250: 2020 2020 2020 2020 2074 6f20 616e 6e6f           to anno
-00039260: 7461 7465 2061 2067 656f 6772 6170 6879  tate a geography
-00039270: 2077 6865 6e20 6465 6669 6e69 6e67 2061   when defining a
-00039280: 2055 4446 2e0a 0a20 2020 2020 2020 2020   UDF...         
-00039290: 2020 202d 2059 6f75 2063 616e 2075 7365     - You can use
-000392a0: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
-000392b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000392c0: 7479 7065 732e 5061 6e64 6173 5365 7269  types.PandasSeri
-000392d0: 6573 6020 746f 2061 6e6e 6f74 6174 650a  es` to annotate.
-000392e0: 2020 2020 2020 2020 2020 2020 2020 6120                a 
-000392f0: 5061 6e64 6173 2053 6572 6965 732c 2061  Pandas Series, a
-00039300: 6e64 2075 7365 203a 6174 7472 3a60 7e73  nd use :attr:`~s
-00039310: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00039320: 6b2e 7479 7065 732e 5061 6e64 6173 4461  k.types.PandasDa
-00039330: 7461 4672 616d 6560 0a20 2020 2020 2020  taFrame`.       
-00039340: 2020 2020 2020 2074 6f20 616e 6e6f 7461         to annota
-00039350: 7465 2061 2050 616e 6461 7320 4461 7461  te a Pandas Data
-00039360: 4672 616d 6520 7768 656e 2064 6566 696e  Frame when defin
-00039370: 696e 6720 6120 7665 6374 6f72 697a 6564  ing a vectorized
-00039380: 2055 4446 2e0a 2020 2020 2020 2020 2020   UDF..          
-00039390: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-000393a0: 6579 2061 7265 2067 656e 6572 6963 2074  ey are generic t
-000393b0: 7970 6573 2073 6f20 796f 7520 6361 6e20  ypes so you can 
-000393c0: 7370 6563 6966 7920 7468 6520 656c 656d  specify the elem
-000393d0: 656e 7420 7479 7065 2069 6e20 610a 2020  ent type in a.  
-000393e0: 2020 2020 2020 2020 2020 2020 5061 6e64              Pand
-000393f0: 6173 2053 6572 6965 7320 616e 6420 4461  as Series and Da
-00039400: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
-00039410: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
-00039420: 7479 7069 6e67 2e55 6e69 6f6e 6020 6973  typing.Union` is
-00039430: 206e 6f74 2061 2076 616c 6964 2074 7970   not a valid typ
-00039440: 6520 616e 6e6f 7461 7469 6f6e 2066 6f72  e annotation for
-00039450: 2055 4446 732c 0a20 2020 2020 2020 2020   UDFs,.         
-00039460: 2020 2020 2062 7574 203a 636c 6173 733a       but :class:
-00039470: 6074 7970 696e 672e 4f70 7469 6f6e 616c  `typing.Optional
-00039480: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
-00039490: 2069 6e64 6963 6174 6520 7468 6520 6f70   indicate the op
-000394a0: 7469 6f6e 616c 2074 7970 652e 0a0a 2020  tional type...  
-000394b0: 2020 2020 2020 2020 2020 2d20 5479 7065            - Type
-000394c0: 2068 696e 7473 2061 7265 206e 6f74 2073   hints are not s
-000394d0: 7570 706f 7274 6564 206f 6e20 6675 6e63  upported on func
-000394e0: 7469 6f6e 7320 6465 636f 7261 7465 6420  tions decorated 
-000394f0: 7769 7468 2064 6563 6f72 6174 6f72 732e  with decorators.
-00039500: 0a0a 2020 2020 2020 2020 322e 2041 2074  ..        2. A t
-00039510: 656d 706f 7261 7279 2055 4446 2028 7768  emporary UDF (wh
-00039520: 656e 2060 6069 735f 7065 726d 616e 656e  en ``is_permanen
-00039530: 7460 6020 6973 2060 6046 616c 7365 6060  t`` is ``False``
-00039540: 2920 6973 2073 636f 7065 6420 746f 2074  ) is scoped to t
-00039550: 6869 7320 6060 7365 7373 696f 6e60 600a  his ``session``.
-00039560: 2020 2020 2020 2020 616e 6420 616c 6c20          and all 
-00039570: 5544 4620 7265 6c61 7465 6420 6669 6c65  UDF related file
-00039580: 7320 7769 6c6c 2062 6520 7570 6c6f 6164  s will be upload
-00039590: 6564 2074 6f20 6120 7465 6d70 6f72 6172  ed to a temporar
-000395a0: 7920 7365 7373 696f 6e20 7374 6167 650a  y session stage.
-000395b0: 2020 2020 2020 2020 283a 6675 6e63 3a60          (:func:`
-000395c0: 7365 7373 696f 6e2e 6765 745f 7365 7373  session.get_sess
-000395d0: 696f 6e5f 7374 6167 6528 2920 3c73 6e6f  ion_stage() <sno
-000395e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000395f0: 5365 7373 696f 6e2e 6765 745f 7365 7373  Session.get_sess
-00039600: 696f 6e5f 7374 6167 653e 6029 2e0a 2020  ion_stage>`)..  
-00039610: 2020 2020 2020 466f 7220 6120 7065 726d        For a perm
-00039620: 616e 656e 7420 5544 462c 2074 6865 7365  anent UDF, these
-00039630: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
-00039640: 706c 6f61 6465 6420 746f 2074 6865 2073  ploaded to the s
-00039650: 7461 6765 2074 6861 7420 796f 7520 7072  tage that you pr
-00039660: 6f76 6964 652e 0a0a 2020 2020 2020 2020  ovide...        
-00039670: 332e 2042 7920 6465 6661 756c 742c 2055  3. By default, U
-00039680: 4446 2072 6567 6973 7472 6174 696f 6e20  DF registration 
-00039690: 6661 696c 7320 6966 2061 2066 756e 6374  fails if a funct
-000396a0: 696f 6e20 7769 7468 2074 6865 2073 616d  ion with the sam
-000396b0: 6520 6e61 6d65 2069 7320 616c 7265 6164  e name is alread
-000396c0: 790a 2020 2020 2020 2020 7265 6769 7374  y.        regist
-000396d0: 6572 6564 2e20 496e 766f 6b69 6e67 203a  ered. Invoking :
-000396e0: 6675 6e63 3a60 7564 6660 2077 6974 6820  func:`udf` with 
-000396f0: 6060 7265 706c 6163 6560 6020 7365 7420  ``replace`` set 
-00039700: 746f 2060 6054 7275 6560 6020 7769 6c6c  to ``True`` will
-00039710: 206f 7665 7277 7269 7465 2074 6865 0a20   overwrite the. 
-00039720: 2020 2020 2020 2070 7265 7669 6f75 736c         previousl
-00039730: 7920 7265 6769 7374 6572 6564 2066 756e  y registered fun
-00039740: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
-00039750: 342e 2057 6865 6e20 7265 6769 7374 6572  4. When register
-00039760: 696e 6720 6120 7665 6374 6f72 697a 6564  ing a vectorized
-00039770: 2055 4446 2c20 6060 7061 6e64 6173 6060   UDF, ``pandas``
-00039780: 206c 6962 7261 7279 2077 696c 6c20 6265   library will be
-00039790: 2061 6464 6564 2061 7320 6120 7061 636b   added as a pack
-000397a0: 6167 650a 2020 2020 2020 2020 6175 746f  age.        auto
-000397b0: 6d61 7469 6361 6c6c 792c 2077 6974 6820  matically, with 
-000397c0: 7468 6520 6c61 7465 7374 2076 6572 7369  the latest versi
-000397d0: 6f6e 206f 6e20 7468 6520 536e 6f77 666c  on on the Snowfl
-000397e0: 616b 6520 7365 7276 6572 2e20 4966 2079  ake server. If y
-000397f0: 6f75 2064 6f6e 2774 2077 616e 7420 746f  ou don't want to
-00039800: 0a20 2020 2020 2020 2075 7365 2074 6869  .        use thi
-00039810: 7320 7665 7273 696f 6e2c 2079 6f75 2063  s version, you c
-00039820: 616e 206f 7665 7277 7269 7465 2069 7420  an overwrite it 
-00039830: 6279 2061 6464 696e 6720 6070 616e 6461  by adding `panda
-00039840: 7360 2077 6974 6820 7370 6563 6966 6963  s` with specific
-00039850: 2076 6572 7369 6f6e 0a20 2020 2020 2020   version.       
-00039860: 2072 6571 7569 7265 6d65 6e74 2075 7369   requirement usi
-00039870: 6e67 2060 6070 6163 6b61 6765 6060 2061  ng ``package`` a
-00039880: 7267 756d 656e 7420 6f72 203a 6d65 7468  rgument or :meth
-00039890: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-000398a0: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
-000398b0: 645f 7061 636b 6167 6573 602e 0a0a 2020  d_packages`...  
-000398c0: 2020 5365 6520 416c 736f 3a0a 2020 2020    See Also:.    
-000398d0: 2020 2020 3a63 6c61 7373 3a60 7e73 6e6f      :class:`~sno
-000398e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000398f0: 7564 662e 5544 4652 6567 6973 7472 6174  udf.UDFRegistrat
-00039900: 696f 6e60 0a0a 2020 2020 5544 4673 2063  ion`..    UDFs c
-00039910: 616e 2062 6520 6372 6561 7465 6420 6173  an be created as
-00039920: 2061 6e6f 6e79 6d6f 7573 2055 4446 730a   anonymous UDFs.
-00039930: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00039940: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00039950: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00039960: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-00039970: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
-00039980: 2020 2020 203e 3e3e 2061 6464 5f6f 6e65       >>> add_one
-00039990: 203d 2075 6466 286c 616d 6264 6120 783a   = udf(lambda x:
-000399a0: 2078 2b31 2c20 7265 7475 726e 5f74 7970   x+1, return_typ
-000399b0: 653d 496e 7465 6765 7254 7970 6528 292c  e=IntegerType(),
-000399c0: 2069 6e70 7574 5f74 7970 6573 3d5b 496e   input_types=[In
-000399d0: 7465 6765 7254 7970 6528 295d 290a 2020  tegerType()]).  
-000399e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000399f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00039a00: 7461 6672 616d 6528 5b31 2c20 322c 2033  taframe([1, 2, 3
-00039a10: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00039a20: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00039a30: 7365 6c65 6374 2861 6464 5f6f 6e65 2863  select(add_one(c
-00039a40: 6f6c 2822 6122 2929 2e61 735f 2822 616e  ol("a")).as_("an
-00039a50: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
-00039a60: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-00039a70: 3229 2c20 526f 7728 414e 533d 3329 2c20  2), Row(ANS=3), 
-00039a80: 526f 7728 414e 533d 3429 5d0a 0a20 2020  Row(ANS=4)]..   
-00039a90: 206f 7220 6173 206e 616d 6564 2055 4446   or as named UDF
-00039aa0: 7320 7468 6174 2061 7265 2061 6363 6573  s that are acces
-00039ab0: 7369 626c 6520 696e 2074 6865 2073 616d  sible in the sam
-00039ac0: 6520 7365 7373 696f 6e2e 2049 6e73 7465  e session. Inste
-00039ad0: 6164 206f 6620 6361 6c6c 696e 6720 6075  ad of calling `u
-00039ae0: 6466 6020 6173 2066 756e 6374 696f 6e2c  df` as function,
-00039af0: 2069 7420 6361 6e20 6265 2061 6c73 6f20   it can be also 
-00039b00: 7573 6564 0a20 2020 2061 7320 6120 6465  used.    as a de
-00039b10: 636f 7261 746f 723a 0a0a 2020 2020 4578  corator:..    Ex
-00039b20: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00039b30: 203e 3e3e 2040 7564 6628 6e61 6d65 3d22   >>> @udf(name="
-00039b40: 6d69 6e75 735f 6f6e 6522 2c20 7265 706c  minus_one", repl
-00039b50: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
-00039b60: 2020 2e2e 2e20 6465 6620 6d69 6e75 735f    ... def minus_
-00039b70: 6f6e 6528 783a 2069 6e74 2920 2d3e 2069  one(x: int) -> i
-00039b80: 6e74 3a0a 2020 2020 2020 2020 2e2e 2e20  nt:.        ... 
-00039b90: 2020 2020 7265 7475 726e 2078 202d 2031      return x - 1
-00039ba0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00039bb0: 7365 6c65 6374 286d 696e 7573 5f6f 6e65  select(minus_one
-00039bc0: 2863 6f6c 2822 6122 2929 2e61 735f 2822  (col("a")).as_("
-00039bd0: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
-00039be0: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-00039bf0: 533d 3029 2c20 526f 7728 414e 533d 3129  S=0), Row(ANS=1)
-00039c00: 2c20 526f 7728 414e 533d 3229 5d0a 2020  , Row(ANS=2)].  
-00039c10: 2020 2020 2020 3e3e 3e20 7365 7373 696f        >>> sessio
-00039c20: 6e2e 7371 6c28 2253 454c 4543 5420 6d69  n.sql("SELECT mi
-00039c30: 6e75 735f 6f6e 6528 3130 2922 292e 636f  nus_one(10)").co
-00039c40: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00039c50: 5b52 6f77 284d 494e 5553 5f4f 4e45 2831  [Row(MINUS_ONE(1
-00039c60: 3029 3d39 295d 0a0a 2020 2020 2222 220a  0)=9)]..    """.
-00039c70: 2020 2020 7365 7373 696f 6e20 3d20 7365      session = se
-00039c80: 7373 696f 6e20 6f72 2073 6e6f 7766 6c61  ssion or snowfla
-00039c90: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
-00039ca0: 696f 6e2e 5f67 6574 5f61 6374 6976 655f  ion._get_active_
-00039cb0: 7365 7373 696f 6e28 290a 2020 2020 6966  session().    if
-00039cc0: 2066 756e 6320 6973 204e 6f6e 653a 0a20   func is None:. 
-00039cd0: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
-00039ce0: 6e63 746f 6f6c 732e 7061 7274 6961 6c28  nctools.partial(
-00039cf0: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
-00039d00: 7369 6f6e 2e75 6466 2e72 6567 6973 7465  sion.udf.registe
-00039d10: 722c 0a20 2020 2020 2020 2020 2020 2072  r,.            r
-00039d20: 6574 7572 6e5f 7479 7065 3d72 6574 7572  eturn_type=retur
-00039d30: 6e5f 7479 7065 2c0a 2020 2020 2020 2020  n_type,.        
-00039d40: 2020 2020 696e 7075 745f 7479 7065 733d      input_types=
-00039d50: 696e 7075 745f 7479 7065 732c 0a20 2020  input_types,.   
-00039d60: 2020 2020 2020 2020 206e 616d 653d 6e61           name=na
-00039d70: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00039d80: 6973 5f70 6572 6d61 6e65 6e74 3d69 735f  is_permanent=is_
-00039d90: 7065 726d 616e 656e 742c 0a20 2020 2020  permanent,.     
-00039da0: 2020 2020 2020 2073 7461 6765 5f6c 6f63         stage_loc
-00039db0: 6174 696f 6e3d 7374 6167 655f 6c6f 6361  ation=stage_loca
-00039dc0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00039dd0: 2020 696d 706f 7274 733d 696d 706f 7274    imports=import
-00039de0: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-00039df0: 6163 6b61 6765 733d 7061 636b 6167 6573  ackages=packages
-00039e00: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-00039e10: 706c 6163 653d 7265 706c 6163 652c 0a20  place=replace,. 
-00039e20: 2020 2020 2020 2020 2020 2069 665f 6e6f             if_no
-00039e30: 745f 6578 6973 7473 3d69 665f 6e6f 745f  t_exists=if_not_
-00039e40: 6578 6973 7473 2c0a 2020 2020 2020 2020  exists,.        
-00039e50: 2020 2020 7061 7261 6c6c 656c 3d70 6172      parallel=par
-00039e60: 616c 6c65 6c2c 0a20 2020 2020 2020 2020  allel,.         
-00039e70: 2020 206d 6178 5f62 6174 6368 5f73 697a     max_batch_siz
-00039e80: 653d 6d61 785f 6261 7463 685f 7369 7a65  e=max_batch_size
-00039e90: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00039ea0: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
-00039eb0: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
-00039ec0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00039ed0: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
-00039ee0: 3d73 6f75 7263 655f 636f 6465 5f64 6973  =source_code_dis
-00039ef0: 706c 6179 2c0a 2020 2020 2020 2020 2020  play,.          
-00039f00: 2020 7374 7269 6374 3d73 7472 6963 742c    strict=strict,
-00039f10: 0a20 2020 2020 2020 2020 2020 2073 6563  .            sec
-00039f20: 7572 653d 7365 6375 7265 2c0a 2020 2020  ure=secure,.    
-00039f30: 2020 2020 290a 2020 2020 656c 7365 3a0a      ).    else:.
-00039f40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00039f50: 6573 7369 6f6e 2e75 6466 2e72 6567 6973  ession.udf.regis
-00039f60: 7465 7228 0a20 2020 2020 2020 2020 2020  ter(.           
-00039f70: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
-00039f80: 2020 2072 6574 7572 6e5f 7479 7065 3d72     return_type=r
-00039f90: 6574 7572 6e5f 7479 7065 2c0a 2020 2020  eturn_type,.    
-00039fa0: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
-00039fb0: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
-00039fc0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00039fd0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
-00039fe0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
-00039ff0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
-0003a000: 2020 2020 2020 2020 2020 2073 7461 6765             stage
-0003a010: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
-0003a020: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
-0003a030: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
-0003a040: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
-0003a050: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
-0003a060: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
-0003a070: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
-0003a080: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-0003a090: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
-0003a0a0: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
-0003a0b0: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
-0003a0c0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
-0003a0d0: 2020 2020 2020 206d 6178 5f62 6174 6368         max_batch
-0003a0e0: 5f73 697a 653d 6d61 785f 6261 7463 685f  _size=max_batch_
-0003a0f0: 7369 7a65 2c0a 2020 2020 2020 2020 2020  size,.          
-0003a100: 2020 7374 6174 656d 656e 745f 7061 7261    statement_para
-0003a110: 6d73 3d73 7461 7465 6d65 6e74 5f70 6172  ms=statement_par
-0003a120: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-0003a130: 2073 6f75 7263 655f 636f 6465 5f64 6973   source_code_dis
-0003a140: 706c 6179 3d73 6f75 7263 655f 636f 6465  play=source_code
-0003a150: 5f64 6973 706c 6179 2c0a 2020 2020 2020  _display,.      
-0003a160: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
-0003a170: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-0003a180: 2073 6563 7572 653d 7365 6375 7265 2c0a   secure=secure,.
-0003a190: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
-0003a1a0: 7564 7466 280a 2020 2020 6861 6e64 6c65  udtf(.    handle
-0003a1b0: 723a 204f 7074 696f 6e61 6c5b 4361 6c6c  r: Optional[Call
-0003a1c0: 6162 6c65 5d20 3d20 4e6f 6e65 2c0a 2020  able] = None,.  
-0003a1d0: 2020 2a2c 0a20 2020 206f 7574 7075 745f    *,.    output_
-0003a1e0: 7363 6865 6d61 3a20 556e 696f 6e5b 5374  schema: Union[St
-0003a1f0: 7275 6374 5479 7065 2c20 4c69 7374 5b73  ructType, List[s
-0003a200: 7472 5d5d 2c0a 2020 2020 696e 7075 745f  tr]],.    input_
-0003a210: 7479 7065 733a 204f 7074 696f 6e61 6c5b  types: Optional[
-0003a220: 4c69 7374 5b44 6174 6154 7970 655d 5d20  List[DataType]] 
-0003a230: 3d20 4e6f 6e65 2c0a 2020 2020 6e61 6d65  = None,.    name
-0003a240: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
-0003a250: 5b73 7472 2c20 4974 6572 6162 6c65 5b73  [str, Iterable[s
-0003a260: 7472 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  tr]]] = None,.  
-0003a270: 2020 6973 5f70 6572 6d61 6e65 6e74 3a20    is_permanent: 
-0003a280: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0003a290: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
-0003a2a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0003a2b0: 3d20 4e6f 6e65 2c0a 2020 2020 696d 706f  = None,.    impo
-0003a2c0: 7274 733a 204f 7074 696f 6e61 6c5b 4c69  rts: Optional[Li
-0003a2d0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 5475  st[Union[str, Tu
-0003a2e0: 706c 655b 7374 722c 2073 7472 5d5d 5d5d  ple[str, str]]]]
-0003a2f0: 203d 204e 6f6e 652c 0a20 2020 2070 6163   = None,.    pac
-0003a300: 6b61 6765 733a 204f 7074 696f 6e61 6c5b  kages: Optional[
-0003a310: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
-0003a320: 4d6f 6475 6c65 5479 7065 5d5d 5d20 3d20  ModuleType]]] = 
-0003a330: 4e6f 6e65 2c0a 2020 2020 7265 706c 6163  None,.    replac
-0003a340: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-0003a350: 0a20 2020 2069 665f 6e6f 745f 6578 6973  .    if_not_exis
-0003a360: 7473 3a20 626f 6f6c 203d 2046 616c 7365  ts: bool = False
-0003a370: 2c0a 2020 2020 7365 7373 696f 6e3a 204f  ,.    session: O
-0003a380: 7074 696f 6e61 6c5b 2273 6e6f 7766 6c61  ptional["snowfla
-0003a390: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
-0003a3a0: 696f 6e2e 5365 7373 696f 6e22 5d20 3d20  ion.Session"] = 
-0003a3b0: 4e6f 6e65 2c0a 2020 2020 7061 7261 6c6c  None,.    parall
-0003a3c0: 656c 3a20 696e 7420 3d20 342c 0a20 2020  el: int = 4,.   
-0003a3d0: 2073 7461 7465 6d65 6e74 5f70 6172 616d   statement_param
-0003a3e0: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
-0003a3f0: 5b73 7472 2c20 7374 725d 5d20 3d20 4e6f  [str, str]] = No
-0003a400: 6e65 2c0a 2020 2020 7374 7269 6374 3a20  ne,.    strict: 
-0003a410: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0003a420: 2020 7365 6375 7265 3a20 626f 6f6c 203d    secure: bool =
-0003a430: 2046 616c 7365 2c0a 2920 2d3e 2055 6e69   False,.) -> Uni
-0003a440: 6f6e 5b55 7365 7244 6566 696e 6564 5461  on[UserDefinedTa
-0003a450: 626c 6546 756e 6374 696f 6e2c 2066 756e  bleFunction, fun
-0003a460: 6374 6f6f 6c73 2e70 6172 7469 616c 5d3a  ctools.partial]:
-0003a470: 0a20 2020 2022 2222 5265 6769 7374 6572  .    """Register
-0003a480: 7320 6120 5079 7468 6f6e 2063 6c61 7373  s a Python class
-0003a490: 2061 7320 6120 536e 6f77 666c 616b 6520   as a Snowflake 
-0003a4a0: 5079 7468 6f6e 2055 4454 4620 616e 6420  Python UDTF and 
-0003a4b0: 7265 7475 726e 7320 7468 6520 5544 5446  returns the UDTF
-0003a4c0: 2e0a 0a20 2020 2049 7420 6361 6e20 6265  ...    It can be
-0003a4d0: 2075 7365 6420 6173 2065 6974 6865 7220   used as either 
-0003a4e0: 6120 6675 6e63 7469 6f6e 2063 616c 6c20  a function call 
-0003a4f0: 6f72 2061 2064 6563 6f72 6174 6f72 2e20  or a decorator. 
-0003a500: 496e 206d 6f73 7420 6361 7365 7320 796f  In most cases yo
-0003a510: 7520 776f 726b 2077 6974 6820 6120 7369  u work with a si
-0003a520: 6e67 6c65 2073 6573 7369 6f6e 2e0a 2020  ngle session..  
-0003a530: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-0003a540: 7573 6573 2074 6861 7420 7365 7373 696f  uses that sessio
-0003a550: 6e20 746f 2072 6567 6973 7465 7220 7468  n to register th
-0003a560: 6520 5544 5446 2e20 4966 2079 6f75 2068  e UDTF. If you h
-0003a570: 6176 6520 6d75 6c74 6970 6c65 2073 6573  ave multiple ses
-0003a580: 7369 6f6e 732c 2079 6f75 206e 6565 6420  sions, you need 
-0003a590: 746f 0a20 2020 2065 7870 6c69 6369 746c  to.    explicitl
-0003a5a0: 7920 7370 6563 6966 7920 7468 6520 6060  y specify the ``
-0003a5b0: 7365 7373 696f 6e60 6020 7061 7261 6d65  session`` parame
-0003a5c0: 7465 7220 6f66 2074 6869 7320 6675 6e63  ter of this func
-0003a5d0: 7469 6f6e 2e20 4966 2079 6f75 2068 6176  tion. If you hav
-0003a5e0: 6520 6120 6675 6e63 7469 6f6e 2061 6e64  e a function and
-0003a5f0: 2077 6f75 6c64 0a20 2020 206c 696b 6520   would.    like 
-0003a600: 746f 2072 6567 6973 7465 7220 6974 2074  to register it t
-0003a610: 6f20 6d75 6c74 6970 6c65 2064 6174 6162  o multiple datab
-0003a620: 6173 6573 2c20 7573 6520 6060 7365 7373  ases, use ``sess
-0003a630: 696f 6e2e 7564 7466 2e72 6567 6973 7465  ion.udtf.registe
-0003a640: 7260 6020 696e 7374 6561 642e 2053 6565  r`` instead. See
-0003a650: 2065 7861 6d70 6c65 730a 2020 2020 696e   examples.    in
-0003a660: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-0003a670: 616b 652e 736e 6f77 7061 726b 2e75 6474  ake.snowpark.udt
-0003a680: 662e 5544 5446 5265 6769 7374 7261 7469  f.UDTFRegistrati
-0003a690: 6f6e 602e 0a0a 2020 2020 4172 6773 3a0a  on`...    Args:.
-0003a6a0: 2020 2020 2020 2020 6861 6e64 6c65 723a          handler:
-0003a6b0: 2041 2050 7974 686f 6e20 636c 6173 7320   A Python class 
-0003a6c0: 7573 6564 2066 6f72 2063 7265 6174 696e  used for creatin
-0003a6d0: 6720 7468 6520 5544 5446 2e0a 2020 2020  g the UDTF..    
-0003a6e0: 2020 2020 6f75 7470 7574 5f73 6368 656d      output_schem
-0003a6f0: 613a 2041 206c 6973 7420 6f66 2063 6f6c  a: A list of col
-0003a700: 756d 6e20 6e61 6d65 732c 206f 7220 6120  umn names, or a 
-0003a710: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
-0003a720: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-0003a730: 732e 5374 7275 6374 5479 7065 6020 696e  s.StructType` in
-0003a740: 7374 616e 6365 2074 6861 7420 7265 7072  stance that repr
-0003a750: 6573 656e 7473 2074 6865 2074 6162 6c65  esents the table
-0003a760: 2066 756e 6374 696f 6e27 7320 636f 6c75   function's colu
-0003a770: 6d6e 732e 0a20 2020 2020 2020 2020 4966  mns..         If
-0003a780: 2061 206c 6973 7420 6f66 2063 6f6c 756d   a list of colum
-0003a790: 6e20 6e61 6d65 7320 6973 2070 726f 7669  n names is provi
-0003a7a0: 6465 642c 2074 6865 2060 6070 726f 6365  ded, the ``proce
-0003a7b0: 7373 6060 206d 6574 686f 6420 6f66 2074  ss`` method of t
-0003a7c0: 6865 2068 616e 646c 6572 2063 6c61 7373  he handler class
-0003a7d0: 206d 7573 7420 6861 7665 2072 6574 7572   must have retur
-0003a7e0: 6e20 7479 7065 2068 696e 7473 2074 6f20  n type hints to 
-0003a7f0: 696e 6469 6361 7465 2074 6865 206f 7574  indicate the out
-0003a800: 7075 7420 7363 6865 6d61 2064 6174 6120  put schema data 
-0003a810: 7479 7065 732e 0a20 2020 2020 2020 2069  types..        i
-0003a820: 6e70 7574 5f74 7970 6573 3a20 4120 6c69  nput_types: A li
-0003a830: 7374 206f 6620 3a63 6c61 7373 3a60 7e73  st of :class:`~s
-0003a840: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0003a850: 6b2e 7479 7065 732e 4461 7461 5479 7065  k.types.DataType
-0003a860: 600a 2020 2020 2020 2020 2020 2020 7265  `.            re
-0003a870: 7072 6573 656e 7469 6e67 2074 6865 2069  presenting the i
-0003a880: 6e70 7574 2064 6174 6120 7479 7065 7320  nput data types 
-0003a890: 6f66 2074 6865 2055 4454 462e 204f 7074  of the UDTF. Opt
-0003a8a0: 696f 6e61 6c20 6966 0a20 2020 2020 2020  ional if.       
-0003a8b0: 2020 2020 2074 7970 6520 6869 6e74 7320       type hints 
-0003a8c0: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
-0003a8d0: 2020 2020 2020 6e61 6d65 3a20 4120 7374        name: A st
-0003a8e0: 7269 6e67 206f 7220 6c69 7374 206f 6620  ring or list of 
-0003a8f0: 7374 7269 6e67 7320 7468 6174 2073 7065  strings that spe
-0003a900: 6369 6679 2074 6865 206e 616d 6520 6f72  cify the name or
-0003a910: 2066 756c 6c79 2d71 7561 6c69 6669 6564   fully-qualified
-0003a920: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-0003a930: 6563 7420 6964 656e 7469 6669 6572 2028  ect identifier (
-0003a940: 6461 7461 6261 7365 206e 616d 652c 2073  database name, s
-0003a950: 6368 656d 6120 6e61 6d65 2c20 616e 6420  chema name, and 
-0003a960: 6675 6e63 7469 6f6e 206e 616d 6529 2066  function name) f
-0003a970: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
-0003a980: 6865 2055 4454 4620 696e 2053 6e6f 7766  he UDTF in Snowf
-0003a990: 6c61 6b65 2c20 7768 6963 6820 616c 6c6f  lake, which allo
-0003a9a0: 7773 2079 6f75 2074 6f20 6361 6c6c 2074  ws you to call t
-0003a9b0: 6869 7320 5544 5446 2069 6e20 6120 5351  his UDTF in a SQ
-0003a9c0: 4c0a 2020 2020 2020 2020 2020 2020 636f  L.            co
-0003a9d0: 6d6d 616e 6420 6f72 2076 6961 203a 6675  mmand or via :fu
-0003a9e0: 6e63 3a60 6361 6c6c 5f75 6474 6628 2960  nc:`call_udtf()`
-0003a9f0: 2e20 4966 2069 7420 6973 206e 6f74 2070  . If it is not p
-0003aa00: 726f 7669 6465 642c 2061 206e 616d 6520  rovided, a name 
-0003aa10: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-0003aa20: 2062 6520 6175 746f 6d61 7469 6361 6c6c   be automaticall
-0003aa30: 7920 6765 6e65 7261 7465 6420 666f 7220  y generated for 
-0003aa40: 7468 6520 5544 5446 2e20 4120 6e61 6d65  the UDTF. A name
-0003aa50: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-0003aa60: 6564 2077 6865 6e0a 2020 2020 2020 2020  ed when.        
-0003aa70: 2020 2020 6060 6973 5f70 6572 6d61 6e65      ``is_permane
-0003aa80: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
-0003aa90: 2e0a 2020 2020 2020 2020 6973 5f70 6572  ..        is_per
-0003aaa0: 6d61 6e65 6e74 3a20 5768 6574 6865 7220  manent: Whether 
-0003aab0: 746f 2063 7265 6174 6520 6120 7065 726d  to create a perm
-0003aac0: 616e 656e 7420 5544 5446 2e20 5468 6520  anent UDTF. The 
-0003aad0: 6465 6661 756c 7420 6973 2060 6046 616c  default is ``Fal
-0003aae0: 7365 6060 2e0a 2020 2020 2020 2020 2020  se``..          
-0003aaf0: 2020 4966 2069 7420 6973 2060 6054 7275    If it is ``Tru
-0003ab00: 6560 602c 2061 2076 616c 6964 2060 6073  e``, a valid ``s
-0003ab10: 7461 6765 5f6c 6f63 6174 696f 6e60 6020  tage_location`` 
-0003ab20: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-0003ab30: 2e0a 2020 2020 2020 2020 7374 6167 655f  ..        stage_
-0003ab40: 6c6f 6361 7469 6f6e 3a20 5468 6520 7374  location: The st
-0003ab50: 6167 6520 6c6f 6361 7469 6f6e 2077 6865  age location whe
-0003ab60: 7265 2074 6865 2050 7974 686f 6e20 6669  re the Python fi
-0003ab70: 6c65 2066 6f72 2074 6865 2055 4454 460a  le for the UDTF.
-0003ab80: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0003ab90: 6974 7320 6465 7065 6e64 656e 6369 6573  its dependencies
-0003aba0: 2073 686f 756c 6420 6265 2075 706c 6f61   should be uploa
-0003abb0: 6465 642e 2054 6865 2073 7461 6765 206c  ded. The stage l
-0003abc0: 6f63 6174 696f 6e20 6d75 7374 2062 6520  ocation must be 
-0003abd0: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
-0003abe0: 2020 2020 2020 7768 656e 2060 6069 735f        when ``is_
-0003abf0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
-0003ac00: 6054 7275 6560 602c 2061 6e64 2069 7420  `True``, and it 
-0003ac10: 7769 6c6c 2062 6520 6967 6e6f 7265 6420  will be ignored 
-0003ac20: 7768 656e 0a20 2020 2020 2020 2020 2020  when.           
-0003ac30: 2060 6069 735f 7065 726d 616e 656e 7460   ``is_permanent`
-0003ac40: 6020 6973 2060 6046 616c 7365 6060 2e20  ` is ``False``. 
-0003ac50: 4974 2063 616e 2062 6520 616e 7920 7374  It can be any st
-0003ac60: 6167 6520 6f74 6865 7220 7468 616e 2074  age other than t
-0003ac70: 656d 706f 7261 7279 0a20 2020 2020 2020  emporary.       
-0003ac80: 2020 2020 2073 7461 6765 7320 616e 6420       stages and 
-0003ac90: 6578 7465 726e 616c 2073 7461 6765 732e  external stages.
-0003aca0: 0a20 2020 2020 2020 2069 6d70 6f72 7473  .        imports
-0003acb0: 3a20 4120 6c69 7374 206f 6620 696d 706f  : A list of impo
-0003acc0: 7274 7320 7468 6174 206f 6e6c 7920 6170  rts that only ap
-0003acd0: 706c 7920 746f 2074 6869 7320 5544 5446  ply to this UDTF
-0003ace0: 2e20 596f 7520 6361 6e20 7573 6520 6120  . You can use a 
-0003acf0: 7374 7269 6e67 2074 6f0a 2020 2020 2020  string to.      
-0003ad00: 2020 2020 2020 7265 7072 6573 656e 7420        represent 
-0003ad10: 6120 6669 6c65 2070 6174 6820 2873 696d  a file path (sim
-0003ad20: 696c 6172 2074 6f20 7468 6520 6060 7061  ilar to the ``pa
-0003ad30: 7468 6060 2061 7267 756d 656e 7420 696e  th`` argument in
-0003ad40: 0a20 2020 2020 2020 2020 2020 203a 6d65  .            :me
-0003ad50: 7468 3a60 7e73 6e6f 7766 6c61 6b65 2e73  th:`~snowflake.s
-0003ad60: 6e6f 7770 6172 6b2e 5365 7373 696f 6e2e  nowpark.Session.
-0003ad70: 6164 645f 696d 706f 7274 6029 2069 6e20  add_import`) in 
-0003ad80: 7468 6973 206c 6973 742c 206f 7220 6120  this list, or a 
-0003ad90: 7475 706c 6520 6f66 2074 776f 0a20 2020  tuple of two.   
-0003ada0: 2020 2020 2020 2020 2073 7472 696e 6773           strings
-0003adb0: 2074 6f20 7265 7072 6573 656e 7420 6120   to represent a 
-0003adc0: 6669 6c65 2070 6174 6820 616e 6420 616e  file path and an
-0003add0: 2069 6d70 6f72 7420 7061 7468 2028 7369   import path (si
-0003ade0: 6d69 6c61 7220 746f 2074 6865 2060 6069  milar to the ``i
-0003adf0: 6d70 6f72 745f 7061 7468 6060 0a20 2020  mport_path``.   
-0003ae00: 2020 2020 2020 2020 2061 7267 756d 656e           argumen
-0003ae10: 7420 696e 203a 6d65 7468 3a60 7e73 6e6f  t in :meth:`~sno
-0003ae20: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003ae30: 5365 7373 696f 6e2e 6164 645f 696d 706f  Session.add_impo
-0003ae40: 7274 6029 2e20 5468 6573 6520 5544 5446  rt`). These UDTF
-0003ae50: 2d6c 6576 656c 2069 6d70 6f72 7473 0a20  -level imports. 
-0003ae60: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-0003ae70: 6f76 6572 7269 6465 2074 6865 2073 6573  override the ses
-0003ae80: 7369 6f6e 2d6c 6576 656c 2069 6d70 6f72  sion-level impor
-0003ae90: 7473 2061 6464 6564 2062 790a 2020 2020  ts added by.    
-0003aea0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
-0003aeb0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0003aec0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
-0003aed0: 6d70 6f72 7460 2e0a 2020 2020 2020 2020  mport`..        
-0003aee0: 7061 636b 6167 6573 3a20 4120 6c69 7374  packages: A list
-0003aef0: 206f 6620 7061 636b 6167 6573 2074 6861   of packages tha
-0003af00: 7420 6f6e 6c79 2061 7070 6c79 2074 6f20  t only apply to 
-0003af10: 7468 6973 2055 4454 462e 2054 6865 7365  this UDTF. These
-0003af20: 2055 4454 462d 6c65 7665 6c20 7061 636b   UDTF-level pack
-0003af30: 6167 6573 0a20 2020 2020 2020 2020 2020  ages.           
-0003af40: 2077 696c 6c20 6f76 6572 7269 6465 2074   will override t
-0003af50: 6865 2073 6573 7369 6f6e 2d6c 6576 656c  he session-level
-0003af60: 2070 6163 6b61 6765 7320 6164 6465 6420   packages added 
-0003af70: 6279 0a20 2020 2020 2020 2020 2020 203a  by.            :
-0003af80: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
-0003af90: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
-0003afa0: 6e2e 6164 645f 7061 636b 6167 6573 6020  n.add_packages` 
-0003afb0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-0003afc0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
-0003afd0: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
-0003afe0: 6f6e 2e61 6464 5f72 6571 7569 7265 6d65  on.add_requireme
-0003aff0: 6e74 7360 2e0a 2020 2020 2020 2020 7265  nts`..        re
-0003b000: 706c 6163 653a 2057 6865 7468 6572 2074  place: Whether t
-0003b010: 6f20 7265 706c 6163 6520 6120 5544 5446  o replace a UDTF
-0003b020: 2074 6861 7420 616c 7265 6164 7920 7761   that already wa
-0003b030: 7320 7265 6769 7374 6572 6564 2e20 5468  s registered. Th
-0003b040: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
-0003b050: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
-0003b060: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
-0003b070: 616c 7365 6060 2c20 6174 7465 6d70 7469  alse``, attempti
-0003b080: 6e67 2074 6f20 7265 6769 7374 6572 2061  ng to register a
-0003b090: 2055 4454 4620 7769 7468 2061 206e 616d   UDTF with a nam
-0003b0a0: 6520 7468 6174 2061 6c72 6561 6479 2065  e that already e
-0003b0b0: 7869 7374 730a 2020 2020 2020 2020 2020  xists.          
-0003b0c0: 2020 7265 7375 6c74 7320 696e 2061 2060    results in a `
-0003b0d0: 6053 6e6f 7770 6172 6b53 514c 4578 6365  `SnowparkSQLExce
-0003b0e0: 7074 696f 6e60 6020 6578 6365 7074 696f  ption`` exceptio
-0003b0f0: 6e20 6265 696e 6720 7468 726f 776e 2e20  n being thrown. 
-0003b100: 4966 2069 7420 6973 2060 6054 7275 6560  If it is ``True`
-0003b110: 602c 0a20 2020 2020 2020 2020 2020 2061  `,.            a
-0003b120: 6e20 6578 6973 7469 6e67 2055 4454 4620  n existing UDTF 
-0003b130: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-0003b140: 6d65 2069 7320 6f76 6572 7772 6974 7465  me is overwritte
-0003b150: 6e2e 0a20 2020 2020 2020 2069 665f 6e6f  n..        if_no
-0003b160: 745f 6578 6973 7473 3a20 5768 6574 6865  t_exists: Whethe
-0003b170: 7220 746f 2073 6b69 7020 6372 6561 7469  r to skip creati
-0003b180: 6f6e 206f 6620 6120 5544 5446 2077 6865  on of a UDTF whe
-0003b190: 6e20 6f6e 6520 7769 7468 2074 6865 2073  n one with the s
-0003b1a0: 616d 6520 7369 676e 6174 7572 6520 616c  ame signature al
-0003b1b0: 7265 6164 7920 6578 6973 7473 2e0a 2020  ready exists..  
-0003b1c0: 2020 2020 2020 2020 2020 5468 6520 6465            The de
-0003b1d0: 6661 756c 7420 6973 2060 6046 616c 7365  fault is ``False
-0003b1e0: 6060 2e20 6060 6966 5f6e 6f74 5f65 7869  ``. ``if_not_exi
-0003b1f0: 7374 7360 6020 616e 6420 6060 7265 706c  sts`` and ``repl
-0003b200: 6163 6560 6020 6172 6520 6d75 7475 616c  ace`` are mutual
-0003b210: 6c79 2065 7863 6c75 7369 7665 0a20 2020  ly exclusive.   
-0003b220: 2020 2020 2020 2020 2061 6e64 2061 2060           and a `
-0003b230: 6056 616c 7565 4572 726f 7260 6020 6973  `ValueError`` is
-0003b240: 2072 6169 7365 6420 7768 656e 2062 6f74   raised when bot
-0003b250: 6820 6172 6520 7365 742e 2049 6620 6974  h are set. If it
-0003b260: 2069 7320 6060 5472 7565 6060 2061 6e64   is ``True`` and
-0003b270: 2061 2055 4454 4620 7769 7468 0a20 2020   a UDTF with.   
-0003b280: 2020 2020 2020 2020 2074 6865 2073 616d           the sam
-0003b290: 6520 7369 676e 6174 7572 6520 6578 6973  e signature exis
-0003b2a0: 7473 2c20 7468 6520 5544 5446 2063 7265  ts, the UDTF cre
-0003b2b0: 6174 696f 6e20 6973 2073 6b69 7070 6564  ation is skipped
-0003b2c0: 2e0a 2020 2020 2020 2020 7365 7373 696f  ..        sessio
-0003b2d0: 6e3a 2055 7365 2074 6869 7320 7365 7373  n: Use this sess
-0003b2e0: 696f 6e20 746f 2072 6567 6973 7465 7220  ion to register 
-0003b2f0: 7468 6520 5544 5446 2e20 4966 2069 7427  the UDTF. If it'
-0003b300: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
-0003b310: 2074 6865 2073 6573 7369 6f6e 2074 6861   the session tha
-0003b320: 7420 796f 7520 6372 6561 7465 6420 6265  t you created be
-0003b330: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
-0003b340: 7320 6675 6e63 7469 6f6e 2077 696c 6c20  s function will 
-0003b350: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
-0003b360: 2020 2020 2059 6f75 206e 6565 6420 746f       You need to
-0003b370: 2073 7065 6369 6679 2074 6869 7320 7061   specify this pa
-0003b380: 7261 6d65 7465 7220 6966 2079 6f75 2068  rameter if you h
-0003b390: 6176 6520 6372 6561 7465 6420 6d75 6c74  ave created mult
-0003b3a0: 6970 6c65 2073 6573 7369 6f6e 7320 6265  iple sessions be
-0003b3b0: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
-0003b3c0: 7320 6d65 7468 6f64 2e0a 2020 2020 2020  s method..      
-0003b3d0: 2020 7061 7261 6c6c 656c 3a20 5468 6520    parallel: The 
-0003b3e0: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
-0003b3f0: 7320 746f 2075 7365 2066 6f72 2075 706c  s to use for upl
-0003b400: 6f61 6469 6e67 2055 4454 4620 6669 6c65  oading UDTF file
-0003b410: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
-0003b420: 2020 2020 2020 2060 5055 5420 3c68 7474         `PUT <htt
-0003b430: 7073 3a2f 2f64 6f63 732e 736e 6f77 666c  ps://docs.snowfl
-0003b440: 616b 652e 636f 6d2f 656e 2f73 716c 2d72  ake.com/en/sql-r
-0003b450: 6566 6572 656e 6365 2f73 716c 2f70 7574  eference/sql/put
-0003b460: 2e68 746d 6c23 7075 743e 605f 0a20 2020  .html#put>`_.   
-0003b470: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
-0003b480: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
-0003b490: 6c75 6520 6973 2034 2061 6e64 2073 7570  lue is 4 and sup
-0003b4a0: 706f 7274 6564 2076 616c 7565 7320 6172  ported values ar
-0003b4b0: 6520 6672 6f6d 2031 2074 6f20 3939 2e0a  e from 1 to 99..
-0003b4c0: 2020 2020 2020 2020 2020 2020 496e 6372              Incr
-0003b4d0: 6561 7369 6e67 2074 6865 206e 756d 6265  easing the numbe
-0003b4e0: 7220 6f66 2074 6872 6561 6473 2063 616e  r of threads can
-0003b4f0: 2069 6d70 726f 7665 2070 6572 666f 726d   improve perform
-0003b500: 616e 6365 2077 6865 6e20 7570 6c6f 6164  ance when upload
-0003b510: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-0003b520: 6c61 7267 6520 5544 5446 2066 696c 6573  large UDTF files
-0003b530: 2e0a 2020 2020 2020 2020 7374 6174 656d  ..        statem
-0003b540: 656e 745f 7061 7261 6d73 3a20 4469 6374  ent_params: Dict
-0003b550: 696f 6e61 7279 206f 6620 7374 6174 656d  ionary of statem
-0003b560: 656e 7420 6c65 7665 6c20 7061 7261 6d65  ent level parame
-0003b570: 7465 7273 2074 6f20 6265 2073 6574 2077  ters to be set w
-0003b580: 6869 6c65 2065 7865 6375 7469 6e67 2074  hile executing t
-0003b590: 6869 7320 6163 7469 6f6e 2e0a 2020 2020  his action..    
-0003b5a0: 2020 2020 7374 7269 6374 3a20 5768 6574      strict: Whet
-0003b5b0: 6865 7220 7468 6520 6372 6561 7465 6420  her the created 
-0003b5c0: 5544 5446 2069 7320 7374 7269 6374 2e20  UDTF is strict. 
-0003b5d0: 4120 7374 7269 6374 2055 4454 4620 7769  A strict UDTF wi
-0003b5e0: 6c6c 206e 6f74 2069 6e76 6f6b 6520 7468  ll not invoke th
-0003b5f0: 6520 5544 5446 2069 6620 616e 7920 696e  e UDTF if any in
-0003b600: 7075 7420 6973 0a20 2020 2020 2020 2020  put is.         
-0003b610: 2020 206e 756c 6c2e 2049 6e73 7465 6164     null. Instead
-0003b620: 2c20 6120 6e75 6c6c 2076 616c 7565 2077  , a null value w
-0003b630: 696c 6c20 616c 7761 7973 2062 6520 7265  ill always be re
-0003b640: 7475 726e 6564 2066 6f72 2074 6861 7420  turned for that 
-0003b650: 726f 772e 204e 6f74 6520 7468 6174 2074  row. Note that t
-0003b660: 6865 2055 4454 4620 6d69 6768 740a 2020  he UDTF might.  
-0003b670: 2020 2020 2020 2020 2020 7374 696c 6c20            still 
-0003b680: 7265 7475 726e 206e 756c 6c20 666f 7220  return null for 
-0003b690: 6e6f 6e2d 6e75 6c6c 2069 6e70 7574 732e  non-null inputs.
-0003b6a0: 0a20 2020 2020 2020 2073 6563 7572 653a  .        secure:
-0003b6b0: 2057 6865 7468 6572 2074 6865 2063 7265   Whether the cre
-0003b6c0: 6174 6564 2055 4454 4620 6973 2073 6563  ated UDTF is sec
-0003b6d0: 7572 652e 2046 6f72 206d 6f72 6520 696e  ure. For more in
-0003b6e0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
-0003b6f0: 7365 6375 7265 2066 756e 6374 696f 6e73  secure functions
-0003b700: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-0003b710: 6520 6053 6563 7572 6520 5544 4673 203c  e `Secure UDFs <
-0003b720: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-0003b730: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-0003b740: 6c2d 7265 6665 7265 6e63 652f 7564 662d  l-reference/udf-
-0003b750: 7365 6375 7265 2e68 746d 6c3e 605f 2e0a  secure.html>`_..
-0003b760: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
-0003b770: 2020 2020 2020 4120 5544 5446 2066 756e        A UDTF fun
-0003b780: 6374 696f 6e20 7468 6174 2063 616e 2062  ction that can b
-0003b790: 6520 6361 6c6c 6564 2077 6974 6820 3a63  e called with :c
-0003b7a0: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
-0003b7b0: 2e73 6e6f 7770 6172 6b2e 436f 6c75 6d6e  .snowpark.Column
-0003b7c0: 6020 6578 7072 6573 7369 6f6e 732e 0a0a  ` expressions...
-0003b7d0: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
-0003b7e0: 2020 312e 2057 6865 6e20 7479 7065 2068    1. When type h
-0003b7f0: 696e 7473 2061 7265 2070 726f 7669 6465  ints are provide
-0003b800: 6420 616e 6420 6172 6520 636f 6d70 6c65  d and are comple
-0003b810: 7465 2066 6f72 2061 2066 756e 6374 696f  te for a functio
-0003b820: 6e2c 0a20 2020 2020 2020 2060 6072 6574  n,.        ``ret
-0003b830: 7572 6e5f 7479 7065 6060 2061 6e64 2060  urn_type`` and `
-0003b840: 6069 6e70 7574 5f74 7970 6573 6060 2061  `input_types`` a
-0003b850: 7265 206f 7074 696f 6e61 6c20 616e 6420  re optional and 
-0003b860: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
-0003b870: 0a20 2020 2020 2020 2053 6565 2064 6574  .        See det
-0003b880: 6169 6c73 206f 6620 7375 7070 6f72 7465  ails of supporte
-0003b890: 6420 6461 7461 2074 7970 6573 2066 6f72  d data types for
-0003b8a0: 2055 4454 4673 2069 6e0a 2020 2020 2020   UDTFs in.      
-0003b8b0: 2020 3a63 6c61 7373 3a60 7e73 6e6f 7766    :class:`~snowf
-0003b8c0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7564  lake.snowpark.ud
-0003b8d0: 7466 2e55 4454 4652 6567 6973 7472 6174  tf.UDTFRegistrat
-0003b8e0: 696f 6e60 2e0a 0a20 2020 2020 2020 2020  ion`...         
-0003b8f0: 2020 202d 2059 6f75 2063 616e 2075 7365     - You can use
-0003b900: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
-0003b910: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003b920: 7479 7065 732e 5661 7269 616e 7460 2074  types.Variant` t
-0003b930: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
-0003b940: 616e 6e6f 7461 7465 2061 2076 6172 6961  annotate a varia
-0003b950: 6e74 2c20 616e 6420 7573 6520 3a61 7474  nt, and use :att
-0003b960: 723a 607e 736e 6f77 666c 616b 652e 736e  r:`~snowflake.sn
-0003b970: 6f77 7061 726b 2e74 7970 6573 2e47 656f  owpark.types.Geo
-0003b980: 6772 6170 6879 600a 2020 2020 2020 2020  graphy`.        
-0003b990: 2020 2020 2020 746f 2061 6e6e 6f74 6174        to annotat
-0003b9a0: 6520 6120 6765 6f67 7261 7068 7920 7768  e a geography wh
-0003b9b0: 656e 2064 6566 696e 696e 6720 6120 5544  en defining a UD
-0003b9c0: 5446 2e0a 0a20 2020 2020 2020 2020 2020  TF...           
-0003b9d0: 202d 203a 636c 6173 733a 6074 7970 696e   - :class:`typin
-0003b9e0: 672e 556e 696f 6e60 2069 7320 6e6f 7420  g.Union` is not 
-0003b9f0: 6120 7661 6c69 6420 7479 7065 2061 6e6e  a valid type ann
-0003ba00: 6f74 6174 696f 6e20 666f 7220 5544 5446  otation for UDTF
-0003ba10: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0003ba20: 2062 7574 203a 636c 6173 733a 6074 7970   but :class:`typ
-0003ba30: 696e 672e 4f70 7469 6f6e 616c 6020 6361  ing.Optional` ca
-0003ba40: 6e20 6265 2075 7365 6420 746f 2069 6e64  n be used to ind
-0003ba50: 6963 6174 6520 7468 6520 6f70 7469 6f6e  icate the option
-0003ba60: 616c 2074 7970 652e 0a0a 2020 2020 2020  al type...      
-0003ba70: 2020 2020 2020 2d20 5479 7065 2068 696e        - Type hin
-0003ba80: 7473 2061 7265 206e 6f74 2073 7570 706f  ts are not suppo
-0003ba90: 7274 6564 206f 6e20 6675 6e63 7469 6f6e  rted on function
-0003baa0: 7320 6465 636f 7261 7465 6420 7769 7468  s decorated with
-0003bab0: 2064 6563 6f72 6174 6f72 732e 0a0a 2020   decorators...  
-0003bac0: 2020 2020 2020 322e 2041 2074 656d 706f        2. A tempo
-0003bad0: 7261 7279 2055 4454 4620 2877 6865 6e20  rary UDTF (when 
-0003bae0: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
-0003baf0: 2069 7320 6060 4661 6c73 6560 6029 2069   is ``False``) i
-0003bb00: 7320 7363 6f70 6564 2074 6f20 7468 6973  s scoped to this
-0003bb10: 2060 6073 6573 7369 6f6e 6060 0a20 2020   ``session``.   
-0003bb20: 2020 2020 2061 6e64 2061 6c6c 2055 4454       and all UDT
-0003bb30: 4620 7265 6c61 7465 6420 6669 6c65 7320  F related files 
-0003bb40: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
-0003bb50: 2074 6f20 6120 7465 6d70 6f72 6172 7920   to a temporary 
-0003bb60: 7365 7373 696f 6e20 7374 6167 650a 2020  session stage.  
-0003bb70: 2020 2020 2020 283a 6675 6e63 3a60 7365        (:func:`se
-0003bb80: 7373 696f 6e2e 6765 745f 7365 7373 696f  ssion.get_sessio
-0003bb90: 6e5f 7374 6167 6528 2920 3c73 6e6f 7766  n_stage() <snowf
-0003bba0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5365  lake.snowpark.Se
-0003bbb0: 7373 696f 6e2e 6765 745f 7365 7373 696f  ssion.get_sessio
-0003bbc0: 6e5f 7374 6167 653e 6029 2e0a 2020 2020  n_stage>`)..    
-0003bbd0: 2020 2020 466f 7220 6120 7065 726d 616e      For a perman
-0003bbe0: 656e 7420 5544 5446 2c20 7468 6573 6520  ent UDTF, these 
-0003bbf0: 6669 6c65 7320 7769 6c6c 2062 6520 7570  files will be up
-0003bc00: 6c6f 6164 6564 2074 6f20 7468 6520 7374  loaded to the st
-0003bc10: 6167 6520 7468 6174 2079 6f75 2073 7065  age that you spe
-0003bc20: 6369 6679 2e0a 0a20 2020 2020 2020 2033  cify...        3
-0003bc30: 2e20 4279 2064 6566 6175 6c74 2c20 5544  . By default, UD
-0003bc40: 5446 2072 6567 6973 7472 6174 696f 6e20  TF registration 
-0003bc50: 6661 696c 7320 6966 2061 2066 756e 6374  fails if a funct
-0003bc60: 696f 6e20 7769 7468 2074 6865 2073 616d  ion with the sam
-0003bc70: 6520 6e61 6d65 2069 7320 616c 7265 6164  e name is alread
-0003bc80: 790a 2020 2020 2020 2020 7265 6769 7374  y.        regist
-0003bc90: 6572 6564 2e20 496e 766f 6b69 6e67 203a  ered. Invoking :
-0003bca0: 6675 6e63 3a60 7564 7466 6020 7769 7468  func:`udtf` with
-0003bcb0: 2060 6072 6570 6c61 6365 6060 2073 6574   ``replace`` set
-0003bcc0: 2074 6f20 6060 5472 7565 6060 2077 696c   to ``True`` wil
-0003bcd0: 6c20 6f76 6572 7772 6974 6520 7468 650a  l overwrite the.
-0003bce0: 2020 2020 2020 2020 7072 6576 696f 7573          previous
-0003bcf0: 6c79 2072 6567 6973 7465 7265 6420 6675  ly registered fu
-0003bd00: 6e63 7469 6f6e 2e0a 0a20 2020 2053 6565  nction...    See
-0003bd10: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
-0003bd20: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-0003bd30: 652e 736e 6f77 7061 726b 2e75 6474 662e  e.snowpark.udtf.
-0003bd40: 5544 5446 5265 6769 7374 7261 7469 6f6e  UDTFRegistration
-0003bd50: 600a 0a0a 2020 2020 4578 616d 706c 653a  `...    Example:
-0003bd60: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
-0003bd70: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-0003bd80: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-0003bd90: 6f72 7420 496e 7465 6765 7254 7970 652c  ort IntegerType,
-0003bda0: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
-0003bdb0: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
-0003bdc0: 203e 3e3e 2063 6c61 7373 2050 7269 6d65   >>> class Prime
-0003bdd0: 5369 6576 653a 0a20 2020 2020 2020 202e  Sieve:.        .
-0003bde0: 2e2e 2020 2020 2064 6566 2070 726f 6365  ..     def proce
-0003bdf0: 7373 2873 656c 662c 206e 293a 0a20 2020  ss(self, n):.   
-0003be00: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003be10: 2069 735f 7072 696d 6520 3d20 5b54 7275   is_prime = [Tru
-0003be20: 655d 202a 2028 6e20 2b20 3129 0a20 2020  e] * (n + 1).   
-0003be30: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003be40: 2069 735f 7072 696d 655b 305d 203d 2046   is_prime[0] = F
-0003be50: 616c 7365 0a20 2020 2020 2020 202e 2e2e  alse.        ...
-0003be60: 2020 2020 2020 2020 2069 735f 7072 696d           is_prim
-0003be70: 655b 315d 203d 2046 616c 7365 0a20 2020  e[1] = False.   
-0003be80: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003be90: 2070 203d 2032 0a20 2020 2020 2020 202e   p = 2.        .
-0003bea0: 2e2e 2020 2020 2020 2020 2077 6869 6c65  ..         while
-0003beb0: 2070 202a 2070 203c 3d20 6e3a 0a20 2020   p * p <= n:.   
-0003bec0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003bed0: 2020 2020 2069 6620 6973 5f70 7269 6d65       if is_prime
-0003bee0: 5b70 5d3a 0a20 2020 2020 2020 202e 2e2e  [p]:.        ...
-0003bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf00: 2023 2073 6574 2061 6c6c 206d 756c 7469   # set all multi
-0003bf10: 706c 6573 206f 6620 7020 746f 2046 616c  ples of p to Fal
-0003bf20: 7365 0a20 2020 2020 2020 202e 2e2e 2020  se.        ...  
-0003bf30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0003bf40: 6f72 2069 2069 6e20 7261 6e67 6528 7020  or i in range(p 
-0003bf50: 2a20 702c 206e 202b 2031 2c20 7029 3a0a  * p, n + 1, p):.
-0003bf60: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf80: 6973 5f70 7269 6d65 5b69 5d20 3d20 4661  is_prime[i] = Fa
-0003bf90: 6c73 650a 2020 2020 2020 2020 2e2e 2e20  lse.        ... 
-0003bfa0: 2020 2020 2020 2020 2020 2020 7020 2b3d              p +=
-0003bfb0: 2031 0a20 2020 2020 2020 202e 2e2e 2020   1.        ...  
-0003bfc0: 2020 2020 2020 2023 2079 6965 6c64 2061         # yield a
-0003bfd0: 6c6c 2070 7269 6d65 206e 756d 6265 7273  ll prime numbers
-0003bfe0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0003bff0: 2020 2020 2066 6f72 2070 2069 6e20 7261       for p in ra
-0003c000: 6e67 6528 322c 206e 202b 2031 293a 0a20  nge(2, n + 1):. 
-0003c010: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0003c020: 2020 2020 2020 2069 6620 6973 5f70 7269         if is_pri
-0003c030: 6d65 5b70 5d3a 0a20 2020 2020 2020 202e  me[p]:.        .
-0003c040: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0003c050: 2020 2079 6965 6c64 2028 702c 290a 2020     yield (p,).  
-0003c060: 2020 2020 2020 3e3e 3e20 7072 696d 655f        >>> prime_
-0003c070: 7564 7466 203d 2075 6474 6628 5072 696d  udtf = udtf(Prim
-0003c080: 6553 6965 7665 2c20 6f75 7470 7574 5f73  eSieve, output_s
-0003c090: 6368 656d 613d 5374 7275 6374 5479 7065  chema=StructType
-0003c0a0: 285b 5374 7275 6374 4669 656c 6428 226e  ([StructField("n
-0003c0b0: 756d 6265 7222 2c20 496e 7465 6765 7254  umber", IntegerT
-0003c0c0: 7970 6528 2929 5d29 2c20 696e 7075 745f  ype())]), input_
-0003c0d0: 7479 7065 733d 5b49 6e74 6567 6572 5479  types=[IntegerTy
-0003c0e0: 7065 2829 5d29 0a20 2020 2020 2020 203e  pe()]).        >
-0003c0f0: 3e3e 2073 6573 7369 6f6e 2e74 6162 6c65  >> session.table
-0003c100: 5f66 756e 6374 696f 6e28 7072 696d 655f  _function(prime_
-0003c110: 7564 7466 286c 6974 2832 3029 2929 2e63  udtf(lit(20))).c
-0003c120: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0003c130: 205b 526f 7728 4e55 4d42 4552 3d32 292c   [Row(NUMBER=2),
-0003c140: 2052 6f77 284e 554d 4245 523d 3329 2c20   Row(NUMBER=3), 
-0003c150: 526f 7728 4e55 4d42 4552 3d35 292c 2052  Row(NUMBER=5), R
-0003c160: 6f77 284e 554d 4245 523d 3729 2c20 526f  ow(NUMBER=7), Ro
-0003c170: 7728 4e55 4d42 4552 3d31 3129 2c20 526f  w(NUMBER=11), Ro
-0003c180: 7728 4e55 4d42 4552 3d31 3329 2c20 526f  w(NUMBER=13), Ro
-0003c190: 7728 4e55 4d42 4552 3d31 3729 2c20 526f  w(NUMBER=17), Ro
-0003c1a0: 7728 4e55 4d42 4552 3d31 3929 5d0a 0a20  w(NUMBER=19)].. 
-0003c1b0: 2020 2020 2020 2049 6e73 7465 6164 206f         Instead o
-0003c1c0: 6620 6361 6c6c 696e 6720 6075 6474 6660  f calling `udtf`
-0003c1d0: 2069 7420 6973 2061 6c73 6f20 706f 7373   it is also poss
-0003c1e0: 6962 6c65 2074 6f20 7573 6520 7564 7466  ible to use udtf
-0003c1f0: 2061 7320 6120 6465 636f 7261 746f 722e   as a decorator.
-0003c200: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0003c210: 0a20 2020 2020 2020 203e 3e3e 2040 7564  .        >>> @ud
-0003c220: 7466 286e 616d 653d 2261 6c74 5f69 6e74  tf(name="alt_int
-0003c230: 222c 7265 706c 6163 653d 5472 7565 2c20  ",replace=True, 
-0003c240: 6f75 7470 7574 5f73 6368 656d 613d 5374  output_schema=St
-0003c250: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
-0003c260: 4669 656c 6428 226e 756d 6265 7222 2c20  Field("number", 
-0003c270: 496e 7465 6765 7254 7970 6528 2929 5d29  IntegerType())])
-0003c280: 2c20 696e 7075 745f 7479 7065 733d 5b49  , input_types=[I
-0003c290: 6e74 6567 6572 5479 7065 2829 5d29 0a20  ntegerType()]). 
-0003c2a0: 2020 2020 2020 202e 2e2e 2063 6c61 7373         ... class
-0003c2b0: 2041 6c74 6572 6e61 746f 723a 0a20 2020   Alternator:.   
-0003c2c0: 2020 2020 202e 2e2e 2020 2020 2064 6566       ...     def
-0003c2d0: 205f 5f69 6e69 745f 5f28 7365 6c66 293a   __init__(self):
-0003c2e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0003c2f0: 2020 2020 2073 656c 662e 5f70 6f73 6974       self._posit
-0003c300: 6976 6520 3d20 5472 7565 0a20 2020 2020  ive = True.     
-0003c310: 2020 202e 2e2e 0a20 2020 2020 2020 202e     ....        .
-0003c320: 2e2e 2020 2020 2064 6566 2070 726f 6365  ..     def proce
-0003c330: 7373 2873 656c 662c 206e 293a 0a20 2020  ss(self, n):.   
-0003c340: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003c350: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0003c360: 6e29 3a0a 2020 2020 2020 2020 2e2e 2e20  n):.        ... 
-0003c370: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0003c380: 656c 662e 5f70 6f73 6974 6976 653a 0a20  elf._positive:. 
-0003c390: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0003c3a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-0003c3b0: 2028 312c 290a 2020 2020 2020 2020 2e2e   (1,).        ..
-0003c3c0: 2e20 2020 2020 2020 2020 2020 2020 656c  .             el
-0003c3d0: 7365 3a0a 2020 2020 2020 2020 2e2e 2e20  se:.        ... 
-0003c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c3f0: 7969 656c 6420 282d 312c 290a 2020 2020  yield (-1,).    
-0003c400: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0003c410: 2020 2020 7365 6c66 2e5f 706f 7369 7469      self._positi
-0003c420: 7665 203d 206e 6f74 2073 656c 662e 5f70  ve = not self._p
-0003c430: 6f73 6974 6976 650a 2020 2020 2020 2020  ositive.        
-0003c440: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
-0003c450: 655f 6675 6e63 7469 6f6e 2822 616c 745f  e_function("alt_
-0003c460: 696e 7422 2c20 6c69 7428 3329 292e 636f  int", lit(3)).co
-0003c470: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0003c480: 5b52 6f77 284e 554d 4245 523d 3129 2c20  [Row(NUMBER=1), 
-0003c490: 526f 7728 4e55 4d42 4552 3d2d 3129 2c20  Row(NUMBER=-1), 
-0003c4a0: 526f 7728 4e55 4d42 4552 3d31 295d 0a20  Row(NUMBER=1)]. 
-0003c4b0: 2020 2020 2020 203e 3e3e 2073 6573 7369         >>> sessi
-0003c4c0: 6f6e 2e74 6162 6c65 5f66 756e 6374 696f  on.table_functio
-0003c4d0: 6e28 2261 6c74 5f69 6e74 222c 206c 6974  n("alt_int", lit
-0003c4e0: 2832 2929 2e63 6f6c 6c65 6374 2829 0a20  (2)).collect(). 
-0003c4f0: 2020 2020 2020 205b 526f 7728 4e55 4d42         [Row(NUMB
-0003c500: 4552 3d31 292c 2052 6f77 284e 554d 4245  ER=1), Row(NUMBE
-0003c510: 523d 2d31 295d 0a20 2020 2020 2020 203e  R=-1)].        >
-0003c520: 3e3e 2073 6573 7369 6f6e 2e74 6162 6c65  >> session.table
-0003c530: 5f66 756e 6374 696f 6e28 2261 6c74 5f69  _function("alt_i
-0003c540: 6e74 222c 206c 6974 2831 2929 2e63 6f6c  nt", lit(1)).col
-0003c550: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0003c560: 526f 7728 4e55 4d42 4552 3d31 295d 0a20  Row(NUMBER=1)]. 
-0003c570: 2020 2022 2222 0a20 2020 2073 6573 7369     """.    sessi
-0003c580: 6f6e 203d 2073 6573 7369 6f6e 206f 7220  on = session or 
-0003c590: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0003c5a0: 726b 2e73 6573 7369 6f6e 2e5f 6765 745f  rk.session._get_
-0003c5b0: 6163 7469 7665 5f73 6573 7369 6f6e 2829  active_session()
-0003c5c0: 0a20 2020 2069 6620 6861 6e64 6c65 7220  .    if handler 
-0003c5d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0003c5e0: 2072 6574 7572 6e20 6675 6e63 746f 6f6c   return functool
-0003c5f0: 732e 7061 7274 6961 6c28 0a20 2020 2020  s.partial(.     
-0003c600: 2020 2020 2020 2073 6573 7369 6f6e 2e75         session.u
-0003c610: 6474 662e 7265 6769 7374 6572 2c0a 2020  dtf.register,.  
-0003c620: 2020 2020 2020 2020 2020 6f75 7470 7574            output
-0003c630: 5f73 6368 656d 613d 6f75 7470 7574 5f73  _schema=output_s
-0003c640: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
-0003c650: 2020 2069 6e70 7574 5f74 7970 6573 3d69     input_types=i
-0003c660: 6e70 7574 5f74 7970 6573 2c0a 2020 2020  nput_types,.    
-0003c670: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
-0003c680: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-0003c690: 735f 7065 726d 616e 656e 743d 6973 5f70  s_permanent=is_p
-0003c6a0: 6572 6d61 6e65 6e74 2c0a 2020 2020 2020  ermanent,.      
-0003c6b0: 2020 2020 2020 7374 6167 655f 6c6f 6361        stage_loca
-0003c6c0: 7469 6f6e 3d73 7461 6765 5f6c 6f63 6174  tion=stage_locat
-0003c6d0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0003c6e0: 2069 6d70 6f72 7473 3d69 6d70 6f72 7473   imports=imports
-0003c6f0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0003c700: 636b 6167 6573 3d70 6163 6b61 6765 732c  ckages=packages,
-0003c710: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
-0003c720: 6c61 6365 3d72 6570 6c61 6365 2c0a 2020  lace=replace,.  
-0003c730: 2020 2020 2020 2020 2020 6966 5f6e 6f74            if_not
-0003c740: 5f65 7869 7374 733d 6966 5f6e 6f74 5f65  _exists=if_not_e
-0003c750: 7869 7374 732c 0a20 2020 2020 2020 2020  xists,.         
-0003c760: 2020 2070 6172 616c 6c65 6c3d 7061 7261     parallel=para
-0003c770: 6c6c 656c 2c0a 2020 2020 2020 2020 2020  llel,.          
-0003c780: 2020 7374 6174 656d 656e 745f 7061 7261    statement_para
-0003c790: 6d73 3d73 7461 7465 6d65 6e74 5f70 6172  ms=statement_par
-0003c7a0: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-0003c7b0: 2073 7472 6963 743d 7374 7269 6374 2c0a   strict=strict,.
-0003c7c0: 2020 2020 2020 2020 2020 2020 7365 6375              secu
-0003c7d0: 7265 3d73 6563 7572 652c 0a20 2020 2020  re=secure,.     
-0003c7e0: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
-0003c7f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0003c800: 7373 696f 6e2e 7564 7466 2e72 6567 6973  ssion.udtf.regis
-0003c810: 7465 7228 0a20 2020 2020 2020 2020 2020  ter(.           
-0003c820: 2068 616e 646c 6572 2c0a 2020 2020 2020   handler,.      
-0003c830: 2020 2020 2020 6f75 7470 7574 5f73 6368        output_sch
-0003c840: 656d 613d 6f75 7470 7574 5f73 6368 656d  ema=output_schem
-0003c850: 612c 0a20 2020 2020 2020 2020 2020 2069  a,.            i
-0003c860: 6e70 7574 5f74 7970 6573 3d69 6e70 7574  nput_types=input
-0003c870: 5f74 7970 6573 2c0a 2020 2020 2020 2020  _types,.        
-0003c880: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
-0003c890: 2020 2020 2020 2020 2020 2069 735f 7065             is_pe
-0003c8a0: 726d 616e 656e 743d 6973 5f70 6572 6d61  rmanent=is_perma
-0003c8b0: 6e65 6e74 2c0a 2020 2020 2020 2020 2020  nent,.          
-0003c8c0: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
-0003c8d0: 3d73 7461 6765 5f6c 6f63 6174 696f 6e2c  =stage_location,
-0003c8e0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0003c8f0: 6f72 7473 3d69 6d70 6f72 7473 2c0a 2020  orts=imports,.  
-0003c900: 2020 2020 2020 2020 2020 7061 636b 6167            packag
-0003c910: 6573 3d70 6163 6b61 6765 732c 0a20 2020  es=packages,.   
-0003c920: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
-0003c930: 3d72 6570 6c61 6365 2c0a 2020 2020 2020  =replace,.      
-0003c940: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
-0003c950: 7374 733d 6966 5f6e 6f74 5f65 7869 7374  sts=if_not_exist
-0003c960: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
-0003c970: 6172 616c 6c65 6c3d 7061 7261 6c6c 656c  arallel=parallel
-0003c980: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-0003c990: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
-0003c9a0: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
-0003c9b0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0003c9c0: 6963 743d 7374 7269 6374 2c0a 2020 2020  ict=strict,.    
-0003c9d0: 2020 2020 2020 2020 7365 6375 7265 3d73          secure=s
-0003c9e0: 6563 7572 652c 0a20 2020 2020 2020 2029  ecure,.        )
-0003c9f0: 0a0a 0a64 6566 2070 616e 6461 735f 7564  ...def pandas_ud
-0003ca00: 6628 0a20 2020 2066 756e 633a 204f 7074  f(.    func: Opt
-0003ca10: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
-0003ca20: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
-0003ca30: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
-0003ca40: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
-0003ca50: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
-0003ca60: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
-0003ca70: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
-0003ca80: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
-0003ca90: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
-0003caa0: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
-0003cab0: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
-0003cac0: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
-0003cad0: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
-0003cae0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
-0003caf0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
-0003cb00: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0003cb10: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
-0003cb20: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
-0003cb30: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
-0003cb40: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
-0003cb50: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
-0003cb60: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
-0003cb70: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
-0003cb80: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
-0003cb90: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
-0003cba0: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
-0003cbb0: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
-0003cbc0: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
-0003cbd0: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
-0003cbe0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0003cbf0: 2e73 6573 7369 6f6e 2e53 6573 7369 6f6e  .session.Session
-0003cc00: 225d 203d 204e 6f6e 652c 0a20 2020 2070  "] = None,.    p
-0003cc10: 6172 616c 6c65 6c3a 2069 6e74 203d 2034  arallel: int = 4
-0003cc20: 2c0a 2020 2020 6d61 785f 6261 7463 685f  ,.    max_batch_
-0003cc30: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b69  size: Optional[i
-0003cc40: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-0003cc50: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
-0003cc60: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
-0003cc70: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
-0003cc80: 652c 0a20 2020 2073 6f75 7263 655f 636f  e,.    source_co
-0003cc90: 6465 5f64 6973 706c 6179 3a20 626f 6f6c  de_display: bool
-0003cca0: 203d 2054 7275 652c 0a29 202d 3e20 556e   = True,.) -> Un
-0003ccb0: 696f 6e5b 5573 6572 4465 6669 6e65 6446  ion[UserDefinedF
-0003ccc0: 756e 6374 696f 6e2c 2066 756e 6374 6f6f  unction, functoo
-0003ccd0: 6c73 2e70 6172 7469 616c 5d3a 0a20 2020  ls.partial]:.   
-0003cce0: 2022 2222 0a20 2020 2052 6567 6973 7465   """.    Registe
-0003ccf0: 7273 2061 2050 7974 686f 6e20 6675 6e63  rs a Python func
-0003cd00: 7469 6f6e 2061 7320 6120 7665 6374 6f72  tion as a vector
-0003cd10: 697a 6564 2055 4446 2061 6e64 2072 6574  ized UDF and ret
-0003cd20: 7572 6e73 2074 6865 2055 4446 2e0a 2020  urns the UDF..  
-0003cd30: 2020 5468 6520 6172 6775 6d65 6e74 732c    The arguments,
-0003cd40: 2072 6574 7572 6e20 7661 6c75 6520 616e   return value an
-0003cd50: 6420 7573 6167 6520 6f66 2074 6869 7320  d usage of this 
-0003cd60: 6675 6e63 7469 6f6e 2061 7265 2065 7861  function are exa
-0003cd70: 6374 6c79 2074 6865 2073 616d 6520 6173  ctly the same as
-0003cd80: 0a20 2020 203a 6675 6e63 3a60 7564 6660  .    :func:`udf`
-0003cd90: 2c20 6275 7420 7468 6973 2066 756e 6374  , but this funct
-0003cda0: 696f 6e20 6361 6e20 6f6e 6c79 2062 6520  ion can only be 
-0003cdb0: 7573 6564 2066 6f72 2072 6567 6973 7465  used for registe
-0003cdc0: 7269 6e67 2076 6563 746f 7269 7a65 6420  ring vectorized 
-0003cdd0: 5544 4673 2e0a 2020 2020 5365 6520 6578  UDFs..    See ex
-0003cde0: 616d 706c 6573 2069 6e20 3a63 6c61 7373  amples in :class
-0003cdf0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-0003ce00: 7770 6172 6b2e 7564 662e 5544 4652 6567  wpark.udf.UDFReg
-0003ce10: 6973 7472 6174 696f 6e60 2e0a 0a20 2020  istration`...   
-0003ce20: 2053 6565 2041 6c73 6f3a 0a20 2020 2020   See Also:.     
-0003ce30: 2020 202d 203a 6675 6e63 3a60 7564 6660     - :func:`udf`
-0003ce40: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
-0003ce50: 3a60 5544 4652 6567 6973 7472 6174 696f  :`UDFRegistratio
-0003ce60: 6e2e 7265 6769 7374 6572 2829 203c 736e  n.register() <sn
-0003ce70: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0003ce80: 2e75 6466 2e55 4446 5265 6769 7374 7261  .udf.UDFRegistra
-0003ce90: 7469 6f6e 2e72 6567 6973 7465 723e 600a  tion.register>`.
-0003cea0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0003ceb0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0003cec0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0003ced0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-0003cee0: 2050 616e 6461 7353 6572 6965 7354 7970   PandasSeriesTyp
-0003cef0: 652c 2050 616e 6461 7344 6174 6146 7261  e, PandasDataFra
-0003cf00: 6d65 5479 7065 2c20 496e 7465 6765 7254  meType, IntegerT
-0003cf10: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-0003cf20: 6164 645f 6f6e 655f 6466 5f70 616e 6461  add_one_df_panda
-0003cf30: 735f 7564 6620 3d20 7061 6e64 6173 5f75  s_udf = pandas_u
-0003cf40: 6466 280a 2020 2020 2020 2020 2e2e 2e20  df(.        ... 
-0003cf50: 2020 2020 6c61 6d62 6461 2064 663a 2064      lambda df: d
-0003cf60: 665b 305d 202b 2064 665b 315d 202b 2031  f[0] + df[1] + 1
-0003cf70: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0003cf80: 2020 7265 7475 726e 5f74 7970 653d 5061    return_type=Pa
-0003cf90: 6e64 6173 5365 7269 6573 5479 7065 2849  ndasSeriesType(I
-0003cfa0: 6e74 6567 6572 5479 7065 2829 292c 0a20  ntegerType()),. 
-0003cfb0: 2020 2020 2020 202e 2e2e 2020 2020 2069         ...     i
-0003cfc0: 6e70 7574 5f74 7970 6573 3d5b 5061 6e64  nput_types=[Pand
-0003cfd0: 6173 4461 7461 4672 616d 6554 7970 6528  asDataFrameType(
-0003cfe0: 5b49 6e74 6567 6572 5479 7065 2829 2c20  [IntegerType(), 
-0003cff0: 496e 7465 6765 7254 7970 6528 295d 295d  IntegerType()])]
-0003d000: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-0003d010: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0003d020: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0003d030: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
-0003d040: 2c20 5b33 2c20 345d 5d2c 2073 6368 656d  , [3, 4]], schem
-0003d050: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
-0003d060: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0003d070: 6563 7428 6164 645f 6f6e 655f 6466 5f70  ect(add_one_df_p
-0003d080: 616e 6461 735f 7564 6628 2261 222c 2022  andas_udf("a", "
-0003d090: 6222 292e 616c 6961 7328 2272 6573 756c  b").alias("resul
-0003d0a0: 7422 2929 2e6f 7264 6572 5f62 7928 2272  t")).order_by("r
-0003d0b0: 6573 756c 7422 292e 7368 6f77 2829 0a20  esult").show(). 
-0003d0c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003d0d0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0003d0e0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-0003d0f0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0003d100: 2020 2020 2020 7c34 2020 2020 2020 2020        |4        
-0003d110: 207c 0a20 2020 2020 2020 207c 3820 2020   |.        |8   
-0003d120: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0003d130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0003d140: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0003d150: 0a0a 2020 2020 6f72 2061 7320 6e61 6d65  ..    or as name
-0003d160: 6420 5061 6e64 6173 2055 4446 7320 7468  d Pandas UDFs th
-0003d170: 6174 2061 7265 2061 6363 6573 6962 6c65  at are accesible
-0003d180: 2069 6e20 7468 6520 7361 6d65 2073 6573   in the same ses
-0003d190: 7369 6f6e 2e20 496e 7374 6561 6420 6f66  sion. Instead of
-0003d1a0: 2063 616c 6c69 6e67 2060 7061 6e64 6173   calling `pandas
-0003d1b0: 5f75 6466 6020 6173 2066 756e 6374 696f  _udf` as functio
-0003d1c0: 6e2c 0a20 2020 2069 7420 6361 6e20 6265  n,.    it can be
-0003d1d0: 2061 6c73 6f20 7573 6564 2061 7320 6120   also used as a 
-0003d1e0: 6465 636f 7261 746f 723a 0a0a 2020 2020  decorator:..    
-0003d1f0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0003d200: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0003d210: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0003d220: 7970 6573 2069 6d70 6f72 7420 5061 6e64  ypes import Pand
-0003d230: 6173 5365 7269 6573 5479 7065 2c20 5061  asSeriesType, Pa
-0003d240: 6e64 6173 4461 7461 4672 616d 6554 7970  ndasDataFrameTyp
-0003d250: 652c 2049 6e74 6567 6572 5479 7065 0a20  e, IntegerType. 
-0003d260: 2020 2020 2020 203e 3e3e 2040 7061 6e64         >>> @pand
-0003d270: 6173 5f75 6466 280a 2020 2020 2020 2020  as_udf(.        
-0003d280: 2e2e 2e20 2020 2020 7265 7475 726e 5f74  ...     return_t
-0003d290: 7970 653d 5061 6e64 6173 5365 7269 6573  ype=PandasSeries
-0003d2a0: 5479 7065 2849 6e74 6567 6572 5479 7065  Type(IntegerType
-0003d2b0: 2829 292c 0a20 2020 2020 2020 202e 2e2e  ()),.        ...
-0003d2c0: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
-0003d2d0: 3d5b 5061 6e64 6173 4461 7461 4672 616d  =[PandasDataFram
-0003d2e0: 6554 7970 6528 5b49 6e74 6567 6572 5479  eType([IntegerTy
-0003d2f0: 7065 2829 2c20 496e 7465 6765 7254 7970  pe(), IntegerTyp
-0003d300: 6528 295d 295d 2c0a 2020 2020 2020 2020  e()])],.        
-0003d310: 2e2e 2e20 290a 2020 2020 2020 2020 2e2e  ... ).        ..
-0003d320: 2e20 6465 6620 6164 645f 6f6e 655f 6466  . def add_one_df
-0003d330: 5f70 616e 6461 735f 7564 6628 6466 293a  _pandas_udf(df):
-0003d340: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0003d350: 2072 6574 7572 6e20 6466 5b30 5d20 2b20   return df[0] + 
-0003d360: 6466 5b31 5d20 2b20 310a 2020 2020 2020  df[1] + 1.      
-0003d370: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0003d380: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0003d390: 616d 6528 5b5b 312c 2032 5d2c 205b 332c  ame([[1, 2], [3,
-0003d3a0: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
-0003d3b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-0003d3c0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-0003d3d0: 6464 5f6f 6e65 5f64 665f 7061 6e64 6173  dd_one_df_pandas
-0003d3e0: 5f75 6466 2822 6122 2c20 2262 2229 2e61  _udf("a", "b").a
-0003d3f0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0003d400: 6f72 6465 725f 6279 2822 7265 7375 6c74  order_by("result
-0003d410: 2229 2e73 686f 7728 290a 2020 2020 2020  ").show().      
-0003d420: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0003d430: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-0003d440: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0003d450: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0003d460: 207c 3420 2020 2020 2020 2020 7c0a 2020   |4         |.  
-0003d470: 2020 2020 2020 7c38 2020 2020 2020 2020        |8        
-0003d480: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0003d490: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003d4a0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0003d4b0: 2222 220a 2020 2020 7365 7373 696f 6e20  """.    session 
-0003d4c0: 3d20 7365 7373 696f 6e20 6f72 2073 6e6f  = session or sno
-0003d4d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003d4e0: 7365 7373 696f 6e2e 5f67 6574 5f61 6374  session._get_act
-0003d4f0: 6976 655f 7365 7373 696f 6e28 290a 2020  ive_session().  
-0003d500: 2020 6966 2066 756e 6320 6973 204e 6f6e    if func is Non
-0003d510: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-0003d520: 6e20 6675 6e63 746f 6f6c 732e 7061 7274  n functools.part
-0003d530: 6961 6c28 0a20 2020 2020 2020 2020 2020  ial(.           
-0003d540: 2073 6573 7369 6f6e 2e75 6466 2e72 6567   session.udf.reg
-0003d550: 6973 7465 722c 0a20 2020 2020 2020 2020  ister,.         
-0003d560: 2020 2072 6574 7572 6e5f 7479 7065 3d72     return_type=r
-0003d570: 6574 7572 6e5f 7479 7065 2c0a 2020 2020  eturn_type,.    
-0003d580: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
-0003d590: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
-0003d5a0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0003d5b0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
-0003d5c0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
-0003d5d0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
-0003d5e0: 2020 2020 2020 2020 2020 2073 7461 6765             stage
-0003d5f0: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
-0003d600: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
-0003d610: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
-0003d620: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
-0003d630: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
-0003d640: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
-0003d650: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
-0003d660: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-0003d670: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
-0003d680: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
-0003d690: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
-0003d6a0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
-0003d6b0: 2020 2020 2020 206d 6178 5f62 6174 6368         max_batch
-0003d6c0: 5f73 697a 653d 6d61 785f 6261 7463 685f  _size=max_batch_
-0003d6d0: 7369 7a65 2c0a 2020 2020 2020 2020 2020  size,.          
-0003d6e0: 2020 5f66 726f 6d5f 7061 6e64 6173 5f75    _from_pandas_u
-0003d6f0: 6466 5f66 756e 6374 696f 6e3d 5472 7565  df_function=True
-0003d700: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-0003d710: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
-0003d720: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
-0003d730: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-0003d740: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
-0003d750: 3d73 6f75 7263 655f 636f 6465 5f64 6973  =source_code_dis
-0003d760: 706c 6179 2c0a 2020 2020 2020 2020 290a  play,.        ).
-0003d770: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003d780: 2020 7265 7475 726e 2073 6573 7369 6f6e    return session
-0003d790: 2e75 6466 2e72 6567 6973 7465 7228 0a20  .udf.register(. 
-0003d7a0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
-0003d7b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0003d7c0: 7572 6e5f 7479 7065 3d72 6574 7572 6e5f  urn_type=return_
-0003d7d0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-0003d7e0: 2020 696e 7075 745f 7479 7065 733d 696e    input_types=in
-0003d7f0: 7075 745f 7479 7065 732c 0a20 2020 2020  put_types,.     
-0003d800: 2020 2020 2020 206e 616d 653d 6e61 6d65         name=name
-0003d810: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
-0003d820: 5f70 6572 6d61 6e65 6e74 3d69 735f 7065  _permanent=is_pe
-0003d830: 726d 616e 656e 742c 0a20 2020 2020 2020  rmanent,.       
-0003d840: 2020 2020 2073 7461 6765 5f6c 6f63 6174       stage_locat
-0003d850: 696f 6e3d 7374 6167 655f 6c6f 6361 7469  ion=stage_locati
-0003d860: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0003d870: 696d 706f 7274 733d 696d 706f 7274 732c  imports=imports,
-0003d880: 0a20 2020 2020 2020 2020 2020 2070 6163  .            pac
-0003d890: 6b61 6765 733d 7061 636b 6167 6573 2c0a  kages=packages,.
-0003d8a0: 2020 2020 2020 2020 2020 2020 7265 706c              repl
-0003d8b0: 6163 653d 7265 706c 6163 652c 0a20 2020  ace=replace,.   
-0003d8c0: 2020 2020 2020 2020 2069 665f 6e6f 745f           if_not_
-0003d8d0: 6578 6973 7473 3d69 665f 6e6f 745f 6578  exists=if_not_ex
-0003d8e0: 6973 7473 2c0a 2020 2020 2020 2020 2020  ists,.          
-0003d8f0: 2020 7061 7261 6c6c 656c 3d70 6172 616c    parallel=paral
-0003d900: 6c65 6c2c 0a20 2020 2020 2020 2020 2020  lel,.           
-0003d910: 206d 6178 5f62 6174 6368 5f73 697a 653d   max_batch_size=
-0003d920: 6d61 785f 6261 7463 685f 7369 7a65 2c0a  max_batch_size,.
-0003d930: 2020 2020 2020 2020 2020 2020 5f66 726f              _fro
-0003d940: 6d5f 7061 6e64 6173 5f75 6466 5f66 756e  m_pandas_udf_fun
-0003d950: 6374 696f 6e3d 5472 7565 2c0a 2020 2020  ction=True,.    
-0003d960: 2020 2020 2020 2020 7374 6174 656d 656e          statemen
-0003d970: 745f 7061 7261 6d73 3d73 7461 7465 6d65  t_params=stateme
-0003d980: 6e74 5f70 6172 616d 732c 0a20 2020 2020  nt_params,.     
-0003d990: 2020 2020 2020 2073 6f75 7263 655f 636f         source_co
-0003d9a0: 6465 5f64 6973 706c 6179 3d73 6f75 7263  de_display=sourc
-0003d9b0: 655f 636f 6465 5f64 6973 706c 6179 2c0a  e_code_display,.
-0003d9c0: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
-0003d9d0: 6361 6c6c 5f75 6466 280a 2020 2020 7564  call_udf(.    ud
-0003d9e0: 665f 6e61 6d65 3a20 7374 722c 0a20 2020  f_name: str,.   
-0003d9f0: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
-0003da00: 4c69 7465 7261 6c2c 0a29 202d 3e20 436f  Literal,.) -> Co
-0003da10: 6c75 6d6e 3a0a 2020 2020 2222 2243 616c  lumn:.    """Cal
-0003da20: 6c73 2061 2075 7365 722d 6465 6669 6e65  ls a user-define
-0003da30: 6420 6675 6e63 7469 6f6e 2028 5544 4629  d function (UDF)
-0003da40: 2062 7920 6e61 6d65 2e0a 0a20 2020 2041   by name...    A
-0003da50: 7267 733a 0a20 2020 2020 2020 2075 6466  rgs:.        udf
-0003da60: 5f6e 616d 653a 2054 6865 206e 616d 6520  _name: The name 
-0003da70: 6f66 2055 4446 2069 6e20 536e 6f77 666c  of UDF in Snowfl
-0003da80: 616b 652e 0a20 2020 2020 2020 2061 7267  ake..        arg
-0003da90: 733a 2041 7267 756d 656e 7473 2063 616e  s: Arguments can
-0003daa0: 2062 6520 696e 2074 776f 2074 7970 6573   be in two types
-0003dab0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-0003dac0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-0003dad0: 616b 652e 736e 6f77 7061 726b 2e43 6f6c  ake.snowpark.Col
-0003dae0: 756d 6e60 2c20 6f72 0a20 2020 2020 2020  umn`, or.       
-0003daf0: 2020 2020 202d 2042 6173 6963 2050 7974       - Basic Pyt
-0003db00: 686f 6e20 7479 7065 732c 2077 6869 6368  hon types, which
-0003db10: 2061 7265 2063 6f6e 7665 7274 6564 2074   are converted t
-0003db20: 6f20 536e 6f77 7061 726b 206c 6974 6572  o Snowpark liter
-0003db30: 616c 732e 0a0a 2020 2020 4578 616d 706c  als...    Exampl
-0003db40: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0003db50: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0003db60: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0003db70: 706f 7274 2049 6e74 6567 6572 5479 7065  port IntegerType
-0003db80: 0a20 2020 2020 2020 203e 3e3e 2075 6466  .        >>> udf
-0003db90: 5f64 6566 203d 2073 6573 7369 6f6e 2e75  _def = session.u
-0003dba0: 6466 2e72 6567 6973 7465 7228 6c61 6d62  df.register(lamb
-0003dbb0: 6461 2078 2c20 793a 2078 202b 2079 2c20  da x, y: x + y, 
-0003dbc0: 6e61 6d65 3d22 6164 645f 636f 6c75 6d6e  name="add_column
-0003dbd0: 7322 2c20 696e 7075 745f 7479 7065 733d  s", input_types=
-0003dbe0: 5b49 6e74 6567 6572 5479 7065 2829 2c20  [IntegerType(), 
-0003dbf0: 496e 7465 6765 7254 7970 6528 295d 2c20  IntegerType()], 
-0003dc00: 7265 7475 726e 5f74 7970 653d 496e 7465  return_type=Inte
-0003dc10: 6765 7254 7970 6528 292c 2072 6570 6c61  gerType(), repla
-0003dc20: 6365 3d54 7275 6529 0a20 2020 2020 2020  ce=True).       
-0003dc30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0003dc40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-0003dc50: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
-0003dc60: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-0003dc70: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0003dc80: 656c 6563 7428 6361 6c6c 5f75 6466 2822  elect(call_udf("
-0003dc90: 6164 645f 636f 6c75 6d6e 7322 2c20 636f  add_columns", co
-0003dca0: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
-0003dcb0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0003dcc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0003dcd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003dce0: 2d0a 2020 2020 2020 2020 7c22 4144 445f  -.        |"ADD_
-0003dcf0: 434f 4c55 4d4e 5328 2222 4122 222c 2022  COLUMNS(""A"", "
-0003dd00: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
-0003dd10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0003dd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003dd30: 2d0a 2020 2020 2020 2020 7c33 2020 2020  -.        |3    
-0003dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd50: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0003dd60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0003dd70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003dd80: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0003dd90: 4c49 4e45 3e0a 2020 2020 2222 220a 0a20  LINE>.    """.. 
-0003dda0: 2020 2076 616c 6964 6174 655f 6f62 6a65     validate_obje
-0003ddb0: 6374 5f6e 616d 6528 7564 665f 6e61 6d65  ct_name(udf_name
-0003ddc0: 290a 2020 2020 7265 7475 726e 205f 6361  ).    return _ca
-0003ddd0: 6c6c 5f66 756e 6374 696f 6e28 7564 665f  ll_function(udf_
-0003dde0: 6e61 6d65 2c20 4661 6c73 652c 202a 6172  name, False, *ar
-0003ddf0: 6773 2c20 6170 695f 6361 6c6c 5f73 6f75  gs, api_call_sou
-0003de00: 7263 653d 2266 756e 6374 696f 6e73 2e63  rce="functions.c
-0003de10: 616c 6c5f 7564 6622 290a 0a0a 6465 6620  all_udf")...def 
-0003de20: 6361 6c6c 5f74 6162 6c65 5f66 756e 6374  call_table_funct
-0003de30: 696f 6e28 0a20 2020 2066 756e 6374 696f  ion(.    functio
-0003de40: 6e5f 6e61 6d65 3a20 7374 722c 202a 6172  n_name: str, *ar
-0003de50: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
-0003de60: 7261 6c2c 202a 2a6b 7761 7267 733a 2043  ral, **kwargs: C
-0003de70: 6f6c 756d 6e4f 724c 6974 6572 616c 0a29  olumnOrLiteral.)
-0003de80: 202d 3e20 2273 6e6f 7766 6c61 6b65 2e73   -> "snowflake.s
-0003de90: 6e6f 7770 6172 6b2e 7461 626c 655f 6675  nowpark.table_fu
-0003dea0: 6e63 7469 6f6e 2e54 6162 6c65 4675 6e63  nction.TableFunc
-0003deb0: 7469 6f6e 4361 6c6c 223a 0a20 2020 2022  tionCall":.    "
-0003dec0: 2222 496e 766f 6b65 7320 6120 536e 6f77  ""Invokes a Snow
-0003ded0: 666c 616b 6520 7461 626c 6520 6675 6e63  flake table func
-0003dee0: 7469 6f6e 2c20 696e 636c 7564 696e 6720  tion, including 
-0003def0: 7379 7374 656d 2d64 6566 696e 6564 2074  system-defined t
-0003df00: 6162 6c65 2066 756e 6374 696f 6e73 2061  able functions a
-0003df10: 6e64 2075 7365 722d 6465 6669 6e65 6420  nd user-defined 
-0003df20: 7461 626c 6520 6675 6e63 7469 6f6e 732e  table functions.
-0003df30: 0a0a 2020 2020 4974 2072 6574 7572 6e73  ..    It returns
-0003df40: 2061 203a 6d65 7468 3a60 7e73 6e6f 7766   a :meth:`~snowf
-0003df50: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7461  lake.snowpark.ta
-0003df60: 626c 655f 6675 6e63 7469 6f6e 2e54 6162  ble_function.Tab
-0003df70: 6c65 4675 6e63 7469 6f6e 4361 6c6c 6020  leFunctionCall` 
-0003df80: 736f 2079 6f75 2063 616e 2073 7065 6369  so you can speci
-0003df90: 6679 2074 6865 2070 6172 7469 7469 6f6e  fy the partition
-0003dfa0: 2063 6c61 7573 652e 0a0a 2020 2020 4172   clause...    Ar
-0003dfb0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
-0003dfc0: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
-0003dfd0: 616d 6520 6f66 2074 6865 2074 6162 6c65  ame of the table
-0003dfe0: 2066 756e 6374 696f 6e2e 0a20 2020 2020   function..     
-0003dff0: 2020 2061 7267 733a 2054 6865 2070 6f73     args: The pos
-0003e000: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-0003e010: 7320 6f66 2074 6865 2074 6162 6c65 2066  s of the table f
-0003e020: 756e 6374 696f 6e2e 0a20 2020 2020 2020  unction..       
-0003e030: 202a 2a6b 7761 7267 733a 2054 6865 206e   **kwargs: The n
-0003e040: 616d 6564 2061 7267 756d 656e 7473 206f  amed arguments o
-0003e050: 6620 7468 6520 7461 626c 6520 6675 6e63  f the table func
-0003e060: 7469 6f6e 2e20 536f 6d65 2074 6162 6c65  tion. Some table
-0003e070: 2066 756e 6374 696f 6e73 2028 652e 672e   functions (e.g.
-0003e080: 2c20 6060 666c 6174 7465 6e60 6029 2068  , ``flatten``) h
-0003e090: 6176 6520 6e61 6d65 6420 6172 6775 6d65  ave named argume
-0003e0a0: 6e74 7320 696e 7374 6561 6420 6f66 2070  nts instead of p
-0003e0b0: 6f73 6974 696f 6e61 6c20 6f6e 6573 2e0a  ositional ones..
-0003e0c0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0003e0d0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0003e0e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0003e0f0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-0003e100: 6f72 7420 6c69 740a 2020 2020 2020 2020  ort lit.        
-0003e110: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
-0003e120: 655f 6675 6e63 7469 6f6e 2863 616c 6c5f  e_function(call_
-0003e130: 7461 626c 655f 6675 6e63 7469 6f6e 2822  table_function("
-0003e140: 7370 6c69 745f 746f 5f74 6162 6c65 222c  split_to_table",
-0003e150: 206c 6974 2822 7370 6c69 7420 776f 7264   lit("split word
-0003e160: 7320 746f 2074 6162 6c65 2229 2c20 6c69  s to table"), li
-0003e170: 7428 2220 2229 292e 6f76 6572 2829 292e  t(" ")).over()).
-0003e180: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0003e190: 2020 5b52 6f77 2853 4551 3d31 2c20 494e    [Row(SEQ=1, IN
-0003e1a0: 4445 583d 312c 2056 414c 5545 3d27 7370  DEX=1, VALUE='sp
-0003e1b0: 6c69 7427 292c 2052 6f77 2853 4551 3d31  lit'), Row(SEQ=1
-0003e1c0: 2c20 494e 4445 583d 322c 2056 414c 5545  , INDEX=2, VALUE
-0003e1d0: 3d27 776f 7264 7327 292c 2052 6f77 2853  ='words'), Row(S
-0003e1e0: 4551 3d31 2c20 494e 4445 583d 332c 2056  EQ=1, INDEX=3, V
-0003e1f0: 414c 5545 3d27 746f 2729 2c20 526f 7728  ALUE='to'), Row(
-0003e200: 5345 513d 312c 2049 4e44 4558 3d34 2c20  SEQ=1, INDEX=4, 
-0003e210: 5641 4c55 453d 2774 6162 6c65 2729 5d0a  VALUE='table')].
-0003e220: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
-0003e230: 726e 2073 6e6f 7766 6c61 6b65 2e73 6e6f  rn snowflake.sno
-0003e240: 7770 6172 6b2e 7461 626c 655f 6675 6e63  wpark.table_func
-0003e250: 7469 6f6e 2e54 6162 6c65 4675 6e63 7469  tion.TableFuncti
-0003e260: 6f6e 4361 6c6c 280a 2020 2020 2020 2020  onCall(.        
-0003e270: 6675 6e63 7469 6f6e 5f6e 616d 652c 202a  function_name, *
-0003e280: 6172 6773 2c20 2a2a 6b77 6172 6773 0a20  args, **kwargs. 
-0003e290: 2020 2029 0a0a 0a64 6566 2074 6162 6c65     )...def table
-0003e2a0: 5f66 756e 6374 696f 6e28 6675 6e63 7469  _function(functi
-0003e2b0: 6f6e 5f6e 616d 653a 2073 7472 2920 2d3e  on_name: str) ->
-0003e2c0: 2043 616c 6c61 626c 653a 0a20 2020 2022   Callable:.    "
-0003e2d0: 2222 4372 6561 7465 2061 2066 756e 6374  ""Create a funct
-0003e2e0: 696f 6e20 6f62 6a65 6374 2074 6f20 696e  ion object to in
-0003e2f0: 766f 6b65 2061 2053 6e6f 7766 6c61 6b65  voke a Snowflake
-0003e300: 2074 6162 6c65 2066 756e 6374 696f 6e2e   table function.
-0003e310: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-0003e320: 2020 2020 6675 6e63 7469 6f6e 5f6e 616d      function_nam
-0003e330: 653a 2054 6865 206e 616d 6520 6f66 2074  e: The name of t
-0003e340: 6865 2074 6162 6c65 2066 756e 6374 696f  he table functio
-0003e350: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
-0003e360: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-0003e370: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-0003e380: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
-0003e390: 696d 706f 7274 206c 6974 0a20 2020 2020  import lit.     
-0003e3a0: 2020 203e 3e3e 2073 706c 6974 5f74 6f5f     >>> split_to_
-0003e3b0: 7461 626c 6520 3d20 7461 626c 655f 6675  table = table_fu
-0003e3c0: 6e63 7469 6f6e 2822 7370 6c69 745f 746f  nction("split_to
-0003e3d0: 5f74 6162 6c65 2229 0a20 2020 2020 2020  _table").       
-0003e3e0: 203e 3e3e 2073 6573 7369 6f6e 2e74 6162   >>> session.tab
-0003e3f0: 6c65 5f66 756e 6374 696f 6e28 7370 6c69  le_function(spli
-0003e400: 745f 746f 5f74 6162 6c65 286c 6974 2822  t_to_table(lit("
-0003e410: 7370 6c69 7420 776f 7264 7320 746f 2074  split words to t
-0003e420: 6162 6c65 2229 2c20 6c69 7428 2220 2229  able"), lit(" ")
-0003e430: 292e 6f76 6572 2829 292e 636f 6c6c 6563  ).over()).collec
-0003e440: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0003e450: 2853 4551 3d31 2c20 494e 4445 583d 312c  (SEQ=1, INDEX=1,
-0003e460: 2056 414c 5545 3d27 7370 6c69 7427 292c   VALUE='split'),
-0003e470: 2052 6f77 2853 4551 3d31 2c20 494e 4445   Row(SEQ=1, INDE
-0003e480: 583d 322c 2056 414c 5545 3d27 776f 7264  X=2, VALUE='word
-0003e490: 7327 292c 2052 6f77 2853 4551 3d31 2c20  s'), Row(SEQ=1, 
-0003e4a0: 494e 4445 583d 332c 2056 414c 5545 3d27  INDEX=3, VALUE='
-0003e4b0: 746f 2729 2c20 526f 7728 5345 513d 312c  to'), Row(SEQ=1,
-0003e4c0: 2049 4e44 4558 3d34 2c20 5641 4c55 453d   INDEX=4, VALUE=
-0003e4d0: 2774 6162 6c65 2729 5d0a 2020 2020 2222  'table')].    ""
-0003e4e0: 220a 2020 2020 7265 7475 726e 206c 616d  ".    return lam
-0003e4f0: 6264 6120 2a61 7267 732c 202a 2a6b 7761  bda *args, **kwa
-0003e500: 7267 733a 2063 616c 6c5f 7461 626c 655f  rgs: call_table_
-0003e510: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
-0003e520: 6e5f 6e61 6d65 2c20 2a61 7267 732c 202a  n_name, *args, *
-0003e530: 2a6b 7761 7267 7329 0a0a 0a64 6566 2063  *kwargs)...def c
-0003e540: 616c 6c5f 6675 6e63 7469 6f6e 2866 756e  all_function(fun
-0003e550: 6374 696f 6e5f 6e61 6d65 3a20 7374 722c  ction_name: str,
-0003e560: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
-0003e570: 4c69 7465 7261 6c29 202d 3e20 436f 6c75  Literal) -> Colu
-0003e580: 6d6e 3a0a 2020 2020 2222 2249 6e76 6f6b  mn:.    """Invok
-0003e590: 6573 2061 2053 6e6f 7766 6c61 6b65 2060  es a Snowflake `
-0003e5a0: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
-0003e5b0: 756e 6374 696f 6e20 3c68 7474 7073 3a2f  unction <https:/
-0003e5c0: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-0003e5d0: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-0003e5e0: 656e 6365 2d66 756e 6374 696f 6e73 2e68  ence-functions.h
-0003e5f0: 746d 6c3e 605f 2028 6275 696c 742d 696e  tml>`_ (built-in
-0003e600: 2066 756e 6374 696f 6e29 2077 6974 6820   function) with 
-0003e610: 7468 6520 7370 6563 6966 6965 6420 6e61  the specified na
-0003e620: 6d65 0a20 2020 2061 6e64 2061 7267 756d  me.    and argum
-0003e630: 656e 7473 2e0a 0a20 2020 2041 7267 733a  ents...    Args:
-0003e640: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
-0003e650: 6e5f 6e61 6d65 3a20 5468 6520 6e61 6d65  n_name: The name
-0003e660: 206f 6620 6275 696c 742d 696e 2066 756e   of built-in fun
-0003e670: 6374 696f 6e20 696e 2053 6e6f 7766 6c61  ction in Snowfla
-0003e680: 6b65 0a20 2020 2020 2020 2061 7267 733a  ke.        args:
-0003e690: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
-0003e6a0: 6520 696e 2074 776f 2074 7970 6573 3a0a  e in two types:.
-0003e6b0: 0a20 2020 2020 2020 2020 2020 202d 203a  .            - :
-0003e6c0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-0003e6d0: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
-0003e6e0: 6e60 2c20 6f72 0a20 2020 2020 2020 2020  n`, or.         
-0003e6f0: 2020 202d 2042 6173 6963 2050 7974 686f     - Basic Pytho
-0003e700: 6e20 7479 7065 732c 2077 6869 6368 2061  n types, which a
-0003e710: 7265 2063 6f6e 7665 7274 6564 2074 6f20  re converted to 
-0003e720: 536e 6f77 7061 726b 206c 6974 6572 616c  Snowpark literal
-0003e730: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
-0003e740: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-0003e750: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0003e760: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-0003e770: 322c 2033 2c20 345d 2c20 7363 6865 6d61  2, 3, 4], schema
-0003e780: 3d5b 2261 225d 2920 2023 2061 2073 696e  =["a"])  # a sin
-0003e790: 676c 6520 636f 6c75 6d6e 2077 6974 6820  gle column with 
-0003e7a0: 3420 726f 7773 0a20 2020 2020 2020 203e  4 rows.        >
-0003e7b0: 3e3e 2064 662e 7365 6c65 6374 2863 616c  >> df.select(cal
-0003e7c0: 6c5f 6675 6e63 7469 6f6e 2822 6176 6722  l_function("avg"
-0003e7d0: 2c20 636f 6c28 2261 2229 2929 2e73 686f  , col("a"))).sho
-0003e7e0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0003e7f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0003e800: 2020 2020 207c 2241 5647 2822 2241 2222       |"AVG(""A""
-0003e810: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
-0003e820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0003e830: 2020 2020 2020 207c 322e 3530 3030 3030         |2.500000
-0003e840: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0003e850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003e860: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0003e870: 494e 453e 0a0a 2020 2020 2222 220a 0a20  INE>..    """.. 
-0003e880: 2020 2072 6574 7572 6e20 5f63 616c 6c5f     return _call_
-0003e890: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
-0003e8a0: 6e5f 6e61 6d65 2c20 4661 6c73 652c 202a  n_name, False, *
-0003e8b0: 6172 6773 290a 0a0a 6465 6620 6675 6e63  args)...def func
-0003e8c0: 7469 6f6e 2866 756e 6374 696f 6e5f 6e61  tion(function_na
-0003e8d0: 6d65 3a20 7374 7229 202d 3e20 4361 6c6c  me: str) -> Call
-0003e8e0: 6162 6c65 3a0a 2020 2020 2222 220a 2020  able:.    """.  
-0003e8f0: 2020 4675 6e63 7469 6f6e 206f 626a 6563    Function objec
-0003e900: 7420 746f 2069 6e76 6f6b 6520 6120 536e  t to invoke a Sn
-0003e910: 6f77 666c 616b 6520 6073 7973 7465 6d2d  owflake `system-
-0003e920: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
-0003e930: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-0003e940: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-0003e950: 7371 6c2d 7265 6665 7265 6e63 652d 6675  sql-reference-fu
-0003e960: 6e63 7469 6f6e 732e 6874 6d6c 3e60 5f20  nctions.html>`_ 
-0003e970: 2862 7569 6c74 2d69 6e20 6675 6e63 7469  (built-in functi
-0003e980: 6f6e 292e 2055 7365 2074 6869 7320 746f  on). Use this to
-0003e990: 2069 6e76 6f6b 650a 2020 2020 616e 7920   invoke.    any 
-0003e9a0: 6275 696c 742d 696e 2066 756e 6374 696f  built-in functio
-0003e9b0: 6e73 206e 6f74 2065 7870 6c69 6369 746c  ns not explicitl
-0003e9c0: 7920 6c69 7374 6564 2069 6e20 7468 6973  y listed in this
-0003e9d0: 206f 626a 6563 742e 0a0a 2020 2020 4172   object...    Ar
-0003e9e0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
-0003e9f0: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
-0003ea00: 616d 6520 6f66 2062 7569 6c74 2d69 6e20  ame of built-in 
-0003ea10: 6675 6e63 7469 6f6e 2069 6e20 536e 6f77  function in Snow
-0003ea20: 666c 616b 652e 0a0a 2020 2020 5265 7475  flake...    Retu
-0003ea30: 726e 733a 0a20 2020 2020 2020 2041 203a  rns:.        A :
-0003ea40: 636c 6173 733a 6043 616c 6c61 626c 6560  class:`Callable`
-0003ea50: 206f 626a 6563 7420 666f 7220 6361 6c6c   object for call
-0003ea60: 696e 6720 6120 536e 6f77 666c 616b 6520  ing a Snowflake 
-0003ea70: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
-0003ea80: 756e 6374 696f 6e2e 0a0a 2020 2020 4578  unction...    Ex
-0003ea90: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-0003eaa0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0003eab0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0003eac0: 6528 5b31 2c20 322c 2033 2c20 345d 2c20  e([1, 2, 3, 4], 
-0003ead0: 7363 6865 6d61 3d5b 2261 225d 2920 2023  schema=["a"])  #
-0003eae0: 2061 2073 696e 676c 6520 636f 6c75 6d6e   a single column
-0003eaf0: 2077 6974 6820 3420 726f 7773 0a20 2020   with 4 rows.   
-0003eb00: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0003eb10: 6374 2863 616c 6c5f 6675 6e63 7469 6f6e  ct(call_function
-0003eb20: 2822 6176 6722 2c20 636f 6c28 2261 2229  ("avg", col("a")
-0003eb30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0003eb40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0003eb50: 2d2d 0a20 2020 2020 2020 207c 2241 5647  --.        |"AVG
-0003eb60: 2822 2241 2222 2922 2020 7c0a 2020 2020  (""A"")"  |.    
-0003eb70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0003eb80: 2d2d 2d2d 0a20 2020 2020 2020 207c 322e  ----.        |2.
-0003eb90: 3530 3030 3030 2020 2020 2020 7c0a 2020  500000      |.  
-0003eba0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0003ebb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0003ebc0: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
-0003ebd0: 2020 203e 3e3e 206d 795f 6176 6720 3d20     >>> my_avg = 
-0003ebe0: 6675 6e63 7469 6f6e 2827 6176 6727 290a  function('avg').
-0003ebf0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0003ec00: 656c 6563 7428 6d79 5f61 7667 2863 6f6c  elect(my_avg(col
-0003ec10: 2822 6122 2929 292e 7368 6f77 2829 0a20  ("a"))).show(). 
-0003ec20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003ec30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003ec40: 7c22 4156 4728 2222 4122 2229 2220 207c  |"AVG(""A"")"  |
-0003ec50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003ec60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0003ec70: 2020 7c32 2e35 3030 3030 3020 2020 2020    |2.500000     
-0003ec80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0003ec90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0003eca0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0003ecb0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
-0003ecc0: 726e 206c 616d 6264 6120 2a61 7267 733a  rn lambda *args:
-0003ecd0: 2063 616c 6c5f 6675 6e63 7469 6f6e 2866   call_function(f
-0003ece0: 756e 6374 696f 6e5f 6e61 6d65 2c20 2a61  unction_name, *a
-0003ecf0: 7267 7329 0a0a 0a64 6566 205f 6361 6c6c  rgs)...def _call
-0003ed00: 5f66 756e 6374 696f 6e28 0a20 2020 206e  _function(.    n
-0003ed10: 616d 653a 2073 7472 2c0a 2020 2020 6973  ame: str,.    is
-0003ed20: 5f64 6973 7469 6e63 743a 2062 6f6f 6c20  _distinct: bool 
-0003ed30: 3d20 4661 6c73 652c 0a20 2020 202a 6172  = False,.    *ar
-0003ed40: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
-0003ed50: 7261 6c2c 0a20 2020 2061 7069 5f63 616c  ral,.    api_cal
-0003ed60: 6c5f 736f 7572 6365 3a20 4f70 7469 6f6e  l_source: Option
-0003ed70: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0003ed80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0003ed90: 2065 7870 7265 7373 696f 6e73 203d 205b   expressions = [
-0003eda0: 436f 6c75 6d6e 2e5f 746f 5f65 7870 7228  Column._to_expr(
-0003edb0: 6172 6729 2066 6f72 2061 7267 2069 6e20  arg) for arg in 
-0003edc0: 7061 7273 655f 706f 7369 7469 6f6e 616c  parse_positional
-0003edd0: 5f61 7267 735f 746f 5f6c 6973 7428 2a61  _args_to_list(*a
-0003ede0: 7267 7329 5d0a 2020 2020 7265 7475 726e  rgs)].    return
-0003edf0: 2043 6f6c 756d 6e28 0a20 2020 2020 2020   Column(.       
-0003ee00: 2046 756e 6374 696f 6e45 7870 7265 7373   FunctionExpress
-0003ee10: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0003ee20: 206e 616d 652c 2065 7870 7265 7373 696f   name, expressio
-0003ee30: 6e73 2c20 6973 5f64 6973 7469 6e63 743d  ns, is_distinct=
-0003ee40: 6973 5f64 6973 7469 6e63 742c 2061 7069  is_distinct, api
-0003ee50: 5f63 616c 6c5f 736f 7572 6365 3d61 7069  _call_source=api
-0003ee60: 5f63 616c 6c5f 736f 7572 6365 0a20 2020  _call_source.   
-0003ee70: 2020 2020 2029 0a20 2020 2029 0a0a 0a64       ).    )...d
-0003ee80: 6566 2073 7072 6f63 280a 2020 2020 6675  ef sproc(.    fu
-0003ee90: 6e63 3a20 4f70 7469 6f6e 616c 5b43 616c  nc: Optional[Cal
-0003eea0: 6c61 626c 655d 203d 204e 6f6e 652c 0a20  lable] = None,. 
-0003eeb0: 2020 202a 2c0a 2020 2020 7265 7475 726e     *,.    return
-0003eec0: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
-0003eed0: 4461 7461 5479 7065 5d20 3d20 4e6f 6e65  DataType] = None
-0003eee0: 2c0a 2020 2020 696e 7075 745f 7479 7065  ,.    input_type
-0003eef0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0003ef00: 5b44 6174 6154 7970 655d 5d20 3d20 4e6f  [DataType]] = No
-0003ef10: 6e65 2c0a 2020 2020 6e61 6d65 3a20 4f70  ne,.    name: Op
-0003ef20: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
-0003ef30: 2c20 4974 6572 6162 6c65 5b73 7472 5d5d  , Iterable[str]]
-0003ef40: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6973  ] = None,.    is
-0003ef50: 5f70 6572 6d61 6e65 6e74 3a20 626f 6f6c  _permanent: bool
-0003ef60: 203d 2046 616c 7365 2c0a 2020 2020 7374   = False,.    st
-0003ef70: 6167 655f 6c6f 6361 7469 6f6e 3a20 4f70  age_location: Op
-0003ef80: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0003ef90: 6e65 2c0a 2020 2020 696d 706f 7274 733a  ne,.    imports:
-0003efa0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b55   Optional[List[U
-0003efb0: 6e69 6f6e 5b73 7472 2c20 5475 706c 655b  nion[str, Tuple[
-0003efc0: 7374 722c 2073 7472 5d5d 5d5d 203d 204e  str, str]]]] = N
-0003efd0: 6f6e 652c 0a20 2020 2070 6163 6b61 6765  one,.    package
-0003efe0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0003eff0: 5b55 6e69 6f6e 5b73 7472 2c20 4d6f 6475  [Union[str, Modu
-0003f000: 6c65 5479 7065 5d5d 5d20 3d20 4e6f 6e65  leType]]] = None
-0003f010: 2c0a 2020 2020 7265 706c 6163 653a 2062  ,.    replace: b
-0003f020: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0003f030: 2069 665f 6e6f 745f 6578 6973 7473 3a20   if_not_exists: 
-0003f040: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0003f050: 2020 7365 7373 696f 6e3a 204f 7074 696f    session: Optio
-0003f060: 6e61 6c5b 2273 6e6f 7766 6c61 6b65 2e73  nal["snowflake.s
-0003f070: 6e6f 7770 6172 6b2e 5365 7373 696f 6e22  nowpark.Session"
-0003f080: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 7061  ] = None,.    pa
-0003f090: 7261 6c6c 656c 3a20 696e 7420 3d20 342c  rallel: int = 4,
-0003f0a0: 0a20 2020 2073 7461 7465 6d65 6e74 5f70  .    statement_p
-0003f0b0: 6172 616d 733a 204f 7074 696f 6e61 6c5b  arams: Optional[
-0003f0c0: 4469 6374 5b73 7472 2c20 7374 725d 5d20  Dict[str, str]] 
-0003f0d0: 3d20 4e6f 6e65 2c0a 2020 2020 6578 6563  = None,.    exec
-0003f0e0: 7574 655f 6173 3a20 7479 7069 6e67 2e4c  ute_as: typing.L
-0003f0f0: 6974 6572 616c 5b22 6361 6c6c 6572 222c  iteral["caller",
-0003f100: 2022 6f77 6e65 7222 5d20 3d20 226f 776e   "owner"] = "own
-0003f110: 6572 222c 0a20 2020 2073 7472 6963 743a  er",.    strict:
-0003f120: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0003f130: 2020 2073 6f75 7263 655f 636f 6465 5f64     source_code_d
-0003f140: 6973 706c 6179 3a20 626f 6f6c 203d 2054  isplay: bool = T
-0003f150: 7275 652c 0a20 2020 202a 2a6b 7761 7267  rue,.    **kwarg
-0003f160: 732c 0a29 202d 3e20 556e 696f 6e5b 5374  s,.) -> Union[St
-0003f170: 6f72 6564 5072 6f63 6564 7572 652c 2066  oredProcedure, f
-0003f180: 756e 6374 6f6f 6c73 2e70 6172 7469 616c  unctools.partial
-0003f190: 5d3a 0a20 2020 2022 2222 5265 6769 7374  ]:.    """Regist
-0003f1a0: 6572 7320 6120 5079 7468 6f6e 2066 756e  ers a Python fun
-0003f1b0: 6374 696f 6e20 6173 2061 2053 6e6f 7766  ction as a Snowf
-0003f1c0: 6c61 6b65 2050 7974 686f 6e20 7374 6f72  lake Python stor
-0003f1d0: 6564 2070 726f 6365 6475 7265 2061 6e64  ed procedure and
-0003f1e0: 2072 6574 7572 6e73 2074 6865 2073 746f   returns the sto
-0003f1f0: 7265 6420 7072 6f63 6564 7572 652e 0a0a  red procedure...
-0003f200: 2020 2020 4974 2063 616e 2062 6520 7573      It can be us
-0003f210: 6564 2061 7320 6569 7468 6572 2061 2066  ed as either a f
-0003f220: 756e 6374 696f 6e20 6361 6c6c 206f 7220  unction call or 
-0003f230: 6120 6465 636f 7261 746f 722e 2049 6e20  a decorator. In 
-0003f240: 6d6f 7374 2063 6173 6573 2079 6f75 2077  most cases you w
-0003f250: 6f72 6b20 7769 7468 2061 2073 696e 676c  ork with a singl
-0003f260: 6520 7365 7373 696f 6e2e 0a20 2020 2054  e session..    T
-0003f270: 6869 7320 6675 6e63 7469 6f6e 2075 7365  his function use
-0003f280: 7320 7468 6174 2073 6573 7369 6f6e 2074  s that session t
-0003f290: 6f20 7265 6769 7374 6572 2074 6865 2073  o register the s
-0003f2a0: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
-0003f2b0: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
-0003f2c0: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
-0003f2d0: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
-0003f2e0: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
-0003f2f0: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
-0003f300: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
-0003f310: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
-0003f320: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
-0003f330: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
-0003f340: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
-0003f350: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
-0003f360: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
-0003f370: 7365 2060 6073 6573 7369 6f6e 2e73 7072  se ``session.spr
-0003f380: 6f63 2e72 6567 6973 7465 7260 6020 696e  oc.register`` in
-0003f390: 7374 6561 642e 2053 6565 2065 7861 6d70  stead. See examp
-0003f3a0: 6c65 730a 2020 2020 696e 203a 636c 6173  les.    in :clas
-0003f3b0: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
-0003f3c0: 6f77 7061 726b 2e73 746f 7265 645f 7072  owpark.stored_pr
-0003f3d0: 6f63 6564 7572 652e 5374 6f72 6564 5072  ocedure.StoredPr
-0003f3e0: 6f63 6564 7572 6552 6567 6973 7472 6174  ocedureRegistrat
-0003f3f0: 696f 6e60 2e0a 0a20 2020 204e 6f74 6520  ion`...    Note 
-0003f400: 7468 6174 2074 6865 2066 6972 7374 2070  that the first p
-0003f410: 6172 616d 6574 6572 206f 6620 796f 7572  arameter of your
-0003f420: 2066 756e 6374 696f 6e20 7368 6f75 6c64   function should
-0003f430: 2062 6520 6120 736e 6f77 7061 726b 2053   be a snowpark S
-0003f440: 6573 7369 6f6e 2e20 416c 736f 2c20 796f  ession. Also, yo
-0003f450: 7520 6e65 6564 2074 6f20 6164 640a 2020  u need to add.  
-0003f460: 2020 6073 6e6f 7766 6c61 6b65 2d73 6e6f    `snowflake-sno
-0003f470: 7770 6172 6b2d 7079 7468 6f6e 6020 7061  wpark-python` pa
-0003f480: 636b 6167 6520 2876 6572 7369 6f6e 203e  ckage (version >
-0003f490: 3d20 302e 342e 3029 2074 6f20 796f 7572  = 0.4.0) to your
-0003f4a0: 2073 6573 7369 6f6e 2062 6566 6f72 6520   session before 
-0003f4b0: 7472 7969 6e67 2074 6f20 6372 6561 7465  trying to create
-0003f4c0: 2061 0a20 2020 2073 746f 7265 6420 7072   a.    stored pr
-0003f4d0: 6f63 6564 7572 652e 0a0a 2020 2020 4172  ocedure...    Ar
-0003f4e0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
-0003f4f0: 3a20 4120 5079 7468 6f6e 2066 756e 6374  : A Python funct
-0003f500: 696f 6e20 7573 6564 2066 6f72 2063 7265  ion used for cre
-0003f510: 6174 696e 6720 7468 6520 7374 6f72 6564  ating the stored
-0003f520: 2070 726f 6365 6475 7265 2e0a 2020 2020   procedure..    
-0003f530: 2020 2020 7265 7475 726e 5f74 7970 653a      return_type:
-0003f540: 2041 203a 636c 6173 733a 607e 736e 6f77   A :class:`~snow
-0003f550: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0003f560: 7970 6573 2e44 6174 6154 7970 6560 2072  ypes.DataType` r
-0003f570: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-0003f580: 7265 7475 726e 2064 6174 610a 2020 2020  return data.    
-0003f590: 2020 2020 2020 2020 7479 7065 206f 6620          type of 
-0003f5a0: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
-0003f5b0: 6475 7265 2e20 4f70 7469 6f6e 616c 2069  dure. Optional i
-0003f5c0: 6620 7479 7065 2068 696e 7473 2061 7265  f type hints are
-0003f5d0: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
-0003f5e0: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
-0003f5f0: 4120 6c69 7374 206f 6620 3a63 6c61 7373  A list of :class
-0003f600: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-0003f610: 7770 6172 6b2e 7479 7065 732e 4461 7461  wpark.types.Data
-0003f620: 5479 7065 600a 2020 2020 2020 2020 2020  Type`.          
-0003f630: 2020 7265 7072 6573 656e 7469 6e67 2074    representing t
-0003f640: 6865 2069 6e70 7574 2064 6174 6120 7479  he input data ty
-0003f650: 7065 7320 6f66 2074 6865 2073 746f 7265  pes of the store
-0003f660: 6420 7072 6f63 6564 7572 652e 204f 7074  d procedure. Opt
-0003f670: 696f 6e61 6c20 6966 0a20 2020 2020 2020  ional if.       
-0003f680: 2020 2020 2074 7970 6520 6869 6e74 7320       type hints 
-0003f690: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
-0003f6a0: 2020 2020 2020 6e61 6d65 3a20 4120 7374        name: A st
-0003f6b0: 7269 6e67 206f 7220 6c69 7374 206f 6620  ring or list of 
-0003f6c0: 7374 7269 6e67 7320 7468 6174 2073 7065  strings that spe
-0003f6d0: 6369 6679 2074 6865 206e 616d 6520 6f72  cify the name or
-0003f6e0: 2066 756c 6c79 2d71 7561 6c69 6669 6564   fully-qualified
-0003f6f0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-0003f700: 6563 7420 6964 656e 7469 6669 6572 2028  ect identifier (
-0003f710: 6461 7461 6261 7365 206e 616d 652c 2073  database name, s
-0003f720: 6368 656d 6120 6e61 6d65 2c20 616e 6420  chema name, and 
-0003f730: 6675 6e63 7469 6f6e 206e 616d 6529 2066  function name) f
-0003f740: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
-0003f750: 6865 2073 746f 7265 6420 7072 6f63 6564  he stored proced
-0003f760: 7572 6520 696e 2053 6e6f 7766 6c61 6b65  ure in Snowflake
-0003f770: 2c20 7768 6963 6820 616c 6c6f 7773 2079  , which allows y
-0003f780: 6f75 2074 6f20 6361 6c6c 2074 6869 7320  ou to call this 
-0003f790: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-0003f7a0: 2069 6e20 6120 5351 4c0a 2020 2020 2020   in a SQL.      
-0003f7b0: 2020 2020 2020 636f 6d6d 616e 6420 6f72        command or
-0003f7c0: 2076 6961 203a 6675 6e63 3a60 7365 7373   via :func:`sess
-0003f7d0: 696f 6e2e 6361 6c6c 2829 602e 2049 6620  ion.call()`. If 
-0003f7e0: 6974 2069 7320 6e6f 7420 7072 6f76 6964  it is not provid
-0003f7f0: 6564 2c20 6120 6e61 6d65 2077 696c 6c0a  ed, a name will.
-0003f800: 2020 2020 2020 2020 2020 2020 6265 2061              be a
-0003f810: 7574 6f6d 6174 6963 616c 6c79 2067 656e  utomatically gen
-0003f820: 6572 6174 6564 2066 6f72 2074 6865 2073  erated for the s
-0003f830: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
-0003f840: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
-0003f850: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
-0003f860: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
-0003f870: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
-0003f880: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
-0003f890: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
-0003f8a0: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
-0003f8b0: 2061 2070 6572 6d61 6e65 6e74 2073 746f   a permanent sto
-0003f8c0: 7265 6420 7072 6f63 6564 7572 652e 2054  red procedure. T
-0003f8d0: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
-0003f8e0: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
-0003f8f0: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
-0003f900: 5472 7565 6060 2c20 6120 7661 6c69 6420  True``, a valid 
-0003f910: 6060 7374 6167 655f 6c6f 6361 7469 6f6e  ``stage_location
-0003f920: 6060 206d 7573 7420 6265 2070 726f 7669  `` must be provi
-0003f930: 6465 642e 0a20 2020 2020 2020 2073 7461  ded..        sta
-0003f940: 6765 5f6c 6f63 6174 696f 6e3a 2054 6865  ge_location: The
-0003f950: 2073 7461 6765 206c 6f63 6174 696f 6e20   stage location 
-0003f960: 7768 6572 6520 7468 6520 5079 7468 6f6e  where the Python
-0003f970: 2066 696c 6520 666f 7220 7468 6520 7374   file for the st
-0003f980: 6f72 6564 2070 726f 6365 6475 7265 0a20  ored procedure. 
-0003f990: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
-0003f9a0: 7473 2064 6570 656e 6465 6e63 6965 7320  ts dependencies 
-0003f9b0: 7368 6f75 6c64 2062 6520 7570 6c6f 6164  should be upload
-0003f9c0: 6564 2e20 5468 6520 7374 6167 6520 6c6f  ed. The stage lo
-0003f9d0: 6361 7469 6f6e 206d 7573 7420 6265 2073  cation must be s
-0003f9e0: 7065 6369 6669 6564 0a20 2020 2020 2020  pecified.       
-0003f9f0: 2020 2020 2077 6865 6e20 6060 6973 5f70       when ``is_p
-0003fa00: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
-0003fa10: 5472 7565 6060 2c20 616e 6420 6974 2077  True``, and it w
-0003fa20: 696c 6c20 6265 2069 676e 6f72 6564 2077  ill be ignored w
-0003fa30: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
-0003fa40: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
-0003fa50: 2069 7320 6060 4661 6c73 6560 602e 2049   is ``False``. I
-0003fa60: 7420 6361 6e20 6265 2061 6e79 2073 7461  t can be any sta
-0003fa70: 6765 206f 7468 6572 2074 6861 6e20 7465  ge other than te
-0003fa80: 6d70 6f72 6172 790a 2020 2020 2020 2020  mporary.        
-0003fa90: 2020 2020 7374 6167 6573 2061 6e64 2065      stages and e
-0003faa0: 7874 6572 6e61 6c20 7374 6167 6573 2e0a  xternal stages..
-0003fab0: 2020 2020 2020 2020 696d 706f 7274 733a          imports:
-0003fac0: 2041 206c 6973 7420 6f66 2069 6d70 6f72   A list of impor
-0003fad0: 7473 2074 6861 7420 6f6e 6c79 2061 7070  ts that only app
-0003fae0: 6c79 2074 6f20 7468 6973 2073 746f 7265  ly to this store
-0003faf0: 6420 7072 6f63 6564 7572 652e 2059 6f75  d procedure. You
-0003fb00: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
-0003fb10: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
-0003fb20: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
-0003fb30: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
-0003fb40: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
-0003fb50: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
-0003fb60: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
-0003fb70: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0003fb80: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
-0003fb90: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
-0003fba0: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
-0003fbb0: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
-0003fbc0: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
-0003fbd0: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
-0003fbe0: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
-0003fbf0: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
-0003fc00: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
-0003fc10: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
-0003fc20: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
-0003fc30: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
-0003fc40: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
-0003fc50: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
-0003fc60: 2054 6865 7365 2073 746f 7265 642d 7072   These stored-pr
-0003fc70: 6f63 2d6c 6576 656c 2069 6d70 6f72 7473  oc-level imports
-0003fc80: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-0003fc90: 6c20 6f76 6572 7269 6465 2074 6865 2073  l override the s
-0003fca0: 6573 7369 6f6e 2d6c 6576 656c 2069 6d70  ession-level imp
-0003fcb0: 6f72 7473 2061 6464 6564 2062 790a 2020  orts added by.  
-0003fcc0: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
-0003fcd0: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-0003fce0: 7061 726b 2e53 6573 7369 6f6e 2e61 6464  park.Session.add
-0003fcf0: 5f69 6d70 6f72 7460 2e0a 2020 2020 2020  _import`..      
-0003fd00: 2020 7061 636b 6167 6573 3a20 4120 6c69    packages: A li
-0003fd10: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
-0003fd20: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
-0003fd30: 6f20 7468 6973 2073 746f 7265 6420 7072  o this stored pr
-0003fd40: 6f63 6564 7572 652e 2054 6865 7365 2073  ocedure. These s
-0003fd50: 746f 7265 642d 7072 6f63 2d6c 6576 656c  tored-proc-level
-0003fd60: 2070 6163 6b61 6765 730a 2020 2020 2020   packages.      
-0003fd70: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
-0003fd80: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
-0003fd90: 6c65 7665 6c20 7061 636b 6167 6573 2061  level packages a
-0003fda0: 6464 6564 2062 790a 2020 2020 2020 2020  dded by.        
-0003fdb0: 2020 2020 3a6d 6574 683a 607e 736e 6f77      :meth:`~snow
-0003fdc0: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
-0003fdd0: 6573 7369 6f6e 2e61 6464 5f70 6163 6b61  ession.add_packa
-0003fde0: 6765 7360 2061 6e64 0a20 2020 2020 2020  ges` and.       
-0003fdf0: 2020 2020 203a 6d65 7468 3a60 7e73 6e6f       :meth:`~sno
-0003fe00: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003fe10: 5365 7373 696f 6e2e 6164 645f 7265 7175  Session.add_requ
-0003fe20: 6972 656d 656e 7473 602e 0a20 2020 2020  irements`..     
-0003fe30: 2020 2072 6570 6c61 6365 3a20 5768 6574     replace: Whet
-0003fe40: 6865 7220 746f 2072 6570 6c61 6365 2061  her to replace a
-0003fe50: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-0003fe60: 6520 7468 6174 2061 6c72 6561 6479 2077  e that already w
-0003fe70: 6173 2072 6567 6973 7465 7265 642e 2054  as registered. T
-0003fe80: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
-0003fe90: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
-0003fea0: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
-0003feb0: 4661 6c73 6560 602c 2061 7474 656d 7074  False``, attempt
-0003fec0: 696e 6720 746f 2072 6567 6973 7465 7220  ing to register 
-0003fed0: 6120 7374 6f72 6564 2070 726f 6365 6475  a stored procedu
-0003fee0: 7265 2077 6974 6820 6120 6e61 6d65 2074  re with a name t
-0003fef0: 6861 7420 616c 7265 6164 7920 6578 6973  hat already exis
-0003ff00: 7473 0a20 2020 2020 2020 2020 2020 2072  ts.            r
-0003ff10: 6573 756c 7473 2069 6e20 6120 6060 536e  esults in a ``Sn
-0003ff20: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
-0003ff30: 6f6e 6060 2065 7863 6570 7469 6f6e 2062  on`` exception b
-0003ff40: 6569 6e67 2074 6872 6f77 6e2e 2049 6620  eing thrown. If 
-0003ff50: 6974 2069 7320 6060 5472 7565 6060 2c0a  it is ``True``,.
-0003ff60: 2020 2020 2020 2020 2020 2020 616e 2065              an e
-0003ff70: 7869 7374 696e 6720 7374 6f72 6564 2070  xisting stored p
-0003ff80: 726f 6365 6475 7265 2077 6974 6820 7468  rocedure with th
-0003ff90: 6520 7361 6d65 206e 616d 6520 6973 206f  e same name is o
-0003ffa0: 7665 7277 7269 7474 656e 2e0a 2020 2020  verwritten..    
-0003ffb0: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
-0003ffc0: 733a 2057 6865 7468 6572 2074 6f20 736b  s: Whether to sk
-0003ffd0: 6970 2063 7265 6174 696f 6e20 6f66 2061  ip creation of a
-0003ffe0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-0003fff0: 6520 7468 6520 7361 6d65 2070 726f 6365  e the same proce
-00040000: 6475 7265 2069 7320 616c 7265 6164 7920  dure is already 
-00040010: 7265 6769 7374 6572 6564 2e0a 2020 2020  registered..    
-00040020: 2020 2020 2020 2020 5468 6520 6465 6661          The defa
-00040030: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
-00040040: 2e20 6060 6966 5f6e 6f74 5f65 7869 7374  . ``if_not_exist
-00040050: 7360 6020 616e 6420 6060 7265 706c 6163  s`` and ``replac
-00040060: 6560 6020 6172 6520 6d75 7475 616c 6c79  e`` are mutually
-00040070: 2065 7863 6c75 7369 7665 2061 6e64 2061   exclusive and a
-00040080: 2060 6056 616c 7565 4572 726f 7260 600a   ``ValueError``.
-00040090: 2020 2020 2020 2020 2020 2020 6973 2072              is r
-000400a0: 6169 7365 6420 7768 656e 2062 6f74 6820  aised when both 
-000400b0: 6172 6520 7365 742e 2049 6620 6974 2069  are set. If it i
-000400c0: 7320 6060 5472 7565 6060 2061 6e64 2061  s ``True`` and a
-000400d0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-000400e0: 6520 6973 2061 6c72 6561 6479 2072 6567  e is already reg
-000400f0: 6973 7465 7265 642c 2074 6865 2072 6567  istered, the reg
-00040100: 6973 7472 6174 696f 6e20 6973 2073 6b69  istration is ski
-00040110: 7070 6564 2e0a 2020 2020 2020 2020 7365  pped..        se
-00040120: 7373 696f 6e3a 2055 7365 2074 6869 7320  ssion: Use this 
-00040130: 7365 7373 696f 6e20 746f 2072 6567 6973  session to regis
-00040140: 7465 7220 7468 6520 7374 6f72 6564 2070  ter the stored p
-00040150: 726f 6365 6475 7265 2e20 4966 2069 7427  rocedure. If it'
-00040160: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
-00040170: 2074 6865 2073 6573 7369 6f6e 2074 6861   the session tha
-00040180: 7420 796f 7520 6372 6561 7465 6420 6265  t you created be
-00040190: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
-000401a0: 7320 6675 6e63 7469 6f6e 2077 696c 6c20  s function will 
-000401b0: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
-000401c0: 2020 2020 2059 6f75 206e 6565 6420 746f       You need to
-000401d0: 2073 7065 6369 6679 2074 6869 7320 7061   specify this pa
-000401e0: 7261 6d65 7465 7220 6966 2079 6f75 2068  rameter if you h
-000401f0: 6176 6520 6372 6561 7465 6420 6d75 6c74  ave created mult
-00040200: 6970 6c65 2073 6573 7369 6f6e 7320 6265  iple sessions be
-00040210: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
-00040220: 7320 6d65 7468 6f64 2e0a 2020 2020 2020  s method..      
-00040230: 2020 7061 7261 6c6c 656c 3a20 5468 6520    parallel: The 
-00040240: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
-00040250: 7320 746f 2075 7365 2066 6f72 2075 706c  s to use for upl
-00040260: 6f61 6469 6e67 2073 746f 7265 6420 7072  oading stored pr
-00040270: 6f63 6564 7572 6520 6669 6c65 7320 7769  ocedure files wi
-00040280: 7468 2074 6865 0a20 2020 2020 2020 2020  th the.         
-00040290: 2020 2060 5055 5420 3c68 7474 7073 3a2f     `PUT <https:/
-000402a0: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-000402b0: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-000402c0: 656e 6365 2f73 716c 2f70 7574 2e68 746d  ence/sql/put.htm
-000402d0: 6c23 7075 743e 605f 0a20 2020 2020 2020  l#put>`_.       
-000402e0: 2020 2020 2063 6f6d 6d61 6e64 2e20 5468       command. Th
-000402f0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-00040300: 6973 2034 2061 6e64 2073 7570 706f 7274  is 4 and support
-00040310: 6564 2076 616c 7565 7320 6172 6520 6672  ed values are fr
-00040320: 6f6d 2031 2074 6f20 3939 2e0a 2020 2020  om 1 to 99..    
-00040330: 2020 2020 2020 2020 496e 6372 6561 7369          Increasi
-00040340: 6e67 2074 6865 206e 756d 6265 7220 6f66  ng the number of
-00040350: 2074 6872 6561 6473 2063 616e 2069 6d70   threads can imp
-00040360: 726f 7665 2070 6572 666f 726d 616e 6365  rove performance
-00040370: 2077 6865 6e20 7570 6c6f 6164 696e 670a   when uploading.
-00040380: 2020 2020 2020 2020 2020 2020 6c61 7267              larg
-00040390: 6520 7374 6f72 6564 2070 726f 6365 6475  e stored procedu
-000403a0: 7265 2066 696c 6573 2e0a 2020 2020 2020  re files..      
-000403b0: 2020 6578 6563 7574 655f 6173 3a20 5768    execute_as: Wh
-000403c0: 6174 2070 6572 6d69 7373 696f 6e73 2073  at permissions s
-000403d0: 686f 756c 6420 7468 6520 7072 6f63 6564  hould the proced
-000403e0: 7572 6520 6861 7665 2077 6869 6c65 2065  ure have while e
-000403f0: 7865 6375 7469 6e67 2e20 5468 6973 0a20  xecuting. This. 
-00040400: 2020 2020 2020 2020 2020 2073 7570 706f             suppo
-00040410: 7274 7320 6361 6c6c 6572 2c20 6f72 206f  rts caller, or o
-00040420: 776e 6572 2066 6f72 206e 6f77 2e20 5365  wner for now. Se
-00040430: 6520 606f 776e 6572 2061 6e64 2063 616c  e `owner and cal
-00040440: 6c65 7220 7269 6768 7473 203c 6874 7470  ler rights <http
-00040450: 733a 2f2f 646f 6373 2e73 6e6f 7766 6c61  s://docs.snowfla
-00040460: 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d 7265  ke.com/en/sql-re
-00040470: 6665 7265 6e63 652f 7374 6f72 6564 2d70  ference/stored-p
-00040480: 726f 6365 6475 7265 732d 7269 6768 7473  rocedures-rights
-00040490: 2e68 746d 6c3e 605f 0a20 2020 2020 2020  .html>`_.       
-000404a0: 2020 2020 2066 6f72 206d 6f72 6520 696e       for more in
-000404b0: 666f 726d 6174 696f 6e2e 0a20 2020 2020  formation..     
-000404c0: 2020 2073 7461 7465 6d65 6e74 5f70 6172     statement_par
-000404d0: 616d 733a 2044 6963 7469 6f6e 6172 7920  ams: Dictionary 
-000404e0: 6f66 2073 7461 7465 6d65 6e74 206c 6576  of statement lev
-000404f0: 656c 2070 6172 616d 6574 6572 7320 746f  el parameters to
-00040500: 2062 6520 7365 7420 7768 696c 6520 6578   be set while ex
-00040510: 6563 7574 696e 6720 7468 6973 2061 6374  ecuting this act
-00040520: 696f 6e2e 0a20 2020 2020 2020 2073 7472  ion..        str
-00040530: 6963 743a 2057 6865 7468 6572 2074 6865  ict: Whether the
-00040540: 2063 7265 6174 6564 2073 746f 7265 6420   created stored 
-00040550: 7072 6f63 6564 7572 6520 6973 2073 7472  procedure is str
-00040560: 6963 742e 2041 2073 7472 6963 7420 7374  ict. A strict st
-00040570: 6f72 6564 2070 726f 6365 6475 7265 2077  ored procedure w
-00040580: 696c 6c20 6e6f 7420 696e 766f 6b65 0a20  ill not invoke. 
-00040590: 2020 2020 2020 2020 2020 2074 6865 2073             the s
-000405a0: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
-000405b0: 6966 2061 6e79 2069 6e70 7574 2069 7320  if any input is 
-000405c0: 6e75 6c6c 2e20 496e 7374 6561 642c 2061  null. Instead, a
-000405d0: 206e 756c 6c20 7661 6c75 6520 7769 6c6c   null value will
-000405e0: 2061 6c77 6179 7320 6265 2072 6574 7572   always be retur
-000405f0: 6e65 642e 204e 6f74 650a 2020 2020 2020  ned. Note.      
-00040600: 2020 2020 2020 7468 6174 2074 6865 2073        that the s
-00040610: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
-00040620: 6d69 6768 7420 7374 696c 6c20 7265 7475  might still retu
-00040630: 726e 206e 756c 6c20 666f 7220 6e6f 6e2d  rn null for non-
-00040640: 6e75 6c6c 2069 6e70 7574 732e 0a20 2020  null inputs..   
-00040650: 2020 2020 2073 6f75 7263 655f 636f 6465       source_code
-00040660: 5f64 6973 706c 6179 3a20 4469 7370 6c61  _display: Displa
-00040670: 7920 7468 6520 736f 7572 6365 2063 6f64  y the source cod
-00040680: 6520 6f66 2074 6865 2073 746f 7265 6420  e of the stored 
-00040690: 7072 6f63 6564 7572 6520 6066 756e 6360  procedure `func`
-000406a0: 2061 7320 636f 6d6d 656e 7473 2069 6e20   as comments in 
-000406b0: 7468 6520 6765 6e65 7261 7465 6420 7363  the generated sc
-000406c0: 7269 7074 2e0a 2020 2020 2020 2020 2020  ript..          
-000406d0: 2020 5468 6520 736f 7572 6365 2063 6f64    The source cod
-000406e0: 6520 6973 2064 796e 616d 6963 616c 6c79  e is dynamically
-000406f0: 2067 656e 6572 6174 6564 2074 6865 7265   generated there
-00040700: 666f 7265 2069 7420 6d61 7920 6e6f 7420  fore it may not 
-00040710: 6265 2069 6465 6e74 6963 616c 2074 6f20  be identical to 
-00040720: 686f 7720 7468 650a 2020 2020 2020 2020  how the.        
-00040730: 2020 2020 6066 756e 6360 2069 7320 6f72      `func` is or
-00040740: 6967 696e 616c 6c79 2064 6566 696e 6564  iginally defined
-00040750: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00040760: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
-00040770: 2020 2020 2020 2049 6620 6974 2069 7320         If it is 
-00040780: 6060 4661 6c73 6560 602c 2073 6f75 7263  ``False``, sourc
-00040790: 6520 636f 6465 2077 696c 6c20 6e6f 7420  e code will not 
-000407a0: 6265 2067 656e 6572 6174 6564 206f 7220  be generated or 
-000407b0: 6469 7370 6c61 7965 642e 0a0a 2020 2020  displayed...    
-000407c0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-000407d0: 2041 2073 746f 7265 6420 7072 6f63 6564   A stored proced
-000407e0: 7572 6520 6675 6e63 7469 6f6e 2074 6861  ure function tha
-000407f0: 7420 6361 6e20 6265 2063 616c 6c65 6420  t can be called 
-00040800: 7769 7468 2070 7974 686f 6e20 7661 6c75  with python valu
-00040810: 652e 0a0a 2020 2020 4e6f 7465 3a0a 2020  e...    Note:.  
-00040820: 2020 2020 2020 312e 2057 6865 6e20 7479        1. When ty
-00040830: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
-00040840: 7669 6465 6420 616e 6420 6172 6520 636f  vided and are co
-00040850: 6d70 6c65 7465 2066 6f72 2061 2066 756e  mplete for a fun
-00040860: 6374 696f 6e2c 0a20 2020 2020 2020 2060  ction,.        `
-00040870: 6072 6574 7572 6e5f 7479 7065 6060 2061  `return_type`` a
-00040880: 6e64 2060 6069 6e70 7574 5f74 7970 6573  nd ``input_types
-00040890: 6060 2061 7265 206f 7074 696f 6e61 6c20  `` are optional 
-000408a0: 616e 6420 7769 6c6c 2062 6520 6967 6e6f  and will be igno
-000408b0: 7265 642e 0a20 2020 2020 2020 2053 6565  red..        See
-000408c0: 2064 6574 6169 6c73 206f 6620 7375 7070   details of supp
-000408d0: 6f72 7465 6420 6461 7461 2074 7970 6573  orted data types
-000408e0: 2066 6f72 2073 746f 7265 6420 7072 6f63   for stored proc
-000408f0: 6564 7572 6520 696e 0a20 2020 2020 2020  edure in.       
-00040900: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
-00040910: 616b 652e 736e 6f77 7061 726b 2e73 746f  ake.snowpark.sto
-00040920: 7265 645f 7072 6f63 6564 7572 652e 5374  red_procedure.St
-00040930: 6f72 6564 5072 6f63 6564 7572 6552 6567  oredProcedureReg
-00040940: 6973 7472 6174 696f 6e60 2e0a 0a20 2020  istration`...   
-00040950: 2020 2020 2020 2020 202d 2059 6f75 2063           - You c
-00040960: 616e 2075 7365 203a 6174 7472 3a60 7e73  an use :attr:`~s
-00040970: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00040980: 6b2e 7479 7065 732e 5661 7269 616e 7460  k.types.Variant`
-00040990: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-000409a0: 2020 616e 6e6f 7461 7465 2061 2076 6172    annotate a var
-000409b0: 6961 6e74 2c20 616e 6420 7573 6520 3a61  iant, and use :a
-000409c0: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
-000409d0: 736e 6f77 7061 726b 2e74 7970 6573 2e47  snowpark.types.G
-000409e0: 656f 6772 6170 6879 600a 2020 2020 2020  eography`.      
-000409f0: 2020 2020 2020 2020 746f 2061 6e6e 6f74          to annot
-00040a00: 6174 6520 6120 6765 6f67 7261 7068 7920  ate a geography 
-00040a10: 7768 656e 2064 6566 696e 696e 6720 6120  when defining a 
-00040a20: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-00040a30: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00040a40: 203a 636c 6173 733a 6074 7970 696e 672e   :class:`typing.
-00040a50: 556e 696f 6e60 2069 7320 6e6f 7420 6120  Union` is not a 
-00040a60: 7661 6c69 6420 7479 7065 2061 6e6e 6f74  valid type annot
-00040a70: 6174 696f 6e20 666f 7220 7374 6f72 6564  ation for stored
-00040a80: 2070 726f 6365 6475 7265 732c 0a20 2020   procedures,.   
-00040a90: 2020 2020 2020 2020 2020 2062 7574 203a             but :
-00040aa0: 636c 6173 733a 6074 7970 696e 672e 4f70  class:`typing.Op
-00040ab0: 7469 6f6e 616c 6020 6361 6e20 6265 2075  tional` can be u
-00040ac0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00040ad0: 7468 6520 6f70 7469 6f6e 616c 2074 7970  the optional typ
-00040ae0: 652e 0a0a 2020 2020 2020 2020 322e 2041  e...        2. A
-00040af0: 2074 656d 706f 7261 7279 2073 746f 7265   temporary store
-00040b00: 6420 7072 6f63 6564 7572 6520 2877 6865  d procedure (whe
-00040b10: 6e20 6060 6973 5f70 6572 6d61 6e65 6e74  n ``is_permanent
-00040b20: 6060 2069 7320 6060 4661 6c73 6560 6029  `` is ``False``)
-00040b30: 2069 7320 7363 6f70 6564 2074 6f20 7468   is scoped to th
-00040b40: 6973 2060 6073 6573 7369 6f6e 6060 0a20  is ``session``. 
-00040b50: 2020 2020 2020 2061 6e64 2061 6c6c 2073         and all s
-00040b60: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
-00040b70: 7265 6c61 7465 6420 6669 6c65 7320 7769  related files wi
-00040b80: 6c6c 2062 6520 7570 6c6f 6164 6564 2074  ll be uploaded t
-00040b90: 6f20 6120 7465 6d70 6f72 6172 7920 7365  o a temporary se
-00040ba0: 7373 696f 6e20 7374 6167 650a 2020 2020  ssion stage.    
-00040bb0: 2020 2020 283a 6675 6e63 3a60 7365 7373      (:func:`sess
-00040bc0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
-00040bd0: 7374 6167 6528 2920 3c73 6e6f 7766 6c61  stage() <snowfla
-00040be0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
-00040bf0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
-00040c00: 7374 6167 653e 6029 2e0a 2020 2020 2020  stage>`)..      
-00040c10: 2020 466f 7220 6120 7065 726d 616e 656e    For a permanen
-00040c20: 7420 7374 6f72 6564 2070 726f 6365 6475  t stored procedu
-00040c30: 7265 2c20 7468 6573 6520 6669 6c65 7320  re, these files 
-00040c40: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
-00040c50: 2074 6f20 7468 6520 7374 6167 6520 7468   to the stage th
-00040c60: 6174 2079 6f75 2070 726f 7669 6465 2e0a  at you provide..
-00040c70: 0a20 2020 2020 2020 2033 2e20 4279 2064  .        3. By d
-00040c80: 6566 6175 6c74 2c20 7374 6f72 6564 2070  efault, stored p
-00040c90: 726f 6365 6475 7265 2072 6567 6973 7472  rocedure registr
-00040ca0: 6174 696f 6e20 6661 696c 7320 6966 2061  ation fails if a
-00040cb0: 2066 756e 6374 696f 6e20 7769 7468 2074   function with t
-00040cc0: 6865 2073 616d 6520 6e61 6d65 2069 7320  he same name is 
-00040cd0: 616c 7265 6164 790a 2020 2020 2020 2020  already.        
-00040ce0: 7265 6769 7374 6572 6564 2e20 496e 766f  registered. Invo
-00040cf0: 6b69 6e67 203a 6675 6e63 3a60 7370 726f  king :func:`spro
-00040d00: 6360 2077 6974 6820 6060 7265 706c 6163  c` with ``replac
-00040d10: 6560 6020 7365 7420 746f 2060 6054 7275  e`` set to ``Tru
-00040d20: 6560 6020 7769 6c6c 206f 7665 7277 7269  e`` will overwri
-00040d30: 7465 2074 6865 0a20 2020 2020 2020 2070  te the.        p
-00040d40: 7265 7669 6f75 736c 7920 7265 6769 7374  reviously regist
-00040d50: 6572 6564 2066 756e 6374 696f 6e2e 0a0a  ered function...
-00040d60: 2020 2020 2020 2020 342e 2054 6f20 6465          4. To de
-00040d70: 7363 7269 6265 2074 6865 2072 6574 7572  scribe the retur
-00040d80: 6e20 7479 7065 2066 6f72 2061 2073 746f  n type for a sto
-00040d90: 7265 6420 7072 6f63 6564 7572 6520 7468  red procedure th
-00040da0: 6174 2060 7265 7475 726e 7320 7461 6275  at `returns tabu
-00040db0: 6c61 7220 6461 7461 0a20 2020 2020 2020  lar data.       
-00040dc0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-00040dd0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-00040de0: 7371 6c2d 7265 6665 7265 6e63 652f 7374  sql-reference/st
-00040df0: 6f72 6564 2d70 726f 6365 6475 7265 732d  ored-procedures-
-00040e00: 7079 7468 6f6e 2372 6574 7572 6e69 6e67  python#returning
-00040e10: 2d74 6162 756c 6172 2d64 6174 613e 605f  -tabular-data>`_
-00040e20: 2c0a 2020 2020 2020 2020 7573 6520 6f6e  ,.        use on
-00040e30: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
-00040e40: 6e67 2077 6179 733a 0a0a 2020 2020 2020  ng ways:..      
-00040e50: 2020 2020 2020 2d20 2852 6563 6f6d 6d65        - (Recomme
-00040e60: 6e64 6564 2920 4465 7363 7269 6265 2074  nded) Describe t
-00040e70: 6865 2072 6574 7572 6e20 7479 7065 2075  he return type u
-00040e80: 7369 6e67 203a 6174 7472 3a60 7e73 6e6f  sing :attr:`~sno
-00040e90: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00040ea0: 7479 7065 732e 5374 7275 6374 5479 7065  types.StructType
-00040eb0: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-00040ec0: 616e 6420 3a61 7474 723a 607e 736e 6f77  and :attr:`~snow
-00040ed0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-00040ee0: 7970 6573 2e53 7472 7563 7446 6965 6c64  ypes.StructField
-00040ef0: 602e 2053 6574 2060 6072 6574 7572 6e5f  `. Set ``return_
-00040f00: 7479 7065 203d 0a20 2020 2020 2020 2020  type =.         
-00040f10: 2020 2020 2053 7472 7563 7454 7970 6528       StructType(
-00040f20: 5b53 7472 7563 7446 6965 6c64 2822 6122  [StructField("a"
-00040f30: 2c20 4461 7461 5479 7065 4128 2929 2c20  , DataTypeA()), 
-00040f40: 2e2e 2e5d 2960 6020 746f 2064 6573 6372  ...])`` to descr
-00040f50: 6962 6520 7468 6520 6361 7365 0a20 2020  ibe the case.   
-00040f60: 2020 2020 2020 2020 2020 2060 6052 4554             ``RET
-00040f70: 5552 4e53 2054 4142 4c45 2841 2044 6174  URNS TABLE(A Dat
-00040f80: 6154 7970 6541 2c20 2e2e 2e29 6060 2e0a  aTypeA, ...)``..
-00040f90: 0a20 2020 2020 2020 2020 2020 202d 2053  .            - S
-00040fa0: 6574 2060 6072 6574 7572 6e5f 7479 7065  et ``return_type
-00040fb0: 203d 2053 7472 7563 7454 7970 6528 2960   = StructType()`
-00040fc0: 6020 746f 2064 6573 6372 6962 6520 7468  ` to describe th
-00040fd0: 6520 6361 7365 2060 6052 4554 5552 4e53  e case ``RETURNS
-00040fe0: 2054 4142 4c45 2829 6060 2e0a 0a20 2020   TABLE()``...   
-00040ff0: 2020 2020 2020 2020 202d 2057 6865 6e20           - When 
-00041000: 7573 696e 6720 7479 7065 2068 696e 7473  using type hints
-00041010: 2c20 7468 6520 7265 7475 726e 2074 7970  , the return typ
-00041020: 6520 6f66 2066 756e 6374 696f 6e20 6361  e of function ca
-00041030: 6e20 6265 2073 6574 2061 730a 2020 2020  n be set as.    
-00041040: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
-00041050: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-00041060: 7770 6172 6b2e 6461 7461 6672 616d 652e  wpark.dataframe.
-00041070: 4461 7461 4672 616d 6560 2e20 5468 6973  DataFrame`. This
-00041080: 2072 6567 6973 7465 7273 2061 0a20 2020   registers a.   
-00041090: 2020 2020 2020 2020 2020 2074 6162 6c65             table
-000410a0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-000410b0: 6520 7769 7468 2072 6574 7572 6e20 7479  e with return ty
-000410c0: 7065 2064 6566 696e 6564 2075 7369 6e67  pe defined using
-000410d0: 2060 6052 4554 5552 4e53 2054 4142 4c45   ``RETURNS TABLE
-000410e0: 2829 6060 2e0a 2020 2020 2020 2020 2020  ()``..          
-000410f0: 2020 2020 4368 6563 6b20 2a2a 5365 6520      Check **See 
-00041100: 616c 736f 2a2a 2062 656c 6f77 2066 6f72  also** below for
-00041110: 206d 6f72 6520 6578 616d 706c 6573 2e0a   more examples..
-00041120: 0a20 2020 2053 6565 2041 6c73 6f3a 0a20  .    See Also:. 
-00041130: 2020 2020 2020 203a 636c 6173 733a 607e         :class:`~
-00041140: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00041150: 726b 2e73 746f 7265 645f 7072 6f63 6564  rk.stored_proced
-00041160: 7572 652e 5374 6f72 6564 5072 6f63 6564  ure.StoredProced
-00041170: 7572 6552 6567 6973 7472 6174 696f 6e60  ureRegistration`
-00041180: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00041190: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-000411a0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-000411b0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-000411c0: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
-000411d0: 2020 2020 203e 3e3e 2040 7370 726f 6328       >>> @sproc(
-000411e0: 7265 7475 726e 5f74 7970 653d 496e 7465  return_type=Inte
-000411f0: 6765 7254 7970 6528 292c 2069 6e70 7574  gerType(), input
-00041200: 5f74 7970 6573 3d5b 496e 7465 6765 7254  _types=[IntegerT
-00041210: 7970 6528 292c 2049 6e74 6567 6572 5479  ype(), IntegerTy
-00041220: 7065 2829 5d2c 2070 6163 6b61 6765 733d  pe()], packages=
-00041230: 5b22 736e 6f77 666c 616b 652d 736e 6f77  ["snowflake-snow
-00041240: 7061 726b 2d70 7974 686f 6e22 5d29 0a20  park-python"]). 
-00041250: 2020 2020 2020 202e 2e2e 2064 6566 2061         ... def a
-00041260: 6464 5f73 7028 7365 7373 696f 6e5f 2c20  dd_sp(session_, 
-00041270: 782c 2079 293a 0a20 2020 2020 2020 202e  x, y):.        .
-00041280: 2e2e 2020 2020 2072 6574 7572 6e20 7365  ..     return se
-00041290: 7373 696f 6e5f 2e73 716c 2866 2253 454c  ssion_.sql(f"SEL
-000412a0: 4543 5420 7b78 7d20 2b20 7b79 7d22 292e  ECT {x} + {y}").
-000412b0: 636f 6c6c 6563 7428 295b 305d 5b30 5d0a  collect()[0][0].
-000412c0: 2020 2020 2020 2020 2e2e 2e0a 2020 2020          ....    
-000412d0: 2020 2020 3e3e 3e20 6164 645f 7370 2831      >>> add_sp(1
-000412e0: 2c20 3129 0a20 2020 2020 2020 2032 0a20  , 1).        2. 
-000412f0: 2020 2022 2222 0a20 2020 2073 6573 7369     """.    sessi
-00041300: 6f6e 203d 2073 6573 7369 6f6e 206f 7220  on = session or 
-00041310: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00041320: 726b 2e73 6573 7369 6f6e 2e5f 6765 745f  rk.session._get_
-00041330: 6163 7469 7665 5f73 6573 7369 6f6e 2829  active_session()
-00041340: 0a20 2020 2069 6620 6675 6e63 2069 7320  .    if func is 
-00041350: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-00041360: 7475 726e 2066 756e 6374 6f6f 6c73 2e70  turn functools.p
-00041370: 6172 7469 616c 280a 2020 2020 2020 2020  artial(.        
-00041380: 2020 2020 7365 7373 696f 6e2e 7370 726f      session.spro
-00041390: 632e 7265 6769 7374 6572 2c0a 2020 2020  c.register,.    
-000413a0: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
-000413b0: 7970 653d 7265 7475 726e 5f74 7970 652c  ype=return_type,
-000413c0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-000413d0: 7574 5f74 7970 6573 3d69 6e70 7574 5f74  ut_types=input_t
-000413e0: 7970 6573 2c0a 2020 2020 2020 2020 2020  ypes,.          
-000413f0: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
-00041400: 2020 2020 2020 2020 2069 735f 7065 726d           is_perm
-00041410: 616e 656e 743d 6973 5f70 6572 6d61 6e65  anent=is_permane
-00041420: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00041430: 7374 6167 655f 6c6f 6361 7469 6f6e 3d73  stage_location=s
-00041440: 7461 6765 5f6c 6f63 6174 696f 6e2c 0a20  tage_location,. 
-00041450: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-00041460: 7473 3d69 6d70 6f72 7473 2c0a 2020 2020  ts=imports,.    
-00041470: 2020 2020 2020 2020 7061 636b 6167 6573          packages
-00041480: 3d70 6163 6b61 6765 732c 0a20 2020 2020  =packages,.     
-00041490: 2020 2020 2020 2072 6570 6c61 6365 3d72         replace=r
-000414a0: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
-000414b0: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
-000414c0: 733d 6966 5f6e 6f74 5f65 7869 7374 732c  s=if_not_exists,
-000414d0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000414e0: 616c 6c65 6c3d 7061 7261 6c6c 656c 2c0a  allel=parallel,.
-000414f0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-00041500: 656d 656e 745f 7061 7261 6d73 3d73 7461  ement_params=sta
-00041510: 7465 6d65 6e74 5f70 6172 616d 732c 0a20  tement_params,. 
-00041520: 2020 2020 2020 2020 2020 2065 7865 6375             execu
-00041530: 7465 5f61 733d 6578 6563 7574 655f 6173  te_as=execute_as
-00041540: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00041550: 7269 6374 3d73 7472 6963 742c 0a20 2020  rict=strict,.   
-00041560: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
-00041570: 636f 6465 5f64 6973 706c 6179 3d73 6f75  code_display=sou
-00041580: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
-00041590: 2c0a 2020 2020 2020 2020 2020 2020 2a2a  ,.            **
-000415a0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-000415b0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-000415c0: 2020 2020 7265 7475 726e 2073 6573 7369      return sessi
-000415d0: 6f6e 2e73 7072 6f63 2e72 6567 6973 7465  on.sproc.registe
-000415e0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
-000415f0: 756e 632c 0a20 2020 2020 2020 2020 2020  unc,.           
-00041600: 2072 6574 7572 6e5f 7479 7065 3d72 6574   return_type=ret
-00041610: 7572 6e5f 7479 7065 2c0a 2020 2020 2020  urn_type,.      
-00041620: 2020 2020 2020 696e 7075 745f 7479 7065        input_type
-00041630: 733d 696e 7075 745f 7479 7065 732c 0a20  s=input_types,. 
-00041640: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00041650: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00041660: 2020 6973 5f70 6572 6d61 6e65 6e74 3d69    is_permanent=i
-00041670: 735f 7065 726d 616e 656e 742c 0a20 2020  s_permanent,.   
-00041680: 2020 2020 2020 2020 2073 7461 6765 5f6c           stage_l
-00041690: 6f63 6174 696f 6e3d 7374 6167 655f 6c6f  ocation=stage_lo
-000416a0: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
-000416b0: 2020 2020 696d 706f 7274 733d 696d 706f      imports=impo
-000416c0: 7274 732c 0a20 2020 2020 2020 2020 2020  rts,.           
-000416d0: 2070 6163 6b61 6765 733d 7061 636b 6167   packages=packag
-000416e0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000416f0: 7265 706c 6163 653d 7265 706c 6163 652c  replace=replace,
-00041700: 0a20 2020 2020 2020 2020 2020 2069 665f  .            if_
-00041710: 6e6f 745f 6578 6973 7473 3d69 665f 6e6f  not_exists=if_no
-00041720: 745f 6578 6973 7473 2c0a 2020 2020 2020  t_exists,.      
-00041730: 2020 2020 2020 7061 7261 6c6c 656c 3d70        parallel=p
-00041740: 6172 616c 6c65 6c2c 0a20 2020 2020 2020  arallel,.       
-00041750: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
-00041760: 6172 616d 733d 7374 6174 656d 656e 745f  arams=statement_
-00041770: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00041780: 2020 2020 6578 6563 7574 655f 6173 3d65      execute_as=e
-00041790: 7865 6375 7465 5f61 732c 0a20 2020 2020  xecute_as,.     
-000417a0: 2020 2020 2020 2073 7472 6963 743d 7374         strict=st
-000417b0: 7269 6374 2c0a 2020 2020 2020 2020 2020  rict,.          
-000417c0: 2020 736f 7572 6365 5f63 6f64 655f 6469    source_code_di
-000417d0: 7370 6c61 793d 736f 7572 6365 5f63 6f64  splay=source_cod
-000417e0: 655f 6469 7370 6c61 792c 0a20 2020 2020  e_display,.     
-000417f0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-00041800: 0a20 2020 2020 2020 2029 0a0a 0a23 2041  .        )...# A
-00041810: 6464 2074 6865 7365 2061 6c69 6173 2066  dd these alias f
-00041820: 6f72 2075 7365 7220 636f 6465 206d 6967  or user code mig
-00041830: 7261 7469 6f6e 0a63 616c 6c5f 6275 696c  ration.call_buil
-00041840: 7469 6e20 3d20 6361 6c6c 5f66 756e 6374  tin = call_funct
-00041850: 696f 6e0a 636f 6c6c 6563 745f 7365 7420  ion.collect_set 
-00041860: 3d20 6172 7261 795f 756e 6971 7565 5f61  = array_unique_a
-00041870: 6767 0a62 7569 6c74 696e 203d 2066 756e  gg.builtin = fun
-00041880: 6374 696f 6e0a 636f 756e 7444 6973 7469  ction.countDisti
-00041890: 6e63 7420 3d20 636f 756e 745f 6469 7374  nct = count_dist
-000418a0: 696e 6374 0a73 7562 7374 7220 3d20 7375  inct.substr = su
-000418b0: 6273 7472 696e 670a 746f 5f76 6172 6368  bstring.to_varch
-000418c0: 6172 203d 2074 6f5f 6368 6172 0a65 7870  ar = to_char.exp
-000418d0: 7220 3d20 7371 6c5f 6578 7072 0a64 6174  r = sql_expr.dat
-000418e0: 655f 666f 726d 6174 203d 2074 6f5f 6461  e_format = to_da
-000418f0: 7465 0a6d 6f6e 6f74 6f6e 6963 616c 6c79  te.monotonically
-00041900: 5f69 6e63 7265 6173 696e 675f 6964 203d  _increasing_id =
-00041910: 2073 6571 380a 6672 6f6d 5f75 6e69 7874   seq8.from_unixt
-00041920: 696d 6520 3d20 746f 5f74 696d 6573 7461  ime = to_timesta
-00041930: 6d70 0a0a 0a64 6566 2075 6e69 785f 7469  mp...def unix_ti
-00041940: 6d65 7374 616d 7028 653a 2043 6f6c 756d  mestamp(e: Colum
-00041950: 6e4f 724e 616d 652c 2066 6d74 3a20 4f70  nOrName, fmt: Op
-00041960: 7469 6f6e 616c 5b22 436f 6c75 6d6e 225d  tional["Column"]
-00041970: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
-00041980: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00041990: 436f 6e76 6572 7473 2061 2074 696d 6573  Converts a times
-000419a0: 7461 6d70 206f 7220 6120 7469 6d65 7374  tamp or a timest
-000419b0: 616d 7020 7374 7269 6e67 2074 6f20 556e  amp string to Un
-000419c0: 6978 2074 696d 6520 7374 616d 7020 2869  ix time stamp (i
-000419d0: 6e20 7365 636f 6e64 7329 2e0a 0a20 2020  n seconds)...   
-000419e0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-000419f0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00041a00: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00041a10: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00041a20: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00041a30: 6528 5b5b 2232 3031 332d 3035 2d30 3854  e([["2013-05-08T
-00041a40: 3233 3a33 393a 3230 2e31 3233 2d30 373a  23:39:20.123-07:
-00041a50: 3030 225d 5d2c 2073 6368 656d 613d 5b22  00"]], schema=["
-00041a60: 7473 5f63 6f6c 225d 290a 2020 2020 2020  ts_col"]).      
-00041a70: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00041a80: 756e 6978 5f74 696d 6573 7461 6d70 2863  unix_timestamp(c
-00041a90: 6f6c 2822 7473 5f63 6f6c 2229 292e 616c  ol("ts_col")).al
-00041aa0: 6961 7328 2275 6e69 785f 7469 6d65 2229  ias("unix_time")
-00041ab0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-00041ac0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00041ad0: 0a20 2020 2020 2020 207c 2255 4e49 585f  .        |"UNIX_
-00041ae0: 5449 4d45 2220 207c 0a20 2020 2020 2020  TIME"  |.       
-00041af0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00041b00: 0a20 2020 2020 2020 207c 3133 3638 3035  .        |136805
-00041b10: 3633 3630 2020 207c 0a20 2020 2020 2020  6360   |.       
-00041b20: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00041b30: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00041b40: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00041b50: 2072 6574 7572 6e20 6461 7465 5f70 6172   return date_par
-00041b60: 7428 2265 706f 6368 5f73 6563 6f6e 6422  t("epoch_second"
-00041b70: 2c20 746f 5f74 696d 6573 7461 6d70 2865  , to_timestamp(e
-00041b80: 2c20 666d 7429 290a                      , fmt)).
+00031c90: 6c65 6374 2874 6f5f 6f62 6a65 6374 2863  lect(to_object(c
+00031ca0: 6f6c 2822 6122 2929 2e61 735f 2827 616e  ol("a")).as_('an
+00031cb0: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+00031cc0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00031cd0: 277b 5c5c 6e20 2022 6122 3a20 3130 2c5c  '{\\n  "a": 10,\
+00031ce0: 5c6e 2020 2262 223a 2032 305c 5c6e 7d27  \n  "b": 20\\n}'
+00031cf0: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
+00031d00: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00031d10: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00031d20: 2865 2c20 2274 6f5f 6f62 6a65 6374 2229  (e, "to_object")
+00031d30: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00031d40: 7469 6e28 2274 6f5f 6f62 6a65 6374 2229  tin("to_object")
+00031d50: 2863 290a 0a0a 6465 6620 746f 5f76 6172  (c)...def to_var
+00031d60: 6961 6e74 2865 3a20 436f 6c75 6d6e 4f72  iant(e: ColumnOr
+00031d70: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00031d80: 0a20 2020 2022 2222 436f 6e76 6572 7473  .    """Converts
+00031d90: 2061 6e79 2076 616c 7565 2074 6f20 6120   any value to a 
+00031da0: 5641 5249 414e 5420 7661 6c75 6520 6f72  VARIANT value or
+00031db0: 204e 554c 4c20 2869 6620 696e 7075 7420   NULL (if input 
+00031dc0: 6973 204e 554c 4c29 2e0a 0a20 2020 2045  is NULL)...    E
+00031dd0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00031de0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00031df0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00031e00: 616d 6528 5b31 2c20 322c 2033 2c20 345d  ame([1, 2, 3, 4]
+00031e10: 2c20 7363 6865 6d61 3d5b 2761 275d 290a  , schema=['a']).
+00031e20: 2020 2020 2020 2020 3e3e 3e20 6466 5f63          >>> df_c
+00031e30: 6f6e 7620 3d20 6466 2e73 656c 6563 7428  onv = df.select(
+00031e40: 746f 5f76 6172 6961 6e74 2863 6f6c 2822  to_variant(col("
+00031e50: 6122 2929 2e61 735f 2822 616e 7322 2929  a")).as_("ans"))
+00031e60: 0a20 2020 2020 2020 203e 3e3e 2064 665f  .        >>> df_
+00031e70: 636f 6e76 2e63 6f6c 6c65 6374 2829 0a20  conv.collect(). 
+00031e80: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00031e90: 2731 2729 2c20 526f 7728 414e 533d 2732  '1'), Row(ANS='2
+00031ea0: 2729 2c20 526f 7728 414e 533d 2733 2729  '), Row(ANS='3')
+00031eb0: 2c20 526f 7728 414e 533d 2734 2729 5d0a  , Row(ANS='4')].
+00031ec0: 0a20 2020 2020 2020 2041 6674 6572 2063  .        After c
+00031ed0: 6f6e 7665 7273 696f 6e20 7669 6120 746f  onversion via to
+00031ee0: 5f76 6172 6961 6e74 2c20 616e 6f74 6865  _variant, anothe
+00031ef0: 7220 7661 7269 616e 7420 6461 7461 6672  r variant datafr
+00031f00: 616d 6520 6361 6e20 6265 206d 6572 6765  ame can be merge
+00031f10: 642e 0a0a 2020 2020 2020 2020 3e3e 3e20  d...        >>> 
+00031f20: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00031f30: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+00031f40: 706f 7274 2056 6172 6961 6e74 5479 7065  port VariantType
+00031f50: 2c20 5374 7275 6374 4669 656c 642c 2053  , StructField, S
+00031f60: 7472 7563 7454 7970 650a 2020 2020 2020  tructType.      
+00031f70: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00031f80: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
+00031f90: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
+00031fa0: 203e 3e3e 2073 6368 656d 6120 3d20 5374   >>> schema = St
+00031fb0: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
+00031fc0: 4669 656c 6428 2261 222c 2056 6172 6961  Field("a", Varia
+00031fd0: 6e74 5479 7065 2829 295d 290a 2020 2020  ntType())]).    
+00031fe0: 2020 2020 3e3e 3e20 6466 5f6f 7468 6572      >>> df_other
+00031ff0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00032000: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
+00032010: 2861 3d31 3029 2c20 526f 7728 613d 2774  (a=10), Row(a='t
+00032020: 6573 7427 292c 2052 6f77 2861 3d7b 2761  est'), Row(a={'a
+00032030: 273a 2031 302c 2027 6227 3a20 3230 7d29  ': 10, 'b': 20})
+00032040: 2c20 526f 7728 613d 5b31 2c20 322c 2033  , Row(a=[1, 2, 3
+00032050: 5d29 5d2c 2073 6368 656d 613d 7363 6865  ])], schema=sche
+00032060: 6d61 290a 2020 2020 2020 2020 3e3e 3e20  ma).        >>> 
+00032070: 6466 5f63 6f6e 762e 756e 696f 6e28 6466  df_conv.union(df
+00032080: 5f6f 7468 6572 292e 7365 6c65 6374 2874  _other).select(t
+00032090: 7970 656f 6628 636f 6c28 2261 6e73 2229  ypeof(col("ans")
+000320a0: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+000320b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000320c0: 5b52 6f77 2841 4e53 3d27 494e 5445 4745  [Row(ANS='INTEGE
+000320d0: 5227 292c 2052 6f77 2841 4e53 3d27 494e  R'), Row(ANS='IN
+000320e0: 5445 4745 5227 292c 2052 6f77 2841 4e53  TEGER'), Row(ANS
+000320f0: 3d27 494e 5445 4745 5227 292c 2052 6f77  ='INTEGER'), Row
+00032100: 2841 4e53 3d27 494e 5445 4745 5227 292c  (ANS='INTEGER'),
+00032110: 2052 6f77 2841 4e53 3d27 494e 5445 4745   Row(ANS='INTEGE
+00032120: 5227 292c 2052 6f77 2841 4e53 3d27 5641  R'), Row(ANS='VA
+00032130: 5243 4841 5227 292c 2052 6f77 2841 4e53  RCHAR'), Row(ANS
+00032140: 3d27 4f42 4a45 4354 2729 2c20 526f 7728  ='OBJECT'), Row(
+00032150: 414e 533d 2741 5252 4159 2729 5d0a 2020  ANS='ARRAY')].  
+00032160: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00032170: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00032180: 2274 6f5f 7661 7269 616e 7422 290a 2020  "to_variant").  
+00032190: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000321a0: 2822 746f 5f76 6172 6961 6e74 2229 2863  ("to_variant")(c
+000321b0: 290a 0a0a 6465 6620 746f 5f78 6d6c 2865  )...def to_xml(e
+000321c0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+000321d0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000321e0: 2222 436f 6e76 6572 7473 2061 6e79 2056  ""Converts any V
+000321f0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+00032200: 6120 7374 7269 6e67 2063 6f6e 7461 696e  a string contain
+00032210: 696e 6720 7468 6520 584d 4c20 7265 7072  ing the XML repr
+00032220: 6573 656e 7461 7469 6f6e 206f 6620 7468  esentation of th
+00032230: 650a 2020 2020 7661 6c75 652e 2049 6620  e.    value. If 
+00032240: 7468 6520 696e 7075 7420 6973 204e 554c  the input is NUL
+00032250: 4c2c 2074 6865 2072 6573 756c 7420 6973  L, the result is
+00032260: 2061 6c73 6f20 4e55 4c4c 2e0a 0a20 2020   also NULL...   
+00032270: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00032280: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00032290: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+000322a0: 7970 6573 2069 6d70 6f72 7420 5661 7269  ypes import Vari
+000322b0: 616e 7454 7970 652c 2053 7472 7563 7446  antType, StructF
+000322c0: 6965 6c64 2c20 5374 7275 6374 5479 7065  ield, StructType
+000322d0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+000322e0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+000322f0: 7061 726b 2069 6d70 6f72 7420 526f 770a  park import Row.
+00032300: 2020 2020 2020 2020 3e3e 3e20 7363 6865          >>> sche
+00032310: 6d61 203d 2053 7472 7563 7454 7970 6528  ma = StructType(
+00032320: 5b53 7472 7563 7446 6965 6c64 2822 6122  [StructField("a"
+00032330: 2c20 5661 7269 616e 7454 7970 6528 2929  , VariantType())
+00032340: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00032350: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00032360: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
+00032370: 7728 613d 3130 292c 2052 6f77 2861 3d27  w(a=10), Row(a='
+00032380: 7465 7374 2729 2c20 526f 7728 613d 7b27  test'), Row(a={'
+00032390: 6127 3a20 3130 2c20 2762 273a 2032 307d  a': 10, 'b': 20}
+000323a0: 292c 2052 6f77 2861 3d5b 312c 2032 2c20  ), Row(a=[1, 2, 
+000323b0: 335d 295d 2c20 7363 6865 6d61 3d73 6368  3])], schema=sch
+000323c0: 656d 6129 0a20 2020 2020 2020 203e 3e3e  ema).        >>>
+000323d0: 2064 662e 7365 6c65 6374 2874 6f5f 786d   df.select(to_xm
+000323e0: 6c28 636f 6c28 2241 2229 292e 6173 5f28  l(col("A")).as_(
+000323f0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+00032400: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00032410: 4e53 3d27 3c53 6e6f 7766 6c61 6b65 4461  NS='<SnowflakeDa
+00032420: 7461 2074 7970 653d 2249 4e54 4547 4552  ta type="INTEGER
+00032430: 223e 3130 3c2f 536e 6f77 666c 616b 6544  ">10</SnowflakeD
+00032440: 6174 613e 2729 2c20 526f 7728 414e 533d  ata>'), Row(ANS=
+00032450: 273c 536e 6f77 666c 616b 6544 6174 6120  '<SnowflakeData 
+00032460: 7479 7065 3d22 5641 5243 4841 5222 3e74  type="VARCHAR">t
+00032470: 6573 743c 2f53 6e6f 7766 6c61 6b65 4461  est</SnowflakeDa
+00032480: 7461 3e27 292c 2052 6f77 2841 4e53 3d27  ta>'), Row(ANS='
+00032490: 3c53 6e6f 7766 6c61 6b65 4461 7461 2074  <SnowflakeData t
+000324a0: 7970 653d 224f 424a 4543 5422 3e3c 6120  ype="OBJECT"><a 
+000324b0: 7479 7065 3d22 494e 5445 4745 5222 3e31  type="INTEGER">1
+000324c0: 303c 2f61 3e3c 6220 7479 7065 3d22 494e  0</a><b type="IN
+000324d0: 5445 4745 5222 3e32 303c 2f62 3e3c 2f53  TEGER">20</b></S
+000324e0: 6e6f 7766 6c61 6b65 4461 7461 3e27 292c  nowflakeData>'),
+000324f0: 2052 6f77 2841 4e53 3d27 3c53 6e6f 7766   Row(ANS='<Snowf
+00032500: 6c61 6b65 4461 7461 2074 7970 653d 2241  lakeData type="A
+00032510: 5252 4159 223e 3c65 2074 7970 653d 2249  RRAY"><e type="I
+00032520: 4e54 4547 4552 223e 313c 2f65 3e3c 6520  NTEGER">1</e><e 
+00032530: 7479 7065 3d22 494e 5445 4745 5222 3e32  type="INTEGER">2
+00032540: 3c2f 653e 3c65 2074 7970 653d 2249 4e54  </e><e type="INT
+00032550: 4547 4552 223e 333c 2f65 3e3c 2f53 6e6f  EGER">3</e></Sno
+00032560: 7766 6c61 6b65 4461 7461 3e27 295d 0a20  wflakeData>')]. 
+00032570: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00032580: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00032590: 2022 746f 5f78 6d6c 2229 0a20 2020 2072   "to_xml").    r
+000325a0: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+000325b0: 6f5f 786d 6c22 2928 6329 0a0a 0a64 6566  o_xml")(c)...def
+000325c0: 2067 6574 5f69 676e 6f72 655f 6361 7365   get_ignore_case
+000325d0: 286f 626a 3a20 436f 6c75 6d6e 4f72 4e61  (obj: ColumnOrNa
+000325e0: 6d65 2c20 6669 656c 643a 2043 6f6c 756d  me, field: Colum
+000325f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00032600: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00032610: 4578 7472 6163 7473 2061 2066 6965 6c64  Extracts a field
+00032620: 2076 616c 7565 2066 726f 6d20 616e 206f   value from an o
+00032630: 626a 6563 742e 2052 6574 7572 6e73 204e  bject. Returns N
+00032640: 554c 4c20 6966 2065 6974 6865 7220 6f66  ULL if either of
+00032650: 2074 6865 2061 7267 756d 656e 7473 2069   the arguments i
+00032660: 7320 4e55 4c4c 2e0a 2020 2020 5468 6973  s NULL..    This
+00032670: 2066 756e 6374 696f 6e20 6973 2073 696d   function is sim
+00032680: 696c 6172 2074 6f20 3a6d 6574 683a 6067  ilar to :meth:`g
+00032690: 6574 6020 6275 7420 6170 706c 6965 7320  et` but applies 
+000326a0: 6361 7365 2d69 6e73 656e 7369 7469 7665  case-insensitive
+000326b0: 206d 6174 6368 696e 6720 746f 2066 6965   matching to fie
+000326c0: 6c64 206e 616d 6573 2e0a 0a20 2020 2045  ld names...    E
+000326d0: 7861 6d70 6c65 733a 3a0a 0a20 2020 2020  xamples::..     
+000326e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000326f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00032700: 7261 6d65 285b 7b22 6122 3a20 7b22 6161  rame([{"a": {"aa
+00032710: 223a 2031 2c20 2262 6222 3a20 322c 2022  ": 1, "bb": 2, "
+00032720: 6363 223a 2033 7d7d 5d29 0a20 2020 2020  cc": 3}}]).     
+00032730: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00032740: 2867 6574 5f69 676e 6f72 655f 6361 7365  (get_ignore_case
+00032750: 2864 665b 2261 225d 2c20 6c69 7428 2241  (df["a"], lit("A
+00032760: 4122 2929 2e61 6c69 6173 2822 6765 745f  A")).alias("get_
+00032770: 6967 6e6f 7265 5f63 6173 6522 2929 2e63  ignore_case")).c
+00032780: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00032790: 205b 526f 7728 4745 545f 4947 4e4f 5245   [Row(GET_IGNORE
+000327a0: 5f43 4153 453d 2731 2729 5d0a 2020 2020  _CASE='1')].    
+000327b0: 2222 220a 2020 2020 6331 203d 205f 746f  """.    c1 = _to
+000327c0: 5f63 6f6c 5f69 665f 7374 7228 6f62 6a2c  _col_if_str(obj,
+000327d0: 2022 6765 745f 6967 6e6f 7265 5f63 6173   "get_ignore_cas
+000327e0: 6522 290a 2020 2020 6332 203d 205f 746f  e").    c2 = _to
+000327f0: 5f63 6f6c 5f69 665f 7374 7228 6669 656c  _col_if_str(fiel
+00032800: 642c 2022 6765 745f 6967 6e6f 7265 5f63  d, "get_ignore_c
+00032810: 6173 6522 290a 2020 2020 7265 7475 726e  ase").    return
+00032820: 2062 7569 6c74 696e 2822 6765 745f 6967   builtin("get_ig
+00032830: 6e6f 7265 5f63 6173 6522 2928 6331 2c20  nore_case")(c1, 
+00032840: 6332 290a 0a0a 6465 6620 6f62 6a65 6374  c2)...def object
+00032850: 5f6b 6579 7328 6f62 6a3a 2043 6f6c 756d  _keys(obj: Colum
+00032860: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00032870: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00032880: 6e73 2061 6e20 6172 7261 7920 636f 6e74  ns an array cont
+00032890: 6169 6e69 6e67 2074 6865 206c 6973 7420  aining the list 
+000328a0: 6f66 206b 6579 7320 696e 2074 6865 2069  of keys in the i
+000328b0: 6e70 7574 206f 626a 6563 742e 0a0a 0a20  nput object.... 
+000328c0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+000328d0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+000328e0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+000328f0: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+00032900: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
+00032910: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+00032920: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
+00032930: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
+00032940: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
+00032950: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
+00032960: 2c20 6b2c 2076 2066 726f 6d20 220a 2020  , k, v from ".  
+00032970: 2020 2020 2020 2e2e 2e20 2020 2020 2276        ...     "v
+00032980: 616c 7565 7328 2761 6765 272c 2032 312c  alues('age', 21,
+00032990: 2027 7a69 7027 2c20 3231 3032 312c 2027   'zip', 21021, '
+000329a0: 6e61 6d65 272c 2027 4a6f 6527 2c20 2761  name', 'Joe', 'a
+000329b0: 6765 272c 2030 292c 220a 2020 2020 2020  ge', 0),".      
+000329c0: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
+000329d0: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
+000329e0: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
+000329f0: 7927 2c20 2761 6765 272c 2030 2920 6173  y', 'age', 0) as
+00032a00: 2054 2861 2c62 2c63 2c64 2c65 2c66 2c6b   T(a,b,c,d,e,f,k
+00032a10: 2c76 2922 0a20 2020 2020 2020 202e 2e2e  ,v)".        ...
+00032a20: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00032a30: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
+00032a40: 6b65 7973 2863 6f6c 2822 6f62 6a22 2929  keys(col("obj"))
+00032a50: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+00032a60: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00032a70: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20   -------------. 
+00032a80: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00032a90: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00032aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00032ab0: 2020 207c 5b20 2020 2020 2020 2020 207c     |[          |
+00032ac0: 0a20 2020 2020 2020 207c 2020 2261 6765  .        |  "age
+00032ad0: 222c 2020 207c 0a20 2020 2020 2020 207c  ",   |.        |
+00032ae0: 2020 226e 616d 6522 2c20 207c 0a20 2020    "name",  |.   
+00032af0: 2020 2020 207c 2020 227a 6970 2220 2020       |  "zip"   
+00032b00: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+00032b10: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00032b20: 207c 5b20 2020 2020 2020 2020 207c 0a20   |[          |. 
+00032b30: 2020 2020 2020 207c 2020 2261 6765 222c         |  "age",
+00032b40: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+00032b50: 226e 616d 6522 2c20 207c 0a20 2020 2020  "name",  |.     
+00032b60: 2020 207c 2020 227a 6970 2220 2020 207c     |  "zip"    |
+00032b70: 0a20 2020 2020 2020 207c 5d20 2020 2020  .        |]     
+00032b80: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00032b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00032ba0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00032bb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00032bc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00032bd0: 6f62 6a2c 2022 6f62 6a65 6374 5f6b 6579  obj, "object_key
+00032be0: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
+00032bf0: 7569 6c74 696e 2822 6f62 6a65 6374 5f6b  uiltin("object_k
+00032c00: 6579 7322 2928 6329 0a0a 0a64 6566 2078  eys")(c)...def x
+00032c10: 6d6c 6765 7428 0a20 2020 2078 6d6c 3a20  mlget(.    xml: 
+00032c20: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
+00032c30: 2020 7461 673a 2043 6f6c 756d 6e4f 724e    tag: ColumnOrN
+00032c40: 616d 652c 0a20 2020 2069 6e73 7461 6e63  ame,.    instanc
+00032c50: 655f 6e75 6d3a 2055 6e69 6f6e 5b43 6f6c  e_num: Union[Col
+00032c60: 756d 6e4f 724e 616d 652c 2069 6e74 5d20  umnOrName, int] 
+00032c70: 3d20 302c 0a29 202d 3e20 436f 6c75 6d6e  = 0,.) -> Column
+00032c80: 3a0a 2020 2020 2222 2245 7874 7261 6374  :.    """Extract
+00032c90: 7320 616e 2058 4d4c 2065 6c65 6d65 6e74  s an XML element
+00032ca0: 206f 626a 6563 7420 286f 6674 656e 2072   object (often r
+00032cb0: 6566 6572 7265 6420 746f 2061 7320 7369  eferred to as si
+00032cc0: 6d70 6c79 2061 2074 6167 2920 6672 6f6d  mply a tag) from
+00032cd0: 2061 2063 6f6e 7465 6e74 206f 6620 6f75   a content of ou
+00032ce0: 7465 720a 2020 2020 584d 4c20 656c 656d  ter.    XML elem
+00032cf0: 656e 7420 6f62 6a65 6374 2062 7920 7468  ent object by th
+00032d00: 6520 6e61 6d65 206f 6620 7468 6520 7461  e name of the ta
+00032d10: 6720 616e 6420 6974 7320 696e 7374 616e  g and its instan
+00032d20: 6365 206e 756d 6265 7220 2863 6f75 6e74  ce number (count
+00032d30: 696e 6720 6672 6f6d 2030 292e 0a0a 2020  ing from 0)...  
+00032d40: 2020 5468 6520 666f 6c6c 6f77 696e 6720    The following 
+00032d50: 6578 616d 706c 6520 7265 7475 726e 7320  example returns 
+00032d60: 7468 6520 6669 7273 7420 696e 6e65 7220  the first inner 
+00032d70: 6c65 7665 6c20 286c 6576 656c 3229 2066  level (level2) f
+00032d80: 726f 6d20 7468 6520 584d 4c20 6f62 6a65  rom the XML obje
+00032d90: 6374 2063 7265 6174 6564 2076 6961 2060  ct created via `
+00032da0: 7061 7273 655f 786d 6c60 2e0a 0a20 2020  parse_xml`...   
+00032db0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00032dc0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00032dd0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00032de0: 6672 616d 6528 5b27 3c6c 6576 656c 3120  frame(['<level1 
+00032df0: 6174 7472 313d 2261 223e 313c 6c65 7665  attr1="a">1<leve
+00032e00: 6c32 2061 7474 7232 3d22 6222 3e32 3c6c  l2 attr2="b">2<l
+00032e10: 6576 656c 333e 3361 3c2f 6c65 7665 6c33  evel3>3a</level3
+00032e20: 3e3c 6c65 7665 6c33 3e33 623c 2f6c 6576  ><level3>3b</lev
+00032e30: 656c 333e 3c2f 6c65 7665 6c32 3e3c 2f6c  el3></level2></l
+00032e40: 6576 656c 313e 275d 2c20 7363 6865 6d61  evel1>'], schema
+00032e50: 3d5b 2273 7472 225d 292e 7365 6c65 6374  =["str"]).select
+00032e60: 2870 6172 7365 5f78 6d6c 2822 7374 7222  (parse_xml("str"
+00032e70: 292e 6173 5f28 226f 626a 2229 290a 2020  ).as_("obj")).  
+00032e80: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+00032e90: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00032ea0: 526f 7728 4f42 4a3d 273c 6c65 7665 6c31  Row(OBJ='<level1
+00032eb0: 2061 7474 7231 3d22 6122 3e5c 5c6e 2020   attr1="a">\\n  
+00032ec0: 315c 5c6e 2020 3c6c 6576 656c 3220 6174  1\\n  <level2 at
+00032ed0: 7472 323d 2262 223e 5c5c 6e20 2020 2032  tr2="b">\\n    2
+00032ee0: 5c5c 6e20 2020 203c 6c65 7665 6c33 3e33  \\n    <level3>3
+00032ef0: 613c 2f6c 6576 656c 333e 5c5c 6e20 2020  a</level3>\\n   
+00032f00: 203c 6c65 7665 6c33 3e33 623c 2f6c 6576   <level3>3b</lev
+00032f10: 656c 333e 5c5c 6e20 203c 2f6c 6576 656c  el3>\\n  </level
+00032f20: 323e 5c5c 6e3c 2f6c 6576 656c 313e 2729  2>\\n</level1>')
+00032f30: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+00032f40: 2e73 656c 6563 7428 786d 6c67 6574 2822  .select(xmlget("
+00032f50: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
+00032f60: 3222 2929 2e61 735f 2822 616e 7322 2929  2")).as_("ans"))
+00032f70: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00032f80: 2020 205b 526f 7728 414e 533d 273c 6c65     [Row(ANS='<le
+00032f90: 7665 6c32 2061 7474 7232 3d22 6222 3e5c  vel2 attr2="b">\
+00032fa0: 5c6e 2020 325c 5c6e 2020 3c6c 6576 656c  \n  2\\n  <level
+00032fb0: 333e 3361 3c2f 6c65 7665 6c33 3e5c 5c6e  3>3a</level3>\\n
+00032fc0: 2020 3c6c 6576 656c 333e 3362 3c2f 6c65    <level3>3b</le
+00032fd0: 7665 6c33 3e5c 5c6e 3c2f 6c65 7665 6c32  vel3>\\n</level2
+00032fe0: 3e27 295d 0a0a 2020 2020 5768 656e 206d  >')]..    When m
+00032ff0: 756c 7469 706c 6520 7461 6773 2065 7869  ultiple tags exi
+00033000: 7374 2061 7420 6120 6c65 7665 6c2c 2069  st at a level, i
+00033010: 6e73 7461 6e63 655f 6e75 6d20 6361 6e20  nstance_num can 
+00033020: 6265 2075 7365 6420 746f 2064 6973 7469  be used to disti
+00033030: 6e67 7569 7368 2077 6869 6368 2065 6c65  nguish which ele
+00033040: 6d65 6e74 2074 6f20 7265 7475 726e 2e0a  ment to return..
+00033050: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00033060: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00033070: 656c 6563 7428 786d 6c67 6574 2878 6d6c  elect(xmlget(xml
+00033080: 6765 7428 226f 626a 222c 206c 6974 2822  get("obj", lit("
+00033090: 6c65 7665 6c32 2229 292c 206c 6974 2822  level2")), lit("
+000330a0: 6c65 7665 6c33 2229 2c20 6c69 7428 3029  level3"), lit(0)
+000330b0: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+000330c0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000330d0: 5b52 6f77 2841 4e53 3d27 3c6c 6576 656c  [Row(ANS='<level
+000330e0: 333e 3361 3c2f 6c65 7665 6c33 3e27 295d  3>3a</level3>')]
+000330f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00033100: 7365 6c65 6374 2878 6d6c 6765 7428 786d  select(xmlget(xm
+00033110: 6c67 6574 2822 6f62 6a22 2c20 6c69 7428  lget("obj", lit(
+00033120: 226c 6576 656c 3222 2929 2c20 6c69 7428  "level2")), lit(
+00033130: 226c 6576 656c 3322 292c 206c 6974 2831  "level3"), lit(1
+00033140: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
+00033150: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00033160: 205b 526f 7728 414e 533d 273c 6c65 7665   [Row(ANS='<leve
+00033170: 6c33 3e33 623c 2f6c 6576 656c 333e 2729  l3>3b</level3>')
+00033180: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
+00033190: 2e73 656c 6563 7428 786d 6c67 6574 2822  .select(xmlget("
+000331a0: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
+000331b0: 3222 292c 206c 6974 2835 2929 2e61 735f  2"), lit(5)).as_
+000331c0: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
+000331d0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+000331e0: 414e 533d 4e6f 6e65 295d 0a0a 2020 2020  ANS=None)]..    
+000331f0: 496e 206f 7264 6572 2074 6f20 6765 7420  In order to get 
+00033200: 7468 6520 7461 676e 616d 652c 2074 6865  the tagname, the
+00033210: 2076 616c 7565 206f 6620 616e 2061 7474   value of an att
+00033220: 7269 6275 7465 206f 7220 7468 6520 636f  ribute or the co
+00033230: 6e74 656e 7420 7769 7468 696e 2061 2074  ntent within a t
+00033240: 6167 2074 6865 2060 6765 7460 2066 756e  ag the `get` fun
+00033250: 6374 696f 6e20 6361 6e20 6265 2075 7365  ction can be use
+00033260: 642e 0a0a 2020 2020 4578 616d 706c 653a  d...    Example:
+00033270: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00033280: 662e 7365 6c65 6374 2867 6574 2878 6d6c  f.select(get(xml
+00033290: 6765 7428 226f 626a 222c 206c 6974 2822  get("obj", lit("
+000332a0: 6c65 7665 6c32 2229 292c 206c 6974 2822  level2")), lit("
+000332b0: 4022 2929 2e61 735f 2822 616e 7322 2929  @")).as_("ans"))
+000332c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000332d0: 2020 205b 526f 7728 414e 533d 2722 6c65     [Row(ANS='"le
+000332e0: 7665 6c32 2227 295d 0a20 2020 2020 2020  vel2"')].       
+000332f0: 203e 3e3e 2064 662e 7365 6c65 6374 2867   >>> df.select(g
+00033300: 6574 2878 6d6c 6765 7428 226f 626a 222c  et(xmlget("obj",
+00033310: 206c 6974 2822 6c65 7665 6c32 2229 292c   lit("level2")),
+00033320: 206c 6974 2822 2422 2929 2e61 735f 2822   lit("$")).as_("
+00033330: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
+00033340: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
+00033350: 533d 275b 5c5c 6e20 2032 2c5c 5c6e 2020  S='[\\n  2,\\n  
+00033360: 7b5c 5c6e 2020 2020 2224 223a 2022 3361  {\\n    "$": "3a
+00033370: 222c 5c5c 6e20 2020 2022 4022 3a20 226c  ",\\n    "@": "l
+00033380: 6576 656c 3322 5c5c 6e20 207d 2c5c 5c6e  evel3"\\n  },\\n
+00033390: 2020 7b5c 5c6e 2020 2020 2224 223a 2022    {\\n    "$": "
+000333a0: 3362 222c 5c5c 6e20 2020 2022 4022 3a20  3b",\\n    "@": 
+000333b0: 226c 6576 656c 3322 5c5c 6e20 207d 5c5c  "level3"\\n  }\\
+000333c0: 6e5d 2729 5d0a 2020 2020 2020 2020 3e3e  n]')].        >>
+000333d0: 3e20 6466 2e73 656c 6563 7428 6765 7428  > df.select(get(
+000333e0: 786d 6c67 6574 2878 6d6c 6765 7428 226f  xmlget(xmlget("o
+000333f0: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
+00033400: 2229 292c 206c 6974 2822 6c65 7665 6c33  ")), lit("level3
+00033410: 2229 292c 206c 6974 2822 2422 2929 2e61  ")), lit("$")).a
+00033420: 735f 2822 616e 7322 2929 2e63 6f6c 6c65  s_("ans")).colle
+00033430: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00033440: 7728 414e 533d 2722 3361 2227 295d 0a20  w(ANS='"3a"')]. 
+00033450: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00033460: 6c65 6374 2867 6574 2878 6d6c 6765 7428  lect(get(xmlget(
+00033470: 226f 626a 222c 206c 6974 2822 6c65 7665  "obj", lit("leve
+00033480: 6c32 2229 292c 206c 6974 2822 4061 7474  l2")), lit("@att
+00033490: 7232 2229 292e 6173 5f28 2261 6e73 2229  r2")).as_("ans")
+000334a0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000334b0: 2020 2020 5b52 6f77 2841 4e53 3d27 2262      [Row(ANS='"b
+000334c0: 2227 295d 0a20 2020 2022 2222 0a20 2020  "')].    """.   
+000334d0: 2063 3120 3d20 5f74 6f5f 636f 6c5f 6966   c1 = _to_col_if
+000334e0: 5f73 7472 2878 6d6c 2c20 2278 6d6c 6765  _str(xml, "xmlge
+000334f0: 7422 290a 2020 2020 6332 203d 205f 746f  t").    c2 = _to
+00033500: 5f63 6f6c 5f69 665f 7374 7228 7461 672c  _col_if_str(tag,
+00033510: 2022 786d 6c67 6574 2229 0a20 2020 2063   "xmlget").    c
+00033520: 3320 3d20 280a 2020 2020 2020 2020 696e  3 = (.        in
+00033530: 7374 616e 6365 5f6e 756d 0a20 2020 2020  stance_num.     
+00033540: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00033550: 2869 6e73 7461 6e63 655f 6e75 6d2c 2069  (instance_num, i
+00033560: 6e74 290a 2020 2020 2020 2020 656c 7365  nt).        else
+00033570: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00033580: 696e 7374 616e 6365 5f6e 756d 2c20 2278  instance_num, "x
+00033590: 6d6c 6765 7422 290a 2020 2020 290a 2020  mlget").    ).  
+000335a0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000335b0: 2822 786d 6c67 6574 2229 2863 312c 2063  ("xmlget")(c1, c
+000335c0: 322c 2063 3329 0a0a 0a64 6566 2067 6574  2, c3)...def get
+000335d0: 5f70 6174 6828 636f 6c3a 2043 6f6c 756d  _path(col: Colum
+000335e0: 6e4f 724e 616d 652c 2070 6174 683a 2043  nOrName, path: C
+000335f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00033600: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00033610: 2020 2020 4578 7472 6163 7473 2061 2076      Extracts a v
+00033620: 616c 7565 2066 726f 6d20 7365 6d69 2d73  alue from semi-s
+00033630: 7472 7563 7475 7265 6420 6461 7461 2075  tructured data u
+00033640: 7369 6e67 2061 2070 6174 6820 6e61 6d65  sing a path name
+00033650: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
+00033660: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00033670: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00033680: 7465 5f64 6174 6166 7261 6d65 285b 7b22  te_dataframe([{"
+00033690: 6122 3a20 7b22 6161 223a 207b 2264 6422  a": {"aa": {"dd"
+000336a0: 3a20 347d 2c20 2262 6222 3a20 322c 2022  : 4}, "bb": 2, "
+000336b0: 6363 223a 2033 7d7d 5d29 0a20 2020 2020  cc": 3}}]).     
+000336c0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000336d0: 2867 6574 5f70 6174 6828 6466 5b22 6122  (get_path(df["a"
+000336e0: 5d2c 206c 6974 2822 6161 2e64 6422 2929  ], lit("aa.dd"))
+000336f0: 2e61 6c69 6173 2822 6765 745f 7061 7468  .alias("get_path
+00033700: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00033710: 2020 2020 2020 5b52 6f77 2847 4554 5f50        [Row(GET_P
+00033720: 4154 483d 2734 2729 5d0a 2020 2020 2222  ATH='4')].    ""
+00033730: 220a 2020 2020 6331 203d 205f 746f 5f63  ".    c1 = _to_c
+00033740: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+00033750: 6765 745f 7061 7468 2229 0a20 2020 2063  get_path").    c
+00033760: 3220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  2 = _to_col_if_s
+00033770: 7472 2870 6174 682c 2022 6765 745f 7061  tr(path, "get_pa
+00033780: 7468 2229 0a20 2020 2072 6574 7572 6e20  th").    return 
+00033790: 6275 696c 7469 6e28 2267 6574 5f70 6174  builtin("get_pat
+000337a0: 6822 2928 6331 2c20 6332 290a 0a0a 6465  h")(c1, c2)...de
+000337b0: 6620 6765 7428 636f 6c31 3a20 556e 696f  f get(col1: Unio
+000337c0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+000337d0: 696e 745d 2c20 636f 6c32 3a20 556e 696f  int], col2: Unio
+000337e0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+000337f0: 696e 745d 2920 2d3e 2043 6f6c 756d 6e3a  int]) -> Column:
+00033800: 0a20 2020 2022 2222 4578 7472 6163 7473  .    """Extracts
+00033810: 2061 2076 616c 7565 2066 726f 6d20 616e   a value from an
+00033820: 206f 626a 6563 7420 6f72 2061 7272 6179   object or array
+00033830: 3b20 7265 7475 726e 7320 4e55 4c4c 2069  ; returns NULL i
+00033840: 6620 6569 7468 6572 206f 6620 7468 6520  f either of the 
+00033850: 6172 6775 6d65 6e74 7320 6973 204e 554c  arguments is NUL
+00033860: 4c2e 0a0a 2020 2020 4578 616d 706c 653a  L...    Example:
+00033870: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
+00033880: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00033890: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
+000338a0: 2069 6d70 6f72 7420 6c69 740a 2020 2020   import lit.    
+000338b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000338c0: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+000338d0: 7261 6d65 285b 287b 2261 223a 2031 2e30  rame([({"a": 1.0
+000338e0: 2c20 2262 223a 2032 2e30 7d2c 205b 312c  , "b": 2.0}, [1,
+000338f0: 2032 2c20 335d 2c29 2c20 287b 7d2c 205b   2, 3],), ({}, [
+00033900: 5d2c 295d 2c20 5b22 6d61 7022 2c20 226c  ],)], ["map", "l
+00033910: 6973 7422 5d29 0a20 2020 2020 2020 203e  ist"]).        >
+00033920: 3e3e 2064 662e 7365 6c65 6374 2867 6574  >> df.select(get
+00033930: 2864 662e 6c69 7374 2c20 3129 2e61 735f  (df.list, 1).as_
+00033940: 2822 6964 7831 2229 292e 736f 7274 2863  ("idx1")).sort(c
+00033950: 6f6c 2822 6964 7831 2229 292e 7368 6f77  ol("idx1")).show
+00033960: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00033970: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00033980: 4944 5831 2220 207c 0a20 2020 2020 2020  IDX1"  |.       
+00033990: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+000339a0: 2020 2020 7c4e 554c 4c20 2020 207c 0a20      |NULL    |. 
+000339b0: 2020 2020 2020 207c 3220 2020 2020 2020         |2       
+000339c0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000339d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+000339e0: 414e 4b4c 494e 453e 0a0a 2020 2020 2020  ANKLINE>..      
+000339f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00033a00: 6765 7428 6466 2e6d 6170 2c20 6c69 7428  get(df.map, lit(
+00033a10: 2261 2229 292e 6173 5f28 2267 6574 5f61  "a")).as_("get_a
+00033a20: 2229 292e 736f 7274 2863 6f6c 2822 6765  ")).sort(col("ge
+00033a30: 745f 6122 2929 2e73 686f 7728 290a 2020  t_a")).show().  
+00033a40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00033a50: 2d0a 2020 2020 2020 2020 7c22 4745 545f  -.        |"GET_
+00033a60: 4122 2020 7c0a 2020 2020 2020 2020 2d2d  A"  |.        --
+00033a70: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00033a80: 2020 7c4e 554c 4c20 2020 2020 7c0a 2020    |NULL     |.  
+00033a90: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
+00033aa0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00033ab0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00033ac0: 4c41 4e4b 4c49 4e45 3e22 2222 0a20 2020  LANKLINE>""".   
+00033ad0: 2063 3120 3d20 5f74 6f5f 636f 6c5f 6966   c1 = _to_col_if
+00033ae0: 5f73 7472 5f6f 725f 696e 7428 636f 6c31  _str_or_int(col1
+00033af0: 2c20 2267 6574 2229 0a20 2020 2063 3220  , "get").    c2 
+00033b00: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00033b10: 5f6f 725f 696e 7428 636f 6c32 2c20 2267  _or_int(col2, "g
+00033b20: 6574 2229 0a20 2020 2072 6574 7572 6e20  et").    return 
+00033b30: 6275 696c 7469 6e28 2267 6574 2229 2863  builtin("get")(c
+00033b40: 312c 2063 3229 0a0a 0a65 6c65 6d65 6e74  1, c2)...element
+00033b50: 5f61 7420 3d20 6765 740a 0a0a 6465 6620  _at = get...def 
+00033b60: 7768 656e 2863 6f6e 6469 7469 6f6e 3a20  when(condition: 
+00033b70: 436f 6c75 6d6e 4f72 5371 6c45 7870 722c  ColumnOrSqlExpr,
+00033b80: 2076 616c 7565 3a20 436f 6c75 6d6e 4f72   value: ColumnOr
+00033b90: 4c69 7465 7261 6c29 202d 3e20 4361 7365  Literal) -> Case
+00033ba0: 4578 7072 3a0a 2020 2020 2222 2257 6f72  Expr:.    """Wor
+00033bb0: 6b73 206c 696b 6520 6120 6361 7363 6164  ks like a cascad
+00033bc0: 696e 6720 6966 2d74 6865 6e2d 656c 7365  ing if-then-else
+00033bd0: 2073 7461 7465 6d65 6e74 2e0a 2020 2020   statement..    
+00033be0: 4120 7365 7269 6573 206f 6620 636f 6e64  A series of cond
+00033bf0: 6974 696f 6e73 2061 7265 2065 7661 6c75  itions are evalu
+00033c00: 6174 6564 2069 6e20 7365 7175 656e 6365  ated in sequence
+00033c10: 2e0a 2020 2020 5768 656e 2061 2063 6f6e  ..    When a con
+00033c20: 6469 7469 6f6e 2065 7661 6c75 6174 6573  dition evaluates
+00033c30: 2074 6f20 5452 5545 2c20 7468 6520 6576   to TRUE, the ev
+00033c40: 616c 7561 7469 6f6e 2073 746f 7073 2061  aluation stops a
+00033c50: 6e64 2074 6865 2061 7373 6f63 6961 7465  nd the associate
+00033c60: 640a 2020 2020 7265 7375 6c74 2028 6166  d.    result (af
+00033c70: 7465 7220 5448 454e 2920 6973 2072 6574  ter THEN) is ret
+00033c80: 7572 6e65 642e 2049 6620 6e6f 6e65 206f  urned. If none o
+00033c90: 6620 7468 6520 636f 6e64 6974 696f 6e73  f the conditions
+00033ca0: 2065 7661 6c75 6174 6520 746f 2054 5255   evaluate to TRU
+00033cb0: 452c 0a20 2020 2074 6865 6e20 7468 6520  E,.    then the 
+00033cc0: 7265 7375 6c74 2061 6674 6572 2074 6865  result after the
+00033cd0: 206f 7074 696f 6e61 6c20 4f54 4845 5257   optional OTHERW
+00033ce0: 4953 4520 6973 2072 6574 7572 6e65 642c  ISE is returned,
+00033cf0: 2069 6620 7072 6573 656e 743b 0a20 2020   if present;.   
+00033d00: 206f 7468 6572 7769 7365 204e 554c 4c20   otherwise NULL 
+00033d10: 6973 2072 6574 7572 6e65 642e 0a0a 2020  is returned...  
+00033d20: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+00033d30: 636f 6e64 6974 696f 6e3a 2041 203a 636c  condition: A :cl
+00033d40: 6173 733a 6043 6f6c 756d 6e60 2065 7870  ass:`Column` exp
+00033d50: 7265 7373 696f 6e20 6f72 2053 514c 2074  ression or SQL t
+00033d60: 6578 7420 7265 7072 6573 656e 7469 6e67  ext representing
+00033d70: 2074 6865 2073 7065 6369 6669 6564 2063   the specified c
+00033d80: 6f6e 6469 7469 6f6e 2e0a 2020 2020 2020  ondition..      
+00033d90: 2020 7661 6c75 653a 2041 203a 636c 6173    value: A :clas
+00033da0: 733a 6043 6f6c 756d 6e60 2065 7870 7265  s:`Column` expre
+00033db0: 7373 696f 6e20 6f72 2061 206c 6974 6572  ssion or a liter
+00033dc0: 616c 2076 616c 7565 2c20 7768 6963 6820  al value, which 
+00033dd0: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+00033de0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00033df0: 6060 636f 6e64 6974 696f 6e60 6020 6973  ``condition`` is
+00033e00: 2074 7275 652e 0a0a 2020 2020 4578 616d   true...    Exam
+00033e10: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00033e20: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00033e30: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00033e40: 285b 312c 204e 6f6e 652c 2032 2c20 332c  ([1, None, 2, 3,
+00033e50: 204e 6f6e 652c 2035 2c20 365d 2c20 7363   None, 5, 6], sc
+00033e60: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00033e70: 2020 2020 3e3e 3e20 6466 2e63 6f6c 6c65      >>> df.colle
+00033e80: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00033e90: 7728 413d 3129 2c20 526f 7728 413d 4e6f  w(A=1), Row(A=No
+00033ea0: 6e65 292c 2052 6f77 2841 3d32 292c 2052  ne), Row(A=2), R
+00033eb0: 6f77 2841 3d33 292c 2052 6f77 2841 3d4e  ow(A=3), Row(A=N
+00033ec0: 6f6e 6529 2c20 526f 7728 413d 3529 2c20  one), Row(A=5), 
+00033ed0: 526f 7728 413d 3629 5d0a 2020 2020 2020  Row(A=6)].      
+00033ee0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00033ef0: 7768 656e 2863 6f6c 2822 6122 2920 2520  when(col("a") % 
+00033f00: 3220 3d3d 2030 2c20 6c69 7428 2265 7665  2 == 0, lit("eve
+00033f10: 6e22 2929 2e61 735f 2822 616e 7322 2929  n")).as_("ans"))
+00033f20: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00033f30: 2020 205b 526f 7728 414e 533d 4e6f 6e65     [Row(ANS=None
+00033f40: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
+00033f50: 2c20 526f 7728 414e 533d 2765 7665 6e27  , Row(ANS='even'
+00033f60: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
+00033f70: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
+00033f80: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+00033f90: 526f 7728 414e 533d 2765 7665 6e27 295d  Row(ANS='even')]
+00033fa0: 0a0a 2020 2020 4d75 6c74 6970 6c65 2077  ..    Multiple w
+00033fb0: 6865 6e20 7374 6174 656d 656e 7473 2063  hen statements c
+00033fc0: 616e 2062 6520 6368 616e 6765 6420 616e  an be changed an
+00033fd0: 6420 606f 7468 6572 7769 7365 602f 6065  d `otherwise`/`e
+00033fe0: 6c73 655f 6020 7573 6564 2074 6f20 6372  lse_` used to cr
+00033ff0: 6561 7465 2065 7870 7265 7373 696f 6e73  eate expressions
+00034000: 2073 696d 696c 6172 2074 6f20 6060 4341   similar to ``CA
+00034010: 5345 2057 4845 4e20 2e2e 2e20 454c 5345  SE WHEN ... ELSE
+00034020: 202e 2e2e 2045 4e44 6060 2069 6e20 5351   ... END`` in SQ
+00034030: 4c2e 0a0a 2020 2020 4578 616d 706c 653a  L...    Example:
+00034040: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00034050: 662e 7365 6c65 6374 2877 6865 6e28 636f  f.select(when(co
+00034060: 6c28 2261 2229 2025 2032 203d 3d20 302c  l("a") % 2 == 0,
+00034070: 206c 6974 2822 6576 656e 2229 292e 7768   lit("even")).wh
+00034080: 656e 2863 6f6c 2822 6122 2920 2520 3220  en(col("a") % 2 
+00034090: 3d3d 2031 2c20 6c69 7428 226f 6464 2229  == 1, lit("odd")
+000340a0: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+000340b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000340c0: 5b52 6f77 2841 4e53 3d27 6f64 6427 292c  [Row(ANS='odd'),
+000340d0: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+000340e0: 526f 7728 414e 533d 2765 7665 6e27 292c  Row(ANS='even'),
+000340f0: 2052 6f77 2841 4e53 3d27 6f64 6427 292c   Row(ANS='odd'),
+00034100: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+00034110: 526f 7728 414e 533d 276f 6464 2729 2c20  Row(ANS='odd'), 
+00034120: 526f 7728 414e 533d 2765 7665 6e27 295d  Row(ANS='even')]
+00034130: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00034140: 7365 6c65 6374 2877 6865 6e28 636f 6c28  select(when(col(
+00034150: 2261 2229 2025 2032 203d 3d20 302c 206c  "a") % 2 == 0, l
+00034160: 6974 2822 6576 656e 2229 292e 7768 656e  it("even")).when
+00034170: 2863 6f6c 2822 6122 2920 2520 3220 3d3d  (col("a") % 2 ==
+00034180: 2031 2c20 6c69 7428 226f 6464 2229 292e   1, lit("odd")).
+00034190: 6f74 6865 7277 6973 6528 6c69 7428 2275  otherwise(lit("u
+000341a0: 6e6b 6e6f 776e 2229 292e 6173 5f28 2261  nknown")).as_("a
+000341b0: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
+000341c0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+000341d0: 3d27 6f64 6427 292c 2052 6f77 2841 4e53  ='odd'), Row(ANS
+000341e0: 3d27 756e 6b6e 6f77 6e27 292c 2052 6f77  ='unknown'), Row
+000341f0: 2841 4e53 3d27 6576 656e 2729 2c20 526f  (ANS='even'), Ro
+00034200: 7728 414e 533d 276f 6464 2729 2c20 526f  w(ANS='odd'), Ro
+00034210: 7728 414e 533d 2775 6e6b 6e6f 776e 2729  w(ANS='unknown')
+00034220: 2c20 526f 7728 414e 533d 276f 6464 2729  , Row(ANS='odd')
+00034230: 2c20 526f 7728 414e 533d 2765 7665 6e27  , Row(ANS='even'
+00034240: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+00034250: 6574 7572 6e20 4361 7365 4578 7072 280a  eturn CaseExpr(.
+00034260: 2020 2020 2020 2020 4361 7365 5768 656e          CaseWhen
+00034270: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+00034280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034290: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000342a0: 2020 2020 2020 5f74 6f5f 636f 6c5f 6966        _to_col_if
+000342b0: 5f73 716c 5f65 7870 7228 636f 6e64 6974  _sql_expr(condit
+000342c0: 696f 6e2c 2022 7768 656e 2229 2e5f 6578  ion, "when")._ex
+000342d0: 7072 6573 7369 6f6e 2c0a 2020 2020 2020  pression,.      
+000342e0: 2020 2020 2020 2020 2020 2020 2020 436f                Co
+000342f0: 6c75 6d6e 2e5f 746f 5f65 7870 7228 7661  lumn._to_expr(va
+00034300: 6c75 6529 2c0a 2020 2020 2020 2020 2020  lue),.          
+00034310: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00034320: 2020 2020 5d0a 2020 2020 2020 2020 290a      ].        ).
+00034330: 2020 2020 290a 0a0a 6465 6620 6966 6628      )...def iff(
+00034340: 0a20 2020 2063 6f6e 6469 7469 6f6e 3a20  .    condition: 
+00034350: 436f 6c75 6d6e 4f72 5371 6c45 7870 722c  ColumnOrSqlExpr,
+00034360: 0a20 2020 2065 7870 7231 3a20 436f 6c75  .    expr1: Colu
+00034370: 6d6e 4f72 4c69 7465 7261 6c2c 0a20 2020  mnOrLiteral,.   
+00034380: 2065 7870 7232 3a20 436f 6c75 6d6e 4f72   expr2: ColumnOr
+00034390: 4c69 7465 7261 6c2c 0a29 202d 3e20 436f  Literal,.) -> Co
+000343a0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+000343b0: 2020 5265 7475 726e 7320 6f6e 6520 6f66    Returns one of
+000343c0: 2074 776f 2073 7065 6369 6669 6564 2065   two specified e
+000343d0: 7870 7265 7373 696f 6e73 2c20 6465 7065  xpressions, depe
+000343e0: 6e64 696e 6720 6f6e 2061 2063 6f6e 6469  nding on a condi
+000343f0: 7469 6f6e 2e0a 2020 2020 5468 6973 2069  tion..    This i
+00034400: 7320 6571 7569 7661 6c65 6e74 2074 6f20  s equivalent to 
+00034410: 616e 2060 6069 662d 7468 656e 2d65 6c73  an ``if-then-els
+00034420: 6560 6020 6578 7072 6573 7369 6f6e 2e0a  e`` expression..
+00034430: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00034440: 2020 2063 6f6e 6469 7469 6f6e 3a20 4120     condition: A 
+00034450: 3a63 6c61 7373 3a60 436f 6c75 6d6e 6020  :class:`Column` 
+00034460: 6578 7072 6573 7369 6f6e 206f 7220 5351  expression or SQ
+00034470: 4c20 7465 7874 2072 6570 7265 7365 6e74  L text represent
+00034480: 696e 6720 7468 6520 7370 6563 6966 6965  ing the specifie
+00034490: 6420 636f 6e64 6974 696f 6e2e 0a20 2020  d condition..   
+000344a0: 2020 2020 2065 7870 7231 3a20 4120 3a63       expr1: A :c
+000344b0: 6c61 7373 3a60 436f 6c75 6d6e 6020 6578  lass:`Column` ex
+000344c0: 7072 6573 7369 6f6e 206f 7220 6120 6c69  pression or a li
+000344d0: 7465 7261 6c20 7661 6c75 652c 2077 6869  teral value, whi
+000344e0: 6368 2077 696c 6c20 6265 2072 6574 7572  ch will be retur
+000344f0: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+00034500: 6966 2060 6063 6f6e 6469 7469 6f6e 6060  if ``condition``
+00034510: 2069 7320 7472 7565 2e0a 2020 2020 2020   is true..      
+00034520: 2020 6578 7072 323a 2041 203a 636c 6173    expr2: A :clas
+00034530: 733a 6043 6f6c 756d 6e60 2065 7870 7265  s:`Column` expre
+00034540: 7373 696f 6e20 6f72 2061 206c 6974 6572  ssion or a liter
+00034550: 616c 2076 616c 7565 2c20 7768 6963 6820  al value, which 
+00034560: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+00034570: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00034580: 6060 636f 6e64 6974 696f 6e60 6020 6973  ``condition`` is
+00034590: 2066 616c 7365 2e0a 0a20 2020 2045 7861   false...    Exa
+000345a0: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
+000345b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000345c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000345d0: 6d65 285b 5472 7565 2c20 4661 6c73 652c  me([True, False,
+000345e0: 204e 6f6e 655d 2c20 7363 6865 6d61 3d5b   None], schema=[
+000345f0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00034600: 3e20 6466 2e73 656c 6563 7428 6966 6628  > df.select(iff(
+00034610: 6466 5b22 6122 5d2c 206c 6974 2822 7472  df["a"], lit("tr
+00034620: 7565 2229 2c20 6c69 7428 2266 616c 7365  ue"), lit("false
+00034630: 2229 292e 616c 6961 7328 2269 6666 2229  ")).alias("iff")
+00034640: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00034650: 2020 2020 5b52 6f77 2849 4646 3d27 7472      [Row(IFF='tr
+00034660: 7565 2729 2c20 526f 7728 4946 463d 2766  ue'), Row(IFF='f
+00034670: 616c 7365 2729 2c20 526f 7728 4946 463d  alse'), Row(IFF=
+00034680: 2766 616c 7365 2729 5d0a 2020 2020 2222  'false')].    ""
+00034690: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
+000346a0: 6c74 696e 2822 6966 6622 2928 5f74 6f5f  ltin("iff")(_to_
+000346b0: 636f 6c5f 6966 5f73 716c 5f65 7870 7228  col_if_sql_expr(
+000346c0: 636f 6e64 6974 696f 6e2c 2022 6966 6622  condition, "iff"
+000346d0: 292c 2065 7870 7231 2c20 6578 7072 3229  ), expr1, expr2)
+000346e0: 0a0a 0a64 6566 2069 6e5f 280a 2020 2020  ...def in_(.    
+000346f0: 636f 6c73 3a20 4c69 7374 5b43 6f6c 756d  cols: List[Colum
+00034700: 6e4f 724e 616d 655d 2c0a 2020 2020 2a76  nOrName],.    *v
+00034710: 616c 733a 2055 6e69 6f6e 5b22 736e 6f77  als: Union["snow
+00034720: 666c 616b 652e 736e 6f77 7061 726b 2e44  flake.snowpark.D
+00034730: 6174 6146 7261 6d65 222c 204c 6974 6572  ataFrame", Liter
+00034740: 616c 5479 7065 2c20 4974 6572 6162 6c65  alType, Iterable
+00034750: 5b4c 6974 6572 616c 5479 7065 5d5d 2c0a  [LiteralType]],.
+00034760: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00034770: 2022 2222 5265 7475 726e 7320 6120 636f   """Returns a co
+00034780: 6e64 6974 696f 6e61 6c20 6578 7072 6573  nditional expres
+00034790: 7369 6f6e 2074 6861 7420 796f 7520 6361  sion that you ca
+000347a0: 6e20 7061 7373 2074 6f20 7468 6520 6669  n pass to the fi
+000347b0: 6c74 6572 206f 7220 7768 6572 6520 6d65  lter or where me
+000347c0: 7468 6f64 7320 746f 0a20 2020 2070 6572  thods to.    per
+000347d0: 666f 726d 2074 6865 2065 7175 6976 616c  form the equival
+000347e0: 656e 7420 6f66 2061 2057 4845 5245 202e  ent of a WHERE .
+000347f0: 2e2e 2049 4e20 7175 6572 7920 7468 6174  .. IN query that
+00034800: 206d 6174 6368 6573 2072 6f77 7320 636f   matches rows co
+00034810: 6e74 6169 6e69 6e67 2061 2073 6571 7565  ntaining a seque
+00034820: 6e63 6520 6f66 0a20 2020 2076 616c 7565  nce of.    value
+00034830: 732e 0a0a 2020 2020 5468 6520 6578 7072  s...    The expr
+00034840: 6573 7369 6f6e 2065 7661 6c75 6174 6573  ession evaluates
+00034850: 2074 6f20 7472 7565 2069 6620 7468 6520   to true if the 
+00034860: 7661 6c75 6573 2069 6e20 6120 726f 7720  values in a row 
+00034870: 6d61 7463 6865 7320 7468 6520 7661 6c75  matches the valu
+00034880: 6573 2069 6e20 6f6e 6520 6f66 0a20 2020  es in one of.   
+00034890: 2074 6865 2073 7065 6369 6669 6564 2073   the specified s
+000348a0: 6571 7565 6e63 6573 2e0a 0a20 2020 2054  equences...    T
+000348b0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f64  he following cod
+000348c0: 6520 7265 7475 726e 7320 6120 4461 7461  e returns a Data
+000348d0: 4672 616d 6520 7468 6174 2063 6f6e 7461  Frame that conta
+000348e0: 696e 7320 7468 6520 726f 7773 2069 6e20  ins the rows in 
+000348f0: 7768 6963 680a 2020 2020 7468 6520 636f  which.    the co
+00034900: 6c75 6d6e 7320 6063 3160 2061 6e64 2060  lumns `c1` and `
+00034910: 6332 6020 636f 6e74 6169 6e20 7468 6520  c2` contain the 
+00034920: 7661 6c75 6573 3a0a 2020 2020 2d20 6031  values:.    - `1
+00034930: 6020 616e 6420 6022 6122 602c 206f 720a  ` and `"a"`, or.
+00034940: 2020 2020 2d20 6032 6020 616e 6420 6022      - `2` and `"
+00034950: 6222 600a 2020 2020 5468 6973 2069 7320  b"`.    This is 
+00034960: 6571 7569 7661 6c65 6e74 2074 6f20 6060  equivalent to ``
+00034970: 5345 4c45 4354 202a 2046 524f 4d20 7461  SELECT * FROM ta
+00034980: 626c 6520 5748 4552 4520 2863 312c 2063  ble WHERE (c1, c
+00034990: 3229 2049 4e20 2828 312c 2027 6127 292c  2) IN ((1, 'a'),
+000349a0: 2028 322c 2027 6227 2929 6060 2e0a 0a20   (2, 'b'))``... 
+000349b0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+000349c0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000349d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000349e0: 7461 6672 616d 6528 5b5b 312c 2022 6122  taframe([[1, "a"
+000349f0: 5d2c 205b 322c 2022 6222 5d2c 205b 332c  ], [2, "b"], [3,
+00034a00: 2022 6322 5d5d 2c20 7363 6865 6d61 3d5b   "c"]], schema=[
+00034a10: 2263 6f6c 3122 2c20 2263 6f6c 3222 5d29  "col1", "col2"])
+00034a20: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00034a30: 6669 6c74 6572 2869 6e5f 285b 636f 6c28  filter(in_([col(
+00034a40: 2263 6f6c 3122 292c 2063 6f6c 2822 636f  "col1"), col("co
+00034a50: 6c32 2229 5d2c 205b 5b31 2c20 2261 225d  l2")], [[1, "a"]
+00034a60: 2c20 5b32 2c20 2262 225d 5d29 292e 7368  , [2, "b"]])).sh
+00034a70: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00034a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00034a90: 0a20 2020 2020 2020 207c 2243 4f4c 3122  .        |"COL1"
+00034aa0: 2020 7c22 434f 4c32 2220 207c 0a20 2020    |"COL2"  |.   
+00034ab0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00034ac0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00034ad0: 207c 3120 2020 2020 2020 7c61 2020 2020   |1       |a    
+00034ae0: 2020 207c 0a20 2020 2020 2020 207c 3220     |.        |2 
+00034af0: 2020 2020 2020 7c62 2020 2020 2020 207c        |b       |
+00034b00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00034b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00034b20: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00034b30: 0a0a 2020 2020 5468 6520 666f 6c6c 6f77  ..    The follow
+00034b40: 696e 6720 636f 6465 2072 6574 7572 6e73  ing code returns
+00034b50: 2061 2044 6174 6146 7261 6d65 2074 6861   a DataFrame tha
+00034b60: 7420 636f 6e74 6169 6e73 2074 6865 2072  t contains the r
+00034b70: 6f77 7320 7768 6572 650a 2020 2020 7468  ows where.    th
+00034b80: 6520 7661 6c75 6573 206f 6620 7468 6520  e values of the 
+00034b90: 636f 6c75 6d6e 7320 6063 3160 2061 6e64  columns `c1` and
+00034ba0: 2060 6332 6020 696e 2060 6466 3260 206d   `c2` in `df2` m
+00034bb0: 6174 6368 2074 6865 2076 616c 7565 7320  atch the values 
+00034bc0: 6f66 2074 6865 2063 6f6c 756d 6e73 0a20  of the columns. 
+00034bd0: 2020 2060 6160 2061 6e64 2060 6260 2069     `a` and `b` i
+00034be0: 6e20 6064 6631 602e 2054 6869 7320 6973  n `df1`. This is
+00034bf0: 2065 7175 6976 616c 656e 7420 746f 0a20   equivalent to. 
+00034c00: 2020 2060 6053 454c 4543 5420 2a20 4652     ``SELECT * FR
+00034c10: 4f4d 2074 6162 6c65 3220 5748 4552 4520  OM table2 WHERE 
+00034c20: 2863 312c 2063 3229 2049 4e20 2853 454c  (c1, c2) IN (SEL
+00034c30: 4543 5420 612c 2062 2046 524f 4d20 7461  ECT a, b FROM ta
+00034c40: 626c 6531 2960 602e 0a0a 2020 2020 4578  ble1)``...    Ex
+00034c50: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00034c60: 203e 3e3e 2064 6631 203d 2073 6573 7369   >>> df1 = sessi
+00034c70: 6f6e 2e73 716c 2822 7365 6c65 6374 2031  on.sql("select 1
+00034c80: 2c20 2761 2722 290a 2020 2020 2020 2020  , 'a'").        
+00034c90: 3e3e 3e20 6466 2e66 696c 7465 7228 696e  >>> df.filter(in
+00034ca0: 5f28 5b63 6f6c 2822 636f 6c31 2229 2c20  _([col("col1"), 
+00034cb0: 636f 6c28 2263 6f6c 3222 295d 2c20 6466  col("col2")], df
+00034cc0: 3129 292e 7368 6f77 2829 0a20 2020 2020  1)).show().     
+00034cd0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00034ce0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00034cf0: 2243 4f4c 3122 2020 7c22 434f 4c32 2220  "COL1"  |"COL2" 
+00034d00: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00034d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00034d20: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
+00034d30: 7c61 2020 2020 2020 207c 0a20 2020 2020  |a       |.     
+00034d40: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00034d50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00034d60: 424c 414e 4b4c 494e 453e 0a0a 2020 2020  BLANKLINE>..    
+00034d70: 4172 6773 3a3a 0a20 2020 2020 2020 2063  Args::.        c
+00034d80: 6f6c 733a 2041 206c 6973 7420 6f66 2074  ols: A list of t
+00034d90: 6865 2063 6f6c 756d 6e73 2074 6f20 636f  he columns to co
+00034da0: 6d70 6172 6520 666f 7220 7468 6520 494e  mpare for the IN
+00034db0: 206f 7065 7261 7469 6f6e 2e0a 2020 2020   operation..    
+00034dc0: 2020 2020 7661 6c73 3a20 4120 6c69 7374      vals: A list
+00034dd0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00034de0: 7661 6c75 6573 2074 6f20 636f 6d70 6172  values to compar
+00034df0: 6520 666f 7220 7468 6520 494e 206f 7065  e for the IN ope
+00034e00: 7261 7469 6f6e 2e0a 2020 2020 2222 220a  ration..    """.
+00034e10: 2020 2020 7661 6c73 203d 2070 6172 7365      vals = parse
+00034e20: 5f70 6f73 6974 696f 6e61 6c5f 6172 6773  _positional_args
+00034e30: 5f74 6f5f 6c69 7374 282a 7661 6c73 290a  _to_list(*vals).
+00034e40: 2020 2020 636f 6c75 6d6e 7320 3d20 5b5f      columns = [_
+00034e50: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
+00034e60: 2022 696e 5f22 2920 666f 7220 6320 696e   "in_") for c in
+00034e70: 2063 6f6c 735d 0a20 2020 2072 6574 7572   cols].    retur
+00034e80: 6e20 436f 6c75 6d6e 284d 756c 7469 706c  n Column(Multipl
+00034e90: 6545 7870 7265 7373 696f 6e28 5b63 2e5f  eExpression([c._
+00034ea0: 6578 7072 6573 7369 6f6e 2066 6f72 2063  expression for c
+00034eb0: 2069 6e20 636f 6c75 6d6e 735d 2929 2e69   in columns])).i
+00034ec0: 6e5f 2876 616c 7329 0a0a 0a64 6566 2063  n_(vals)...def c
+00034ed0: 756d 655f 6469 7374 2829 202d 3e20 436f  ume_dist() -> Co
+00034ee0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00034ef0: 2020 4669 6e64 7320 7468 6520 6375 6d75    Finds the cumu
+00034f00: 6c61 7469 7665 2064 6973 7472 6962 7574  lative distribut
+00034f10: 696f 6e20 6f66 2061 2076 616c 7565 2077  ion of a value w
+00034f20: 6974 6820 7265 6761 7264 2074 6f20 6f74  ith regard to ot
+00034f30: 6865 7220 7661 6c75 6573 0a20 2020 2077  her values.    w
+00034f40: 6974 6869 6e20 7468 6520 7361 6d65 2077  ithin the same w
+00034f50: 696e 646f 7720 7061 7274 6974 696f 6e2e  indow partition.
+00034f60: 0a0a 2020 2020 4578 616d 706c 653a 0a0a  ..    Example:..
+00034f70: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00034f80: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00034f90: 6172 6b2e 7769 6e64 6f77 2069 6d70 6f72  ark.window impor
+00034fa0: 7420 5769 6e64 6f77 0a20 2020 2020 2020  t Window.       
+00034fb0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00034fc0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+00034fd0: 6573 2069 6d70 6f72 7420 4465 6369 6d61  es import Decima
+00034fe0: 6c54 7970 650a 2020 2020 2020 2020 3e3e  lType.        >>
+00034ff0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00035000: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00035010: 5b5b 312c 2032 5d2c 205b 312c 2032 5d2c  [[1, 2], [1, 2],
+00035020: 205b 312c 335d 2c20 5b34 2c20 355d 2c20   [1,3], [4, 5], 
+00035030: 5b32 2c20 335d 2c20 5b33 2c20 345d 2c20  [2, 3], [3, 4], 
+00035040: 5b34 2c20 375d 2c20 5b33 2c37 5d2c 205b  [4, 7], [3,7], [
+00035050: 342c 355d 5d2c 2073 6368 656d 613d 5b22  4,5]], schema=["
+00035060: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+00035070: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00035080: 6375 6d65 5f64 6973 7428 292e 6f76 6572  cume_dist().over
+00035090: 2857 696e 646f 772e 6f72 6465 725f 6279  (Window.order_by
+000350a0: 2822 6122 2929 2e63 6173 7428 4465 6369  ("a")).cast(Deci
+000350b0: 6d61 6c54 7970 6528 7363 616c 653d 3329  malType(scale=3)
+000350c0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000350d0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000350e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000350f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00035100: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00035110: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00035120: 207c 302e 3333 3320 2020 2020 7c0a 2020   |0.333     |.  
+00035130: 2020 2020 2020 7c30 2e33 3333 2020 2020        |0.333    
+00035140: 207c 0a20 2020 2020 2020 207c 302e 3333   |.        |0.33
+00035150: 3320 2020 2020 7c0a 2020 2020 2020 2020  3     |.        
+00035160: 7c30 2e34 3434 2020 2020 207c 0a20 2020  |0.444     |.   
+00035170: 2020 2020 207c 302e 3636 3720 2020 2020       |0.667     
+00035180: 7c0a 2020 2020 2020 2020 7c30 2e36 3637  |.        |0.667
+00035190: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+000351a0: 312e 3030 3020 2020 2020 7c0a 2020 2020  1.000     |.    
+000351b0: 2020 2020 7c31 2e30 3030 2020 2020 207c      |1.000     |
+000351c0: 0a20 2020 2020 2020 207c 312e 3030 3020  .        |1.000 
+000351d0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+000351e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000351f0: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00035200: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+00035210: 6e20 6275 696c 7469 6e28 2263 756d 655f  n builtin("cume_
+00035220: 6469 7374 2229 2829 0a0a 0a64 6566 2072  dist")()...def r
+00035230: 616e 6b28 2920 2d3e 2043 6f6c 756d 6e3a  ank() -> Column:
+00035240: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00035250: 7572 6e73 2074 6865 2072 616e 6b20 6f66  urns the rank of
+00035260: 2061 2076 616c 7565 2077 6974 6869 6e20   a value within 
+00035270: 616e 206f 7264 6572 6564 2067 726f 7570  an ordered group
+00035280: 206f 6620 7661 6c75 6573 2e0a 2020 2020   of values..    
+00035290: 5468 6520 7261 6e6b 2076 616c 7565 2073  The rank value s
+000352a0: 7461 7274 7320 6174 2031 2061 6e64 2063  tarts at 1 and c
+000352b0: 6f6e 7469 6e75 6573 2075 702e 0a0a 2020  ontinues up...  
+000352c0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+000352d0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+000352e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000352f0: 7769 6e64 6f77 2069 6d70 6f72 7420 5769  window import Wi
+00035300: 6e64 6f77 0a20 2020 2020 2020 203e 3e3e  ndow.        >>>
+00035310: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00035320: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00035330: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00035340: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
+00035350: 2020 2020 2020 5b31 2c20 322c 2031 5d2c        [1, 2, 1],
+00035360: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00035370: 2020 2020 205b 312c 2032 2c20 335d 2c0a       [1, 2, 3],.
+00035380: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00035390: 2020 2020 5b32 2c20 312c 2031 305d 2c0a      [2, 1, 10],.
+000353a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+000353b0: 2020 2020 5b32 2c20 322c 2031 5d2c 0a20      [2, 2, 1],. 
+000353c0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000353d0: 2020 205b 322c 2032 2c20 335d 2c0a 2020     [2, 2, 3],.  
+000353e0: 2020 2020 2020 2e2e 2e20 2020 2020 5d2c        ...     ],
+000353f0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00035400: 2073 6368 656d 613d 5b22 7822 2c20 2279   schema=["x", "y
+00035410: 222c 2022 7a22 5d0a 2020 2020 2020 2020  ", "z"].        
+00035420: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+00035430: 3e20 6466 2e73 656c 6563 7428 7261 6e6b  > df.select(rank
+00035440: 2829 2e6f 7665 7228 5769 6e64 6f77 2e70  ().over(Window.p
+00035450: 6172 7469 7469 6f6e 5f62 7928 636f 6c28  artition_by(col(
+00035460: 2258 2229 292e 6f72 6465 725f 6279 2863  "X")).order_by(c
+00035470: 6f6c 2822 5922 2929 292e 616c 6961 7328  ol("Y"))).alias(
+00035480: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00035490: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+000354a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+000354b0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+000354c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000354d0: 0a20 2020 2020 2020 207c 3120 2020 2020  .        |1     
+000354e0: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
+000354f0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00035500: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
+00035510: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
+00035520: 2020 207c 0a20 2020 2020 2020 207c 3120     |.        |1 
+00035530: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00035540: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00035550: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00035560: 453e 0a20 2020 2022 2222 0a20 2020 2072  E>.    """.    r
+00035570: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
+00035580: 616e 6b22 2928 290a 0a0a 6465 6620 7065  ank")()...def pe
+00035590: 7263 656e 745f 7261 6e6b 2829 202d 3e20  rcent_rank() -> 
+000355a0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+000355b0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+000355c0: 7265 6c61 7469 7665 2072 616e 6b20 6f66  relative rank of
+000355d0: 2061 2076 616c 7565 2077 6974 6869 6e20   a value within 
+000355e0: 6120 6772 6f75 7020 6f66 2076 616c 7565  a group of value
+000355f0: 732c 2073 7065 6369 6669 6564 2061 7320  s, specified as 
+00035600: 6120 7065 7263 656e 7461 6765 0a20 2020  a percentage.   
+00035610: 2072 616e 6769 6e67 2066 726f 6d20 302e   ranging from 0.
+00035620: 3020 746f 2031 2e30 2e0a 0a20 2020 2045  0 to 1.0...    E
+00035630: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00035640: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00035650: 616b 652e 736e 6f77 7061 726b 2e77 696e  ake.snowpark.win
+00035660: 646f 7720 696d 706f 7274 2057 696e 646f  dow import Windo
+00035670: 770a 2020 2020 2020 2020 3e3e 3e20 6466  w.        >>> df
+00035680: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00035690: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+000356a0: 2020 2020 202e 2e2e 2020 2020 205b 0a20       ...     [. 
+000356b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000356c0: 2020 205b 312c 2032 2c20 315d 2c0a 2020     [1, 2, 1],.  
+000356d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000356e0: 2020 5b31 2c20 322c 2033 5d2c 0a20 2020    [1, 2, 3],.   
+000356f0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00035700: 205b 322c 2031 2c20 3130 5d2c 0a20 2020   [2, 1, 10],.   
+00035710: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00035720: 205b 322c 2032 2c20 315d 2c0a 2020 2020   [2, 2, 1],.    
+00035730: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00035740: 5b32 2c20 322c 2033 5d2c 0a20 2020 2020  [2, 2, 3],.     
+00035750: 2020 202e 2e2e 2020 2020 205d 2c0a 2020     ...     ],.  
+00035760: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+00035770: 6865 6d61 3d5b 2278 222c 2022 7922 2c20  hema=["x", "y", 
+00035780: 227a 225d 0a20 2020 2020 2020 202e 2e2e  "z"].        ...
+00035790: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+000357a0: 662e 7365 6c65 6374 2870 6572 6365 6e74  f.select(percent
+000357b0: 5f72 616e 6b28 292e 6f76 6572 2857 696e  _rank().over(Win
+000357c0: 646f 772e 7061 7274 6974 696f 6e5f 6279  dow.partition_by
+000357d0: 2822 7822 292e 6f72 6465 725f 6279 2863  ("x").order_by(c
+000357e0: 6f6c 2822 7922 2929 292e 616c 6961 7328  ol("y"))).alias(
+000357f0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00035800: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00035810: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00035820: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00035830: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00035840: 0a20 2020 2020 2020 207c 302e 3020 2020  .        |0.0   
+00035850: 2020 2020 7c0a 2020 2020 2020 2020 7c30      |.        |0
+00035860: 2e35 2020 2020 2020 207c 0a20 2020 2020  .5       |.     
+00035870: 2020 207c 302e 3520 2020 2020 2020 7c0a     |0.5       |.
+00035880: 2020 2020 2020 2020 7c30 2e30 2020 2020          |0.0    
+00035890: 2020 207c 0a20 2020 2020 2020 207c 302e     |.        |0.
+000358a0: 3020 2020 2020 2020 7c0a 2020 2020 2020  0       |.      
+000358b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000358c0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+000358d0: 453e 0a20 2020 2022 2222 0a20 2020 2072  E>.    """.    r
+000358e0: 6574 7572 6e20 6275 696c 7469 6e28 2270  eturn builtin("p
+000358f0: 6572 6365 6e74 5f72 616e 6b22 2928 290a  ercent_rank")().
+00035900: 0a0a 6465 6620 6465 6e73 655f 7261 6e6b  ..def dense_rank
+00035910: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00035920: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+00035930: 7320 7468 6520 7261 6e6b 206f 6620 6120  s the rank of a 
+00035940: 7661 6c75 6520 7769 7468 696e 2061 2067  value within a g
+00035950: 726f 7570 206f 6620 7661 6c75 6573 2c20  roup of values, 
+00035960: 7769 7468 6f75 7420 6761 7073 2069 6e20  without gaps in 
+00035970: 7468 6520 7261 6e6b 732e 0a20 2020 2054  the ranks..    T
+00035980: 6865 2072 616e 6b20 7661 6c75 6520 7374  he rank value st
+00035990: 6172 7473 2061 7420 3120 616e 6420 636f  arts at 1 and co
+000359a0: 6e74 696e 7565 7320 7570 2073 6571 7565  ntinues up seque
+000359b0: 6e74 6961 6c6c 792e 0a20 2020 2049 6620  ntially..    If 
+000359c0: 7477 6f20 7661 6c75 6573 2061 7265 2074  two values are t
+000359d0: 6865 2073 616d 652c 2074 6865 7920 7769  he same, they wi
+000359e0: 6c6c 2068 6176 6520 7468 6520 7361 6d65  ll have the same
+000359f0: 2072 616e 6b2e 0a0a 2020 2020 4578 616d   rank...    Exam
+00035a00: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00035a10: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00035a20: 652e 736e 6f77 7061 726b 2e77 696e 646f  e.snowpark.windo
+00035a30: 7720 696d 706f 7274 2057 696e 646f 770a  w import Window.
+00035a40: 2020 2020 2020 2020 3e3e 3e20 7769 6e64          >>> wind
+00035a50: 6f77 203d 2057 696e 646f 772e 6f72 6465  ow = Window.orde
+00035a60: 725f 6279 2822 6b65 7922 290a 2020 2020  r_by("key").    
+00035a70: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00035a80: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00035a90: 6672 616d 6528 5b28 312c 2022 3122 292c  frame([(1, "1"),
+00035aa0: 2028 322c 2022 3222 292c 2028 312c 2022   (2, "2"), (1, "
+00035ab0: 3322 292c 2028 322c 2022 3422 295d 2c20  3"), (2, "4")], 
+00035ac0: 7363 6865 6d61 3d5b 226b 6579 222c 2022  schema=["key", "
+00035ad0: 7661 6c75 6522 5d29 0a20 2020 2020 2020  value"]).       
+00035ae0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+00035af0: 656e 7365 5f72 616e 6b28 292e 6f76 6572  ense_rank().over
+00035b00: 2877 696e 646f 7729 2e61 735f 2822 6465  (window).as_("de
+00035b10: 6e73 655f 7261 6e6b 2229 292e 636f 6c6c  nse_rank")).coll
+00035b20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00035b30: 6f77 2844 454e 5345 5f52 414e 4b3d 3129  ow(DENSE_RANK=1)
+00035b40: 2c20 526f 7728 4445 4e53 455f 5241 4e4b  , Row(DENSE_RANK
+00035b50: 3d31 292c 2052 6f77 2844 454e 5345 5f52  =1), Row(DENSE_R
+00035b60: 414e 4b3d 3229 2c20 526f 7728 4445 4e53  ANK=2), Row(DENS
+00035b70: 455f 5241 4e4b 3d32 295d 0a20 2020 2022  E_RANK=2)].    "
+00035b80: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00035b90: 696c 7469 6e28 2264 656e 7365 5f72 616e  iltin("dense_ran
+00035ba0: 6b22 2928 290a 0a0a 6465 6620 726f 775f  k")()...def row_
+00035bb0: 6e75 6d62 6572 2829 202d 3e20 436f 6c75  number() -> Colu
+00035bc0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00035bd0: 5265 7475 726e 7320 6120 756e 6971 7565  Returns a unique
+00035be0: 2072 6f77 206e 756d 6265 7220 666f 7220   row number for 
+00035bf0: 6561 6368 2072 6f77 2077 6974 6869 6e20  each row within 
+00035c00: 6120 7769 6e64 6f77 2070 6172 7469 7469  a window partiti
+00035c10: 6f6e 2e0a 2020 2020 5468 6520 726f 7720  on..    The row 
+00035c20: 6e75 6d62 6572 2073 7461 7274 7320 6174  number starts at
+00035c30: 2031 2061 6e64 2063 6f6e 7469 6e75 6573   1 and continues
+00035c40: 2075 7020 7365 7175 656e 7469 616c 6c79   up sequentially
+00035c50: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00035c60: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00035c70: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00035c80: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
+00035c90: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
+00035ca0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00035cb0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00035cc0: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00035cd0: 2e20 2020 2020 5b0a 2020 2020 2020 2020  .     [.        
+00035ce0: 2e2e 2e20 2020 2020 2020 2020 5b31 2c20  ...         [1, 
+00035cf0: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
+00035d00: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
+00035d10: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
+00035d20: 2e20 2020 2020 2020 2020 5b32 2c20 312c  .         [2, 1,
+00035d30: 2031 305d 2c0a 2020 2020 2020 2020 2e2e   10],.        ..
+00035d40: 2e20 2020 2020 2020 2020 5b32 2c20 322c  .         [2, 2,
+00035d50: 2031 5d2c 0a20 2020 2020 2020 202e 2e2e   1],.        ...
+00035d60: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
+00035d70: 335d 2c0a 2020 2020 2020 2020 2e2e 2e20  3],.        ... 
+00035d80: 2020 2020 5d2c 0a20 2020 2020 2020 202e      ],.        .
+00035d90: 2e2e 2020 2020 2073 6368 656d 613d 5b22  ..     schema=["
+00035da0: 7822 2c20 2279 222c 2022 7a22 5d0a 2020  x", "y", "z"].  
+00035db0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
+00035dc0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00035dd0: 7428 726f 775f 6e75 6d62 6572 2829 2e6f  t(row_number().o
+00035de0: 7665 7228 5769 6e64 6f77 2e70 6172 7469  ver(Window.parti
+00035df0: 7469 6f6e 5f62 7928 636f 6c28 2258 2229  tion_by(col("X")
+00035e00: 292e 6f72 6465 725f 6279 2863 6f6c 2822  ).order_by(col("
+00035e10: 5922 2929 292e 616c 6961 7328 2272 6573  Y"))).alias("res
+00035e20: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+00035e30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00035e40: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00035e50: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00035e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00035e70: 2020 2020 207c 3120 2020 2020 2020 2020       |1         
+00035e80: 7c0a 2020 2020 2020 2020 7c32 2020 2020  |.        |2    
+00035e90: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00035ea0: 3320 2020 2020 2020 2020 7c0a 2020 2020  3         |.    
+00035eb0: 2020 2020 7c31 2020 2020 2020 2020 207c      |1         |
+00035ec0: 0a20 2020 2020 2020 207c 3220 2020 2020  .        |2     
+00035ed0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00035ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00035ef0: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00035f00: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+00035f10: 6e20 6275 696c 7469 6e28 2272 6f77 5f6e  n builtin("row_n
+00035f20: 756d 6265 7222 2928 290a 0a0a 6465 6620  umber")()...def 
+00035f30: 6c61 6728 0a20 2020 2065 3a20 436f 6c75  lag(.    e: Colu
+00035f40: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 6f66  mnOrName,.    of
+00035f50: 6673 6574 3a20 696e 7420 3d20 312c 0a20  fset: int = 1,. 
+00035f60: 2020 2064 6566 6175 6c74 5f76 616c 7565     default_value
+00035f70: 3a20 4f70 7469 6f6e 616c 5b43 6f6c 756d  : Optional[Colum
+00035f80: 6e4f 724c 6974 6572 616c 5d20 3d20 4e6f  nOrLiteral] = No
+00035f90: 6e65 2c0a 2020 2020 6967 6e6f 7265 5f6e  ne,.    ignore_n
+00035fa0: 756c 6c73 3a20 626f 6f6c 203d 2046 616c  ulls: bool = Fal
+00035fb0: 7365 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  se,.) -> Column:
+00035fc0: 0a20 2020 2022 2222 0a20 2020 2041 6363  .    """.    Acc
+00035fd0: 6573 7365 7320 6461 7461 2069 6e20 6120  esses data in a 
+00035fe0: 7072 6576 696f 7573 2072 6f77 2069 6e20  previous row in 
+00035ff0: 7468 6520 7361 6d65 2072 6573 756c 7420  the same result 
+00036000: 7365 7420 7769 7468 6f75 7420 6861 7669  set without havi
+00036010: 6e67 2074 6f0a 2020 2020 6a6f 696e 2074  ng to.    join t
+00036020: 6865 2074 6162 6c65 2074 6f20 6974 7365  he table to itse
+00036030: 6c66 2e0a 0a20 2020 2045 7861 6d70 6c65  lf...    Example
+00036040: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00036050: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00036060: 6e6f 7770 6172 6b2e 7769 6e64 6f77 2069  nowpark.window i
+00036070: 6d70 6f72 7420 5769 6e64 6f77 0a20 2020  mport Window.   
+00036080: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00036090: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000360a0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+000360b0: 2e2e 2e20 2020 2020 5b0a 2020 2020 2020  ...     [.      
+000360c0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
+000360d0: 2c20 322c 2031 5d2c 0a20 2020 2020 2020  , 2, 1],.       
+000360e0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
+000360f0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
+00036100: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00036110: 312c 2031 305d 2c0a 2020 2020 2020 2020  1, 10],.        
+00036120: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00036130: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
+00036140: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
+00036150: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
+00036160: 2e20 2020 2020 5d2c 0a20 2020 2020 2020  .     ],.       
+00036170: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00036180: 5b22 7822 2c20 2279 222c 2022 7a22 5d0a  ["x", "y", "z"].
+00036190: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+000361a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000361b0: 6563 7428 6c61 6728 225a 2229 2e6f 7665  ect(lag("Z").ove
+000361c0: 7228 5769 6e64 6f77 2e70 6172 7469 7469  r(Window.partiti
+000361d0: 6f6e 5f62 7928 636f 6c28 2258 2229 292e  on_by(col("X")).
+000361e0: 6f72 6465 725f 6279 2863 6f6c 2822 5922  order_by(col("Y"
+000361f0: 2929 292e 616c 6961 7328 2272 6573 756c  ))).alias("resul
+00036200: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
+00036210: 2020 2020 2020 205b 526f 7728 5245 5355         [Row(RESU
+00036220: 4c54 3d4e 6f6e 6529 2c20 526f 7728 5245  LT=None), Row(RE
+00036230: 5355 4c54 3d31 3029 2c20 526f 7728 5245  SULT=10), Row(RE
+00036240: 5355 4c54 3d31 292c 2052 6f77 2852 4553  SULT=1), Row(RES
+00036250: 554c 543d 4e6f 6e65 292c 2052 6f77 2852  ULT=None), Row(R
+00036260: 4553 554c 543d 3129 5d0a 2020 2020 2222  ESULT=1)].    ""
+00036270: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00036280: 6c5f 6966 5f73 7472 2865 2c20 226c 6167  l_if_str(e, "lag
+00036290: 2229 0a20 2020 2072 6574 7572 6e20 436f  ").    return Co
+000362a0: 6c75 6d6e 280a 2020 2020 2020 2020 4c61  lumn(.        La
+000362b0: 6728 632e 5f65 7870 7265 7373 696f 6e2c  g(c._expression,
+000362c0: 206f 6666 7365 742c 2043 6f6c 756d 6e2e   offset, Column.
+000362d0: 5f74 6f5f 6578 7072 2864 6566 6175 6c74  _to_expr(default
+000362e0: 5f76 616c 7565 292c 2069 676e 6f72 655f  _value), ignore_
+000362f0: 6e75 6c6c 7329 0a20 2020 2029 0a0a 0a64  nulls).    )...d
+00036300: 6566 206c 6561 6428 0a20 2020 2065 3a20  ef lead(.    e: 
+00036310: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
+00036320: 2020 6f66 6673 6574 3a20 696e 7420 3d20    offset: int = 
+00036330: 312c 0a20 2020 2064 6566 6175 6c74 5f76  1,.    default_v
+00036340: 616c 7565 3a20 4f70 7469 6f6e 616c 5b55  alue: Optional[U
+00036350: 6e69 6f6e 5b43 6f6c 756d 6e2c 204c 6974  nion[Column, Lit
+00036360: 6572 616c 5479 7065 5d5d 203d 204e 6f6e  eralType]] = Non
+00036370: 652c 0a20 2020 2069 676e 6f72 655f 6e75  e,.    ignore_nu
+00036380: 6c6c 733a 2062 6f6f 6c20 3d20 4661 6c73  lls: bool = Fals
+00036390: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
+000363a0: 2020 2020 2222 220a 2020 2020 4163 6365      """.    Acce
+000363b0: 7373 6573 2064 6174 6120 696e 2061 2073  sses data in a s
+000363c0: 7562 7365 7175 656e 7420 726f 7720 696e  ubsequent row in
+000363d0: 2074 6865 2073 616d 6520 7265 7375 6c74   the same result
+000363e0: 2073 6574 2077 6974 686f 7574 2068 6176   set without hav
+000363f0: 696e 6720 746f 0a20 2020 206a 6f69 6e20  ing to.    join 
+00036400: 7468 6520 7461 626c 6520 746f 2069 7473  the table to its
+00036410: 656c 662e 0a0a 2020 2020 4578 616d 706c  elf...    Exampl
+00036420: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00036430: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+00036440: 736e 6f77 7061 726b 2e77 696e 646f 7720  snowpark.window 
+00036450: 696d 706f 7274 2057 696e 646f 770a 2020  import Window.  
+00036460: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00036470: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00036480: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+00036490: 202e 2e2e 2020 2020 205b 0a20 2020 2020   ...     [.     
+000364a0: 2020 202e 2e2e 2020 2020 2020 2020 205b     ...         [
+000364b0: 312c 2032 2c20 315d 2c0a 2020 2020 2020  1, 2, 1],.      
+000364c0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
+000364d0: 2c20 322c 2033 5d2c 0a20 2020 2020 2020  , 2, 3],.       
+000364e0: 202e 2e2e 2020 2020 2020 2020 205b 322c   ...         [2,
+000364f0: 2031 2c20 3130 5d2c 0a20 2020 2020 2020   1, 10],.       
+00036500: 202e 2e2e 2020 2020 2020 2020 205b 322c   ...         [2,
+00036510: 2032 2c20 315d 2c0a 2020 2020 2020 2020   2, 1],.        
+00036520: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00036530: 322c 2033 5d2c 0a20 2020 2020 2020 202e  2, 3],.        .
+00036540: 2e2e 2020 2020 205d 2c0a 2020 2020 2020  ..     ],.      
+00036550: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
+00036560: 3d5b 2278 222c 2022 7922 2c20 227a 225d  =["x", "y", "z"]
+00036570: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+00036580: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00036590: 6c65 6374 286c 6561 6428 225a 2229 2e6f  lect(lead("Z").o
+000365a0: 7665 7228 5769 6e64 6f77 2e70 6172 7469  ver(Window.parti
+000365b0: 7469 6f6e 5f62 7928 636f 6c28 2258 2229  tion_by(col("X")
+000365c0: 292e 6f72 6465 725f 6279 2863 6f6c 2822  ).order_by(col("
+000365d0: 5922 2929 292e 616c 6961 7328 2272 6573  Y"))).alias("res
+000365e0: 756c 7422 2929 2e63 6f6c 6c65 6374 2829  ult")).collect()
+000365f0: 0a20 2020 2020 2020 205b 526f 7728 5245  .        [Row(RE
+00036600: 5355 4c54 3d31 292c 2052 6f77 2852 4553  SULT=1), Row(RES
+00036610: 554c 543d 3329 2c20 526f 7728 5245 5355  ULT=3), Row(RESU
+00036620: 4c54 3d4e 6f6e 6529 2c20 526f 7728 5245  LT=None), Row(RE
+00036630: 5355 4c54 3d33 292c 2052 6f77 2852 4553  SULT=3), Row(RES
+00036640: 554c 543d 4e6f 6e65 295d 0a20 2020 2022  ULT=None)].    "
+00036650: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00036660: 6f6c 5f69 665f 7374 7228 652c 2022 6c65  ol_if_str(e, "le
+00036670: 6164 2229 0a20 2020 2072 6574 7572 6e20  ad").    return 
+00036680: 436f 6c75 6d6e 280a 2020 2020 2020 2020  Column(.        
+00036690: 4c65 6164 2863 2e5f 6578 7072 6573 7369  Lead(c._expressi
+000366a0: 6f6e 2c20 6f66 6673 6574 2c20 436f 6c75  on, offset, Colu
+000366b0: 6d6e 2e5f 746f 5f65 7870 7228 6465 6661  mn._to_expr(defa
+000366c0: 756c 745f 7661 6c75 6529 2c20 6967 6e6f  ult_value), igno
+000366d0: 7265 5f6e 756c 6c73 290a 2020 2020 290a  re_nulls).    ).
+000366e0: 0a0a 6465 6620 6c61 7374 5f76 616c 7565  ..def last_value
+000366f0: 280a 2020 2020 653a 2043 6f6c 756d 6e4f  (.    e: ColumnO
+00036700: 724e 616d 652c 0a20 2020 2069 676e 6f72  rName,.    ignor
+00036710: 655f 6e75 6c6c 733a 2062 6f6f 6c20 3d20  e_nulls: bool = 
+00036720: 4661 6c73 652c 0a29 202d 3e20 436f 6c75  False,.) -> Colu
+00036730: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00036740: 5265 7475 726e 7320 7468 6520 6c61 7374  Returns the last
+00036750: 2076 616c 7565 2077 6974 6869 6e20 616e   value within an
+00036760: 206f 7264 6572 6564 2067 726f 7570 206f   ordered group o
+00036770: 6620 7661 6c75 6573 2e0a 0a20 2020 2045  f values...    E
+00036780: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00036790: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+000367a0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7769  lake.snowpark.wi
+000367b0: 6e64 6f77 2069 6d70 6f72 7420 5769 6e64  ndow import Wind
+000367c0: 6f77 0a20 2020 2020 2020 203e 3e3e 2077  ow.        >>> w
+000367d0: 696e 646f 7720 3d20 5769 6e64 6f77 2e70  indow = Window.p
+000367e0: 6172 7469 7469 6f6e 5f62 7928 2263 6f6c  artition_by("col
+000367f0: 756d 6e31 2229 2e6f 7264 6572 5f62 7928  umn1").order_by(
+00036800: 2263 6f6c 756d 6e32 2229 0a20 2020 2020  "column2").     
+00036810: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00036820: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00036830: 7261 6d65 285b 5b31 2c20 3130 5d2c 205b  rame([[1, 10], [
+00036840: 312c 2031 315d 2c20 5b32 2c20 3230 5d2c  1, 11], [2, 20],
+00036850: 205b 322c 2032 315d 5d2c 2073 6368 656d   [2, 21]], schem
+00036860: 613d 5b22 636f 6c75 6d6e 3122 2c20 2263  a=["column1", "c
+00036870: 6f6c 756d 6e32 225d 290a 2020 2020 2020  olumn2"]).      
+00036880: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00036890: 6466 5b22 636f 6c75 6d6e 3122 5d2c 2064  df["column1"], d
+000368a0: 665b 2263 6f6c 756d 6e32 225d 2c20 6c61  f["column2"], la
+000368b0: 7374 5f76 616c 7565 2864 665b 2263 6f6c  st_value(df["col
+000368c0: 756d 6e32 225d 292e 6f76 6572 2877 696e  umn2"]).over(win
+000368d0: 646f 7729 2e61 735f 2822 636f 6c75 6d6e  dow).as_("column
+000368e0: 325f 6c61 7374 2229 292e 636f 6c6c 6563  2_last")).collec
+000368f0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00036900: 2843 4f4c 554d 4e31 3d31 2c20 434f 4c55  (COLUMN1=1, COLU
+00036910: 4d4e 323d 3130 2c20 434f 4c55 4d4e 325f  MN2=10, COLUMN2_
+00036920: 4c41 5354 3d31 3129 2c20 526f 7728 434f  LAST=11), Row(CO
+00036930: 4c55 4d4e 313d 312c 2043 4f4c 554d 4e32  LUMN1=1, COLUMN2
+00036940: 3d31 312c 2043 4f4c 554d 4e32 5f4c 4153  =11, COLUMN2_LAS
+00036950: 543d 3131 292c 2052 6f77 2843 4f4c 554d  T=11), Row(COLUM
+00036960: 4e31 3d32 2c20 434f 4c55 4d4e 323d 3230  N1=2, COLUMN2=20
+00036970: 2c20 434f 4c55 4d4e 325f 4c41 5354 3d32  , COLUMN2_LAST=2
+00036980: 3129 2c20 526f 7728 434f 4c55 4d4e 313d  1), Row(COLUMN1=
+00036990: 322c 2043 4f4c 554d 4e32 3d32 312c 2043  2, COLUMN2=21, C
+000369a0: 4f4c 554d 4e32 5f4c 4153 543d 3231 295d  OLUMN2_LAST=21)]
+000369b0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+000369c0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+000369d0: 652c 2022 6c61 7374 5f76 616c 7565 2229  e, "last_value")
+000369e0: 0a20 2020 2072 6574 7572 6e20 436f 6c75  .    return Colu
+000369f0: 6d6e 284c 6173 7456 616c 7565 2863 2e5f  mn(LastValue(c._
+00036a00: 6578 7072 6573 7369 6f6e 2c20 4e6f 6e65  expression, None
+00036a10: 2c20 4e6f 6e65 2c20 6967 6e6f 7265 5f6e  , None, ignore_n
+00036a20: 756c 6c73 2929 0a0a 0a64 6566 2066 6972  ulls))...def fir
+00036a30: 7374 5f76 616c 7565 280a 2020 2020 653a  st_value(.    e:
+00036a40: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
+00036a50: 2020 2069 676e 6f72 655f 6e75 6c6c 733a     ignore_nulls:
+00036a60: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a29   bool = False,.)
+00036a70: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00036a80: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
+00036a90: 7468 6520 6669 7273 7420 7661 6c75 6520  the first value 
+00036aa0: 7769 7468 696e 2061 6e20 6f72 6465 7265  within an ordere
+00036ab0: 6420 6772 6f75 7020 6f66 2076 616c 7565  d group of value
+00036ac0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00036ad0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
+00036ae0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00036af0: 6f77 7061 726b 2e77 696e 646f 7720 696d  owpark.window im
+00036b00: 706f 7274 2057 696e 646f 770a 2020 2020  port Window.    
+00036b10: 2020 2020 3e3e 3e20 7769 6e64 6f77 203d      >>> window =
+00036b20: 2057 696e 646f 772e 7061 7274 6974 696f   Window.partitio
+00036b30: 6e5f 6279 2822 636f 6c75 6d6e 3122 292e  n_by("column1").
+00036b40: 6f72 6465 725f 6279 2822 636f 6c75 6d6e  order_by("column
+00036b50: 3222 290a 2020 2020 2020 2020 3e3e 3e20  2").        >>> 
+00036b60: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00036b70: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+00036b80: 312c 2031 305d 2c20 5b31 2c20 3131 5d2c  1, 10], [1, 11],
+00036b90: 205b 322c 2032 305d 2c20 5b32 2c20 3231   [2, 20], [2, 21
+00036ba0: 5d5d 2c20 7363 6865 6d61 3d5b 2263 6f6c  ]], schema=["col
+00036bb0: 756d 6e31 222c 2022 636f 6c75 6d6e 3222  umn1", "column2"
+00036bc0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00036bd0: 662e 7365 6c65 6374 2864 665b 2263 6f6c  f.select(df["col
+00036be0: 756d 6e31 225d 2c20 6466 5b22 636f 6c75  umn1"], df["colu
+00036bf0: 6d6e 3222 5d2c 2066 6972 7374 5f76 616c  mn2"], first_val
+00036c00: 7565 2864 665b 2263 6f6c 756d 6e32 225d  ue(df["column2"]
+00036c10: 292e 6f76 6572 2877 696e 646f 7729 2e61  ).over(window).a
+00036c20: 735f 2822 636f 6c75 6d6e 325f 6669 7273  s_("column2_firs
+00036c30: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
+00036c40: 2020 2020 2020 205b 526f 7728 434f 4c55         [Row(COLU
+00036c50: 4d4e 313d 312c 2043 4f4c 554d 4e32 3d31  MN1=1, COLUMN2=1
+00036c60: 302c 2043 4f4c 554d 4e32 5f46 4952 5354  0, COLUMN2_FIRST
+00036c70: 3d31 3029 2c20 526f 7728 434f 4c55 4d4e  =10), Row(COLUMN
+00036c80: 313d 312c 2043 4f4c 554d 4e32 3d31 312c  1=1, COLUMN2=11,
+00036c90: 2043 4f4c 554d 4e32 5f46 4952 5354 3d31   COLUMN2_FIRST=1
+00036ca0: 3029 2c20 526f 7728 434f 4c55 4d4e 313d  0), Row(COLUMN1=
+00036cb0: 322c 2043 4f4c 554d 4e32 3d32 302c 2043  2, COLUMN2=20, C
+00036cc0: 4f4c 554d 4e32 5f46 4952 5354 3d32 3029  OLUMN2_FIRST=20)
+00036cd0: 2c20 526f 7728 434f 4c55 4d4e 313d 322c  , Row(COLUMN1=2,
+00036ce0: 2043 4f4c 554d 4e32 3d32 312c 2043 4f4c   COLUMN2=21, COL
+00036cf0: 554d 4e32 5f46 4952 5354 3d32 3029 5d0a  UMN2_FIRST=20)].
+00036d00: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00036d10: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+00036d20: 2c20 226c 6173 745f 7661 6c75 6522 290a  , "last_value").
+00036d30: 2020 2020 7265 7475 726e 2043 6f6c 756d      return Colum
+00036d40: 6e28 4669 7273 7456 616c 7565 2863 2e5f  n(FirstValue(c._
+00036d50: 6578 7072 6573 7369 6f6e 2c20 4e6f 6e65  expression, None
+00036d60: 2c20 4e6f 6e65 2c20 6967 6e6f 7265 5f6e  , None, ignore_n
+00036d70: 756c 6c73 2929 0a0a 0a64 6566 206e 7469  ulls))...def nti
+00036d80: 6c65 2865 3a20 556e 696f 6e5b 696e 742c  le(e: Union[int,
+00036d90: 2043 6f6c 756d 6e4f 724e 616d 655d 2920   ColumnOrName]) 
+00036da0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00036db0: 2222 0a20 2020 2044 6976 6964 6573 2061  "".    Divides a
+00036dc0: 6e20 6f72 6465 7265 6420 6461 7461 2073  n ordered data s
+00036dd0: 6574 2065 7175 616c 6c79 2069 6e74 6f20  et equally into 
+00036de0: 7468 6520 6e75 6d62 6572 206f 6620 6275  the number of bu
+00036df0: 636b 6574 7320 7370 6563 6966 6965 6420  ckets specified 
+00036e00: 6279 206e 2e0a 2020 2020 4275 636b 6574  by n..    Bucket
+00036e10: 7320 6172 6520 7365 7175 656e 7469 616c  s are sequential
+00036e20: 6c79 206e 756d 6265 7265 6420 3120 7468  ly numbered 1 th
+00036e30: 726f 7567 6820 6e2e 0a0a 2020 2020 4172  rough n...    Ar
+00036e40: 6773 3a0a 2020 2020 2020 2020 653a 2054  gs:.        e: T
+00036e50: 6865 2064 6573 6972 6564 206e 756d 6265  he desired numbe
+00036e60: 7220 6f66 2062 7563 6b65 7473 3b20 6d75  r of buckets; mu
+00036e70: 7374 2062 6520 6120 706f 7369 7469 7665  st be a positive
+00036e80: 2069 6e74 6567 6572 2076 616c 7565 2e0a   integer value..
+00036e90: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00036ea0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00036eb0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00036ec0: 6172 6b2e 7769 6e64 6f77 2069 6d70 6f72  ark.window impor
+00036ed0: 7420 5769 6e64 6f77 0a20 2020 2020 2020  t Window.       
+00036ee0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00036ef0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00036f00: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+00036f10: 2020 2020 5b5b 2243 222c 2022 5350 5922      [["C", "SPY"
+00036f20: 2c20 335d 2c20 5b22 4322 2c20 2241 4150  , 3], ["C", "AAP
+00036f30: 4c22 2c20 3130 5d2c 205b 224e 222c 2022  L", 10], ["N", "
+00036f40: 5350 5922 2c20 355d 2c20 5b22 4e22 2c20  SPY", 5], ["N", 
+00036f50: 2241 4150 4c22 2c20 375d 2c20 5b22 5122  "AAPL", 7], ["Q"
+00036f60: 2c20 224d 5346 5422 2c20 335d 5d2c 0a20  , "MSFT", 3]],. 
+00036f70: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+00036f80: 6368 656d 613d 5b22 6578 6368 616e 6765  chema=["exchange
+00036f90: 222c 2022 7379 6d62 6f6c 222c 2022 7368  ", "symbol", "sh
+00036fa0: 6172 6573 225d 0a20 2020 2020 2020 202e  ares"].        .
+00036fb0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+00036fc0: 2064 662e 7365 6c65 6374 2863 6f6c 2822   df.select(col("
+00036fd0: 6578 6368 616e 6765 2229 2c20 636f 6c28  exchange"), col(
+00036fe0: 2273 796d 626f 6c22 292c 206e 7469 6c65  "symbol"), ntile
+00036ff0: 2833 292e 6f76 6572 2857 696e 646f 772e  (3).over(Window.
+00037000: 7061 7274 6974 696f 6e5f 6279 2822 6578  partition_by("ex
+00037010: 6368 616e 6765 2229 2e6f 7264 6572 5f62  change").order_b
+00037020: 7928 2273 6861 7265 7322 2929 2e61 6c69  y("shares")).ali
+00037030: 6173 2822 6e74 696c 655f 3322 2929 2e73  as("ntile_3")).s
+00037040: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+00037050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00037060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00037070: 2d2d 2d0a 2020 2020 2020 2020 7c22 4558  ---.        |"EX
+00037080: 4348 414e 4745 2220 207c 2253 594d 424f  CHANGE"  |"SYMBO
+00037090: 4c22 2020 7c22 4e54 494c 455f 3322 2020  L"  |"NTILE_3"  
+000370a0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+000370b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000370c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000370d0: 2020 2020 2020 2020 7c51 2020 2020 2020          |Q      
+000370e0: 2020 2020 207c 4d53 4654 2020 2020 2020       |MSFT      
+000370f0: 7c31 2020 2020 2020 2020 2020 7c0a 2020  |1          |.  
+00037100: 2020 2020 2020 7c4e 2020 2020 2020 2020        |N        
+00037110: 2020 207c 5350 5920 2020 2020 2020 7c31     |SPY       |1
+00037120: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00037130: 2020 2020 7c4e 2020 2020 2020 2020 2020      |N          
+00037140: 207c 4141 504c 2020 2020 2020 7c32 2020   |AAPL      |2  
+00037150: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00037160: 2020 7c43 2020 2020 2020 2020 2020 207c    |C           |
+00037170: 5350 5920 2020 2020 2020 7c31 2020 2020  SPY       |1    
+00037180: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00037190: 7c43 2020 2020 2020 2020 2020 207c 4141  |C           |AA
+000371a0: 504c 2020 2020 2020 7c32 2020 2020 2020  PL      |2      
+000371b0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+000371c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000371d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000371e0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+000371f0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00037200: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00037210: 6966 5f73 7472 5f6f 725f 696e 7428 652c  if_str_or_int(e,
+00037220: 2022 6e74 696c 6522 290a 2020 2020 7265   "ntile").    re
+00037230: 7475 726e 2062 7569 6c74 696e 2822 6e74  turn builtin("nt
+00037240: 696c 6522 2928 6329 0a0a 0a64 6566 2070  ile")(c)...def p
+00037250: 6572 6365 6e74 696c 655f 636f 6e74 2870  ercentile_cont(p
+00037260: 6572 6365 6e74 696c 653a 2066 6c6f 6174  ercentile: float
+00037270: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00037280: 2022 2222 0a20 2020 2052 6574 7572 6e20   """.    Return 
+00037290: 6120 7065 7263 656e 7469 6c65 2076 616c  a percentile val
+000372a0: 7565 2062 6173 6564 206f 6e20 6120 636f  ue based on a co
+000372b0: 6e74 696e 756f 7573 2064 6973 7472 6962  ntinuous distrib
+000372c0: 7574 696f 6e20 6f66 2074 6865 0a20 2020  ution of the.   
+000372d0: 2069 6e70 7574 2063 6f6c 756d 6e2e 2049   input column. I
+000372e0: 6620 6e6f 2069 6e70 7574 2072 6f77 206c  f no input row l
+000372f0: 6965 7320 6578 6163 746c 7920 6174 2074  ies exactly at t
+00037300: 6865 2064 6573 6972 6564 2070 6572 6365  he desired perce
+00037310: 6e74 696c 652c 0a20 2020 2074 6865 2072  ntile,.    the r
+00037320: 6573 756c 7420 6973 2063 616c 6375 6c61  esult is calcula
+00037330: 7465 6420 7573 696e 6720 6c69 6e65 6172  ted using linear
+00037340: 2069 6e74 6572 706f 6c61 7469 6f6e 206f   interpolation o
+00037350: 6620 7468 6520 7477 6f20 6e65 6172 6573  f the two neares
+00037360: 740a 2020 2020 696e 7075 7420 7661 6c75  t.    input valu
+00037370: 6573 2e20 4e55 4c4c 2076 616c 7565 7320  es. NULL values 
+00037380: 6172 6520 6967 6e6f 7265 6420 696e 2074  are ignored in t
+00037390: 6865 2063 616c 6375 6c61 7469 6f6e 2e0a  he calculation..
+000373a0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+000373b0: 2020 2070 6572 6365 6e74 696c 653a 2074     percentile: t
+000373c0: 6865 2070 6572 6365 6e74 696c 6520 6f66  he percentile of
+000373d0: 2074 6865 2076 616c 7565 2074 6861 7420   the value that 
+000373e0: 796f 7520 7761 6e74 2074 6f20 6669 6e64  you want to find
+000373f0: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00037400: 6520 7065 7263 656e 7469 6c65 206d 7573  e percentile mus
+00037410: 7420 6265 2061 2063 6f6e 7374 616e 7420  t be a constant 
+00037420: 6265 7477 6565 6e20 302e 3020 616e 6420  between 0.0 and 
+00037430: 312e 302e 2046 6f72 2065 7861 6d70 6c65  1.0. For example
+00037440: 2c0a 2020 2020 2020 2020 2020 2020 6966  ,.            if
+00037450: 2079 6f75 2077 616e 7420 746f 2066 696e   you want to fin
+00037460: 6420 7468 6520 7661 6c75 6520 6174 2074  d the value at t
+00037470: 6865 2039 3074 6820 7065 7263 656e 7469  he 90th percenti
+00037480: 6c65 2c20 7370 6563 6966 7920 302e 392e  le, specify 0.9.
+00037490: 0a0a 2020 2020 4578 616d 706c 653a 0a0a  ..    Example:..
+000374a0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000374b0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+000374c0: 6461 7461 6672 616d 6528 5b0a 2020 2020  dataframe([.    
+000374d0: 2020 2020 2e2e 2e20 2020 2020 2830 2c20      ...     (0, 
+000374e0: 3029 2c20 2830 2c20 3130 292c 2028 302c  0), (0, 10), (0,
+000374f0: 2032 3029 2c20 2830 2c20 3330 292c 2028   20), (0, 30), (
+00037500: 302c 2034 3029 2c0a 2020 2020 2020 2020  0, 40),.        
+00037510: 2e2e 2e20 2020 2020 2831 2c20 3130 292c  ...     (1, 10),
+00037520: 2028 312c 2032 3029 2c20 2832 2c20 3130   (1, 20), (2, 10
+00037530: 292c 2028 322c 2032 3029 2c20 2832 2c20  ), (2, 20), (2, 
+00037540: 3235 292c 0a20 2020 2020 2020 202e 2e2e  25),.        ...
+00037550: 2020 2020 2028 322c 2033 3029 2c20 2833       (2, 30), (3
+00037560: 2c20 3630 292c 2028 342c 204e 6f6e 6529  , 60), (4, None)
+00037570: 0a20 2020 2020 2020 202e 2e2e 205d 2c20  .        ... ], 
+00037580: 7363 6865 6d61 3d5b 226b 222c 2022 7622  schema=["k", "v"
+00037590: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+000375a0: 662e 6772 6f75 705f 6279 2822 6b22 292e  f.group_by("k").
+000375b0: 6167 6728 7065 7263 656e 7469 6c65 5f63  agg(percentile_c
+000375c0: 6f6e 7428 302e 3235 292e 7769 7468 696e  ont(0.25).within
+000375d0: 5f67 726f 7570 2822 7622 292e 6173 5f28  _group("v").as_(
+000375e0: 2270 6572 6365 6e74 696c 6522 2929 2e73  "percentile")).s
+000375f0: 6f72 7428 226b 2229 2e63 6f6c 6c65 6374  ort("k").collect
+00037600: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00037610: 4b3d 302c 2050 4552 4345 4e54 494c 453d  K=0, PERCENTILE=
+00037620: 4465 6369 6d61 6c28 2731 302e 3030 3027  Decimal('10.000'
+00037630: 2929 2c20 5c0a 526f 7728 4b3d 312c 2050  )), \.Row(K=1, P
+00037640: 4552 4345 4e54 494c 453d 4465 6369 6d61  ERCENTILE=Decima
+00037650: 6c28 2731 322e 3530 3027 2929 2c20 5c0a  l('12.500')), \.
+00037660: 526f 7728 4b3d 322c 2050 4552 4345 4e54  Row(K=2, PERCENT
+00037670: 494c 453d 4465 6369 6d61 6c28 2731 372e  ILE=Decimal('17.
+00037680: 3530 3027 2929 2c20 5c0a 526f 7728 4b3d  500')), \.Row(K=
+00037690: 332c 2050 4552 4345 4e54 494c 453d 4465  3, PERCENTILE=De
+000376a0: 6369 6d61 6c28 2736 302e 3030 3027 2929  cimal('60.000'))
+000376b0: 2c20 5c0a 526f 7728 4b3d 342c 2050 4552  , \.Row(K=4, PER
+000376c0: 4345 4e54 494c 453d 4e6f 6e65 295d 0a20  CENTILE=None)]. 
+000376d0: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+000376e0: 6e20 6275 696c 7469 6e28 2270 6572 6365  n builtin("perce
+000376f0: 6e74 696c 655f 636f 6e74 2229 2870 6572  ntile_cont")(per
+00037700: 6365 6e74 696c 6529 0a0a 0a64 6566 2067  centile)...def g
+00037710: 7265 6174 6573 7428 2a63 6f6c 756d 6e73  reatest(*columns
+00037720: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00037730: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00037740: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+00037750: 6865 206c 6172 6765 7374 2076 616c 7565  he largest value
+00037760: 2066 726f 6d20 6120 6c69 7374 206f 6620   from a list of 
+00037770: 6578 7072 6573 7369 6f6e 732e 0a20 2020  expressions..   
+00037780: 2049 6620 616e 7920 6f66 2074 6865 2061   If any of the a
+00037790: 7267 756d 656e 7420 7661 6c75 6573 2069  rgument values i
+000377a0: 7320 4e55 4c4c 2c20 7468 6520 7265 7375  s NULL, the resu
+000377b0: 6c74 2069 7320 4e55 4c4c 2e0a 2020 2020  lt is NULL..    
+000377c0: 4752 4541 5445 5354 2073 7570 706f 7274  GREATEST support
+000377d0: 7320 616c 6c20 6461 7461 2074 7970 6573  s all data types
+000377e0: 2c20 696e 636c 7564 696e 6720 5641 5249  , including VARI
+000377f0: 414e 542e 0a0a 2020 2020 4578 616d 706c  ANT...    Exampl
+00037800: 6573 3a3a 0a0a 2020 2020 2020 2020 3e3e  es::..        >>
+00037810: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00037820: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00037830: 5b5b 312c 2032 2c20 335d 2c20 5b32 2c20  [[1, 2, 3], [2, 
+00037840: 342c 202d 315d 2c20 5b33 2c20 362c 204e  4, -1], [3, 6, N
+00037850: 6f6e 655d 5d2c 2073 6368 656d 613d 5b22  one]], schema=["
+00037860: 6122 2c20 2262 222c 2022 6322 5d29 0a20  a", "b", "c"]). 
+00037870: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00037880: 6c65 6374 2867 7265 6174 6573 7428 6466  lect(greatest(df
+00037890: 5b22 6122 5d2c 2064 665b 2262 225d 2c20  ["a"], df["b"], 
+000378a0: 6466 5b22 6322 5d29 2e61 6c69 6173 2822  df["c"]).alias("
+000378b0: 6772 6561 7465 7374 2229 292e 636f 6c6c  greatest")).coll
+000378c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+000378d0: 6f77 2847 5245 4154 4553 543d 3329 2c20  ow(GREATEST=3), 
+000378e0: 526f 7728 4752 4541 5445 5354 3d34 292c  Row(GREATEST=4),
+000378f0: 2052 6f77 2847 5245 4154 4553 543d 4e6f   Row(GREATEST=No
+00037900: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
+00037910: 2063 203d 205b 5f74 6f5f 636f 6c5f 6966   c = [_to_col_if
+00037920: 5f73 7472 2865 782c 2022 6772 6561 7465  _str(ex, "greate
+00037930: 7374 2229 2066 6f72 2065 7820 696e 2063  st") for ex in c
+00037940: 6f6c 756d 6e73 5d0a 2020 2020 7265 7475  olumns].    retu
+00037950: 726e 2062 7569 6c74 696e 2822 6772 6561  rn builtin("grea
+00037960: 7465 7374 2229 282a 6329 0a0a 0a64 6566  test")(*c)...def
+00037970: 206c 6561 7374 282a 636f 6c75 6d6e 733a   least(*columns:
+00037980: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00037990: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000379a0: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
+000379b0: 6520 736d 616c 6c65 7374 2076 616c 7565  e smallest value
+000379c0: 2066 726f 6d20 6120 6c69 7374 206f 6620   from a list of 
+000379d0: 6578 7072 6573 7369 6f6e 732e 0a20 2020  expressions..   
+000379e0: 2049 6620 616e 7920 6f66 2074 6865 2061   If any of the a
+000379f0: 7267 756d 656e 7420 7661 6c75 6573 2069  rgument values i
+00037a00: 7320 4e55 4c4c 2c20 7468 6520 7265 7375  s NULL, the resu
+00037a10: 6c74 2069 7320 4e55 4c4c 2e0a 2020 2020  lt is NULL..    
+00037a20: 4c45 4153 5420 7375 7070 6f72 7473 2061  LEAST supports a
+00037a30: 6c6c 2064 6174 6120 7479 7065 732c 2069  ll data types, i
+00037a40: 6e63 6c75 6469 6e67 2056 4152 4941 4e54  ncluding VARIANT
+00037a50: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00037a60: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00037a70: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00037a80: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+00037a90: 2032 2c20 335d 2c20 5b32 2c20 342c 202d   2, 3], [2, 4, -
+00037aa0: 315d 2c20 5b33 2c20 362c 204e 6f6e 655d  1], [3, 6, None]
+00037ab0: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+00037ac0: 2262 222c 2022 6322 5d29 0a20 2020 2020  "b", "c"]).     
+00037ad0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00037ae0: 286c 6561 7374 2864 665b 2261 225d 2c20  (least(df["a"], 
+00037af0: 6466 5b22 6222 5d2c 2064 665b 2263 225d  df["b"], df["c"]
+00037b00: 292e 616c 6961 7328 226c 6561 7374 2229  ).alias("least")
+00037b10: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00037b20: 2020 2020 5b52 6f77 284c 4541 5354 3d31      [Row(LEAST=1
+00037b30: 292c 2052 6f77 284c 4541 5354 3d2d 3129  ), Row(LEAST=-1)
+00037b40: 2c20 526f 7728 4c45 4153 543d 4e6f 6e65  , Row(LEAST=None
+00037b50: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+00037b60: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
+00037b70: 7472 2865 782c 2022 6c65 6173 7422 2920  tr(ex, "least") 
+00037b80: 666f 7220 6578 2069 6e20 636f 6c75 6d6e  for ex in column
+00037b90: 735d 0a20 2020 2072 6574 7572 6e20 6275  s].    return bu
+00037ba0: 696c 7469 6e28 226c 6561 7374 2229 282a  iltin("least")(*
+00037bb0: 6329 0a0a 0a64 6566 206c 6973 7461 6767  c)...def listagg
+00037bc0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00037bd0: 2c20 6465 6c69 6d69 7465 723a 2073 7472  , delimiter: str
+00037be0: 203d 2022 222c 2069 735f 6469 7374 696e   = "", is_distin
+00037bf0: 6374 3a20 626f 6f6c 203d 2046 616c 7365  ct: bool = False
+00037c00: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00037c10: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00037c20: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
+00037c30: 6420 696e 7075 7420 7661 6c75 6573 2c20  d input values, 
+00037c40: 7365 7061 7261 7465 6420 6279 2060 6465  separated by `de
+00037c50: 6c69 6d69 7465 7260 2073 7472 696e 672e  limiter` string.
+00037c60: 0a20 2020 2053 6565 2060 4c49 5354 4147  .    See `LISTAG
+00037c70: 4720 3c68 7474 7073 3a2f 2f64 6f63 732e  G <https://docs.
+00037c80: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
+00037c90: 2f73 716c 2d72 6566 6572 656e 6365 2f66  /sql-reference/f
+00037ca0: 756e 6374 696f 6e73 2f6c 6973 7461 6767  unctions/listagg
+00037cb0: 2e68 746d 6c3e 605f 2066 6f72 2064 6574  .html>`_ for det
+00037cc0: 6169 6c73 2e0a 0a20 2020 2041 7267 733a  ails...    Args:
+00037cd0: 0a20 2020 2020 2020 2065 3a20 4120 3a63  .        e: A :c
+00037ce0: 6c61 7373 3a60 436f 6c75 6d6e 6020 6f62  lass:`Column` ob
+00037cf0: 6a65 6374 206f 7220 636f 6c75 6d6e 206e  ject or column n
+00037d00: 616d 6520 7468 6174 2064 6574 6572 6d69  ame that determi
+00037d10: 6e65 7320 7468 6520 7661 6c75 6573 0a20  nes the values. 
+00037d20: 2020 2020 2020 2020 2020 2074 6f20 6265             to be
+00037d30: 2070 7574 2069 6e74 6f20 7468 6520 6c69   put into the li
+00037d40: 7374 2e0a 2020 2020 2020 2020 6465 6c69  st..        deli
+00037d50: 6d69 7465 723a 2041 2073 7472 696e 6720  miter: A string 
+00037d60: 6465 6c69 6d69 7465 722e 0a20 2020 2020  delimiter..     
+00037d70: 2020 2069 735f 6469 7374 696e 6374 3a20     is_distinct: 
+00037d80: 5768 6574 6865 7220 7468 6520 696e 7075  Whether the inpu
+00037d90: 7420 6578 7072 6573 7369 6f6e 2069 7320  t expression is 
+00037da0: 6469 7374 696e 6374 2e0a 0a20 2020 2045  distinct...    E
+00037db0: 7861 6d70 6c65 733a 3a0a 0a20 2020 2020  xamples::..     
+00037dc0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00037dd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00037de0: 7261 6d65 285b 312c 2032 2c20 332c 2032  rame([1, 2, 3, 2
+00037df0: 2c20 342c 2035 5d2c 2073 6368 656d 613d  , 4, 5], schema=
+00037e00: 5b22 636f 6c22 5d29 0a20 2020 2020 2020  ["col"]).       
+00037e10: 203e 3e3e 2064 662e 7365 6c65 6374 286c   >>> df.select(l
+00037e20: 6973 7461 6767 2822 636f 6c22 2c20 222c  istagg("col", ",
+00037e30: 2229 2e77 6974 6869 6e5f 6772 6f75 7028  ").within_group(
+00037e40: 6466 5b22 636f 6c22 5d2e 6173 6328 2929  df["col"].asc())
+00037e50: 2e61 735f 2822 7265 7375 6c74 2229 292e  .as_("result")).
+00037e60: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00037e70: 2020 5b52 6f77 2852 4553 554c 543d 2731    [Row(RESULT='1
+00037e80: 2c32 2c32 2c33 2c34 2c35 2729 5d0a 2020  ,2,2,3,4,5')].  
+00037e90: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00037ea0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00037eb0: 226c 6973 7461 6767 2229 0a20 2020 2072  "listagg").    r
+00037ec0: 6574 7572 6e20 436f 6c75 6d6e 284c 6973  eturn Column(Lis
+00037ed0: 7441 6767 2863 2e5f 6578 7072 6573 7369  tAgg(c._expressi
+00037ee0: 6f6e 2c20 6465 6c69 6d69 7465 722c 2069  on, delimiter, i
+00037ef0: 735f 6469 7374 696e 6374 2929 0a0a 0a64  s_distinct))...d
+00037f00: 6566 2077 6865 6e5f 6d61 7463 6865 6428  ef when_matched(
+00037f10: 0a20 2020 2063 6f6e 6469 7469 6f6e 3a20  .    condition: 
+00037f20: 4f70 7469 6f6e 616c 5b43 6f6c 756d 6e5d  Optional[Column]
+00037f30: 203d 204e 6f6e 652c 0a29 202d 3e20 2273   = None,.) -> "s
+00037f40: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00037f50: 6b2e 7461 626c 652e 5768 656e 4d61 7463  k.table.WhenMatc
+00037f60: 6865 6443 6c61 7573 6522 3a0a 2020 2020  hedClause":.    
+00037f70: 2222 220a 2020 2020 5370 6563 6966 6965  """.    Specifie
+00037f80: 7320 6120 6d61 7463 6865 6420 636c 6175  s a matched clau
+00037f90: 7365 2066 6f72 2074 6865 203a 6d65 7468  se for the :meth
+00037fa0: 3a60 5461 626c 652e 6d65 7267 6520 3c73  :`Table.merge <s
+00037fb0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00037fc0: 6b2e 5461 626c 652e 6d65 7267 653e 6020  k.Table.merge>` 
+00037fd0: 6163 7469 6f6e 2e0a 2020 2020 5365 6520  action..    See 
+00037fe0: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
+00037ff0: 6b65 2e73 6e6f 7770 6172 6b2e 7461 626c  ke.snowpark.tabl
+00038000: 652e 5768 656e 4d61 7463 6865 6443 6c61  e.WhenMatchedCla
+00038010: 7573 6560 2066 6f72 2064 6574 6169 6c73  use` for details
+00038020: 2e0a 0a20 2020 2043 6f6e 7665 6e69 656e  ...    Convenien
+00038030: 6365 2066 756e 6374 696f 6e20 746f 2063  ce function to c
+00038040: 7265 6174 6520 6120 6e65 7720 5768 656e  reate a new When
+00038050: 4d61 7463 6865 6443 6c61 7573 6520 696e  MatchedClause in
+00038060: 7374 616e 6365 2077 6869 6368 2069 7320  stance which is 
+00038070: 7265 7175 6972 6564 2074 6f67 6574 6865  required togethe
+00038080: 7220 7769 7468 2061 6e20 6163 7469 6f6e  r with an action
+00038090: 2077 6865 6e20 6d65 7267 696e 670a 2020   when merging.  
+000380a0: 2020 6120 536e 6f77 7061 726b 2074 6162    a Snowpark tab
+000380b0: 6c65 2077 6974 6820 6120 536e 6f77 7061  le with a Snowpa
+000380c0: 726b 2044 6174 6146 7261 6d65 2028 7365  rk DataFrame (se
+000380d0: 6520 736e 6f77 666c 616b 652e 736e 6f77  e snowflake.snow
+000380e0: 7061 726b 2e54 6162 6c65 2e6d 6572 6765  park.Table.merge
+000380f0: 2066 6f72 206d 6f72 6520 6465 7461 696c   for more detail
+00038100: 7329 2e0a 0a20 2020 2045 7861 6d70 6c65  s)...    Example
+00038110: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00038120: 7461 7267 6574 5f64 6620 3d20 7365 7373  target_df = sess
+00038130: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00038140: 7261 6d65 285b 2831 302c 2022 6f6c 6422  rame([(10, "old"
+00038150: 292c 2028 3130 2c20 2274 6f6f 5f6f 6c64  ), (10, "too_old
+00038160: 2229 2c20 2831 312c 2022 6f6c 6422 295d  "), (11, "old")]
+00038170: 2c20 7363 6865 6d61 3d5b 226b 6579 222c  , schema=["key",
+00038180: 2022 7661 6c75 6522 5d29 0a20 2020 2020   "value"]).     
+00038190: 2020 203e 3e3e 2074 6172 6765 745f 6466     >>> target_df
+000381a0: 2e77 7269 7465 2e73 6176 655f 6173 5f74  .write.save_as_t
+000381b0: 6162 6c65 2822 6d79 5f74 6162 6c65 222c  able("my_table",
+000381c0: 206d 6f64 653d 226f 7665 7277 7269 7465   mode="overwrite
+000381d0: 222c 2074 6162 6c65 5f74 7970 653d 2274  ", table_type="t
+000381e0: 656d 706f 7261 7279 2229 0a20 2020 2020  emporary").     
+000381f0: 2020 203e 3e3e 2074 6172 6765 7420 3d20     >>> target = 
+00038200: 7365 7373 696f 6e2e 7461 626c 6528 226d  session.table("m
+00038210: 795f 7461 626c 6522 290a 2020 2020 2020  y_table").      
+00038220: 2020 3e3e 3e20 736f 7572 6365 203d 2073    >>> source = s
+00038230: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00038240: 7461 6672 616d 6528 5b28 3130 2c20 226e  taframe([(10, "n
+00038250: 6577 2229 2c20 2831 322c 2022 6e65 7722  ew"), (12, "new"
+00038260: 292c 2028 3133 2c20 226f 6c64 2229 5d2c  ), (13, "old")],
+00038270: 2073 6368 656d 613d 5b22 6b65 7922 2c20   schema=["key", 
+00038280: 2276 616c 7565 225d 290a 2020 2020 2020  "value"]).      
+00038290: 2020 3e3e 3e20 7461 7267 6574 2e6d 6572    >>> target.mer
+000382a0: 6765 2873 6f75 7263 652c 2028 7461 7267  ge(source, (targ
+000382b0: 6574 5b22 6b65 7922 5d20 3d3d 2073 6f75  et["key"] == sou
+000382c0: 7263 655b 226b 6579 225d 2920 2620 2874  rce["key"]) & (t
+000382d0: 6172 6765 745b 2276 616c 7565 225d 203d  arget["value"] =
+000382e0: 3d20 2274 6f6f 5f6f 6c64 2229 2c0a 2020  = "too_old"),.  
+000382f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00038300: 2020 2020 2020 205b 7768 656e 5f6d 6174         [when_mat
+00038310: 6368 6564 2829 2e75 7064 6174 6528 7b22  ched().update({"
+00038320: 7661 6c75 6522 3a20 736f 7572 6365 5b22  value": source["
+00038330: 7661 6c75 6522 5d7d 295d 290a 2020 2020  value"]})]).    
+00038340: 2020 2020 4d65 7267 6552 6573 756c 7428      MergeResult(
+00038350: 726f 7773 5f69 6e73 6572 7465 643d 302c  rows_inserted=0,
+00038360: 2072 6f77 735f 7570 6461 7465 643d 312c   rows_updated=1,
+00038370: 2072 6f77 735f 6465 6c65 7465 643d 3029   rows_deleted=0)
+00038380: 0a20 2020 2020 2020 203e 3e3e 2074 6172  .        >>> tar
+00038390: 6765 742e 636f 6c6c 6563 7428 290a 2020  get.collect().  
+000383a0: 2020 2020 2020 5b52 6f77 284b 4559 3d31        [Row(KEY=1
+000383b0: 302c 2056 414c 5545 3d27 6f6c 6427 292c  0, VALUE='old'),
+000383c0: 2052 6f77 284b 4559 3d31 302c 2056 414c   Row(KEY=10, VAL
+000383d0: 5545 3d27 6e65 7727 292c 2052 6f77 284b  UE='new'), Row(K
+000383e0: 4559 3d31 312c 2056 414c 5545 3d27 6f6c  EY=11, VALUE='ol
+000383f0: 6427 295d 0a0a 2020 2020 2222 220a 2020  d')]..    """.  
+00038400: 2020 7265 7475 726e 2073 6e6f 7766 6c61    return snowfla
+00038410: 6b65 2e73 6e6f 7770 6172 6b2e 7461 626c  ke.snowpark.tabl
+00038420: 652e 5768 656e 4d61 7463 6865 6443 6c61  e.WhenMatchedCla
+00038430: 7573 6528 636f 6e64 6974 696f 6e29 0a0a  use(condition)..
+00038440: 0a64 6566 2077 6865 6e5f 6e6f 745f 6d61  .def when_not_ma
+00038450: 7463 6865 6428 0a20 2020 2063 6f6e 6469  tched(.    condi
+00038460: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b43  tion: Optional[C
+00038470: 6f6c 756d 6e5d 203d 204e 6f6e 652c 0a29  olumn] = None,.)
+00038480: 202d 3e20 2273 6e6f 7766 6c61 6b65 2e73   -> "snowflake.s
+00038490: 6e6f 7770 6172 6b2e 7461 626c 652e 5768  nowpark.table.Wh
+000384a0: 656e 4e6f 744d 6174 6368 6564 436c 6175  enNotMatchedClau
+000384b0: 7365 223a 0a20 2020 2022 2222 0a20 2020  se":.    """.   
+000384c0: 2053 7065 6369 6669 6573 2061 206e 6f74   Specifies a not
+000384d0: 2d6d 6174 6368 6564 2063 6c61 7573 6520  -matched clause 
+000384e0: 666f 7220 7468 6520 3a6d 6574 683a 6054  for the :meth:`T
+000384f0: 6162 6c65 2e6d 6572 6765 203c 736e 6f77  able.merge <snow
+00038500: 666c 616b 652e 736e 6f77 7061 726b 2e54  flake.snowpark.T
+00038510: 6162 6c65 2e6d 6572 6765 3e60 2061 6374  able.merge>` act
+00038520: 696f 6e2e 0a20 2020 2053 6565 203a 636c  ion..    See :cl
+00038530: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+00038540: 736e 6f77 7061 726b 2e74 6162 6c65 2e57  snowpark.table.W
+00038550: 6865 6e4e 6f74 4d61 7463 6865 6443 6c61  henNotMatchedCla
+00038560: 7573 6560 2066 6f72 2064 6574 6169 6c73  use` for details
+00038570: 2e0a 0a20 2020 2043 6f6e 7665 6e69 656e  ...    Convenien
+00038580: 6365 2066 756e 6374 696f 6e20 746f 2063  ce function to c
+00038590: 7265 6174 6520 6120 6e65 7720 5768 656e  reate a new When
+000385a0: 4e6f 744d 6174 6368 6564 436c 6175 7365  NotMatchedClause
+000385b0: 2069 6e73 7461 6e63 6520 7768 6963 6820   instance which 
+000385c0: 6973 2072 6571 7569 7265 6420 746f 6765  is required toge
+000385d0: 7468 6572 2077 6974 6820 616e 2061 6374  ther with an act
+000385e0: 696f 6e20 7768 656e 206d 6572 6769 6e67  ion when merging
+000385f0: 0a20 2020 2061 2053 6e6f 7770 6172 6b20  .    a Snowpark 
+00038600: 7461 626c 6520 7769 7468 2061 2053 6e6f  table with a Sno
+00038610: 7770 6172 6b20 4461 7461 4672 616d 6520  wpark DataFrame 
+00038620: 2873 6565 2073 6e6f 7766 6c61 6b65 2e73  (see snowflake.s
+00038630: 6e6f 7770 6172 6b2e 5461 626c 652e 6d65  nowpark.Table.me
+00038640: 7267 6520 666f 7220 6d6f 7265 2064 6574  rge for more det
+00038650: 6169 6c73 292e 0a0a 2020 2020 4578 616d  ails)...    Exam
+00038660: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00038670: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+00038680: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00038690: 2069 6d70 6f72 7420 496e 7465 6765 7254   import IntegerT
+000386a0: 7970 652c 2053 7472 696e 6754 7970 652c  ype, StringType,
+000386b0: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
+000386c0: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
+000386d0: 203e 3e3e 2073 6368 656d 6120 3d20 5374   >>> schema = St
+000386e0: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
+000386f0: 4669 656c 6428 226b 6579 222c 2049 6e74  Field("key", Int
+00038700: 6567 6572 5479 7065 2829 292c 2053 7472  egerType()), Str
+00038710: 7563 7446 6965 6c64 2822 7661 6c75 6522  uctField("value"
+00038720: 2c20 5374 7269 6e67 5479 7065 2829 295d  , StringType())]
+00038730: 290a 2020 2020 2020 2020 3e3e 3e20 7461  ).        >>> ta
+00038740: 7267 6574 5f64 6620 3d20 7365 7373 696f  rget_df = sessio
+00038750: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00038760: 6d65 285b 2831 302c 2022 6f6c 6422 292c  me([(10, "old"),
+00038770: 2028 3130 2c20 2274 6f6f 5f6f 6c64 2229   (10, "too_old")
+00038780: 2c20 2831 312c 2022 6f6c 6422 295d 2c20  , (11, "old")], 
+00038790: 7363 6865 6d61 3d73 6368 656d 6129 0a20  schema=schema). 
+000387a0: 2020 2020 2020 203e 3e3e 2074 6172 6765         >>> targe
+000387b0: 745f 6466 2e77 7269 7465 2e73 6176 655f  t_df.write.save_
+000387c0: 6173 5f74 6162 6c65 2822 6d79 5f74 6162  as_table("my_tab
+000387d0: 6c65 222c 206d 6f64 653d 226f 7665 7277  le", mode="overw
+000387e0: 7269 7465 222c 2074 6162 6c65 5f74 7970  rite", table_typ
+000387f0: 653d 2274 656d 706f 7261 7279 2229 0a20  e="temporary"). 
+00038800: 2020 2020 2020 203e 3e3e 2074 6172 6765         >>> targe
+00038810: 7420 3d20 7365 7373 696f 6e2e 7461 626c  t = session.tabl
+00038820: 6528 226d 795f 7461 626c 6522 290a 2020  e("my_table").  
+00038830: 2020 2020 2020 3e3e 3e20 736f 7572 6365        >>> source
+00038840: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00038850: 655f 6461 7461 6672 616d 6528 5b28 3130  e_dataframe([(10
+00038860: 2c20 226e 6577 2229 2c20 2831 322c 2022  , "new"), (12, "
+00038870: 6e65 7722 292c 2028 3133 2c20 226f 6c64  new"), (13, "old
+00038880: 2229 5d2c 2073 6368 656d 613d 7363 6865  ")], schema=sche
+00038890: 6d61 290a 2020 2020 2020 2020 3e3e 3e20  ma).        >>> 
+000388a0: 7461 7267 6574 2e6d 6572 6765 2873 6f75  target.merge(sou
+000388b0: 7263 652c 2028 7461 7267 6574 5b22 6b65  rce, (target["ke
+000388c0: 7922 5d20 3d3d 2073 6f75 7263 655b 226b  y"] == source["k
+000388d0: 6579 225d 2920 2620 2874 6172 6765 745b  ey"]) & (target[
+000388e0: 2276 616c 7565 225d 203d 3d20 2274 6f6f  "value"] == "too
+000388f0: 5f6f 6c64 2229 2c0a 2020 2020 2020 2020  _old"),.        
+00038900: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00038910: 205b 7768 656e 5f6e 6f74 5f6d 6174 6368   [when_not_match
+00038920: 6564 2829 2e69 6e73 6572 7428 7b22 6b65  ed().insert({"ke
+00038930: 7922 3a20 736f 7572 6365 5b22 6b65 7922  y": source["key"
+00038940: 5d7d 295d 290a 2020 2020 2020 2020 4d65  ]})]).        Me
+00038950: 7267 6552 6573 756c 7428 726f 7773 5f69  rgeResult(rows_i
+00038960: 6e73 6572 7465 643d 322c 2072 6f77 735f  nserted=2, rows_
+00038970: 7570 6461 7465 643d 302c 2072 6f77 735f  updated=0, rows_
+00038980: 6465 6c65 7465 643d 3029 0a20 2020 2020  deleted=0).     
+00038990: 2020 203e 3e3e 2074 6172 6765 742e 736f     >>> target.so
+000389a0: 7274 2863 6f6c 2822 6b65 7922 292c 2063  rt(col("key"), c
+000389b0: 6f6c 2822 7661 6c75 6522 2929 2e63 6f6c  ol("value")).col
+000389c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000389d0: 526f 7728 4b45 593d 3130 2c20 5641 4c55  Row(KEY=10, VALU
+000389e0: 453d 276f 6c64 2729 2c20 526f 7728 4b45  E='old'), Row(KE
+000389f0: 593d 3130 2c20 5641 4c55 453d 2774 6f6f  Y=10, VALUE='too
+00038a00: 5f6f 6c64 2729 2c20 526f 7728 4b45 593d  _old'), Row(KEY=
+00038a10: 3131 2c20 5641 4c55 453d 276f 6c64 2729  11, VALUE='old')
+00038a20: 2c20 526f 7728 4b45 593d 3132 2c20 5641  , Row(KEY=12, VA
+00038a30: 4c55 453d 4e6f 6e65 292c 2052 6f77 284b  LUE=None), Row(K
+00038a40: 4559 3d31 332c 2056 414c 5545 3d4e 6f6e  EY=13, VALUE=Non
+00038a50: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00038a60: 7265 7475 726e 2073 6e6f 7766 6c61 6b65  return snowflake
+00038a70: 2e73 6e6f 7770 6172 6b2e 7461 626c 652e  .snowpark.table.
+00038a80: 5768 656e 4e6f 744d 6174 6368 6564 436c  WhenNotMatchedCl
+00038a90: 6175 7365 2863 6f6e 6469 7469 6f6e 290a  ause(condition).
+00038aa0: 0a0a 6465 6620 7564 6628 0a20 2020 2066  ..def udf(.    f
+00038ab0: 756e 633a 204f 7074 696f 6e61 6c5b 4361  unc: Optional[Ca
+00038ac0: 6c6c 6162 6c65 5d20 3d20 4e6f 6e65 2c0a  llable] = None,.
+00038ad0: 2020 2020 2a2c 0a20 2020 2072 6574 7572      *,.    retur
+00038ae0: 6e5f 7479 7065 3a20 4f70 7469 6f6e 616c  n_type: Optional
+00038af0: 5b44 6174 6154 7970 655d 203d 204e 6f6e  [DataType] = Non
+00038b00: 652c 0a20 2020 2069 6e70 7574 5f74 7970  e,.    input_typ
+00038b10: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
+00038b20: 745b 4461 7461 5479 7065 5d5d 203d 204e  t[DataType]] = N
+00038b30: 6f6e 652c 0a20 2020 206e 616d 653a 204f  one,.    name: O
+00038b40: 7074 696f 6e61 6c5b 556e 696f 6e5b 7374  ptional[Union[st
+00038b50: 722c 2049 7465 7261 626c 655b 7374 725d  r, Iterable[str]
+00038b60: 5d5d 203d 204e 6f6e 652c 0a20 2020 2069  ]] = None,.    i
+00038b70: 735f 7065 726d 616e 656e 743a 2062 6f6f  s_permanent: boo
+00038b80: 6c20 3d20 4661 6c73 652c 0a20 2020 2073  l = False,.    s
+00038b90: 7461 6765 5f6c 6f63 6174 696f 6e3a 204f  tage_location: O
+00038ba0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00038bb0: 6f6e 652c 0a20 2020 2069 6d70 6f72 7473  one,.    imports
+00038bc0: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+00038bd0: 556e 696f 6e5b 7374 722c 2054 7570 6c65  Union[str, Tuple
+00038be0: 5b73 7472 2c20 7374 725d 5d5d 5d20 3d20  [str, str]]]] = 
+00038bf0: 4e6f 6e65 2c0a 2020 2020 7061 636b 6167  None,.    packag
+00038c00: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
+00038c10: 745b 556e 696f 6e5b 7374 722c 204d 6f64  t[Union[str, Mod
+00038c20: 756c 6554 7970 655d 5d5d 203d 204e 6f6e  uleType]]] = Non
+00038c30: 652c 0a20 2020 2072 6570 6c61 6365 3a20  e,.    replace: 
+00038c40: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00038c50: 2020 6966 5f6e 6f74 5f65 7869 7374 733a    if_not_exists:
+00038c60: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00038c70: 2020 2073 6573 7369 6f6e 3a20 4f70 7469     session: Opti
+00038c80: 6f6e 616c 5b22 736e 6f77 666c 616b 652e  onal["snowflake.
+00038c90: 736e 6f77 7061 726b 2e73 6573 7369 6f6e  snowpark.session
+00038ca0: 2e53 6573 7369 6f6e 225d 203d 204e 6f6e  .Session"] = Non
+00038cb0: 652c 0a20 2020 2070 6172 616c 6c65 6c3a  e,.    parallel:
+00038cc0: 2069 6e74 203d 2034 2c0a 2020 2020 6d61   int = 4,.    ma
+00038cd0: 785f 6261 7463 685f 7369 7a65 3a20 4f70  x_batch_size: Op
+00038ce0: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00038cf0: 6e65 2c0a 2020 2020 7374 6174 656d 656e  ne,.    statemen
+00038d00: 745f 7061 7261 6d73 3a20 4f70 7469 6f6e  t_params: Option
+00038d10: 616c 5b44 6963 745b 7374 722c 2073 7472  al[Dict[str, str
+00038d20: 5d5d 203d 204e 6f6e 652c 0a20 2020 2073  ]] = None,.    s
+00038d30: 6f75 7263 655f 636f 6465 5f64 6973 706c  ource_code_displ
+00038d40: 6179 3a20 626f 6f6c 203d 2054 7275 652c  ay: bool = True,
+00038d50: 0a20 2020 2073 7472 6963 743a 2062 6f6f  .    strict: boo
+00038d60: 6c20 3d20 4661 6c73 652c 0a20 2020 2073  l = False,.    s
+00038d70: 6563 7572 653a 2062 6f6f 6c20 3d20 4661  ecure: bool = Fa
+00038d80: 6c73 652c 0a29 202d 3e20 556e 696f 6e5b  lse,.) -> Union[
+00038d90: 5573 6572 4465 6669 6e65 6446 756e 6374  UserDefinedFunct
+00038da0: 696f 6e2c 2066 756e 6374 6f6f 6c73 2e70  ion, functools.p
+00038db0: 6172 7469 616c 5d3a 0a20 2020 2022 2222  artial]:.    """
+00038dc0: 5265 6769 7374 6572 7320 6120 5079 7468  Registers a Pyth
+00038dd0: 6f6e 2066 756e 6374 696f 6e20 6173 2061  on function as a
+00038de0: 2053 6e6f 7766 6c61 6b65 2050 7974 686f   Snowflake Pytho
+00038df0: 6e20 5544 4620 616e 6420 7265 7475 726e  n UDF and return
+00038e00: 7320 7468 6520 5544 462e 0a0a 2020 2020  s the UDF...    
+00038e10: 4974 2063 616e 2062 6520 7573 6564 2061  It can be used a
+00038e20: 7320 6569 7468 6572 2061 2066 756e 6374  s either a funct
+00038e30: 696f 6e20 6361 6c6c 206f 7220 6120 6465  ion call or a de
+00038e40: 636f 7261 746f 722e 2049 6e20 6d6f 7374  corator. In most
+00038e50: 2063 6173 6573 2079 6f75 2077 6f72 6b20   cases you work 
+00038e60: 7769 7468 2061 2073 696e 676c 6520 7365  with a single se
+00038e70: 7373 696f 6e2e 0a20 2020 2054 6869 7320  ssion..    This 
+00038e80: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
+00038e90: 6174 2073 6573 7369 6f6e 2074 6f20 7265  at session to re
+00038ea0: 6769 7374 6572 2074 6865 2055 4446 2e20  gister the UDF. 
+00038eb0: 4966 2079 6f75 2068 6176 6520 6d75 6c74  If you have mult
+00038ec0: 6970 6c65 2073 6573 7369 6f6e 732c 2079  iple sessions, y
+00038ed0: 6f75 206e 6565 6420 746f 0a20 2020 2065  ou need to.    e
+00038ee0: 7870 6c69 6369 746c 7920 7370 6563 6966  xplicitly specif
+00038ef0: 7920 7468 6520 6060 7365 7373 696f 6e60  y the ``session`
+00038f00: 6020 7061 7261 6d65 7465 7220 6f66 2074  ` parameter of t
+00038f10: 6869 7320 6675 6e63 7469 6f6e 2e20 4966  his function. If
+00038f20: 2079 6f75 2068 6176 6520 6120 6675 6e63   you have a func
+00038f30: 7469 6f6e 2061 6e64 2077 6f75 6c64 0a20  tion and would. 
+00038f40: 2020 206c 696b 6520 746f 2072 6567 6973     like to regis
+00038f50: 7465 7220 6974 2074 6f20 6d75 6c74 6970  ter it to multip
+00038f60: 6c65 2064 6174 6162 6173 6573 2c20 7573  le databases, us
+00038f70: 6520 6060 7365 7373 696f 6e2e 7564 662e  e ``session.udf.
+00038f80: 7265 6769 7374 6572 6060 2069 6e73 7465  register`` inste
+00038f90: 6164 2e20 5365 6520 6578 616d 706c 6573  ad. See examples
+00038fa0: 0a20 2020 2069 6e20 3a63 6c61 7373 3a60  .    in :class:`
+00038fb0: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00038fc0: 6172 6b2e 7564 662e 5544 4652 6567 6973  ark.udf.UDFRegis
+00038fd0: 7472 6174 696f 6e60 2e0a 0a20 2020 2041  tration`...    A
+00038fe0: 7267 733a 0a20 2020 2020 2020 2066 756e  rgs:.        fun
+00038ff0: 633a 2041 2050 7974 686f 6e20 6675 6e63  c: A Python func
+00039000: 7469 6f6e 2075 7365 6420 666f 7220 6372  tion used for cr
+00039010: 6561 7469 6e67 2074 6865 2055 4446 2e0a  eating the UDF..
+00039020: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
+00039030: 7970 653a 2041 203a 636c 6173 733a 607e  ype: A :class:`~
+00039040: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00039050: 726b 2e74 7970 6573 2e44 6174 6154 7970  rk.types.DataTyp
+00039060: 6560 2072 6570 7265 7365 6e74 696e 6720  e` representing 
+00039070: 7468 6520 7265 7475 726e 2064 6174 610a  the return data.
+00039080: 2020 2020 2020 2020 2020 2020 7479 7065              type
+00039090: 206f 6620 7468 6520 5544 462e 204f 7074   of the UDF. Opt
+000390a0: 696f 6e61 6c20 6966 2074 7970 6520 6869  ional if type hi
+000390b0: 6e74 7320 6172 6520 7072 6f76 6964 6564  nts are provided
+000390c0: 2e0a 2020 2020 2020 2020 696e 7075 745f  ..        input_
+000390d0: 7479 7065 733a 2041 206c 6973 7420 6f66  types: A list of
+000390e0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+000390f0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+00039100: 6573 2e44 6174 6154 7970 6560 0a20 2020  es.DataType`.   
+00039110: 2020 2020 2020 2020 2072 6570 7265 7365           represe
+00039120: 6e74 696e 6720 7468 6520 696e 7075 7420  nting the input 
+00039130: 6461 7461 2074 7970 6573 206f 6620 7468  data types of th
+00039140: 6520 5544 462e 204f 7074 696f 6e61 6c20  e UDF. Optional 
+00039150: 6966 0a20 2020 2020 2020 2020 2020 2074  if.            t
+00039160: 7970 6520 6869 6e74 7320 6172 6520 7072  ype hints are pr
+00039170: 6f76 6964 6564 2e0a 2020 2020 2020 2020  ovided..        
+00039180: 6e61 6d65 3a20 4120 7374 7269 6e67 206f  name: A string o
+00039190: 7220 6c69 7374 206f 6620 7374 7269 6e67  r list of string
+000391a0: 7320 7468 6174 2073 7065 6369 6679 2074  s that specify t
+000391b0: 6865 206e 616d 6520 6f72 2066 756c 6c79  he name or fully
+000391c0: 2d71 7561 6c69 6669 6564 0a20 2020 2020  -qualified.     
+000391d0: 2020 2020 2020 206f 626a 6563 7420 6964         object id
+000391e0: 656e 7469 6669 6572 2028 6461 7461 6261  entifier (databa
+000391f0: 7365 206e 616d 652c 2073 6368 656d 6120  se name, schema 
+00039200: 6e61 6d65 2c20 616e 6420 6675 6e63 7469  name, and functi
+00039210: 6f6e 206e 616d 6529 2066 6f72 0a20 2020  on name) for.   
+00039220: 2020 2020 2020 2020 2074 6865 2055 4446           the UDF
+00039230: 2069 6e20 536e 6f77 666c 616b 652c 2077   in Snowflake, w
+00039240: 6869 6368 2061 6c6c 6f77 7320 796f 7520  hich allows you 
+00039250: 746f 2063 616c 6c20 7468 6973 2055 4446  to call this UDF
+00039260: 2069 6e20 6120 5351 4c0a 2020 2020 2020   in a SQL.      
+00039270: 2020 2020 2020 636f 6d6d 616e 6420 6f72        command or
+00039280: 2076 6961 203a 6675 6e63 3a60 6361 6c6c   via :func:`call
+00039290: 5f75 6466 2829 602e 2049 6620 6974 2069  _udf()`. If it i
+000392a0: 7320 6e6f 7420 7072 6f76 6964 6564 2c20  s not provided, 
+000392b0: 6120 6e61 6d65 2077 696c 6c0a 2020 2020  a name will.    
+000392c0: 2020 2020 2020 2020 6265 2061 7574 6f6d          be autom
+000392d0: 6174 6963 616c 6c79 2067 656e 6572 6174  atically generat
+000392e0: 6564 2066 6f72 2074 6865 2055 4446 2e20  ed for the UDF. 
+000392f0: 4120 6e61 6d65 206d 7573 7420 6265 2073  A name must be s
+00039300: 7065 6369 6669 6564 2077 6865 6e0a 2020  pecified when.  
+00039310: 2020 2020 2020 2020 2020 6060 6973 5f70            ``is_p
+00039320: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
+00039330: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
+00039340: 6973 5f70 6572 6d61 6e65 6e74 3a20 5768  is_permanent: Wh
+00039350: 6574 6865 7220 746f 2063 7265 6174 6520  ether to create 
+00039360: 6120 7065 726d 616e 656e 7420 5544 462e  a permanent UDF.
+00039370: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+00039380: 6060 4661 6c73 6560 602e 0a20 2020 2020  ``False``..     
+00039390: 2020 2020 2020 2049 6620 6974 2069 7320         If it is 
+000393a0: 6060 5472 7565 6060 2c20 6120 7661 6c69  ``True``, a vali
+000393b0: 6420 6060 7374 6167 655f 6c6f 6361 7469  d ``stage_locati
+000393c0: 6f6e 6060 206d 7573 7420 6265 2070 726f  on`` must be pro
+000393d0: 7669 6465 642e 0a20 2020 2020 2020 2073  vided..        s
+000393e0: 7461 6765 5f6c 6f63 6174 696f 6e3a 2054  tage_location: T
+000393f0: 6865 2073 7461 6765 206c 6f63 6174 696f  he stage locatio
+00039400: 6e20 7768 6572 6520 7468 6520 5079 7468  n where the Pyth
+00039410: 6f6e 2066 696c 6520 666f 7220 7468 6520  on file for the 
+00039420: 5544 460a 2020 2020 2020 2020 2020 2020  UDF.            
+00039430: 616e 6420 6974 7320 6465 7065 6e64 656e  and its dependen
+00039440: 6369 6573 2073 686f 756c 6420 6265 2075  cies should be u
+00039450: 706c 6f61 6465 642e 2054 6865 2073 7461  ploaded. The sta
+00039460: 6765 206c 6f63 6174 696f 6e20 6d75 7374  ge location must
+00039470: 2062 6520 7370 6563 6966 6965 640a 2020   be specified.  
+00039480: 2020 2020 2020 2020 2020 7768 656e 2060            when `
+00039490: 6069 735f 7065 726d 616e 656e 7460 6020  `is_permanent`` 
+000394a0: 6973 2060 6054 7275 6560 602c 2061 6e64  is ``True``, and
+000394b0: 2069 7420 7769 6c6c 2062 6520 6967 6e6f   it will be igno
+000394c0: 7265 6420 7768 656e 0a20 2020 2020 2020  red when.       
+000394d0: 2020 2020 2060 6069 735f 7065 726d 616e       ``is_perman
+000394e0: 656e 7460 6020 6973 2060 6046 616c 7365  ent`` is ``False
+000394f0: 6060 2e20 4974 2063 616e 2062 6520 616e  ``. It can be an
+00039500: 7920 7374 6167 6520 6f74 6865 7220 7468  y stage other th
+00039510: 616e 2074 656d 706f 7261 7279 0a20 2020  an temporary.   
+00039520: 2020 2020 2020 2020 2073 7461 6765 7320           stages 
+00039530: 616e 6420 6578 7465 726e 616c 2073 7461  and external sta
+00039540: 6765 732e 0a20 2020 2020 2020 2069 6d70  ges..        imp
+00039550: 6f72 7473 3a20 4120 6c69 7374 206f 6620  orts: A list of 
+00039560: 696d 706f 7274 7320 7468 6174 206f 6e6c  imports that onl
+00039570: 7920 6170 706c 7920 746f 2074 6869 7320  y apply to this 
+00039580: 5544 462e 2059 6f75 2063 616e 2075 7365  UDF. You can use
+00039590: 2061 2073 7472 696e 6720 746f 0a20 2020   a string to.   
+000395a0: 2020 2020 2020 2020 2072 6570 7265 7365           represe
+000395b0: 6e74 2061 2066 696c 6520 7061 7468 2028  nt a file path (
+000395c0: 7369 6d69 6c61 7220 746f 2074 6865 2060  similar to the `
+000395d0: 6070 6174 6860 6020 6172 6775 6d65 6e74  `path`` argument
+000395e0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
+000395f0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+00039600: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+00039610: 6f6e 2e61 6464 5f69 6d70 6f72 7460 2920  on.add_import`) 
+00039620: 696e 2074 6869 7320 6c69 7374 2c20 6f72  in this list, or
+00039630: 2061 2074 7570 6c65 206f 6620 7477 6f0a   a tuple of two.
+00039640: 2020 2020 2020 2020 2020 2020 7374 7269              stri
+00039650: 6e67 7320 746f 2072 6570 7265 7365 6e74  ngs to represent
+00039660: 2061 2066 696c 6520 7061 7468 2061 6e64   a file path and
+00039670: 2061 6e20 696d 706f 7274 2070 6174 6820   an import path 
+00039680: 2873 696d 696c 6172 2074 6f20 7468 6520  (similar to the 
+00039690: 6060 696d 706f 7274 5f70 6174 6860 600a  ``import_path``.
+000396a0: 2020 2020 2020 2020 2020 2020 6172 6775              argu
+000396b0: 6d65 6e74 2069 6e20 3a6d 6574 683a 607e  ment in :meth:`~
+000396c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000396d0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+000396e0: 6d70 6f72 7460 292e 2054 6865 7365 2055  mport`). These U
+000396f0: 4446 2d6c 6576 656c 2069 6d70 6f72 7473  DF-level imports
+00039700: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00039710: 6c20 6f76 6572 7269 6465 2074 6865 2073  l override the s
+00039720: 6573 7369 6f6e 2d6c 6576 656c 2069 6d70  ession-level imp
+00039730: 6f72 7473 2061 6464 6564 2062 790a 2020  orts added by.  
+00039740: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+00039750: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00039760: 7061 726b 2e53 6573 7369 6f6e 2e61 6464  park.Session.add
+00039770: 5f69 6d70 6f72 7460 2e20 4e6f 7465 2074  _import`. Note t
+00039780: 6861 7420 616e 2065 6d70 7479 206c 6973  hat an empty lis
+00039790: 7420 6d65 616e 730a 2020 2020 2020 2020  t means.        
+000397a0: 2020 2020 6e6f 2069 6d70 6f72 7420 666f      no import fo
+000397b0: 7220 7468 6973 2055 4446 2c20 616e 6420  r this UDF, and 
+000397c0: 6060 4e6f 6e65 6060 206f 7220 6e6f 7420  ``None`` or not 
+000397d0: 7370 6563 6966 7969 6e67 2074 6869 7320  specifying this 
+000397e0: 7061 7261 6d65 7465 7220 6d65 616e 7320  parameter means 
+000397f0: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
+00039800: 2020 7365 7373 696f 6e2d 6c65 7665 6c20    session-level 
+00039810: 696d 706f 7274 732e 0a20 2020 2020 2020  imports..       
+00039820: 2070 6163 6b61 6765 733a 2041 206c 6973   packages: A lis
+00039830: 7420 6f66 2070 6163 6b61 6765 7320 7468  t of packages th
+00039840: 6174 206f 6e6c 7920 6170 706c 7920 746f  at only apply to
+00039850: 2074 6869 7320 5544 462e 2054 6865 7365   this UDF. These
+00039860: 2055 4446 2d6c 6576 656c 2070 6163 6b61   UDF-level packa
+00039870: 6765 730a 2020 2020 2020 2020 2020 2020  ges.            
+00039880: 7769 6c6c 206f 7665 7272 6964 6520 7468  will override th
+00039890: 6520 7365 7373 696f 6e2d 6c65 7665 6c20  e session-level 
+000398a0: 7061 636b 6167 6573 2061 6464 6564 2062  packages added b
+000398b0: 790a 2020 2020 2020 2020 2020 2020 3a6d  y.            :m
+000398c0: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
+000398d0: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+000398e0: 2e61 6464 5f70 6163 6b61 6765 7360 2061  .add_packages` a
+000398f0: 6e64 0a20 2020 2020 2020 2020 2020 203a  nd.            :
+00039900: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
+00039910: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
+00039920: 6e2e 6164 645f 7265 7175 6972 656d 656e  n.add_requiremen
+00039930: 7473 602e 204e 6f74 6520 7468 6174 2061  ts`. Note that a
+00039940: 6e20 656d 7074 7920 6c69 7374 206d 6561  n empty list mea
+00039950: 6e73 0a20 2020 2020 2020 2020 2020 206e  ns.            n
+00039960: 6f20 7061 636b 6167 6520 666f 7220 7468  o package for th
+00039970: 6973 2055 4446 2c20 616e 6420 6060 4e6f  is UDF, and ``No
+00039980: 6e65 6060 206f 7220 6e6f 7420 7370 6563  ne`` or not spec
+00039990: 6966 7969 6e67 2074 6869 7320 7061 7261  ifying this para
+000399a0: 6d65 7465 7220 6d65 616e 7320 7573 696e  meter means usin
+000399b0: 670a 2020 2020 2020 2020 2020 2020 7365  g.            se
+000399c0: 7373 696f 6e2d 6c65 7665 6c20 7061 636b  ssion-level pack
+000399d0: 6167 6573 2e20 546f 2075 7365 2050 7974  ages. To use Pyt
+000399e0: 686f 6e20 7061 636b 6167 6573 2074 6861  hon packages tha
+000399f0: 7420 6172 6520 6e6f 7420 6176 6169 6c61  t are not availa
+00039a00: 626c 6520 696e 2053 6e6f 7766 6c61 6b65  ble in Snowflake
+00039a10: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00039a20: 6665 7220 746f 203a 6d65 7468 3a60 7e73  fer to :meth:`~s
+00039a30: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00039a40: 6b2e 5365 7373 696f 6e2e 6375 7374 6f6d  k.Session.custom
+00039a50: 5f70 6163 6b61 6765 5f75 7361 6765 5f63  _package_usage_c
+00039a60: 6f6e 6669 6760 2e0a 2020 2020 2020 2020  onfig`..        
+00039a70: 7265 706c 6163 653a 2057 6865 7468 6572  replace: Whether
+00039a80: 2074 6f20 7265 706c 6163 6520 6120 5544   to replace a UD
+00039a90: 4620 7468 6174 2061 6c72 6561 6479 2077  F that already w
+00039aa0: 6173 2072 6567 6973 7465 7265 642e 2054  as registered. T
+00039ab0: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
+00039ac0: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+00039ad0: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
+00039ae0: 4661 6c73 6560 602c 2061 7474 656d 7074  False``, attempt
+00039af0: 696e 6720 746f 2072 6567 6973 7465 7220  ing to register 
+00039b00: 6120 5544 4620 7769 7468 2061 206e 616d  a UDF with a nam
+00039b10: 6520 7468 6174 2061 6c72 6561 6479 2065  e that already e
+00039b20: 7869 7374 730a 2020 2020 2020 2020 2020  xists.          
+00039b30: 2020 7265 7375 6c74 7320 696e 2061 2060    results in a `
+00039b40: 6053 6e6f 7770 6172 6b53 514c 4578 6365  `SnowparkSQLExce
+00039b50: 7074 696f 6e60 6020 6578 6365 7074 696f  ption`` exceptio
+00039b60: 6e20 6265 696e 6720 7468 726f 776e 2e20  n being thrown. 
+00039b70: 4966 2069 7420 6973 2060 6054 7275 6560  If it is ``True`
+00039b80: 602c 0a20 2020 2020 2020 2020 2020 2061  `,.            a
+00039b90: 6e20 6578 6973 7469 6e67 2055 4446 2077  n existing UDF w
+00039ba0: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
+00039bb0: 6520 6973 206f 7665 7277 7269 7474 656e  e is overwritten
+00039bc0: 2e0a 2020 2020 2020 2020 6966 5f6e 6f74  ..        if_not
+00039bd0: 5f65 7869 7374 733a 2057 6865 7468 6572  _exists: Whether
+00039be0: 2074 6f20 736b 6970 2063 7265 6174 696f   to skip creatio
+00039bf0: 6e20 6f66 2061 2055 4446 2077 6865 6e20  n of a UDF when 
+00039c00: 6f6e 6520 7769 7468 2074 6865 2073 616d  one with the sam
+00039c10: 6520 7369 676e 6174 7572 6520 616c 7265  e signature alre
+00039c20: 6164 7920 6578 6973 7473 2e0a 2020 2020  ady exists..    
+00039c30: 2020 2020 2020 2020 5468 6520 6465 6661          The defa
+00039c40: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+00039c50: 2e20 6060 6966 5f6e 6f74 5f65 7869 7374  . ``if_not_exist
+00039c60: 7360 6020 616e 6420 6060 7265 706c 6163  s`` and ``replac
+00039c70: 6560 6020 6172 6520 6d75 7475 616c 6c79  e`` are mutually
+00039c80: 2065 7863 6c75 7369 7665 0a20 2020 2020   exclusive.     
+00039c90: 2020 2020 2020 2061 6e64 2061 2060 6056         and a ``V
+00039ca0: 616c 7565 4572 726f 7260 6020 6973 2072  alueError`` is r
+00039cb0: 6169 7365 6420 7768 656e 2062 6f74 6820  aised when both 
+00039cc0: 6172 6520 7365 742e 2049 6620 6974 2069  are set. If it i
+00039cd0: 7320 6060 5472 7565 6060 2061 6e64 2061  s ``True`` and a
+00039ce0: 2055 4446 2077 6974 680a 2020 2020 2020   UDF with.      
+00039cf0: 2020 2020 2020 7468 6520 7361 6d65 2073        the same s
+00039d00: 6967 6e61 7475 7265 2065 7869 7374 732c  ignature exists,
+00039d10: 2074 6865 2055 4446 2063 7265 6174 696f   the UDF creatio
+00039d20: 6e20 6973 2073 6b69 7070 6564 2e0a 2020  n is skipped..  
+00039d30: 2020 2020 2020 7365 7373 696f 6e3a 2055        session: U
+00039d40: 7365 2074 6869 7320 7365 7373 696f 6e20  se this session 
+00039d50: 746f 2072 6567 6973 7465 7220 7468 6520  to register the 
+00039d60: 5544 462e 2049 6620 6974 2773 206e 6f74  UDF. If it's not
+00039d70: 2073 7065 6369 6669 6564 2c20 7468 6520   specified, the 
+00039d80: 7365 7373 696f 6e20 7468 6174 2079 6f75  session that you
+00039d90: 2063 7265 6174 6564 2062 6566 6f72 6520   created before 
+00039da0: 6361 6c6c 696e 6720 7468 6973 2066 756e  calling this fun
+00039db0: 6374 696f 6e20 7769 6c6c 2062 6520 7573  ction will be us
+00039dc0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+00039dd0: 596f 7520 6e65 6564 2074 6f20 7370 6563  You need to spec
+00039de0: 6966 7920 7468 6973 2070 6172 616d 6574  ify this paramet
+00039df0: 6572 2069 6620 796f 7520 6861 7665 2063  er if you have c
+00039e00: 7265 6174 6564 206d 756c 7469 706c 6520  reated multiple 
+00039e10: 7365 7373 696f 6e73 2062 6566 6f72 6520  sessions before 
+00039e20: 6361 6c6c 696e 6720 7468 6973 206d 6574  calling this met
+00039e30: 686f 642e 0a20 2020 2020 2020 2070 6172  hod..        par
+00039e40: 616c 6c65 6c3a 2054 6865 206e 756d 6265  allel: The numbe
+00039e50: 7220 6f66 2074 6872 6561 6473 2074 6f20  r of threads to 
+00039e60: 7573 6520 666f 7220 7570 6c6f 6164 696e  use for uploadin
+00039e70: 6720 5544 4620 6669 6c65 7320 7769 7468  g UDF files with
+00039e80: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00039e90: 2060 5055 5420 3c68 7474 7073 3a2f 2f64   `PUT <https://d
+00039ea0: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
+00039eb0: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
+00039ec0: 6365 2f73 716c 2f70 7574 2e68 746d 6c23  ce/sql/put.html#
+00039ed0: 7075 743e 605f 0a20 2020 2020 2020 2020  put>`_.         
+00039ee0: 2020 2063 6f6d 6d61 6e64 2e20 5468 6520     command. The 
+00039ef0: 6465 6661 756c 7420 7661 6c75 6520 6973  default value is
+00039f00: 2034 2061 6e64 2073 7570 706f 7274 6564   4 and supported
+00039f10: 2076 616c 7565 7320 6172 6520 6672 6f6d   values are from
+00039f20: 2031 2074 6f20 3939 2e0a 2020 2020 2020   1 to 99..      
+00039f30: 2020 2020 2020 496e 6372 6561 7369 6e67        Increasing
+00039f40: 2074 6865 206e 756d 6265 7220 6f66 2074   the number of t
+00039f50: 6872 6561 6473 2063 616e 2069 6d70 726f  hreads can impro
+00039f60: 7665 2070 6572 666f 726d 616e 6365 2077  ve performance w
+00039f70: 6865 6e20 7570 6c6f 6164 696e 670a 2020  hen uploading.  
+00039f80: 2020 2020 2020 2020 2020 6c61 7267 6520            large 
+00039f90: 5544 4620 6669 6c65 732e 0a20 2020 2020  UDF files..     
+00039fa0: 2020 206d 6178 5f62 6174 6368 5f73 697a     max_batch_siz
+00039fb0: 653a 2054 6865 206d 6178 696d 756d 206e  e: The maximum n
+00039fc0: 756d 6265 7220 6f66 2072 6f77 7320 7065  umber of rows pe
+00039fd0: 7220 696e 7075 7420 5061 6e64 6173 2044  r input Pandas D
+00039fe0: 6174 6146 7261 6d65 206f 7220 5061 6e64  ataFrame or Pand
+00039ff0: 6173 2053 6572 6965 730a 2020 2020 2020  as Series.      
+0003a000: 2020 2020 2020 696e 7369 6465 2061 2076        inside a v
+0003a010: 6563 746f 7269 7a65 6420 5544 462e 2042  ectorized UDF. B
+0003a020: 6563 6175 7365 2061 2076 6563 746f 7269  ecause a vectori
+0003a030: 7a65 6420 5544 4620 7769 6c6c 2062 6520  zed UDF will be 
+0003a040: 6578 6563 7574 6564 2077 6974 6869 6e20  executed within 
+0003a050: 6120 7469 6d65 206c 696d 6974 2c0a 2020  a time limit,.  
+0003a060: 2020 2020 2020 2020 2020 7768 6963 6820            which 
+0003a070: 6973 2060 3630 6020 7365 636f 6e64 732c  is `60` seconds,
+0003a080: 2074 6869 7320 6f70 7469 6f6e 616c 2061   this optional a
+0003a090: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
+0003a0a0: 7365 6420 746f 2072 6564 7563 6520 7468  sed to reduce th
+0003a0b0: 6520 7275 6e6e 696e 6720 7469 6d65 206f  e running time o
+0003a0c0: 660a 2020 2020 2020 2020 2020 2020 6576  f.            ev
+0003a0d0: 6572 7920 6261 7463 6820 6279 2073 6574  ery batch by set
+0003a0e0: 7469 6e67 2061 2073 6d61 6c6c 6572 2062  ting a smaller b
+0003a0f0: 6174 6368 2073 697a 652e 204e 6f74 6520  atch size. Note 
+0003a100: 7468 6174 2073 6574 7469 6e67 2061 206c  that setting a l
+0003a110: 6172 6765 7220 7661 6c75 6520 646f 6573  arger value does
+0003a120: 206e 6f74 0a20 2020 2020 2020 2020 2020   not.           
+0003a130: 2067 7561 7261 6e74 6565 2074 6861 7420   guarantee that 
+0003a140: 536e 6f77 666c 616b 6520 7769 6c6c 2065  Snowflake will e
+0003a150: 6e63 6f64 6520 6261 7463 6865 7320 7769  ncode batches wi
+0003a160: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
+0003a170: 206e 756d 6265 7220 6f66 2072 6f77 732e   number of rows.
+0003a180: 2049 7420 7769 6c6c 0a20 2020 2020 2020   It will.       
+0003a190: 2020 2020 2062 6520 6967 6e6f 7265 6420       be ignored 
+0003a1a0: 7768 656e 2072 6567 6973 7465 7269 6e67  when registering
+0003a1b0: 2061 206e 6f6e 2d76 6563 746f 7269 7a65   a non-vectorize
+0003a1c0: 6420 5544 462e 0a20 2020 2020 2020 2073  d UDF..        s
+0003a1d0: 7461 7465 6d65 6e74 5f70 6172 616d 733a  tatement_params:
+0003a1e0: 2044 6963 7469 6f6e 6172 7920 6f66 2073   Dictionary of s
+0003a1f0: 7461 7465 6d65 6e74 206c 6576 656c 2070  tatement level p
+0003a200: 6172 616d 6574 6572 7320 746f 2062 6520  arameters to be 
+0003a210: 7365 7420 7768 696c 6520 6578 6563 7574  set while execut
+0003a220: 696e 6720 7468 6973 2061 6374 696f 6e2e  ing this action.
+0003a230: 0a20 2020 2020 2020 2073 6f75 7263 655f  .        source_
+0003a240: 636f 6465 5f64 6973 706c 6179 3a20 4469  code_display: Di
+0003a250: 7370 6c61 7920 7468 6520 736f 7572 6365  splay the source
+0003a260: 2063 6f64 6520 6f66 2074 6865 2055 4446   code of the UDF
+0003a270: 2060 6675 6e63 6020 6173 2063 6f6d 6d65   `func` as comme
+0003a280: 6e74 7320 696e 2074 6865 2067 656e 6572  nts in the gener
+0003a290: 6174 6564 2073 6372 6970 742e 0a20 2020  ated script..   
+0003a2a0: 2020 2020 2020 2020 2054 6865 2073 6f75           The sou
+0003a2b0: 7263 6520 636f 6465 2069 7320 6479 6e61  rce code is dyna
+0003a2c0: 6d69 6361 6c6c 7920 6765 6e65 7261 7465  mically generate
+0003a2d0: 6420 7468 6572 6566 6f72 6520 6974 206d  d therefore it m
+0003a2e0: 6179 206e 6f74 2062 6520 6964 656e 7469  ay not be identi
+0003a2f0: 6361 6c20 746f 2068 6f77 2074 6865 0a20  cal to how the. 
+0003a300: 2020 2020 2020 2020 2020 2060 6675 6e63             `func
+0003a310: 6020 6973 206f 7269 6769 6e61 6c6c 7920  ` is originally 
+0003a320: 6465 6669 6e65 642e 2054 6865 2064 6566  defined. The def
+0003a330: 6175 6c74 2069 7320 6060 5472 7565 6060  ault is ``True``
+0003a340: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0003a350: 2069 7420 6973 2060 6046 616c 7365 6060   it is ``False``
+0003a360: 2c20 736f 7572 6365 2063 6f64 6520 7769  , source code wi
+0003a370: 6c6c 206e 6f74 2062 6520 6765 6e65 7261  ll not be genera
+0003a380: 7465 6420 6f72 2064 6973 706c 6179 6564  ted or displayed
+0003a390: 2e0a 2020 2020 2020 2020 7374 7269 6374  ..        strict
+0003a3a0: 3a20 5768 6574 6865 7220 7468 6520 6372  : Whether the cr
+0003a3b0: 6561 7465 6420 5544 4620 6973 2073 7472  eated UDF is str
+0003a3c0: 6963 742e 2041 2073 7472 6963 7420 5544  ict. A strict UD
+0003a3d0: 4620 7769 6c6c 206e 6f74 2069 6e76 6f6b  F will not invok
+0003a3e0: 6520 7468 6520 5544 4620 6966 2061 6e79  e the UDF if any
+0003a3f0: 2069 6e70 7574 2069 730a 2020 2020 2020   input is.      
+0003a400: 2020 2020 2020 6e75 6c6c 2e20 496e 7374        null. Inst
+0003a410: 6561 642c 2061 206e 756c 6c20 7661 6c75  ead, a null valu
+0003a420: 6520 7769 6c6c 2061 6c77 6179 7320 6265  e will always be
+0003a430: 2072 6574 7572 6e65 6420 666f 7220 7468   returned for th
+0003a440: 6174 2072 6f77 2e20 4e6f 7465 2074 6861  at row. Note tha
+0003a450: 7420 7468 6520 5544 4620 6d69 6768 740a  t the UDF might.
+0003a460: 2020 2020 2020 2020 2020 2020 7374 696c              stil
+0003a470: 6c20 7265 7475 726e 206e 756c 6c20 666f  l return null fo
+0003a480: 7220 6e6f 6e2d 6e75 6c6c 2069 6e70 7574  r non-null input
+0003a490: 732e 0a20 2020 2020 2020 2073 6563 7572  s..        secur
+0003a4a0: 653a 2057 6865 7468 6572 2074 6865 2063  e: Whether the c
+0003a4b0: 7265 6174 6564 2055 4446 2069 7320 7365  reated UDF is se
+0003a4c0: 6375 7265 2e20 466f 7220 6d6f 7265 2069  cure. For more i
+0003a4d0: 6e66 6f72 6d61 7469 6f6e 2061 626f 7574  nformation about
+0003a4e0: 2073 6563 7572 6520 6675 6e63 7469 6f6e   secure function
+0003a4f0: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+0003a500: 6565 2060 5365 6375 7265 2055 4446 7320  ee `Secure UDFs 
+0003a510: 3c68 7474 7073 3a2f 2f64 6f63 732e 736e  <https://docs.sn
+0003a520: 6f77 666c 616b 652e 636f 6d2f 656e 2f73  owflake.com/en/s
+0003a530: 716c 2d72 6566 6572 656e 6365 2f75 6466  ql-reference/udf
+0003a540: 2d73 6563 7572 652e 6874 6d6c 3e60 5f2e  -secure.html>`_.
+0003a550: 0a0a 2020 2020 5265 7475 726e 733a 0a20  ..    Returns:. 
+0003a560: 2020 2020 2020 2041 2055 4446 2066 756e         A UDF fun
+0003a570: 6374 696f 6e20 7468 6174 2063 616e 2062  ction that can b
+0003a580: 6520 6361 6c6c 6564 2077 6974 6820 3a63  e called with :c
+0003a590: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
+0003a5a0: 2e73 6e6f 7770 6172 6b2e 436f 6c75 6d6e  .snowpark.Column
+0003a5b0: 6020 6578 7072 6573 7369 6f6e 732e 0a0a  ` expressions...
+0003a5c0: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
+0003a5d0: 2020 312e 2057 6865 6e20 7479 7065 2068    1. When type h
+0003a5e0: 696e 7473 2061 7265 2070 726f 7669 6465  ints are provide
+0003a5f0: 6420 616e 6420 6172 6520 636f 6d70 6c65  d and are comple
+0003a600: 7465 2066 6f72 2061 2066 756e 6374 696f  te for a functio
+0003a610: 6e2c 0a20 2020 2020 2020 2060 6072 6574  n,.        ``ret
+0003a620: 7572 6e5f 7479 7065 6060 2061 6e64 2060  urn_type`` and `
+0003a630: 6069 6e70 7574 5f74 7970 6573 6060 2061  `input_types`` a
+0003a640: 7265 206f 7074 696f 6e61 6c20 616e 6420  re optional and 
+0003a650: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
+0003a660: 0a20 2020 2020 2020 2053 6565 2064 6574  .        See det
+0003a670: 6169 6c73 206f 6620 7375 7070 6f72 7465  ails of supporte
+0003a680: 6420 6461 7461 2074 7970 6573 2066 6f72  d data types for
+0003a690: 2055 4446 7320 696e 0a20 2020 2020 2020   UDFs in.       
+0003a6a0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+0003a6b0: 616b 652e 736e 6f77 7061 726b 2e75 6466  ake.snowpark.udf
+0003a6c0: 2e55 4446 5265 6769 7374 7261 7469 6f6e  .UDFRegistration
+0003a6d0: 602e 0a0a 2020 2020 2020 2020 2020 2020  `...            
+0003a6e0: 2d20 596f 7520 6361 6e20 7573 6520 7573  - You can use us
+0003a6f0: 6520 3a61 7474 723a 607e 736e 6f77 666c  e :attr:`~snowfl
+0003a700: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0003a710: 6573 2e56 6172 6961 6e74 6020 746f 0a20  es.Variant` to. 
+0003a720: 2020 2020 2020 2020 2020 2020 2061 6e6e               ann
+0003a730: 6f74 6174 6520 6120 7661 7269 616e 742c  otate a variant,
+0003a740: 2061 6e64 2075 7365 203a 6174 7472 3a60   and use :attr:`
+0003a750: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003a760: 6172 6b2e 7479 7065 732e 4765 6f67 7261  ark.types.Geogra
+0003a770: 7068 7960 0a20 2020 2020 2020 2020 2020  phy`.           
+0003a780: 2020 206f 7220 3a61 7474 723a 607e 736e     or :attr:`~sn
+0003a790: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003a7a0: 2e74 7970 6573 2e47 656f 6d65 7472 7960  .types.Geometry`
+0003a7b0: 2074 6f20 616e 6e6f 7461 7465 2067 656f   to annotate geo
+0003a7c0: 7370 6174 6961 6c0a 2020 2020 2020 2020  spatial.        
+0003a7d0: 2020 2020 2020 7479 7065 7320 7768 656e        types when
+0003a7e0: 2064 6566 696e 696e 6720 6120 5544 462e   defining a UDF.
+0003a7f0: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0003a800: 596f 7520 6361 6e20 7573 6520 7573 6520  You can use use 
+0003a810: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
+0003a820: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0003a830: 2e50 616e 6461 7353 6572 6965 7360 2074  .PandasSeries` t
+0003a840: 6f20 616e 6e6f 7461 7465 0a20 2020 2020  o annotate.     
+0003a850: 2020 2020 2020 2020 2061 2050 616e 6461           a Panda
+0003a860: 7320 5365 7269 6573 2c20 616e 6420 7573  s Series, and us
+0003a870: 6520 3a61 7474 723a 607e 736e 6f77 666c  e :attr:`~snowfl
+0003a880: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0003a890: 6573 2e50 616e 6461 7344 6174 6146 7261  es.PandasDataFra
+0003a8a0: 6d65 600a 2020 2020 2020 2020 2020 2020  me`.            
+0003a8b0: 2020 746f 2061 6e6e 6f74 6174 6520 6120    to annotate a 
+0003a8c0: 5061 6e64 6173 2044 6174 6146 7261 6d65  Pandas DataFrame
+0003a8d0: 2077 6865 6e20 6465 6669 6e69 6e67 2061   when defining a
+0003a8e0: 2076 6563 746f 7269 7a65 6420 5544 462e   vectorized UDF.
+0003a8f0: 0a20 2020 2020 2020 2020 2020 2020 204e  .              N
+0003a900: 6f74 6520 7468 6174 2074 6865 7920 6172  ote that they ar
+0003a910: 6520 6765 6e65 7269 6320 7479 7065 7320  e generic types 
+0003a920: 736f 2079 6f75 2063 616e 2073 7065 6369  so you can speci
+0003a930: 6679 2074 6865 2065 6c65 6d65 6e74 2074  fy the element t
+0003a940: 7970 6520 696e 2061 0a20 2020 2020 2020  ype in a.       
+0003a950: 2020 2020 2020 2050 616e 6461 7320 5365         Pandas Se
+0003a960: 7269 6573 2061 6e64 2044 6174 6146 7261  ries and DataFra
+0003a970: 6d65 2e0a 0a20 2020 2020 2020 2020 2020  me...           
+0003a980: 202d 203a 636c 6173 733a 6074 7970 696e   - :class:`typin
+0003a990: 672e 556e 696f 6e60 2069 7320 6e6f 7420  g.Union` is not 
+0003a9a0: 6120 7661 6c69 6420 7479 7065 2061 6e6e  a valid type ann
+0003a9b0: 6f74 6174 696f 6e20 666f 7220 5544 4673  otation for UDFs
+0003a9c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003a9d0: 6275 7420 3a63 6c61 7373 3a60 7479 7069  but :class:`typi
+0003a9e0: 6e67 2e4f 7074 696f 6e61 6c60 2063 616e  ng.Optional` can
+0003a9f0: 2062 6520 7573 6564 2074 6f20 696e 6469   be used to indi
+0003aa00: 6361 7465 2074 6865 206f 7074 696f 6e61  cate the optiona
+0003aa10: 6c20 7479 7065 2e0a 0a20 2020 2020 2020  l type...       
+0003aa20: 2020 2020 202d 2054 7970 6520 6869 6e74       - Type hint
+0003aa30: 7320 6172 6520 6e6f 7420 7375 7070 6f72  s are not suppor
+0003aa40: 7465 6420 6f6e 2066 756e 6374 696f 6e73  ted on functions
+0003aa50: 2064 6563 6f72 6174 6564 2077 6974 6820   decorated with 
+0003aa60: 6465 636f 7261 746f 7273 2e0a 0a20 2020  decorators...   
+0003aa70: 2020 2020 2032 2e20 4120 7465 6d70 6f72       2. A tempor
+0003aa80: 6172 7920 5544 4620 2877 6865 6e20 6060  ary UDF (when ``
+0003aa90: 6973 5f70 6572 6d61 6e65 6e74 6060 2069  is_permanent`` i
+0003aaa0: 7320 6060 4661 6c73 6560 6029 2069 7320  s ``False``) is 
+0003aab0: 7363 6f70 6564 2074 6f20 7468 6973 2060  scoped to this `
+0003aac0: 6073 6573 7369 6f6e 6060 0a20 2020 2020  `session``.     
+0003aad0: 2020 2061 6e64 2061 6c6c 2055 4446 2072     and all UDF r
+0003aae0: 656c 6174 6564 2066 696c 6573 2077 696c  elated files wil
+0003aaf0: 6c20 6265 2075 706c 6f61 6465 6420 746f  l be uploaded to
+0003ab00: 2061 2074 656d 706f 7261 7279 2073 6573   a temporary ses
+0003ab10: 7369 6f6e 2073 7461 6765 0a20 2020 2020  sion stage.     
+0003ab20: 2020 2028 3a66 756e 633a 6073 6573 7369     (:func:`sessi
+0003ab30: 6f6e 2e67 6574 5f73 6573 7369 6f6e 5f73  on.get_session_s
+0003ab40: 7461 6765 2829 203c 736e 6f77 666c 616b  tage() <snowflak
+0003ab50: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+0003ab60: 6f6e 2e67 6574 5f73 6573 7369 6f6e 5f73  on.get_session_s
+0003ab70: 7461 6765 3e60 292e 0a20 2020 2020 2020  tage>`)..       
+0003ab80: 2046 6f72 2061 2070 6572 6d61 6e65 6e74   For a permanent
+0003ab90: 2055 4446 2c20 7468 6573 6520 6669 6c65   UDF, these file
+0003aba0: 7320 7769 6c6c 2062 6520 7570 6c6f 6164  s will be upload
+0003abb0: 6564 2074 6f20 7468 6520 7374 6167 6520  ed to the stage 
+0003abc0: 7468 6174 2079 6f75 2070 726f 7669 6465  that you provide
+0003abd0: 2e0a 0a20 2020 2020 2020 2033 2e20 4279  ...        3. By
+0003abe0: 2064 6566 6175 6c74 2c20 5544 4620 7265   default, UDF re
+0003abf0: 6769 7374 7261 7469 6f6e 2066 6169 6c73  gistration fails
+0003ac00: 2069 6620 6120 6675 6e63 7469 6f6e 2077   if a function w
+0003ac10: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
+0003ac20: 6520 6973 2061 6c72 6561 6479 0a20 2020  e is already.   
+0003ac30: 2020 2020 2072 6567 6973 7465 7265 642e       registered.
+0003ac40: 2049 6e76 6f6b 696e 6720 3a66 756e 633a   Invoking :func:
+0003ac50: 6075 6466 6020 7769 7468 2060 6072 6570  `udf` with ``rep
+0003ac60: 6c61 6365 6060 2073 6574 2074 6f20 6060  lace`` set to ``
+0003ac70: 5472 7565 6060 2077 696c 6c20 6f76 6572  True`` will over
+0003ac80: 7772 6974 6520 7468 650a 2020 2020 2020  write the.      
+0003ac90: 2020 7072 6576 696f 7573 6c79 2072 6567    previously reg
+0003aca0: 6973 7465 7265 6420 6675 6e63 7469 6f6e  istered function
+0003acb0: 2e0a 0a20 2020 2020 2020 2034 2e20 5768  ...        4. Wh
+0003acc0: 656e 2072 6567 6973 7465 7269 6e67 2061  en registering a
+0003acd0: 2076 6563 746f 7269 7a65 6420 5544 462c   vectorized UDF,
+0003ace0: 2060 6070 616e 6461 7360 6020 6c69 6272   ``pandas`` libr
+0003acf0: 6172 7920 7769 6c6c 2062 6520 6164 6465  ary will be adde
+0003ad00: 6420 6173 2061 2070 6163 6b61 6765 0a20  d as a package. 
+0003ad10: 2020 2020 2020 2061 7574 6f6d 6174 6963         automatic
+0003ad20: 616c 6c79 2c20 7769 7468 2074 6865 206c  ally, with the l
+0003ad30: 6174 6573 7420 7665 7273 696f 6e20 6f6e  atest version on
+0003ad40: 2074 6865 2053 6e6f 7766 6c61 6b65 2073   the Snowflake s
+0003ad50: 6572 7665 722e 2049 6620 796f 7520 646f  erver. If you do
+0003ad60: 6e27 7420 7761 6e74 2074 6f0a 2020 2020  n't want to.    
+0003ad70: 2020 2020 7573 6520 7468 6973 2076 6572      use this ver
+0003ad80: 7369 6f6e 2c20 796f 7520 6361 6e20 6f76  sion, you can ov
+0003ad90: 6572 7772 6974 6520 6974 2062 7920 6164  erwrite it by ad
+0003ada0: 6469 6e67 2060 7061 6e64 6173 6020 7769  ding `pandas` wi
+0003adb0: 7468 2073 7065 6369 6669 6320 7665 7273  th specific vers
+0003adc0: 696f 6e0a 2020 2020 2020 2020 7265 7175  ion.        requ
+0003add0: 6972 656d 656e 7420 7573 696e 6720 6060  irement using ``
+0003ade0: 7061 636b 6167 6560 6020 6172 6775 6d65  package`` argume
+0003adf0: 6e74 206f 7220 3a6d 6574 683a 607e 736e  nt or :meth:`~sn
+0003ae00: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003ae10: 2e53 6573 7369 6f6e 2e61 6464 5f70 6163  .Session.add_pac
+0003ae20: 6b61 6765 7360 2e0a 0a20 2020 2053 6565  kages`...    See
+0003ae30: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
+0003ae40: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+0003ae50: 652e 736e 6f77 7061 726b 2e75 6466 2e55  e.snowpark.udf.U
+0003ae60: 4446 5265 6769 7374 7261 7469 6f6e 600a  DFRegistration`.
+0003ae70: 0a20 2020 2055 4446 7320 6361 6e20 6265  .    UDFs can be
+0003ae80: 2063 7265 6174 6564 2061 7320 616e 6f6e   created as anon
+0003ae90: 796d 6f75 7320 5544 4673 0a0a 2020 2020  ymous UDFs..    
+0003aea0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0003aeb0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0003aec0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003aed0: 7970 6573 2069 6d70 6f72 7420 496e 7465  ypes import Inte
+0003aee0: 6765 7254 7970 650a 2020 2020 2020 2020  gerType.        
+0003aef0: 3e3e 3e20 6164 645f 6f6e 6520 3d20 7564  >>> add_one = ud
+0003af00: 6628 6c61 6d62 6461 2078 3a20 782b 312c  f(lambda x: x+1,
+0003af10: 2072 6574 7572 6e5f 7479 7065 3d49 6e74   return_type=Int
+0003af20: 6567 6572 5479 7065 2829 2c20 696e 7075  egerType(), inpu
+0003af30: 745f 7479 7065 733d 5b49 6e74 6567 6572  t_types=[Integer
+0003af40: 5479 7065 2829 5d29 0a20 2020 2020 2020  Type()]).       
+0003af50: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0003af60: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0003af70: 6d65 285b 312c 2032 2c20 335d 2c20 7363  me([1, 2, 3], sc
+0003af80: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0003af90: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0003afa0: 7428 6164 645f 6f6e 6528 636f 6c28 2261  t(add_one(col("a
+0003afb0: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
+0003afc0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0003afd0: 2020 5b52 6f77 2841 4e53 3d32 292c 2052    [Row(ANS=2), R
+0003afe0: 6f77 2841 4e53 3d33 292c 2052 6f77 2841  ow(ANS=3), Row(A
+0003aff0: 4e53 3d34 295d 0a0a 2020 2020 6f72 2061  NS=4)]..    or a
+0003b000: 7320 6e61 6d65 6420 5544 4673 2074 6861  s named UDFs tha
+0003b010: 7420 6172 6520 6163 6365 7373 6962 6c65  t are accessible
+0003b020: 2069 6e20 7468 6520 7361 6d65 2073 6573   in the same ses
+0003b030: 7369 6f6e 2e20 496e 7374 6561 6420 6f66  sion. Instead of
+0003b040: 2063 616c 6c69 6e67 2060 7564 6660 2061   calling `udf` a
+0003b050: 7320 6675 6e63 7469 6f6e 2c20 6974 2063  s function, it c
+0003b060: 616e 2062 6520 616c 736f 2075 7365 640a  an be also used.
+0003b070: 2020 2020 6173 2061 2064 6563 6f72 6174      as a decorat
+0003b080: 6f72 3a0a 0a20 2020 2045 7861 6d70 6c65  or:..    Example
+0003b090: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0003b0a0: 4075 6466 286e 616d 653d 226d 696e 7573  @udf(name="minus
+0003b0b0: 5f6f 6e65 222c 2072 6570 6c61 6365 3d54  _one", replace=T
+0003b0c0: 7275 6529 0a20 2020 2020 2020 202e 2e2e  rue).        ...
+0003b0d0: 2064 6566 206d 696e 7573 5f6f 6e65 2878   def minus_one(x
+0003b0e0: 3a20 696e 7429 202d 3e20 696e 743a 0a20  : int) -> int:. 
+0003b0f0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+0003b100: 6574 7572 6e20 7820 2d20 310a 2020 2020  eturn x - 1.    
+0003b110: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0003b120: 7428 6d69 6e75 735f 6f6e 6528 636f 6c28  t(minus_one(col(
+0003b130: 2261 2229 292e 6173 5f28 2261 6e73 2229  "a")).as_("ans")
+0003b140: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0003b150: 2020 2020 5b52 6f77 2841 4e53 3d30 292c      [Row(ANS=0),
+0003b160: 2052 6f77 2841 4e53 3d31 292c 2052 6f77   Row(ANS=1), Row
+0003b170: 2841 4e53 3d32 295d 0a20 2020 2020 2020  (ANS=2)].       
+0003b180: 203e 3e3e 2073 6573 7369 6f6e 2e73 716c   >>> session.sql
+0003b190: 2822 5345 4c45 4354 206d 696e 7573 5f6f  ("SELECT minus_o
+0003b1a0: 6e65 2831 3029 2229 2e63 6f6c 6c65 6374  ne(10)").collect
+0003b1b0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0003b1c0: 4d49 4e55 535f 4f4e 4528 3130 293d 3929  MINUS_ONE(10)=9)
+0003b1d0: 5d0a 0a20 2020 2022 2222 0a20 2020 2073  ]..    """.    s
+0003b1e0: 6573 7369 6f6e 203d 2073 6573 7369 6f6e  ession = session
+0003b1f0: 206f 7220 736e 6f77 666c 616b 652e 736e   or snowflake.sn
+0003b200: 6f77 7061 726b 2e73 6573 7369 6f6e 2e5f  owpark.session._
+0003b210: 6765 745f 6163 7469 7665 5f73 6573 7369  get_active_sessi
+0003b220: 6f6e 2829 0a20 2020 2069 6620 6675 6e63  on().    if func
+0003b230: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0003b240: 2020 7265 7475 726e 2066 756e 6374 6f6f    return functoo
+0003b250: 6c73 2e70 6172 7469 616c 280a 2020 2020  ls.partial(.    
+0003b260: 2020 2020 2020 2020 7365 7373 696f 6e2e          session.
+0003b270: 7564 662e 7265 6769 7374 6572 2c0a 2020  udf.register,.  
+0003b280: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0003b290: 5f74 7970 653d 7265 7475 726e 5f74 7970  _type=return_typ
+0003b2a0: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003b2b0: 6e70 7574 5f74 7970 6573 3d69 6e70 7574  nput_types=input
+0003b2c0: 5f74 7970 6573 2c0a 2020 2020 2020 2020  _types,.        
+0003b2d0: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
+0003b2e0: 2020 2020 2020 2020 2020 2069 735f 7065             is_pe
+0003b2f0: 726d 616e 656e 743d 6973 5f70 6572 6d61  rmanent=is_perma
+0003b300: 6e65 6e74 2c0a 2020 2020 2020 2020 2020  nent,.          
+0003b310: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
+0003b320: 3d73 7461 6765 5f6c 6f63 6174 696f 6e2c  =stage_location,
+0003b330: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0003b340: 6f72 7473 3d69 6d70 6f72 7473 2c0a 2020  orts=imports,.  
+0003b350: 2020 2020 2020 2020 2020 7061 636b 6167            packag
+0003b360: 6573 3d70 6163 6b61 6765 732c 0a20 2020  es=packages,.   
+0003b370: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
+0003b380: 3d72 6570 6c61 6365 2c0a 2020 2020 2020  =replace,.      
+0003b390: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
+0003b3a0: 7374 733d 6966 5f6e 6f74 5f65 7869 7374  sts=if_not_exist
+0003b3b0: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
+0003b3c0: 6172 616c 6c65 6c3d 7061 7261 6c6c 656c  arallel=parallel
+0003b3d0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+0003b3e0: 785f 6261 7463 685f 7369 7a65 3d6d 6178  x_batch_size=max
+0003b3f0: 5f62 6174 6368 5f73 697a 652c 0a20 2020  _batch_size,.   
+0003b400: 2020 2020 2020 2020 2073 7461 7465 6d65           stateme
+0003b410: 6e74 5f70 6172 616d 733d 7374 6174 656d  nt_params=statem
+0003b420: 656e 745f 7061 7261 6d73 2c0a 2020 2020  ent_params,.    
+0003b430: 2020 2020 2020 2020 736f 7572 6365 5f63          source_c
+0003b440: 6f64 655f 6469 7370 6c61 793d 736f 7572  ode_display=sour
+0003b450: 6365 5f63 6f64 655f 6469 7370 6c61 792c  ce_code_display,
+0003b460: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0003b470: 6963 743d 7374 7269 6374 2c0a 2020 2020  ict=strict,.    
+0003b480: 2020 2020 2020 2020 7365 6375 7265 3d73          secure=s
+0003b490: 6563 7572 652c 0a20 2020 2020 2020 2029  ecure,.        )
+0003b4a0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0003b4b0: 2020 2072 6574 7572 6e20 7365 7373 696f     return sessio
+0003b4c0: 6e2e 7564 662e 7265 6769 7374 6572 280a  n.udf.register(.
+0003b4d0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0003b4e0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+0003b4f0: 7475 726e 5f74 7970 653d 7265 7475 726e  turn_type=return
+0003b500: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+0003b510: 2020 2069 6e70 7574 5f74 7970 6573 3d69     input_types=i
+0003b520: 6e70 7574 5f74 7970 6573 2c0a 2020 2020  nput_types,.    
+0003b530: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
+0003b540: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003b550: 735f 7065 726d 616e 656e 743d 6973 5f70  s_permanent=is_p
+0003b560: 6572 6d61 6e65 6e74 2c0a 2020 2020 2020  ermanent,.      
+0003b570: 2020 2020 2020 7374 6167 655f 6c6f 6361        stage_loca
+0003b580: 7469 6f6e 3d73 7461 6765 5f6c 6f63 6174  tion=stage_locat
+0003b590: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0003b5a0: 2069 6d70 6f72 7473 3d69 6d70 6f72 7473   imports=imports
+0003b5b0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0003b5c0: 636b 6167 6573 3d70 6163 6b61 6765 732c  ckages=packages,
+0003b5d0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+0003b5e0: 6c61 6365 3d72 6570 6c61 6365 2c0a 2020  lace=replace,.  
+0003b5f0: 2020 2020 2020 2020 2020 6966 5f6e 6f74            if_not
+0003b600: 5f65 7869 7374 733d 6966 5f6e 6f74 5f65  _exists=if_not_e
+0003b610: 7869 7374 732c 0a20 2020 2020 2020 2020  xists,.         
+0003b620: 2020 2070 6172 616c 6c65 6c3d 7061 7261     parallel=para
+0003b630: 6c6c 656c 2c0a 2020 2020 2020 2020 2020  llel,.          
+0003b640: 2020 6d61 785f 6261 7463 685f 7369 7a65    max_batch_size
+0003b650: 3d6d 6178 5f62 6174 6368 5f73 697a 652c  =max_batch_size,
+0003b660: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+0003b670: 7465 6d65 6e74 5f70 6172 616d 733d 7374  tement_params=st
+0003b680: 6174 656d 656e 745f 7061 7261 6d73 2c0a  atement_params,.
+0003b690: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+0003b6a0: 6365 5f63 6f64 655f 6469 7370 6c61 793d  ce_code_display=
+0003b6b0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
+0003b6c0: 6c61 792c 0a20 2020 2020 2020 2020 2020  lay,.           
+0003b6d0: 2073 7472 6963 743d 7374 7269 6374 2c0a   strict=strict,.
+0003b6e0: 2020 2020 2020 2020 2020 2020 7365 6375              secu
+0003b6f0: 7265 3d73 6563 7572 652c 0a20 2020 2020  re=secure,.     
+0003b700: 2020 2029 0a0a 0a64 6566 2075 6474 6628     )...def udtf(
+0003b710: 0a20 2020 2068 616e 646c 6572 3a20 4f70  .    handler: Op
+0003b720: 7469 6f6e 616c 5b43 616c 6c61 626c 655d  tional[Callable]
+0003b730: 203d 204e 6f6e 652c 0a20 2020 202a 2c0a   = None,.    *,.
+0003b740: 2020 2020 6f75 7470 7574 5f73 6368 656d      output_schem
+0003b750: 613a 2055 6e69 6f6e 5b53 7472 7563 7454  a: Union[StructT
+0003b760: 7970 652c 204c 6973 745b 7374 725d 5d2c  ype, List[str]],
+0003b770: 0a20 2020 2069 6e70 7574 5f74 7970 6573  .    input_types
+0003b780: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+0003b790: 4461 7461 5479 7065 5d5d 203d 204e 6f6e  DataType]] = Non
+0003b7a0: 652c 0a20 2020 206e 616d 653a 204f 7074  e,.    name: Opt
+0003b7b0: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
+0003b7c0: 2049 7465 7261 626c 655b 7374 725d 5d5d   Iterable[str]]]
+0003b7d0: 203d 204e 6f6e 652c 0a20 2020 2069 735f   = None,.    is_
+0003b7e0: 7065 726d 616e 656e 743a 2062 6f6f 6c20  permanent: bool 
+0003b7f0: 3d20 4661 6c73 652c 0a20 2020 2073 7461  = False,.    sta
+0003b800: 6765 5f6c 6f63 6174 696f 6e3a 204f 7074  ge_location: Opt
+0003b810: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0003b820: 652c 0a20 2020 2069 6d70 6f72 7473 3a20  e,.    imports: 
+0003b830: 4f70 7469 6f6e 616c 5b4c 6973 745b 556e  Optional[List[Un
+0003b840: 696f 6e5b 7374 722c 2054 7570 6c65 5b73  ion[str, Tuple[s
+0003b850: 7472 2c20 7374 725d 5d5d 5d20 3d20 4e6f  tr, str]]]] = No
+0003b860: 6e65 2c0a 2020 2020 7061 636b 6167 6573  ne,.    packages
+0003b870: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+0003b880: 556e 696f 6e5b 7374 722c 204d 6f64 756c  Union[str, Modul
+0003b890: 6554 7970 655d 5d5d 203d 204e 6f6e 652c  eType]]] = None,
+0003b8a0: 0a20 2020 2072 6570 6c61 6365 3a20 626f  .    replace: bo
+0003b8b0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0003b8c0: 6966 5f6e 6f74 5f65 7869 7374 733a 2062  if_not_exists: b
+0003b8d0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0003b8e0: 2073 6573 7369 6f6e 3a20 4f70 7469 6f6e   session: Option
+0003b8f0: 616c 5b22 736e 6f77 666c 616b 652e 736e  al["snowflake.sn
+0003b900: 6f77 7061 726b 2e73 6573 7369 6f6e 2e53  owpark.session.S
+0003b910: 6573 7369 6f6e 225d 203d 204e 6f6e 652c  ession"] = None,
+0003b920: 0a20 2020 2070 6172 616c 6c65 6c3a 2069  .    parallel: i
+0003b930: 6e74 203d 2034 2c0a 2020 2020 7374 6174  nt = 4,.    stat
+0003b940: 656d 656e 745f 7061 7261 6d73 3a20 4f70  ement_params: Op
+0003b950: 7469 6f6e 616c 5b44 6963 745b 7374 722c  tional[Dict[str,
+0003b960: 2073 7472 5d5d 203d 204e 6f6e 652c 0a20   str]] = None,. 
+0003b970: 2020 2073 7472 6963 743a 2062 6f6f 6c20     strict: bool 
+0003b980: 3d20 4661 6c73 652c 0a20 2020 2073 6563  = False,.    sec
+0003b990: 7572 653a 2062 6f6f 6c20 3d20 4661 6c73  ure: bool = Fals
+0003b9a0: 652c 0a29 202d 3e20 556e 696f 6e5b 5573  e,.) -> Union[Us
+0003b9b0: 6572 4465 6669 6e65 6454 6162 6c65 4675  erDefinedTableFu
+0003b9c0: 6e63 7469 6f6e 2c20 6675 6e63 746f 6f6c  nction, functool
+0003b9d0: 732e 7061 7274 6961 6c5d 3a0a 2020 2020  s.partial]:.    
+0003b9e0: 2222 2252 6567 6973 7465 7273 2061 2050  """Registers a P
+0003b9f0: 7974 686f 6e20 636c 6173 7320 6173 2061  ython class as a
+0003ba00: 2053 6e6f 7766 6c61 6b65 2050 7974 686f   Snowflake Pytho
+0003ba10: 6e20 5544 5446 2061 6e64 2072 6574 7572  n UDTF and retur
+0003ba20: 6e73 2074 6865 2055 4454 462e 0a0a 2020  ns the UDTF...  
+0003ba30: 2020 4974 2063 616e 2062 6520 7573 6564    It can be used
+0003ba40: 2061 7320 6569 7468 6572 2061 2066 756e   as either a fun
+0003ba50: 6374 696f 6e20 6361 6c6c 206f 7220 6120  ction call or a 
+0003ba60: 6465 636f 7261 746f 722e 2049 6e20 6d6f  decorator. In mo
+0003ba70: 7374 2063 6173 6573 2079 6f75 2077 6f72  st cases you wor
+0003ba80: 6b20 7769 7468 2061 2073 696e 676c 6520  k with a single 
+0003ba90: 7365 7373 696f 6e2e 0a20 2020 2054 6869  session..    Thi
+0003baa0: 7320 6675 6e63 7469 6f6e 2075 7365 7320  s function uses 
+0003bab0: 7468 6174 2073 6573 7369 6f6e 2074 6f20  that session to 
+0003bac0: 7265 6769 7374 6572 2074 6865 2055 4454  register the UDT
+0003bad0: 462e 2049 6620 796f 7520 6861 7665 206d  F. If you have m
+0003bae0: 756c 7469 706c 6520 7365 7373 696f 6e73  ultiple sessions
+0003baf0: 2c20 796f 7520 6e65 6564 2074 6f0a 2020  , you need to.  
+0003bb00: 2020 6578 706c 6963 6974 6c79 2073 7065    explicitly spe
+0003bb10: 6369 6679 2074 6865 2060 6073 6573 7369  cify the ``sessi
+0003bb20: 6f6e 6060 2070 6172 616d 6574 6572 206f  on`` parameter o
+0003bb30: 6620 7468 6973 2066 756e 6374 696f 6e2e  f this function.
+0003bb40: 2049 6620 796f 7520 6861 7665 2061 2066   If you have a f
+0003bb50: 756e 6374 696f 6e20 616e 6420 776f 756c  unction and woul
+0003bb60: 640a 2020 2020 6c69 6b65 2074 6f20 7265  d.    like to re
+0003bb70: 6769 7374 6572 2069 7420 746f 206d 756c  gister it to mul
+0003bb80: 7469 706c 6520 6461 7461 6261 7365 732c  tiple databases,
+0003bb90: 2075 7365 2060 6073 6573 7369 6f6e 2e75   use ``session.u
+0003bba0: 6474 662e 7265 6769 7374 6572 6060 2069  dtf.register`` i
+0003bbb0: 6e73 7465 6164 2e20 5365 6520 6578 616d  nstead. See exam
+0003bbc0: 706c 6573 0a20 2020 2069 6e20 3a63 6c61  ples.    in :cla
+0003bbd0: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
+0003bbe0: 6e6f 7770 6172 6b2e 7564 7466 2e55 4454  nowpark.udtf.UDT
+0003bbf0: 4652 6567 6973 7472 6174 696f 6e60 2e0a  FRegistration`..
+0003bc00: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0003bc10: 2020 2068 616e 646c 6572 3a20 4120 5079     handler: A Py
+0003bc20: 7468 6f6e 2063 6c61 7373 2075 7365 6420  thon class used 
+0003bc30: 666f 7220 6372 6561 7469 6e67 2074 6865  for creating the
+0003bc40: 2055 4454 462e 0a20 2020 2020 2020 206f   UDTF..        o
+0003bc50: 7574 7075 745f 7363 6865 6d61 3a20 4120  utput_schema: A 
+0003bc60: 6c69 7374 206f 6620 636f 6c75 6d6e 206e  list of column n
+0003bc70: 616d 6573 2c20 6f72 2061 203a 636c 6173  ames, or a :clas
+0003bc80: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+0003bc90: 6f77 7061 726b 2e74 7970 6573 2e53 7472  owpark.types.Str
+0003bca0: 7563 7454 7970 6560 2069 6e73 7461 6e63  uctType` instanc
+0003bcb0: 6520 7468 6174 2072 6570 7265 7365 6e74  e that represent
+0003bcc0: 7320 7468 6520 7461 626c 6520 6675 6e63  s the table func
+0003bcd0: 7469 6f6e 2773 2063 6f6c 756d 6e73 2e0a  tion's columns..
+0003bce0: 2020 2020 2020 2020 2049 6620 6120 6c69           If a li
+0003bcf0: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
+0003bd00: 6573 2069 7320 7072 6f76 6964 6564 2c20  es is provided, 
+0003bd10: 7468 6520 6060 7072 6f63 6573 7360 6020  the ``process`` 
+0003bd20: 6d65 7468 6f64 206f 6620 7468 6520 6861  method of the ha
+0003bd30: 6e64 6c65 7220 636c 6173 7320 6d75 7374  ndler class must
+0003bd40: 2068 6176 6520 7265 7475 726e 2074 7970   have return typ
+0003bd50: 6520 6869 6e74 7320 746f 2069 6e64 6963  e hints to indic
+0003bd60: 6174 6520 7468 6520 6f75 7470 7574 2073  ate the output s
+0003bd70: 6368 656d 6120 6461 7461 2074 7970 6573  chema data types
+0003bd80: 2e0a 2020 2020 2020 2020 696e 7075 745f  ..        input_
+0003bd90: 7479 7065 733a 2041 206c 6973 7420 6f66  types: A list of
+0003bda0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+0003bdb0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0003bdc0: 6573 2e44 6174 6154 7970 6560 0a20 2020  es.DataType`.   
+0003bdd0: 2020 2020 2020 2020 2072 6570 7265 7365           represe
+0003bde0: 6e74 696e 6720 7468 6520 696e 7075 7420  nting the input 
+0003bdf0: 6461 7461 2074 7970 6573 206f 6620 7468  data types of th
+0003be00: 6520 5544 5446 2e20 4f70 7469 6f6e 616c  e UDTF. Optional
+0003be10: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
+0003be20: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
+0003be30: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
+0003be40: 206e 616d 653a 2041 2073 7472 696e 6720   name: A string 
+0003be50: 6f72 206c 6973 7420 6f66 2073 7472 696e  or list of strin
+0003be60: 6773 2074 6861 7420 7370 6563 6966 7920  gs that specify 
+0003be70: 7468 6520 6e61 6d65 206f 7220 6675 6c6c  the name or full
+0003be80: 792d 7175 616c 6966 6965 640a 2020 2020  y-qualified.    
+0003be90: 2020 2020 2020 2020 6f62 6a65 6374 2069          object i
+0003bea0: 6465 6e74 6966 6965 7220 2864 6174 6162  dentifier (datab
+0003beb0: 6173 6520 6e61 6d65 2c20 7363 6865 6d61  ase name, schema
+0003bec0: 206e 616d 652c 2061 6e64 2066 756e 6374   name, and funct
+0003bed0: 696f 6e20 6e61 6d65 2920 666f 720a 2020  ion name) for.  
+0003bee0: 2020 2020 2020 2020 2020 7468 6520 5544            the UD
+0003bef0: 5446 2069 6e20 536e 6f77 666c 616b 652c  TF in Snowflake,
+0003bf00: 2077 6869 6368 2061 6c6c 6f77 7320 796f   which allows yo
+0003bf10: 7520 746f 2063 616c 6c20 7468 6973 2055  u to call this U
+0003bf20: 4454 4620 696e 2061 2053 514c 0a20 2020  DTF in a SQL.   
+0003bf30: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
+0003bf40: 206f 7220 7669 6120 3a66 756e 633a 6063   or via :func:`c
+0003bf50: 616c 6c5f 7564 7466 2829 602e 2049 6620  all_udtf()`. If 
+0003bf60: 6974 2069 7320 6e6f 7420 7072 6f76 6964  it is not provid
+0003bf70: 6564 2c20 6120 6e61 6d65 2077 696c 6c0a  ed, a name will.
+0003bf80: 2020 2020 2020 2020 2020 2020 6265 2061              be a
+0003bf90: 7574 6f6d 6174 6963 616c 6c79 2067 656e  utomatically gen
+0003bfa0: 6572 6174 6564 2066 6f72 2074 6865 2055  erated for the U
+0003bfb0: 4454 462e 2041 206e 616d 6520 6d75 7374  DTF. A name must
+0003bfc0: 2062 6520 7370 6563 6966 6965 6420 7768   be specified wh
+0003bfd0: 656e 0a20 2020 2020 2020 2020 2020 2060  en.            `
+0003bfe0: 6069 735f 7065 726d 616e 656e 7460 6020  `is_permanent`` 
+0003bff0: 6973 2060 6054 7275 6560 602e 0a20 2020  is ``True``..   
+0003c000: 2020 2020 2069 735f 7065 726d 616e 656e       is_permanen
+0003c010: 743a 2057 6865 7468 6572 2074 6f20 6372  t: Whether to cr
+0003c020: 6561 7465 2061 2070 6572 6d61 6e65 6e74  eate a permanent
+0003c030: 2055 4454 462e 2054 6865 2064 6566 6175   UDTF. The defau
+0003c040: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
+0003c050: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0003c060: 6974 2069 7320 6060 5472 7565 6060 2c20  it is ``True``, 
+0003c070: 6120 7661 6c69 6420 6060 7374 6167 655f  a valid ``stage_
+0003c080: 6c6f 6361 7469 6f6e 6060 206d 7573 7420  location`` must 
+0003c090: 6265 2070 726f 7669 6465 642e 0a20 2020  be provided..   
+0003c0a0: 2020 2020 2073 7461 6765 5f6c 6f63 6174       stage_locat
+0003c0b0: 696f 6e3a 2054 6865 2073 7461 6765 206c  ion: The stage l
+0003c0c0: 6f63 6174 696f 6e20 7768 6572 6520 7468  ocation where th
+0003c0d0: 6520 5079 7468 6f6e 2066 696c 6520 666f  e Python file fo
+0003c0e0: 7220 7468 6520 5544 5446 0a20 2020 2020  r the UDTF.     
+0003c0f0: 2020 2020 2020 2061 6e64 2069 7473 2064         and its d
+0003c100: 6570 656e 6465 6e63 6965 7320 7368 6f75  ependencies shou
+0003c110: 6c64 2062 6520 7570 6c6f 6164 6564 2e20  ld be uploaded. 
+0003c120: 5468 6520 7374 6167 6520 6c6f 6361 7469  The stage locati
+0003c130: 6f6e 206d 7573 7420 6265 2073 7065 6369  on must be speci
+0003c140: 6669 6564 0a20 2020 2020 2020 2020 2020  fied.           
+0003c150: 2077 6865 6e20 6060 6973 5f70 6572 6d61   when ``is_perma
+0003c160: 6e65 6e74 6060 2069 7320 6060 5472 7565  nent`` is ``True
+0003c170: 6060 2c20 616e 6420 6974 2077 696c 6c20  ``, and it will 
+0003c180: 6265 2069 676e 6f72 6564 2077 6865 6e0a  be ignored when.
+0003c190: 2020 2020 2020 2020 2020 2020 6060 6973              ``is
+0003c1a0: 5f70 6572 6d61 6e65 6e74 6060 2069 7320  _permanent`` is 
+0003c1b0: 6060 4661 6c73 6560 602e 2049 7420 6361  ``False``. It ca
+0003c1c0: 6e20 6265 2061 6e79 2073 7461 6765 206f  n be any stage o
+0003c1d0: 7468 6572 2074 6861 6e20 7465 6d70 6f72  ther than tempor
+0003c1e0: 6172 790a 2020 2020 2020 2020 2020 2020  ary.            
+0003c1f0: 7374 6167 6573 2061 6e64 2065 7874 6572  stages and exter
+0003c200: 6e61 6c20 7374 6167 6573 2e0a 2020 2020  nal stages..    
+0003c210: 2020 2020 696d 706f 7274 733a 2041 206c      imports: A l
+0003c220: 6973 7420 6f66 2069 6d70 6f72 7473 2074  ist of imports t
+0003c230: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
+0003c240: 6f20 7468 6973 2055 4454 462e 2059 6f75  o this UDTF. You
+0003c250: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
+0003c260: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
+0003c270: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
+0003c280: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
+0003c290: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
+0003c2a0: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
+0003c2b0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+0003c2c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003c2d0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+0003c2e0: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
+0003c2f0: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
+0003c300: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
+0003c310: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
+0003c320: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
+0003c330: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
+0003c340: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
+0003c350: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
+0003c360: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
+0003c370: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
+0003c380: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+0003c390: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+0003c3a0: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
+0003c3b0: 2054 6865 7365 2055 4454 462d 6c65 7665   These UDTF-leve
+0003c3c0: 6c20 696d 706f 7274 730a 2020 2020 2020  l imports.      
+0003c3d0: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
+0003c3e0: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
+0003c3f0: 6c65 7665 6c20 696d 706f 7274 7320 6164  level imports ad
+0003c400: 6465 6420 6279 0a20 2020 2020 2020 2020  ded by.         
+0003c410: 2020 203a 6d65 7468 3a60 7e73 6e6f 7766     :meth:`~snowf
+0003c420: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5365  lake.snowpark.Se
+0003c430: 7373 696f 6e2e 6164 645f 696d 706f 7274  ssion.add_import
+0003c440: 602e 0a20 2020 2020 2020 2070 6163 6b61  `..        packa
+0003c450: 6765 733a 2041 206c 6973 7420 6f66 2070  ges: A list of p
+0003c460: 6163 6b61 6765 7320 7468 6174 206f 6e6c  ackages that onl
+0003c470: 7920 6170 706c 7920 746f 2074 6869 7320  y apply to this 
+0003c480: 5544 5446 2e20 5468 6573 6520 5544 5446  UDTF. These UDTF
+0003c490: 2d6c 6576 656c 2070 6163 6b61 6765 730a  -level packages.
+0003c4a0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+0003c4b0: 206f 7665 7272 6964 6520 7468 6520 7365   override the se
+0003c4c0: 7373 696f 6e2d 6c65 7665 6c20 7061 636b  ssion-level pack
+0003c4d0: 6167 6573 2061 6464 6564 2062 790a 2020  ages added by.  
+0003c4e0: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+0003c4f0: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+0003c500: 7061 726b 2e53 6573 7369 6f6e 2e61 6464  park.Session.add
+0003c510: 5f70 6163 6b61 6765 7360 2061 6e64 0a20  _packages` and. 
+0003c520: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
+0003c530: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003c540: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
+0003c550: 645f 7265 7175 6972 656d 656e 7473 602e  d_requirements`.
+0003c560: 2054 6f20 7573 6520 5079 7468 6f6e 2070   To use Python p
+0003c570: 6163 6b61 6765 7320 7468 6174 2061 7265  ackages that are
+0003c580: 206e 6f74 2061 7661 696c 6162 6c65 0a20   not available. 
+0003c590: 2020 2020 2020 2020 2020 2069 6e20 536e             in Sn
+0003c5a0: 6f77 666c 616b 652c 2072 6566 6572 2074  owflake, refer t
+0003c5b0: 6f20 3a6d 6574 683a 607e 736e 6f77 666c  o :meth:`~snowfl
+0003c5c0: 616b 652e 736e 6f77 7061 726b 2e53 6573  ake.snowpark.Ses
+0003c5d0: 7369 6f6e 2e63 7573 746f 6d5f 7061 636b  sion.custom_pack
+0003c5e0: 6167 655f 7573 6167 655f 636f 6e66 6967  age_usage_config
+0003c5f0: 602e 0a20 2020 2020 2020 2072 6570 6c61  `..        repla
+0003c600: 6365 3a20 5768 6574 6865 7220 746f 2072  ce: Whether to r
+0003c610: 6570 6c61 6365 2061 2055 4454 4620 7468  eplace a UDTF th
+0003c620: 6174 2061 6c72 6561 6479 2077 6173 2072  at already was r
+0003c630: 6567 6973 7465 7265 642e 2054 6865 2064  egistered. The d
+0003c640: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
+0003c650: 6560 602e 0a20 2020 2020 2020 2020 2020  e``..           
+0003c660: 2049 6620 6974 2069 7320 6060 4661 6c73   If it is ``Fals
+0003c670: 6560 602c 2061 7474 656d 7074 696e 6720  e``, attempting 
+0003c680: 746f 2072 6567 6973 7465 7220 6120 5544  to register a UD
+0003c690: 5446 2077 6974 6820 6120 6e61 6d65 2074  TF with a name t
+0003c6a0: 6861 7420 616c 7265 6164 7920 6578 6973  hat already exis
+0003c6b0: 7473 0a20 2020 2020 2020 2020 2020 2072  ts.            r
+0003c6c0: 6573 756c 7473 2069 6e20 6120 6060 536e  esults in a ``Sn
+0003c6d0: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
+0003c6e0: 6f6e 6060 2065 7863 6570 7469 6f6e 2062  on`` exception b
+0003c6f0: 6569 6e67 2074 6872 6f77 6e2e 2049 6620  eing thrown. If 
+0003c700: 6974 2069 7320 6060 5472 7565 6060 2c0a  it is ``True``,.
+0003c710: 2020 2020 2020 2020 2020 2020 616e 2065              an e
+0003c720: 7869 7374 696e 6720 5544 5446 2077 6974  xisting UDTF wit
+0003c730: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+0003c740: 6973 206f 7665 7277 7269 7474 656e 2e0a  is overwritten..
+0003c750: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
+0003c760: 7869 7374 733a 2057 6865 7468 6572 2074  xists: Whether t
+0003c770: 6f20 736b 6970 2063 7265 6174 696f 6e20  o skip creation 
+0003c780: 6f66 2061 2055 4454 4620 7768 656e 206f  of a UDTF when o
+0003c790: 6e65 2077 6974 6820 7468 6520 7361 6d65  ne with the same
+0003c7a0: 2073 6967 6e61 7475 7265 2061 6c72 6561   signature alrea
+0003c7b0: 6479 2065 7869 7374 732e 0a20 2020 2020  dy exists..     
+0003c7c0: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
+0003c7d0: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
+0003c7e0: 2060 6069 665f 6e6f 745f 6578 6973 7473   ``if_not_exists
+0003c7f0: 6060 2061 6e64 2060 6072 6570 6c61 6365  `` and ``replace
+0003c800: 6060 2061 7265 206d 7574 7561 6c6c 7920  `` are mutually 
+0003c810: 6578 636c 7573 6976 650a 2020 2020 2020  exclusive.      
+0003c820: 2020 2020 2020 616e 6420 6120 6060 5661        and a ``Va
+0003c830: 6c75 6545 7272 6f72 6060 2069 7320 7261  lueError`` is ra
+0003c840: 6973 6564 2077 6865 6e20 626f 7468 2061  ised when both a
+0003c850: 7265 2073 6574 2e20 4966 2069 7420 6973  re set. If it is
+0003c860: 2060 6054 7275 6560 6020 616e 6420 6120   ``True`` and a 
+0003c870: 5544 5446 2077 6974 680a 2020 2020 2020  UDTF with.      
+0003c880: 2020 2020 2020 7468 6520 7361 6d65 2073        the same s
+0003c890: 6967 6e61 7475 7265 2065 7869 7374 732c  ignature exists,
+0003c8a0: 2074 6865 2055 4454 4620 6372 6561 7469   the UDTF creati
+0003c8b0: 6f6e 2069 7320 736b 6970 7065 642e 0a20  on is skipped.. 
+0003c8c0: 2020 2020 2020 2073 6573 7369 6f6e 3a20         session: 
+0003c8d0: 5573 6520 7468 6973 2073 6573 7369 6f6e  Use this session
+0003c8e0: 2074 6f20 7265 6769 7374 6572 2074 6865   to register the
+0003c8f0: 2055 4454 462e 2049 6620 6974 2773 206e   UDTF. If it's n
+0003c900: 6f74 2073 7065 6369 6669 6564 2c20 7468  ot specified, th
+0003c910: 6520 7365 7373 696f 6e20 7468 6174 2079  e session that y
+0003c920: 6f75 2063 7265 6174 6564 2062 6566 6f72  ou created befor
+0003c930: 6520 6361 6c6c 696e 6720 7468 6973 2066  e calling this f
+0003c940: 756e 6374 696f 6e20 7769 6c6c 2062 6520  unction will be 
+0003c950: 7573 6564 2e0a 2020 2020 2020 2020 2020  used..          
+0003c960: 2020 596f 7520 6e65 6564 2074 6f20 7370    You need to sp
+0003c970: 6563 6966 7920 7468 6973 2070 6172 616d  ecify this param
+0003c980: 6574 6572 2069 6620 796f 7520 6861 7665  eter if you have
+0003c990: 2063 7265 6174 6564 206d 756c 7469 706c   created multipl
+0003c9a0: 6520 7365 7373 696f 6e73 2062 6566 6f72  e sessions befor
+0003c9b0: 6520 6361 6c6c 696e 6720 7468 6973 206d  e calling this m
+0003c9c0: 6574 686f 642e 0a20 2020 2020 2020 2070  ethod..        p
+0003c9d0: 6172 616c 6c65 6c3a 2054 6865 206e 756d  arallel: The num
+0003c9e0: 6265 7220 6f66 2074 6872 6561 6473 2074  ber of threads t
+0003c9f0: 6f20 7573 6520 666f 7220 7570 6c6f 6164  o use for upload
+0003ca00: 696e 6720 5544 5446 2066 696c 6573 2077  ing UDTF files w
+0003ca10: 6974 6820 7468 650a 2020 2020 2020 2020  ith the.        
+0003ca20: 2020 2020 6050 5554 203c 6874 7470 733a      `PUT <https:
+0003ca30: 2f2f 646f 6373 2e73 6e6f 7766 6c61 6b65  //docs.snowflake
+0003ca40: 2e63 6f6d 2f65 6e2f 7371 6c2d 7265 6665  .com/en/sql-refe
+0003ca50: 7265 6e63 652f 7371 6c2f 7075 742e 6874  rence/sql/put.ht
+0003ca60: 6d6c 2370 7574 3e60 5f0a 2020 2020 2020  ml#put>`_.      
+0003ca70: 2020 2020 2020 636f 6d6d 616e 642e 2054        command. T
+0003ca80: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0003ca90: 2069 7320 3420 616e 6420 7375 7070 6f72   is 4 and suppor
+0003caa0: 7465 6420 7661 6c75 6573 2061 7265 2066  ted values are f
+0003cab0: 726f 6d20 3120 746f 2039 392e 0a20 2020  rom 1 to 99..   
+0003cac0: 2020 2020 2020 2020 2049 6e63 7265 6173           Increas
+0003cad0: 696e 6720 7468 6520 6e75 6d62 6572 206f  ing the number o
+0003cae0: 6620 7468 7265 6164 7320 6361 6e20 696d  f threads can im
+0003caf0: 7072 6f76 6520 7065 7266 6f72 6d61 6e63  prove performanc
+0003cb00: 6520 7768 656e 2075 706c 6f61 6469 6e67  e when uploading
+0003cb10: 0a20 2020 2020 2020 2020 2020 206c 6172  .            lar
+0003cb20: 6765 2055 4454 4620 6669 6c65 732e 0a20  ge UDTF files.. 
+0003cb30: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
+0003cb40: 5f70 6172 616d 733a 2044 6963 7469 6f6e  _params: Diction
+0003cb50: 6172 7920 6f66 2073 7461 7465 6d65 6e74  ary of statement
+0003cb60: 206c 6576 656c 2070 6172 616d 6574 6572   level parameter
+0003cb70: 7320 746f 2062 6520 7365 7420 7768 696c  s to be set whil
+0003cb80: 6520 6578 6563 7574 696e 6720 7468 6973  e executing this
+0003cb90: 2061 6374 696f 6e2e 0a20 2020 2020 2020   action..       
+0003cba0: 2073 7472 6963 743a 2057 6865 7468 6572   strict: Whether
+0003cbb0: 2074 6865 2063 7265 6174 6564 2055 4454   the created UDT
+0003cbc0: 4620 6973 2073 7472 6963 742e 2041 2073  F is strict. A s
+0003cbd0: 7472 6963 7420 5544 5446 2077 696c 6c20  trict UDTF will 
+0003cbe0: 6e6f 7420 696e 766f 6b65 2074 6865 2055  not invoke the U
+0003cbf0: 4454 4620 6966 2061 6e79 2069 6e70 7574  DTF if any input
+0003cc00: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+0003cc10: 6e75 6c6c 2e20 496e 7374 6561 642c 2061  null. Instead, a
+0003cc20: 206e 756c 6c20 7661 6c75 6520 7769 6c6c   null value will
+0003cc30: 2061 6c77 6179 7320 6265 2072 6574 7572   always be retur
+0003cc40: 6e65 6420 666f 7220 7468 6174 2072 6f77  ned for that row
+0003cc50: 2e20 4e6f 7465 2074 6861 7420 7468 6520  . Note that the 
+0003cc60: 5544 5446 206d 6967 6874 0a20 2020 2020  UDTF might.     
+0003cc70: 2020 2020 2020 2073 7469 6c6c 2072 6574         still ret
+0003cc80: 7572 6e20 6e75 6c6c 2066 6f72 206e 6f6e  urn null for non
+0003cc90: 2d6e 756c 6c20 696e 7075 7473 2e0a 2020  -null inputs..  
+0003cca0: 2020 2020 2020 7365 6375 7265 3a20 5768        secure: Wh
+0003ccb0: 6574 6865 7220 7468 6520 6372 6561 7465  ether the create
+0003ccc0: 6420 5544 5446 2069 7320 7365 6375 7265  d UDTF is secure
+0003ccd0: 2e20 466f 7220 6d6f 7265 2069 6e66 6f72  . For more infor
+0003cce0: 6d61 7469 6f6e 2061 626f 7574 2073 6563  mation about sec
+0003ccf0: 7572 6520 6675 6e63 7469 6f6e 732c 0a20  ure functions,. 
+0003cd00: 2020 2020 2020 2020 2020 2073 6565 2060             see `
+0003cd10: 5365 6375 7265 2055 4446 7320 3c68 7474  Secure UDFs <htt
+0003cd20: 7073 3a2f 2f64 6f63 732e 736e 6f77 666c  ps://docs.snowfl
+0003cd30: 616b 652e 636f 6d2f 656e 2f73 716c 2d72  ake.com/en/sql-r
+0003cd40: 6566 6572 656e 6365 2f75 6466 2d73 6563  eference/udf-sec
+0003cd50: 7572 652e 6874 6d6c 3e60 5f2e 0a0a 2020  ure.html>`_...  
+0003cd60: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+0003cd70: 2020 2041 2055 4454 4620 6675 6e63 7469     A UDTF functi
+0003cd80: 6f6e 2074 6861 7420 6361 6e20 6265 2063  on that can be c
+0003cd90: 616c 6c65 6420 7769 7468 203a 636c 6173  alled with :clas
+0003cda0: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+0003cdb0: 6f77 7061 726b 2e43 6f6c 756d 6e60 2065  owpark.Column` e
+0003cdc0: 7870 7265 7373 696f 6e73 2e0a 0a20 2020  xpressions...   
+0003cdd0: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
+0003cde0: 2e20 5768 656e 2074 7970 6520 6869 6e74  . When type hint
+0003cdf0: 7320 6172 6520 7072 6f76 6964 6564 2061  s are provided a
+0003ce00: 6e64 2061 7265 2063 6f6d 706c 6574 6520  nd are complete 
+0003ce10: 666f 7220 6120 6675 6e63 7469 6f6e 2c0a  for a function,.
+0003ce20: 2020 2020 2020 2020 6060 7265 7475 726e          ``return
+0003ce30: 5f74 7970 6560 6020 616e 6420 6060 696e  _type`` and ``in
+0003ce40: 7075 745f 7479 7065 7360 6020 6172 6520  put_types`` are 
+0003ce50: 6f70 7469 6f6e 616c 2061 6e64 2077 696c  optional and wil
+0003ce60: 6c20 6265 2069 676e 6f72 6564 2e0a 2020  l be ignored..  
+0003ce70: 2020 2020 2020 5365 6520 6465 7461 696c        See detail
+0003ce80: 7320 6f66 2073 7570 706f 7274 6564 2064  s of supported d
+0003ce90: 6174 6120 7479 7065 7320 666f 7220 5544  ata types for UD
+0003cea0: 5446 7320 696e 0a20 2020 2020 2020 203a  TFs in.        :
+0003ceb0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+0003cec0: 652e 736e 6f77 7061 726b 2e75 6474 662e  e.snowpark.udtf.
+0003ced0: 5544 5446 5265 6769 7374 7261 7469 6f6e  UDTFRegistration
+0003cee0: 602e 0a0a 2020 2020 2020 2020 2020 2020  `...            
+0003cef0: 2d20 596f 7520 6361 6e20 7573 6520 7573  - You can use us
+0003cf00: 6520 3a61 7474 723a 607e 736e 6f77 666c  e :attr:`~snowfl
+0003cf10: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+0003cf20: 6573 2e56 6172 6961 6e74 6020 746f 0a20  es.Variant` to. 
+0003cf30: 2020 2020 2020 2020 2020 2020 2061 6e6e               ann
+0003cf40: 6f74 6174 6520 6120 7661 7269 616e 742c  otate a variant,
+0003cf50: 2061 6e64 2075 7365 203a 6174 7472 3a60   and use :attr:`
+0003cf60: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003cf70: 6172 6b2e 7479 7065 732e 4765 6f67 7261  ark.types.Geogra
+0003cf80: 7068 7960 0a20 2020 2020 2020 2020 2020  phy`.           
+0003cf90: 2020 206f 7220 3a61 7474 723a 607e 736e     or :attr:`~sn
+0003cfa0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003cfb0: 2e74 7970 6573 2e47 656f 6d65 7472 7960  .types.Geometry`
+0003cfc0: 2074 6f20 616e 6e6f 7461 7465 2067 656f   to annotate geo
+0003cfd0: 7370 6174 6961 6c0a 2020 2020 2020 2020  spatial.        
+0003cfe0: 2020 2020 2020 7479 7065 7320 7768 656e        types when
+0003cff0: 2064 6566 696e 696e 6720 6120 5544 5446   defining a UDTF
+0003d000: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
+0003d010: 203a 636c 6173 733a 6074 7970 696e 672e   :class:`typing.
+0003d020: 556e 696f 6e60 2069 7320 6e6f 7420 6120  Union` is not a 
+0003d030: 7661 6c69 6420 7479 7065 2061 6e6e 6f74  valid type annot
+0003d040: 6174 696f 6e20 666f 7220 5544 5446 732c  ation for UDTFs,
+0003d050: 0a20 2020 2020 2020 2020 2020 2020 2062  .              b
+0003d060: 7574 203a 636c 6173 733a 6074 7970 696e  ut :class:`typin
+0003d070: 672e 4f70 7469 6f6e 616c 6020 6361 6e20  g.Optional` can 
+0003d080: 6265 2075 7365 6420 746f 2069 6e64 6963  be used to indic
+0003d090: 6174 6520 7468 6520 6f70 7469 6f6e 616c  ate the optional
+0003d0a0: 2074 7970 652e 0a0a 2020 2020 2020 2020   type...        
+0003d0b0: 2020 2020 2d20 5479 7065 2068 696e 7473      - Type hints
+0003d0c0: 2061 7265 206e 6f74 2073 7570 706f 7274   are not support
+0003d0d0: 6564 206f 6e20 6675 6e63 7469 6f6e 7320  ed on functions 
+0003d0e0: 6465 636f 7261 7465 6420 7769 7468 2064  decorated with d
+0003d0f0: 6563 6f72 6174 6f72 732e 0a0a 2020 2020  ecorators...    
+0003d100: 2020 2020 322e 2041 2074 656d 706f 7261      2. A tempora
+0003d110: 7279 2055 4454 4620 2877 6865 6e20 6060  ry UDTF (when ``
+0003d120: 6973 5f70 6572 6d61 6e65 6e74 6060 2069  is_permanent`` i
+0003d130: 7320 6060 4661 6c73 6560 6029 2069 7320  s ``False``) is 
+0003d140: 7363 6f70 6564 2074 6f20 7468 6973 2060  scoped to this `
+0003d150: 6073 6573 7369 6f6e 6060 0a20 2020 2020  `session``.     
+0003d160: 2020 2061 6e64 2061 6c6c 2055 4454 4620     and all UDTF 
+0003d170: 7265 6c61 7465 6420 6669 6c65 7320 7769  related files wi
+0003d180: 6c6c 2062 6520 7570 6c6f 6164 6564 2074  ll be uploaded t
+0003d190: 6f20 6120 7465 6d70 6f72 6172 7920 7365  o a temporary se
+0003d1a0: 7373 696f 6e20 7374 6167 650a 2020 2020  ssion stage.    
+0003d1b0: 2020 2020 283a 6675 6e63 3a60 7365 7373      (:func:`sess
+0003d1c0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
+0003d1d0: 7374 6167 6528 2920 3c73 6e6f 7766 6c61  stage() <snowfla
+0003d1e0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
+0003d1f0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
+0003d200: 7374 6167 653e 6029 2e0a 2020 2020 2020  stage>`)..      
+0003d210: 2020 466f 7220 6120 7065 726d 616e 656e    For a permanen
+0003d220: 7420 5544 5446 2c20 7468 6573 6520 6669  t UDTF, these fi
+0003d230: 6c65 7320 7769 6c6c 2062 6520 7570 6c6f  les will be uplo
+0003d240: 6164 6564 2074 6f20 7468 6520 7374 6167  aded to the stag
+0003d250: 6520 7468 6174 2079 6f75 2073 7065 6369  e that you speci
+0003d260: 6679 2e0a 0a20 2020 2020 2020 2033 2e20  fy...        3. 
+0003d270: 4279 2064 6566 6175 6c74 2c20 5544 5446  By default, UDTF
+0003d280: 2072 6567 6973 7472 6174 696f 6e20 6661   registration fa
+0003d290: 696c 7320 6966 2061 2066 756e 6374 696f  ils if a functio
+0003d2a0: 6e20 7769 7468 2074 6865 2073 616d 6520  n with the same 
+0003d2b0: 6e61 6d65 2069 7320 616c 7265 6164 790a  name is already.
+0003d2c0: 2020 2020 2020 2020 7265 6769 7374 6572          register
+0003d2d0: 6564 2e20 496e 766f 6b69 6e67 203a 6675  ed. Invoking :fu
+0003d2e0: 6e63 3a60 7564 7466 6020 7769 7468 2060  nc:`udtf` with `
+0003d2f0: 6072 6570 6c61 6365 6060 2073 6574 2074  `replace`` set t
+0003d300: 6f20 6060 5472 7565 6060 2077 696c 6c20  o ``True`` will 
+0003d310: 6f76 6572 7772 6974 6520 7468 650a 2020  overwrite the.  
+0003d320: 2020 2020 2020 7072 6576 696f 7573 6c79        previously
+0003d330: 2072 6567 6973 7465 7265 6420 6675 6e63   registered func
+0003d340: 7469 6f6e 2e0a 0a20 2020 2053 6565 2041  tion...    See A
+0003d350: 6c73 6f3a 0a20 2020 2020 2020 203a 636c  lso:.        :cl
+0003d360: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+0003d370: 736e 6f77 7061 726b 2e75 6474 662e 5544  snowpark.udtf.UD
+0003d380: 5446 5265 6769 7374 7261 7469 6f6e 600a  TFRegistration`.
+0003d390: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0003d3a0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0003d3b0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0003d3c0: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+0003d3d0: 7420 496e 7465 6765 7254 7970 652c 2053  t IntegerType, S
+0003d3e0: 7472 7563 7446 6965 6c64 2c20 5374 7275  tructField, Stru
+0003d3f0: 6374 5479 7065 0a20 2020 2020 2020 203e  ctType.        >
+0003d400: 3e3e 2063 6c61 7373 2050 7269 6d65 5369  >> class PrimeSi
+0003d410: 6576 653a 0a20 2020 2020 2020 202e 2e2e  eve:.        ...
+0003d420: 2020 2020 2064 6566 2070 726f 6365 7373       def process
+0003d430: 2873 656c 662c 206e 293a 0a20 2020 2020  (self, n):.     
+0003d440: 2020 202e 2e2e 2020 2020 2020 2020 2069     ...         i
+0003d450: 735f 7072 696d 6520 3d20 5b54 7275 655d  s_prime = [True]
+0003d460: 202a 2028 6e20 2b20 3129 0a20 2020 2020   * (n + 1).     
+0003d470: 2020 202e 2e2e 2020 2020 2020 2020 2069     ...         i
+0003d480: 735f 7072 696d 655b 305d 203d 2046 616c  s_prime[0] = Fal
+0003d490: 7365 0a20 2020 2020 2020 202e 2e2e 2020  se.        ...  
+0003d4a0: 2020 2020 2020 2069 735f 7072 696d 655b         is_prime[
+0003d4b0: 315d 203d 2046 616c 7365 0a20 2020 2020  1] = False.     
+0003d4c0: 2020 202e 2e2e 2020 2020 2020 2020 2070     ...         p
+0003d4d0: 203d 2032 0a20 2020 2020 2020 202e 2e2e   = 2.        ...
+0003d4e0: 2020 2020 2020 2020 2077 6869 6c65 2070           while p
+0003d4f0: 202a 2070 203c 3d20 6e3a 0a20 2020 2020   * p <= n:.     
+0003d500: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+0003d510: 2020 2069 6620 6973 5f70 7269 6d65 5b70     if is_prime[p
+0003d520: 5d3a 0a20 2020 2020 2020 202e 2e2e 2020  ]:.        ...  
+0003d530: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003d540: 2073 6574 2061 6c6c 206d 756c 7469 706c   set all multipl
+0003d550: 6573 206f 6620 7020 746f 2046 616c 7365  es of p to False
+0003d560: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003d570: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003d580: 2069 2069 6e20 7261 6e67 6528 7020 2a20   i in range(p * 
+0003d590: 702c 206e 202b 2031 2c20 7029 3a0a 2020  p, n + 1, p):.  
+0003d5a0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0003d5b0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0003d5c0: 5f70 7269 6d65 5b69 5d20 3d20 4661 6c73  _prime[i] = Fals
+0003d5d0: 650a 2020 2020 2020 2020 2e2e 2e20 2020  e.        ...   
+0003d5e0: 2020 2020 2020 2020 2020 7020 2b3d 2031            p += 1
+0003d5f0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003d600: 2020 2020 2023 2079 6965 6c64 2061 6c6c       # yield all
+0003d610: 2070 7269 6d65 206e 756d 6265 7273 0a20   prime numbers. 
+0003d620: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003d630: 2020 2066 6f72 2070 2069 6e20 7261 6e67     for p in rang
+0003d640: 6528 322c 206e 202b 2031 293a 0a20 2020  e(2, n + 1):.   
+0003d650: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003d660: 2020 2020 2069 6620 6973 5f70 7269 6d65       if is_prime
+0003d670: 5b70 5d3a 0a20 2020 2020 2020 202e 2e2e  [p]:.        ...
+0003d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d690: 2079 6965 6c64 2028 702c 290a 2020 2020   yield (p,).    
+0003d6a0: 2020 2020 3e3e 3e20 7072 696d 655f 7564      >>> prime_ud
+0003d6b0: 7466 203d 2075 6474 6628 5072 696d 6553  tf = udtf(PrimeS
+0003d6c0: 6965 7665 2c20 6f75 7470 7574 5f73 6368  ieve, output_sch
+0003d6d0: 656d 613d 5374 7275 6374 5479 7065 285b  ema=StructType([
+0003d6e0: 5374 7275 6374 4669 656c 6428 226e 756d  StructField("num
+0003d6f0: 6265 7222 2c20 496e 7465 6765 7254 7970  ber", IntegerTyp
+0003d700: 6528 2929 5d29 2c20 696e 7075 745f 7479  e())]), input_ty
+0003d710: 7065 733d 5b49 6e74 6567 6572 5479 7065  pes=[IntegerType
+0003d720: 2829 5d29 0a20 2020 2020 2020 203e 3e3e  ()]).        >>>
+0003d730: 2073 6573 7369 6f6e 2e74 6162 6c65 5f66   session.table_f
+0003d740: 756e 6374 696f 6e28 7072 696d 655f 7564  unction(prime_ud
+0003d750: 7466 286c 6974 2832 3029 2929 2e63 6f6c  tf(lit(20))).col
+0003d760: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0003d770: 526f 7728 4e55 4d42 4552 3d32 292c 2052  Row(NUMBER=2), R
+0003d780: 6f77 284e 554d 4245 523d 3329 2c20 526f  ow(NUMBER=3), Ro
+0003d790: 7728 4e55 4d42 4552 3d35 292c 2052 6f77  w(NUMBER=5), Row
+0003d7a0: 284e 554d 4245 523d 3729 2c20 526f 7728  (NUMBER=7), Row(
+0003d7b0: 4e55 4d42 4552 3d31 3129 2c20 526f 7728  NUMBER=11), Row(
+0003d7c0: 4e55 4d42 4552 3d31 3329 2c20 526f 7728  NUMBER=13), Row(
+0003d7d0: 4e55 4d42 4552 3d31 3729 2c20 526f 7728  NUMBER=17), Row(
+0003d7e0: 4e55 4d42 4552 3d31 3929 5d0a 0a20 2020  NUMBER=19)]..   
+0003d7f0: 2020 2020 2049 6e73 7465 6164 206f 6620       Instead of 
+0003d800: 6361 6c6c 696e 6720 6075 6474 6660 2069  calling `udtf` i
+0003d810: 7420 6973 2061 6c73 6f20 706f 7373 6962  t is also possib
+0003d820: 6c65 2074 6f20 7573 6520 7564 7466 2061  le to use udtf a
+0003d830: 7320 6120 6465 636f 7261 746f 722e 0a0a  s a decorator...
+0003d840: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0003d850: 2020 2020 2020 203e 3e3e 2040 7564 7466         >>> @udtf
+0003d860: 286e 616d 653d 2261 6c74 5f69 6e74 222c  (name="alt_int",
+0003d870: 7265 706c 6163 653d 5472 7565 2c20 6f75  replace=True, ou
+0003d880: 7470 7574 5f73 6368 656d 613d 5374 7275  tput_schema=Stru
+0003d890: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
+0003d8a0: 656c 6428 226e 756d 6265 7222 2c20 496e  eld("number", In
+0003d8b0: 7465 6765 7254 7970 6528 2929 5d29 2c20  tegerType())]), 
+0003d8c0: 696e 7075 745f 7479 7065 733d 5b49 6e74  input_types=[Int
+0003d8d0: 6567 6572 5479 7065 2829 5d29 0a20 2020  egerType()]).   
+0003d8e0: 2020 2020 202e 2e2e 2063 6c61 7373 2041       ... class A
+0003d8f0: 6c74 6572 6e61 746f 723a 0a20 2020 2020  lternator:.     
+0003d900: 2020 202e 2e2e 2020 2020 2064 6566 205f     ...     def _
+0003d910: 5f69 6e69 745f 5f28 7365 6c66 293a 0a20  _init__(self):. 
+0003d920: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003d930: 2020 2073 656c 662e 5f70 6f73 6974 6976     self._positiv
+0003d940: 6520 3d20 5472 7565 0a20 2020 2020 2020  e = True.       
+0003d950: 202e 2e2e 0a20 2020 2020 2020 202e 2e2e   ....        ...
+0003d960: 2020 2020 2064 6566 2070 726f 6365 7373       def process
+0003d970: 2873 656c 662c 206e 293a 0a20 2020 2020  (self, n):.     
+0003d980: 2020 202e 2e2e 2020 2020 2020 2020 2066     ...         f
+0003d990: 6f72 2069 2069 6e20 7261 6e67 6528 6e29  or i in range(n)
+0003d9a0: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
+0003d9b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003d9c0: 662e 5f70 6f73 6974 6976 653a 0a20 2020  f._positive:.   
+0003d9d0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003d9e0: 2020 2020 2020 2020 2079 6965 6c64 2028           yield (
+0003d9f0: 312c 290a 2020 2020 2020 2020 2e2e 2e20  1,).        ... 
+0003da00: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003da10: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
+0003da20: 2020 2020 2020 2020 2020 2020 2020 7969                yi
+0003da30: 656c 6420 282d 312c 290a 2020 2020 2020  eld (-1,).      
+0003da40: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0003da50: 2020 7365 6c66 2e5f 706f 7369 7469 7665    self._positive
+0003da60: 203d 206e 6f74 2073 656c 662e 5f70 6f73   = not self._pos
+0003da70: 6974 6976 650a 2020 2020 2020 2020 3e3e  itive.        >>
+0003da80: 3e20 7365 7373 696f 6e2e 7461 626c 655f  > session.table_
+0003da90: 6675 6e63 7469 6f6e 2822 616c 745f 696e  function("alt_in
+0003daa0: 7422 2c20 6c69 7428 3329 292e 636f 6c6c  t", lit(3)).coll
+0003dab0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0003dac0: 6f77 284e 554d 4245 523d 3129 2c20 526f  ow(NUMBER=1), Ro
+0003dad0: 7728 4e55 4d42 4552 3d2d 3129 2c20 526f  w(NUMBER=-1), Ro
+0003dae0: 7728 4e55 4d42 4552 3d31 295d 0a20 2020  w(NUMBER=1)].   
+0003daf0: 2020 2020 203e 3e3e 2073 6573 7369 6f6e       >>> session
+0003db00: 2e74 6162 6c65 5f66 756e 6374 696f 6e28  .table_function(
+0003db10: 2261 6c74 5f69 6e74 222c 206c 6974 2832  "alt_int", lit(2
+0003db20: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0003db30: 2020 2020 205b 526f 7728 4e55 4d42 4552       [Row(NUMBER
+0003db40: 3d31 292c 2052 6f77 284e 554d 4245 523d  =1), Row(NUMBER=
+0003db50: 2d31 295d 0a20 2020 2020 2020 203e 3e3e  -1)].        >>>
+0003db60: 2073 6573 7369 6f6e 2e74 6162 6c65 5f66   session.table_f
+0003db70: 756e 6374 696f 6e28 2261 6c74 5f69 6e74  unction("alt_int
+0003db80: 222c 206c 6974 2831 2929 2e63 6f6c 6c65  ", lit(1)).colle
+0003db90: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0003dba0: 7728 4e55 4d42 4552 3d31 295d 0a20 2020  w(NUMBER=1)].   
+0003dbb0: 2022 2222 0a20 2020 2073 6573 7369 6f6e   """.    session
+0003dbc0: 203d 2073 6573 7369 6f6e 206f 7220 736e   = session or sn
+0003dbd0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003dbe0: 2e73 6573 7369 6f6e 2e5f 6765 745f 6163  .session._get_ac
+0003dbf0: 7469 7665 5f73 6573 7369 6f6e 2829 0a20  tive_session(). 
+0003dc00: 2020 2069 6620 6861 6e64 6c65 7220 6973     if handler is
+0003dc10: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+0003dc20: 6574 7572 6e20 6675 6e63 746f 6f6c 732e  eturn functools.
+0003dc30: 7061 7274 6961 6c28 0a20 2020 2020 2020  partial(.       
+0003dc40: 2020 2020 2073 6573 7369 6f6e 2e75 6474       session.udt
+0003dc50: 662e 7265 6769 7374 6572 2c0a 2020 2020  f.register,.    
+0003dc60: 2020 2020 2020 2020 6f75 7470 7574 5f73          output_s
+0003dc70: 6368 656d 613d 6f75 7470 7574 5f73 6368  chema=output_sch
+0003dc80: 656d 612c 0a20 2020 2020 2020 2020 2020  ema,.           
+0003dc90: 2069 6e70 7574 5f74 7970 6573 3d69 6e70   input_types=inp
+0003dca0: 7574 5f74 7970 6573 2c0a 2020 2020 2020  ut_types,.      
+0003dcb0: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
+0003dcc0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+0003dcd0: 7065 726d 616e 656e 743d 6973 5f70 6572  permanent=is_per
+0003dce0: 6d61 6e65 6e74 2c0a 2020 2020 2020 2020  manent,.        
+0003dcf0: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
+0003dd00: 6f6e 3d73 7461 6765 5f6c 6f63 6174 696f  on=stage_locatio
+0003dd10: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
+0003dd20: 6d70 6f72 7473 3d69 6d70 6f72 7473 2c0a  mports=imports,.
+0003dd30: 2020 2020 2020 2020 2020 2020 7061 636b              pack
+0003dd40: 6167 6573 3d70 6163 6b61 6765 732c 0a20  ages=packages,. 
+0003dd50: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
+0003dd60: 6365 3d72 6570 6c61 6365 2c0a 2020 2020  ce=replace,.    
+0003dd70: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
+0003dd80: 7869 7374 733d 6966 5f6e 6f74 5f65 7869  xists=if_not_exi
+0003dd90: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
+0003dda0: 2070 6172 616c 6c65 6c3d 7061 7261 6c6c   parallel=parall
+0003ddb0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0003ddc0: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
+0003ddd0: 3d73 7461 7465 6d65 6e74 5f70 6172 616d  =statement_param
+0003dde0: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+0003ddf0: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
+0003de00: 2020 2020 2020 2020 2020 7365 6375 7265            secure
+0003de10: 3d73 6563 7572 652c 0a20 2020 2020 2020  =secure,.       
+0003de20: 2029 0a20 2020 2065 6c73 653a 0a20 2020   ).    else:.   
+0003de30: 2020 2020 2072 6574 7572 6e20 7365 7373       return sess
+0003de40: 696f 6e2e 7564 7466 2e72 6567 6973 7465  ion.udtf.registe
+0003de50: 7228 0a20 2020 2020 2020 2020 2020 2068  r(.            h
+0003de60: 616e 646c 6572 2c0a 2020 2020 2020 2020  andler,.        
+0003de70: 2020 2020 6f75 7470 7574 5f73 6368 656d      output_schem
+0003de80: 613d 6f75 7470 7574 5f73 6368 656d 612c  a=output_schema,
+0003de90: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+0003dea0: 7574 5f74 7970 6573 3d69 6e70 7574 5f74  ut_types=input_t
+0003deb0: 7970 6573 2c0a 2020 2020 2020 2020 2020  ypes,.          
+0003dec0: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
+0003ded0: 2020 2020 2020 2020 2069 735f 7065 726d           is_perm
+0003dee0: 616e 656e 743d 6973 5f70 6572 6d61 6e65  anent=is_permane
+0003def0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+0003df00: 7374 6167 655f 6c6f 6361 7469 6f6e 3d73  stage_location=s
+0003df10: 7461 6765 5f6c 6f63 6174 696f 6e2c 0a20  tage_location,. 
+0003df20: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0003df30: 7473 3d69 6d70 6f72 7473 2c0a 2020 2020  ts=imports,.    
+0003df40: 2020 2020 2020 2020 7061 636b 6167 6573          packages
+0003df50: 3d70 6163 6b61 6765 732c 0a20 2020 2020  =packages,.     
+0003df60: 2020 2020 2020 2072 6570 6c61 6365 3d72         replace=r
+0003df70: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
+0003df80: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
+0003df90: 733d 6966 5f6e 6f74 5f65 7869 7374 732c  s=if_not_exists,
+0003dfa0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0003dfb0: 616c 6c65 6c3d 7061 7261 6c6c 656c 2c0a  allel=parallel,.
+0003dfc0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+0003dfd0: 656d 656e 745f 7061 7261 6d73 3d73 7461  ement_params=sta
+0003dfe0: 7465 6d65 6e74 5f70 6172 616d 732c 0a20  tement_params,. 
+0003dff0: 2020 2020 2020 2020 2020 2073 7472 6963             stric
+0003e000: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
+0003e010: 2020 2020 2020 7365 6375 7265 3d73 6563        secure=sec
+0003e020: 7572 652c 0a20 2020 2020 2020 2029 0a0a  ure,.        )..
+0003e030: 0a40 7072 6976 6174 655f 7072 6576 6965  .@private_previe
+0003e040: 7728 7665 7273 696f 6e3d 2231 2e36 2e30  w(version="1.6.0
+0003e050: 2229 0a64 6566 2075 6461 6628 0a20 2020  ").def udaf(.   
+0003e060: 2068 616e 646c 6572 3a20 4f70 7469 6f6e   handler: Option
+0003e070: 616c 5b74 7970 696e 672e 5479 7065 5d20  al[typing.Type] 
+0003e080: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
+0003e090: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
+0003e0a0: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
+0003e0b0: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
+0003e0c0: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
+0003e0d0: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
+0003e0e0: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
+0003e0f0: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
+0003e100: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
+0003e110: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
+0003e120: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
+0003e130: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+0003e140: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
+0003e150: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+0003e160: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0003e170: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
+0003e180: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
+0003e190: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
+0003e1a0: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
+0003e1b0: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
+0003e1c0: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
+0003e1d0: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
+0003e1e0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
+0003e1f0: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
+0003e200: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
+0003e210: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
+0003e220: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
+0003e230: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
+0003e240: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003e250: 2e73 6573 7369 6f6e 2e53 6573 7369 6f6e  .session.Session
+0003e260: 225d 203d 204e 6f6e 652c 0a20 2020 2070  "] = None,.    p
+0003e270: 6172 616c 6c65 6c3a 2069 6e74 203d 2034  arallel: int = 4
+0003e280: 2c0a 2020 2020 7374 6174 656d 656e 745f  ,.    statement_
+0003e290: 7061 7261 6d73 3a20 4f70 7469 6f6e 616c  params: Optional
+0003e2a0: 5b44 6963 745b 7374 722c 2073 7472 5d5d  [Dict[str, str]]
+0003e2b0: 203d 204e 6f6e 652c 0a29 202d 3e20 556e   = None,.) -> Un
+0003e2c0: 696f 6e5b 5573 6572 4465 6669 6e65 6441  ion[UserDefinedA
+0003e2d0: 6767 7265 6761 7465 4675 6e63 7469 6f6e  ggregateFunction
+0003e2e0: 2c20 6675 6e63 746f 6f6c 732e 7061 7274  , functools.part
+0003e2f0: 6961 6c5d 3a0a 2020 2020 2222 2252 6567  ial]:.    """Reg
+0003e300: 6973 7465 7273 2061 2050 7974 686f 6e20  isters a Python 
+0003e310: 636c 6173 7320 6173 2061 2053 6e6f 7766  class as a Snowf
+0003e320: 6c61 6b65 2050 7974 686f 6e20 5544 4146  lake Python UDAF
+0003e330: 2061 6e64 2072 6574 7572 6e73 2074 6865   and returns the
+0003e340: 2055 4441 462e 0a0a 2020 2020 4974 2063   UDAF...    It c
+0003e350: 616e 2062 6520 7573 6564 2061 7320 6569  an be used as ei
+0003e360: 7468 6572 2061 2066 756e 6374 696f 6e20  ther a function 
+0003e370: 6361 6c6c 206f 7220 6120 6465 636f 7261  call or a decora
+0003e380: 746f 722e 2049 6e20 6d6f 7374 2063 6173  tor. In most cas
+0003e390: 6573 2079 6f75 2077 6f72 6b20 7769 7468  es you work with
+0003e3a0: 2061 2073 696e 676c 6520 7365 7373 696f   a single sessio
+0003e3b0: 6e2e 0a20 2020 2054 6869 7320 6675 6e63  n..    This func
+0003e3c0: 7469 6f6e 2075 7365 7320 7468 6174 2073  tion uses that s
+0003e3d0: 6573 7369 6f6e 2074 6f20 7265 6769 7374  ession to regist
+0003e3e0: 6572 2074 6865 2055 4441 462e 2049 6620  er the UDAF. If 
+0003e3f0: 796f 7520 6861 7665 206d 756c 7469 706c  you have multipl
+0003e400: 6520 7365 7373 696f 6e73 2c20 796f 7520  e sessions, you 
+0003e410: 6e65 6564 2074 6f0a 2020 2020 6578 706c  need to.    expl
+0003e420: 6963 6974 6c79 2073 7065 6369 6679 2074  icitly specify t
+0003e430: 6865 2060 6073 6573 7369 6f6e 6060 2070  he ``session`` p
+0003e440: 6172 616d 6574 6572 206f 6620 7468 6973  arameter of this
+0003e450: 2066 756e 6374 696f 6e2e 2049 6620 796f   function. If yo
+0003e460: 7520 6861 7665 2061 2066 756e 6374 696f  u have a functio
+0003e470: 6e20 616e 6420 776f 756c 640a 2020 2020  n and would.    
+0003e480: 6c69 6b65 2074 6f20 7265 6769 7374 6572  like to register
+0003e490: 2069 7420 746f 206d 756c 7469 706c 6520   it to multiple 
+0003e4a0: 6461 7461 6261 7365 732c 2075 7365 2060  databases, use `
+0003e4b0: 6073 6573 7369 6f6e 2e75 6461 662e 7265  `session.udaf.re
+0003e4c0: 6769 7374 6572 6060 2069 6e73 7465 6164  gister`` instead
+0003e4d0: 2e20 5365 6520 6578 616d 706c 6573 0a20  . See examples. 
+0003e4e0: 2020 2069 6e20 3a63 6c61 7373 3a60 7e73     in :class:`~s
+0003e4f0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0003e500: 6b2e 7564 6166 2e55 4441 4652 6567 6973  k.udaf.UDAFRegis
+0003e510: 7472 6174 696f 6e60 2e0a 0a20 2020 2041  tration`...    A
+0003e520: 7267 733a 0a20 2020 2020 2020 2068 616e  rgs:.        han
+0003e530: 646c 6572 3a20 4120 5079 7468 6f6e 2063  dler: A Python c
+0003e540: 6c61 7373 2075 7365 6420 666f 7220 6372  lass used for cr
+0003e550: 6561 7469 6e67 2074 6865 2055 4441 462e  eating the UDAF.
+0003e560: 0a20 2020 2020 2020 2072 6574 7572 6e5f  .        return_
+0003e570: 7479 7065 3a20 4120 3a63 6c61 7373 3a60  type: A :class:`
+0003e580: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+0003e590: 6172 6b2e 7479 7065 732e 4461 7461 5479  ark.types.DataTy
+0003e5a0: 7065 6020 7265 7072 6573 656e 7469 6e67  pe` representing
+0003e5b0: 2074 6865 2072 6574 7572 6e20 6461 7461   the return data
+0003e5c0: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
+0003e5d0: 6520 6f66 2074 6865 2055 4441 462e 204f  e of the UDAF. O
+0003e5e0: 7074 696f 6e61 6c20 6966 2074 7970 6520  ptional if type 
+0003e5f0: 6869 6e74 7320 6172 6520 7072 6f76 6964  hints are provid
+0003e600: 6564 2e0a 2020 2020 2020 2020 696e 7075  ed..        inpu
+0003e610: 745f 7479 7065 733a 2041 206c 6973 7420  t_types: A list 
+0003e620: 6f66 203a 636c 6173 733a 607e 736e 6f77  of :class:`~snow
+0003e630: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003e640: 7970 6573 2e44 6174 6154 7970 6560 0a20  ypes.DataType`. 
+0003e650: 2020 2020 2020 2020 2020 2072 6570 7265             repre
+0003e660: 7365 6e74 696e 6720 7468 6520 696e 7075  senting the inpu
+0003e670: 7420 6461 7461 2074 7970 6573 206f 6620  t data types of 
+0003e680: 7468 6520 5544 4146 2e20 4f70 7469 6f6e  the UDAF. Option
+0003e690: 616c 2069 660a 2020 2020 2020 2020 2020  al if.          
+0003e6a0: 2020 7479 7065 2068 696e 7473 2061 7265    type hints are
+0003e6b0: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
+0003e6c0: 2020 206e 616d 653a 2041 2073 7472 696e     name: A strin
+0003e6d0: 6720 6f72 206c 6973 7420 6f66 2073 7472  g or list of str
+0003e6e0: 696e 6773 2074 6861 7420 7370 6563 6966  ings that specif
+0003e6f0: 7920 7468 6520 6e61 6d65 206f 7220 6675  y the name or fu
+0003e700: 6c6c 792d 7175 616c 6966 6965 640a 2020  lly-qualified.  
+0003e710: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
+0003e720: 2069 6465 6e74 6966 6965 7220 2864 6174   identifier (dat
+0003e730: 6162 6173 6520 6e61 6d65 2c20 7363 6865  abase name, sche
+0003e740: 6d61 206e 616d 652c 2061 6e64 2066 756e  ma name, and fun
+0003e750: 6374 696f 6e20 6e61 6d65 2920 666f 720a  ction name) for.
+0003e760: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0003e770: 5544 4146 2069 6e20 536e 6f77 666c 616b  UDAF in Snowflak
+0003e780: 652c 2077 6869 6368 2061 6c6c 6f77 7320  e, which allows 
+0003e790: 796f 7520 746f 2063 616c 6c20 7468 6973  you to call this
+0003e7a0: 2055 4441 4620 696e 2061 2053 514c 0a20   UDAF in a SQL. 
+0003e7b0: 2020 2020 2020 2020 2020 2063 6f6d 6d61             comma
+0003e7c0: 6e64 206f 7220 7669 6120 3a66 756e 633a  nd or via :func:
+0003e7d0: 6044 6174 6146 7261 6d65 2e61 6767 602e  `DataFrame.agg`.
+0003e7e0: 2049 6620 6974 2069 7320 6e6f 7420 7072   If it is not pr
+0003e7f0: 6f76 6964 6564 2c20 6120 6e61 6d65 2077  ovided, a name w
+0003e800: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+0003e810: 6265 2061 7574 6f6d 6174 6963 616c 6c79  be automatically
+0003e820: 2067 656e 6572 6174 6564 2066 6f72 2074   generated for t
+0003e830: 6865 2055 4441 462e 2041 206e 616d 6520  he UDAF. A name 
+0003e840: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
+0003e850: 6420 7768 656e 0a20 2020 2020 2020 2020  d when.         
+0003e860: 2020 2060 6069 735f 7065 726d 616e 656e     ``is_permanen
+0003e870: 7460 6020 6973 2060 6054 7275 6560 602e  t`` is ``True``.
+0003e880: 0a20 2020 2020 2020 2069 735f 7065 726d  .        is_perm
+0003e890: 616e 656e 743a 2057 6865 7468 6572 2074  anent: Whether t
+0003e8a0: 6f20 6372 6561 7465 2061 2070 6572 6d61  o create a perma
+0003e8b0: 6e65 6e74 2055 4441 462e 2054 6865 2064  nent UDAF. The d
+0003e8c0: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
+0003e8d0: 6560 602e 0a20 2020 2020 2020 2020 2020  e``..           
+0003e8e0: 2049 6620 6974 2069 7320 6060 5472 7565   If it is ``True
+0003e8f0: 6060 2c20 6120 7661 6c69 6420 6060 7374  ``, a valid ``st
+0003e900: 6167 655f 6c6f 6361 7469 6f6e 6060 206d  age_location`` m
+0003e910: 7573 7420 6265 2070 726f 7669 6465 642e  ust be provided.
+0003e920: 0a20 2020 2020 2020 2073 7461 6765 5f6c  .        stage_l
+0003e930: 6f63 6174 696f 6e3a 2054 6865 2073 7461  ocation: The sta
+0003e940: 6765 206c 6f63 6174 696f 6e20 7768 6572  ge location wher
+0003e950: 6520 7468 6520 5079 7468 6f6e 2066 696c  e the Python fil
+0003e960: 6520 666f 7220 7468 6520 5544 4146 0a20  e for the UDAF. 
+0003e970: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
+0003e980: 7473 2064 6570 656e 6465 6e63 6965 7320  ts dependencies 
+0003e990: 7368 6f75 6c64 2062 6520 7570 6c6f 6164  should be upload
+0003e9a0: 6564 2e20 5468 6520 7374 6167 6520 6c6f  ed. The stage lo
+0003e9b0: 6361 7469 6f6e 206d 7573 7420 6265 2073  cation must be s
+0003e9c0: 7065 6369 6669 6564 0a20 2020 2020 2020  pecified.       
+0003e9d0: 2020 2020 2077 6865 6e20 6060 6973 5f70       when ``is_p
+0003e9e0: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
+0003e9f0: 5472 7565 6060 2c20 616e 6420 6974 2077  True``, and it w
+0003ea00: 696c 6c20 6265 2069 676e 6f72 6564 2077  ill be ignored w
+0003ea10: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+0003ea20: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
+0003ea30: 2069 7320 6060 4661 6c73 6560 602e 2049   is ``False``. I
+0003ea40: 7420 6361 6e20 6265 2061 6e79 2073 7461  t can be any sta
+0003ea50: 6765 206f 7468 6572 2074 6861 6e20 7465  ge other than te
+0003ea60: 6d70 6f72 6172 790a 2020 2020 2020 2020  mporary.        
+0003ea70: 2020 2020 7374 6167 6573 2061 6e64 2065      stages and e
+0003ea80: 7874 6572 6e61 6c20 7374 6167 6573 2e0a  xternal stages..
+0003ea90: 2020 2020 2020 2020 696d 706f 7274 733a          imports:
+0003eaa0: 2041 206c 6973 7420 6f66 2069 6d70 6f72   A list of impor
+0003eab0: 7473 2074 6861 7420 6f6e 6c79 2061 7070  ts that only app
+0003eac0: 6c79 2074 6f20 7468 6973 2055 4441 462e  ly to this UDAF.
+0003ead0: 2059 6f75 2063 616e 2075 7365 2061 2073   You can use a s
+0003eae0: 7472 696e 6720 746f 0a20 2020 2020 2020  tring to.       
+0003eaf0: 2020 2020 2072 6570 7265 7365 6e74 2061       represent a
+0003eb00: 2066 696c 6520 7061 7468 2028 7369 6d69   file path (simi
+0003eb10: 6c61 7220 746f 2074 6865 2060 6070 6174  lar to the ``pat
+0003eb20: 6860 6020 6172 6775 6d65 6e74 2069 6e0a  h`` argument in.
+0003eb30: 2020 2020 2020 2020 2020 2020 3a6d 6574              :met
+0003eb40: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
+0003eb50: 6f77 7061 726b 2e53 6573 7369 6f6e 2e61  owpark.Session.a
+0003eb60: 6464 5f69 6d70 6f72 7460 2920 696e 2074  dd_import`) in t
+0003eb70: 6869 7320 6c69 7374 2c20 6f72 2061 2074  his list, or a t
+0003eb80: 7570 6c65 206f 6620 7477 6f0a 2020 2020  uple of two.    
+0003eb90: 2020 2020 2020 2020 7374 7269 6e67 7320          strings 
+0003eba0: 746f 2072 6570 7265 7365 6e74 2061 2066  to represent a f
+0003ebb0: 696c 6520 7061 7468 2061 6e64 2061 6e20  ile path and an 
+0003ebc0: 696d 706f 7274 2070 6174 6820 2873 696d  import path (sim
+0003ebd0: 696c 6172 2074 6f20 7468 6520 6060 696d  ilar to the ``im
+0003ebe0: 706f 7274 5f70 6174 6860 600a 2020 2020  port_path``.    
+0003ebf0: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
+0003ec00: 2069 6e20 3a6d 6574 683a 607e 736e 6f77   in :meth:`~snow
+0003ec10: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
+0003ec20: 6573 7369 6f6e 2e61 6464 5f69 6d70 6f72  ession.add_impor
+0003ec30: 7460 292e 2054 6865 7365 2055 4441 462d  t`). These UDAF-
+0003ec40: 6c65 7665 6c20 696d 706f 7274 730a 2020  level imports.  
+0003ec50: 2020 2020 2020 2020 2020 7769 6c6c 206f            will o
+0003ec60: 7665 7272 6964 6520 7468 6520 7365 7373  verride the sess
+0003ec70: 696f 6e2d 6c65 7665 6c20 696d 706f 7274  ion-level import
+0003ec80: 7320 6164 6465 6420 6279 0a20 2020 2020  s added by.     
+0003ec90: 2020 2020 2020 203a 6d65 7468 3a60 7e73         :meth:`~s
+0003eca0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0003ecb0: 6b2e 5365 7373 696f 6e2e 6164 645f 696d  k.Session.add_im
+0003ecc0: 706f 7274 602e 204e 6f74 6520 7468 6174  port`. Note that
+0003ecd0: 2061 6e20 656d 7074 7920 6c69 7374 206d   an empty list m
+0003ece0: 6561 6e73 0a20 2020 2020 2020 2020 2020  eans.           
+0003ecf0: 206e 6f20 696d 706f 7274 2066 6f72 2074   no import for t
+0003ed00: 6869 7320 5544 4146 2c20 616e 6420 6060  his UDAF, and ``
+0003ed10: 4e6f 6e65 6060 206f 7220 6e6f 7420 7370  None`` or not sp
+0003ed20: 6563 6966 7969 6e67 2074 6869 7320 7061  ecifying this pa
+0003ed30: 7261 6d65 7465 7220 6d65 616e 7320 7573  rameter means us
+0003ed40: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0003ed50: 7365 7373 696f 6e2d 6c65 7665 6c20 696d  session-level im
+0003ed60: 706f 7274 732e 0a20 2020 2020 2020 2070  ports..        p
+0003ed70: 6163 6b61 6765 733a 2041 206c 6973 7420  ackages: A list 
+0003ed80: 6f66 2070 6163 6b61 6765 7320 7468 6174  of packages that
+0003ed90: 206f 6e6c 7920 6170 706c 7920 746f 2074   only apply to t
+0003eda0: 6869 7320 5544 4146 2e20 5468 6573 6520  his UDAF. These 
+0003edb0: 5544 4146 2d6c 6576 656c 2070 6163 6b61  UDAF-level packa
+0003edc0: 6765 730a 2020 2020 2020 2020 2020 2020  ges.            
+0003edd0: 7769 6c6c 206f 7665 7272 6964 6520 7468  will override th
+0003ede0: 6520 7365 7373 696f 6e2d 6c65 7665 6c20  e session-level 
+0003edf0: 7061 636b 6167 6573 2061 6464 6564 2062  packages added b
+0003ee00: 790a 2020 2020 2020 2020 2020 2020 3a6d  y.            :m
+0003ee10: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
+0003ee20: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+0003ee30: 2e61 6464 5f70 6163 6b61 6765 7360 2061  .add_packages` a
+0003ee40: 6e64 0a20 2020 2020 2020 2020 2020 203a  nd.            :
+0003ee50: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
+0003ee60: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
+0003ee70: 6e2e 6164 645f 7265 7175 6972 656d 656e  n.add_requiremen
+0003ee80: 7473 602e 204e 6f74 6520 7468 6174 2061  ts`. Note that a
+0003ee90: 6e20 656d 7074 7920 6c69 7374 206d 6561  n empty list mea
+0003eea0: 6e73 0a20 2020 2020 2020 2020 2020 206e  ns.            n
+0003eeb0: 6f20 7061 636b 6167 6520 666f 7220 7468  o package for th
+0003eec0: 6973 2055 4441 462c 2061 6e64 2060 604e  is UDAF, and ``N
+0003eed0: 6f6e 6560 6020 6f72 206e 6f74 2073 7065  one`` or not spe
+0003eee0: 6369 6679 696e 6720 7468 6973 2070 6172  cifying this par
+0003eef0: 616d 6574 6572 206d 6561 6e73 2075 7369  ameter means usi
+0003ef00: 6e67 0a20 2020 2020 2020 2020 2020 2073  ng.            s
+0003ef10: 6573 7369 6f6e 2d6c 6576 656c 2070 6163  ession-level pac
+0003ef20: 6b61 6765 732e 2054 6f20 7573 6520 5079  kages. To use Py
+0003ef30: 7468 6f6e 2070 6163 6b61 6765 7320 7468  thon packages th
+0003ef40: 6174 2061 7265 206e 6f74 2061 7661 696c  at are not avail
+0003ef50: 6162 6c65 2069 6e20 536e 6f77 666c 616b  able in Snowflak
+0003ef60: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
+0003ef70: 6566 6572 2074 6f20 3a6d 6574 683a 607e  efer to :meth:`~
+0003ef80: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003ef90: 726b 2e53 6573 7369 6f6e 2e63 7573 746f  rk.Session.custo
+0003efa0: 6d5f 7061 636b 6167 655f 7573 6167 655f  m_package_usage_
+0003efb0: 636f 6e66 6967 602e 0a20 2020 2020 2020  config`..       
+0003efc0: 2072 6570 6c61 6365 3a20 5768 6574 6865   replace: Whethe
+0003efd0: 7220 746f 2072 6570 6c61 6365 2061 2055  r to replace a U
+0003efe0: 4441 4620 7468 6174 2061 6c72 6561 6479  DAF that already
+0003eff0: 2077 6173 2072 6567 6973 7465 7265 642e   was registered.
+0003f000: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+0003f010: 6060 4661 6c73 6560 602e 0a20 2020 2020  ``False``..     
+0003f020: 2020 2020 2020 2049 6620 6974 2069 7320         If it is 
+0003f030: 6060 4661 6c73 6560 602c 2061 7474 656d  ``False``, attem
+0003f040: 7074 696e 6720 746f 2072 6567 6973 7465  pting to registe
+0003f050: 7220 6120 5544 4146 2077 6974 6820 6120  r a UDAF with a 
+0003f060: 6e61 6d65 2074 6861 7420 616c 7265 6164  name that alread
+0003f070: 7920 6578 6973 7473 0a20 2020 2020 2020  y exists.       
+0003f080: 2020 2020 2072 6573 756c 7473 2069 6e20       results in 
+0003f090: 6120 6060 536e 6f77 7061 726b 5351 4c45  a ``SnowparkSQLE
+0003f0a0: 7863 6570 7469 6f6e 6060 2065 7863 6570  xception`` excep
+0003f0b0: 7469 6f6e 2062 6569 6e67 2074 6872 6f77  tion being throw
+0003f0c0: 6e2e 2049 6620 6974 2069 7320 6060 5472  n. If it is ``Tr
+0003f0d0: 7565 6060 2c0a 2020 2020 2020 2020 2020  ue``,.          
+0003f0e0: 2020 616e 2065 7869 7374 696e 6720 5544    an existing UD
+0003f0f0: 4146 2077 6974 6820 7468 6520 7361 6d65  AF with the same
+0003f100: 206e 616d 6520 6973 206f 7665 7277 7269   name is overwri
+0003f110: 7474 656e 2e0a 2020 2020 2020 2020 6966  tten..        if
+0003f120: 5f6e 6f74 5f65 7869 7374 733a 2057 6865  _not_exists: Whe
+0003f130: 7468 6572 2074 6f20 736b 6970 2063 7265  ther to skip cre
+0003f140: 6174 696f 6e20 6f66 2061 2055 4441 4620  ation of a UDAF 
+0003f150: 7768 656e 206f 6e65 2077 6974 6820 7468  when one with th
+0003f160: 6520 7361 6d65 2073 6967 6e61 7475 7265  e same signature
+0003f170: 2061 6c72 6561 6479 2065 7869 7374 732e   already exists.
+0003f180: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0003f190: 2064 6566 6175 6c74 2069 7320 6060 4661   default is ``Fa
+0003f1a0: 6c73 6560 602e 2060 6069 665f 6e6f 745f  lse``. ``if_not_
+0003f1b0: 6578 6973 7473 6060 2061 6e64 2060 6072  exists`` and ``r
+0003f1c0: 6570 6c61 6365 6060 2061 7265 206d 7574  eplace`` are mut
+0003f1d0: 7561 6c6c 7920 6578 636c 7573 6976 650a  ually exclusive.
+0003f1e0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0003f1f0: 6120 6060 5661 6c75 6545 7272 6f72 6060  a ``ValueError``
+0003f200: 2069 7320 7261 6973 6564 2077 6865 6e20   is raised when 
+0003f210: 626f 7468 2061 7265 2073 6574 2e20 4966  both are set. If
+0003f220: 2069 7420 6973 2060 6054 7275 6560 6020   it is ``True`` 
+0003f230: 616e 6420 6120 5544 4146 2077 6974 680a  and a UDAF with.
+0003f240: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0003f250: 7361 6d65 2073 6967 6e61 7475 7265 2065  same signature e
+0003f260: 7869 7374 732c 2074 6865 2055 4441 4620  xists, the UDAF 
+0003f270: 6372 6561 7469 6f6e 2069 7320 736b 6970  creation is skip
+0003f280: 7065 642e 0a20 2020 2020 2020 2073 6573  ped..        ses
+0003f290: 7369 6f6e 3a20 5573 6520 7468 6973 2073  sion: Use this s
+0003f2a0: 6573 7369 6f6e 2074 6f20 7265 6769 7374  ession to regist
+0003f2b0: 6572 2074 6865 2055 4441 462e 2049 6620  er the UDAF. If 
+0003f2c0: 6974 2773 206e 6f74 2073 7065 6369 6669  it's not specifi
+0003f2d0: 6564 2c20 7468 6520 7365 7373 696f 6e20  ed, the session 
+0003f2e0: 7468 6174 2079 6f75 2063 7265 6174 6564  that you created
+0003f2f0: 2062 6566 6f72 650a 2020 2020 2020 2020   before.        
+0003f300: 2020 2020 6361 6c6c 696e 6720 7468 6973      calling this
+0003f310: 2066 756e 6374 696f 6e20 7769 6c6c 2062   function will b
+0003f320: 6520 7573 6564 2e20 596f 7520 6e65 6564  e used. You need
+0003f330: 2074 6f20 7370 6563 6966 7920 7468 6973   to specify this
+0003f340: 2070 6172 616d 6574 6572 2069 6620 796f   parameter if yo
+0003f350: 7520 6861 7665 2063 7265 6174 6564 206d  u have created m
+0003f360: 756c 7469 706c 650a 2020 2020 2020 2020  ultiple.        
+0003f370: 2020 2020 7365 7373 696f 6e73 2062 6566      sessions bef
+0003f380: 6f72 6520 6361 6c6c 696e 6720 7468 6973  ore calling this
+0003f390: 206d 6574 686f 642e 0a20 2020 2020 2020   method..       
+0003f3a0: 2070 6172 616c 6c65 6c3a 2054 6865 206e   parallel: The n
+0003f3b0: 756d 6265 7220 6f66 2074 6872 6561 6473  umber of threads
+0003f3c0: 2074 6f20 7573 6520 666f 7220 7570 6c6f   to use for uplo
+0003f3d0: 6164 696e 6720 5544 4146 2066 696c 6573  ading UDAF files
+0003f3e0: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
+0003f3f0: 2020 2020 2020 6050 5554 203c 6874 7470        `PUT <http
+0003f400: 733a 2f2f 646f 6373 2e73 6e6f 7766 6c61  s://docs.snowfla
+0003f410: 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d 7265  ke.com/en/sql-re
+0003f420: 6665 7265 6e63 652f 7371 6c2f 7075 742e  ference/sql/put.
+0003f430: 6874 6d6c 2370 7574 3e60 5f0a 2020 2020  html#put>`_.    
+0003f440: 2020 2020 2020 2020 636f 6d6d 616e 642e          command.
+0003f450: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+0003f460: 7565 2069 7320 3420 616e 6420 7375 7070  ue is 4 and supp
+0003f470: 6f72 7465 6420 7661 6c75 6573 2061 7265  orted values are
+0003f480: 2066 726f 6d20 3120 746f 2039 392e 0a20   from 1 to 99.. 
+0003f490: 2020 2020 2020 2020 2020 2049 6e63 7265             Incre
+0003f4a0: 6173 696e 6720 7468 6520 6e75 6d62 6572  asing the number
+0003f4b0: 206f 6620 7468 7265 6164 7320 6361 6e20   of threads can 
+0003f4c0: 696d 7072 6f76 6520 7065 7266 6f72 6d61  improve performa
+0003f4d0: 6e63 6520 7768 656e 2075 706c 6f61 6469  nce when uploadi
+0003f4e0: 6e67 0a20 2020 2020 2020 2020 2020 206c  ng.            l
+0003f4f0: 6172 6765 2055 4441 4620 6669 6c65 732e  arge UDAF files.
+0003f500: 0a20 2020 2020 2020 2073 7461 7465 6d65  .        stateme
+0003f510: 6e74 5f70 6172 616d 733a 2044 6963 7469  nt_params: Dicti
+0003f520: 6f6e 6172 7920 6f66 2073 7461 7465 6d65  onary of stateme
+0003f530: 6e74 206c 6576 656c 2070 6172 616d 6574  nt level paramet
+0003f540: 6572 7320 746f 2062 6520 7365 7420 7768  ers to be set wh
+0003f550: 696c 6520 6578 6563 7574 696e 6720 7468  ile executing th
+0003f560: 6973 2061 6374 696f 6e2e 0a0a 2020 2020  is action...    
+0003f570: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+0003f580: 2041 2055 4441 4620 6675 6e63 7469 6f6e   A UDAF function
+0003f590: 2074 6861 7420 6361 6e20 6265 2063 616c   that can be cal
+0003f5a0: 6c65 6420 7769 7468 203a 636c 6173 733a  led with :class:
+0003f5b0: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+0003f5c0: 7061 726b 2e43 6f6c 756d 6e60 2065 7870  park.Column` exp
+0003f5d0: 7265 7373 696f 6e73 2e0a 0a20 2020 204e  ressions...    N
+0003f5e0: 6f74 653a 0a20 2020 2020 2020 2031 2e20  ote:.        1. 
+0003f5f0: 5768 656e 2074 7970 6520 6869 6e74 7320  When type hints 
+0003f600: 6172 6520 7072 6f76 6964 6564 2061 6e64  are provided and
+0003f610: 2061 7265 2063 6f6d 706c 6574 6520 666f   are complete fo
+0003f620: 7220 6120 6675 6e63 7469 6f6e 2c0a 2020  r a function,.  
+0003f630: 2020 2020 2020 6060 7265 7475 726e 5f74        ``return_t
+0003f640: 7970 6560 6020 616e 6420 6060 696e 7075  ype`` and ``inpu
+0003f650: 745f 7479 7065 7360 6020 6172 6520 6f70  t_types`` are op
+0003f660: 7469 6f6e 616c 2061 6e64 2077 696c 6c20  tional and will 
+0003f670: 6265 2069 676e 6f72 6564 2e0a 2020 2020  be ignored..    
+0003f680: 2020 2020 5365 6520 6465 7461 696c 7320      See details 
+0003f690: 6f66 2073 7570 706f 7274 6564 2064 6174  of supported dat
+0003f6a0: 6120 7479 7065 7320 666f 7220 5544 4146  a types for UDAF
+0003f6b0: 7320 696e 0a20 2020 2020 2020 203a 636c  s in.        :cl
+0003f6c0: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+0003f6d0: 736e 6f77 7061 726b 2e75 6461 662e 5544  snowpark.udaf.UD
+0003f6e0: 4146 5265 6769 7374 7261 7469 6f6e 602e  AFRegistration`.
+0003f6f0: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0003f700: 596f 7520 6361 6e20 7573 6520 7573 6520  You can use use 
+0003f710: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
+0003f720: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0003f730: 2e56 6172 6961 6e74 6020 746f 0a20 2020  .Variant` to.   
+0003f740: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
+0003f750: 6174 6520 6120 7661 7269 616e 742c 2061  ate a variant, a
+0003f760: 6e64 2075 7365 203a 6174 7472 3a60 7e73  nd use :attr:`~s
+0003f770: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0003f780: 6b2e 7479 7065 732e 4765 6f67 7261 7068  k.types.Geograph
+0003f790: 7960 0a20 2020 2020 2020 2020 2020 2020  y`.             
+0003f7a0: 2074 6f20 616e 6e6f 7461 7465 2061 2067   to annotate a g
+0003f7b0: 656f 6772 6170 6879 2077 6865 6e20 6465  eography when de
+0003f7c0: 6669 6e69 6e67 2061 2055 4441 462e 0a0a  fining a UDAF...
+0003f7d0: 2020 2020 2020 2020 2020 2020 2d20 3a63              - :c
+0003f7e0: 6c61 7373 3a60 7479 7069 6e67 2e55 6e69  lass:`typing.Uni
+0003f7f0: 6f6e 6020 6973 206e 6f74 2061 2076 616c  on` is not a val
+0003f800: 6964 2074 7970 6520 616e 6e6f 7461 7469  id type annotati
+0003f810: 6f6e 2066 6f72 2055 4441 4673 2c0a 2020  on for UDAFs,.  
+0003f820: 2020 2020 2020 2020 2020 2020 6275 7420              but 
+0003f830: 3a63 6c61 7373 3a60 7479 7069 6e67 2e4f  :class:`typing.O
+0003f840: 7074 696f 6e61 6c60 2063 616e 2062 6520  ptional` can be 
+0003f850: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+0003f860: 2074 6865 206f 7074 696f 6e61 6c20 7479   the optional ty
+0003f870: 7065 2e0a 0a20 2020 2020 2020 2020 2020  pe...           
+0003f880: 202d 2054 7970 6520 6869 6e74 7320 6172   - Type hints ar
+0003f890: 6520 6e6f 7420 7375 7070 6f72 7465 6420  e not supported 
+0003f8a0: 6f6e 2066 756e 6374 696f 6e73 2064 6563  on functions dec
+0003f8b0: 6f72 6174 6564 2077 6974 6820 6465 636f  orated with deco
+0003f8c0: 7261 746f 7273 2e0a 0a20 2020 2020 2020  rators...       
+0003f8d0: 2032 2e20 4120 7465 6d70 6f72 6172 7920   2. A temporary 
+0003f8e0: 5544 4146 2028 7768 656e 2060 6069 735f  UDAF (when ``is_
+0003f8f0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+0003f900: 6046 616c 7365 6060 2920 6973 2073 636f  `False``) is sco
+0003f910: 7065 6420 746f 2074 6869 7320 6060 7365  ped to this ``se
+0003f920: 7373 696f 6e60 600a 2020 2020 2020 2020  ssion``.        
+0003f930: 616e 6420 616c 6c20 5544 4146 2072 656c  and all UDAF rel
+0003f940: 6174 6564 2066 696c 6573 2077 696c 6c20  ated files will 
+0003f950: 6265 2075 706c 6f61 6465 6420 746f 2061  be uploaded to a
+0003f960: 2074 656d 706f 7261 7279 2073 6573 7369   temporary sessi
+0003f970: 6f6e 2073 7461 6765 0a20 2020 2020 2020  on stage.       
+0003f980: 2028 3a66 756e 633a 6073 6573 7369 6f6e   (:func:`session
+0003f990: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
+0003f9a0: 6765 2829 203c 736e 6f77 666c 616b 652e  ge() <snowflake.
+0003f9b0: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
+0003f9c0: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
+0003f9d0: 6765 3e60 292e 0a20 2020 2020 2020 2046  ge>`)..        F
+0003f9e0: 6f72 2061 2070 6572 6d61 6e65 6e74 2055  or a permanent U
+0003f9f0: 4441 462c 2074 6865 7365 2066 696c 6573  DAF, these files
+0003fa00: 2077 696c 6c20 6265 2075 706c 6f61 6465   will be uploade
+0003fa10: 6420 746f 2074 6865 2073 7461 6765 2074  d to the stage t
+0003fa20: 6861 7420 796f 7520 7072 6f76 6964 652e  hat you provide.
+0003fa30: 0a0a 2020 2020 2020 2020 332e 2042 7920  ..        3. By 
+0003fa40: 6465 6661 756c 742c 2055 4441 4620 7265  default, UDAF re
+0003fa50: 6769 7374 7261 7469 6f6e 2066 6169 6c73  gistration fails
+0003fa60: 2069 6620 6120 6675 6e63 7469 6f6e 2077   if a function w
+0003fa70: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
+0003fa80: 6520 6973 2061 6c72 6561 6479 0a20 2020  e is already.   
+0003fa90: 2020 2020 2072 6567 6973 7465 7265 642e       registered.
+0003faa0: 2049 6e76 6f6b 696e 6720 3a66 756e 633a   Invoking :func:
+0003fab0: 6075 6461 6660 2077 6974 6820 6060 7265  `udaf` with ``re
+0003fac0: 706c 6163 6560 6020 7365 7420 746f 2060  place`` set to `
+0003fad0: 6054 7275 6560 6020 7769 6c6c 206f 7665  `True`` will ove
+0003fae0: 7277 7269 7465 2074 6865 0a20 2020 2020  rwrite the.     
+0003faf0: 2020 2070 7265 7669 6f75 736c 7920 7265     previously re
+0003fb00: 6769 7374 6572 6564 2066 756e 6374 696f  gistered functio
+0003fb10: 6e2e 0a0a 2020 2020 5365 6520 416c 736f  n...    See Also
+0003fb20: 3a0a 2020 2020 2020 2020 3a63 6c61 7373  :.        :class
+0003fb30: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003fb40: 7770 6172 6b2e 7564 6166 2e55 4441 4652  wpark.udaf.UDAFR
+0003fb50: 6567 6973 7472 6174 696f 6e60 0a0a 0a20  egistration`... 
+0003fb60: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0003fb70: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0003fb80: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003fb90: 2e74 7970 6573 2069 6d70 6f72 7420 496e  .types import In
+0003fba0: 7465 6765 7254 7970 650a 2020 2020 2020  tegerType.      
+0003fbb0: 2020 3e3e 3e20 636c 6173 7320 5079 7468    >>> class Pyth
+0003fbc0: 6f6e 5375 6d55 4441 463a 0a20 2020 2020  onSumUDAF:.     
+0003fbd0: 2020 202e 2e2e 2020 2020 2064 6566 205f     ...     def _
+0003fbe0: 5f69 6e69 745f 5f28 7365 6c66 2920 2d3e  _init__(self) ->
+0003fbf0: 204e 6f6e 653a 0a20 2020 2020 2020 202e   None:.        .
+0003fc00: 2e2e 2020 2020 2020 2020 2073 656c 662e  ..         self.
+0003fc10: 5f73 756d 203d 2030 0a20 2020 2020 2020  _sum = 0.       
+0003fc20: 202e 2e2e 0a20 2020 2020 2020 202e 2e2e   ....        ...
+0003fc30: 2020 2020 2040 7072 6f70 6572 7479 0a20       @property. 
+0003fc40: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0003fc50: 6566 2061 6767 7265 6761 7465 5f73 7461  ef aggregate_sta
+0003fc60: 7465 2873 656c 6629 3a0a 2020 2020 2020  te(self):.      
+0003fc70: 2020 2e2e 2e20 2020 2020 2020 2020 7265    ...         re
+0003fc80: 7475 726e 2073 656c 662e 5f73 756d 0a20  turn self._sum. 
+0003fc90: 2020 2020 2020 202e 2e2e 0a20 2020 2020         ....     
+0003fca0: 2020 202e 2e2e 2020 2020 2064 6566 2061     ...     def a
+0003fcb0: 6363 756d 756c 6174 6528 7365 6c66 2c20  ccumulate(self, 
+0003fcc0: 696e 7075 745f 7661 6c75 6529 3a0a 2020  input_value):.  
+0003fcd0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0003fce0: 2020 7365 6c66 2e5f 7375 6d20 2b3d 2069    self._sum += i
+0003fcf0: 6e70 7574 5f76 616c 7565 0a20 2020 2020  nput_value.     
+0003fd00: 2020 202e 2e2e 0a20 2020 2020 2020 202e     ....        .
+0003fd10: 2e2e 2020 2020 2064 6566 206d 6572 6765  ..     def merge
+0003fd20: 2873 656c 662c 206f 7468 6572 5f73 756d  (self, other_sum
+0003fd30: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
+0003fd40: 2020 2020 2020 2073 656c 662e 5f73 756d         self._sum
+0003fd50: 202b 3d20 6f74 6865 725f 7375 6d0a 2020   += other_sum.  
+0003fd60: 2020 2020 2020 2e2e 2e0a 2020 2020 2020        ....      
+0003fd70: 2020 2e2e 2e20 2020 2020 6465 6620 6669    ...     def fi
+0003fd80: 6e69 7368 2873 656c 6629 3a0a 2020 2020  nish(self):.    
+0003fd90: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0003fda0: 7265 7475 726e 2073 656c 662e 5f73 756d  return self._sum
+0003fdb0: 0a20 2020 2020 2020 203e 3e3e 2073 756d  .        >>> sum
+0003fdc0: 5f75 6461 6620 3d20 7564 6166 280a 2020  _udaf = udaf(.  
+0003fdd0: 2020 2020 2020 2e2e 2e20 2020 2020 5079        ...     Py
+0003fde0: 7468 6f6e 5375 6d55 4441 462c 0a20 2020  thonSumUDAF,.   
+0003fdf0: 2020 2020 202e 2e2e 2020 2020 206e 616d       ...     nam
+0003fe00: 653d 2273 756d 5f69 6e74 222c 0a20 2020  e="sum_int",.   
+0003fe10: 2020 2020 202e 2e2e 2020 2020 2072 6570       ...     rep
+0003fe20: 6c61 6365 3d54 7275 652c 0a20 2020 2020  lace=True,.     
+0003fe30: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+0003fe40: 6e5f 7479 7065 3d49 6e74 6567 6572 5479  n_type=IntegerTy
+0003fe50: 7065 2829 2c0a 2020 2020 2020 2020 2e2e  pe(),.        ..
+0003fe60: 2e20 2020 2020 696e 7075 745f 7479 7065  .     input_type
+0003fe70: 733d 5b49 6e74 6567 6572 5479 7065 2829  s=[IntegerType()
+0003fe80: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+0003fe90: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0003fea0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0003feb0: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
+0003fec0: 335d 2c20 5b31 2c20 345d 2c20 5b32 2c20  3], [1, 4], [2, 
+0003fed0: 355d 2c20 5b32 2c20 365d 5d29 2e74 6f5f  5], [2, 6]]).to_
+0003fee0: 6466 2822 6122 2c20 2262 2229 0a20 2020  df("a", "b").   
+0003fef0: 2020 2020 203e 3e3e 2064 662e 6167 6728       >>> df.agg(
+0003ff00: 7375 6d5f 7564 6166 2822 6122 2929 2e63  sum_udaf("a")).c
+0003ff10: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0003ff20: 205b 526f 7728 5355 4d5f 494e 5428 2241   [Row(SUM_INT("A
+0003ff30: 2229 3d36 295d 0a0a 2020 2020 2020 2020  ")=6)]..        
+0003ff40: 496e 7374 6561 6420 6f66 2063 616c 6c69  Instead of calli
+0003ff50: 6e67 2060 7564 6166 6020 6974 2069 7320  ng `udaf` it is 
+0003ff60: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
+0003ff70: 2075 7365 2075 6461 6620 6173 2061 2064   use udaf as a d
+0003ff80: 6563 6f72 6174 6f72 2e0a 0a20 2020 2045  ecorator...    E
+0003ff90: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0003ffa0: 2020 3e3e 3e20 4075 6461 6628 6e61 6d65    >>> @udaf(name
+0003ffb0: 3d22 7375 6d5f 696e 7422 2c20 7265 706c  ="sum_int", repl
+0003ffc0: 6163 653d 5472 7565 2c20 7265 7475 726e  ace=True, return
+0003ffd0: 5f74 7970 653d 496e 7465 6765 7254 7970  _type=IntegerTyp
+0003ffe0: 6528 292c 2069 6e70 7574 5f74 7970 6573  e(), input_types
+0003fff0: 3d5b 496e 7465 6765 7254 7970 6528 295d  =[IntegerType()]
+00040000: 290a 2020 2020 2020 2020 2e2e 2e20 636c  ).        ... cl
+00040010: 6173 7320 5079 7468 6f6e 5375 6d55 4441  ass PythonSumUDA
+00040020: 463a 0a20 2020 2020 2020 202e 2e2e 2020  F:.        ...  
+00040030: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00040040: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00040050: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00040060: 2020 2073 656c 662e 5f73 756d 203d 2030     self._sum = 0
+00040070: 0a20 2020 2020 2020 202e 2e2e 0a20 2020  .        ....   
+00040080: 2020 2020 202e 2e2e 2020 2020 2040 7072       ...     @pr
+00040090: 6f70 6572 7479 0a20 2020 2020 2020 202e  operty.        .
+000400a0: 2e2e 2020 2020 2064 6566 2061 6767 7265  ..     def aggre
+000400b0: 6761 7465 5f73 7461 7465 2873 656c 6629  gate_state(self)
+000400c0: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
+000400d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000400e0: 662e 5f73 756d 0a20 2020 2020 2020 202e  f._sum.        .
+000400f0: 2e2e 0a20 2020 2020 2020 202e 2e2e 2020  ...        ...  
+00040100: 2020 2064 6566 2061 6363 756d 756c 6174     def accumulat
+00040110: 6528 7365 6c66 2c20 696e 7075 745f 7661  e(self, input_va
+00040120: 6c75 6529 3a0a 2020 2020 2020 2020 2e2e  lue):.        ..
+00040130: 2e20 2020 2020 2020 2020 7365 6c66 2e5f  .         self._
+00040140: 7375 6d20 2b3d 2069 6e70 7574 5f76 616c  sum += input_val
+00040150: 7565 0a20 2020 2020 2020 202e 2e2e 0a20  ue.        .... 
+00040160: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+00040170: 6566 206d 6572 6765 2873 656c 662c 206f  ef merge(self, o
+00040180: 7468 6572 5f73 756d 293a 0a20 2020 2020  ther_sum):.     
+00040190: 2020 202e 2e2e 2020 2020 2020 2020 2073     ...         s
+000401a0: 656c 662e 5f73 756d 202b 3d20 6f74 6865  elf._sum += othe
+000401b0: 725f 7375 6d0a 2020 2020 2020 2020 2e2e  r_sum.        ..
+000401c0: 2e0a 2020 2020 2020 2020 2e2e 2e20 2020  ..        ...   
+000401d0: 2020 6465 6620 6669 6e69 7368 2873 656c    def finish(sel
+000401e0: 6629 3a0a 2020 2020 2020 2020 2e2e 2e20  f):.        ... 
+000401f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00040200: 656c 662e 5f73 756d 0a0a 2020 2020 2020  elf._sum..      
+00040210: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00040220: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00040230: 616d 6528 5b5b 312c 2033 5d2c 205b 312c  ame([[1, 3], [1,
+00040240: 2034 5d2c 205b 322c 2035 5d2c 205b 322c   4], [2, 5], [2,
+00040250: 2036 5d5d 292e 746f 5f64 6628 2261 222c   6]]).to_df("a",
+00040260: 2022 6222 290a 2020 2020 2020 2020 3e3e   "b").        >>
+00040270: 3e20 6466 2e61 6767 2850 7974 686f 6e53  > df.agg(PythonS
+00040280: 756d 5544 4146 2822 6122 2929 2e63 6f6c  umUDAF("a")).col
+00040290: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000402a0: 526f 7728 5355 4d5f 494e 5428 2241 2229  Row(SUM_INT("A")
+000402b0: 3d36 295d 0a20 2020 2022 2222 0a20 2020  =6)].    """.   
+000402c0: 2073 6573 7369 6f6e 203d 2073 6573 7369   session = sessi
+000402d0: 6f6e 206f 7220 736e 6f77 666c 616b 652e  on or snowflake.
+000402e0: 736e 6f77 7061 726b 2e73 6573 7369 6f6e  snowpark.session
+000402f0: 2e5f 6765 745f 6163 7469 7665 5f73 6573  ._get_active_ses
+00040300: 7369 6f6e 2829 0a20 2020 2069 6620 6861  sion().    if ha
+00040310: 6e64 6c65 7220 6973 204e 6f6e 653a 0a20  ndler is None:. 
+00040320: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
+00040330: 6e63 746f 6f6c 732e 7061 7274 6961 6c28  nctools.partial(
+00040340: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
+00040350: 7369 6f6e 2e75 6461 662e 7265 6769 7374  sion.udaf.regist
+00040360: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00040370: 7265 7475 726e 5f74 7970 653d 7265 7475  return_type=retu
+00040380: 726e 5f74 7970 652c 0a20 2020 2020 2020  rn_type,.       
+00040390: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
+000403a0: 3d69 6e70 7574 5f74 7970 6573 2c0a 2020  =input_types,.  
+000403b0: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
+000403c0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+000403d0: 2069 735f 7065 726d 616e 656e 743d 6973   is_permanent=is
+000403e0: 5f70 6572 6d61 6e65 6e74 2c0a 2020 2020  _permanent,.    
+000403f0: 2020 2020 2020 2020 7374 6167 655f 6c6f          stage_lo
+00040400: 6361 7469 6f6e 3d73 7461 6765 5f6c 6f63  cation=stage_loc
+00040410: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+00040420: 2020 2069 6d70 6f72 7473 3d69 6d70 6f72     imports=impor
+00040430: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00040440: 7061 636b 6167 6573 3d70 6163 6b61 6765  packages=package
+00040450: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
+00040460: 6570 6c61 6365 3d72 6570 6c61 6365 2c0a  eplace=replace,.
+00040470: 2020 2020 2020 2020 2020 2020 6966 5f6e              if_n
+00040480: 6f74 5f65 7869 7374 733d 6966 5f6e 6f74  ot_exists=if_not
+00040490: 5f65 7869 7374 732c 0a20 2020 2020 2020  _exists,.       
+000404a0: 2020 2020 2070 6172 616c 6c65 6c3d 7061       parallel=pa
+000404b0: 7261 6c6c 656c 2c0a 2020 2020 2020 2020  rallel,.        
+000404c0: 2020 2020 7374 6174 656d 656e 745f 7061      statement_pa
+000404d0: 7261 6d73 3d73 7461 7465 6d65 6e74 5f70  rams=statement_p
+000404e0: 6172 616d 732c 0a20 2020 2020 2020 2029  arams,.        )
+000404f0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00040500: 2020 2072 6574 7572 6e20 7365 7373 696f     return sessio
+00040510: 6e2e 7564 6166 2e72 6567 6973 7465 7228  n.udaf.register(
+00040520: 0a20 2020 2020 2020 2020 2020 2068 616e  .            han
+00040530: 646c 6572 2c0a 2020 2020 2020 2020 2020  dler,.          
+00040540: 2020 7265 7475 726e 5f74 7970 653d 7265    return_type=re
+00040550: 7475 726e 5f74 7970 652c 0a20 2020 2020  turn_type,.     
+00040560: 2020 2020 2020 2069 6e70 7574 5f74 7970         input_typ
+00040570: 6573 3d69 6e70 7574 5f74 7970 6573 2c0a  es=input_types,.
+00040580: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00040590: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
+000405a0: 2020 2069 735f 7065 726d 616e 656e 743d     is_permanent=
+000405b0: 6973 5f70 6572 6d61 6e65 6e74 2c0a 2020  is_permanent,.  
+000405c0: 2020 2020 2020 2020 2020 7374 6167 655f            stage_
+000405d0: 6c6f 6361 7469 6f6e 3d73 7461 6765 5f6c  location=stage_l
+000405e0: 6f63 6174 696f 6e2c 0a20 2020 2020 2020  ocation,.       
+000405f0: 2020 2020 2069 6d70 6f72 7473 3d69 6d70       imports=imp
+00040600: 6f72 7473 2c0a 2020 2020 2020 2020 2020  orts,.          
+00040610: 2020 7061 636b 6167 6573 3d70 6163 6b61    packages=packa
+00040620: 6765 732c 0a20 2020 2020 2020 2020 2020  ges,.           
+00040630: 2072 6570 6c61 6365 3d72 6570 6c61 6365   replace=replace
+00040640: 2c0a 2020 2020 2020 2020 2020 2020 6966  ,.            if
+00040650: 5f6e 6f74 5f65 7869 7374 733d 6966 5f6e  _not_exists=if_n
+00040660: 6f74 5f65 7869 7374 732c 0a20 2020 2020  ot_exists,.     
+00040670: 2020 2020 2020 2070 6172 616c 6c65 6c3d         parallel=
+00040680: 7061 7261 6c6c 656c 2c0a 2020 2020 2020  parallel,.      
+00040690: 2020 2020 2020 7374 6174 656d 656e 745f        statement_
+000406a0: 7061 7261 6d73 3d73 7461 7465 6d65 6e74  params=statement
+000406b0: 5f70 6172 616d 732c 0a20 2020 2020 2020  _params,.       
+000406c0: 2029 0a0a 0a64 6566 2070 616e 6461 735f   )...def pandas_
+000406d0: 7564 6628 0a20 2020 2066 756e 633a 204f  udf(.    func: O
+000406e0: 7074 696f 6e61 6c5b 4361 6c6c 6162 6c65  ptional[Callable
+000406f0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2a2c  ] = None,.    *,
+00040700: 0a20 2020 2072 6574 7572 6e5f 7479 7065  .    return_type
+00040710: 3a20 4f70 7469 6f6e 616c 5b44 6174 6154  : Optional[DataT
+00040720: 7970 655d 203d 204e 6f6e 652c 0a20 2020  ype] = None,.   
+00040730: 2069 6e70 7574 5f74 7970 6573 3a20 4f70   input_types: Op
+00040740: 7469 6f6e 616c 5b4c 6973 745b 4461 7461  tional[List[Data
+00040750: 5479 7065 5d5d 203d 204e 6f6e 652c 0a20  Type]] = None,. 
+00040760: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
+00040770: 6c5b 556e 696f 6e5b 7374 722c 2049 7465  l[Union[str, Ite
+00040780: 7261 626c 655b 7374 725d 5d5d 203d 204e  rable[str]]] = N
+00040790: 6f6e 652c 0a20 2020 2069 735f 7065 726d  one,.    is_perm
+000407a0: 616e 656e 743a 2062 6f6f 6c20 3d20 4661  anent: bool = Fa
+000407b0: 6c73 652c 0a20 2020 2073 7461 6765 5f6c  lse,.    stage_l
+000407c0: 6f63 6174 696f 6e3a 204f 7074 696f 6e61  ocation: Optiona
+000407d0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000407e0: 2020 2069 6d70 6f72 7473 3a20 4f70 7469     imports: Opti
+000407f0: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
+00040800: 7374 722c 2054 7570 6c65 5b73 7472 2c20  str, Tuple[str, 
+00040810: 7374 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a  str]]]] = None,.
+00040820: 2020 2020 7061 636b 6167 6573 3a20 4f70      packages: Op
+00040830: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
+00040840: 6e5b 7374 722c 204d 6f64 756c 6554 7970  n[str, ModuleTyp
+00040850: 655d 5d5d 203d 204e 6f6e 652c 0a20 2020  e]]] = None,.   
+00040860: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
+00040870: 2046 616c 7365 2c0a 2020 2020 6966 5f6e   False,.    if_n
+00040880: 6f74 5f65 7869 7374 733a 2062 6f6f 6c20  ot_exists: bool 
+00040890: 3d20 4661 6c73 652c 0a20 2020 2073 6573  = False,.    ses
+000408a0: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b22  sion: Optional["
+000408b0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000408c0: 726b 2e73 6573 7369 6f6e 2e53 6573 7369  rk.session.Sessi
+000408d0: 6f6e 225d 203d 204e 6f6e 652c 0a20 2020  on"] = None,.   
+000408e0: 2070 6172 616c 6c65 6c3a 2069 6e74 203d   parallel: int =
+000408f0: 2034 2c0a 2020 2020 6d61 785f 6261 7463   4,.    max_batc
+00040900: 685f 7369 7a65 3a20 4f70 7469 6f6e 616c  h_size: Optional
+00040910: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+00040920: 2020 7374 6174 656d 656e 745f 7061 7261    statement_para
+00040930: 6d73 3a20 4f70 7469 6f6e 616c 5b44 6963  ms: Optional[Dic
+00040940: 745b 7374 722c 2073 7472 5d5d 203d 204e  t[str, str]] = N
+00040950: 6f6e 652c 0a20 2020 2073 6f75 7263 655f  one,.    source_
+00040960: 636f 6465 5f64 6973 706c 6179 3a20 626f  code_display: bo
+00040970: 6f6c 203d 2054 7275 652c 0a29 202d 3e20  ol = True,.) -> 
+00040980: 556e 696f 6e5b 5573 6572 4465 6669 6e65  Union[UserDefine
+00040990: 6446 756e 6374 696f 6e2c 2066 756e 6374  dFunction, funct
+000409a0: 6f6f 6c73 2e70 6172 7469 616c 5d3a 0a20  ools.partial]:. 
+000409b0: 2020 2022 2222 0a20 2020 2052 6567 6973     """.    Regis
+000409c0: 7465 7273 2061 2050 7974 686f 6e20 6675  ters a Python fu
+000409d0: 6e63 7469 6f6e 2061 7320 6120 7665 6374  nction as a vect
+000409e0: 6f72 697a 6564 2055 4446 2061 6e64 2072  orized UDF and r
+000409f0: 6574 7572 6e73 2074 6865 2055 4446 2e0a  eturns the UDF..
+00040a00: 2020 2020 5468 6520 6172 6775 6d65 6e74      The argument
+00040a10: 732c 2072 6574 7572 6e20 7661 6c75 6520  s, return value 
+00040a20: 616e 6420 7573 6167 6520 6f66 2074 6869  and usage of thi
+00040a30: 7320 6675 6e63 7469 6f6e 2061 7265 2065  s function are e
+00040a40: 7861 6374 6c79 2074 6865 2073 616d 6520  xactly the same 
+00040a50: 6173 0a20 2020 203a 6675 6e63 3a60 7564  as.    :func:`ud
+00040a60: 6660 2c20 6275 7420 7468 6973 2066 756e  f`, but this fun
+00040a70: 6374 696f 6e20 6361 6e20 6f6e 6c79 2062  ction can only b
+00040a80: 6520 7573 6564 2066 6f72 2072 6567 6973  e used for regis
+00040a90: 7465 7269 6e67 2076 6563 746f 7269 7a65  tering vectorize
+00040aa0: 6420 5544 4673 2e0a 2020 2020 5365 6520  d UDFs..    See 
+00040ab0: 6578 616d 706c 6573 2069 6e20 3a63 6c61  examples in :cla
+00040ac0: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
+00040ad0: 6e6f 7770 6172 6b2e 7564 662e 5544 4652  nowpark.udf.UDFR
+00040ae0: 6567 6973 7472 6174 696f 6e60 2e0a 0a20  egistration`... 
+00040af0: 2020 2053 6565 2041 6c73 6f3a 0a20 2020     See Also:.   
+00040b00: 2020 2020 202d 203a 6675 6e63 3a60 7564       - :func:`ud
+00040b10: 6660 0a20 2020 2020 2020 202d 203a 6d65  f`.        - :me
+00040b20: 7468 3a60 5544 4652 6567 6973 7472 6174  th:`UDFRegistrat
+00040b30: 696f 6e2e 7265 6769 7374 6572 2829 203c  ion.register() <
+00040b40: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00040b50: 726b 2e75 6466 2e55 4446 5265 6769 7374  rk.udf.UDFRegist
+00040b60: 7261 7469 6f6e 2e72 6567 6973 7465 723e  ration.register>
+00040b70: 600a 0a20 2020 2045 7861 6d70 6c65 3a3a  `..    Example::
+00040b80: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00040b90: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00040ba0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00040bb0: 7274 2050 616e 6461 7353 6572 6965 7354  rt PandasSeriesT
+00040bc0: 7970 652c 2050 616e 6461 7344 6174 6146  ype, PandasDataF
+00040bd0: 7261 6d65 5479 7065 2c20 496e 7465 6765  rameType, Intege
+00040be0: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
+00040bf0: 3e20 6164 645f 6f6e 655f 6466 5f70 616e  > add_one_df_pan
+00040c00: 6461 735f 7564 6620 3d20 7061 6e64 6173  das_udf = pandas
+00040c10: 5f75 6466 280a 2020 2020 2020 2020 2e2e  _udf(.        ..
+00040c20: 2e20 2020 2020 6c61 6d62 6461 2064 663a  .     lambda df:
+00040c30: 2064 665b 305d 202b 2064 665b 315d 202b   df[0] + df[1] +
+00040c40: 2031 2c0a 2020 2020 2020 2020 2e2e 2e20   1,.        ... 
+00040c50: 2020 2020 7265 7475 726e 5f74 7970 653d      return_type=
+00040c60: 5061 6e64 6173 5365 7269 6573 5479 7065  PandasSeriesType
+00040c70: 2849 6e74 6567 6572 5479 7065 2829 292c  (IntegerType()),
+00040c80: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00040c90: 2069 6e70 7574 5f74 7970 6573 3d5b 5061   input_types=[Pa
+00040ca0: 6e64 6173 4461 7461 4672 616d 6554 7970  ndasDataFrameTyp
+00040cb0: 6528 5b49 6e74 6567 6572 5479 7065 2829  e([IntegerType()
+00040cc0: 2c20 496e 7465 6765 7254 7970 6528 295d  , IntegerType()]
+00040cd0: 295d 0a20 2020 2020 2020 202e 2e2e 2029  )].        ... )
+00040ce0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00040cf0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00040d00: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
+00040d10: 325d 2c20 5b33 2c20 345d 5d2c 2073 6368  2], [3, 4]], sch
+00040d20: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+00040d30: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00040d40: 656c 6563 7428 6164 645f 6f6e 655f 6466  elect(add_one_df
+00040d50: 5f70 616e 6461 735f 7564 6628 2261 222c  _pandas_udf("a",
+00040d60: 2022 6222 292e 616c 6961 7328 2272 6573   "b").alias("res
+00040d70: 756c 7422 2929 2e6f 7264 6572 5f62 7928  ult")).order_by(
+00040d80: 2272 6573 756c 7422 292e 7368 6f77 2829  "result").show()
+00040d90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00040da0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00040db0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+00040dc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00040dd0: 2020 2020 2020 2020 7c34 2020 2020 2020          |4      
+00040de0: 2020 207c 0a20 2020 2020 2020 207c 3820     |.        |8 
+00040df0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00040e00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00040e10: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00040e20: 453e 0a0a 2020 2020 6f72 2061 7320 6e61  E>..    or as na
+00040e30: 6d65 6420 5061 6e64 6173 2055 4446 7320  med Pandas UDFs 
+00040e40: 7468 6174 2061 7265 2061 6363 6573 6962  that are accesib
+00040e50: 6c65 2069 6e20 7468 6520 7361 6d65 2073  le in the same s
+00040e60: 6573 7369 6f6e 2e20 496e 7374 6561 6420  ession. Instead 
+00040e70: 6f66 2063 616c 6c69 6e67 2060 7061 6e64  of calling `pand
+00040e80: 6173 5f75 6466 6020 6173 2066 756e 6374  as_udf` as funct
+00040e90: 696f 6e2c 0a20 2020 2069 7420 6361 6e20  ion,.    it can 
+00040ea0: 6265 2061 6c73 6f20 7573 6564 2061 7320  be also used as 
+00040eb0: 6120 6465 636f 7261 746f 723a 0a0a 2020  a decorator:..  
+00040ec0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00040ed0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00040ee0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00040ef0: 2e74 7970 6573 2069 6d70 6f72 7420 5061  .types import Pa
+00040f00: 6e64 6173 5365 7269 6573 5479 7065 2c20  ndasSeriesType, 
+00040f10: 5061 6e64 6173 4461 7461 4672 616d 6554  PandasDataFrameT
+00040f20: 7970 652c 2049 6e74 6567 6572 5479 7065  ype, IntegerType
+00040f30: 0a20 2020 2020 2020 203e 3e3e 2040 7061  .        >>> @pa
+00040f40: 6e64 6173 5f75 6466 280a 2020 2020 2020  ndas_udf(.      
+00040f50: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+00040f60: 5f74 7970 653d 5061 6e64 6173 5365 7269  _type=PandasSeri
+00040f70: 6573 5479 7065 2849 6e74 6567 6572 5479  esType(IntegerTy
+00040f80: 7065 2829 292c 0a20 2020 2020 2020 202e  pe()),.        .
+00040f90: 2e2e 2020 2020 2069 6e70 7574 5f74 7970  ..     input_typ
+00040fa0: 6573 3d5b 5061 6e64 6173 4461 7461 4672  es=[PandasDataFr
+00040fb0: 616d 6554 7970 6528 5b49 6e74 6567 6572  ameType([Integer
+00040fc0: 5479 7065 2829 2c20 496e 7465 6765 7254  Type(), IntegerT
+00040fd0: 7970 6528 295d 295d 2c0a 2020 2020 2020  ype()])],.      
+00040fe0: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+00040ff0: 2e2e 2e20 6465 6620 6164 645f 6f6e 655f  ... def add_one_
+00041000: 6466 5f70 616e 6461 735f 7564 6628 6466  df_pandas_udf(df
+00041010: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
+00041020: 2020 2072 6574 7572 6e20 6466 5b30 5d20     return df[0] 
+00041030: 2b20 6466 5b31 5d20 2b20 310a 2020 2020  + df[1] + 1.    
+00041040: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00041050: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00041060: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
+00041070: 332c 2034 5d5d 2c20 7363 6865 6d61 3d5b  3, 4]], schema=[
+00041080: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00041090: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000410a0: 2861 6464 5f6f 6e65 5f64 665f 7061 6e64  (add_one_df_pand
+000410b0: 6173 5f75 6466 2822 6122 2c20 2262 2229  as_udf("a", "b")
+000410c0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+000410d0: 292e 6f72 6465 725f 6279 2822 7265 7375  ).order_by("resu
+000410e0: 6c74 2229 2e73 686f 7728 290a 2020 2020  lt").show().    
+000410f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00041100: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+00041110: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+00041120: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00041130: 2020 207c 3420 2020 2020 2020 2020 7c0a     |4         |.
+00041140: 2020 2020 2020 2020 7c38 2020 2020 2020          |8      
+00041150: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00041160: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00041170: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00041180: 2020 2222 220a 2020 2020 7365 7373 696f    """.    sessio
+00041190: 6e20 3d20 7365 7373 696f 6e20 6f72 2073  n = session or s
+000411a0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+000411b0: 6b2e 7365 7373 696f 6e2e 5f67 6574 5f61  k.session._get_a
+000411c0: 6374 6976 655f 7365 7373 696f 6e28 290a  ctive_session().
+000411d0: 2020 2020 6966 2066 756e 6320 6973 204e      if func is N
+000411e0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
+000411f0: 7572 6e20 6675 6e63 746f 6f6c 732e 7061  urn functools.pa
+00041200: 7274 6961 6c28 0a20 2020 2020 2020 2020  rtial(.         
+00041210: 2020 2073 6573 7369 6f6e 2e75 6466 2e72     session.udf.r
+00041220: 6567 6973 7465 722c 0a20 2020 2020 2020  egister,.       
+00041230: 2020 2020 2072 6574 7572 6e5f 7479 7065       return_type
+00041240: 3d72 6574 7572 6e5f 7479 7065 2c0a 2020  =return_type,.  
+00041250: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00041260: 7479 7065 733d 696e 7075 745f 7479 7065  types=input_type
+00041270: 732c 0a20 2020 2020 2020 2020 2020 206e  s,.            n
+00041280: 616d 653d 6e61 6d65 2c0a 2020 2020 2020  ame=name,.      
+00041290: 2020 2020 2020 6973 5f70 6572 6d61 6e65        is_permane
+000412a0: 6e74 3d69 735f 7065 726d 616e 656e 742c  nt=is_permanent,
+000412b0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+000412c0: 6765 5f6c 6f63 6174 696f 6e3d 7374 6167  ge_location=stag
+000412d0: 655f 6c6f 6361 7469 6f6e 2c0a 2020 2020  e_location,.    
+000412e0: 2020 2020 2020 2020 696d 706f 7274 733d          imports=
+000412f0: 696d 706f 7274 732c 0a20 2020 2020 2020  imports,.       
+00041300: 2020 2020 2070 6163 6b61 6765 733d 7061       packages=pa
+00041310: 636b 6167 6573 2c0a 2020 2020 2020 2020  ckages,.        
+00041320: 2020 2020 7265 706c 6163 653d 7265 706c      replace=repl
+00041330: 6163 652c 0a20 2020 2020 2020 2020 2020  ace,.           
+00041340: 2069 665f 6e6f 745f 6578 6973 7473 3d69   if_not_exists=i
+00041350: 665f 6e6f 745f 6578 6973 7473 2c0a 2020  f_not_exists,.  
+00041360: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
+00041370: 656c 3d70 6172 616c 6c65 6c2c 0a20 2020  el=parallel,.   
+00041380: 2020 2020 2020 2020 206d 6178 5f62 6174           max_bat
+00041390: 6368 5f73 697a 653d 6d61 785f 6261 7463  ch_size=max_batc
+000413a0: 685f 7369 7a65 2c0a 2020 2020 2020 2020  h_size,.        
+000413b0: 2020 2020 5f66 726f 6d5f 7061 6e64 6173      _from_pandas
+000413c0: 5f75 6466 5f66 756e 6374 696f 6e3d 5472  _udf_function=Tr
+000413d0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+000413e0: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
+000413f0: 3d73 7461 7465 6d65 6e74 5f70 6172 616d  =statement_param
+00041400: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+00041410: 6f75 7263 655f 636f 6465 5f64 6973 706c  ource_code_displ
+00041420: 6179 3d73 6f75 7263 655f 636f 6465 5f64  ay=source_code_d
+00041430: 6973 706c 6179 2c0a 2020 2020 2020 2020  isplay,.        
+00041440: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00041450: 2020 2020 7265 7475 726e 2073 6573 7369      return sessi
+00041460: 6f6e 2e75 6466 2e72 6567 6973 7465 7228  on.udf.register(
+00041470: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
+00041480: 632c 0a20 2020 2020 2020 2020 2020 2072  c,.            r
+00041490: 6574 7572 6e5f 7479 7065 3d72 6574 7572  eturn_type=retur
+000414a0: 6e5f 7479 7065 2c0a 2020 2020 2020 2020  n_type,.        
+000414b0: 2020 2020 696e 7075 745f 7479 7065 733d      input_types=
+000414c0: 696e 7075 745f 7479 7065 732c 0a20 2020  input_types,.   
+000414d0: 2020 2020 2020 2020 206e 616d 653d 6e61           name=na
+000414e0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+000414f0: 6973 5f70 6572 6d61 6e65 6e74 3d69 735f  is_permanent=is_
+00041500: 7065 726d 616e 656e 742c 0a20 2020 2020  permanent,.     
+00041510: 2020 2020 2020 2073 7461 6765 5f6c 6f63         stage_loc
+00041520: 6174 696f 6e3d 7374 6167 655f 6c6f 6361  ation=stage_loca
+00041530: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00041540: 2020 696d 706f 7274 733d 696d 706f 7274    imports=import
+00041550: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
+00041560: 6163 6b61 6765 733d 7061 636b 6167 6573  ackages=packages
+00041570: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00041580: 706c 6163 653d 7265 706c 6163 652c 0a20  place=replace,. 
+00041590: 2020 2020 2020 2020 2020 2069 665f 6e6f             if_no
+000415a0: 745f 6578 6973 7473 3d69 665f 6e6f 745f  t_exists=if_not_
+000415b0: 6578 6973 7473 2c0a 2020 2020 2020 2020  exists,.        
+000415c0: 2020 2020 7061 7261 6c6c 656c 3d70 6172      parallel=par
+000415d0: 616c 6c65 6c2c 0a20 2020 2020 2020 2020  allel,.         
+000415e0: 2020 206d 6178 5f62 6174 6368 5f73 697a     max_batch_siz
+000415f0: 653d 6d61 785f 6261 7463 685f 7369 7a65  e=max_batch_size
+00041600: 2c0a 2020 2020 2020 2020 2020 2020 5f66  ,.            _f
+00041610: 726f 6d5f 7061 6e64 6173 5f75 6466 5f66  rom_pandas_udf_f
+00041620: 756e 6374 696f 6e3d 5472 7565 2c0a 2020  unction=True,.  
+00041630: 2020 2020 2020 2020 2020 7374 6174 656d            statem
+00041640: 656e 745f 7061 7261 6d73 3d73 7461 7465  ent_params=state
+00041650: 6d65 6e74 5f70 6172 616d 732c 0a20 2020  ment_params,.   
+00041660: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
+00041670: 636f 6465 5f64 6973 706c 6179 3d73 6f75  code_display=sou
+00041680: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
+00041690: 2c0a 2020 2020 2020 2020 290a 0a0a 6465  ,.        )...de
+000416a0: 6620 7061 6e64 6173 5f75 6474 6628 0a20  f pandas_udtf(. 
+000416b0: 2020 2068 616e 646c 6572 3a20 4f70 7469     handler: Opti
+000416c0: 6f6e 616c 5b43 616c 6c61 626c 655d 203d  onal[Callable] =
+000416d0: 204e 6f6e 652c 0a20 2020 202a 2c0a 2020   None,.    *,.  
+000416e0: 2020 6f75 7470 7574 5f73 6368 656d 613a    output_schema:
+000416f0: 2055 6e69 6f6e 5b53 7472 7563 7454 7970   Union[StructTyp
+00041700: 652c 204c 6973 745b 7374 725d 5d2c 0a20  e, List[str]],. 
+00041710: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
+00041720: 4f70 7469 6f6e 616c 5b4c 6973 745b 4461  Optional[List[Da
+00041730: 7461 5479 7065 5d5d 203d 204e 6f6e 652c  taType]] = None,
+00041740: 0a20 2020 206e 616d 653a 204f 7074 696f  .    name: Optio
+00041750: 6e61 6c5b 556e 696f 6e5b 7374 722c 2049  nal[Union[str, I
+00041760: 7465 7261 626c 655b 7374 725d 5d5d 203d  terable[str]]] =
+00041770: 204e 6f6e 652c 0a20 2020 2069 735f 7065   None,.    is_pe
+00041780: 726d 616e 656e 743a 2062 6f6f 6c20 3d20  rmanent: bool = 
+00041790: 4661 6c73 652c 0a20 2020 2073 7461 6765  False,.    stage
+000417a0: 5f6c 6f63 6174 696f 6e3a 204f 7074 696f  _location: Optio
+000417b0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+000417c0: 0a20 2020 2069 6d70 6f72 7473 3a20 4f70  .    imports: Op
+000417d0: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
+000417e0: 6e5b 7374 722c 2054 7570 6c65 5b73 7472  n[str, Tuple[str
+000417f0: 2c20 7374 725d 5d5d 5d20 3d20 4e6f 6e65  , str]]]] = None
+00041800: 2c0a 2020 2020 7061 636b 6167 6573 3a20  ,.    packages: 
+00041810: 4f70 7469 6f6e 616c 5b4c 6973 745b 556e  Optional[List[Un
+00041820: 696f 6e5b 7374 722c 204d 6f64 756c 6554  ion[str, ModuleT
+00041830: 7970 655d 5d5d 203d 204e 6f6e 652c 0a20  ype]]] = None,. 
+00041840: 2020 2072 6570 6c61 6365 3a20 626f 6f6c     replace: bool
+00041850: 203d 2046 616c 7365 2c0a 2020 2020 6966   = False,.    if
+00041860: 5f6e 6f74 5f65 7869 7374 733a 2062 6f6f  _not_exists: boo
+00041870: 6c20 3d20 4661 6c73 652c 0a20 2020 2073  l = False,.    s
+00041880: 6573 7369 6f6e 3a20 4f70 7469 6f6e 616c  ession: Optional
+00041890: 5b22 736e 6f77 666c 616b 652e 736e 6f77  ["snowflake.snow
+000418a0: 7061 726b 2e73 6573 7369 6f6e 2e53 6573  park.session.Ses
+000418b0: 7369 6f6e 225d 203d 204e 6f6e 652c 0a20  sion"] = None,. 
+000418c0: 2020 2070 6172 616c 6c65 6c3a 2069 6e74     parallel: int
+000418d0: 203d 2034 2c0a 2020 2020 7374 6174 656d   = 4,.    statem
+000418e0: 656e 745f 7061 7261 6d73 3a20 4f70 7469  ent_params: Opti
+000418f0: 6f6e 616c 5b44 6963 745b 7374 722c 2073  onal[Dict[str, s
+00041900: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+00041910: 2073 7472 6963 743a 2062 6f6f 6c20 3d20   strict: bool = 
+00041920: 4661 6c73 652c 0a20 2020 2073 6563 7572  False,.    secur
+00041930: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00041940: 0a29 202d 3e20 556e 696f 6e5b 5573 6572  .) -> Union[User
+00041950: 4465 6669 6e65 6454 6162 6c65 4675 6e63  DefinedTableFunc
+00041960: 7469 6f6e 2c20 6675 6e63 746f 6f6c 732e  tion, functools.
+00041970: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
+00041980: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
+00041990: 686f 6e20 636c 6173 7320 6173 2061 2076  hon class as a v
+000419a0: 6563 746f 7269 7a65 6420 5079 7468 6f6e  ectorized Python
+000419b0: 2055 4454 4620 616e 6420 7265 7475 726e   UDTF and return
+000419c0: 7320 7468 6520 5544 5446 2e0a 0a20 2020  s the UDTF...   
+000419d0: 2054 6865 2061 7267 756d 656e 7473 2c20   The arguments, 
+000419e0: 7265 7475 726e 2076 616c 7565 2061 6e64  return value and
+000419f0: 2075 7361 6765 206f 6620 7468 6973 2066   usage of this f
+00041a00: 756e 6374 696f 6e20 6172 6520 6578 6163  unction are exac
+00041a10: 746c 7920 7468 6520 7361 6d65 2061 730a  tly the same as.
+00041a20: 2020 2020 3a66 756e 633a 6075 6474 6660      :func:`udtf`
+00041a30: 2c20 6275 7420 7468 6973 2066 756e 6374  , but this funct
+00041a40: 696f 6e20 6361 6e20 6f6e 6c79 2062 6520  ion can only be 
+00041a50: 7573 6564 2066 6f72 2072 6567 6973 7465  used for registe
+00041a60: 7269 6e67 2076 6563 746f 7269 7a65 6420  ring vectorized 
+00041a70: 5544 5446 732e 0a20 2020 2053 6565 2065  UDTFs..    See e
+00041a80: 7861 6d70 6c65 7320 696e 203a 636c 6173  xamples in :clas
+00041a90: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+00041aa0: 6f77 7061 726b 2e75 6474 662e 5544 5446  owpark.udtf.UDTF
+00041ab0: 5265 6769 7374 7261 7469 6f6e 602e 0a0a  Registration`...
+00041ac0: 2020 2020 5365 6520 416c 736f 3a0a 2020      See Also:.  
+00041ad0: 2020 2020 2020 2d20 3a66 756e 633a 6075        - :func:`u
+00041ae0: 6474 6660 0a20 2020 2020 2020 202d 203a  dtf`.        - :
+00041af0: 6d65 7468 3a60 5544 5446 5265 6769 7374  meth:`UDTFRegist
+00041b00: 7261 7469 6f6e 2e72 6567 6973 7465 7228  ration.register(
+00041b10: 2920 3c73 6e6f 7766 6c61 6b65 2e73 6e6f  ) <snowflake.sno
+00041b20: 7770 6172 6b2e 7564 662e 5544 5446 5265  wpark.udf.UDTFRe
+00041b30: 6769 7374 7261 7469 6f6e 2e72 6567 6973  gistration.regis
+00041b40: 7465 723e 600a 0a20 2020 2043 6f6d 7061  ter>`..    Compa
+00041b50: 7265 6420 746f 2074 6865 2064 6566 6175  red to the defau
+00041b60: 6c74 2072 6f77 2d62 792d 726f 7720 7072  lt row-by-row pr
+00041b70: 6f63 6573 7369 6e67 2070 6174 7465 726e  ocessing pattern
+00041b80: 206f 6620 6120 6e6f 726d 616c 2055 4454   of a normal UDT
+00041b90: 462c 2077 6869 6368 2073 6f6d 6574 696d  F, which sometim
+00041ba0: 6573 2069 730a 2020 2020 696e 6566 6669  es is.    ineffi
+00041bb0: 6369 656e 742c 2076 6563 746f 7269 7a65  cient, vectorize
+00041bc0: 6420 5079 7468 6f6e 2055 4454 4673 2028  d Python UDTFs (
+00041bd0: 7573 6572 2d64 6566 696e 6564 2074 6162  user-defined tab
+00041be0: 6c65 2066 756e 6374 696f 6e73 2920 656e  le functions) en
+00041bf0: 6162 6c65 2073 6561 6d6c 6573 7320 7061  able seamless pa
+00041c00: 7274 6974 696f 6e2d 6279 2d70 6172 7469  rtition-by-parti
+00041c10: 7469 6f6e 2070 726f 6365 7373 696e 670a  tion processing.
+00041c20: 2020 2020 6279 206f 7065 7261 7469 6e67      by operating
+00041c30: 206f 6e20 7061 7274 6974 696f 6e73 2061   on partitions a
+00041c40: 730a 2020 2020 6050 616e 6461 7320 4461  s.    `Pandas Da
+00041c50: 7461 4672 616d 6573 203c 6874 7470 733a  taFrames <https:
+00041c60: 2f2f 7061 6e64 6173 2e70 7964 6174 612e  //pandas.pydata.
+00041c70: 6f72 672f 646f 6373 2f72 6566 6572 656e  org/docs/referen
+00041c80: 6365 2f61 7069 2f70 616e 6461 732e 4461  ce/api/pandas.Da
+00041c90: 7461 4672 616d 652e 6874 6d6c 3e60 5f0a  taFrame.html>`_.
+00041ca0: 2020 2020 616e 6420 7265 7475 726e 696e      and returnin
+00041cb0: 6720 7265 7375 6c74 7320 6173 0a20 2020  g results as.   
+00041cc0: 2060 5061 6e64 6173 2044 6174 6146 7261   `Pandas DataFra
+00041cd0: 6d65 7320 3c68 7474 7073 3a2f 2f70 616e  mes <https://pan
+00041ce0: 6461 732e 7079 6461 7461 2e6f 7267 2f64  das.pydata.org/d
+00041cf0: 6f63 732f 7265 6665 7265 6e63 652f 6170  ocs/reference/ap
+00041d00: 692f 7061 6e64 6173 2e44 6174 6146 7261  i/pandas.DataFra
+00041d10: 6d65 2e68 746d 6c3e 605f 0a20 2020 206f  me.html>`_.    o
+00041d20: 7220 6c69 7374 7320 6f66 2060 5061 6e64  r lists of `Pand
+00041d30: 6173 2061 7272 6179 7320 3c68 7474 7073  as arrays <https
+00041d40: 3a2f 2f70 616e 6461 732e 7079 6461 7461  ://pandas.pydata
+00041d50: 2e6f 7267 2f64 6f63 732f 7265 6665 7265  .org/docs/refere
+00041d60: 6e63 652f 6170 692f 7061 6e64 6173 2e61  nce/api/pandas.a
+00041d70: 7272 6179 2e68 746d 6c3e 605f 0a20 2020  rray.html>`_.   
+00041d80: 206f 7220 6050 616e 6461 7320 5365 7269   or `Pandas Seri
+00041d90: 6573 203c 6874 7470 733a 2f2f 7061 6e64  es <https://pand
+00041da0: 6173 2e70 7964 6174 612e 6f72 672f 646f  as.pydata.org/do
+00041db0: 6373 2f72 6566 6572 656e 6365 2f73 6572  cs/reference/ser
+00041dc0: 6965 732e 6874 6d6c 3e60 5f2e 0a0a 2020  ies.html>`_...  
+00041dd0: 2020 496e 2061 6464 6974 696f 6e2c 2076    In addition, v
+00041de0: 6563 746f 7269 7a65 6420 5079 7468 6f6e  ectorized Python
+00041df0: 2055 4454 4673 2061 6c6c 6f77 2066 6f72   UDTFs allow for
+00041e00: 2065 6173 7920 696e 7465 6772 6174 696f   easy integratio
+00041e10: 6e20 7769 7468 206c 6962 7261 7269 6573  n with libraries
+00041e20: 2074 6861 7420 6f70 6572 6174 6520 6f6e   that operate on
+00041e30: 2070 616e 6461 7320 4461 7461 4672 616d   pandas DataFram
+00041e40: 6573 206f 7220 7061 6e64 6173 2061 7272  es or pandas arr
+00041e50: 6179 732e 0a0a 2020 2020 4120 7665 6374  ays...    A vect
+00041e60: 6f72 697a 6564 2055 4454 4620 6861 6e64  orized UDTF hand
+00041e70: 6c65 7220 636c 6173 733a 0a20 2020 202d  ler class:.    -
+00041e80: 2064 6566 696e 6573 2061 6e20 3a63 6f64   defines an :cod
+00041e90: 653a 6065 6e64 5f70 6172 7469 7469 6f6e  e:`end_partition
+00041ea0: 6020 6d65 7468 6f64 2074 6861 7420 7461  ` method that ta
+00041eb0: 6b65 7320 696e 2061 2044 6174 6146 7261  kes in a DataFra
+00041ec0: 6d65 2061 7267 756d 656e 7420 616e 6420  me argument and 
+00041ed0: 7265 7475 726e 7320 6120 3a63 6f64 653a  returns a :code:
+00041ee0: 6070 616e 6461 732e 4461 7461 4672 616d  `pandas.DataFram
+00041ef0: 6560 206f 7220 6120 7475 706c 6520 6f66  e` or a tuple of
+00041f00: 203a 636f 6465 3a60 7061 6e64 6173 2e53   :code:`pandas.S
+00041f10: 6572 6965 7360 206f 7220 3a63 6f64 653a  eries` or :code:
+00041f20: 6070 616e 6461 732e 6172 7261 7973 6020  `pandas.arrays` 
+00041f30: 7768 6572 6520 6561 6368 2061 7272 6179  where each array
+00041f40: 2069 7320 6120 636f 6c75 6d6e 2e0a 2020   is a column..  
+00041f50: 2020 2d20 646f 6573 204e 4f54 2064 6566    - does NOT def
+00041f60: 696e 6520 6120 3a63 6f64 653a 6070 726f  ine a :code:`pro
+00041f70: 6365 7373 6020 6d65 7468 6f64 2e0a 2020  cess` method..  
+00041f80: 2020 2d20 6f70 7469 6f6e 616c 6c79 2064    - optionally d
+00041f90: 6566 696e 6573 2061 2068 616e 646c 6572  efines a handler
+00041fa0: 2063 6c61 7373 2077 6974 6820 616e 203a   class with an :
+00041fb0: 636f 6465 3a60 5f5f 696e 6974 5f5f 6020  code:`__init__` 
+00041fc0: 6d65 7468 6f64 2077 6869 6368 2077 696c  method which wil
+00041fd0: 6c20 6265 2069 6e76 6f6b 6564 2062 6566  l be invoked bef
+00041fe0: 6f72 6520 7072 6f63 6573 7369 6e67 2065  ore processing e
+00041ff0: 6163 6820 7061 7274 6974 696f 6e2e 0a0a  ach partition...
+00042000: 2020 2020 596f 7520 6361 6e20 7573 6520      You can use 
+00042010: 3a66 756e 633a 607e 736e 6f77 666c 616b  :func:`~snowflak
+00042020: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+00042030: 696f 6e73 2e75 6474 6660 2c20 3a6d 6574  ions.udtf`, :met
+00042040: 683a 6072 6567 6973 7465 7260 206f 720a  h:`register` or.
+00042050: 2020 2020 3a66 756e 633a 607e 736e 6f77      :func:`~snow
+00042060: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+00042070: 756e 6374 696f 6e73 2e70 616e 6461 735f  unctions.pandas_
+00042080: 7564 7466 6020 746f 2063 7265 6174 6520  udtf` to create 
+00042090: 6120 7665 6374 6f72 697a 6564 2055 4454  a vectorized UDT
+000420a0: 4620 6279 2070 726f 7669 6469 6e67 0a20  F by providing. 
+000420b0: 2020 2061 7070 726f 7072 6961 7465 2072     appropriate r
+000420c0: 6574 7572 6e20 616e 6420 696e 7075 7420  eturn and input 
+000420d0: 7479 7065 732e 2049 6620 796f 7520 776f  types. If you wo
+000420e0: 756c 6420 6c69 6b65 2074 6f20 7573 6520  uld like to use 
+000420f0: 3a6d 6574 683a 6072 6567 6973 7465 725f  :meth:`register_
+00042100: 6672 6f6d 5f66 696c 6560 2074 6f0a 2020  from_file` to.  
+00042110: 2020 6372 6561 7465 2061 2076 6563 746f    create a vecto
+00042120: 7269 7a65 6420 5544 5446 2c20 796f 7520  rized UDTF, you 
+00042130: 6e65 6564 2074 6f20 6578 706c 6963 6974  need to explicit
+00042140: 6c79 206d 6172 6b20 7468 6520 6861 6e64  ly mark the hand
+00042150: 6c65 7220 6d65 7468 6f64 2061 7320 7665  ler method as ve
+00042160: 6374 6f72 697a 6564 2075 7369 6e67 0a20  ctorized using. 
+00042170: 2020 2065 6974 6865 7220 7468 6520 6465     either the de
+00042180: 636f 7261 746f 7220 6040 7665 6374 6f72  corator `@vector
+00042190: 697a 6564 2869 6e70 7574 3d70 616e 6461  ized(input=panda
+000421a0: 732e 4461 7461 4672 616d 6529 6020 6f72  s.DataFrame)` or
+000421b0: 2073 6574 7469 6e67 2060 3c63 6c61 7373   setting `<class
+000421c0: 3e2e 656e 645f 7061 7274 6974 696f 6e2e  >.end_partition.
+000421d0: 5f73 665f 7665 6374 6f72 697a 6564 5f69  _sf_vectorized_i
+000421e0: 6e70 7574 203d 2070 616e 6461 732e 4461  nput = pandas.Da
+000421f0: 7461 4672 616d 6560 0a0a 2020 2020 4e6f  taFrame`..    No
+00042200: 7465 3a20 4120 7665 6374 6f72 697a 6564  te: A vectorized
+00042210: 2055 4454 4620 6d75 7374 2062 6520 6361   UDTF must be ca
+00042220: 6c6c 6564 2077 6974 6820 607e 736e 6f77  lled with `~snow
+00042230: 666c 616b 652e 736e 6f77 7061 726b 2e57  flake.snowpark.W
+00042240: 696e 646f 772e 7061 7274 6974 696f 6e5f  indow.partition_
+00042250: 6279 6020 746f 2062 7569 6c64 2074 6865  by` to build the
+00042260: 2070 6172 7469 7469 6f6e 732e 0a0a 2020   partitions...  
+00042270: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00042280: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00042290: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000422a0: 7479 7065 7320 696d 706f 7274 2050 616e  types import Pan
+000422b0: 6461 7353 6572 6965 7354 7970 652c 2050  dasSeriesType, P
+000422c0: 616e 6461 7344 6174 6146 7261 6d65 5479  andasDataFrameTy
+000422d0: 7065 2c20 496e 7465 6765 7254 7970 650a  pe, IntegerType.
+000422e0: 2020 2020 2020 2020 3e3e 3e20 636c 6173          >>> clas
+000422f0: 7320 6d75 6c74 6970 6c79 3a0a 2020 2020  s multiply:.    
+00042300: 2020 2020 2e2e 2e20 2020 2020 6465 6620      ...     def 
+00042310: 5f5f 696e 6974 5f5f 2873 656c 6629 3a0a  __init__(self):.
+00042320: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00042330: 2020 2020 7365 6c66 2e6d 756c 7469 706c      self.multipl
+00042340: 6965 7220 3d20 3130 0a20 2020 2020 2020  ier = 10.       
+00042350: 202e 2e2e 2020 2020 2064 6566 2065 6e64   ...     def end
+00042360: 5f70 6172 7469 7469 6f6e 2873 656c 662c  _partition(self,
+00042370: 2064 6629 3a0a 2020 2020 2020 2020 2e2e   df):.        ..
+00042380: 2e20 2020 2020 2020 2020 6466 2e63 6f6c  .         df.col
+00042390: 756d 6e73 203d 205b 2769 6427 2c20 2763  umns = ['id', 'c
+000423a0: 6f6c 3127 2c20 2763 6f6c 3227 5d0a 2020  ol1', 'col2'].  
+000423b0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000423c0: 2020 6466 2e63 6f6c 3120 3d20 6466 2e63    df.col1 = df.c
+000423d0: 6f6c 312a 7365 6c66 2e6d 756c 7469 706c  ol1*self.multipl
+000423e0: 6965 720a 2020 2020 2020 2020 2e2e 2e20  ier.        ... 
+000423f0: 2020 2020 2020 2020 6466 2e63 6f6c 3220          df.col2 
+00042400: 3d20 6466 2e63 6f6c 322a 7365 6c66 2e6d  = df.col2*self.m
+00042410: 756c 7469 706c 6965 720a 2020 2020 2020  ultiplier.      
+00042420: 2020 2e2e 2e20 2020 2020 2020 2020 7969    ...         yi
+00042430: 656c 6420 6466 0a20 2020 2020 2020 203e  eld df.        >
+00042440: 3e3e 206d 756c 7469 706c 795f 7564 7466  >> multiply_udtf
+00042450: 203d 2070 616e 6461 735f 7564 7466 280a   = pandas_udtf(.
+00042460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00042470: 6d75 6c74 6970 6c79 2c0a 2020 2020 2020  multiply,.      
+00042480: 2020 2e2e 2e20 2020 2020 6f75 7470 7574    ...     output
+00042490: 5f73 6368 656d 613d 5061 6e64 6173 4461  _schema=PandasDa
+000424a0: 7461 4672 616d 6554 7970 6528 5b53 7472  taFrameType([Str
+000424b0: 696e 6754 7970 6528 292c 2049 6e74 6567  ingType(), Integ
+000424c0: 6572 5479 7065 2829 2c20 466c 6f61 7454  erType(), FloatT
+000424d0: 7970 6528 295d 2c20 5b22 6964 5f22 2c20  ype()], ["id_", 
+000424e0: 2263 6f6c 315f 222c 2022 636f 6c32 5f22  "col1_", "col2_"
+000424f0: 5d29 2c0a 2020 2020 2020 2020 2e2e 2e20  ]),.        ... 
+00042500: 2020 2020 696e 7075 745f 7479 7065 733d      input_types=
+00042510: 5b50 616e 6461 7344 6174 6146 7261 6d65  [PandasDataFrame
+00042520: 5479 7065 285b 5374 7269 6e67 5479 7065  Type([StringType
+00042530: 2829 2c20 496e 7465 6765 7254 7970 6528  (), IntegerType(
+00042540: 292c 2046 6c6f 6174 5479 7065 2829 5d29  ), FloatType()])
+00042550: 5d0a 2020 2020 2020 2020 2e2e 2e20 290a  ].        ... ).
+00042560: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00042570: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00042580: 6461 7461 6672 616d 6528 5b5b 2778 272c  dataframe([['x',
+00042590: 2033 2c20 3335 2e39 5d2c 5b27 7827 2c20   3, 35.9],['x', 
+000425a0: 392c 2032 302e 355d 5d2c 2073 6368 656d  9, 20.5]], schem
+000425b0: 613d 5b22 6964 222c 2022 636f 6c31 222c  a=["id", "col1",
+000425c0: 2022 636f 6c32 225d 290a 2020 2020 2020   "col2"]).      
+000425d0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000425e0: 6d75 6c74 6970 6c79 5f75 6474 6628 2269  multiply_udtf("i
+000425f0: 6422 2c20 2263 6f6c 3122 2c20 2263 6f6c  d", "col1", "col
+00042600: 3222 292e 6f76 6572 2870 6172 7469 7469  2").over(partiti
+00042610: 6f6e 5f62 793d 5b22 6964 225d 2929 2e73  on_by=["id"])).s
+00042620: 6f72 7428 2263 6f6c 315f 2229 2e73 686f  ort("col1_").sho
+00042630: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00042640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00042650: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00042660: 2020 7c22 4944 5f22 2020 7c22 434f 4c31    |"ID_"  |"COL1
+00042670: 5f22 2020 7c22 434f 4c32 5f22 2020 7c0a  _"  |"COL2_"  |.
+00042680: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00042690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000426a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c78  -----.        |x
+000426b0: 2020 2020 2020 7c33 3020 2020 2020 2020        |30       
+000426c0: 7c33 3539 2e30 2020 2020 7c0a 2020 2020  |359.0    |.    
+000426d0: 2020 2020 7c78 2020 2020 2020 7c39 3020      |x      |90 
+000426e0: 2020 2020 2020 7c32 3035 2e30 2020 2020        |205.0    
+000426f0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00042700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00042710: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00042720: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
+00042730: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00042740: 2020 2020 3e3e 3e20 4070 616e 6461 735f      >>> @pandas_
+00042750: 7564 7466 286f 7574 7075 745f 7363 6865  udtf(output_sche
+00042760: 6d61 3d50 616e 6461 7344 6174 6146 7261  ma=PandasDataFra
+00042770: 6d65 5479 7065 285b 5374 7269 6e67 5479  meType([StringTy
+00042780: 7065 2829 2c20 496e 7465 6765 7254 7970  pe(), IntegerTyp
+00042790: 6528 292c 2046 6c6f 6174 5479 7065 2829  e(), FloatType()
+000427a0: 5d2c 205b 2269 645f 222c 2022 636f 6c31  ], ["id_", "col1
+000427b0: 5f22 2c20 2263 6f6c 325f 225d 292c 2069  _", "col2_"]), i
+000427c0: 6e70 7574 5f74 7970 6573 3d5b 5061 6e64  nput_types=[Pand
+000427d0: 6173 4461 7461 4672 616d 6554 7970 6528  asDataFrameType(
+000427e0: 5b53 7472 696e 6754 7970 6528 292c 2049  [StringType(), I
+000427f0: 6e74 6567 6572 5479 7065 2829 2c20 466c  ntegerType(), Fl
+00042800: 6f61 7454 7970 6528 295d 295d 290a 2020  oatType()])]).  
+00042810: 2020 2020 2020 2e2e 2e20 636c 6173 7320        ... class 
+00042820: 5f6d 756c 7469 706c 793a 0a20 2020 2020  _multiply:.     
+00042830: 2020 202e 2e2e 2020 2020 2064 6566 205f     ...     def _
+00042840: 5f69 6e69 745f 5f28 7365 6c66 293a 0a20  _init__(self):. 
+00042850: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00042860: 2020 2073 656c 662e 6d75 6c74 6970 6c69     self.multipli
+00042870: 6572 203d 2031 300a 2020 2020 2020 2020  er = 10.        
+00042880: 2e2e 2e20 2020 2020 6465 6620 656e 645f  ...     def end_
+00042890: 7061 7274 6974 696f 6e28 7365 6c66 2c20  partition(self, 
+000428a0: 6466 293a 0a20 2020 2020 2020 202e 2e2e  df):.        ...
+000428b0: 2020 2020 2020 2020 2064 662e 636f 6c75           df.colu
+000428c0: 6d6e 7320 3d20 5b27 6964 272c 2027 636f  mns = ['id', 'co
+000428d0: 6c31 272c 2027 636f 6c32 275d 0a20 2020  l1', 'col2'].   
+000428e0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+000428f0: 2064 662e 636f 6c31 203d 2064 662e 636f   df.col1 = df.co
+00042900: 6c31 2a73 656c 662e 6d75 6c74 6970 6c69  l1*self.multipli
+00042910: 6572 0a20 2020 2020 2020 202e 2e2e 2020  er.        ...  
+00042920: 2020 2020 2020 2064 662e 636f 6c32 203d         df.col2 =
+00042930: 2064 662e 636f 6c32 2a73 656c 662e 6d75   df.col2*self.mu
+00042940: 6c74 6970 6c69 6572 0a20 2020 2020 2020  ltiplier.       
+00042950: 202e 2e2e 2020 2020 2020 2020 2079 6965   ...         yie
+00042960: 6c64 2064 660a 2020 2020 2020 2020 3e3e  ld df.        >>
+00042970: 3e20 6466 2e73 656c 6563 7428 6d75 6c74  > df.select(mult
+00042980: 6970 6c79 5f75 6474 6628 2269 6422 2c20  iply_udtf("id", 
+00042990: 2263 6f6c 3122 2c20 2263 6f6c 3222 292e  "col1", "col2").
+000429a0: 6f76 6572 2870 6172 7469 7469 6f6e 5f62  over(partition_b
+000429b0: 793d 5b22 6964 225d 2929 2e73 6f72 7428  y=["id"])).sort(
+000429c0: 2263 6f6c 315f 2229 2e73 686f 7728 290a  "col1_").show().
+000429d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000429e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000429f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00042a00: 4944 5f22 2020 7c22 434f 4c31 5f22 2020  ID_"  |"COL1_"  
+00042a10: 7c22 434f 4c32 5f22 2020 7c0a 2020 2020  |"COL2_"  |.    
+00042a20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00042a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00042a40: 2d0a 2020 2020 2020 2020 7c78 2020 2020  -.        |x    
+00042a50: 2020 7c33 3020 2020 2020 2020 7c33 3539    |30       |359
+00042a60: 2e30 2020 2020 7c0a 2020 2020 2020 2020  .0    |.        
+00042a70: 7c78 2020 2020 2020 7c39 3020 2020 2020  |x      |90     
+00042a80: 2020 7c32 3035 2e30 2020 2020 7c0a 2020    |205.0    |.  
+00042a90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00042aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00042ab0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00042ac0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00042ad0: 2020 2020 7365 7373 696f 6e20 3d20 7365      session = se
+00042ae0: 7373 696f 6e20 6f72 2073 6e6f 7766 6c61  ssion or snowfla
+00042af0: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
+00042b00: 696f 6e2e 5f67 6574 5f61 6374 6976 655f  ion._get_active_
+00042b10: 7365 7373 696f 6e28 290a 2020 2020 6966  session().    if
+00042b20: 2068 616e 646c 6572 2069 7320 4e6f 6e65   handler is None
+00042b30: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00042b40: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
+00042b50: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00042b60: 7365 7373 696f 6e2e 7564 7466 2e72 6567  session.udtf.reg
+00042b70: 6973 7465 722c 0a20 2020 2020 2020 2020  ister,.         
+00042b80: 2020 206f 7574 7075 745f 7363 6865 6d61     output_schema
+00042b90: 3d6f 7574 7075 745f 7363 6865 6d61 2c0a  =output_schema,.
+00042ba0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00042bb0: 745f 7479 7065 733d 696e 7075 745f 7479  t_types=input_ty
+00042bc0: 7065 732c 0a20 2020 2020 2020 2020 2020  pes,.           
+00042bd0: 206e 616d 653d 6e61 6d65 2c0a 2020 2020   name=name,.    
+00042be0: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
+00042bf0: 6e65 6e74 3d69 735f 7065 726d 616e 656e  nent=is_permanen
+00042c00: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
+00042c10: 7461 6765 5f6c 6f63 6174 696f 6e3d 7374  tage_location=st
+00042c20: 6167 655f 6c6f 6361 7469 6f6e 2c0a 2020  age_location,.  
+00042c30: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00042c40: 733d 696d 706f 7274 732c 0a20 2020 2020  s=imports,.     
+00042c50: 2020 2020 2020 2070 6163 6b61 6765 733d         packages=
+00042c60: 7061 636b 6167 6573 2c0a 2020 2020 2020  packages,.      
+00042c70: 2020 2020 2020 7265 706c 6163 653d 7265        replace=re
+00042c80: 706c 6163 652c 0a20 2020 2020 2020 2020  place,.         
+00042c90: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
+00042ca0: 3d69 665f 6e6f 745f 6578 6973 7473 2c0a  =if_not_exists,.
+00042cb0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00042cc0: 6c6c 656c 3d70 6172 616c 6c65 6c2c 0a20  llel=parallel,. 
+00042cd0: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00042ce0: 6d65 6e74 5f70 6172 616d 733d 7374 6174  ment_params=stat
+00042cf0: 656d 656e 745f 7061 7261 6d73 2c0a 2020  ement_params,.  
+00042d00: 2020 2020 2020 2020 2020 7374 7269 6374            strict
+00042d10: 3d73 7472 6963 742c 0a20 2020 2020 2020  =strict,.       
+00042d20: 2020 2020 2073 6563 7572 653d 7365 6375       secure=secu
+00042d30: 7265 2c0a 2020 2020 2020 2020 290a 2020  re,.        ).  
+00042d40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00042d50: 7265 7475 726e 2073 6573 7369 6f6e 2e75  return session.u
+00042d60: 6474 662e 7265 6769 7374 6572 280a 2020  dtf.register(.  
+00042d70: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
+00042d80: 722c 0a20 2020 2020 2020 2020 2020 206f  r,.            o
+00042d90: 7574 7075 745f 7363 6865 6d61 3d6f 7574  utput_schema=out
+00042da0: 7075 745f 7363 6865 6d61 2c0a 2020 2020  put_schema,.    
+00042db0: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
+00042dc0: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
+00042dd0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00042de0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
+00042df0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
+00042e00: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
+00042e10: 2020 2020 2020 2020 2020 2073 7461 6765             stage
+00042e20: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
+00042e30: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
+00042e40: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
+00042e50: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
+00042e60: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
+00042e70: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
+00042e80: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
+00042e90: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+00042ea0: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
+00042eb0: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
+00042ec0: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
+00042ed0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
+00042ee0: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
+00042ef0: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
+00042f00: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
+00042f10: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
+00042f20: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+00042f30: 2073 6563 7572 653d 7365 6375 7265 2c0a   secure=secure,.
+00042f40: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+00042f50: 6361 6c6c 5f75 6466 280a 2020 2020 7564  call_udf(.    ud
+00042f60: 665f 6e61 6d65 3a20 7374 722c 0a20 2020  f_name: str,.   
+00042f70: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
+00042f80: 4c69 7465 7261 6c2c 0a29 202d 3e20 436f  Literal,.) -> Co
+00042f90: 6c75 6d6e 3a0a 2020 2020 2222 2243 616c  lumn:.    """Cal
+00042fa0: 6c73 2061 2075 7365 722d 6465 6669 6e65  ls a user-define
+00042fb0: 6420 6675 6e63 7469 6f6e 2028 5544 4629  d function (UDF)
+00042fc0: 2062 7920 6e61 6d65 2e0a 0a20 2020 2041   by name...    A
+00042fd0: 7267 733a 0a20 2020 2020 2020 2075 6466  rgs:.        udf
+00042fe0: 5f6e 616d 653a 2054 6865 206e 616d 6520  _name: The name 
+00042ff0: 6f66 2055 4446 2069 6e20 536e 6f77 666c  of UDF in Snowfl
+00043000: 616b 652e 0a20 2020 2020 2020 2061 7267  ake..        arg
+00043010: 733a 2041 7267 756d 656e 7473 2063 616e  s: Arguments can
+00043020: 2062 6520 696e 2074 776f 2074 7970 6573   be in two types
+00043030: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+00043040: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+00043050: 616b 652e 736e 6f77 7061 726b 2e43 6f6c  ake.snowpark.Col
+00043060: 756d 6e60 2c20 6f72 0a20 2020 2020 2020  umn`, or.       
+00043070: 2020 2020 202d 2042 6173 6963 2050 7974       - Basic Pyt
+00043080: 686f 6e20 7479 7065 732c 2077 6869 6368  hon types, which
+00043090: 2061 7265 2063 6f6e 7665 7274 6564 2074   are converted t
+000430a0: 6f20 536e 6f77 7061 726b 206c 6974 6572  o Snowpark liter
+000430b0: 616c 732e 0a0a 2020 2020 4578 616d 706c  als...    Exampl
+000430c0: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+000430d0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+000430e0: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+000430f0: 706f 7274 2049 6e74 6567 6572 5479 7065  port IntegerType
+00043100: 0a20 2020 2020 2020 203e 3e3e 2075 6466  .        >>> udf
+00043110: 5f64 6566 203d 2073 6573 7369 6f6e 2e75  _def = session.u
+00043120: 6466 2e72 6567 6973 7465 7228 6c61 6d62  df.register(lamb
+00043130: 6461 2078 2c20 793a 2078 202b 2079 2c20  da x, y: x + y, 
+00043140: 6e61 6d65 3d22 6164 645f 636f 6c75 6d6e  name="add_column
+00043150: 7322 2c20 696e 7075 745f 7479 7065 733d  s", input_types=
+00043160: 5b49 6e74 6567 6572 5479 7065 2829 2c20  [IntegerType(), 
+00043170: 496e 7465 6765 7254 7970 6528 295d 2c20  IntegerType()], 
+00043180: 7265 7475 726e 5f74 7970 653d 496e 7465  return_type=Inte
+00043190: 6765 7254 7970 6528 292c 2072 6570 6c61  gerType(), repla
+000431a0: 6365 3d54 7275 6529 0a20 2020 2020 2020  ce=True).       
+000431b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000431c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000431d0: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
+000431e0: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+000431f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00043200: 656c 6563 7428 6361 6c6c 5f75 6466 2822  elect(call_udf("
+00043210: 6164 645f 636f 6c75 6d6e 7322 2c20 636f  add_columns", co
+00043220: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
+00043230: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00043240: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00043250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043260: 2d0a 2020 2020 2020 2020 7c22 4144 445f  -.        |"ADD_
+00043270: 434f 4c55 4d4e 5328 2222 4122 222c 2022  COLUMNS(""A"", "
+00043280: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
+00043290: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000432a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000432b0: 2d0a 2020 2020 2020 2020 7c33 2020 2020  -.        |3    
+000432c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000432d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+000432e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000432f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043300: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00043310: 4c49 4e45 3e0a 2020 2020 2222 220a 0a20  LINE>.    """.. 
+00043320: 2020 2076 616c 6964 6174 655f 6f62 6a65     validate_obje
+00043330: 6374 5f6e 616d 6528 7564 665f 6e61 6d65  ct_name(udf_name
+00043340: 290a 2020 2020 7265 7475 726e 205f 6361  ).    return _ca
+00043350: 6c6c 5f66 756e 6374 696f 6e28 7564 665f  ll_function(udf_
+00043360: 6e61 6d65 2c20 4661 6c73 652c 202a 6172  name, False, *ar
+00043370: 6773 2c20 6170 695f 6361 6c6c 5f73 6f75  gs, api_call_sou
+00043380: 7263 653d 2266 756e 6374 696f 6e73 2e63  rce="functions.c
+00043390: 616c 6c5f 7564 6622 290a 0a0a 6465 6620  all_udf")...def 
+000433a0: 6361 6c6c 5f74 6162 6c65 5f66 756e 6374  call_table_funct
+000433b0: 696f 6e28 0a20 2020 2066 756e 6374 696f  ion(.    functio
+000433c0: 6e5f 6e61 6d65 3a20 7374 722c 202a 6172  n_name: str, *ar
+000433d0: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
+000433e0: 7261 6c2c 202a 2a6b 7761 7267 733a 2043  ral, **kwargs: C
+000433f0: 6f6c 756d 6e4f 724c 6974 6572 616c 0a29  olumnOrLiteral.)
+00043400: 202d 3e20 2273 6e6f 7766 6c61 6b65 2e73   -> "snowflake.s
+00043410: 6e6f 7770 6172 6b2e 7461 626c 655f 6675  nowpark.table_fu
+00043420: 6e63 7469 6f6e 2e54 6162 6c65 4675 6e63  nction.TableFunc
+00043430: 7469 6f6e 4361 6c6c 223a 0a20 2020 2022  tionCall":.    "
+00043440: 2222 496e 766f 6b65 7320 6120 536e 6f77  ""Invokes a Snow
+00043450: 666c 616b 6520 7461 626c 6520 6675 6e63  flake table func
+00043460: 7469 6f6e 2c20 696e 636c 7564 696e 6720  tion, including 
+00043470: 7379 7374 656d 2d64 6566 696e 6564 2074  system-defined t
+00043480: 6162 6c65 2066 756e 6374 696f 6e73 2061  able functions a
+00043490: 6e64 2075 7365 722d 6465 6669 6e65 6420  nd user-defined 
+000434a0: 7461 626c 6520 6675 6e63 7469 6f6e 732e  table functions.
+000434b0: 0a0a 2020 2020 4974 2072 6574 7572 6e73  ..    It returns
+000434c0: 2061 203a 6d65 7468 3a60 7e73 6e6f 7766   a :meth:`~snowf
+000434d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7461  lake.snowpark.ta
+000434e0: 626c 655f 6675 6e63 7469 6f6e 2e54 6162  ble_function.Tab
+000434f0: 6c65 4675 6e63 7469 6f6e 4361 6c6c 6020  leFunctionCall` 
+00043500: 736f 2079 6f75 2063 616e 2073 7065 6369  so you can speci
+00043510: 6679 2074 6865 2070 6172 7469 7469 6f6e  fy the partition
+00043520: 2063 6c61 7573 652e 0a0a 2020 2020 4172   clause...    Ar
+00043530: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+00043540: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
+00043550: 616d 6520 6f66 2074 6865 2074 6162 6c65  ame of the table
+00043560: 2066 756e 6374 696f 6e2e 0a20 2020 2020   function..     
+00043570: 2020 2061 7267 733a 2054 6865 2070 6f73     args: The pos
+00043580: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00043590: 7320 6f66 2074 6865 2074 6162 6c65 2066  s of the table f
+000435a0: 756e 6374 696f 6e2e 0a20 2020 2020 2020  unction..       
+000435b0: 202a 2a6b 7761 7267 733a 2054 6865 206e   **kwargs: The n
+000435c0: 616d 6564 2061 7267 756d 656e 7473 206f  amed arguments o
+000435d0: 6620 7468 6520 7461 626c 6520 6675 6e63  f the table func
+000435e0: 7469 6f6e 2e20 536f 6d65 2074 6162 6c65  tion. Some table
+000435f0: 2066 756e 6374 696f 6e73 2028 652e 672e   functions (e.g.
+00043600: 2c20 6060 666c 6174 7465 6e60 6029 2068  , ``flatten``) h
+00043610: 6176 6520 6e61 6d65 6420 6172 6775 6d65  ave named argume
+00043620: 6e74 7320 696e 7374 6561 6420 6f66 2070  nts instead of p
+00043630: 6f73 6974 696f 6e61 6c20 6f6e 6573 2e0a  ositional ones..
+00043640: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00043650: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00043660: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00043670: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+00043680: 6f72 7420 6c69 740a 2020 2020 2020 2020  ort lit.        
+00043690: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
+000436a0: 655f 6675 6e63 7469 6f6e 2863 616c 6c5f  e_function(call_
+000436b0: 7461 626c 655f 6675 6e63 7469 6f6e 2822  table_function("
+000436c0: 7370 6c69 745f 746f 5f74 6162 6c65 222c  split_to_table",
+000436d0: 206c 6974 2822 7370 6c69 7420 776f 7264   lit("split word
+000436e0: 7320 746f 2074 6162 6c65 2229 2c20 6c69  s to table"), li
+000436f0: 7428 2220 2229 292e 6f76 6572 2829 292e  t(" ")).over()).
+00043700: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00043710: 2020 5b52 6f77 2853 4551 3d31 2c20 494e    [Row(SEQ=1, IN
+00043720: 4445 583d 312c 2056 414c 5545 3d27 7370  DEX=1, VALUE='sp
+00043730: 6c69 7427 292c 2052 6f77 2853 4551 3d31  lit'), Row(SEQ=1
+00043740: 2c20 494e 4445 583d 322c 2056 414c 5545  , INDEX=2, VALUE
+00043750: 3d27 776f 7264 7327 292c 2052 6f77 2853  ='words'), Row(S
+00043760: 4551 3d31 2c20 494e 4445 583d 332c 2056  EQ=1, INDEX=3, V
+00043770: 414c 5545 3d27 746f 2729 2c20 526f 7728  ALUE='to'), Row(
+00043780: 5345 513d 312c 2049 4e44 4558 3d34 2c20  SEQ=1, INDEX=4, 
+00043790: 5641 4c55 453d 2774 6162 6c65 2729 5d0a  VALUE='table')].
+000437a0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+000437b0: 726e 2073 6e6f 7766 6c61 6b65 2e73 6e6f  rn snowflake.sno
+000437c0: 7770 6172 6b2e 7461 626c 655f 6675 6e63  wpark.table_func
+000437d0: 7469 6f6e 2e54 6162 6c65 4675 6e63 7469  tion.TableFuncti
+000437e0: 6f6e 4361 6c6c 280a 2020 2020 2020 2020  onCall(.        
+000437f0: 6675 6e63 7469 6f6e 5f6e 616d 652c 202a  function_name, *
+00043800: 6172 6773 2c20 2a2a 6b77 6172 6773 0a20  args, **kwargs. 
+00043810: 2020 2029 0a0a 0a64 6566 2074 6162 6c65     )...def table
+00043820: 5f66 756e 6374 696f 6e28 6675 6e63 7469  _function(functi
+00043830: 6f6e 5f6e 616d 653a 2073 7472 2920 2d3e  on_name: str) ->
+00043840: 2043 616c 6c61 626c 653a 0a20 2020 2022   Callable:.    "
+00043850: 2222 4372 6561 7465 2061 2066 756e 6374  ""Create a funct
+00043860: 696f 6e20 6f62 6a65 6374 2074 6f20 696e  ion object to in
+00043870: 766f 6b65 2061 2053 6e6f 7766 6c61 6b65  voke a Snowflake
+00043880: 2074 6162 6c65 2066 756e 6374 696f 6e2e   table function.
+00043890: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+000438a0: 2020 2020 6675 6e63 7469 6f6e 5f6e 616d      function_nam
+000438b0: 653a 2054 6865 206e 616d 6520 6f66 2074  e: The name of t
+000438c0: 6865 2074 6162 6c65 2066 756e 6374 696f  he table functio
+000438d0: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+000438e0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+000438f0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00043900: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+00043910: 696d 706f 7274 206c 6974 0a20 2020 2020  import lit.     
+00043920: 2020 203e 3e3e 2073 706c 6974 5f74 6f5f     >>> split_to_
+00043930: 7461 626c 6520 3d20 7461 626c 655f 6675  table = table_fu
+00043940: 6e63 7469 6f6e 2822 7370 6c69 745f 746f  nction("split_to
+00043950: 5f74 6162 6c65 2229 0a20 2020 2020 2020  _table").       
+00043960: 203e 3e3e 2073 6573 7369 6f6e 2e74 6162   >>> session.tab
+00043970: 6c65 5f66 756e 6374 696f 6e28 7370 6c69  le_function(spli
+00043980: 745f 746f 5f74 6162 6c65 286c 6974 2822  t_to_table(lit("
+00043990: 7370 6c69 7420 776f 7264 7320 746f 2074  split words to t
+000439a0: 6162 6c65 2229 2c20 6c69 7428 2220 2229  able"), lit(" ")
+000439b0: 292e 6f76 6572 2829 292e 636f 6c6c 6563  ).over()).collec
+000439c0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+000439d0: 2853 4551 3d31 2c20 494e 4445 583d 312c  (SEQ=1, INDEX=1,
+000439e0: 2056 414c 5545 3d27 7370 6c69 7427 292c   VALUE='split'),
+000439f0: 2052 6f77 2853 4551 3d31 2c20 494e 4445   Row(SEQ=1, INDE
+00043a00: 583d 322c 2056 414c 5545 3d27 776f 7264  X=2, VALUE='word
+00043a10: 7327 292c 2052 6f77 2853 4551 3d31 2c20  s'), Row(SEQ=1, 
+00043a20: 494e 4445 583d 332c 2056 414c 5545 3d27  INDEX=3, VALUE='
+00043a30: 746f 2729 2c20 526f 7728 5345 513d 312c  to'), Row(SEQ=1,
+00043a40: 2049 4e44 4558 3d34 2c20 5641 4c55 453d   INDEX=4, VALUE=
+00043a50: 2774 6162 6c65 2729 5d0a 2020 2020 2222  'table')].    ""
+00043a60: 220a 2020 2020 7265 7475 726e 206c 616d  ".    return lam
+00043a70: 6264 6120 2a61 7267 732c 202a 2a6b 7761  bda *args, **kwa
+00043a80: 7267 733a 2063 616c 6c5f 7461 626c 655f  rgs: call_table_
+00043a90: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
+00043aa0: 6e5f 6e61 6d65 2c20 2a61 7267 732c 202a  n_name, *args, *
+00043ab0: 2a6b 7761 7267 7329 0a0a 0a64 6566 2063  *kwargs)...def c
+00043ac0: 616c 6c5f 6675 6e63 7469 6f6e 2866 756e  all_function(fun
+00043ad0: 6374 696f 6e5f 6e61 6d65 3a20 7374 722c  ction_name: str,
+00043ae0: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
+00043af0: 4c69 7465 7261 6c29 202d 3e20 436f 6c75  Literal) -> Colu
+00043b00: 6d6e 3a0a 2020 2020 2222 2249 6e76 6f6b  mn:.    """Invok
+00043b10: 6573 2061 2053 6e6f 7766 6c61 6b65 2060  es a Snowflake `
+00043b20: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
+00043b30: 756e 6374 696f 6e20 3c68 7474 7073 3a2f  unction <https:/
+00043b40: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
+00043b50: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
+00043b60: 656e 6365 2d66 756e 6374 696f 6e73 2e68  ence-functions.h
+00043b70: 746d 6c3e 605f 2028 6275 696c 742d 696e  tml>`_ (built-in
+00043b80: 2066 756e 6374 696f 6e29 2077 6974 6820   function) with 
+00043b90: 7468 6520 7370 6563 6966 6965 6420 6e61  the specified na
+00043ba0: 6d65 0a20 2020 2061 6e64 2061 7267 756d  me.    and argum
+00043bb0: 656e 7473 2e0a 0a20 2020 2041 7267 733a  ents...    Args:
+00043bc0: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
+00043bd0: 6e5f 6e61 6d65 3a20 5468 6520 6e61 6d65  n_name: The name
+00043be0: 206f 6620 6275 696c 742d 696e 2066 756e   of built-in fun
+00043bf0: 6374 696f 6e20 696e 2053 6e6f 7766 6c61  ction in Snowfla
+00043c00: 6b65 0a20 2020 2020 2020 2061 7267 733a  ke.        args:
+00043c10: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
+00043c20: 6520 696e 2074 776f 2074 7970 6573 3a0a  e in two types:.
+00043c30: 0a20 2020 2020 2020 2020 2020 202d 203a  .            - :
+00043c40: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00043c50: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
+00043c60: 6e60 2c20 6f72 0a20 2020 2020 2020 2020  n`, or.         
+00043c70: 2020 202d 2042 6173 6963 2050 7974 686f     - Basic Pytho
+00043c80: 6e20 7479 7065 732c 2077 6869 6368 2061  n types, which a
+00043c90: 7265 2063 6f6e 7665 7274 6564 2074 6f20  re converted to 
+00043ca0: 536e 6f77 7061 726b 206c 6974 6572 616c  Snowpark literal
+00043cb0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00043cc0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+00043cd0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00043ce0: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+00043cf0: 322c 2033 2c20 345d 2c20 7363 6865 6d61  2, 3, 4], schema
+00043d00: 3d5b 2261 225d 2920 2023 2061 2073 696e  =["a"])  # a sin
+00043d10: 676c 6520 636f 6c75 6d6e 2077 6974 6820  gle column with 
+00043d20: 3420 726f 7773 0a20 2020 2020 2020 203e  4 rows.        >
+00043d30: 3e3e 2064 662e 7365 6c65 6374 2863 616c  >> df.select(cal
+00043d40: 6c5f 6675 6e63 7469 6f6e 2822 6176 6722  l_function("avg"
+00043d50: 2c20 636f 6c28 2261 2229 2929 2e73 686f  , col("a"))).sho
+00043d60: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00043d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00043d80: 2020 2020 207c 2241 5647 2822 2241 2222       |"AVG(""A""
+00043d90: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
+00043da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00043db0: 2020 2020 2020 207c 322e 3530 3030 3030         |2.500000
+00043dc0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00043dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00043de0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00043df0: 494e 453e 0a0a 2020 2020 2222 220a 0a20  INE>..    """.. 
+00043e00: 2020 2072 6574 7572 6e20 5f63 616c 6c5f     return _call_
+00043e10: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
+00043e20: 6e5f 6e61 6d65 2c20 4661 6c73 652c 202a  n_name, False, *
+00043e30: 6172 6773 290a 0a0a 6465 6620 6675 6e63  args)...def func
+00043e40: 7469 6f6e 2866 756e 6374 696f 6e5f 6e61  tion(function_na
+00043e50: 6d65 3a20 7374 7229 202d 3e20 4361 6c6c  me: str) -> Call
+00043e60: 6162 6c65 3a0a 2020 2020 2222 220a 2020  able:.    """.  
+00043e70: 2020 4675 6e63 7469 6f6e 206f 626a 6563    Function objec
+00043e80: 7420 746f 2069 6e76 6f6b 6520 6120 536e  t to invoke a Sn
+00043e90: 6f77 666c 616b 6520 6073 7973 7465 6d2d  owflake `system-
+00043ea0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+00043eb0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+00043ec0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+00043ed0: 7371 6c2d 7265 6665 7265 6e63 652d 6675  sql-reference-fu
+00043ee0: 6e63 7469 6f6e 732e 6874 6d6c 3e60 5f20  nctions.html>`_ 
+00043ef0: 2862 7569 6c74 2d69 6e20 6675 6e63 7469  (built-in functi
+00043f00: 6f6e 292e 2055 7365 2074 6869 7320 746f  on). Use this to
+00043f10: 2069 6e76 6f6b 650a 2020 2020 616e 7920   invoke.    any 
+00043f20: 6275 696c 742d 696e 2066 756e 6374 696f  built-in functio
+00043f30: 6e73 206e 6f74 2065 7870 6c69 6369 746c  ns not explicitl
+00043f40: 7920 6c69 7374 6564 2069 6e20 7468 6973  y listed in this
+00043f50: 206f 626a 6563 742e 0a0a 2020 2020 4172   object...    Ar
+00043f60: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+00043f70: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
+00043f80: 616d 6520 6f66 2062 7569 6c74 2d69 6e20  ame of built-in 
+00043f90: 6675 6e63 7469 6f6e 2069 6e20 536e 6f77  function in Snow
+00043fa0: 666c 616b 652e 0a0a 2020 2020 5265 7475  flake...    Retu
+00043fb0: 726e 733a 0a20 2020 2020 2020 2041 203a  rns:.        A :
+00043fc0: 636c 6173 733a 6043 616c 6c61 626c 6560  class:`Callable`
+00043fd0: 206f 626a 6563 7420 666f 7220 6361 6c6c   object for call
+00043fe0: 696e 6720 6120 536e 6f77 666c 616b 6520  ing a Snowflake 
+00043ff0: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
+00044000: 756e 6374 696f 6e2e 0a0a 2020 2020 4578  unction...    Ex
+00044010: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00044020: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00044030: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00044040: 6528 5b31 2c20 322c 2033 2c20 345d 2c20  e([1, 2, 3, 4], 
+00044050: 7363 6865 6d61 3d5b 2261 225d 2920 2023  schema=["a"])  #
+00044060: 2061 2073 696e 676c 6520 636f 6c75 6d6e   a single column
+00044070: 2077 6974 6820 3420 726f 7773 0a20 2020   with 4 rows.   
+00044080: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00044090: 6374 2863 616c 6c5f 6675 6e63 7469 6f6e  ct(call_function
+000440a0: 2822 6176 6722 2c20 636f 6c28 2261 2229  ("avg", col("a")
+000440b0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000440c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+000440d0: 2d2d 0a20 2020 2020 2020 207c 2241 5647  --.        |"AVG
+000440e0: 2822 2241 2222 2922 2020 7c0a 2020 2020  (""A"")"  |.    
+000440f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00044100: 2d2d 2d2d 0a20 2020 2020 2020 207c 322e  ----.        |2.
+00044110: 3530 3030 3030 2020 2020 2020 7c0a 2020  500000      |.  
+00044120: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00044130: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00044140: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
+00044150: 2020 203e 3e3e 206d 795f 6176 6720 3d20     >>> my_avg = 
+00044160: 6675 6e63 7469 6f6e 2827 6176 6727 290a  function('avg').
+00044170: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00044180: 656c 6563 7428 6d79 5f61 7667 2863 6f6c  elect(my_avg(col
+00044190: 2822 6122 2929 292e 7368 6f77 2829 0a20  ("a"))).show(). 
+000441a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000441b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000441c0: 7c22 4156 4728 2222 4122 2229 2220 207c  |"AVG(""A"")"  |
+000441d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000441e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000441f0: 2020 7c32 2e35 3030 3030 3020 2020 2020    |2.500000     
+00044200: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00044210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00044220: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00044230: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+00044240: 726e 206c 616d 6264 6120 2a61 7267 733a  rn lambda *args:
+00044250: 2063 616c 6c5f 6675 6e63 7469 6f6e 2866   call_function(f
+00044260: 756e 6374 696f 6e5f 6e61 6d65 2c20 2a61  unction_name, *a
+00044270: 7267 7329 0a0a 0a64 6566 205f 6361 6c6c  rgs)...def _call
+00044280: 5f66 756e 6374 696f 6e28 0a20 2020 206e  _function(.    n
+00044290: 616d 653a 2073 7472 2c0a 2020 2020 6973  ame: str,.    is
+000442a0: 5f64 6973 7469 6e63 743a 2062 6f6f 6c20  _distinct: bool 
+000442b0: 3d20 4661 6c73 652c 0a20 2020 202a 6172  = False,.    *ar
+000442c0: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
+000442d0: 7261 6c2c 0a20 2020 2061 7069 5f63 616c  ral,.    api_cal
+000442e0: 6c5f 736f 7572 6365 3a20 4f70 7469 6f6e  l_source: Option
+000442f0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+00044300: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00044310: 2065 7870 7265 7373 696f 6e73 203d 205b   expressions = [
+00044320: 436f 6c75 6d6e 2e5f 746f 5f65 7870 7228  Column._to_expr(
+00044330: 6172 6729 2066 6f72 2061 7267 2069 6e20  arg) for arg in 
+00044340: 7061 7273 655f 706f 7369 7469 6f6e 616c  parse_positional
+00044350: 5f61 7267 735f 746f 5f6c 6973 7428 2a61  _args_to_list(*a
+00044360: 7267 7329 5d0a 2020 2020 7265 7475 726e  rgs)].    return
+00044370: 2043 6f6c 756d 6e28 0a20 2020 2020 2020   Column(.       
+00044380: 2046 756e 6374 696f 6e45 7870 7265 7373   FunctionExpress
+00044390: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+000443a0: 206e 616d 652c 2065 7870 7265 7373 696f   name, expressio
+000443b0: 6e73 2c20 6973 5f64 6973 7469 6e63 743d  ns, is_distinct=
+000443c0: 6973 5f64 6973 7469 6e63 742c 2061 7069  is_distinct, api
+000443d0: 5f63 616c 6c5f 736f 7572 6365 3d61 7069  _call_source=api
+000443e0: 5f63 616c 6c5f 736f 7572 6365 0a20 2020  _call_source.   
+000443f0: 2020 2020 2029 0a20 2020 2029 0a0a 0a64       ).    )...d
+00044400: 6566 2073 7072 6f63 280a 2020 2020 6675  ef sproc(.    fu
+00044410: 6e63 3a20 4f70 7469 6f6e 616c 5b43 616c  nc: Optional[Cal
+00044420: 6c61 626c 655d 203d 204e 6f6e 652c 0a20  lable] = None,. 
+00044430: 2020 202a 2c0a 2020 2020 7265 7475 726e     *,.    return
+00044440: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
+00044450: 4461 7461 5479 7065 5d20 3d20 4e6f 6e65  DataType] = None
+00044460: 2c0a 2020 2020 696e 7075 745f 7479 7065  ,.    input_type
+00044470: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+00044480: 5b44 6174 6154 7970 655d 5d20 3d20 4e6f  [DataType]] = No
+00044490: 6e65 2c0a 2020 2020 6e61 6d65 3a20 4f70  ne,.    name: Op
+000444a0: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+000444b0: 2c20 4974 6572 6162 6c65 5b73 7472 5d5d  , Iterable[str]]
+000444c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6973  ] = None,.    is
+000444d0: 5f70 6572 6d61 6e65 6e74 3a20 626f 6f6c  _permanent: bool
+000444e0: 203d 2046 616c 7365 2c0a 2020 2020 7374   = False,.    st
+000444f0: 6167 655f 6c6f 6361 7469 6f6e 3a20 4f70  age_location: Op
+00044500: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00044510: 6e65 2c0a 2020 2020 696d 706f 7274 733a  ne,.    imports:
+00044520: 204f 7074 696f 6e61 6c5b 4c69 7374 5b55   Optional[List[U
+00044530: 6e69 6f6e 5b73 7472 2c20 5475 706c 655b  nion[str, Tuple[
+00044540: 7374 722c 2073 7472 5d5d 5d5d 203d 204e  str, str]]]] = N
+00044550: 6f6e 652c 0a20 2020 2070 6163 6b61 6765  one,.    package
+00044560: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+00044570: 5b55 6e69 6f6e 5b73 7472 2c20 4d6f 6475  [Union[str, Modu
+00044580: 6c65 5479 7065 5d5d 5d20 3d20 4e6f 6e65  leType]]] = None
+00044590: 2c0a 2020 2020 7265 706c 6163 653a 2062  ,.    replace: b
+000445a0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+000445b0: 2069 665f 6e6f 745f 6578 6973 7473 3a20   if_not_exists: 
+000445c0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+000445d0: 2020 7365 7373 696f 6e3a 204f 7074 696f    session: Optio
+000445e0: 6e61 6c5b 2273 6e6f 7766 6c61 6b65 2e73  nal["snowflake.s
+000445f0: 6e6f 7770 6172 6b2e 5365 7373 696f 6e22  nowpark.Session"
+00044600: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 7061  ] = None,.    pa
+00044610: 7261 6c6c 656c 3a20 696e 7420 3d20 342c  rallel: int = 4,
+00044620: 0a20 2020 2073 7461 7465 6d65 6e74 5f70  .    statement_p
+00044630: 6172 616d 733a 204f 7074 696f 6e61 6c5b  arams: Optional[
+00044640: 4469 6374 5b73 7472 2c20 7374 725d 5d20  Dict[str, str]] 
+00044650: 3d20 4e6f 6e65 2c0a 2020 2020 6578 6563  = None,.    exec
+00044660: 7574 655f 6173 3a20 7479 7069 6e67 2e4c  ute_as: typing.L
+00044670: 6974 6572 616c 5b22 6361 6c6c 6572 222c  iteral["caller",
+00044680: 2022 6f77 6e65 7222 5d20 3d20 226f 776e   "owner"] = "own
+00044690: 6572 222c 0a20 2020 2073 7472 6963 743a  er",.    strict:
+000446a0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+000446b0: 2020 2073 6f75 7263 655f 636f 6465 5f64     source_code_d
+000446c0: 6973 706c 6179 3a20 626f 6f6c 203d 2054  isplay: bool = T
+000446d0: 7275 652c 0a20 2020 202a 2a6b 7761 7267  rue,.    **kwarg
+000446e0: 732c 0a29 202d 3e20 556e 696f 6e5b 5374  s,.) -> Union[St
+000446f0: 6f72 6564 5072 6f63 6564 7572 652c 2066  oredProcedure, f
+00044700: 756e 6374 6f6f 6c73 2e70 6172 7469 616c  unctools.partial
+00044710: 5d3a 0a20 2020 2022 2222 5265 6769 7374  ]:.    """Regist
+00044720: 6572 7320 6120 5079 7468 6f6e 2066 756e  ers a Python fun
+00044730: 6374 696f 6e20 6173 2061 2053 6e6f 7766  ction as a Snowf
+00044740: 6c61 6b65 2050 7974 686f 6e20 7374 6f72  lake Python stor
+00044750: 6564 2070 726f 6365 6475 7265 2061 6e64  ed procedure and
+00044760: 2072 6574 7572 6e73 2074 6865 2073 746f   returns the sto
+00044770: 7265 6420 7072 6f63 6564 7572 652e 0a0a  red procedure...
+00044780: 2020 2020 4974 2063 616e 2062 6520 7573      It can be us
+00044790: 6564 2061 7320 6569 7468 6572 2061 2066  ed as either a f
+000447a0: 756e 6374 696f 6e20 6361 6c6c 206f 7220  unction call or 
+000447b0: 6120 6465 636f 7261 746f 722e 2049 6e20  a decorator. In 
+000447c0: 6d6f 7374 2063 6173 6573 2079 6f75 2077  most cases you w
+000447d0: 6f72 6b20 7769 7468 2061 2073 696e 676c  ork with a singl
+000447e0: 6520 7365 7373 696f 6e2e 0a20 2020 2054  e session..    T
+000447f0: 6869 7320 6675 6e63 7469 6f6e 2075 7365  his function use
+00044800: 7320 7468 6174 2073 6573 7369 6f6e 2074  s that session t
+00044810: 6f20 7265 6769 7374 6572 2074 6865 2073  o register the s
+00044820: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
+00044830: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
+00044840: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
+00044850: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
+00044860: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
+00044870: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
+00044880: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
+00044890: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
+000448a0: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
+000448b0: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
+000448c0: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
+000448d0: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
+000448e0: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
+000448f0: 7365 2060 6073 6573 7369 6f6e 2e73 7072  se ``session.spr
+00044900: 6f63 2e72 6567 6973 7465 7260 6020 696e  oc.register`` in
+00044910: 7374 6561 642e 2053 6565 2065 7861 6d70  stead. See examp
+00044920: 6c65 730a 2020 2020 696e 203a 636c 6173  les.    in :clas
+00044930: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+00044940: 6f77 7061 726b 2e73 746f 7265 645f 7072  owpark.stored_pr
+00044950: 6f63 6564 7572 652e 5374 6f72 6564 5072  ocedure.StoredPr
+00044960: 6f63 6564 7572 6552 6567 6973 7472 6174  ocedureRegistrat
+00044970: 696f 6e60 2e0a 0a20 2020 204e 6f74 6520  ion`...    Note 
+00044980: 7468 6174 2074 6865 2066 6972 7374 2070  that the first p
+00044990: 6172 616d 6574 6572 206f 6620 796f 7572  arameter of your
+000449a0: 2066 756e 6374 696f 6e20 7368 6f75 6c64   function should
+000449b0: 2062 6520 6120 736e 6f77 7061 726b 2053   be a snowpark S
+000449c0: 6573 7369 6f6e 2e20 416c 736f 2c20 796f  ession. Also, yo
+000449d0: 7520 6e65 6564 2074 6f20 6164 640a 2020  u need to add.  
+000449e0: 2020 6073 6e6f 7766 6c61 6b65 2d73 6e6f    `snowflake-sno
+000449f0: 7770 6172 6b2d 7079 7468 6f6e 6020 7061  wpark-python` pa
+00044a00: 636b 6167 6520 2876 6572 7369 6f6e 203e  ckage (version >
+00044a10: 3d20 302e 342e 3029 2074 6f20 796f 7572  = 0.4.0) to your
+00044a20: 2073 6573 7369 6f6e 2062 6566 6f72 6520   session before 
+00044a30: 7472 7969 6e67 2074 6f20 6372 6561 7465  trying to create
+00044a40: 2061 0a20 2020 2073 746f 7265 6420 7072   a.    stored pr
+00044a50: 6f63 6564 7572 652e 0a0a 2020 2020 4172  ocedure...    Ar
+00044a60: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+00044a70: 3a20 4120 5079 7468 6f6e 2066 756e 6374  : A Python funct
+00044a80: 696f 6e20 7573 6564 2066 6f72 2063 7265  ion used for cre
+00044a90: 6174 696e 6720 7468 6520 7374 6f72 6564  ating the stored
+00044aa0: 2070 726f 6365 6475 7265 2e0a 2020 2020   procedure..    
+00044ab0: 2020 2020 7265 7475 726e 5f74 7970 653a      return_type:
+00044ac0: 2041 203a 636c 6173 733a 607e 736e 6f77   A :class:`~snow
+00044ad0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+00044ae0: 7970 6573 2e44 6174 6154 7970 6560 2072  ypes.DataType` r
+00044af0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+00044b00: 7265 7475 726e 2064 6174 610a 2020 2020  return data.    
+00044b10: 2020 2020 2020 2020 7479 7065 206f 6620          type of 
+00044b20: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
+00044b30: 6475 7265 2e20 4f70 7469 6f6e 616c 2069  dure. Optional i
+00044b40: 6620 7479 7065 2068 696e 7473 2061 7265  f type hints are
+00044b50: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
+00044b60: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
+00044b70: 4120 6c69 7374 206f 6620 3a63 6c61 7373  A list of :class
+00044b80: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+00044b90: 7770 6172 6b2e 7479 7065 732e 4461 7461  wpark.types.Data
+00044ba0: 5479 7065 600a 2020 2020 2020 2020 2020  Type`.          
+00044bb0: 2020 7265 7072 6573 656e 7469 6e67 2074    representing t
+00044bc0: 6865 2069 6e70 7574 2064 6174 6120 7479  he input data ty
+00044bd0: 7065 7320 6f66 2074 6865 2073 746f 7265  pes of the store
+00044be0: 6420 7072 6f63 6564 7572 652e 204f 7074  d procedure. Opt
+00044bf0: 696f 6e61 6c20 6966 0a20 2020 2020 2020  ional if.       
+00044c00: 2020 2020 2074 7970 6520 6869 6e74 7320       type hints 
+00044c10: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
+00044c20: 2020 2020 2020 6e61 6d65 3a20 4120 7374        name: A st
+00044c30: 7269 6e67 206f 7220 6c69 7374 206f 6620  ring or list of 
+00044c40: 7374 7269 6e67 7320 7468 6174 2073 7065  strings that spe
+00044c50: 6369 6679 2074 6865 206e 616d 6520 6f72  cify the name or
+00044c60: 2066 756c 6c79 2d71 7561 6c69 6669 6564   fully-qualified
+00044c70: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
+00044c80: 6563 7420 6964 656e 7469 6669 6572 2028  ect identifier (
+00044c90: 6461 7461 6261 7365 206e 616d 652c 2073  database name, s
+00044ca0: 6368 656d 6120 6e61 6d65 2c20 616e 6420  chema name, and 
+00044cb0: 6675 6e63 7469 6f6e 206e 616d 6529 2066  function name) f
+00044cc0: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
+00044cd0: 6865 2073 746f 7265 6420 7072 6f63 6564  he stored proced
+00044ce0: 7572 6520 696e 2053 6e6f 7766 6c61 6b65  ure in Snowflake
+00044cf0: 2c20 7768 6963 6820 616c 6c6f 7773 2079  , which allows y
+00044d00: 6f75 2074 6f20 6361 6c6c 2074 6869 7320  ou to call this 
+00044d10: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+00044d20: 2069 6e20 6120 5351 4c0a 2020 2020 2020   in a SQL.      
+00044d30: 2020 2020 2020 636f 6d6d 616e 6420 6f72        command or
+00044d40: 2076 6961 203a 6675 6e63 3a60 7365 7373   via :func:`sess
+00044d50: 696f 6e2e 6361 6c6c 2829 602e 2049 6620  ion.call()`. If 
+00044d60: 6974 2069 7320 6e6f 7420 7072 6f76 6964  it is not provid
+00044d70: 6564 2c20 6120 6e61 6d65 2077 696c 6c0a  ed, a name will.
+00044d80: 2020 2020 2020 2020 2020 2020 6265 2061              be a
+00044d90: 7574 6f6d 6174 6963 616c 6c79 2067 656e  utomatically gen
+00044da0: 6572 6174 6564 2066 6f72 2074 6865 2073  erated for the s
+00044db0: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
+00044dc0: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
+00044dd0: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
+00044de0: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
+00044df0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+00044e00: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+00044e10: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
+00044e20: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
+00044e30: 2061 2070 6572 6d61 6e65 6e74 2073 746f   a permanent sto
+00044e40: 7265 6420 7072 6f63 6564 7572 652e 2054  red procedure. T
+00044e50: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
+00044e60: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+00044e70: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
+00044e80: 5472 7565 6060 2c20 6120 7661 6c69 6420  True``, a valid 
+00044e90: 6060 7374 6167 655f 6c6f 6361 7469 6f6e  ``stage_location
+00044ea0: 6060 206d 7573 7420 6265 2070 726f 7669  `` must be provi
+00044eb0: 6465 642e 0a20 2020 2020 2020 2073 7461  ded..        sta
+00044ec0: 6765 5f6c 6f63 6174 696f 6e3a 2054 6865  ge_location: The
+00044ed0: 2073 7461 6765 206c 6f63 6174 696f 6e20   stage location 
+00044ee0: 7768 6572 6520 7468 6520 5079 7468 6f6e  where the Python
+00044ef0: 2066 696c 6520 666f 7220 7468 6520 7374   file for the st
+00044f00: 6f72 6564 2070 726f 6365 6475 7265 0a20  ored procedure. 
+00044f10: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
+00044f20: 7473 2064 6570 656e 6465 6e63 6965 7320  ts dependencies 
+00044f30: 7368 6f75 6c64 2062 6520 7570 6c6f 6164  should be upload
+00044f40: 6564 2e20 5468 6520 7374 6167 6520 6c6f  ed. The stage lo
+00044f50: 6361 7469 6f6e 206d 7573 7420 6265 2073  cation must be s
+00044f60: 7065 6369 6669 6564 0a20 2020 2020 2020  pecified.       
+00044f70: 2020 2020 2077 6865 6e20 6060 6973 5f70       when ``is_p
+00044f80: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
+00044f90: 5472 7565 6060 2c20 616e 6420 6974 2077  True``, and it w
+00044fa0: 696c 6c20 6265 2069 676e 6f72 6564 2077  ill be ignored w
+00044fb0: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+00044fc0: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
+00044fd0: 2069 7320 6060 4661 6c73 6560 602e 2049   is ``False``. I
+00044fe0: 7420 6361 6e20 6265 2061 6e79 2073 7461  t can be any sta
+00044ff0: 6765 206f 7468 6572 2074 6861 6e20 7465  ge other than te
+00045000: 6d70 6f72 6172 790a 2020 2020 2020 2020  mporary.        
+00045010: 2020 2020 7374 6167 6573 2061 6e64 2065      stages and e
+00045020: 7874 6572 6e61 6c20 7374 6167 6573 2e0a  xternal stages..
+00045030: 2020 2020 2020 2020 696d 706f 7274 733a          imports:
+00045040: 2041 206c 6973 7420 6f66 2069 6d70 6f72   A list of impor
+00045050: 7473 2074 6861 7420 6f6e 6c79 2061 7070  ts that only app
+00045060: 6c79 2074 6f20 7468 6973 2073 746f 7265  ly to this store
+00045070: 6420 7072 6f63 6564 7572 652e 2059 6f75  d procedure. You
+00045080: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
+00045090: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
+000450a0: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
+000450b0: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
+000450c0: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
+000450d0: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
+000450e0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+000450f0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00045100: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+00045110: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
+00045120: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
+00045130: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
+00045140: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
+00045150: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
+00045160: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
+00045170: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
+00045180: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
+00045190: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
+000451a0: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
+000451b0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+000451c0: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+000451d0: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
+000451e0: 2054 6865 7365 2073 746f 7265 642d 7072   These stored-pr
+000451f0: 6f63 2d6c 6576 656c 2069 6d70 6f72 7473  oc-level imports
+00045200: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00045210: 6c20 6f76 6572 7269 6465 2074 6865 2073  l override the s
+00045220: 6573 7369 6f6e 2d6c 6576 656c 2069 6d70  ession-level imp
+00045230: 6f72 7473 2061 6464 6564 2062 790a 2020  orts added by.  
+00045240: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+00045250: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00045260: 7061 726b 2e53 6573 7369 6f6e 2e61 6464  park.Session.add
+00045270: 5f69 6d70 6f72 7460 2e0a 2020 2020 2020  _import`..      
+00045280: 2020 7061 636b 6167 6573 3a20 4120 6c69    packages: A li
+00045290: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
+000452a0: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
+000452b0: 6f20 7468 6973 2073 746f 7265 6420 7072  o this stored pr
+000452c0: 6f63 6564 7572 652e 2054 6865 7365 2073  ocedure. These s
+000452d0: 746f 7265 642d 7072 6f63 2d6c 6576 656c  tored-proc-level
+000452e0: 2070 6163 6b61 6765 730a 2020 2020 2020   packages.      
+000452f0: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
+00045300: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
+00045310: 6c65 7665 6c20 7061 636b 6167 6573 2061  level packages a
+00045320: 6464 6564 2062 790a 2020 2020 2020 2020  dded by.        
+00045330: 2020 2020 3a6d 6574 683a 607e 736e 6f77      :meth:`~snow
+00045340: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
+00045350: 6573 7369 6f6e 2e61 6464 5f70 6163 6b61  ession.add_packa
+00045360: 6765 7360 2061 6e64 0a20 2020 2020 2020  ges` and.       
+00045370: 2020 2020 203a 6d65 7468 3a60 7e73 6e6f       :meth:`~sno
+00045380: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00045390: 5365 7373 696f 6e2e 6164 645f 7265 7175  Session.add_requ
+000453a0: 6972 656d 656e 7473 602e 2054 6f20 7573  irements`. To us
+000453b0: 6520 5079 7468 6f6e 2070 6163 6b61 6765  e Python package
+000453c0: 7320 7468 6174 2061 7265 206e 6f74 2061  s that are not a
+000453d0: 7661 696c 6162 6c65 2069 6e0a 2020 2020  vailable in.    
+000453e0: 2020 2020 2020 2020 536e 6f77 666c 616b          Snowflak
+000453f0: 652c 2072 6566 6572 2074 6f20 3a6d 6574  e, refer to :met
+00045400: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
+00045410: 6f77 7061 726b 2e53 6573 7369 6f6e 2e63  owpark.Session.c
+00045420: 7573 746f 6d5f 7061 636b 6167 655f 7573  ustom_package_us
+00045430: 6167 655f 636f 6e66 6967 602e 0a20 2020  age_config`..   
+00045440: 2020 2020 2072 6570 6c61 6365 3a20 5768       replace: Wh
+00045450: 6574 6865 7220 746f 2072 6570 6c61 6365  ether to replace
+00045460: 2061 2073 746f 7265 6420 7072 6f63 6564   a stored proced
+00045470: 7572 6520 7468 6174 2061 6c72 6561 6479  ure that already
+00045480: 2077 6173 2072 6567 6973 7465 7265 642e   was registered.
+00045490: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+000454a0: 6060 4661 6c73 6560 602e 0a20 2020 2020  ``False``..     
+000454b0: 2020 2020 2020 2049 6620 6974 2069 7320         If it is 
+000454c0: 6060 4661 6c73 6560 602c 2061 7474 656d  ``False``, attem
+000454d0: 7074 696e 6720 746f 2072 6567 6973 7465  pting to registe
+000454e0: 7220 6120 7374 6f72 6564 2070 726f 6365  r a stored proce
+000454f0: 6475 7265 2077 6974 6820 6120 6e61 6d65  dure with a name
+00045500: 2074 6861 7420 616c 7265 6164 7920 6578   that already ex
+00045510: 6973 7473 0a20 2020 2020 2020 2020 2020  ists.           
+00045520: 2072 6573 756c 7473 2069 6e20 6120 6060   results in a ``
+00045530: 536e 6f77 7061 726b 5351 4c45 7863 6570  SnowparkSQLExcep
+00045540: 7469 6f6e 6060 2065 7863 6570 7469 6f6e  tion`` exception
+00045550: 2062 6569 6e67 2074 6872 6f77 6e2e 2049   being thrown. I
+00045560: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
+00045570: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
+00045580: 2065 7869 7374 696e 6720 7374 6f72 6564   existing stored
+00045590: 2070 726f 6365 6475 7265 2077 6974 6820   procedure with 
+000455a0: 7468 6520 7361 6d65 206e 616d 6520 6973  the same name is
+000455b0: 206f 7665 7277 7269 7474 656e 2e0a 2020   overwritten..  
+000455c0: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
+000455d0: 7374 733a 2057 6865 7468 6572 2074 6f20  sts: Whether to 
+000455e0: 736b 6970 2063 7265 6174 696f 6e20 6f66  skip creation of
+000455f0: 2061 2073 746f 7265 6420 7072 6f63 6564   a stored proced
+00045600: 7572 6520 7468 6520 7361 6d65 2070 726f  ure the same pro
+00045610: 6365 6475 7265 2069 7320 616c 7265 6164  cedure is alread
+00045620: 7920 7265 6769 7374 6572 6564 2e0a 2020  y registered..  
+00045630: 2020 2020 2020 2020 2020 5468 6520 6465            The de
+00045640: 6661 756c 7420 6973 2060 6046 616c 7365  fault is ``False
+00045650: 6060 2e20 6060 6966 5f6e 6f74 5f65 7869  ``. ``if_not_exi
+00045660: 7374 7360 6020 616e 6420 6060 7265 706c  sts`` and ``repl
+00045670: 6163 6560 6020 6172 6520 6d75 7475 616c  ace`` are mutual
+00045680: 6c79 2065 7863 6c75 7369 7665 2061 6e64  ly exclusive and
+00045690: 2061 2060 6056 616c 7565 4572 726f 7260   a ``ValueError`
+000456a0: 600a 2020 2020 2020 2020 2020 2020 6973  `.            is
+000456b0: 2072 6169 7365 6420 7768 656e 2062 6f74   raised when bot
+000456c0: 6820 6172 6520 7365 742e 2049 6620 6974  h are set. If it
+000456d0: 2069 7320 6060 5472 7565 6060 2061 6e64   is ``True`` and
+000456e0: 2061 2073 746f 7265 6420 7072 6f63 6564   a stored proced
+000456f0: 7572 6520 6973 2061 6c72 6561 6479 2072  ure is already r
+00045700: 6567 6973 7465 7265 642c 2074 6865 2072  egistered, the r
+00045710: 6567 6973 7472 6174 696f 6e20 6973 2073  egistration is s
+00045720: 6b69 7070 6564 2e0a 2020 2020 2020 2020  kipped..        
+00045730: 7365 7373 696f 6e3a 2055 7365 2074 6869  session: Use thi
+00045740: 7320 7365 7373 696f 6e20 746f 2072 6567  s session to reg
+00045750: 6973 7465 7220 7468 6520 7374 6f72 6564  ister the stored
+00045760: 2070 726f 6365 6475 7265 2e20 4966 2069   procedure. If i
+00045770: 7427 7320 6e6f 7420 7370 6563 6966 6965  t's not specifie
+00045780: 642c 2074 6865 2073 6573 7369 6f6e 2074  d, the session t
+00045790: 6861 7420 796f 7520 6372 6561 7465 6420  hat you created 
+000457a0: 6265 666f 7265 2063 616c 6c69 6e67 2074  before calling t
+000457b0: 6869 7320 6675 6e63 7469 6f6e 2077 696c  his function wil
+000457c0: 6c20 6265 2075 7365 642e 0a20 2020 2020  l be used..     
+000457d0: 2020 2020 2020 2059 6f75 206e 6565 6420         You need 
+000457e0: 746f 2073 7065 6369 6679 2074 6869 7320  to specify this 
+000457f0: 7061 7261 6d65 7465 7220 6966 2079 6f75  parameter if you
+00045800: 2068 6176 6520 6372 6561 7465 6420 6d75   have created mu
+00045810: 6c74 6970 6c65 2073 6573 7369 6f6e 7320  ltiple sessions 
+00045820: 6265 666f 7265 2063 616c 6c69 6e67 2074  before calling t
+00045830: 6869 7320 6d65 7468 6f64 2e0a 2020 2020  his method..    
+00045840: 2020 2020 7061 7261 6c6c 656c 3a20 5468      parallel: Th
+00045850: 6520 6e75 6d62 6572 206f 6620 7468 7265  e number of thre
+00045860: 6164 7320 746f 2075 7365 2066 6f72 2075  ads to use for u
+00045870: 706c 6f61 6469 6e67 2073 746f 7265 6420  ploading stored 
+00045880: 7072 6f63 6564 7572 6520 6669 6c65 7320  procedure files 
+00045890: 7769 7468 2074 6865 0a20 2020 2020 2020  with the.       
+000458a0: 2020 2020 2060 5055 5420 3c68 7474 7073       `PUT <https
+000458b0: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+000458c0: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+000458d0: 6572 656e 6365 2f73 716c 2f70 7574 2e68  erence/sql/put.h
+000458e0: 746d 6c23 7075 743e 605f 0a20 2020 2020  tml#put>`_.     
+000458f0: 2020 2020 2020 2063 6f6d 6d61 6e64 2e20         command. 
+00045900: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+00045910: 6520 6973 2034 2061 6e64 2073 7570 706f  e is 4 and suppo
+00045920: 7274 6564 2076 616c 7565 7320 6172 6520  rted values are 
+00045930: 6672 6f6d 2031 2074 6f20 3939 2e0a 2020  from 1 to 99..  
+00045940: 2020 2020 2020 2020 2020 496e 6372 6561            Increa
+00045950: 7369 6e67 2074 6865 206e 756d 6265 7220  sing the number 
+00045960: 6f66 2074 6872 6561 6473 2063 616e 2069  of threads can i
+00045970: 6d70 726f 7665 2070 6572 666f 726d 616e  mprove performan
+00045980: 6365 2077 6865 6e20 7570 6c6f 6164 696e  ce when uploadin
+00045990: 670a 2020 2020 2020 2020 2020 2020 6c61  g.            la
+000459a0: 7267 6520 7374 6f72 6564 2070 726f 6365  rge stored proce
+000459b0: 6475 7265 2066 696c 6573 2e0a 2020 2020  dure files..    
+000459c0: 2020 2020 6578 6563 7574 655f 6173 3a20      execute_as: 
+000459d0: 5768 6174 2070 6572 6d69 7373 696f 6e73  What permissions
+000459e0: 2073 686f 756c 6420 7468 6520 7072 6f63   should the proc
+000459f0: 6564 7572 6520 6861 7665 2077 6869 6c65  edure have while
+00045a00: 2065 7865 6375 7469 6e67 2e20 5468 6973   executing. This
+00045a10: 0a20 2020 2020 2020 2020 2020 2073 7570  .            sup
+00045a20: 706f 7274 7320 6361 6c6c 6572 2c20 6f72  ports caller, or
+00045a30: 206f 776e 6572 2066 6f72 206e 6f77 2e20   owner for now. 
+00045a40: 5365 6520 606f 776e 6572 2061 6e64 2063  See `owner and c
+00045a50: 616c 6c65 7220 7269 6768 7473 203c 6874  aller rights <ht
+00045a60: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
+00045a70: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
+00045a80: 7265 6665 7265 6e63 652f 7374 6f72 6564  reference/stored
+00045a90: 2d70 726f 6365 6475 7265 732d 7269 6768  -procedures-righ
+00045aa0: 7473 2e68 746d 6c3e 605f 0a20 2020 2020  ts.html>`_.     
+00045ab0: 2020 2020 2020 2066 6f72 206d 6f72 6520         for more 
+00045ac0: 696e 666f 726d 6174 696f 6e2e 0a20 2020  information..   
+00045ad0: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
+00045ae0: 6172 616d 733a 2044 6963 7469 6f6e 6172  arams: Dictionar
+00045af0: 7920 6f66 2073 7461 7465 6d65 6e74 206c  y of statement l
+00045b00: 6576 656c 2070 6172 616d 6574 6572 7320  evel parameters 
+00045b10: 746f 2062 6520 7365 7420 7768 696c 6520  to be set while 
+00045b20: 6578 6563 7574 696e 6720 7468 6973 2061  executing this a
+00045b30: 6374 696f 6e2e 0a20 2020 2020 2020 2073  ction..        s
+00045b40: 7472 6963 743a 2057 6865 7468 6572 2074  trict: Whether t
+00045b50: 6865 2063 7265 6174 6564 2073 746f 7265  he created store
+00045b60: 6420 7072 6f63 6564 7572 6520 6973 2073  d procedure is s
+00045b70: 7472 6963 742e 2041 2073 7472 6963 7420  trict. A strict 
+00045b80: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+00045b90: 2077 696c 6c20 6e6f 7420 696e 766f 6b65   will not invoke
+00045ba0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00045bb0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+00045bc0: 6520 6966 2061 6e79 2069 6e70 7574 2069  e if any input i
+00045bd0: 7320 6e75 6c6c 2e20 496e 7374 6561 642c  s null. Instead,
+00045be0: 2061 206e 756c 6c20 7661 6c75 6520 7769   a null value wi
+00045bf0: 6c6c 2061 6c77 6179 7320 6265 2072 6574  ll always be ret
+00045c00: 7572 6e65 642e 204e 6f74 650a 2020 2020  urned. Note.    
+00045c10: 2020 2020 2020 2020 7468 6174 2074 6865          that the
+00045c20: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+00045c30: 6520 6d69 6768 7420 7374 696c 6c20 7265  e might still re
+00045c40: 7475 726e 206e 756c 6c20 666f 7220 6e6f  turn null for no
+00045c50: 6e2d 6e75 6c6c 2069 6e70 7574 732e 0a20  n-null inputs.. 
+00045c60: 2020 2020 2020 2073 6f75 7263 655f 636f         source_co
+00045c70: 6465 5f64 6973 706c 6179 3a20 4469 7370  de_display: Disp
+00045c80: 6c61 7920 7468 6520 736f 7572 6365 2063  lay the source c
+00045c90: 6f64 6520 6f66 2074 6865 2073 746f 7265  ode of the store
+00045ca0: 6420 7072 6f63 6564 7572 6520 6066 756e  d procedure `fun
+00045cb0: 6360 2061 7320 636f 6d6d 656e 7473 2069  c` as comments i
+00045cc0: 6e20 7468 6520 6765 6e65 7261 7465 6420  n the generated 
+00045cd0: 7363 7269 7074 2e0a 2020 2020 2020 2020  script..        
+00045ce0: 2020 2020 5468 6520 736f 7572 6365 2063      The source c
+00045cf0: 6f64 6520 6973 2064 796e 616d 6963 616c  ode is dynamical
+00045d00: 6c79 2067 656e 6572 6174 6564 2074 6865  ly generated the
+00045d10: 7265 666f 7265 2069 7420 6d61 7920 6e6f  refore it may no
+00045d20: 7420 6265 2069 6465 6e74 6963 616c 2074  t be identical t
+00045d30: 6f20 686f 7720 7468 650a 2020 2020 2020  o how the.      
+00045d40: 2020 2020 2020 6066 756e 6360 2069 7320        `func` is 
+00045d50: 6f72 6967 696e 616c 6c79 2064 6566 696e  originally defin
+00045d60: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
+00045d70: 6973 2060 6054 7275 6560 602e 0a20 2020  is ``True``..   
+00045d80: 2020 2020 2020 2020 2049 6620 6974 2069           If it i
+00045d90: 7320 6060 4661 6c73 6560 602c 2073 6f75  s ``False``, sou
+00045da0: 7263 6520 636f 6465 2077 696c 6c20 6e6f  rce code will no
+00045db0: 7420 6265 2067 656e 6572 6174 6564 206f  t be generated o
+00045dc0: 7220 6469 7370 6c61 7965 642e 0a0a 2020  r displayed...  
+00045dd0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00045de0: 2020 2041 2073 746f 7265 6420 7072 6f63     A stored proc
+00045df0: 6564 7572 6520 6675 6e63 7469 6f6e 2074  edure function t
+00045e00: 6861 7420 6361 6e20 6265 2063 616c 6c65  hat can be calle
+00045e10: 6420 7769 7468 2070 7974 686f 6e20 7661  d with python va
+00045e20: 6c75 652e 0a0a 2020 2020 4e6f 7465 3a0a  lue...    Note:.
+00045e30: 2020 2020 2020 2020 312e 2057 6865 6e20          1. When 
+00045e40: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
+00045e50: 726f 7669 6465 6420 616e 6420 6172 6520  rovided and are 
+00045e60: 636f 6d70 6c65 7465 2066 6f72 2061 2066  complete for a f
+00045e70: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
+00045e80: 2060 6072 6574 7572 6e5f 7479 7065 6060   ``return_type``
+00045e90: 2061 6e64 2060 6069 6e70 7574 5f74 7970   and ``input_typ
+00045ea0: 6573 6060 2061 7265 206f 7074 696f 6e61  es`` are optiona
+00045eb0: 6c20 616e 6420 7769 6c6c 2062 6520 6967  l and will be ig
+00045ec0: 6e6f 7265 642e 0a20 2020 2020 2020 2053  nored..        S
+00045ed0: 6565 2064 6574 6169 6c73 206f 6620 7375  ee details of su
+00045ee0: 7070 6f72 7465 6420 6461 7461 2074 7970  pported data typ
+00045ef0: 6573 2066 6f72 2073 746f 7265 6420 7072  es for stored pr
+00045f00: 6f63 6564 7572 6520 696e 0a20 2020 2020  ocedure in.     
+00045f10: 2020 203a 636c 6173 733a 607e 736e 6f77     :class:`~snow
+00045f20: 666c 616b 652e 736e 6f77 7061 726b 2e73  flake.snowpark.s
+00045f30: 746f 7265 645f 7072 6f63 6564 7572 652e  tored_procedure.
+00045f40: 5374 6f72 6564 5072 6f63 6564 7572 6552  StoredProcedureR
+00045f50: 6567 6973 7472 6174 696f 6e60 2e0a 0a20  egistration`... 
+00045f60: 2020 2020 2020 2020 2020 202d 2059 6f75             - You
+00045f70: 2063 616e 2075 7365 203a 6174 7472 3a60   can use :attr:`
+00045f80: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00045f90: 6172 6b2e 7479 7065 732e 5661 7269 616e  ark.types.Varian
+00045fa0: 7460 2074 6f0a 2020 2020 2020 2020 2020  t` to.          
+00045fb0: 2020 2020 616e 6e6f 7461 7465 2061 2076      annotate a v
+00045fc0: 6172 6961 6e74 2c20 616e 6420 7573 6520  ariant, and use 
+00045fd0: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
+00045fe0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00045ff0: 2e47 656f 6772 6170 6879 600a 2020 2020  .Geography`.    
+00046000: 2020 2020 2020 2020 2020 6f72 203a 6174            or :at
+00046010: 7472 3a60 7e73 6e6f 7766 6c61 6b65 2e73  tr:`~snowflake.s
+00046020: 6e6f 7770 6172 6b2e 7479 7065 732e 4765  nowpark.types.Ge
+00046030: 6f6d 6574 7279 6020 746f 2061 6e6e 6f74  ometry` to annot
+00046040: 6174 6520 6765 6f73 7061 7469 616c 0a20  ate geospatial. 
+00046050: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+00046060: 6573 2077 6865 6e20 6465 6669 6e69 6e67  es when defining
+00046070: 2061 2073 746f 7265 6420 7072 6f63 6564   a stored proced
+00046080: 7572 652e 0a0a 2020 2020 2020 2020 2020  ure...          
+00046090: 2020 2d20 3a63 6c61 7373 3a60 7479 7069    - :class:`typi
+000460a0: 6e67 2e55 6e69 6f6e 6020 6973 206e 6f74  ng.Union` is not
+000460b0: 2061 2076 616c 6964 2074 7970 6520 616e   a valid type an
+000460c0: 6e6f 7461 7469 6f6e 2066 6f72 2073 746f  notation for sto
+000460d0: 7265 6420 7072 6f63 6564 7572 6573 2c0a  red procedures,.
+000460e0: 2020 2020 2020 2020 2020 2020 2020 6275                bu
+000460f0: 7420 3a63 6c61 7373 3a60 7479 7069 6e67  t :class:`typing
+00046100: 2e4f 7074 696f 6e61 6c60 2063 616e 2062  .Optional` can b
+00046110: 6520 7573 6564 2074 6f20 696e 6469 6361  e used to indica
+00046120: 7465 2074 6865 206f 7074 696f 6e61 6c20  te the optional 
+00046130: 7479 7065 2e0a 0a20 2020 2020 2020 2032  type...        2
+00046140: 2e20 4120 7465 6d70 6f72 6172 7920 7374  . A temporary st
+00046150: 6f72 6564 2070 726f 6365 6475 7265 2028  ored procedure (
+00046160: 7768 656e 2060 6069 735f 7065 726d 616e  when ``is_perman
+00046170: 656e 7460 6020 6973 2060 6046 616c 7365  ent`` is ``False
+00046180: 6060 2920 6973 2073 636f 7065 6420 746f  ``) is scoped to
+00046190: 2074 6869 7320 6060 7365 7373 696f 6e60   this ``session`
+000461a0: 600a 2020 2020 2020 2020 616e 6420 616c  `.        and al
+000461b0: 6c20 7374 6f72 6564 2070 726f 6365 6475  l stored procedu
+000461c0: 7265 2072 656c 6174 6564 2066 696c 6573  re related files
+000461d0: 2077 696c 6c20 6265 2075 706c 6f61 6465   will be uploade
+000461e0: 6420 746f 2061 2074 656d 706f 7261 7279  d to a temporary
+000461f0: 2073 6573 7369 6f6e 2073 7461 6765 0a20   session stage. 
+00046200: 2020 2020 2020 2028 3a66 756e 633a 6073         (:func:`s
+00046210: 6573 7369 6f6e 2e67 6574 5f73 6573 7369  ession.get_sessi
+00046220: 6f6e 5f73 7461 6765 2829 203c 736e 6f77  on_stage() <snow
+00046230: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
+00046240: 6573 7369 6f6e 2e67 6574 5f73 6573 7369  ession.get_sessi
+00046250: 6f6e 5f73 7461 6765 3e60 292e 0a20 2020  on_stage>`)..   
+00046260: 2020 2020 2046 6f72 2061 2070 6572 6d61       For a perma
+00046270: 6e65 6e74 2073 746f 7265 6420 7072 6f63  nent stored proc
+00046280: 6564 7572 652c 2074 6865 7365 2066 696c  edure, these fil
+00046290: 6573 2077 696c 6c20 6265 2075 706c 6f61  es will be uploa
+000462a0: 6465 6420 746f 2074 6865 2073 7461 6765  ded to the stage
+000462b0: 2074 6861 7420 796f 7520 7072 6f76 6964   that you provid
+000462c0: 652e 0a0a 2020 2020 2020 2020 332e 2042  e...        3. B
+000462d0: 7920 6465 6661 756c 742c 2073 746f 7265  y default, store
+000462e0: 6420 7072 6f63 6564 7572 6520 7265 6769  d procedure regi
+000462f0: 7374 7261 7469 6f6e 2066 6169 6c73 2069  stration fails i
+00046300: 6620 6120 6675 6e63 7469 6f6e 2077 6974  f a function wit
+00046310: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+00046320: 6973 2061 6c72 6561 6479 0a20 2020 2020  is already.     
+00046330: 2020 2072 6567 6973 7465 7265 642e 2049     registered. I
+00046340: 6e76 6f6b 696e 6720 3a66 756e 633a 6073  nvoking :func:`s
+00046350: 7072 6f63 6020 7769 7468 2060 6072 6570  proc` with ``rep
+00046360: 6c61 6365 6060 2073 6574 2074 6f20 6060  lace`` set to ``
+00046370: 5472 7565 6060 2077 696c 6c20 6f76 6572  True`` will over
+00046380: 7772 6974 6520 7468 650a 2020 2020 2020  write the.      
+00046390: 2020 7072 6576 696f 7573 6c79 2072 6567    previously reg
+000463a0: 6973 7465 7265 6420 6675 6e63 7469 6f6e  istered function
+000463b0: 2e0a 0a20 2020 2020 2020 2034 2e20 546f  ...        4. To
+000463c0: 2064 6573 6372 6962 6520 7468 6520 7265   describe the re
+000463d0: 7475 726e 2074 7970 6520 666f 7220 6120  turn type for a 
+000463e0: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+000463f0: 2074 6861 7420 6072 6574 7572 6e73 2074   that `returns t
+00046400: 6162 756c 6172 2064 6174 610a 2020 2020  abular data.    
+00046410: 2020 2020 3c68 7474 7073 3a2f 2f64 6f63      <https://doc
+00046420: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
+00046430: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
+00046440: 2f73 746f 7265 642d 7072 6f63 6564 7572  /stored-procedur
+00046450: 6573 2d70 7974 686f 6e23 7265 7475 726e  es-python#return
+00046460: 696e 672d 7461 6275 6c61 722d 6461 7461  ing-tabular-data
+00046470: 3e60 5f2c 0a20 2020 2020 2020 2075 7365  >`_,.        use
+00046480: 206f 6e65 206f 6620 7468 6520 666f 6c6c   one of the foll
+00046490: 6f77 696e 6720 7761 7973 3a0a 0a20 2020  owing ways:..   
+000464a0: 2020 2020 2020 2020 202d 2028 5265 636f           - (Reco
+000464b0: 6d6d 656e 6465 6429 2044 6573 6372 6962  mmended) Describ
+000464c0: 6520 7468 6520 7265 7475 726e 2074 7970  e the return typ
+000464d0: 6520 7573 696e 6720 3a61 7474 723a 607e  e using :attr:`~
+000464e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000464f0: 726b 2e74 7970 6573 2e53 7472 7563 7454  rk.types.StructT
+00046500: 7970 6560 0a20 2020 2020 2020 2020 2020  ype`.           
+00046510: 2020 2061 6e64 203a 6174 7472 3a60 7e73     and :attr:`~s
+00046520: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00046530: 6b2e 7479 7065 732e 5374 7275 6374 4669  k.types.StructFi
+00046540: 656c 6460 2e20 5365 7420 6060 7265 7475  eld`. Set ``retu
+00046550: 726e 5f74 7970 6520 3d0a 2020 2020 2020  rn_type =.      
+00046560: 2020 2020 2020 2020 5374 7275 6374 5479          StructTy
+00046570: 7065 285b 5374 7275 6374 4669 656c 6428  pe([StructField(
+00046580: 2261 222c 2044 6174 6154 7970 6541 2829  "a", DataTypeA()
+00046590: 292c 202e 2e2e 5d29 6060 2074 6f20 6465  ), ...])`` to de
+000465a0: 7363 7269 6265 2074 6865 2063 6173 650a  scribe the case.
+000465b0: 2020 2020 2020 2020 2020 2020 2020 6060                ``
+000465c0: 5245 5455 524e 5320 5441 424c 4528 4120  RETURNS TABLE(A 
+000465d0: 4461 7461 5479 7065 412c 202e 2e2e 2960  DataTypeA, ...)`
+000465e0: 602e 0a0a 2020 2020 2020 2020 2020 2020  `...            
+000465f0: 2d20 5365 7420 6060 7265 7475 726e 5f74  - Set ``return_t
+00046600: 7970 6520 3d20 5374 7275 6374 5479 7065  ype = StructType
+00046610: 2829 6060 2074 6f20 6465 7363 7269 6265  ()`` to describe
+00046620: 2074 6865 2063 6173 6520 6060 5245 5455   the case ``RETU
+00046630: 524e 5320 5441 424c 4528 2960 602e 0a0a  RNS TABLE()``...
+00046640: 2020 2020 2020 2020 2020 2020 2d20 5768              - Wh
+00046650: 656e 2075 7369 6e67 2074 7970 6520 6869  en using type hi
+00046660: 6e74 732c 2074 6865 2072 6574 7572 6e20  nts, the return 
+00046670: 7479 7065 206f 6620 6675 6e63 7469 6f6e  type of function
+00046680: 2063 616e 2062 6520 7365 7420 6173 0a20   can be set as. 
+00046690: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+000466a0: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
+000466b0: 736e 6f77 7061 726b 2e64 6174 6166 7261  snowpark.datafra
+000466c0: 6d65 2e44 6174 6146 7261 6d65 602e 2054  me.DataFrame`. T
+000466d0: 6869 7320 7265 6769 7374 6572 7320 610a  his registers a.
+000466e0: 2020 2020 2020 2020 2020 2020 2020 7461                ta
+000466f0: 626c 6520 7374 6f72 6564 2070 726f 6365  ble stored proce
+00046700: 6475 7265 2077 6974 6820 7265 7475 726e  dure with return
+00046710: 2074 7970 6520 6465 6669 6e65 6420 7573   type defined us
+00046720: 696e 6720 6060 5245 5455 524e 5320 5441  ing ``RETURNS TA
+00046730: 424c 4528 2960 602e 0a20 2020 2020 2020  BLE()``..       
+00046740: 2020 2020 2020 2043 6865 636b 202a 2a53         Check **S
+00046750: 6565 2061 6c73 6f2a 2a20 6265 6c6f 7720  ee also** below 
+00046760: 666f 7220 6d6f 7265 2065 7861 6d70 6c65  for more example
+00046770: 732e 0a0a 2020 2020 5365 6520 416c 736f  s...    See Also
+00046780: 3a0a 2020 2020 2020 2020 3a63 6c61 7373  :.        :class
+00046790: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+000467a0: 7770 6172 6b2e 7374 6f72 6564 5f70 726f  wpark.stored_pro
+000467b0: 6365 6475 7265 2e53 746f 7265 6450 726f  cedure.StoredPro
+000467c0: 6365 6475 7265 5265 6769 7374 7261 7469  cedureRegistrati
+000467d0: 6f6e 600a 0a20 2020 2045 7861 6d70 6c65  on`..    Example
+000467e0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+000467f0: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00046800: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+00046810: 6f72 7420 496e 7465 6765 7254 7970 650a  ort IntegerType.
+00046820: 2020 2020 2020 2020 3e3e 3e20 4073 7072          >>> @spr
+00046830: 6f63 2872 6574 7572 6e5f 7479 7065 3d49  oc(return_type=I
+00046840: 6e74 6567 6572 5479 7065 2829 2c20 696e  ntegerType(), in
+00046850: 7075 745f 7479 7065 733d 5b49 6e74 6567  put_types=[Integ
+00046860: 6572 5479 7065 2829 2c20 496e 7465 6765  erType(), Intege
+00046870: 7254 7970 6528 295d 2c20 7061 636b 6167  rType()], packag
+00046880: 6573 3d5b 2273 6e6f 7766 6c61 6b65 2d73  es=["snowflake-s
+00046890: 6e6f 7770 6172 6b2d 7079 7468 6f6e 225d  nowpark-python"]
+000468a0: 290a 2020 2020 2020 2020 2e2e 2e20 6465  ).        ... de
+000468b0: 6620 6164 645f 7370 2873 6573 7369 6f6e  f add_sp(session
+000468c0: 5f2c 2078 2c20 7929 3a0a 2020 2020 2020  _, x, y):.      
+000468d0: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+000468e0: 2073 6573 7369 6f6e 5f2e 7371 6c28 6622   session_.sql(f"
+000468f0: 5345 4c45 4354 207b 787d 202b 207b 797d  SELECT {x} + {y}
+00046900: 2229 2e63 6f6c 6c65 6374 2829 5b30 5d5b  ").collect()[0][
+00046910: 305d 0a20 2020 2020 2020 202e 2e2e 0a20  0].        .... 
+00046920: 2020 2020 2020 203e 3e3e 2061 6464 5f73         >>> add_s
+00046930: 7028 312c 2031 290a 2020 2020 2020 2020  p(1, 1).        
+00046940: 320a 2020 2020 2222 220a 2020 2020 7365  2.    """.    se
+00046950: 7373 696f 6e20 3d20 7365 7373 696f 6e20  ssion = session 
+00046960: 6f72 2073 6e6f 7766 6c61 6b65 2e73 6e6f  or snowflake.sno
+00046970: 7770 6172 6b2e 7365 7373 696f 6e2e 5f67  wpark.session._g
+00046980: 6574 5f61 6374 6976 655f 7365 7373 696f  et_active_sessio
+00046990: 6e28 290a 2020 2020 6966 2066 756e 6320  n().    if func 
+000469a0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000469b0: 2072 6574 7572 6e20 6675 6e63 746f 6f6c   return functool
+000469c0: 732e 7061 7274 6961 6c28 0a20 2020 2020  s.partial(.     
+000469d0: 2020 2020 2020 2073 6573 7369 6f6e 2e73         session.s
+000469e0: 7072 6f63 2e72 6567 6973 7465 722c 0a20  proc.register,. 
+000469f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00046a00: 6e5f 7479 7065 3d72 6574 7572 6e5f 7479  n_type=return_ty
+00046a10: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00046a20: 696e 7075 745f 7479 7065 733d 696e 7075  input_types=inpu
+00046a30: 745f 7479 7065 732c 0a20 2020 2020 2020  t_types,.       
+00046a40: 2020 2020 206e 616d 653d 6e61 6d65 2c0a       name=name,.
+00046a50: 2020 2020 2020 2020 2020 2020 6973 5f70              is_p
+00046a60: 6572 6d61 6e65 6e74 3d69 735f 7065 726d  ermanent=is_perm
+00046a70: 616e 656e 742c 0a20 2020 2020 2020 2020  anent,.         
+00046a80: 2020 2073 7461 6765 5f6c 6f63 6174 696f     stage_locatio
+00046a90: 6e3d 7374 6167 655f 6c6f 6361 7469 6f6e  n=stage_location
+00046aa0: 2c0a 2020 2020 2020 2020 2020 2020 696d  ,.            im
+00046ab0: 706f 7274 733d 696d 706f 7274 732c 0a20  ports=imports,. 
+00046ac0: 2020 2020 2020 2020 2020 2070 6163 6b61             packa
+00046ad0: 6765 733d 7061 636b 6167 6573 2c0a 2020  ges=packages,.  
+00046ae0: 2020 2020 2020 2020 2020 7265 706c 6163            replac
+00046af0: 653d 7265 706c 6163 652c 0a20 2020 2020  e=replace,.     
+00046b00: 2020 2020 2020 2069 665f 6e6f 745f 6578         if_not_ex
+00046b10: 6973 7473 3d69 665f 6e6f 745f 6578 6973  ists=if_not_exis
+00046b20: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00046b30: 7061 7261 6c6c 656c 3d70 6172 616c 6c65  parallel=paralle
+00046b40: 6c2c 0a20 2020 2020 2020 2020 2020 2073  l,.            s
+00046b50: 7461 7465 6d65 6e74 5f70 6172 616d 733d  tatement_params=
+00046b60: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
+00046b70: 2c0a 2020 2020 2020 2020 2020 2020 6578  ,.            ex
+00046b80: 6563 7574 655f 6173 3d65 7865 6375 7465  ecute_as=execute
+00046b90: 5f61 732c 0a20 2020 2020 2020 2020 2020  _as,.           
+00046ba0: 2073 7472 6963 743d 7374 7269 6374 2c0a   strict=strict,.
+00046bb0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00046bc0: 6365 5f63 6f64 655f 6469 7370 6c61 793d  ce_code_display=
+00046bd0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
+00046be0: 6c61 792c 0a20 2020 2020 2020 2020 2020  lay,.           
+00046bf0: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
+00046c00: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
+00046c10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00046c20: 7373 696f 6e2e 7370 726f 632e 7265 6769  ssion.sproc.regi
+00046c30: 7374 6572 280a 2020 2020 2020 2020 2020  ster(.          
+00046c40: 2020 6675 6e63 2c0a 2020 2020 2020 2020    func,.        
+00046c50: 2020 2020 7265 7475 726e 5f74 7970 653d      return_type=
+00046c60: 7265 7475 726e 5f74 7970 652c 0a20 2020  return_type,.   
+00046c70: 2020 2020 2020 2020 2069 6e70 7574 5f74           input_t
+00046c80: 7970 6573 3d69 6e70 7574 5f74 7970 6573  ypes=input_types
+00046c90: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+00046ca0: 6d65 3d6e 616d 652c 0a20 2020 2020 2020  me=name,.       
+00046cb0: 2020 2020 2069 735f 7065 726d 616e 656e       is_permanen
+00046cc0: 743d 6973 5f70 6572 6d61 6e65 6e74 2c0a  t=is_permanent,.
+00046cd0: 2020 2020 2020 2020 2020 2020 7374 6167              stag
+00046ce0: 655f 6c6f 6361 7469 6f6e 3d73 7461 6765  e_location=stage
+00046cf0: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
+00046d00: 2020 2020 2020 2069 6d70 6f72 7473 3d69         imports=i
+00046d10: 6d70 6f72 7473 2c0a 2020 2020 2020 2020  mports,.        
+00046d20: 2020 2020 7061 636b 6167 6573 3d70 6163      packages=pac
+00046d30: 6b61 6765 732c 0a20 2020 2020 2020 2020  kages,.         
+00046d40: 2020 2072 6570 6c61 6365 3d72 6570 6c61     replace=repla
+00046d50: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+00046d60: 6966 5f6e 6f74 5f65 7869 7374 733d 6966  if_not_exists=if
+00046d70: 5f6e 6f74 5f65 7869 7374 732c 0a20 2020  _not_exists,.   
+00046d80: 2020 2020 2020 2020 2070 6172 616c 6c65           paralle
+00046d90: 6c3d 7061 7261 6c6c 656c 2c0a 2020 2020  l=parallel,.    
+00046da0: 2020 2020 2020 2020 7374 6174 656d 656e          statemen
+00046db0: 745f 7061 7261 6d73 3d73 7461 7465 6d65  t_params=stateme
+00046dc0: 6e74 5f70 6172 616d 732c 0a20 2020 2020  nt_params,.     
+00046dd0: 2020 2020 2020 2065 7865 6375 7465 5f61         execute_a
+00046de0: 733d 6578 6563 7574 655f 6173 2c0a 2020  s=execute_as,.  
+00046df0: 2020 2020 2020 2020 2020 7374 7269 6374            strict
+00046e00: 3d73 7472 6963 742c 0a20 2020 2020 2020  =strict,.       
+00046e10: 2020 2020 2073 6f75 7263 655f 636f 6465       source_code
+00046e20: 5f64 6973 706c 6179 3d73 6f75 7263 655f  _display=source_
+00046e30: 636f 6465 5f64 6973 706c 6179 2c0a 2020  code_display,.  
+00046e40: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
+00046e50: 6773 2c0a 2020 2020 2020 2020 290a 0a0a  gs,.        )...
+00046e60: 2320 4164 6420 7468 6573 6520 616c 6961  # Add these alia
+00046e70: 7320 666f 7220 7573 6572 2063 6f64 6520  s for user code 
+00046e80: 6d69 6772 6174 696f 6e0a 6361 6c6c 5f62  migration.call_b
+00046e90: 7569 6c74 696e 203d 2063 616c 6c5f 6675  uiltin = call_fu
+00046ea0: 6e63 7469 6f6e 0a63 6f6c 6c65 6374 5f73  nction.collect_s
+00046eb0: 6574 203d 2061 7272 6179 5f75 6e69 7175  et = array_uniqu
+00046ec0: 655f 6167 670a 6275 696c 7469 6e20 3d20  e_agg.builtin = 
+00046ed0: 6675 6e63 7469 6f6e 0a63 6f75 6e74 4469  function.countDi
+00046ee0: 7374 696e 6374 203d 2063 6f75 6e74 5f64  stinct = count_d
+00046ef0: 6973 7469 6e63 740a 7375 6273 7472 203d  istinct.substr =
+00046f00: 2073 7562 7374 7269 6e67 0a74 6f5f 7661   substring.to_va
+00046f10: 7263 6861 7220 3d20 746f 5f63 6861 720a  rchar = to_char.
+00046f20: 6578 7072 203d 2073 716c 5f65 7870 720a  expr = sql_expr.
+00046f30: 6461 7465 5f66 6f72 6d61 7420 3d20 746f  date_format = to
+00046f40: 5f64 6174 650a 6d6f 6e6f 746f 6e69 6361  _date.monotonica
+00046f50: 6c6c 795f 696e 6372 6561 7369 6e67 5f69  lly_increasing_i
+00046f60: 6420 3d20 7365 7138 0a66 726f 6d5f 756e  d = seq8.from_un
+00046f70: 6978 7469 6d65 203d 2074 6f5f 7469 6d65  ixtime = to_time
+00046f80: 7374 616d 700a 736f 7274 5f61 7272 6179  stamp.sort_array
+00046f90: 203d 2061 7272 6179 5f73 6f72 740a 0a0a   = array_sort...
+00046fa0: 6465 6620 756e 6978 5f74 696d 6573 7461  def unix_timesta
+00046fb0: 6d70 2865 3a20 436f 6c75 6d6e 4f72 4e61  mp(e: ColumnOrNa
+00046fc0: 6d65 2c20 666d 743a 204f 7074 696f 6e61  me, fmt: Optiona
+00046fd0: 6c5b 2243 6f6c 756d 6e22 5d20 3d20 4e6f  l["Column"] = No
+00046fe0: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00046ff0: 2020 2022 2222 0a20 2020 2043 6f6e 7665     """.    Conve
+00047000: 7274 7320 6120 7469 6d65 7374 616d 7020  rts a timestamp 
+00047010: 6f72 2061 2074 696d 6573 7461 6d70 2073  or a timestamp s
+00047020: 7472 696e 6720 746f 2055 6e69 7820 7469  tring to Unix ti
+00047030: 6d65 2073 7461 6d70 2028 696e 2073 6563  me stamp (in sec
+00047040: 6f6e 6473 292e 0a0a 2020 2020 4578 616d  onds)...    Exam
+00047050: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00047060: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00047070: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00047080: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00047090: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
+000470a0: 3230 3133 2d30 352d 3038 5432 333a 3339  2013-05-08T23:39
+000470b0: 3a32 302e 3132 332d 3037 3a30 3022 5d5d  :20.123-07:00"]]
+000470c0: 2c20 7363 6865 6d61 3d5b 2274 735f 636f  , schema=["ts_co
+000470d0: 6c22 5d29 0a20 2020 2020 2020 203e 3e3e  l"]).        >>>
+000470e0: 2064 662e 7365 6c65 6374 2875 6e69 785f   df.select(unix_
+000470f0: 7469 6d65 7374 616d 7028 636f 6c28 2274  timestamp(col("t
+00047100: 735f 636f 6c22 2929 2e61 6c69 6173 2822  s_col")).alias("
+00047110: 756e 6978 5f74 696d 6522 2929 2e73 686f  unix_time")).sho
+00047120: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00047130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00047140: 2020 2020 7c22 554e 4958 5f54 494d 4522      |"UNIX_TIME"
+00047150: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00047160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00047170: 2020 2020 7c31 3336 3830 3536 3336 3020      |1368056360 
+00047180: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00047190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000471a0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+000471b0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+000471c0: 726e 2064 6174 655f 7061 7274 2822 6570  rn date_part("ep
+000471d0: 6f63 685f 7365 636f 6e64 222c 2074 6f5f  och_second", to_
+000471e0: 7469 6d65 7374 616d 7028 652c 2066 6d74  timestamp(e, fmt
+000471f0: 2929 0a                                  )).
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/query_history.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/query_history.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/relational_grouped_dataframe.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/relational_grouped_dataframe.py`

 * *Files 0% similar despite different names*

```diff
@@ -5,14 +5,15 @@
 from typing import Callable, Dict, List, Tuple, Union
 
 from snowflake.snowpark import functions
 from snowflake.snowpark._internal.analyzer.expression import (
     Expression,
     Literal,
     NamedExpression,
+    SnowflakeUDF,
     UnresolvedAttribute,
 )
 from snowflake.snowpark._internal.analyzer.grouping_set import (
     Cube,
     GroupingSetsExpression,
     Rollup,
 )
@@ -32,30 +33,30 @@
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.dataframe import DataFrame
 
 
 def _alias(expr: Expression) -> NamedExpression:
     if isinstance(expr, UnresolvedAttribute):
         return UnresolvedAlias(expr)
-    elif isinstance(expr, NamedExpression):
+    elif isinstance(expr, (NamedExpression, SnowflakeUDF)):
         return expr
     else:
         return Alias(expr, expr.sql.upper().replace('"', ""))
 
 
 def _expr_to_func(expr: str, input_expr: Expression) -> Expression:
     lowered = expr.lower()
     if lowered in ["avg", "average", "mean"]:
         return functions.avg(Column(input_expr))._expression
     elif lowered in ["stddev", "std"]:
         return functions.stddev(Column(input_expr))._expression
     elif lowered in ["count", "size"]:
         return functions.count(Column(input_expr))._expression
     else:
-        return functions.function(lowered)(input_expr)._expression
+        return functions.function(expr)(input_expr)._expression
 
 
 def _str_to_expr(expr: str) -> Callable:
     return lambda input_expr: _expr_to_func(expr, input_expr)
 
 
 class _GroupType:
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/row.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/row.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/session.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/session.py`

 * *Files 13% similar despite different names*

```diff
@@ -4,27 +4,28 @@
 #
 
 import datetime
 import decimal
 import json
 import logging
 import os
+import platform
 import sys
+import tempfile
 from array import array
 from functools import reduce
 from logging import getLogger
 from threading import RLock
 from types import ModuleType
 from typing import Any, Dict, List, Literal, Optional, Sequence, Set, Tuple, Union
 
 import cloudpickle
 import pkg_resources
 
 from snowflake.connector import ProgrammingError, SnowflakeConnection
-from snowflake.connector.errors import MissingDependencyError
 from snowflake.connector.options import installed_pandas, pandas
 from snowflake.connector.pandas_tools import write_pandas
 from snowflake.snowpark._internal.analyzer.analyzer import Analyzer
 from snowflake.snowpark._internal.analyzer.analyzer_utils import (
     escape_quotes,
     quote_name,
 )
@@ -43,14 +44,27 @@
 )
 from snowflake.snowpark._internal.analyzer.table_function import (
     FlattenFunction,
     GeneratorTableFunction,
     TableFunctionRelation,
 )
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
+from snowflake.snowpark._internal.packaging_utils import (
+    ENVIRONMENT_METADATA_FILE_NAME,
+    IMPLICIT_ZIP_FILE_NAME,
+    delete_files_belonging_to_packages,
+    detect_native_dependencies,
+    get_signature,
+    identify_supported_packages,
+    map_python_packages_to_files_and_folders,
+    parse_conda_environment_yaml_file,
+    parse_requirements_text_file,
+    pip_install_packages_to_target_folder,
+    zip_directory_contents,
+)
 from snowflake.snowpark._internal.server_connection import ServerConnection
 from snowflake.snowpark._internal.telemetry import set_api_call_source
 from snowflake.snowpark._internal.type_utils import (
     ColumnOrName,
     convert_sp_to_sf_type,
     infer_schema,
     infer_type,
@@ -61,23 +75,26 @@
     MODULE_NAME_TO_PACKAGE_NAME_MAP,
     STAGE_PREFIX,
     SUPPORTED_TABLE_TYPES,
     PythonObjJSONEncoder,
     TempObjectType,
     calculate_checksum,
     deprecated,
+    experimental_parameter,
     get_connector_version,
     get_os_name,
     get_python_version,
     get_stage_file_prefix_length,
     get_temp_type_for_object,
     get_version,
     is_in_stored_procedure,
+    normalize_local_file,
     normalize_remote_file_or_dir,
     parse_positional_args_to_list,
+    private_preview,
     random_name_for_temp_object,
     strip_double_quotes_in_like_statement_in_table_name,
     unwrap_single_quote,
     unwrap_stage_location_single_quote,
     validate_object_name,
     warning,
     zip_file_or_directory_to_stream,
@@ -87,22 +104,24 @@
 from snowflake.snowpark.context import _use_scoped_temp_objects
 from snowflake.snowpark.dataframe import DataFrame
 from snowflake.snowpark.dataframe_reader import DataFrameReader
 from snowflake.snowpark.exceptions import SnowparkClientException
 from snowflake.snowpark.file_operation import FileOperation
 from snowflake.snowpark.functions import (
     array_agg,
+    builtin,
     col,
     column,
     lit,
     parse_json,
     to_array,
     to_date,
     to_decimal,
     to_geography,
+    to_geometry,
     to_object,
     to_time,
     to_timestamp,
     to_variant,
 )
 from snowflake.snowpark.query_history import QueryHistory
 from snowflake.snowpark.row import Row
@@ -113,22 +132,25 @@
     _create_table_function_expression,
 )
 from snowflake.snowpark.types import (
     ArrayType,
     DateType,
     DecimalType,
     GeographyType,
+    GeometryType,
     MapType,
     StringType,
     StructType,
+    TimestampTimeZone,
     TimestampType,
     TimeType,
     VariantType,
     _AtomicType,
 )
+from snowflake.snowpark.udaf import UDAFRegistration
 from snowflake.snowpark.udf import UDFRegistration
 from snowflake.snowpark.udtf import UDTFRegistration
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
 if sys.version_info <= (3, 9):
@@ -343,14 +365,15 @@
 "python.connector.session.id" : {self._session_id},
 "os.name" : {get_os_name()}
 """
         self._session_stage = random_name_for_temp_object(TempObjectType.STAGE)
         self._stage_created = False
         self._udf_registration = UDFRegistration(self)
         self._udtf_registration = UDTFRegistration(self)
+        self._udaf_registration = UDAFRegistration(self)
         self._sp_registration = StoredProcedureRegistration(self)
         self._plan_builder = SnowflakePlanBuilder(self)
         self._last_action_id = 0
         self._last_canceled_id = 0
         self._use_scoped_temp_objects: bool = (
             _use_scoped_temp_objects
             and self._get_client_side_session_parameter(
@@ -358,15 +381,18 @@
             )
         )
         self._file = FileOperation(self)
         self._analyzer = Analyzer(self)
         self._sql_simplifier_enabled: bool = self._get_client_side_session_parameter(
             _PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER_STRING, True
         )
+        self._custom_package_usage_config: Dict = {}
         self._conf = self.RuntimeConfig(self, options or {})
+        self._tmpdir_handler: Optional[tempfile.TemporaryDirectory] = None
+        self._runtime_version_from_requirement: str = None
 
         _logger.info("Snowpark Session information: %s", self._session_info)
 
     def __enter__(self):
         return self
 
     def __exit__(self, exc_type, exc_val, exc_tb):
@@ -407,31 +433,76 @@
 
     @property
     def conf(self) -> RuntimeConfig:
         return self._conf
 
     @property
     def sql_simplifier_enabled(self) -> bool:
+        """Set to ``True`` to use the SQL simplifier (defaults to ``True``).
+        The generated SQLs from ``DataFrame`` transformations would have fewer layers of nested queries if the SQL simplifier is enabled."""
         return self._sql_simplifier_enabled
 
+    @property
+    def custom_package_usage_config(self) -> Dict:
+        """Get or set configuration parameters related to usage of custom Python packages in Snowflake.
+
+        If enabled, pure Python packages that are not available in Snowflake will be installed locally via pip and made available
+        as an import (see :func:`add_import` for more information on imports). You can speed up this process by mentioning
+        a remote stage path as ``cache_path`` where unsupported pure Python packages will be persisted. To use a specific
+        version of pip, you can set the environment variable ``PIP_PATH`` to point to your pip executable. To use custom
+        Python packages which are not purely Python, specify the ``force_push`` configuration parameter (*note that using
+        non-pure Python packages is not recommended!*).
+
+        This feature is **experimental** and works well on **UNIX systems only**, please do not use it in production!
+
+        Configurations:
+            - **enabled** (*bool*): Turn on usage of custom pure Python packages.
+            - **force_push** (*bool*): Use Python packages regardless of whether the packages are pure Python or not.
+            - **cache_path** (*str*): Cache custom Python packages on a stage directory. This parameter greatly reduces latency of custom package import.
+            - **force_cache** (*bool*): Use this parameter if you specified a ``cache_path`` but wish to create a fresh cache of your environment.
+
+        Args:
+            config (dict): Dictionary containing configuration parameters mentioned above (defaults to empty dictionary).
+
+        Example::
+
+            >>> from snowflake.snowpark.functions import udf
+            >>> session.custom_package_usage_config = {"enabled": True, "cache_path": "@my_permanent_stage/folder"} # doctest: +SKIP
+            >>> session.add_packages("package_unavailable_in_snowflake") # doctest: +SKIP
+            >>> @udf
+            ... def use_my_custom_package() -> str:
+            ...     import package_unavailable_in_snowflake
+            ...     return "works"
+            >>> session.clear_packages()
+            >>> session.clear_imports()
+
+        Note:
+            - These configurations allow custom package addition via :func:`Session.add_requirements` and :func:`Session.add_packages`.
+            - These configurations also allow custom package addition for all UDFs or stored procedures created later in the current session. If you only want to add custom packages for a specific UDF, you can use ``packages`` argument in :func:`functions.udf` or :meth:`session.udf.register() <snowflake.snowpark.udf.UDFRegistration.register>`.
+        """
+        return self._custom_package_usage_config
+
     @sql_simplifier_enabled.setter
     def sql_simplifier_enabled(self, value: bool) -> None:
-        """Set to ``True`` to use the SQL simplifier.
-        The generated SQLs from ``DataFrame`` transformations would have fewer layers of nested queries if the SQL simplifier is enabled."""
         self._conn._telemetry_client.send_sql_simplifier_telemetry(
             self._session_id, value
         )
         try:
             self._conn._cursor.execute(
                 f"alter session set {_PYTHON_SNOWPARK_USE_SQL_SIMPLIFIER_STRING} = {value}"
             )
         except Exception:
             pass
         self._sql_simplifier_enabled = value
 
+    @custom_package_usage_config.setter
+    @experimental_parameter(version="1.6.0")
+    def custom_package_usage_config(self, config: Dict) -> None:
+        self._custom_package_usage_config = {k.lower(): v for k, v in config.items()}
+
     def cancel_all(self) -> None:
         """
         Cancel all action methods that are running currently.
         This does not affect any action methods called in the future.
         """
         _logger.info("Canceling all running queries")
         self._last_canceled_id = self._last_action_id
@@ -701,14 +772,16 @@
         """
         Adds third-party packages as dependencies of a user-defined function (UDF).
         Use this method to add packages for UDFs as installing packages using
         `conda <https://docs.conda.io/en/latest/>`_. You can also find examples in
         :class:`~snowflake.snowpark.udf.UDFRegistration`. See details of
         `third-party Python packages in Snowflake <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html>`_.
 
+        To use Python packages that are not available in Snowflake, refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
+
         Args:
             packages: A `requirement specifier <https://packaging.python.org/en/latest/glossary/#term-Requirement-Specifier>`_,
                 a ``module`` object or a list of them for installing the packages. An exception
                 will be raised if two conflicting requirement specifiers are provided.
                 The syntax of a requirement specifier is defined in full in
                 `PEP 508 <https://www.python.org/dev/peps/pep-0508/>`_, but currently only the
                 `version matching clause <https://www.python.org/dev/peps/pep-0440/#version-matching>`_ (``==``)
@@ -749,15 +822,18 @@
             ``packages`` argument in :func:`functions.udf` or
             :meth:`session.udf.register() <snowflake.snowpark.udf.UDFRegistration.register>`.
 
             2. We recommend you to `setup the local environment with Anaconda <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html#local-development-and-testing>`_,
             to ensure the consistent experience of a UDF between your local environment
             and the Snowflake server.
         """
-        self._resolve_packages(parse_positional_args_to_list(*packages), self._packages)
+        self._resolve_packages(
+            parse_positional_args_to_list(*packages),
+            self._packages,
+        )
 
     def remove_package(self, package: str) -> None:
         """
         Removes a third-party package from the dependency list of a user-defined function (UDF).
 
         Args:
             package: The package name.
@@ -788,15 +864,18 @@
         Clears all third-party packages of a user-defined function (UDF).
         """
         self._packages.clear()
 
     def add_requirements(self, file_path: str) -> None:
         """
         Adds a `requirement file <https://pip.pypa.io/en/stable/user_guide/#requirements-files>`_
-        that contains a list of packages as dependencies of a user-defined function (UDF).
+        that contains a list of packages as dependencies of a user-defined function (UDF). This function also supports
+        addition of requirements via a `conda environment file <https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#create-env-file-manually>`_.
+
+        To use Python packages that are not available in Snowflake, refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
 
         Args:
             file_path: The path of a local requirement file.
 
         Example::
 
             >>> from snowflake.snowpark.functions import udf
@@ -825,20 +904,21 @@
             ``packages`` argument in :func:`functions.udf` or
             :meth:`session.udf.register() <snowflake.snowpark.udf.UDFRegistration.register>`.
 
             2. We recommend you to `setup the local environment with Anaconda <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html#local-development-and-testing>`_,
             to ensure the consistent experience of a UDF between your local environment
             and the Snowflake server.
         """
-        packages = []
-        with open(file_path) as f:
-            for line in f:
-                package = line.rstrip()
-                if package:
-                    packages.append(package)
+        if file_path.endswith(".yml") or file_path.endswith(".yaml"):
+            packages, runtime_version = parse_conda_environment_yaml_file(file_path)
+            self._runtime_version_from_requirement = runtime_version
+        else:
+            packages, new_imports = parse_requirements_text_file(file_path)
+            for import_path in new_imports:
+                self.add_import(import_path)
         self.add_packages(packages)
 
     def _resolve_packages(
         self,
         packages: List[Union[str, ModuleType]],
         existing_packages_dict: Optional[Dict[str, str]] = None,
         validate_package: bool = True,
@@ -850,139 +930,443 @@
                 package_name = MODULE_NAME_TO_PACKAGE_NAME_MAP.get(
                     package.__name__, package.__name__
                 )
                 package = f"{package_name}=={pkg_resources.get_distribution(package_name).version}"
                 use_local_version = True
             else:
                 package = package.strip().lower()
+                if package.startswith("#"):
+                    continue
                 use_local_version = False
             package_req = pkg_resources.Requirement.parse(package)
             # get the standard package name if there is no underscore
             # underscores are discouraged in package names, but are still used in Anaconda channel
             # pkg_resources.Requirement.parse will convert all underscores to dashes
+
             package_name = (
                 package if not use_local_version and "_" in package else package_req.key
             )
             package_dict[package] = (package_name, use_local_version, package_req)
 
         package_table = "information_schema.packages"
         # TODO: Use the database from fully qualified UDF name
         if not self.get_current_database():
             package_table = f"snowflake.{package_table}"
 
-        valid_packages = (
-            {
-                p[0]: json.loads(p[1])
-                for p in self.table(package_table)
-                .filter(
-                    (col("language") == "python")
-                    & (col("package_name").in_([v[0] for v in package_dict.values()]))
-                )
-                .group_by("package_name")
-                .agg(array_agg("version"))
-                ._internal_collect_with_tag()
-            }
-            if validate_package and package_dict
-            else None
+        valid_packages = self._get_available_versions_for_packages(
+            package_names=[v[0] for v in package_dict.values()],
+            package_table_name=package_table,
+            validate_package=validate_package,
         )
 
         result_dict = (
             existing_packages_dict if existing_packages_dict is not None else {}
         )
+        unsupported_packages: List[str] = []
         for package, package_info in package_dict.items():
             package_name, use_local_version, package_req = package_info
             package_version_req = package_req.specs[0][1] if package_req.specs else None
 
             if validate_package:
-                unavailable_pkg_err_msg = (
-                    "it is not available in Snowflake. Check information_schema.packages "
-                    "to see available packages for UDFs. If this package is a "
-                    '"pure-Python" package, you can find the directory of this package '
-                    "and add it via session.add_import(). See details at "
-                    "https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html#using-third-party-packages-from-anaconda-in-a-udf."
-                )
-
-                if package_name not in valid_packages:
-                    is_anaconda_terms_acknowledged = self._run_query(
-                        "select system$are_anaconda_terms_acknowledged()"
-                    )[0][0]
-                    if is_anaconda_terms_acknowledged:
-                        detailed_err_msg = unavailable_pkg_err_msg
-                    else:
-                        detailed_err_msg = (
-                            "Anaconda terms must be accepted by ORGADMIN to use "
-                            "Anaconda 3rd party packages. Please follow the instructions at "
-                            "https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html#using-third-party-packages-from-anaconda."
-                        )
-
-                    raise ValueError(
-                        f"Cannot add package {package_name} because {detailed_err_msg}"
-                    )
-                elif package_version_req and not any(
-                    v in package_req for v in valid_packages[package_name]
+                if package_name not in valid_packages or (
+                    package_version_req
+                    and not any(v in package_req for v in valid_packages[package_name])
                 ):
-                    raise ValueError(
-                        f"Cannot add package {package_name}=={package_version_req} because {unavailable_pkg_err_msg}"
+                    version_text = (
+                        f"(version {package_version_req})"
+                        if package_version_req is not None
+                        else ""
                     )
+                    if is_in_stored_procedure():  # pragma: no cover
+                        raise RuntimeError(
+                            f"Cannot add package {package_name}{version_text} because it is not available in Snowflake "
+                            f"and it cannot be installed via pip as you are executing this code inside a stored "
+                            f"procedure. You can find the directory of these packages and add it via "
+                            f"Session.add_import. See details at "
+                            f"https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html#using-third-party-packages-from-anaconda-in-a-udf."
+                        )
+                    if (
+                        package_name not in valid_packages
+                        and not self._is_anaconda_terms_acknowledged()
+                    ):
+                        raise RuntimeError(
+                            f"Cannot add package {package_name}{version_text} because Anaconda terms must be accepted "
+                            "by ORGADMIN to use Anaconda 3rd party packages. Please follow the instructions at "
+                            "https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html#using-third-party-packages-from-anaconda."
+                        )
+                    if not self._custom_package_usage_config.get("enabled", False):
+                        raise RuntimeError(
+                            f"Cannot add package {package_req} because it is not available in Snowflake "
+                            f"and Session.custom_package_usage_config['enabled'] is not set to True. To upload these packages, you can "
+                            f"set it to True or find the directory of these packages and add it via Session.add_import. See details at "
+                            f"https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html#using-third-party-packages-from-anaconda-in-a-udf."
+                        )
+                    unsupported_packages.append(package)
+                    continue
                 elif not use_local_version:
                     try:
                         package_client_version = pkg_resources.get_distribution(
                             package_name
                         ).version
                         if package_client_version not in valid_packages[package_name]:
                             _logger.warning(
-                                "The version of package %s in the local environment is %s, "
-                                "which does not fit the criteria for the requirement %s. "
-                                "Your UDF might not work when the package version is different "
-                                "between the server and your local environment",
-                                package_name,
-                                package_client_version,
-                                package,
+                                f"The version of package '{package_name}' in the local environment is "
+                                f"{package_client_version}, which does not fit the criteria for the "
+                                f"requirement '{package}'. Your UDF might not work when the package version "
+                                f"is different between the server and your local environment."
                             )
                     except pkg_resources.DistributionNotFound:
                         _logger.warning(
-                            "package %s is not installed in the local environment"
-                            "Your UDF might not work when the package is installed "
-                            "on the server but not on your local environment.",
-                            package_name,
+                            f"Package '{package_name}' is not installed in the local environment. "
+                            f"Your UDF might not work when the package is installed on the server "
+                            f"but not on your local environment."
                         )
                     except Exception as ex:  # pragma: no cover
                         logging.warning(
                             "Failed to get the local distribution of package %s: %s",
                             package_name,
                             ex,
                         )
 
             if package_name in result_dict:
                 if result_dict[package_name] != package:
                     raise ValueError(
-                        f"Cannot add {package} because {result_dict[package_name]} "
-                        "is already added"
+                        f"Cannot add package '{package}' because {result_dict[package_name]} "
+                        "is already added."
                     )
             else:
                 result_dict[package_name] = package
 
+        dependency_packages: Optional[List[pkg_resources.Requirement]] = None
+        if len(unsupported_packages) != 0:
+            _logger.warning(
+                f"The following packages are not available in Snowflake: {unsupported_packages}."
+            )
+            if platform.system() == "Windows":
+                _logger.warning(
+                    "Custom package upload does not work well on Windows currently. Do not use in production!"
+                )
+            if self._custom_package_usage_config.get(
+                "cache_path", False
+            ) and not self._custom_package_usage_config.get("force_cache", False):
+                cache_path = self._custom_package_usage_config["cache_path"]
+                try:
+                    environment_signature = get_signature(unsupported_packages)
+                    dependency_packages = self._load_unsupported_packages_from_stage(
+                        environment_signature
+                    )
+                    if dependency_packages is None:
+                        _logger.warning(
+                            f"Unable to load environments from remote path {cache_path}, creating a fresh "
+                            f"environment instead."
+                        )
+                except Exception as e:
+                    _logger.warning(
+                        f"Unable to load environments from remote path {cache_path}, creating a fresh "
+                        f"environment instead. Error: {e.__repr__()}"
+                    )
+
+            if not dependency_packages:
+                dependency_packages = self._upload_unsupported_packages(
+                    unsupported_packages,
+                    package_table,
+                )
+
         def get_req_identifiers_list(
             modules: List[Union[str, ModuleType]]
         ) -> List[str]:
             res = []
             for m in modules:
                 if isinstance(m, str) and m not in result_dict:
                     res.append(m)
                 elif isinstance(m, ModuleType) and m.__name__ not in result_dict:
                     res.append(f"{m.__name__}=={m.__version__}")
 
             return res
 
-        # always include cloudpickle
+        # Add dependency packages
+        if dependency_packages:
+            for package in dependency_packages:
+                name = package.name
+                version = package.specs[0][1] if package.specs else None
+
+                # Add to packages dictionary
+                if name in result_dict:
+                    if result_dict[name] != str(package):
+                        raise ValueError(
+                            f"Cannot add dependency package '{name}'{'( version '+version+')' if version else ''} "
+                            f"because {result_dict[name]} is already added."
+                        )
+                else:
+                    result_dict[name] = str(package)
+
+        # Always include cloudpickle
         extra_modules = [cloudpickle]
         if include_pandas:
             extra_modules.append("pandas")
+
         return list(result_dict.values()) + get_req_identifiers_list(extra_modules)
 
+    def _upload_unsupported_packages(
+        self,
+        packages: List[str],
+        package_table: str,
+    ) -> List[pkg_resources.Requirement]:
+        """
+        Uploads a list of Pypi packages, which are unavailable in Snowflake, to session stage.
+
+        Args:
+            packages (List[str]): List of package names requested by the user, that are not present in Snowflake.
+            package_table (str): Name of Snowflake table containing information about Anaconda packages.
+
+        Returns:
+            List[pkg_resources.Requirement]: List of package dependencies (present in Snowflake) that would need to be added
+            to the package dictionary.
+
+        Raises:
+            RuntimeError: If any failure occurs in the workflow.
+
+        """
+        if not self._custom_package_usage_config.get("cache_path", False):
+            _logger.warning(
+                "If you are adding package(s) unavailable in Snowflake, it is highly recommended that you "
+                "include the 'cache_path' configuration parameter in order to reduce latency."
+            )
+
+        try:
+            # Setup a temporary directory and target folder where pip install will take place.
+            self._tmpdir_handler = tempfile.TemporaryDirectory()
+            tmpdir = self._tmpdir_handler.name
+            target = os.path.join(tmpdir, "unsupported_packages")
+            if not os.path.exists(target):
+                os.makedirs(target)
+
+            pip_install_packages_to_target_folder(packages, target)
+
+            # Create Requirement objects for packages installed, mapped to list of package files and folders.
+            downloaded_packages_dict = map_python_packages_to_files_and_folders(target)
+
+            # Fetch valid Snowflake Anaconda versions for all packages installed by pip (if present).
+            valid_downloaded_packages = self._get_available_versions_for_packages(
+                package_names=[
+                    package.name for package in downloaded_packages_dict.keys()
+                ],
+                package_table_name=package_table,
+            )
+
+            # Detect packages which use native code.
+            native_packages = detect_native_dependencies(
+                target, downloaded_packages_dict
+            )
+
+            # Figure out which dependencies are available in Snowflake, and which native dependencies can be dropped.
+            (
+                supported_dependencies,
+                dropped_dependencies,
+                new_dependencies,
+            ) = identify_supported_packages(
+                list(downloaded_packages_dict.keys()),
+                valid_downloaded_packages,
+                native_packages,
+            )
+
+            if len(native_packages) > 0 and not self._custom_package_usage_config.get(
+                "force_push", False
+            ):
+                raise ValueError(
+                    "Your code depends on packages that contain native code, it may not work on Snowflake! Set Session.custom_package_usage_config['force_push'] to True "
+                    "if you wish to proceed with using them anyway."
+                )
+
+            # Delete files
+            delete_files_belonging_to_packages(
+                supported_dependencies + dropped_dependencies,
+                downloaded_packages_dict,
+                target,
+            )
+
+            # Zip and add to stage
+            environment_signature: str = get_signature(packages)
+            zip_file = f"{IMPLICIT_ZIP_FILE_NAME}_{environment_signature}.zip"
+            zip_path = os.path.join(tmpdir, zip_file)
+            zip_directory_contents(target, zip_path)
+
+            # Add packages to stage
+            stage_name = self.get_session_stage()
+
+            if self._custom_package_usage_config.get("cache_path", False):
+                # Switch the stage used for storing zip file.
+                stage_name = self._custom_package_usage_config["cache_path"]
+
+                # Download metadata dictionary using the technique mentioned here: https://docs.snowflake.com/en/user-guide/querying-stage
+                metadata_file = f"{ENVIRONMENT_METADATA_FILE_NAME}.txt"
+                normalized_metadata_path = normalize_remote_file_or_dir(
+                    f"{stage_name}/{metadata_file}"
+                )
+                metadata = {
+                    row[0]: row[1] if row[1] else []
+                    for row in (
+                        self.sql(
+                            f"SELECT t.$1 as signature, t.$2 as packages from {normalized_metadata_path} t"
+                        )._internal_collect_with_tag()
+                    )
+                }
+                _logger.info(f"METADATA: {metadata}")
+
+                # Add a new enviroment to the metadata, avoid commas while storing list of dependencies because commas are treated as default delimiters.
+                metadata[environment_signature] = "|".join(
+                    [
+                        str(requirement)
+                        for requirement in supported_dependencies + new_dependencies
+                    ]
+                )
+                metadata_local_path = os.path.join(
+                    self._tmpdir_handler.name, metadata_file
+                )
+                with open(metadata_local_path, "w") as file:
+                    for key, value in metadata.items():
+                        file.write(f"{key},{value}\n")
+
+                # Upload metadata file to stage
+                # Note that the metadata file is not compressed, only the zip files are.
+                self._conn.upload_file(
+                    path=normalize_local_file(metadata_local_path),
+                    stage_location=normalize_remote_file_or_dir(stage_name),
+                    compress_data=False,
+                    overwrite=True,
+                )
+
+            self._conn.upload_file(
+                path=normalize_local_file(zip_path),
+                stage_location=normalize_remote_file_or_dir(stage_name),
+                compress_data=True,
+                overwrite=True,
+            )
+
+            # Add zipped file as an import
+            stage_zip_path = f"{stage_name}/{zip_file}"
+            self.add_import(
+                stage_zip_path
+                if stage_zip_path.startswith(STAGE_PREFIX)
+                else f"{STAGE_PREFIX}{stage_zip_path}"
+            )
+        except Exception as e:
+            raise RuntimeError(
+                f"Unable to auto-upload packages: {packages}, Error: {e} | NOTE: Alternatively, you can find the "
+                f"directory of these packages and add it via Session.add_import. See details at "
+                f"https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html#using"
+                f"-third-party-packages-from-anaconda-in-a-udf."
+            )
+        finally:
+            if self._tmpdir_handler:
+                self._tmpdir_handler.cleanup()
+                self._tmpdir_handler = None
+
+        return supported_dependencies + new_dependencies
+
+    def _is_anaconda_terms_acknowledged(self) -> bool:
+        return self._run_query("select system$are_anaconda_terms_acknowledged()")[0][0]
+
+    def _load_unsupported_packages_from_stage(
+        self, environment_signature: str
+    ) -> Optional[List[pkg_resources.Requirement]]:
+        """
+        Uses specified stage path to auto-import a group of unsupported packages, along with its dependencies. This
+        saves time spent on pip install, native package detection and zip upload to stage.
+
+        A cached environment on a stage consists of two files:
+        1. A metadata dictionary, pickled using cloudpickle, which maps environment signatures to a list of
+        Anaconda-supported dependency packages required for that environment.
+        2. Zip files named '{PACKAGES_ZIP_NAME}_<environment_signature>.zip.gz which contain the unsupported packages.
+
+        Note that a cached environment is only useful if you wish to use packages unsupported in Snowflake! Supported
+        packages will not be cached (and need not be cached).
+
+        Also note that any changes to your package list, which does not involve changing the versions or names
+        of unsupported packages, will not necessarily affect your environment signature. Your environment signature
+        corresponds only to packages currently not supported in the Anaconda channel.
+
+        Args:
+            environment_signature (str): Unique hash signature for a set of unsupported packages, computed by hashing
+            a sorted tuple of unsupported package requirements (package versioning included).
+        Returns:
+            Optional[List[pkg_resources.Requirement]]: A list of package dependencies for the set of unsupported packages requested.
+        """
+        cache_path = self._custom_package_usage_config["cache_path"]
+        # Ensure that metadata file exists
+        metadata_file = f"{ENVIRONMENT_METADATA_FILE_NAME}.txt"
+        files: Set[str] = self._list_files_in_stage(cache_path)
+        if metadata_file not in files:
+            _logger.info(
+                f"Metadata file named {metadata_file} not found at stage path {cache_path}."
+            )
+            return None  # We need the metadata file to obtain dependency package names.
+
+        # Ensure that zipped package exists
+        required_file = f"{IMPLICIT_ZIP_FILE_NAME}_{environment_signature}.zip.gz"
+        if required_file not in files:
+            _logger.info(
+                f"Matching environment file not found at stage path {cache_path}."
+            )
+            return None  # We need the zipped packages folder.
+
+        # Download metadata
+        metadata_file_path = f"{cache_path}/{metadata_file}"
+        metadata = {
+            row[0]: row[1].split("|") if row[1] else []
+            for row in (
+                self.sql(
+                    f"SELECT t.$1 as signature, t.$2 as packages from {normalize_remote_file_or_dir(metadata_file_path)} t"
+                )
+                .filter(col("signature") == environment_signature)
+                ._internal_collect_with_tag()
+            )
+        }
+
+        dependency_packages = [
+            pkg_resources.Requirement.parse(package)
+            for package in metadata[environment_signature]
+        ]
+        _logger.info(
+            f"Loading dependency packages list - {metadata[environment_signature]}."
+        )
+
+        import_path = (
+            f"{cache_path}/{IMPLICIT_ZIP_FILE_NAME}_{environment_signature}.zip.gz"
+        )
+        self.add_import(
+            import_path
+            if import_path.startswith(STAGE_PREFIX)
+            else f"{STAGE_PREFIX}{import_path}"
+        )
+        return dependency_packages
+
+    def _get_available_versions_for_packages(
+        self,
+        package_names: List[str],
+        package_table_name: str,
+        validate_package: bool = True,
+    ) -> Dict[str, List[str]]:
+        package_to_version_mapping = (
+            {
+                p[0]: json.loads(p[1])
+                for p in self.table(package_table_name)
+                .filter(
+                    (col("language") == "python")
+                    & (col("package_name").in_(package_names))
+                )
+                .group_by("package_name")
+                .agg(array_agg("version"))
+                ._internal_collect_with_tag()
+            }
+            if validate_package and len(package_names) > 0
+            else None
+        )
+        return package_to_version_mapping
+
     @property
     def query_tag(self) -> Optional[str]:
         """
         The query tag for this session.
 
         :getter: Returns the query tag. You can use the query tag to find all queries
             run for this session in the History page of the Snowflake web interface.
@@ -1189,30 +1573,29 @@
         """
         Returns a new DataFrame representing the results of a SQL query.
         You can use this method to execute a SQL statement. Note that you still
         need to call :func:`DataFrame.collect` to execute this query in Snowflake.
 
         Args:
             query: The SQL statement to execute.
-            params: binding parameters.
+            params: binding parameters. We only support qmark bind variables. For more information, check
+                https://docs.snowflake.com/en/developer-guide/python-connector/python-connector-example#qmark-or-numeric-binding
 
         Example::
 
             >>> # create a dataframe from a SQL query
             >>> df = session.sql("select 1/2")
             >>> # execute the query
             >>> df.collect()
             [Row(1/2=Decimal('0.500000'))]
-        """
-        # TODO(SNOW-796947): Remove this limit once stored proc match parity with client
-        if is_in_stored_procedure() and params:
-            raise NotImplementedError(
-                "Bind variable in stored procedure is not supported yet"
-            )
 
+            >>> # Use params to bind variables
+            >>> session.sql("select * from values (?, ?), (?, ?)", params=[1, "a", 2, "b"]).sort("column1").collect()
+            [Row(COLUMN1=1, COLUMN2='a'), Row(COLUMN1=2, COLUMN2='b')]
+        """
         if self.sql_simplifier_enabled:
             d = DataFrame(
                 self,
                 SelectStatement(
                     from_=SelectSQL(query, analyzer=self._analyzer, params=params),
                     analyzer=self._analyzer,
                 ),
@@ -1318,22 +1701,22 @@
                         types `here <https://docs.snowflake.com/en/user-guide/tables-temp-transient.html>`_.
 
         Example::
 
             >>> import pandas as pd
             >>> pandas_df = pd.DataFrame([(1, "Steve"), (2, "Bob")], columns=["id", "name"])
             >>> snowpark_df = session.write_pandas(pandas_df, "write_pandas_table", auto_create_table=True, table_type="temp")
-            >>> snowpark_df.to_pandas()
+            >>> snowpark_df.sort('"id"').to_pandas()
                id   name
             0   1  Steve
             1   2    Bob
 
             >>> pandas_df2 = pd.DataFrame([(3, "John")], columns=["id", "name"])
             >>> snowpark_df2 = session.write_pandas(pandas_df2, "write_pandas_table", auto_create_table=False)
-            >>> snowpark_df2.to_pandas()
+            >>> snowpark_df2.sort('"id"').to_pandas()
                id   name
             0   1  Steve
             1   2    Bob
             2   3   John
 
             >>> pandas_df3 = pd.DataFrame([(1, "Jane")], columns=["id", "name"])
             >>> snowpark_df3 = session.write_pandas(pandas_df3, "write_pandas_table", auto_create_table=False, overwrite=True)
@@ -1458,34 +1841,35 @@
             >>> session.create_dataframe([{"a": 1}, {"b": 2}]).collect()
             [Row(A=1, B=None), Row(A=None, B=2)]
 
             >>> # create a dataframe from a pandas Dataframe
             >>> import pandas as pd
             >>> session.create_dataframe(pd.DataFrame([(1, 2, 3, 4)], columns=["a", "b", "c", "d"])).collect()
             [Row(a=1, b=2, c=3, d=4)]
+
+        Note:
+            When `data` is a pandas DataFrame, `snowflake.connector.pandas_tools.write_pandas` is called, which
+            requires permission to (1) CREATE STAGE (2) CREATE TABLE and (3) CREATE FILE FORMAT under the current
+            database and schema.
         """
         if data is None:
             raise ValueError("data cannot be None.")
 
         # check the type of data
         if isinstance(data, Row):
             raise TypeError("create_dataframe() function does not accept a Row object.")
 
-        if not isinstance(data, (list, tuple, pandas.DataFrame)):
+        if not isinstance(data, (list, tuple)) and (
+            not installed_pandas
+            or (installed_pandas and not isinstance(data, pandas.DataFrame))
+        ):
             raise TypeError(
                 "create_dataframe() function only accepts data as a list, tuple or a pandas DataFrame."
             )
 
-        if not installed_pandas and isinstance(data, pandas.DataFrame):
-            raise MissingDependencyError(
-                "snowflake-connector-python[pandas]. create_dataframe() function only accepts data as a pandas "
-                "DataFrame when the Snowflake Connector for Python is the Pandas-compatible version. Please install "
-                'it as follow: `pip install "snowflake-connector-python[pandas]"`'
-            )
-
         # check to see if it is a Pandas DataFrame and if so, write that to a temp
         # table and return as a DataFrame
         if installed_pandas and isinstance(data, pandas.DataFrame):
             table_name = escape_quotes(
                 random_name_for_temp_object(TempObjectType.TABLE)
             )
             sf_database = self._conn._get_current_parameter("database", quoted=False)
@@ -1569,22 +1953,23 @@
                         VariantType,
                         ArrayType,
                         MapType,
                         TimeType,
                         DateType,
                         TimestampType,
                         GeographyType,
+                        GeometryType,
                     ),
                 )
                 else field.datatype
             )
             attrs.append(Attribute(quoted_name, sf_type, field.nullable))
             data_types.append(field.datatype)
 
-        # convert all variant/time/geography/array/map data to string
+        # convert all variant/time/geospatial/array/map data to string
         converted = []
         for row in rows:
             converted_row = []
             for value, data_type in zip(row, data_types):
                 if value is None:
                     converted_row.append(None)
                 elif isinstance(value, decimal.Decimal) and isinstance(
@@ -1611,14 +1996,16 @@
                     converted_row.append(json.dumps(value, cls=PythonObjJSONEncoder))
                 elif isinstance(value, dict) and isinstance(data_type, MapType):
                     converted_row.append(json.dumps(value, cls=PythonObjJSONEncoder))
                 elif isinstance(data_type, VariantType):
                     converted_row.append(json.dumps(value, cls=PythonObjJSONEncoder))
                 elif isinstance(data_type, GeographyType):
                     converted_row.append(value)
+                elif isinstance(data_type, GeometryType):
+                    converted_row.append(value)
                 else:
                     raise TypeError(
                         f"Cannot cast {type(value)}({value}) to {str(data_type)}."
                     )
             converted.append(Row(*converted_row))
 
         # construct a project statement to convert string value back to variant
@@ -1629,23 +2016,34 @@
                     to_decimal(
                         column(name),
                         field.datatype.precision,
                         field.datatype.scale,
                     ).as_(name)
                 )
             elif isinstance(field.datatype, TimestampType):
-                project_columns.append(to_timestamp(column(name)).as_(name))
+                tz = field.datatype.tz
+                if tz == TimestampTimeZone.NTZ:
+                    to_timestamp_func = builtin("to_timestamp_ntz")
+                elif tz == TimestampTimeZone.LTZ:
+                    to_timestamp_func = builtin("to_timestamp_ltz")
+                elif tz == TimestampTimeZone.TZ:
+                    to_timestamp_func = builtin("to_timestamp_tz")
+                else:
+                    to_timestamp_func = to_timestamp
+                project_columns.append(to_timestamp_func(column(name)).as_(name))
             elif isinstance(field.datatype, TimeType):
                 project_columns.append(to_time(column(name)).as_(name))
             elif isinstance(field.datatype, DateType):
                 project_columns.append(to_date(column(name)).as_(name))
             elif isinstance(field.datatype, VariantType):
                 project_columns.append(to_variant(parse_json(column(name))).as_(name))
             elif isinstance(field.datatype, GeographyType):
                 project_columns.append(to_geography(column(name)).as_(name))
+            elif isinstance(field.datatype, GeometryType):
+                project_columns.append(to_geometry(column(name)).as_(name))
             elif isinstance(field.datatype, ArrayType):
                 project_columns.append(to_array(parse_json(column(name))).as_(name))
             elif isinstance(field.datatype, MapType):
                 project_columns.append(to_object(parse_json(column(name))).as_(name))
             else:
                 project_columns.append(column(name))
 
@@ -1865,14 +2263,23 @@
         """
         Returns a :class:`udtf.UDTFRegistration` object that you can use to register UDTFs.
         See details of how to use this object in :class:`udtf.UDTFRegistration`.
         """
         return self._udtf_registration
 
     @property
+    @private_preview(version="1.6.0")
+    def udaf(self) -> UDAFRegistration:
+        """
+        Returns a :class:`udaf.UDAFRegistration` object that you can use to register UDAFs.
+        See details of how to use this object in :class:`udaf.UDAFRegistration`.
+        """
+        return self._udaf_registration
+
+    @property
     def sproc(self) -> StoredProcedureRegistration:
         """
         Returns a :class:`stored_procedure.StoredProcedureRegistration` object that you can use to register stored procedures.
         See details of how to use this object in :class:`stored_procedure.StoredProcedureRegistration`.
         """
         return self._sp_registration
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/stored_procedure.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/stored_procedure.py`

 * *Files 2% similar despite different names*

```diff
@@ -13,14 +13,15 @@
 from snowflake.connector import ProgrammingError
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import TelemetryField
 from snowflake.snowpark._internal.type_utils import convert_sp_to_sf_type
 from snowflake.snowpark._internal.udf_utils import (
     UDFColumn,
     check_execute_as_arg,
+    check_python_runtime_version,
     check_register_args,
     cleanup_failed_permanent_registration,
     create_python_udf_or_sp,
     generate_anonymous_python_sp_sql,
     generate_call_python_sp_sql,
     process_file_path,
     process_registration_inputs,
@@ -713,14 +714,15 @@
 
         (
             handler,
             code,
             all_imports,
             all_packages,
             upload_file_stage_location,
+            custom_python_runtime_version_allowed,
         ) = resolve_imports_and_packages(
             self._session,
             TempObjectType.PROCEDURE,
             func,
             arg_names,
             udf_name,
             stage_location,
@@ -728,25 +730,31 @@
             packages,
             parallel,
             statement_params=statement_params,
             source_code_display=source_code_display,
             skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
+        if not custom_python_runtime_version_allowed:
+            check_python_runtime_version(
+                self._session._runtime_version_from_requirement
+            )
+
         anonymous_sp_sql = None
         if anonymous:
             anonymous_sp_sql = generate_anonymous_python_sp_sql(
                 return_type=return_type,
                 input_args=input_args,
                 handler=handler,
                 object_name=udf_name,
                 all_imports=all_imports,
                 all_packages=all_packages,
                 inline_python_code=code,
                 strict=strict,
+                runtime_version=self._session._runtime_version_from_requirement,
             )
         else:
             raised = False
             try:
                 create_python_udf_or_sp(
                     session=self._session,
                     return_type=return_type,
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/table.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/table.py`

 * *Files 2% similar despite different names*

```diff
@@ -188,18 +188,20 @@
         Examples::
 
             >>> # Adds a not-matched clause where a row in source is not matched
             >>> # if its key does not equal the key of any row in target.
             >>> # For all such rows, insert a row into target whose ley and value
             >>> # are assigned to the key and value of the not matched row.
             >>> from snowflake.snowpark.functions import when_not_matched
-            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
+            >>> from snowflake.snowpark.types import IntegerType, StringType, StructField, StructType
+            >>> schema = StructType([StructField("key", IntegerType()), StructField("value", StringType())])
+            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=schema)
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
-            >>> source = session.create_dataframe([(12, "new")], schema=["key", "value"])
+            >>> source = session.create_dataframe([(12, "new")], schema=schema)
             >>> target.merge(source, target["key"] == source["key"], [when_not_matched().insert([source["key"], source["value"]])])
             MergeResult(rows_inserted=1, rows_updated=0, rows_deleted=0)
             >>> target.sort("key", "value").collect() # the rows are inserted
             [Row(KEY=10, VALUE='old'), Row(KEY=10, VALUE='too_old'), Row(KEY=11, VALUE='old'), Row(KEY=12, VALUE='new')]
 
             >>> # For all such rows, insert a row into target whose key is
             >>> # assigned to the key of the not matched row.
@@ -595,18 +597,20 @@
             block: A bool value indicating whether this function will wait until the result is available.
                 When it is ``False``, this function executes the underlying queries of the dataframe
                 asynchronously and returns an :class:`AsyncJob`.
 
         Example::
 
             >>> from snowflake.snowpark.functions import when_matched, when_not_matched
-            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=["key", "value"])
+            >>> from snowflake.snowpark.types import IntegerType, StringType, StructField, StructType
+            >>> schema = StructType([StructField("key", IntegerType()), StructField("value", StringType())])
+            >>> target_df = session.create_dataframe([(10, "old"), (10, "too_old"), (11, "old")], schema=schema)
             >>> target_df.write.save_as_table("my_table", mode="overwrite", table_type="temporary")
             >>> target = session.table("my_table")
-            >>> source = session.create_dataframe([(10, "new"), (12, "new"), (13, "old")], schema=["key", "value"])
+            >>> source = session.create_dataframe([(10, "new"), (12, "new"), (13, "old")], schema=schema)
             >>> target.merge(source, (target["key"] == source["key"]) & (target["value"] == "too_old"),
             ...              [when_matched().update({"value": source["value"]}), when_not_matched().insert({"key": source["key"]})])
             MergeResult(rows_inserted=2, rows_updated=1, rows_deleted=0)
             >>> target.sort("key", "value").collect()
             [Row(KEY=10, VALUE='new'), Row(KEY=10, VALUE='old'), Row(KEY=11, VALUE='old'), Row(KEY=12, VALUE=None), Row(KEY=13, VALUE=None)]
         """
         inserted, updated, deleted = False, False, False
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/table_function.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/table_function.py`

 * *Files 1% similar despite different names*

```diff
@@ -132,16 +132,16 @@
 
     as_ = alias
 
 
 class _ExplodeFunctionCall(TableFunctionCall):
     """Internal class to identify explode function call as a special instance of TableFunctionCall"""
 
-    def __init__(self, col: ColumnOrName) -> None:
-        super().__init__("flatten", col)
+    def __init__(self, col: ColumnOrName, outer: Column) -> None:
+        super().__init__("flatten", input=col, outer=outer)
         if isinstance(col, Column):
             self.col = col._expression.name
         else:
             self.col = quote_name(col)
         self.user_visible_name: str = "explode"
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/types.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/types.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,15 +1,17 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 """This package contains all Snowpark logical types."""
+import datetime
 import re
 import sys
+from enum import Enum
 from typing import Generic, List, Optional, TypeVar, Union
 
 import snowflake.snowpark._internal.analyzer.expression as expression
 from snowflake.connector.options import installed_pandas, pandas
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
@@ -111,18 +113,40 @@
         return super().__hash__()
 
 
 class _NumericType(_AtomicType):
     pass
 
 
+class TimestampTimeZone(Enum):
+    """
+    `Snowflake Timestamp variations <https://docs.snowflake.com/en/sql-reference/data-types-datetime#timestamp-ltz-timestamp-ntz-timestamp-tz>`_.
+    """
+
+    DEFAULT = "default"
+    # TIMESTAMP_NTZ
+    NTZ = "ntz"
+    # TIMESTAMP_LTZ
+    LTZ = "ltz"
+    # TIMESTAMP_TZ
+    TZ = "tz"
+
+    def __str__(self):
+        return str(self.value)
+
+
 class TimestampType(_AtomicType):
     """Timestamp data type. This maps to the TIMESTAMP data type in Snowflake."""
 
-    pass
+    def __init__(self, timezone: TimestampTimeZone = TimestampTimeZone.DEFAULT) -> None:
+        self.tz = timezone  #: Timestamp variations
+
+    def __repr__(self) -> str:
+        tzinfo = f"tz={self.tz}" if self.tz != TimestampTimeZone.DEFAULT else ""
+        return f"TimestampType({tzinfo})"
 
 
 class TimeType(_AtomicType):
     """Time data type. This maps to the TIME data type in Snowflake."""
 
     pass
 
@@ -380,14 +404,20 @@
 
 class GeographyType(DataType):
     """Geography data type. This maps to the GEOGRAPHY data type in Snowflake."""
 
     pass
 
 
+class GeometryType(DataType):
+    """Geometry data type. This maps to the GEOMETRY data type in Snowflake."""
+
+    pass
+
+
 class _PandasType(DataType):
     pass
 
 
 class PandasSeriesType(_PandasType):
     """Pandas Series data type."""
 
@@ -397,27 +427,57 @@
 
 class PandasDataFrameType(_PandasType):
     """
     Pandas DataFrame data type. The input should be a list of data types for all columns in order.
     It cannot be used as the return type of a Pandas UDF.
     """
 
-    def __init__(self, col_types: Iterable[DataType]) -> None:
+    def __init__(
+        self, col_types: Iterable[DataType], col_names: Iterable[str] = None
+    ) -> None:
         self.col_types = col_types
+        self.col_names = col_names or []
+
+    def get_snowflake_col_datatypes(self):
+        """Get the column types of the dataframe as the input/output of a vectorized UDTF."""
+        return [
+            tp.element_type if isinstance(tp, PandasSeriesType) else tp
+            for tp in self.col_types
+        ]
 
 
 #: The type hint for annotating Variant data when registering UDFs.
 Variant = TypeVar("Variant")
 
 #: The type hint for annotating Geography data when registering UDFs.
 Geography = TypeVar("Geography")
 
+#: The type hint for annotating Geometry data when registering UDFs.
+Geometry = TypeVar("Geometry")
+
+#: The type hint for annotating TIMESTAMP_NTZ (e.g., ``Timestamp[NTZ]``) data when registering UDFs.
+NTZ = TypeVar("NTZ")
+
+#: The type hint for annotating TIMESTAMP_LTZ (e.g., ``Timestamp[LTZ]``) data when registering UDFs.
+LTZ = TypeVar("LTZ")
+
+#: The type hint for annotating TIMESTAMP_TZ (e.g., ``Timestamp[TZ]``) data when registering UDFs.
+TZ = TypeVar("TZ")
+
+
+_T = TypeVar("_T")
+
+
+class Timestamp(datetime.datetime, Generic[_T]):
+    """The type hint for annotating ``TIMESTAMP_*`` data when registering UDFs."""
+
+    pass
+
 
 if installed_pandas:  # pragma: no cover
-    _T = TypeVar("_T")
 
     class PandasSeries(pandas.Series, Generic[_T]):
         """The type hint for annotating Pandas Series data when registering UDFs."""
 
         pass
 
     from typing_extensions import TypeVarTuple
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/udf.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/udf.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,24 +1,35 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
-"""User-defined functions (UDFs) in Snowpark. Refer to :class:`~snowflake.snowpark.udf.UDFRegistration` for details and sample code."""
+"""User-defined functions (UDFs) in Snowpark. Please see `Python UDFs <https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs>`_ for details.
+Furthermore, there is vectorized UDF (Please see `Python UDF Batch API <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html>`__ for details). Compared to the default row-by-row processing pattern of a normal UDF, which sometimes is
+inefficient, a vectorized UDF allows vectorized operations on a dataframe, with the input as a `Pandas DataFrame <https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html>`_ or `Pandas Series <https://pandas.pydata.org/docs/reference/api/pandas.Series.html>`_. In a
+vectorized UDF, you can operate on a batches of rows by handling Pandas DataFrame or Pandas Series.
+
+In brief, the advantages of a vectorized UDF include
+    - The potential for better performance if your Python code operates efficiently on batches of rows.
+    - Less transformation logic is required if you are calling into libraries that operate on Pandas DataFrames or Pandas arrays.
+
+Refer to :class:`~snowflake.snowpark.udf.UDFRegistration` for sample code on how to create and use regular and vectorized UDF's using Snowpark Python API.
+"""
 import sys
 from types import ModuleType
 from typing import Callable, Dict, List, Optional, Tuple, Union
 
 import snowflake.snowpark
 from snowflake.connector import ProgrammingError
 from snowflake.snowpark._internal.analyzer.expression import Expression, SnowflakeUDF
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.type_utils import ColumnOrName, convert_sp_to_sf_type
 from snowflake.snowpark._internal.udf_utils import (
     UDFColumn,
+    check_python_runtime_version,
     check_register_args,
     cleanup_failed_permanent_registration,
     create_python_udf_or_sp,
     process_file_path,
     process_registration_inputs,
     resolve_imports_and_packages,
 )
@@ -117,24 +128,14 @@
     For more information about Snowflake Python UDFs, see `Python UDFs <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python.html>`__.
 
     :attr:`session.udf <snowflake.snowpark.Session.udf>` returns an object of this class.
     You can use this object to register UDFs that you plan to use in the current session or
     permanently. The methods that register a UDF return a :class:`UserDefinedFunction` object,
     which you can also use in :class:`~snowflake.snowpark.Column` expressions.
 
-    Note:
-        Before creating a UDF, think about whether you want to create a vectorized UDF (also referred to as `Python UDF Batch API`) or a regular UDF.
-        The advantages of a vectorized UDF are:
-
-          - The potential for better performance if your Python code operates efficiently on batches of rows.
-          - Less transformation logic is required if you are calling into libraries that operate on Pandas DataFrames or Pandas arrays.
-
-        Refer to `Python UDF Batch API <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html>`__ for more details.
-        The following text explains how to create a regular UDF and a vectorized UDF by using the Snowpark Python APIs.
-
     There are two ways to register a UDF with Snowpark:
 
         - Use :func:`~snowflake.snowpark.functions.udf` or :meth:`register`. By pointing to a
           `runtime Python function`, Snowpark uses `cloudpickle <https://github.com/cloudpipe/cloudpickle>`_
           to serialize this function to bytecode, and deserialize the bytecode to a Python
           function on the Snowflake server during UDF creation. During the serialization, the
           global variables used in the Python function will be serialized into the bytecode,
@@ -195,26 +196,21 @@
           executed and applied to every row of your dataframe or table when executing this UDF.
           This approach can address the deficiency of the previous approach that uses cloudpickle,
           because the source code in this file other than the target function will be loaded
           during UDF creation, and will not be executed on every row during UDF execution.
           Therefore, this approach is useful and efficient when all your Python code is already in
           source files.
 
-    Compared to the default row-by-row processing pattern of a normal UDF, which sometimes is
-    inefficient, a vectorized UDF allows vectorized operations on a dataframe, with the input as a
-    `Pandas DataFrame <https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html>`_
-    or `Pandas Series <https://pandas.pydata.org/docs/reference/api/pandas.Series.html>`_. In a
-    vectorized UDF, you can operate on a batches of rows by handling Pandas DataFrame or Pandas
-    Series. You can use :func:`~snowflake.snowpark.functions.udf`, :meth:`register` or
-    :func:`~snowflake.snowpark.functions.pandas_udf` to create a vectorized UDF by providing
-    appropriate return and input types. If you would like to use :meth:`register_from_file` to
-    create a vectorized UDF, you would need to explicitly mark the handler function as vectorized using
-    either the `vectorized` Decorator or a function attribute. Please see
-    `Python UDF Batch API <https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html>`
-    for examples.
+
+    For a vectorized UDF:
+        You can use :func:`~snowflake.snowpark.functions.udf`, :meth:`register` or
+        :func:`~snowflake.snowpark.functions.pandas_udf` to create a vectorized UDF by providing
+        appropriate return and input types. If you would like to use :meth:`register_from_file` to
+        create a vectorized UDF, you need to explicitly mark the handler function as vectorized using
+        either the `vectorized` Decorator or a function attribute.
 
     Snowflake supports the following data types for the parameters for a UDF:
 
     =============================================  ======================================================= ============
     Python Type                                    Snowpark Type                                           SQL Type
     =============================================  ======================================================= ============
     ``int``                                        :class:`~snowflake.snowpark.types.LongType`             NUMBER
@@ -251,14 +247,19 @@
         3. :class:`~snowflake.snowpark.types.PandasSeriesType` and
         :class:`~snowflake.snowpark.types.PandasDataFrameType` are used when creating a Pandas
         (vectorized) UDF, so they are not mapped to any SQL types. ``element_type`` in
         :class:`~snowflake.snowpark.types.PandasSeriesType` and ``col_types`` in
         :class:`~snowflake.snowpark.types.PandasDataFrameType` indicate the SQL types
         in a Pandas Series and a Pandas DataFrame.
 
+        4. To annotate the Snowflake specific Timestamp type (TIMESTAMP_NTZ, TIMESTAMP_LTZ and
+        TIMESTAMP_TZ), use :class:`~snowflake.snowpark.types.Timestamp` with
+        :class:`~snowflake.snowpark.types.NTZ`, :class:`~snowflake.snowpark.types.LTZ`,
+        :class:`~snowflake.snowpark.types.TZ` (e.g., ``Timestamp[NTZ]``).
+
     Example 1
         Create a temporary UDF from a lambda and apply it to a dataframe::
 
             >>> from snowflake.snowpark.types import IntegerType
             >>> from snowflake.snowpark.functions import udf
             >>> add_one_udf = udf(lambda x: x+1, return_type=IntegerType(), input_types=[IntegerType()])
             >>> session.range(1, 8, 2).select(add_one_udf("id")).to_df("col1").collect()
@@ -536,15 +537,16 @@
                 no import for this UDF, and ``None`` or not specifying this parameter means using
                 session-level imports.
             packages: A list of packages that only apply to this UDF. These UDF-level packages
                 will override the session-level packages added by
                 :meth:`~snowflake.snowpark.Session.add_packages` and
                 :meth:`~snowflake.snowpark.Session.add_requirements`. Note that an empty list means
                 no package for this UDF, and ``None`` or not specifying this parameter means using
-                session-level packages.
+                session-level packages. To use Python packages that are not available in Snowflake,
+                refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
             replace: Whether to replace a UDF that already was registered. The default is ``False``.
                 If it is ``False``, attempting to register a UDF with a name that already exists
                 results in a ``SnowparkSQLException`` exception being thrown. If it is ``True``,
                 an existing UDF with the same name is overwritten.
             if_not_exists: Whether to skip creation of a UDF when one with the same signature already exists.
                 The default is ``False``. ``if_not_exists`` and ``replace`` are mutually exclusive
                 and a ``ValueError`` is raised when both are set. If it is ``True`` and a UDF with
@@ -674,15 +676,16 @@
                 no import for this UDF, and ``None`` or not specifying this parameter means using
                 session-level imports.
             packages: A list of packages that only apply to this UDF. These UDF-level packages
                 will override the session-level packages added by
                 :meth:`~snowflake.snowpark.Session.add_packages` and
                 :meth:`~snowflake.snowpark.Session.add_requirements`. Note that an empty list means
                 no package for this UDF, and ``None`` or not specifying this parameter means using
-                session-level packages.
+                session-level packages. To use Python packages that are not available in Snowflake,
+                refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
             replace: Whether to replace a UDF that already was registered. The default is ``False``.
                 If it is ``False``, attempting to register a UDF with a name that already exists
                 results in a ``SnowparkSQLException`` exception being thrown. If it is ``True``,
                 an existing UDF with the same name is overwritten.
             if_not_exists: Whether to skip creation of a UDF when one with the same signature already exists.
                 The default is ``False``. ``if_not_exists`` and ``replace`` are mutually exclusive
                 and a ``ValueError`` is raised when both are set. If it is ``True`` and a UDF with
@@ -703,18 +706,18 @@
                 `func` is originally defined. The default is ``True``.
                 If it is ``False``, source code will not be generated or displayed.
             skip_upload_on_content_match: When set to ``True`` and a version of source file already exists on stage, the given source
                 file will be uploaded to stage only if the contents of the current file differ from the remote file on stage. Defaults
                 to ``False``.
 
         Note::
-            The type hints can still be extracted from the source Python file if they
-            are provided, but currently are not working for a zip file. Therefore,
+            The type hints can still be extracted from the local source Python file if they
+            are provided, but currently are not working for a zip file or a remote file. Therefore,
             you have to provide ``return_type`` and ``input_types`` when ``path``
-            points to a zip file.
+            points to a zip file or a remote file.
 
         See Also:
             - :func:`~snowflake.snowpark.functions.udf`
             - :meth:`register`
         """
         file_path = process_file_path(file_path)
         check_register_args(
@@ -789,14 +792,15 @@
 
         (
             handler,
             code,
             all_imports,
             all_packages,
             upload_file_stage_location,
+            custom_python_runtime_version_allowed,
         ) = resolve_imports_and_packages(
             self._session,
             TempObjectType.FUNCTION,
             func,
             arg_names,
             udf_name,
             stage_location,
@@ -807,14 +811,19 @@
             is_dataframe_input,
             max_batch_size,
             statement_params=statement_params,
             source_code_display=source_code_display,
             skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
+        if not custom_python_runtime_version_allowed:
+            check_python_runtime_version(
+                self._session._runtime_version_from_requirement
+            )
+
         raised = False
         try:
             create_python_udf_or_sp(
                 session=self._session,
                 return_type=return_type,
                 input_args=input_args,
                 handler=handler,
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/udtf.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/udtf.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,51 +1,50 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
-"""User-defined table functions (UDTFs) in Snowpark. Refer to :class:`~snowflake.snowpark.udtf.UDTFRegistration` for details and sample code."""
-import collections.abc
+"""User-defined table functions (UDTFs) in Snowpark. Please see `Python UDTF <https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udtfs>_` for details.
+There is also vectorized UDTF. Compared to the default row-by-row processing pattern of a normal UDTF, which sometimes is inefficient, vectorized Python UDTFs (user-defined table functions) enable seamless partition-by-partition processing
+by operating on partitions as `Pandas DataFrames <https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html>`_ and returning results as`Pandas DataFrames <https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html>`_ or lists of
+`Pandas arrays <https://pandas.pydata.org/docs/reference/api/pandas.array.html>`_ or `Pandas Series <https://pandas.pydata.org/docs/reference/series.html>`_.
+
+In addition, vectorized Python UDTFs allow for easy integration with libraries that operate on pandas DataFrames or pandas arrays.
+
+A vectorized UDTF handler class:
+    - defines an :code:`end_partition` method that takes in a DataFrame argument and returns a :code:`pandas.DataFrame` or a tuple of :code:`pandas.Series` or :code:`pandas.arrays` where each array is a column.
+    - does NOT define a :code:`process` method.
+    - optionally defines a handler class with an :code:`__init__` method which will be invoked before processing each partition.
+
+Note:
+    A vectorized UDTF must be called with `~snowflake.snowpark.Window.partition_by` to build the partitions.
+
+Refer to :class:`~snowflake.snowpark.udtf.UDTFRegistration` for details and sample code on how to create regular and vectorized UDTFs using Snowpark Python API.
+"""
 import sys
 from types import ModuleType
-from typing import (
-    Callable,
-    Dict,
-    List,
-    Optional,
-    Tuple,
-    Type,
-    Union,
-    get_args,
-    get_origin,
-    get_type_hints,
-)
+from typing import Callable, Dict, List, Optional, Tuple, Type, Union
 
 import snowflake.snowpark
 from snowflake.connector import ProgrammingError
-from snowflake.snowpark._internal import type_utils
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
-from snowflake.snowpark._internal.type_utils import (
-    ColumnOrName,
-    python_type_str_to_object,
-    retrieve_func_type_hints_from_source,
-)
+from snowflake.snowpark._internal.type_utils import ColumnOrName
 from snowflake.snowpark._internal.udf_utils import (
-    TABLE_FUNCTION_PROCESS_METHOD,
     UDFColumn,
+    check_python_runtime_version,
     check_register_args,
     cleanup_failed_permanent_registration,
     create_python_udf_or_sp,
     process_file_path,
     process_registration_inputs,
     resolve_imports_and_packages,
 )
 from snowflake.snowpark._internal.utils import TempObjectType, validate_object_name
 from snowflake.snowpark.table_function import TableFunctionCall
-from snowflake.snowpark.types import DataType, StructField, StructType
+from snowflake.snowpark.types import DataType, PandasDataFrameType, StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
 if sys.version_info <= (3, 9):
     from typing import Iterable
 else:
@@ -310,14 +309,98 @@
         - :func:`~snowflake.snowpark.functions.udtf`
         - :meth:`register`
         - :meth:`register_from_file`
         - :meth:`~snowflake.snowpark.Session.add_import`
         - :meth:`~snowflake.snowpark.Session.add_packages`
         - :meth:`~snowflake.snowpark.Session.table_function`
         - :meth:`~snowflake.snowpark.DataFrame.join_table_function`
+
+    You can use :func:`~snowflake.snowpark.functions.udtf`, :meth:`register` or
+    :func:`~snowflake.snowpark.functions.pandas_udtf` to create a vectorized UDTF by providing
+    appropriate return and input types. If you would like to use :meth:`register_from_file` to
+    create a vectorized UDTF, you would need to explicitly mark the handler method as vectorized using
+    either the decorator `@vectorized(input=pandas.DataFrame)` or setting `<class>.end_partition._sf_vectorized_input = pandas.DataFrame`
+
+    Example 11
+        Creating a vectorized UDTF by specifying a `PandasDataFrameType` as `input_types` and a `PandasDataFrameType` with column names as `output_schema`.
+            >>> from snowflake.snowpark.types import PandasDataFrameType, IntegerType, StringType, FloatType
+            >>> class multiply:
+            ...     def __init__(self):
+            ...         self.multiplier = 10
+            ...     def end_partition(self, df):
+            ...         df.columns = ['id', 'col1', 'col2']
+            ...         df.col1 = df.col1*self.multiplier
+            ...         df.col2 = df.col2*self.multiplier
+            ...         yield df
+            >>> multiply_udtf = session.udtf.register(
+            ...     multiply,
+            ...     output_schema=PandasDataFrameType([StringType(), IntegerType(), FloatType()], ["id_", "col1_", "col2_"]),
+            ...     input_types=[PandasDataFrameType([StringType(), IntegerType(), FloatType()])]
+            ... )
+            >>> df = session.create_dataframe([['x', 3, 35.9],['x', 9, 20.5]], schema=["id", "col1", "col2"])
+            >>> df.select(multiply_udtf("id", "col1", "col2").over(partition_by=["id"])).sort("col1_").show()
+            -----------------------------
+            |"ID_"  |"COL1_"  |"COL2_"  |
+            -----------------------------
+            |x      |30       |359.0    |
+            |x      |90       |205.0    |
+            -----------------------------
+            <BLANKLINE>
+
+    Example 12
+        Creating a vectorized UDTF by specifying `PandasDataFrame` with nested types as type hints.
+            >>> from snowflake.snowpark.types import PandasDataFrame
+            >>> class multiply:
+            ...     def __init__(self):
+            ...         self.multiplier = 10
+            ...     def end_partition(self, df: PandasDataFrame[str, int, float]) -> PandasDataFrame[str, int, float]:
+            ...         df.columns = ['id', 'col1', 'col2']
+            ...         df.col1 = df.col1*self.multiplier
+            ...         df.col2 = df.col2*self.multiplier
+            ...         yield df
+            >>> multiply_udtf = session.udtf.register(
+            ...     multiply,
+            ...     output_schema=["id_", "col1_", "col2_"],
+            ... )
+            >>> df = session.create_dataframe([['x', 3, 35.9],['x', 9, 20.5]], schema=["id", "col1", "col2"])
+            >>> df.select(multiply_udtf("id", "col1", "col2").over(partition_by=["id"])).sort("col1_").show()
+            -----------------------------
+            |"ID_"  |"COL1_"  |"COL2_"  |
+            -----------------------------
+            |x      |30       |359.0    |
+            |x      |90       |205.0    |
+            -----------------------------
+            <BLANKLINE>
+
+    Example 13
+        Creating a vectorized UDTF by specifying a `pandas.DataFrame` as type hints and a `StructType` with type information and column names as `output_schema`.
+            >>> import pandas as pd
+            >>> from snowflake.snowpark.types import IntegerType, StringType, FloatType, StructType, StructField
+            >>> class multiply:
+            ...     def __init__(self):
+            ...         self.multiplier = 10
+            ...     def end_partition(self, df: pd.DataFrame) -> pd.DataFrame:
+            ...         df.columns = ['id', 'col1', 'col2']
+            ...         df.col1 = df.col1*self.multiplier
+            ...         df.col2 = df.col2*self.multiplier
+            ...         yield df
+            >>> multiply_udtf = session.udtf.register(
+            ...     multiply,
+            ...     output_schema=StructType([StructField("id_", StringType()), StructField("col1_", IntegerType()), StructField("col2_", FloatType())]),
+            ...     input_types=[StringType(), IntegerType(), FloatType()]
+            ... )
+            >>> df = session.create_dataframe([['x', 3, 35.9],['x', 9, 20.5]], schema=["id", "col1", "col2"])
+            >>> df.select(multiply_udtf("id", "col1", "col2").over(partition_by=["id"])).sort("col1_").show()
+            -----------------------------
+            |"ID_"  |"COL1_"  |"COL2_"  |
+            -----------------------------
+            |x      |30       |359.0    |
+            |x      |90       |205.0    |
+            -----------------------------
+            <BLANKLINE>
     """
 
     def __init__(self, session: "snowflake.snowpark.Session") -> None:
         self._session = session
 
     def register(
         self,
@@ -369,15 +452,16 @@
                 strings to represent a file path and an import path (similar to the ``import_path``
                 argument in :meth:`~snowflake.snowpark.Session.add_import`). These UDTF-level imports
                 will override the session-level imports added by
                 :meth:`~snowflake.snowpark.Session.add_import`.
             packages: A list of packages that only apply to this UDTF. These UDTF-level packages
                 will override the session-level packages added by
                 :meth:`~snowflake.snowpark.Session.add_packages` and
-                :meth:`~snowflake.snowpark.Session.add_requirements`.
+                :meth:`~snowflake.snowpark.Session.add_requirements`. To use Python packages that are not available
+                in Snowflake, refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
             replace: Whether to replace a UDTF that already was registered. The default is ``False``.
                 If it is ``False``, attempting to register a UDTF with a name that already exists
                 results in a ``SnowparkSQLException`` exception being thrown. If it is ``True``,
                 an existing UDTF with the same name is overwritten.
             if_not_exists: Whether to skip creation of a UDTF when one with the same signature already exists.
                 The default is ``False``. ``if_not_exists`` and ``replace`` are mutually exclusive
                 and a ``ValueError`` is raised when both are set. If it is ``True`` and a UDTF with
@@ -428,15 +512,17 @@
             api_call_source="UDTFRegistration.register",
         )
 
     def register_from_file(
         self,
         file_path: str,
         handler_name: str,
-        output_schema: Union[StructType, Iterable[str]],
+        output_schema: Union[
+            StructType, Iterable[str], Tuple[PandasDataFrameType, Iterable[str]]
+        ],
         input_types: Optional[List[DataType]] = None,
         name: Optional[Union[str, Iterable[str]]] = None,
         is_permanent: bool = False,
         stage_location: Optional[str] = None,
         imports: Optional[List[Union[str, Tuple[str, str]]]] = None,
         packages: Optional[List[Union[str, ModuleType]]] = None,
         replace: bool = False,
@@ -486,15 +572,16 @@
                 strings to represent a file path and an import path (similar to the ``import_path``
                 argument in :meth:`~snowflake.snowpark.Session.add_import`). These UDTF-level imports
                 will override the session-level imports added by
                 :meth:`~snowflake.snowpark.Session.add_import`.
             packages: A list of packages that only apply to this UDTF. These UDTF-level packages
                 will override the session-level packages added by
                 :meth:`~snowflake.snowpark.Session.add_packages` and
-                :meth:`~snowflake.snowpark.Session.add_requirements`.
+                :meth:`~snowflake.snowpark.Session.add_requirements`. To use Python packages that are not
+                available in Snowflake, refer to :meth:`~snowflake.snowpark.Session.custom_package_usage_config`.
             replace: Whether to replace a UDTF that already was registered. The default is ``False``.
                 If it is ``False``, attempting to register a UDTF with a name that already exists
                 results in a ``SnowparkSQLException`` exception being thrown. If it is ``True``,
                 an existing UDTF with the same name is overwritten.
             if_not_exists: Whether to skip creation of a UDTF when one with the same signature already exists.
                 The default is ``False``. ``if_not_exists`` and ``replace`` are mutually exclusive
                 and a ``ValueError`` is raised when both are set. If it is ``True`` and a UDTF with
@@ -513,18 +600,18 @@
                 see `Secure UDFs <https://docs.snowflake.com/en/sql-reference/udf-secure.html>`_.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
             skip_upload_on_content_match: When set to ``True`` and a version of source file already exists on stage, the given source
                 file will be uploaded to stage only if the contents of the current file differ from the remote file on stage. Defaults
                 to ``False``.
 
         Note::
-            The type hints can still be extracted from the source Python file if they
-            are provided, but currently are not working for a zip file. Therefore,
+            The type hints can still be extracted from the local source Python file if they
+            are provided, but currently are not working for a zip file or a remote file. Therefore,
             you have to provide ``output_schema`` and ``input_types`` when ``path``
-            points to a zip file.
+            points to a zip file or a remote file.
 
         See Also:
             - :func:`~snowflake.snowpark.functions.udtf`
             - :meth:`register`
         """
         file_path = process_file_path(file_path)
         check_register_args(
@@ -565,122 +652,83 @@
         strict: bool = False,
         secure: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         api_call_source: str,
         skip_upload_on_content_match: bool = False,
     ) -> UserDefinedTableFunction:
-        if not isinstance(output_schema, (Iterable, StructType)):
-            raise ValueError(
-                f"'output_schema' must be a list of column names or StructType instance to create a UDTF. Got {type(output_schema)}."
-            )
+
         if isinstance(output_schema, StructType):
             _validate_output_schema_names(output_schema.names)
-        if isinstance(
+            return_type = output_schema
+            output_schema = None
+        elif isinstance(output_schema, PandasDataFrameType):
+            _validate_output_schema_names(output_schema.col_names)
+            return_type = output_schema
+            output_schema = None
+        elif isinstance(
             output_schema, Iterable
         ):  # with column names instead of StructType. Read type hints to infer column types.
             output_schema = tuple(output_schema)
             _validate_output_schema_names(output_schema)
-            # A typical type hint for method process is like Iterable[Tuple[int, str, datetime]], or Iterable[Tuple[str, ...]]
-            # The inner Tuple is a single row of the table function result.
-            if isinstance(handler, Callable):
-                type_hints = get_type_hints(
-                    getattr(handler, TABLE_FUNCTION_PROCESS_METHOD)
-                )
-                return_type_hint = type_hints.get("return")
-            else:
-                type_hints = retrieve_func_type_hints_from_source(
-                    handler[0],
-                    func_name=TABLE_FUNCTION_PROCESS_METHOD,
-                    class_name=handler[1],
-                )
-                return_type_hint = python_type_str_to_object(type_hints.get("return"))
-            if not return_type_hint:
-                raise ValueError(
-                    "The return type hint is not set but 'output_schema' has only column names. You can either use a StructType instance for 'output_schema', or use"
-                    "a combination of a return type hint for method 'process' and column names for 'output_schema'."
-                )
-            if get_origin(return_type_hint) not in (
-                list,
-                tuple,
-                collections.abc.Iterable,
-                collections.abc.Iterator,
-            ):
-                raise ValueError(
-                    f"The return type hint for a UDTF handler must but a collection type. {return_type_hint} is used."
-                )
-            row_type_hint = get_args(return_type_hint)[0]  # The inner Tuple
-            if get_origin(row_type_hint) != tuple:
-                raise ValueError(
-                    f"The return type hint of method '{handler.__name__}.process' must be a collection of tuples, for instance, Iterable[Tuple[str, int]], if you specify return type hint."
-                )
-            column_type_hints = get_args(row_type_hint)
-            if len(column_type_hints) > 1 and column_type_hints[1] == Ellipsis:
-                output_schema = StructType(
-                    [
-                        StructField(
-                            name,
-                            type_utils.python_type_to_snow_type(column_type_hints[0])[
-                                0
-                            ],
-                        )
-                        for name in output_schema
-                    ]
-                )
-            else:
-                if len(column_type_hints) != len(output_schema):
-                    raise ValueError(
-                        f"'output_schema' has {len(output_schema)} names while type hints Tuple has only {len(column_type_hints)}."
-                    )
-                output_schema = StructType(
-                    [
-                        StructField(
-                            name,
-                            type_utils.python_type_to_snow_type(column_type)[0],
-                        )
-                        for name, column_type in zip(output_schema, column_type_hints)
-                    ]
-                )
+            return_type = None
+        else:
+            raise ValueError(
+                f"'output_schema' must be a list of column names or StructType or PandasDataFrameType instance to create a UDTF. Got {type(output_schema)}."
+            )
 
         # get the udtf name, input types
-        (udtf_name, _, _, _, input_types,) = process_registration_inputs(
+        (
+            udtf_name,
+            is_pandas_udf,
+            is_dataframe_input,
+            output_schema,
+            input_types,
+        ) = process_registration_inputs(
             self._session,
             TempObjectType.TABLE_FUNCTION,
             handler,
-            output_schema,
+            return_type,
             input_types,
             name,
+            output_schema=output_schema,
         )
 
         arg_names = [f"arg{i + 1}" for i in range(len(input_types))]
         input_args = [
             UDFColumn(dt, arg_name) for dt, arg_name in zip(input_types, arg_names)
         ]
         (
             handler_name,
             code,
             all_imports,
             all_packages,
             upload_file_stage_location,
+            custom_python_runtime_version_allowed,
         ) = resolve_imports_and_packages(
             self._session,
             TempObjectType.TABLE_FUNCTION,
             handler,
             arg_names,
             udtf_name,
             stage_location,
             imports,
             packages,
             parallel,
-            False,
-            False,
+            is_pandas_udf,
+            is_dataframe_input,
             statement_params=statement_params,
             skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
+        if not custom_python_runtime_version_allowed:
+            check_python_runtime_version(
+                self._session._runtime_version_from_requirement
+            )
+
         raised = False
         try:
             create_python_udf_or_sp(
                 session=self._session,
                 return_type=output_schema,
                 input_args=input_args,
                 handler=handler_name,
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake/snowpark/window.py` & `snowflake-snowpark-python-1.6.0/src/snowflake/snowpark/window.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/PKG-INFO` & `snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.5.1
+Version: 1.6.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -132,14 +132,56 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.6.0 (2023-07-28)
+
+### New Features
+
+- Added support for these new functions in `snowflake.snowpark.functions`:
+  - `array_sort`
+  - `sort_array`
+  - `array_min`
+  - `array_max`
+  - `explode_outer`
+- Added support for pure Python packages specified via `Session.add_requirements` or `Session.add_packages`. They are now usable in stored procedures and UDFs even if packages are not present on the Snowflake Anaconda channel.
+  - Added Session parameter `custom_packages_upload_enabled` and `custom_packages_force_upload_enabled` to enable the support for pure Python packages feature mentioned above. Both parameters default to `False`.
+- Added support for specifying package requirements by passing a Conda environment yaml file to `Session.add_requirements`.
+- Added support for asynchronous execution of multi-query dataframes that contain binding variables.
+- Added support for renaming multiple columns in `DataFrame.rename`.
+- Added support for Geometry datatypes.
+- Added support for `params` in `session.sql()` in stored procedures.
+- Added support for user-defined aggregate functions (UDAFs). This feature is currently in private preview.
+- Added support for vectorized UDTFs (user-defined table functions). This feature is currently in public preview.
+- Added support for Snowflake Timestamp variants (i.e., `TIMESTAMP_NTZ`, `TIMESTAMP_LTZ`, `TIMESTAMP_TZ`)
+  - Added `TimestampTimezone` as an argument in `TimestampType` constructor.
+  - Added type hints `NTZ`, `LTZ`, `TZ` and `Timestamp` to annotate functions when registering UDFs.
+
+### Improvements
+
+- Removed redundant dependency `typing-extensions`.
+- `DataFrame.cache_result` now creates temp table fully qualified names under current database and current schema.
+
+### Bug Fixes
+
+- Fixed a bug where type check happens on pandas before it is imported.
+- Fixed a bug when creating a UDF from `numpy.ufunc`.
+- Fixed a bug where `DataFrame.union` was not generating the correct `Selectable.schema_query` when SQL simplifier is enabled.
+
+### Behavior Changes
+
+- `DataFrameWriter.save_as_table` now respects the `nullable` field of the schema provided by the user or the inferred schema based on data from user input.
+
+### Dependency updates
+
+- Updated ``snowflake-connector-python`` to 3.0.4.
+
 ## 1.5.1 (2023-06-20)
 
 ### New Features
 
 - Added support for the Python 3.10 runtime environment.
 
 ## 1.5.0 (2023-06-09)
```

### Comparing `snowflake-snowpark-python-1.5.1/src/snowflake_snowpark_python.egg-info/SOURCES.txt` & `snowflake-snowpark-python-1.6.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -21,21 +21,23 @@
 src/snowflake/snowpark/relational_grouped_dataframe.py
 src/snowflake/snowpark/row.py
 src/snowflake/snowpark/session.py
 src/snowflake/snowpark/stored_procedure.py
 src/snowflake/snowpark/table.py
 src/snowflake/snowpark/table_function.py
 src/snowflake/snowpark/types.py
+src/snowflake/snowpark/udaf.py
 src/snowflake/snowpark/udf.py
 src/snowflake/snowpark/udtf.py
 src/snowflake/snowpark/version.py
 src/snowflake/snowpark/window.py
 src/snowflake/snowpark/_internal/__init__.py
 src/snowflake/snowpark/_internal/code_generation.py
 src/snowflake/snowpark/_internal/error_message.py
+src/snowflake/snowpark/_internal/packaging_utils.py
 src/snowflake/snowpark/_internal/server_connection.py
 src/snowflake/snowpark/_internal/telemetry.py
 src/snowflake/snowpark/_internal/type_utils.py
 src/snowflake/snowpark/_internal/udf_utils.py
 src/snowflake/snowpark/_internal/utils.py
 src/snowflake/snowpark/_internal/analyzer/__init__.py
 src/snowflake/snowpark/_internal/analyzer/analyzer.py
```

